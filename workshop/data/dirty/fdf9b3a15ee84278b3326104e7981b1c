VolumeShadowCopyTools.ps1,2566d63f26be32522abde6a935ca9c70,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gR2V0LVZvbHVtZVNoYWRvd0NvcHkKewo8IwouU1lOT1BTSVMKCiAgICBMaXN0cyB0aGUgZGV2aWNlIHBhdGhzIG9mIGFsbCBsb2NhbCB2b2x1bWUgc2hhZG93IGNvcGllcy4KCiAgICBQb3dlclNwbG9pdCBGdW5jdGlvbjogR2V0LVZvbHVtZVNoYWRvd0NvcHkKICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiM+CgogICAgJFVzZXJJZGVudGl0eSA9IChbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWxdW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpCgogICAgaWYgKC1ub3QgJFVzZXJJZGVudGl0eS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV0nQWRtaW5pc3RyYXRvcicpKQogICAgewogICAgICAgIFRocm93ICdZb3UgbXVzdCBydW4gR2V0LVZvbHVtZVNoYWRvd0NvcHkgZnJvbSBhbiBlbGV2YXRlZCBjb21tYW5kIHByb21wdC4nCiAgICB9CgogICAgR2V0LVdtaU9iamVjdCAtTmFtZXNwYWNlIHJvb3RcY2ltdjIgLUNsYXNzIFdpbjMyX1NoYWRvd0NvcHkgfCBGb3JFYWNoLU9iamVjdCB7ICRfLkRldmljZU9iamVjdCB9Cn0KCmZ1bmN0aW9uIE5ldy1Wb2x1bWVTaGFkb3dDb3B5CnsKPCMKLlNZTk9QU0lTCgogICAgQ3JlYXRlcyBhIG5ldyB2b2x1bWUgc2hhZG93IGNvcHkuCgogICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IE5ldy1Wb2x1bWVTaGFkb3dDb3B5CiAgICBBdXRob3I6IEphcmVkIEF0a2luc29uIChAamFyZWRjYXRraW5zb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgouREVTQ1JJUFRJT04KCiAgICBOZXctVm9sdW1lU2hhZG93Q29weSBjcmVhdGVzIGEgdm9sdW1lIHNoYWRvdyBjb3B5IGZvciB0aGUgc3BlY2lmaWVkIHZvbHVtZS4KCi5QQVJBTUVURVIgVm9sdW1lCgogICAgVm9sdW1lIHVzZWQgZm9yIHRoZSBzaGFkb3cgY29weS4gVGhpcyB2b2x1bWUgaXMgc29tZXRpbWVzIHJlZmVycmVkIHRvIGFzIHRoZSBvcmlnaW5hbCB2b2x1bWUuIAogICAgVGhlIFZvbHVtZSBwYXJhbWV0ZXIgY2FuIGJlIHNwZWNpZmllZCBhcyBhIHZvbHVtZSBkcml2ZSBsZXR0ZXIsIG1vdW50IHBvaW50LCBvciB2b2x1bWUgZ2xvYmFsbHkgdW5pcXVlIGlkZW50aWZpZXIgKEdVSUQpIG5hbWUuCgouUEFSQU1FVEVSIENvbnRleHQKCiAgICBDb250ZXh0IHRoYXQgdGhlIHByb3ZpZGVyIHVzZXMgd2hlbiBjcmVhdGluZyB0aGUgc2hhZG93LiBUaGUgZGVmYXVsdCBpcyAiQ2xpZW50QWNjZXNzaWJsZSIuCgouRVhBTVBMRQoKICAgIE5ldy1Wb2x1bWVTaGFkb3dDb3B5IC1Wb2x1bWUgQzpcCgogICAgRGVzY3JpcHRpb24KICAgIC0tLS0tLS0tLS0tCiAgICBDcmVhdGVzIGEgbmV3IFZvbHVtZVNoYWRvd0NvcHkgb2YgdGhlIEMgZHJpdmUKIz4KICAgIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZVBhdHRlcm4oJ15cdzpcXCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFZvbHVtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkRmFsc2UpXQogICAgICAgIFtWYWxpZGF0ZVNldCgiQ2xpZW50QWNjZXNzaWJsZSIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbnRleHQgPSAiQ2xpZW50QWNjZXNzaWJsZSIKICAgICkKCiAgICAkVXNlcklkZW50aXR5ID0gKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c1ByaW5jaXBhbF1bU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkKCiAgICBpZiAoLW5vdCAkVXNlcklkZW50aXR5LklzSW5Sb2xlKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0J1aWx0SW5Sb2xlXSdBZG1pbmlzdHJhdG9yJykpCiAgICB7CiAgICAgICAgVGhyb3cgJ1lvdSBtdXN0IHJ1biBHZXQtVm9sdW1lU2hhZG93Q29weSBmcm9tIGFuIGVsZXZhdGVkIGNvbW1hbmQgcHJvbXB0LicKICAgIH0KCiAgICAjIFNhdmUgVlNTIFNlcnZpY2UgaW5pdGlhbCBzdGF0ZQogICAgJHJ1bm5pbmcgPSAoR2V0LVNlcnZpY2UgLU5hbWUgVlNTKS5TdGF0dXMKCiAgICAkY2xhc3MgPSBbV01JQ0xBU1NdInJvb3RcY2ltdjI6d2luMzJfc2hhZG93Y29weSIKCiAgICAkcmV0dXJuID0gJGNsYXNzLmNyZWF0ZSgiJFZvbHVtZSIsICIkQ29udGV4dCIpCgogICAgc3dpdGNoKCRyZXR1cm4ucmV0dXJudmFsdWUpCiAgICB7CiAgICAgICAgMSB7V3JpdGUtRXJyb3IgIkFjY2VzcyBkZW5pZWQuIjsgYnJlYWt9CiAgICAgICAgMiB7V3JpdGUtRXJyb3IgIkludmFsaWQgYXJndW1lbnQuIjsgYnJlYWt9CiAgICAgICAgMyB7V3JpdGUtRXJyb3IgIlNwZWNpZmllZCB2b2x1bWUgbm90IGZvdW5kLiI7IGJyZWFrfQogICAgICAgIDQge1dyaXRlLUVycm9yICJTcGVjaWZpZWQgdm9sdW1lIG5vdCBzdXBwb3J0ZWQuIjsgYnJlYWt9CiAgICAgICAgNSB7V3JpdGUtRXJyb3IgIlVuc3VwcG9ydGVkIHNoYWRvdyBjb3B5IGNvbnRleHQuIjsgYnJlYWt9CiAgICAgICAgNiB7V3JpdGUtRXJyb3IgIkluc3VmZmljaWVudCBzdG9yYWdlLiI7IGJyZWFrfQogICAgICAgIDcge1dyaXRlLUVycm9yICJWb2x1bWUgaXMgaW4gdXNlLiI7IGJyZWFrfQogICAgICAgIDgge1dyaXRlLUVycm9yICJNYXhpbXVtIG51bWJlciBvZiBzaGFkb3cgY29waWVzIHJlYWNoZWQuIjsgYnJlYWt9CiAgICAgICAgOSB7V3JpdGUtRXJyb3IgIkFub3RoZXIgc2hhZG93IGNvcHkgb3BlcmF0aW9uIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIjsgYnJlYWt9CiAgICAgICAgMTAge1dyaXRlLUVycm9yICJTaGFkb3cgY29weSBwcm92aWRlciB2ZXRvZWQgdGhlIG9wZXJhdGlvbi4iOyBicmVha30KICAgICAgICAxMSB7V3JpdGUtRXJyb3IgIlNoYWRvdyBjb3B5IHByb3ZpZGVyIG5vdCByZWdpc3RlcmVkLiI7IGJyZWFrfQogICAgICAgIDEyIHtXcml0ZS1FcnJvciAiU2hhZG93IGNvcHkgcHJvdmlkZXIgZmFpbHVyZS4iOyBicmVha30KICAgICAgICAxMyB7V3JpdGUtRXJyb3IgIlVua25vd24gZXJyb3IuIjsgYnJlYWt9CiAgICAgICAgZGVmYXVsdCB7YnJlYWt9CiAgICB9CgogICAgIyBJZiBWU1MgU2VydmljZSB3YXMgU3RvcHBlZCBhdCB0aGUgc3RhcnQsIHJldHVybiBWU1MgdG8gIlN0b3BwZWQiIHN0YXRlCiAgICBpZigkcnVubmluZyAtZXEgIlN0b3BwZWQiKQogICAgewogICAgICAgIFN0b3AtU2VydmljZSAtTmFtZSBWU1MKICAgIH0KfQoKZnVuY3Rpb24gUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkKewo8IwouU1lOT1BTSVMKCiAgICBEZWxldGVzIGEgdm9sdW1lIHNoYWRvdyBjb3B5LgoKICAgIFBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBSZW1vdmUtVm9sdW1lU2hhZG93Q29weQogICAgQXV0aG9yOiBKYXJlZCBBdGtpbnNvbiAoQGphcmVkY2F0a2luc29uKQogICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIE9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQoKLkRFU0NSSVBUSU9OCgogICAgUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkgZGVsZXRlcyBhIHZvbHVtZSBzaGFkb3cgY29weSBmcm9tIHRoZSBzeXN0ZW0uCgouUEFSQU1FVEVSIElucHV0T2JqZWN0CgogICAgU3BlY2lmaWVzIHRoZSBXaW4zMl9TaGFkb3dDb3B5IG9iamVjdCB0byByZW1vdmUKCi5QQVJBTUVURVIgRGV2aWNlUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgdm9sdW1lIHNoYWRvdyBjb3B5ICdEZXZpY2VPYmplY3QnIHBhdGguIFRoaXMgcGF0aCBjYW4gYmUgcmV0cmlldmVkIHdpdGggdGhlIEdldC1Wb2x1bWVTaGFkb3dDb3B5IFBvd2VyU3Bsb2l0IGZ1bmN0aW9uIG9yIHdpdGggdGhlIFdpbjMyX1NoYWRvd0NvcHkgb2JqZWN0LgoKLkVYQU1QTEUKCiAgICBHZXQtVm9sdW1lU2hhZG93Q29weSB8IFJlbW92ZS1Wb2x1bWVTaGFkb3dDb3B5CgogICAgRGVzY3JpcHRpb24KICAgIC0tLS0tLS0tLS0tCiAgICBSZW1vdmVzIGFsbCB2b2x1bWUgc2hhZG93IGNvcHkKCi5FWEFNUExFCgogICAgUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkgLURldmljZVBhdGggJ1xcP1xHTE9CQUxST09UXERldmljZVxIYXJkZGlza1ZvbHVtZVNoYWRvd0NvcHk0JwoKICAgIERlc2NyaXB0aW9uCiAgICAtLS0tLS0tLS0tLQogICAgUmVtb3ZlcyB0aGUgdm9sdW1lIHNoYWRvdyBjb3B5IGF0IHRoZSAnRGV2aWNlT2JqZWN0JyBwYXRoIFxcP1xHTE9CQUxST09UXERldmljZUhhcmRkaXNrVm9sdW1lU2hhZG93Q29weTQKIz4KICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2VzcyA9ICRUcnVlKV0KICAgIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZVBhdHRlcm4oJ15cXFxcXD9cXEdMT0JBTFJPT1RcXERldmljZVxcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5WzAtOV17MSwzfSQnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREZXZpY2VQYXRoCiAgICApCgogICAgUFJPQ0VTUwogICAgewogICAgICAgIGlmKCRQU0NtZGxldC5TaG91bGRQcm9jZXNzKCJUaGUgVm9sdW1lU2hhZG93Q29weSBhdCBEZXZpY2VQYXRoICREZXZpY2VQYXRoIHdpbGwgYmUgcmVtb3ZlZCIpKQogICAgICAgIHsKICAgICAgICAgICAgKEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSByb290XGNpbXYyIC1DbGFzcyBXaW4zMl9TaGFkb3dDb3B5IHwgV2hlcmUtT2JqZWN0IHskXy5EZXZpY2VPYmplY3QgLWVxICREZXZpY2VQYXRofSkuRGVsZXRlKCkKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIE1vdW50LVZvbHVtZVNoYWRvd0NvcHkKewo8IwouU1lOT1BTSVMKCiAgICBNb3VudHMgYSB2b2x1bWUgc2hhZG93IGNvcHkuCgogICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IE1vdW50LVZvbHVtZVNoYWRvd0NvcHkKICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgouREVTQ1JJUFRJT04KCiAgICBNb3VudC1Wb2x1bWVTaGFkb3dDb3B5IG1vdW50cyBhIHZvbHVtZSBzaGFkb3cgY29weSB2b2x1bWUgYnkgY3JlYXRpbmcgYSBzeW1ib2xpYyBsaW5rLgoKLlBBUkFNRVRFUiBQYXRoCgogICAgU3BlY2lmaWVzIHRoZSBwYXRoIHRvIHdoaWNoIHRoZSBzeW1ib2xpYyBsaW5rIGZvciB0aGUgbW91bnRlZCB2b2x1bWUgc2hhZG93IGNvcHkgd2lsbCBiZSBzYXZlZC4KCi5QQVJBTUVURVIgRGV2aWNlUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgdm9sdW1lIHNoYWRvdyBjb3B5ICdEZXZpY2VPYmplY3QnIHBhdGguIFRoaXMgcGF0aCBjYW4gYmUgcmV0cmlldmVkIHdpdGggdGhlIEdldC1Wb2x1bWVTaGFkb3dDb3B5IFBvd2VyU3Bsb2l0IGZ1bmN0aW9uIG9yIHdpdGggdGhlIFdpbjMyX1NoYWRvd0NvcHkgb2JqZWN0LgoKLkVYQU1QTEUKCiAgICBHZXQtVm9sdW1lU2hhZG93Q29weSB8IE1vdW50LVZvbHVtZVNoYWRvd0NvcHkgLVBhdGggQzpcVlNTCgogICAgRGVzY3JpcHRpb24KICAgIC0tLS0tLS0tLS0tCiAgICBDcmVhdGUgYSBtb3VudCBwb2ludCBpbiAnQzpcVlNTJyBmb3IgZWFjaCB2b2x1bWUgc2hhZG93IGNvcHkgdm9sdW1lCgouRVhBTVBMRQoKICAgIE1vdW50LVZvbHVtZVNoYWRvd0NvcHkgLVBhdGggQzpcVlNTIC1EZXZpY2VQYXRoICdcXD9cR0xPQkFMUk9PVFxEZXZpY2VcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5NCcKCi5FWEFNUExFCgogICAgR2V0LVdtaU9iamVjdCBXaW4zMl9TaGFkb3dDb3B5IHwgJSB7ICRfLkRldmljZU9iamVjdCAtUGF0aCBDOlxWU1MgLURldmljZVBhdGggJF8gfQojPgoKICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZVBhdHRlcm4oJ15cXFxcXD9cXEdMT0JBTFJPT1RcXERldmljZVxcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5WzAtOV17MSwzfSQnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJERldmljZVBhdGgKICAgICkKCiAgICBCRUdJTgogICAgewogICAgICAgICRVc2VySWRlbnRpdHkgPSAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQoKICAgICAgICBpZiAoLW5vdCAkVXNlcklkZW50aXR5LklzSW5Sb2xlKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0J1aWx0SW5Sb2xlXSdBZG1pbmlzdHJhdG9yJykpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnWW91IG11c3QgcnVuIEdldC1Wb2x1bWVTaGFkb3dDb3B5IGZyb20gYW4gZWxldmF0ZWQgY29tbWFuZCBwcm9tcHQuJwogICAgICAgIH0KCiAgICAgICAgIyBWYWxpZGF0ZSB0aGF0IHRoZSBwYXRoIGV4aXN0cyBiZWZvcmUgcHJvY2VlZGluZwogICAgICAgIEdldC1DaGlsZEl0ZW0gJFBhdGggLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbAoKICAgICAgICAkRHluQXNzZW1ibHkgPSBOZXctT2JqZWN0IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnVlNTVXRpbCcpCiAgICAgICAgJEFzc2VtYmx5QnVpbGRlciA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgkRHluQXNzZW1ibHksIFtSZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQogICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdWU1NVdGlsJywgJEZhbHNlKQoKICAgICAgICAjIERlZmluZSBbVlNTLktlcm5lbDMyXTo6Q3JlYXRlU3ltYm9saWNMaW5rIG1ldGhvZCB1c2luZyByZWZsZWN0aW9uCiAgICAgICAgIyAoaS5lLiBub25lIG9mIHRoZSBmb3JlbnNpYyBhcnRpZmFjdHMgbGVmdCB3aXRoIHVzaW5nIEFkZC1UeXBlKQogICAgICAgICRUeXBlQnVpbGRlciA9ICRNb2R1bGVCdWlsZGVyLkRlZmluZVR5cGUoJ1ZTUy5LZXJuZWwzMicsICdQdWJsaWMsIENsYXNzJykKICAgICAgICAkUEludm9rZU1ldGhvZCA9ICRUeXBlQnVpbGRlci5EZWZpbmVQSW52b2tlTWV0aG9kKCdDcmVhdGVTeW1ib2xpY0xpbmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAna2VybmVsMzIuZGxsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFtSZWZsZWN0aW9uLk1ldGhvZEF0dHJpYnV0ZXNdOjpQdWJsaWMgLWJvciBbUmVmbGVjdGlvbi5NZXRob2RBdHRyaWJ1dGVzXTo6U3RhdGljKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtCb29sXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1R5cGVbXV1AKFtTdHJpbmddLCBbU3RyaW5nXSwgW1VJbnQzMl0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKICAgICAgICAkRGxsSW1wb3J0Q29uc3RydWN0b3IgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuRGxsSW1wb3J0QXR0cmlidXRlXS5HZXRDb25zdHJ1Y3RvcihAKFtTdHJpbmddKSkKICAgICAgICAkU2V0TGFzdEVycm9yID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkRsbEltcG9ydEF0dHJpYnV0ZV0uR2V0RmllbGQoJ1NldExhc3RFcnJvcicpCiAgICAgICAgJFNldExhc3RFcnJvckN1c3RvbUF0dHJpYnV0ZSA9IE5ldy1PYmplY3QgUmVmbGVjdGlvbi5FbWl0LkN1c3RvbUF0dHJpYnV0ZUJ1aWxkZXIoJERsbEltcG9ydENvbnN0cnVjdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEAoJ2tlcm5lbDMyLmRsbCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSZWZsZWN0aW9uLkZpZWxkSW5mb1tdXUAoJFNldExhc3RFcnJvciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQCgkdHJ1ZSkpCiAgICAgICAgJFBJbnZva2VNZXRob2QuU2V0Q3VzdG9tQXR0cmlidXRlKCRTZXRMYXN0RXJyb3JDdXN0b21BdHRyaWJ1dGUpCgogICAgICAgICRLZXJuZWwzMlR5cGUgPSAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCiAgICB9CgogICAgUFJPQ0VTUwogICAgewogICAgICAgIGZvcmVhY2ggKCRWb2x1bWUgaW4gJERldmljZVBhdGgpCiAgICAgICAgewogICAgICAgICAgICAkVm9sdW1lIC1tYXRjaCAnXlxcXFxcP1xcR0xPQkFMUk9PVFxcRGV2aWNlXFwoPzxMaW5rTmFtZT5IYXJkZGlza1ZvbHVtZVNoYWRvd0NvcHlbMC05XXsxLDN9KSQnIHwgT3V0LU51bGwKICAgICAgICAgICAgCiAgICAgICAgICAgICRMaW5rUGF0aCA9IEpvaW4tUGF0aCAkUGF0aCAkTWF0Y2hlcy5MaW5rTmFtZQoKICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkTGlua1BhdGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIickTGlua1BhdGgnIGFscmVhZHkgZXhpc3RzLiIKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgtbm90ICRLZXJuZWwzMlR5cGU6OkNyZWF0ZVN5bWJvbGljTGluaygkTGlua1BhdGgsICIkKCRWb2x1bWUpXCIsIDEpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiU3ltYm9saWMgbGluayBjcmVhdGlvbiBmYWlsZWQgZm9yICckVm9sdW1lJy4iCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBHZXQtSXRlbSAkTGlua1BhdGgKICAgICAgICB9CiAgICB9CgogICAgRU5ECiAgICB7CgogICAgfQp9Cg==
