Get-VaultCredential.ps1,2a58dd67171bad9b5b5076ad8df077b2,Scan result is 32768. IsMalware: 1,w6/Cu8K/ZnVuY3Rpb24gR2V0LVZhdWx0Q3JlZGVudGlhbAp7CjwjCi5TWU5PUFNJUwoKRGlzcGxheXMgV2luZG93cyB2YXVsdCBjcmVkZW50aWFsIG9iamVjdHMgaW5jbHVkaW5nIGNsZWFydGV4dCB3ZWIgY3JlZGVudGlhbHMuCgpQb3dlclNwbG9pdCBGdW5jdGlvbjogR2V0LVZhdWx0Q3JlZGVudGlhbApBdXRob3I6IE1hdHRoZXcgR3JhZWJlciAoQG1hdHRpZmVzdGF0aW9uKQpMaWNlbnNlOiBCU0QgMy1DbGF1c2UKUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCk9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQogCi5ERVNDUklQVElPTgoKR2V0LVZhdWx0Q3JlZGVudGlhbCBlbnVtZXJhdGVzIGFuZCBkaXNwbGF5cyBhbGwgY3JlZGVudGlhbHMgc3RvcmVkIGluIHRoZSBXaW5kb3dzCnZhdWx0LiBXZWIgY3JlZGVudGlhbHMsIHNwZWNpZmljYWxseSBhcmUgZGlzcGxheWVkIGluIGNsZWFydGV4dC4gVGhpcyBzY3JpcHQgd2FzCmluc3BpcmVkIGJ5IHRoZSBmb2xsb3dpbmcgQyBpbXBsZW1lbnRhdGlvbjogaHR0cDovL3d3dy5veGlkLml0L2Rvd25sb2Fkcy92YXVsdGR1bXAudHh0CgouRVhBTVBMRQoKR2V0LVZhdWx0Q3JlZGVudGlhbAoKLk5PVEVTCgpPbmx5IHdlYiBjcmVkZW50aWFscyBjYW4gYmUgZGlzcGxheWVkIGluIGNsZWFydGV4dC4KIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldIFBhcmFtKCkKCiAgICAkT1NWZXJzaW9uID0gW0Vudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24KICAgICRPU01ham9yID0gJE9TVmVyc2lvbi5NYWpvcgogICAgJE9TTWlub3IgPSAkT1NWZXJzaW9uLk1pbm9yCgogICAgI3JlZ2lvbiBQL0ludm9rZSBkZWNsYXJhdGlvbnMgZm9yIHZhdWx0Y2xpLmRsbAogICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseU5hbWUoJ1ZhdWx0VXRpbCcpCiAgICAkQXNzZW1ibHlCdWlsZGVyID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1JlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCiAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnVmF1bHRVdGlsJywgJEZhbHNlKQoKICAgICRFbnVtQnVpbGRlciA9ICRNb2R1bGVCdWlsZGVyLkRlZmluZUVudW0oJ1ZhdWx0TGliLlZBVUxUX0VMRU1FTlRfVFlQRScsICdQdWJsaWMnLCBbSW50MzJdKQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnVW5kZWZpbmVkJywgLTEpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdCb29sZWFuJywgMCkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1Nob3J0JywgMSkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1Vuc2lnbmVkU2hvcnQnLCAyKQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnSW50JywgMykKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1Vuc2lnbmVkSW50JywgNCkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ0RvdWJsZScsIDUpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdHdWlkJywgNikKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1N0cmluZycsIDcpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdCeXRlQXJyYXknLCA4KQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnVGltZVN0YW1wJywgOSkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1Byb3RlY3RlZEFycmF5JywgMTApCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdBdHRyaWJ1dGUnLCAxMSkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1NpZCcsIDEyKQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnTGFzdCcsIDEzKQogICAgJFZBVUxUX0VMRU1FTlRfVFlQRSA9ICRFbnVtQnVpbGRlci5DcmVhdGVUeXBlKCkKCiAgICAkRW51bUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVFbnVtKCdWYXVsdExpYi5WQVVMVF9TQ0hFTUFfRUxFTUVOVF9JRCcsICdQdWJsaWMnLCBbSW50MzJdKQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnSWxsZWdhbCcsIDApCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdSZXNvdXJjZScsIDEpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdJZGVudGl0eScsIDIpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdBdXRoZW50aWNhdG9yJywgMykKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ1RhZycsIDQpCiAgICAkbnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCdQYWNrYWdlU2lkJywgNSkKICAgICRudWxsID0gJEVudW1CdWlsZGVyLkRlZmluZUxpdGVyYWwoJ0FwcFN0YXJ0JywgMTAwKQogICAgJG51bGwgPSAkRW51bUJ1aWxkZXIuRGVmaW5lTGl0ZXJhbCgnQXBwRW5kJywgMTAwMDApCiAgICAkVkFVTFRfU0NIRU1BX0VMRU1FTlRfSUQgPSAkRW51bUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCgogICAgJExheW91dENvbnN0cnVjdG9yID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLlN0cnVjdExheW91dEF0dHJpYnV0ZV0uR2V0Q29uc3RydWN0b3IoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkxheW91dEtpbmRdKQogICAgJENoYXJzZXRGaWVsZCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5TdHJ1Y3RMYXlvdXRBdHRyaWJ1dGVdLkdldEZpZWxkKCdDaGFyU2V0JykKICAgICRTdHJ1Y3RMYXlvdXRDdXN0b21BdHRyaWJ1dGUgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uRW1pdC5DdXN0b21BdHRyaWJ1dGVCdWlsZGVyKCRMYXlvdXRDb25zdHJ1Y3RvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkxheW91dEtpbmRdOjpFeHBsaWNpdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQ2hhcnNldEZpZWxkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkFuc2kpKQogICAgJFN0cnVjdEF0dHJpYnV0ZXMgPSAnQXV0b0xheW91dCwgQW5zaUNsYXNzLCBDbGFzcywgUHVibGljLCBTZXF1ZW50aWFsTGF5b3V0LCBTZWFsZWQsIEJlZm9yZUZpZWxkSW5pdCcKCiAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdWYXVsdExpYi5WQVVMVF9JVEVNJywgJFN0cnVjdEF0dHJpYnV0ZXMsIFtPYmplY3RdLCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5QYWNraW5nU2l6ZV06OlNpemU0KQogICAgJG51bGwgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lRmllbGQoJ1NjaGVtYUlkJywgW0d1aWRdLCAnUHVibGljJykKICAgICRudWxsID0gJFR5cGVCdWlsZGVyLkRlZmluZUZpZWxkKCdwc3pDcmVkZW50aWFsRnJpZW5kbHlOYW1lJywgW0ludFB0cl0sICdQdWJsaWMnKQogICAgJG51bGwgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lRmllbGQoJ3BSZXNvdXJjZUVsZW1lbnQnLCBbSW50UHRyXSwgJ1B1YmxpYycpCiAgICAkbnVsbCA9ICRUeXBlQnVpbGRlci5EZWZpbmVGaWVsZCgncElkZW50aXR5RWxlbWVudCcsIFtJbnRQdHJdLCAnUHVibGljJykKICAgICRudWxsID0gJFR5cGVCdWlsZGVyLkRlZmluZUZpZWxkKCdwQXV0aGVudGljYXRvckVsZW1lbnQnLCBbSW50UHRyXSwgJ1B1YmxpYycpCiAgICBpZiAoJE9TTWFqb3IgLWdlIDYgLWFuZCAkT1NNaW5vciAtZ2UgMikKICAgIHsKICAgICAgICAkbnVsbCA9ICRUeXBlQnVpbGRlci5EZWZpbmVGaWVsZCgncFBhY2thZ2VTaWQnLCBbSW50UHRyXSwgJ1B1YmxpYycpCiAgICB9CiAgICAkbnVsbCA9ICRUeXBlQnVpbGRlci5EZWZpbmVGaWVsZCgnTGFzdE1vZGlmaWVkJywgW1VJbnQ2NF0sICdQdWJsaWMnKQogICAgJG51bGwgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lRmllbGQoJ2R3RmxhZ3MnLCBbVUludDMyXSwgJ1B1YmxpYycpCiAgICAkbnVsbCA9ICRUeXBlQnVpbGRlci5EZWZpbmVGaWVsZCgnZHdQcm9wZXJ0aWVzQ291bnQnLCBbVUludDMyXSwgJ1B1YmxpYycpCiAgICAkbnVsbCA9ICRUeXBlQnVpbGRlci5EZWZpbmVGaWVsZCgncFByb3BlcnR5RWxlbWVudHMnLCBbSW50UHRyXSwgJ1B1YmxpYycpCiAgICAkVkFVTFRfSVRFTSA9ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKCiAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdWYXVsdExpYi5WQVVMVF9JVEVNX0VMRU1FTlQnLCAkU3RydWN0QXR0cmlidXRlcykKICAgICRUeXBlQnVpbGRlci5TZXRDdXN0b21BdHRyaWJ1dGUoJFN0cnVjdExheW91dEN1c3RvbUF0dHJpYnV0ZSkKICAgICRudWxsID0gJFR5cGVCdWlsZGVyLkRlZmluZUZpZWxkKCdTY2hlbWFFbGVtZW50SWQnLCAkVkFVTFRfU0NIRU1BX0VMRU1FTlRfSUQsICdQdWJsaWMnKS5TZXRPZmZzZXQoMCkKICAgICRudWxsID0gJFR5cGVCdWlsZGVyLkRlZmluZUZpZWxkKCdUeXBlJywgJFZBVUxUX0VMRU1FTlRfVFlQRSwgJ1B1YmxpYycpLlNldE9mZnNldCg4KQogICAgJFZBVUxUX0lURU1fRUxFTUVOVCA9ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKCgogICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnVmF1bHRMaWIuVmF1bHRjbGknLCAnUHVibGljLCBDbGFzcycpCiAgICAkUEludm9rZU1ldGhvZCA9ICRUeXBlQnVpbGRlci5EZWZpbmVQSW52b2tlTWV0aG9kKCdWYXVsdE9wZW5WYXVsdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXVsdGNsaS5kbGwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUHVibGljLCBTdGF0aWMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1R5cGVbXV0gQChbR3VpZF0uTWFrZUJ5UmVmVHlwZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtVSW50MzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OldpbmFwaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNoYXJTZXRdOjpBdXRvKQoKICAgICRQSW52b2tlTWV0aG9kID0gJFR5cGVCdWlsZGVyLkRlZmluZVBJbnZva2VNZXRob2QoJ1ZhdWx0Q2xvc2VWYXVsdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXVsdGNsaS5kbGwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUHVibGljLCBTdGF0aWMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1R5cGVbXV0gQChbSW50UHRyXS5NYWtlQnlSZWZUeXBlKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKCiAgICAkUEludm9rZU1ldGhvZCA9ICRUeXBlQnVpbGRlci5EZWZpbmVQSW52b2tlTWV0aG9kKCdWYXVsdEZyZWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmF1bHRjbGkuZGxsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1B1YmxpYywgU3RhdGljJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnQzMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtUeXBlW11dIEAoW0ludFB0cl0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKCiAgICAkUEludm9rZU1ldGhvZCA9ICRUeXBlQnVpbGRlci5EZWZpbmVQSW52b2tlTWV0aG9kKCdWYXVsdEVudW1lcmF0ZVZhdWx0cycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXVsdGNsaS5kbGwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUHVibGljLCBTdGF0aWMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1R5cGVbXV0gQChbSW50MzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OldpbmFwaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNoYXJTZXRdOjpBdXRvKQoKICAgICRQSW52b2tlTWV0aG9kID0gJFR5cGVCdWlsZGVyLkRlZmluZVBJbnZva2VNZXRob2QoJ1ZhdWx0RW51bWVyYXRlSXRlbXMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmF1bHRjbGkuZGxsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1B1YmxpYywgU3RhdGljJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnQzMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtUeXBlW11dIEAoW0ludFB0cl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50UHRyXS5NYWtlQnlSZWZUeXBlKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKCiAgICBpZiAoJE9TTWFqb3IgLWdlIDYgLWFuZCAkT1NNaW5vciAtZ2UgMikKICAgIHsKICAgICAgICAkUEludm9rZU1ldGhvZCA9ICRUeXBlQnVpbGRlci5EZWZpbmVQSW52b2tlTWV0aG9kKCdWYXVsdEdldEl0ZW0nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhdWx0Y2xpLmRsbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUHVibGljLCBTdGF0aWMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50MzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1R5cGVbXV0gQChbSW50UHRyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0d1aWRdLk1ha2VCeVJlZlR5cGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludFB0cl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50UHRyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludFB0cl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnQzMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkF1dG8pCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJFBJbnZva2VNZXRob2QgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lUEludm9rZU1ldGhvZCgnVmF1bHRHZXRJdGVtJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXVsdGNsaS5kbGwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1B1YmxpYywgU3RhdGljJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtUeXBlW11dIEAoW0ludFB0cl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtHdWlkXS5NYWtlQnlSZWZUeXBlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50UHRyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludFB0cl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnQzMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dOjpXaW5hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkF1dG8pCiAgICB9CgogICAgJFZhdWx0Y2xpID0gJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQogICAgI2VuZHJlZ2lvbgoKICAgICMgSGVscGVyIGZ1bmN0aW9uIHRvIGV4dHJhY3QgdGhlIEl0ZW1WYWx1ZSBmaWVsZCBmcm9tIGEgVkFVTFRfSVRFTV9FTEVNRU5UIHN0cnVjdC4KICAgIGZ1bmN0aW9uIGxvY2FsOkdldC1WYXVsdEVsZW1lbnRWYWx1ZQogICAgewogICAgICAgIFBhcmFtICgKICAgICAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHskXyAtbmUgW0ludFB0cl06Olplcm99KV0KICAgICAgICAgICAgW0ludFB0cl0KICAgICAgICAgICAgJFZhdWx0RWxlbWVudFB0cgogICAgICAgICkKCiAgICAgICAgJFBhcnRpYWxFbGVtZW50ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpQdHJUb1N0cnVjdHVyZSgkVmF1bHRFbGVtZW50UHRyLCBbVHlwZV0gJFZBVUxUX0lURU1fRUxFTUVOVCkKICAgICAgICAkRWxlbWVudFB0ciA9IFtJbnRQdHJdICgkVmF1bHRFbGVtZW50UHRyLlRvSW50NjQoKSArIDE2KQoKICAgICAgICBzd2l0Y2ggKCRQYXJ0aWFsRWxlbWVudC5UeXBlKQogICAgICAgIHsKICAgICAgICAgICAgJFZBVUxUX0VMRU1FTlRfVFlQRTo6U3RyaW5nIHsKICAgICAgICAgICAgICAgICRTdHJpbmdQdHIgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlJlYWRJbnRQdHIoW0ludFB0cl0gJEVsZW1lbnRQdHIpCiAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlB0clRvU3RyaW5nVW5pKFtJbnRQdHJdICRTdHJpbmdQdHIpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6OkJvb2xlYW4gewogICAgICAgICAgICAgICAgW0Jvb2xdIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEJ5dGUoW0ludFB0cl0gJEVsZW1lbnRQdHIpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6OlNob3J0IHsKICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDE2KFtJbnRQdHJdICRFbGVtZW50UHRyKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpVbnNpZ25lZFNob3J0IHsKICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDE2KFtJbnRQdHJdICRFbGVtZW50UHRyKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpJbnQgewogICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpSZWFkSW50MzIoW0ludFB0cl0gJEVsZW1lbnRQdHIpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6OlVuc2lnbmVkSW50IHsKICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDMyKFtJbnRQdHJdICRFbGVtZW50UHRyKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpEb3VibGUgewogICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpQdHJUb1N0cnVjdHVyZSgkRWxlbWVudFB0ciwgW1R5cGVdIFtEb3VibGVdKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpHdWlkIHsKICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJ1Y3R1cmUoJEVsZW1lbnRQdHIsIFtUeXBlXSBbR3VpZF0pCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6OlNpZCB7CiAgICAgICAgICAgICAgICAkU2lkUHRyID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpSZWFkSW50UHRyKFtJbnRQdHJdICRFbGVtZW50UHRyKQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiMHgkKCRTaWRQdHIuVG9TdHJpbmcoJ1g4JykpIgogICAgICAgICAgICAgICAgJFNpZE9iamVjdCA9IFtTZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyXSAoW0ludFB0cl0gJFNpZFB0cikKICAgICAgICAgICAgICAgICRTaWRPYmplY3QuVmFsdWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBUaGVzZSBlbGVtZW50cyBhcmUgY3VycmVudGx5IHVuaW1wbGVtZW50ZWQuCiAgICAgICAgICAgICMgSSBoYXZlIHlldCB0byBzZWUgdGhlc2UgdXNlZCBpbiBwcmFjdGljZS4KICAgICAgICAgICAgJFZBVUxUX0VMRU1FTlRfVFlQRTo6Qnl0ZUFycmF5IHsgJG51bGwgfQogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpUaW1lU3RhbXAgeyAkbnVsbCB9CiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6OlByb3RlY3RlZEFycmF5IHsgJG51bGwgfQogICAgICAgICAgICAkVkFVTFRfRUxFTUVOVF9UWVBFOjpBdHRyaWJ1dGUgeyAkbnVsbCB9CiAgICAgICAgICAgICRWQVVMVF9FTEVNRU5UX1RZUEU6Okxhc3QgeyAkbnVsbCB9CiAgICAgICAgfQogICAgfQoKICAgICRWYXVsdENvdW50ID0gMAogICAgJFZhdWx0R3VpZFB0ciA9IFtJbnRQdHJdOjpaZXJvCiAgICAkUmVzdWx0ID0gJFZhdWx0Y2xpOjpWYXVsdEVudW1lcmF0ZVZhdWx0cygwLCBbUmVmXSAkVmF1bHRDb3VudCwgW1JlZl0gJFZhdWx0R3VpZFB0cikKCiAgICBpZiAoJFJlc3VsdCAtbmUgMCkKICAgIHsKICAgICAgICB0aHJvdyAiVW5hYmxlIHRvIGVudW1lcmF0ZSB2YXVsdHMuIEVycm9yICgweCQoJFJlc3VsdC5Ub1N0cmluZygnWDgnKSkpIgogICAgfQoKICAgICRHdWlkQWRkcmVzcyA9ICRWYXVsdEd1aWRQdHIKCiAgICAkVmF1bHRTY2hlbWEgPSBAewogICAgICAgIChbR3VpZF0gJzJGMUE2NTA0LTA2NDEtNDRDRi04QkI1LTM2MTJEODY1RjJFNScpID0gJ1dpbmRvd3MgU2VjdXJlIE5vdGUnCiAgICAgICAgKFtHdWlkXSAnM0NDRDU0OTktODdBOC00QjEwLUEyMTUtNjA4ODg4REQzQjU1JykgPSAnV2luZG93cyBXZWIgUGFzc3dvcmQgQ3JlZGVudGlhbCcKICAgICAgICAoW0d1aWRdICcxNTRFMjNEMC1DNjQ0LTRFNkYtOENFNi01MDY5MjcyRjk5OUYnKSA9ICdXaW5kb3dzIENyZWRlbnRpYWwgUGlja2VyIFByb3RlY3RvcicKICAgICAgICAoW0d1aWRdICc0QkY0QzQ0Mi05QjhBLTQxQTAtQjM4MC1ERDRBNzA0RERCMjgnKSA9ICdXZWIgQ3JlZGVudGlhbHMnCiAgICAgICAgKFtHdWlkXSAnNzdCQzU4MkItRjBBNi00RTE1LTRFODAtNjE3MzZCNkYzQjI5JykgPSAnV2luZG93cyBDcmVkZW50aWFscycKICAgICAgICAoW0d1aWRdICdFNjlENzgzOC05MUI1LTRGQzktODlENS0yMzBENEQ0Q0MyQkMnKSA9ICdXaW5kb3dzIERvbWFpbiBDZXJ0aWZpY2F0ZSBDcmVkZW50aWFsJwogICAgICAgIChbR3VpZF0gJzNFMEUzNUJFLTFCNzctNDNFNy1CODczLUFFRDkwMUI2Mjc1QicpID0gJ1dpbmRvd3MgRG9tYWluIFBhc3N3b3JkIENyZWRlbnRpYWwnCiAgICAgICAgKFtHdWlkXSAnM0M4ODZGRjMtMjY2OS00QUEyLUE4RkItM0Y2NzU5QTc3NTQ4JykgPSAnV2luZG93cyBFeHRlbmRlZCBDcmVkZW50aWFsJwogICAgICAgIChbR3VpZF0gJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpID0gJG51bGwKICAgIH0KCiAgICBpZiAoJFZhdWx0Q291bnQpCiAgICB7CiAgICAgICAgZm9yZWFjaCAoJGkgaW4gMS4uJFZhdWx0Q291bnQpCiAgICAgICAgewogICAgICAgICAgICAkVmF1bHRHdWlkID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpQdHJUb1N0cnVjdHVyZSgkR3VpZEFkZHJlc3MsIFtUeXBlXSBbR3VpZF0pCiAgICAgICAgICAgICRHdWlkQWRkcmVzcyA9IFtJbnRQdHJdICgkR3VpZEFkZHJlc3MuVG9JbnQ2NCgpICsgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTaXplT2YoW1R5cGVdIFtHdWlkXSkpCgogICAgICAgICAgICAkVmF1bHRIYW5kbGUgPSBbSW50UHRyXTo6WmVybwoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiT3BlbmluZyB2YXVsdCAtICQoJFZhdWx0U2NoZW1hWyRWYXVsdEd1aWRdKSAoJCgkVmF1bHRHdWlkKSkiCgogICAgICAgICAgICAkUmVzdWx0ID0gJFZhdWx0Y2xpOjpWYXVsdE9wZW5WYXVsdChbUmVmXSAkVmF1bHRHdWlkLCAwLCBbUmVmXSAkVmF1bHRIYW5kbGUpCgogICAgICAgICAgICBpZiAoJFJlc3VsdCAtbmUgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIlVuYWJsZSB0byBvcGVuIHRoZSBmb2xsb3dpbmcgdmF1bHQ6ICQoJFZhdWx0U2NoZW1hWyRWYXVsdEd1aWRdKS4gRXJyb3IgKDB4JCgkUmVzdWx0LlRvU3RyaW5nKCdYOCcpKSkiCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVmF1bHRJdGVtQ291bnQgPSAwCiAgICAgICAgICAgICRWYXVsdEl0ZW1QdHIgPSBbSW50UHRyXTo6WmVybwoKICAgICAgICAgICAgJFJlc3VsdCA9ICRWYXVsdGNsaTo6VmF1bHRFbnVtZXJhdGVJdGVtcygkVmF1bHRIYW5kbGUsIDUxMiwgW1JlZl0gJFZhdWx0SXRlbUNvdW50LCBbUmVmXSAkVmF1bHRJdGVtUHRyKQoKICAgICAgICAgICAgaWYgKCRSZXN1bHQgLW5lIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRudWxsID0gJFZhdWx0Y2xpOjpWYXVsdENsb3NlVmF1bHQoW1JlZl0gJFZhdWx0SGFuZGxlKQogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIlVuYWJsZSB0byBlbnVtZXJhdGUgdmF1bHQgaXRlbXMgZnJvbSB0aGUgZm9sbG93aW5nIHZhdWx0OiAkKCRWYXVsdFNjaGVtYVskVmF1bHRHdWlkXSkuIEVycm9yICgweCQoJFJlc3VsdC5Ub1N0cmluZygnWDgnKSkpIgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFN0cnVjdEFkZHJlc3MgPSAkVmF1bHRJdGVtUHRyCgogICAgICAgICAgICBpZiAoJFZhdWx0SXRlbUNvdW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkaiBpbiAxLi4kVmF1bHRJdGVtQ291bnQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJEN1cnJlbnRJdGVtID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpQdHJUb1N0cnVjdHVyZSgkU3RydWN0QWRkcmVzcywgW1R5cGVdICRWQVVMVF9JVEVNKQogICAgICAgICAgICAgICAgICAgICRTdHJ1Y3RBZGRyZXNzID0gW0ludFB0cl0gKCRTdHJ1Y3RBZGRyZXNzLlRvSW50NjQoKSArIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6U2l6ZU9mKFtUeXBlXSAkVkFVTFRfSVRFTSkpCgogICAgICAgICAgICAgICAgICAgICRQYXNzd29yZFZhdWx0SXRlbSA9IFtJbnRQdHJdOjpaZXJvCgogICAgICAgICAgICAgICAgICAgIGlmICgkT1NNYWpvciAtZ2UgNiAtYW5kICRPU01pbm9yIC1nZSAyKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9ICRWYXVsdGNsaTo6VmF1bHRHZXRJdGVtKCRWYXVsdEhhbmRsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSZWZdICRDdXJyZW50SXRlbS5TY2hlbWFJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRDdXJyZW50SXRlbS5wUmVzb3VyY2VFbGVtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEN1cnJlbnRJdGVtLnBJZGVudGl0eUVsZW1lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQ3VycmVudEl0ZW0ucFBhY2thZ2VTaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbSW50UHRyXTo6WmVybywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmXSAkUGFzc3dvcmRWYXVsdEl0ZW0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHQgPSAkVmF1bHRjbGk6OlZhdWx0R2V0SXRlbSgkVmF1bHRIYW5kbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmXSAkQ3VycmVudEl0ZW0uU2NoZW1hSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQ3VycmVudEl0ZW0ucFJlc291cmNlRWxlbWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRDdXJyZW50SXRlbS5wSWRlbnRpdHlFbGVtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludFB0cl06Olplcm8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZl0gJFBhc3N3b3JkVmF1bHRJdGVtKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJFBhc3N3b3JkSXRlbSA9ICRudWxsCgogICAgICAgICAgICAgICAgICAgIGlmICgkUmVzdWx0IC1uZSAwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIkVycm9yIG9jY3VyZWQgcmV0cmlldmluZyB2YXVsdCBpdGVtLiBFcnJvciAoMHgkKCRSZXN1bHQuVG9TdHJpbmcoJ1g4JykpKSIKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFBhc3N3b3JkSXRlbSA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJ1Y3R1cmUoJFBhc3N3b3JkVmF1bHRJdGVtLCBbVHlwZV0gJFZBVUxUX0lURU0pCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoJFZhdWx0U2NoZW1hLkNvbnRhaW5zS2V5KCRWYXVsdEd1aWQpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFZhdWx0VHlwZSA9ICRWYXVsdFNjaGVtYVskVmF1bHRHdWlkXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkVmF1bHRUeXBlID0gJFZhdWx0R3VpZAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCRQYXNzd29yZEl0ZW0ucEF1dGhlbnRpY2F0b3JFbGVtZW50IC1uZSBbSW50UHRyXTo6WmVybykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRDcmVkZW50aWFsID0gR2V0LVZhdWx0RWxlbWVudFZhbHVlICRQYXNzd29yZEl0ZW0ucEF1dGhlbnRpY2F0b3JFbGVtZW50CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRDcmVkZW50aWFsID0gJG51bGwKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRQYWNrYWdlU2lkID0gJG51bGwKCiAgICAgICAgICAgICAgICAgICAgaWYgKCRDdXJyZW50SXRlbS5wUGFja2FnZVNpZCAtYW5kICgkQ3VycmVudEl0ZW0ucFBhY2thZ2VTaWQgLW5lIFtJbnRQdHJdOjpaZXJvKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRQYWNrYWdlU2lkID0gR2V0LVZhdWx0RWxlbWVudFZhbHVlICRDdXJyZW50SXRlbS5wUGFja2FnZVNpZAogICAgICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0aWVzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgVmF1bHQgPSAkVmF1bHRUeXBlCiAgICAgICAgICAgICAgICAgICAgICAgIFJlc291cmNlID0gaWYgKCRDdXJyZW50SXRlbS5wUmVzb3VyY2VFbGVtZW50KSB7IEdldC1WYXVsdEVsZW1lbnRWYWx1ZSAkQ3VycmVudEl0ZW0ucFJlc291cmNlRWxlbWVudCB9IGVsc2UgeyAkbnVsbCB9CiAgICAgICAgICAgICAgICAgICAgICAgIElkZW50aXR5ID0gaWYgKCRDdXJyZW50SXRlbS5wSWRlbnRpdHlFbGVtZW50KSB7IEdldC1WYXVsdEVsZW1lbnRWYWx1ZSAkQ3VycmVudEl0ZW0ucElkZW50aXR5RWxlbWVudCB9IGVsc2UgeyAkbnVsbCB9CiAgICAgICAgICAgICAgICAgICAgICAgIFBhY2thZ2VTaWQgPSAkUGFja2FnZVNpZAogICAgICAgICAgICAgICAgICAgICAgICBDcmVkZW50aWFsID0gJENyZWRlbnRpYWwKICAgICAgICAgICAgICAgICAgICAgICAgTGFzdE1vZGlmaWVkID0gW0RhdGVUaW1lXTo6RnJvbUZpbGVUaW1lVXRjKCRDdXJyZW50SXRlbS5MYXN0TW9kaWZpZWQpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkVmF1bHRJdGVtID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgJFByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAkVmF1bHRJdGVtLlBTT2JqZWN0LlR5cGVOYW1lc1swXSA9ICdWQVVMVENMSS5WQVVMVElURU0nCgogICAgICAgICAgICAgICAgICAgICRWYXVsdEl0ZW0KCiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSAkVmF1bHRjbGk6OlZhdWx0RnJlZSgkUGFzc3dvcmRWYXVsdEl0ZW0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRudWxsID0gJFZhdWx0Y2xpOjpWYXVsdENsb3NlVmF1bHQoW1JlZl0gJFZhdWx0SGFuZGxlKQogICAgICAgIH0KICAgIH0KfQ==
