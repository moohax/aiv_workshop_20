7-Process Injection-dll.ps1,758d01371e62e638b0391a9dbd5a417f,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLURsbEluamVjdGlvbgp7CjwjCi5TWU5PUFNJUwoKSW5qZWN0cyBhIERsbCBpbnRvIHRoZSBwcm9jZXNzIElEIG9mIHlvdXIgY2hvb3NpbmcuCgpQb3dlclNwbG9pdCBGdW5jdGlvbjogSW52b2tlLURsbEluamVjdGlvbgpBdXRob3I6IE1hdHRoZXcgR3JhZWJlciAoQG1hdHRpZmVzdGF0aW9uKQpMaWNlbnNlOiBCU0QgMy1DbGF1c2UKUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCk9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQoKLkRFU0NSSVBUSU9OCgpJbnZva2UtRGxsSW5qZWN0aW9uIGluamVjdHMgYSBEbGwgaW50byBhbiBhcmJpdHJhcnkgcHJvY2Vzcy4KCi5QQVJBTUVURVIgUHJvY2Vzc0lECgpQcm9jZXNzIElEIG9mIHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBhIERsbCBpbnRvLgoKLlBBUkFNRVRFUiBEbGwKCk5hbWUgb2YgdGhlIGRsbCB0byBpbmplY3QuIFRoaXMgY2FuIGJlIGFuIGFic29sdXRlIG9yIHJlbGF0aXZlIHBhdGguCgouRVhBTVBMRQoKSW52b2tlLURsbEluamVjdGlvbiAtUHJvY2Vzc0lEIDQyNzQgLURsbCBldmlsLmRsbAoKRGVzY3JpcHRpb24KLS0tLS0tLS0tLS0KSW5qZWN0ICdldmlsLmRsbCcgaW50byBwcm9jZXNzIElEIDQyNzQuCgouTk9URVMKClVzZSB0aGUgJy1WZXJib3NlJyBvcHRpb24gdG8gcHJpbnQgZGV0YWlsZWQgaW5mb3JtYXRpb24uCgouTElOSwoKaHR0cDovL3d3dy5leHBsb2l0LW1vbmRheS5jb20KIz4KCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSApXQogICAgICAgIFtJbnRdCiAgICAgICAgJFByb2Nlc3NJRCwKCiAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSApXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERsbAogICAgKQoKICAgICMgQ29uZmlybSB0aGF0IHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBpbnRvIGV4aXN0cwogICAgdHJ5CiAgICB7CiAgICAgICAgR2V0LVByb2Nlc3MgLUlkICRQcm9jZXNzSUQgLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbAogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQWN0aW9uUHJlZmVyZW5jZVN0b3BFeGNlcHRpb25dCiAgICB7CiAgICAgICAgVGhyb3cgIlByb2Nlc3MgZG9lcyBub3QgZXhpc3QhIgogICAgfQogICAgCiAgICAjIENvbmZpcm0gdGhhdCB0aGUgcGF0aCB0byB0aGUgZGxsIGV4aXN0cwogICAgdHJ5CiAgICB7CiAgICAgICAgJERsbCA9IChSZXNvbHZlLVBhdGggJERsbCAtRXJyb3JBY3Rpb24gU3RvcCkuUGF0aAogICAgICAgIFdyaXRlLVZlcmJvc2UgIkZ1bGwgcGF0aCB0byBEbGw6ICREbGwiCiAgICAgICAgJEFzY2lpRW5jb2RlciA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQVNDSUlFbmNvZGluZwogICAgICAgICMgU2F2ZSB0aGUgbmFtZSBvZiB0aGUgZGxsIGluIGFuIGFzY2lpLWVuY29kZWQgZm9ybWF0LiBUaGlzIG5hbWUgd2lsbCBiZSBpbmplY3RlZCBpbnRvIHRoZSByZW1vdGUgcHJvY2Vzcy4KICAgICAgICAkRGxsQnl0ZUFycmF5ID0gJEFzY2lpRW5jb2Rlci5HZXRCeXRlcygkRGxsKQogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQWN0aW9uUHJlZmVyZW5jZVN0b3BFeGNlcHRpb25dCiAgICB7CiAgICAgICAgVGhyb3cgIkludmFsaWQgRGxsIHBhdGghIgogICAgfQoKICAgIGZ1bmN0aW9uIExvY2FsOkdldC1EZWxlZ2F0ZVR5cGUKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW1R5cGVdKV0KICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtUeXBlW11dCiAgICAgICAgICAgICRQYXJhbWV0ZXJzID0gKE5ldy1PYmplY3QgVHlwZVtdKDApKSwKICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICBbVHlwZV0KICAgICAgICAgICAgJFJldHVyblR5cGUgPSBbVm9pZF0KICAgICAgICApCgogICAgICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgICAgICREeW5Bc3NlbWJseSA9IE5ldy1PYmplY3QgU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHlOYW1lKCdSZWZsZWN0ZWREZWxlZ2F0ZScpCiAgICAgICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1N5c3RlbS5SZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQogICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdNeURlbGVnYXRlVHlwZScsICdDbGFzcywgUHVibGljLCBTZWFsZWQsIEFuc2lDbGFzcywgQXV0b0NsYXNzJywgW1N5c3RlbS5NdWx0aWNhc3REZWxlZ2F0ZV0pCiAgICAgICAgJENvbnN0cnVjdG9yQnVpbGRlciA9ICRUeXBlQnVpbGRlci5EZWZpbmVDb25zdHJ1Y3RvcignUlRTcGVjaWFsTmFtZSwgSGlkZUJ5U2lnLCBQdWJsaWMnLCBbU3lzdGVtLlJlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsICRQYXJhbWV0ZXJzKQogICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lTWV0aG9kKCdJbnZva2UnLCAnUHVibGljLCBIaWRlQnlTaWcsIE5ld1Nsb3QsIFZpcnR1YWwnLCAkUmV0dXJuVHlwZSwgJFBhcmFtZXRlcnMpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgCiAgICAgICAgV3JpdGUtT3V0cHV0ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpHZXQtUHJvY0FkZHJlc3MKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW0ludFB0cl0pXQogICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRNb2R1bGUsCiAgICAgICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRQcm9jZWR1cmUKICAgICAgICApCgogICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIFN5c3RlbS5kbGwgaW4gdGhlIEdBQwogICAgICAgICRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICRVbnNhZmVOYXRpdmVNZXRob2RzID0gJFN5c3RlbUFzc2VtYmx5LkdldFR5cGUoJ01pY3Jvc29mdC5XaW4zMi5VbnNhZmVOYXRpdmVNZXRob2RzJykKICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKICAgICAgICAkR2V0UHJvY0FkZHJlc3MgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldFByb2NBZGRyZXNzJykKICAgICAgICAjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAogICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAkdG1wUHRyID0gTmV3LU9iamVjdCBJbnRQdHIKICAgICAgICAkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCiAgICAgICAgCiAgICAgICAgIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCiAgICAgICAgV3JpdGUtT3V0cHV0ICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCiAgICB9CgogICAgZnVuY3Rpb24gTG9jYWw6R2V0LVBFQXJjaGl0ZWN0dXJlCiAgICB7CiAgICAgICAgUGFyYW0KICAgICAgICAoCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJFBhdGgKICAgICAgICApCiAgICAKICAgICAgICAjIFBhcnNlIFBFIGhlYWRlciB0byBzZWUgaWYgYmluYXJ5IHdhcyBjb21waWxlZCAzMiBvciA2NC1iaXQKICAgICAgICAkRmlsZVN0cmVhbSA9IE5ldy1PYmplY3QgU3lzdGVtLklPLkZpbGVTdHJlYW0oJFBhdGgsIFtTeXN0ZW0uSU8uRmlsZU1vZGVdOjpPcGVuLCBbU3lzdGVtLklPLkZpbGVBY2Nlc3NdOjpSZWFkKQogICAgCiAgICAgICAgW0J5dGVbXV0gJE1aSGVhZGVyID0gTmV3LU9iamVjdCBCeXRlW10oMikKICAgICAgICAkRmlsZVN0cmVhbS5SZWFkKCRNWkhlYWRlciwwLDIpIHwgT3V0LU51bGwKICAgIAogICAgICAgICRIZWFkZXIgPSBbU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZ106OkFTQ0lJLkdldFN0cmluZygkTVpIZWFkZXIpCiAgICAgICAgaWYgKCRIZWFkZXIgLW5lICdNWicpCiAgICAgICAgewogICAgICAgICAgICAkRmlsZVN0cmVhbS5DbG9zZSgpCiAgICAgICAgICAgIFRocm93ICdJbnZhbGlkIFBFIGhlYWRlci4nCiAgICAgICAgfQogICAgCiAgICAgICAgIyBTZWVrIHRvIDB4M2MgLSBJTUFHRV9ET1NfSEVBREVSLmVfbGZhbmV3IChpLmUuIE9mZnNldCB0byBQRSBIZWFkZXIpCiAgICAgICAgJEZpbGVTdHJlYW0uU2VlaygweDNjLCBbU3lzdGVtLklPLlNlZWtPcmlnaW5dOjpCZWdpbikgfCBPdXQtTnVsbAogICAgCiAgICAgICAgW0J5dGVbXV0gJGxmYW5ldyA9IE5ldy1PYmplY3QgQnl0ZVtdKDQpCiAgICAKICAgICAgICAjIFJlYWQgb2Zmc2V0IHRvIHRoZSBQRSBIZWFkZXIgKHdpbGwgYmUgcmVhZCBpbiByZXZlcnNlKQogICAgICAgICRGaWxlU3RyZWFtLlJlYWQoJGxmYW5ldywwLDQpIHwgT3V0LU51bGwKICAgICAgICAkUEVPZmZzZXQgPSBbSW50XSAoJzB4ezB9JyAtZiAoKCAkbGZhbmV3Wy0xLi4tNF0gfCAlIHsgJF8uVG9TdHJpbmcoJ1gyJykgfSApIC1qb2luICcnKSkKICAgIAogICAgICAgICMgU2VlayB0byBJTUFHRV9GSUxFX0hFQURFUi5JTUFHRV9GSUxFX01BQ0hJTkUKICAgICAgICAkRmlsZVN0cmVhbS5TZWVrKCRQRU9mZnNldCArIDQsIFtTeXN0ZW0uSU8uU2Vla09yaWdpbl06OkJlZ2luKSB8IE91dC1OdWxsCiAgICAgICAgW0J5dGVbXV0gJElNQUdFX0ZJTEVfTUFDSElORSA9IE5ldy1PYmplY3QgQnl0ZVtdKDIpCiAgICAKICAgICAgICAjIFJlYWQgY29tcGlsZWQgYXJjaGl0ZWN0dXJlCiAgICAgICAgJEZpbGVTdHJlYW0uUmVhZCgkSU1BR0VfRklMRV9NQUNISU5FLDAsMikgfCBPdXQtTnVsbAogICAgICAgICRBcmNoaXRlY3R1cmUgPSAnezB9JyAtZiAoKCAkSU1BR0VfRklMRV9NQUNISU5FWy0xLi4tMl0gfCAlIHsgJF8uVG9TdHJpbmcoJ1gyJykgfSApIC1qb2luICcnKQogICAgICAgICRGaWxlU3RyZWFtLkNsb3NlKCkKICAgIAogICAgICAgIGlmICgoJEFyY2hpdGVjdHVyZSAtbmUgJzAxNEMnKSAtYW5kICgkQXJjaGl0ZWN0dXJlIC1uZSAnODY2NCcpKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ0ludmFsaWQgUEUgaGVhZGVyIG9yIHVuc3VwcG9ydGVkIGFyY2hpdGVjdHVyZS4nCiAgICAgICAgfQogICAgCiAgICAgICAgaWYgKCRBcmNoaXRlY3R1cmUgLWVxICcwMTRDJykKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAnWDg2JwogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRBcmNoaXRlY3R1cmUgLWVxICc4NjY0JykKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAnWDY0JwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgJ09USEVSJwogICAgICAgIH0KICAgIH0KCiAgICAKICAgICMgR2V0IGFkZHJlc3NlcyBvZiBhbmQgZGVjbGFyZSBkZWxlZ2F0ZXMgZm9yIGVzc2VudGlhbCBXaW4zMiBmdW5jdGlvbnMuCiAgICAkT3BlblByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBPcGVuUHJvY2VzcwogICAgJE9wZW5Qcm9jZXNzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1VJbnQzMl0sIFtCb29sXSwgW1VJbnQzMl0pIChbSW50UHRyXSkKICAgICRPcGVuUHJvY2VzcyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRPcGVuUHJvY2Vzc0FkZHIsICRPcGVuUHJvY2Vzc0RlbGVnYXRlKQogICAgJFZpcnR1YWxBbGxvY0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgVmlydHVhbEFsbG9jRXgKICAgICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtJbnRQdHJdKQogICAgJFZpcnR1YWxBbGxvY0V4ID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFZpcnR1YWxBbGxvY0V4QWRkciwgJFZpcnR1YWxBbGxvY0V4RGVsZWdhdGUpCiAgICAkVmlydHVhbEZyZWVFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxGcmVlRXgKICAgICRWaXJ0dWFsRnJlZUV4RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbVWludDMyXSwgW1VJbnQzMl0pIChbQm9vbF0pCiAgICAkVmlydHVhbEZyZWVFeCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsRnJlZUV4QWRkciwgJFZpcnR1YWxGcmVlRXhEZWxlZ2F0ZSkKICAgICRXcml0ZVByb2Nlc3NNZW1vcnlBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBXcml0ZVByb2Nlc3NNZW1vcnkKICAgICRXcml0ZVByb2Nlc3NNZW1vcnlEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtCeXRlW11dLCBbVUludDMyXSwgW1VJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSAoW0Jvb2xdKQogICAgJFdyaXRlUHJvY2Vzc01lbW9yeSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRXcml0ZVByb2Nlc3NNZW1vcnlBZGRyLCAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUpCiAgICAkUnRsQ3JlYXRlVXNlclRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgbnRkbGwuZGxsIFJ0bENyZWF0ZVVzZXJUaHJlYWQKICAgICRSdGxDcmVhdGVVc2VyVGhyZWFkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbQm9vbF0sIFtVSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0sIFtJbnRQdHJdLCBbSW50UHRyXSwgW0ludFB0cl0sIFtJbnRQdHJdKSAoW1VJbnQzMl0pCiAgICAkUnRsQ3JlYXRlVXNlclRocmVhZCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRSdGxDcmVhdGVVc2VyVGhyZWFkQWRkciwgJFJ0bENyZWF0ZVVzZXJUaHJlYWREZWxlZ2F0ZSkKICAgICRDbG9zZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENsb3NlSGFuZGxlCiAgICAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtCb29sXSkKICAgICRDbG9zZUhhbmRsZSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRDbG9zZUhhbmRsZUFkZHIsICRDbG9zZUhhbmRsZURlbGVnYXRlKQoKICAgICMgRGV0ZXJtaW5lIHRoZSBiaXRuZXNzIG9mIHRoZSBydW5uaW5nIFBvd2VyU2hlbGwgcHJvY2VzcyBiYXNlZCB1cG9uIHRoZSBzaXplIG9mIHRoZSBJbnRQdHIgdHlwZS4KICAgIGlmIChbSW50UHRyXTo6U2l6ZSAtZXEgNCkKICAgIHsKICAgICAgICAkUG93ZXJTaGVsbDMyYml0ID0gJFRydWUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkUG93ZXJTaGVsbDMyYml0ID0gJEZhbHNlCiAgICB9CgogICAgJE9TQXJjaGl0ZWN0dXJlID0gKEdldC1XbWlPYmplY3QgV2luMzJfT3BlcmF0aW5nU3lzdGVtKS5PU0FyY2hpdGVjdHVyZQoKICAgIHN3aXRjaCAoJE9TQXJjaGl0ZWN0dXJlKQogICAgewogICAgICAgICczMi1iaXQnIHsgJDY0Yml0T1MgPSAkRmFsc2UgfQogICAgICAgICc2NC1iaXQnIHsgJDY0Yml0T1MgPSAkVHJ1ZSB9CiAgICB9CgogICAgIyBUaGUgYWRkcmVzcyBmb3IgSXNXb3c2NFByb2Nlc3Mgd2lsbCBiZSByZXR1cm5lZCBpZiBhbmQgb25seSBpZiBydW5uaW5nIG9uIGEgNjQtYml0IENQVS4gT3RoZXJ3aXNlLCBHZXQtUHJvY0FkZHJlc3Mgd2lsbCByZXR1cm4gJG51bGwuCiAgICAkSXNXb3c2NFByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBJc1dvdzY0UHJvY2VzcwoKICAgIGlmICgkSXNXb3c2NFByb2Nlc3NBZGRyKQogICAgewogICAgCSRJc1dvdzY0UHJvY2Vzc0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbQm9vbF0uTWFrZUJ5UmVmVHlwZSgpKSAoW0Jvb2xdKQogICAgCSRJc1dvdzY0UHJvY2VzcyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRJc1dvdzY0UHJvY2Vzc0FkZHIsICRJc1dvdzY0UHJvY2Vzc0RlbGVnYXRlKQogICAgfQoKICAgICRBcmNoaXRlY3R1cmUgPSBHZXQtUEVBcmNoaXRlY3R1cmUgJERsbAoKICAgIFdyaXRlLVZlcmJvc2UgIkFyY2hpdGVjdHVyZSBvZiB0aGUgZGxsIHRvIGJlIGluamVjdGVkOiAkQXJjaGl0ZWN0dXJlIgoKICAgICMgT3BlbiBhIGhhbmRsZSB0byB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50bwogICAgJGhQcm9jZXNzID0gJE9wZW5Qcm9jZXNzLkludm9rZSgweDAwMUYwRkZGLCAkZmFsc2UsICRQcm9jZXNzSUQpICMgUHJvY2Vzc0FjY2Vzc0ZsYWdzLkFsbCAoMHgwMDFGMEZGRikKICAgIAogICAgaWYgKCEkaFByb2Nlc3MpCiAgICB7CiAgICAgICAgVGhyb3cgJ1VuYWJsZSB0byBvcGVuIHByb2Nlc3MgaGFuZGxlLicKICAgIH0KCiAgICBpZiAoJDY0Yml0T1MpICMgT25seSBwZXJmb3JtIHRoZXNlcyBjaGVja3MgaWYgT1MgaXMgNjQtYml0CiAgICB7CiAgICAgICAgaWYgKCAoJEFyY2hpdGVjdHVyZSAtbmUgJ1g4NicpIC1hbmQgKCRBcmNoaXRlY3R1cmUgLW5lICdYNjQnKSApCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnT25seSB4ODYgb3IgQU1ENjQgYXJjaGl0ZWNodHVyZXMgc3VwcG9ydGVkLicKICAgICAgICB9CgogICAgICAgICMgRGV0ZXJtaW5lIGlzIHRoZSBwcm9jZXNzIHNwZWNpZmllZCBpcyAzMiBvciA2NCBiaXQuIEFzc3VtZSB0aGF0IGl0IGlzIDY0LWJpdCB1bmxlc3MgZGV0ZXJtaW5lZCBvdGhlcndpc2UuCiAgICAgICAgJElzV293NjQgPSAkRmFsc2UKICAgICAgICAkSXNXb3c2NFByb2Nlc3MuSW52b2tlKCRoUHJvY2VzcywgW1JlZl0gJElzV293NjQpIHwgT3V0LU51bGwKCiAgICAgICAgaWYgKCAkUG93ZXJTaGVsbDMyYml0IC1hbmQgKCRBcmNoaXRlY3R1cmUgLWVxICdYNjQnKSApCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnWW91IGNhbm5vdCBtYW5pcHVsYXRlIDY0LWJpdCBjb2RlIHdpdGhpbiAzMi1iaXQgUG93ZXJTaGVsbC4gT3BlbiB0aGUgNjQtYml0IHZlcnNpb24gYW5kIHRyeSBhZ2Fpbi4nCiAgICAgICAgfQoKICAgICAgICBpZiAoICghJElzV293NjQpIC1hbmQgKCRBcmNoaXRlY3R1cmUgLWVxICdYODYnKSApCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnWW91IGNhbm5vdCBpbmplY3QgYSAzMi1iaXQgRExMIGludG8gYSA2NC1iaXQgcHJvY2Vzcy4nCiAgICAgICAgfQoKICAgICAgICBpZiAoICRJc1dvdzY0IC1hbmQgKCRBcmNoaXRlY3R1cmUgLWVxICdYNjQnKSApCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnWW91IGNhbm5vdCBpbmplY3QgYSA2NC1iaXQgRExMIGludG8gYSAzMi1iaXQgcHJvY2Vzcy4nCiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGlmICgkQXJjaGl0ZWN0dXJlIC1uZSAnWDg2JykgICAgICAKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICdQRSBmaWxlIHdhcyBub3QgY29tcGlsZWQgZm9yIHg4Ni4nCiAgICAgICAgfQogICAgfQoKICAgICMgR2V0IGFkZHJlc3Mgb2YgTG9hZExpYnJhcnlBIGZ1bmN0aW9uCiAgICAkTG9hZExpYnJhcnlBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBMb2FkTGlicmFyeUEKICAgIFdyaXRlLVZlcmJvc2UgIkxvYWRMaWJyYXJ5IGFkZHJlc3M6IDB4JCgkTG9hZExpYnJhcnlBZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAjIFJlc2VydmUgYW5kIGNvbW1pdCBtZW1vcnkgdG8gaG9sZCBuYW1lIG9mIGRsbAogICAgJFJlbW90ZU1lbUFkZHIgPSAkVmlydHVhbEFsbG9jRXguSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sICREbGwuTGVuZ3RoLCAweDMwMDAsIDQpICMgKDB4MzAwMCA9IFJlc2VydmV8Q29tbWl0LCA0ID0gUlcpCiAgICBpZiAoJFJlbW90ZU1lbUFkZHIgLWVxIFtJbnRQdHJdOjpaZXJvKQogICAgewogICAgICAgIFRocm93ICdVbmFibGUgdG8gYWxsb2NhdGUgbWVtb3J5IGluIHJlbW90ZSBwcm9jZXNzLiBUcnkgcnVubmluZyBQb3dlclNoZWxsIGVsZXZhdGVkLicKICAgIH0KICAgIFdyaXRlLVZlcmJvc2UgIkRMTCBwYXRoIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJFJlbW90ZU1lbUFkZHIuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKICAgICMgV3JpdGUgdGhlIG5hbWUgb2YgdGhlIGRsbCB0byB0aGUgcmVtb3RlIHByb2Nlc3MgYWRkcmVzcyBzcGFjZQogICAgJFdyaXRlUHJvY2Vzc01lbW9yeS5JbnZva2UoJGhQcm9jZXNzLCAkUmVtb3RlTWVtQWRkciwgJERsbEJ5dGVBcnJheSwgJERsbC5MZW5ndGgsIFtSZWZdIDApIHwgT3V0LU51bGwKICAgIFdyaXRlLVZlcmJvc2UgIkRsbCBwYXRoIHdyaXR0ZW4gc3VjZXNzZnVsbHkuIgoKICAgICMgRXhlY3V0ZSBkbGwgYXMgYSByZW1vdGUgdGhyZWFkCiAgICAkUmVzdWx0ID0gJFJ0bENyZWF0ZVVzZXJUaHJlYWQuSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sICRGYWxzZSwgMCwgW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvLCAkTG9hZExpYnJhcnlBZGRyLCAkUmVtb3RlTWVtQWRkciwgW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvKQogICAgaWYgKCRSZXN1bHQpCiAgICB7CiAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBsYXVuY2ggcmVtb3RlIHRocmVhZC4gTlRTVEFUVVM6IDB4JCgkUmVzdWx0LlRvU3RyaW5nKCdYOCcpKSIKICAgIH0KICAgIAogICAgJFZpcnR1YWxGcmVlRXguSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZU1lbUFkZHIsICREbGwuTGVuZ3RoLCAweDgwMDApIHwgT3V0LU51bGwgIyBNRU1fUkVMRUFTRSAoMHg4MDAwKQoKICAgICMgQ2xvc2UgcHJvY2VzcyBoYW5kbGUKICAgICRDbG9zZUhhbmRsZS5JbnZva2UoJGhQcm9jZXNzKSB8IE91dC1OdWxsCgogICAgIyBFeHRyYWN0IGp1c3QgdGhlIGZpbGVuYW1lIGZyb20gdGhlIHByb3ZpZGVkIHBhdGggdG8gdGhlIGRsbC4KICAgICRGaWxlTmFtZSA9IFNwbGl0LVBhdGggJERsbCAtTGVhZgogICAgJERsbEluZm8gPSAoR2V0LVByb2Nlc3MgLUlkICRQcm9jZXNzSUQpLk1vZHVsZXMgfCA/IHsgJF8uRmlsZU5hbWUuQ29udGFpbnMoJEZpbGVOYW1lKSB9CgogICAgaWYgKCEkRGxsSW5mbykKICAgIHsKICAgICAgICBUaHJvdyAiRGxsIGRpZCBkb3QgaW5qZWN0IHByb3Blcmx5IGludG8gdGhlIHZpY3RpbSBwcm9jZXNzLiIKICAgIH0KCiAgICBXcml0ZS1WZXJib3NlICdEbGwgaW5qZWN0aW9uIGNvbXBsZXRlIScKCiAgICAkRGxsSW5mbwp9CiRQcm9jID0gR2V0LVByb2Nlc3Mgbm90ZXBhZAoKCkludm9rZS1EbGxJbmplY3Rpb24gLVByb2Nlc3NJZCAkUHJvYy5JZCAtRGxsIERlbW9ETEwuZGxsCg==
