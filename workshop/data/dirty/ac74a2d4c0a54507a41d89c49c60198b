VolumeShadowCopyTools.ps1,47deda4b402b68a571c975803e96cae2,Scan result is 32768. IsMalware: 1,w6/Cu8K/ZnVuY3Rpb24gR2V0LVZvbHVtZVNoYWRvd0NvcHkKewo8IwouU1lOT1BTSVMKCiAgICBMaXN0cyB0aGUgZGV2aWNlIHBhdGhzIG9mIGFsbCBsb2NhbCB2b2x1bWUgc2hhZG93IGNvcGllcy4KCiAgICBQb3dlclNwbG9pdCBGdW5jdGlvbjogR2V0LVZvbHVtZVNoYWRvd0NvcHkKICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAgICBWZXJzaW9uOiAyLjAuMAojPgoKICAgICRVc2VySWRlbnRpdHkgPSAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQoKICAgIGlmICgtbm90ICRVc2VySWRlbnRpdHkuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdJ0FkbWluaXN0cmF0b3InKSkKICAgIHsKICAgICAgICBUaHJvdyAnWW91IG11c3QgcnVuIEdldC1Wb2x1bWVTaGFkb3dDb3B5IGZyb20gYW4gZWxldmF0ZWQgY29tbWFuZCBwcm9tcHQuJwogICAgfQoKICAgIEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSByb290XGNpbXYyIC1DbGFzcyBXaW4zMl9TaGFkb3dDb3B5IHwgRm9yRWFjaC1PYmplY3QgeyAkXy5EZXZpY2VPYmplY3QgfQp9CgpmdW5jdGlvbiBOZXctVm9sdW1lU2hhZG93Q29weQp7CjwjCi5TWU5PUFNJUwoKICAgIENyZWF0ZXMgYSBuZXcgdm9sdW1lIHNoYWRvdyBjb3B5LgoKICAgIFBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBOZXctVm9sdW1lU2hhZG93Q29weQogICAgQXV0aG9yOiBKYXJlZCBBdGtpbnNvbiAoQGphcmVkY2F0a2luc29uKQogICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIE9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQogICAgVmVyc2lvbjogMi4wLjAKCi5ERVNDUklQVElPTgoKICAgIE5ldy1Wb2x1bWVTaGFkb3dDb3B5IGNyZWF0ZXMgYSB2b2x1bWUgc2hhZG93IGNvcHkgZm9yIHRoZSBzcGVjaWZpZWQgdm9sdW1lLgoKLlBBUkFNRVRFUiBWb2x1bWUKCiAgICBWb2x1bWUgdXNlZCBmb3IgdGhlIHNoYWRvdyBjb3B5LiBUaGlzIHZvbHVtZSBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIG9yaWdpbmFsIHZvbHVtZS4gCiAgICBUaGUgVm9sdW1lIHBhcmFtZXRlciBjYW4gYmUgc3BlY2lmaWVkIGFzIGEgdm9sdW1lIGRyaXZlIGxldHRlciwgbW91bnQgcG9pbnQsIG9yIHZvbHVtZSBnbG9iYWxseSB1bmlxdWUgaWRlbnRpZmllciAoR1VJRCkgbmFtZS4KCi5QQVJBTUVURVIgQ29udGV4dAoKICAgIENvbnRleHQgdGhhdCB0aGUgcHJvdmlkZXIgdXNlcyB3aGVuIGNyZWF0aW5nIHRoZSBzaGFkb3cuIFRoZSBkZWZhdWx0IGlzICJDbGllbnRBY2Nlc3NpYmxlIi4KCi5FWEFNUExFCgogICAgTmV3LVZvbHVtZVNoYWRvd0NvcHkgLVZvbHVtZSBDOlwKCiAgICBEZXNjcmlwdGlvbgogICAgLS0tLS0tLS0tLS0KICAgIENyZWF0ZXMgYSBuZXcgVm9sdW1lU2hhZG93Q29weSBvZiB0aGUgQyBkcml2ZQojPgogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlUGF0dGVybignXlx3OlxcJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVm9sdW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRGYWxzZSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJDbGllbnRBY2Nlc3NpYmxlIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29udGV4dCA9ICJDbGllbnRBY2Nlc3NpYmxlIgogICAgKQoKICAgICRVc2VySWRlbnRpdHkgPSAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQoKICAgIGlmICgtbm90ICRVc2VySWRlbnRpdHkuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdJ0FkbWluaXN0cmF0b3InKSkKICAgIHsKICAgICAgICBUaHJvdyAnWW91IG11c3QgcnVuIEdldC1Wb2x1bWVTaGFkb3dDb3B5IGZyb20gYW4gZWxldmF0ZWQgY29tbWFuZCBwcm9tcHQuJwogICAgfQoKICAgICMgU2F2ZSBWU1MgU2VydmljZSBpbml0aWFsIHN0YXRlCiAgICAkcnVubmluZyA9IChHZXQtU2VydmljZSAtTmFtZSBWU1MpLlN0YXR1cwoKICAgICRjbGFzcyA9IFtXTUlDTEFTU10icm9vdFxjaW12Mjp3aW4zMl9zaGFkb3djb3B5IgoKICAgICRyZXR1cm4gPSAkY2xhc3MuY3JlYXRlKCIkVm9sdW1lIiwgIiRDb250ZXh0IikKCiAgICBzd2l0Y2goJHJldHVybi5yZXR1cm52YWx1ZSkKICAgIHsKICAgICAgICAxIHtXcml0ZS1FcnJvciAiQWNjZXNzIGRlbmllZC4iOyBicmVha30KICAgICAgICAyIHtXcml0ZS1FcnJvciAiSW52YWxpZCBhcmd1bWVudC4iOyBicmVha30KICAgICAgICAzIHtXcml0ZS1FcnJvciAiU3BlY2lmaWVkIHZvbHVtZSBub3QgZm91bmQuIjsgYnJlYWt9CiAgICAgICAgNCB7V3JpdGUtRXJyb3IgIlNwZWNpZmllZCB2b2x1bWUgbm90IHN1cHBvcnRlZC4iOyBicmVha30KICAgICAgICA1IHtXcml0ZS1FcnJvciAiVW5zdXBwb3J0ZWQgc2hhZG93IGNvcHkgY29udGV4dC4iOyBicmVha30KICAgICAgICA2IHtXcml0ZS1FcnJvciAiSW5zdWZmaWNpZW50IHN0b3JhZ2UuIjsgYnJlYWt9CiAgICAgICAgNyB7V3JpdGUtRXJyb3IgIlZvbHVtZSBpcyBpbiB1c2UuIjsgYnJlYWt9CiAgICAgICAgOCB7V3JpdGUtRXJyb3IgIk1heGltdW0gbnVtYmVyIG9mIHNoYWRvdyBjb3BpZXMgcmVhY2hlZC4iOyBicmVha30KICAgICAgICA5IHtXcml0ZS1FcnJvciAiQW5vdGhlciBzaGFkb3cgY29weSBvcGVyYXRpb24gaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4iOyBicmVha30KICAgICAgICAxMCB7V3JpdGUtRXJyb3IgIlNoYWRvdyBjb3B5IHByb3ZpZGVyIHZldG9lZCB0aGUgb3BlcmF0aW9uLiI7IGJyZWFrfQogICAgICAgIDExIHtXcml0ZS1FcnJvciAiU2hhZG93IGNvcHkgcHJvdmlkZXIgbm90IHJlZ2lzdGVyZWQuIjsgYnJlYWt9CiAgICAgICAgMTIge1dyaXRlLUVycm9yICJTaGFkb3cgY29weSBwcm92aWRlciBmYWlsdXJlLiI7IGJyZWFrfQogICAgICAgIDEzIHtXcml0ZS1FcnJvciAiVW5rbm93biBlcnJvci4iOyBicmVha30KICAgICAgICBkZWZhdWx0IHticmVha30KICAgIH0KCiAgICAjIElmIFZTUyBTZXJ2aWNlIHdhcyBTdG9wcGVkIGF0IHRoZSBzdGFydCwgcmV0dXJuIFZTUyB0byAiU3RvcHBlZCIgc3RhdGUKICAgIGlmKCRydW5uaW5nIC1lcSAiU3RvcHBlZCIpCiAgICB7CiAgICAgICAgU3RvcC1TZXJ2aWNlIC1OYW1lIFZTUwogICAgfQp9CgpmdW5jdGlvbiBSZW1vdmUtVm9sdW1lU2hhZG93Q29weQp7CjwjCi5TWU5PUFNJUwoKICAgIERlbGV0ZXMgYSB2b2x1bWUgc2hhZG93IGNvcHkuCgogICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IFJlbW92ZS1Wb2x1bWVTaGFkb3dDb3B5CiAgICBBdXRob3I6IEphcmVkIEF0a2luc29uIChAamFyZWRjYXRraW5zb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAgICBWZXJzaW9uOiAyLjAuMAoKLkRFU0NSSVBUSU9OCgogICAgUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkgZGVsZXRlcyBhIHZvbHVtZSBzaGFkb3cgY29weSBmcm9tIHRoZSBzeXN0ZW0uCgouUEFSQU1FVEVSIElucHV0T2JqZWN0CgogICAgU3BlY2lmaWVzIHRoZSBXaW4zMl9TaGFkb3dDb3B5IG9iamVjdCB0byByZW1vdmUKCi5QQVJBTUVURVIgRGV2aWNlUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgdm9sdW1lIHNoYWRvdyBjb3B5ICdEZXZpY2VPYmplY3QnIHBhdGguIFRoaXMgcGF0aCBjYW4gYmUgcmV0cmlldmVkIHdpdGggdGhlIEdldC1Wb2x1bWVTaGFkb3dDb3B5IFBvd2VyU3Bsb2l0IGZ1bmN0aW9uIG9yIHdpdGggdGhlIFdpbjMyX1NoYWRvd0NvcHkgb2JqZWN0LgoKLkVYQU1QTEUKCiAgICBHZXQtVm9sdW1lU2hhZG93Q29weSB8IFJlbW92ZS1Wb2x1bWVTaGFkb3dDb3B5CgogICAgRGVzY3JpcHRpb24KICAgIC0tLS0tLS0tLS0tCiAgICBSZW1vdmVzIGFsbCB2b2x1bWUgc2hhZG93IGNvcHkKCi5FWEFNUExFCgogICAgUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkgLURldmljZVBhdGggJ1xcP1xHTE9CQUxST09UXERldmljZVxIYXJkZGlza1ZvbHVtZVNoYWRvd0NvcHk0JwoKICAgIERlc2NyaXB0aW9uCiAgICAtLS0tLS0tLS0tLQogICAgUmVtb3ZlcyB0aGUgdm9sdW1lIHNoYWRvdyBjb3B5IGF0IHRoZSAnRGV2aWNlT2JqZWN0JyBwYXRoIFxcP1xHTE9CQUxST09UXERldmljZUhhcmRkaXNrVm9sdW1lU2hhZG93Q29weTQKIz4KICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2VzcyA9ICRUcnVlKV0KICAgIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZVBhdHRlcm4oJ15cXFxcXD9cXEdMT0JBTFJPT1RcXERldmljZVxcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5WzAtOV17MSwzfSQnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREZXZpY2VQYXRoCiAgICApCgogICAgUFJPQ0VTUwogICAgewogICAgICAgIGlmKCRQU0NtZGxldC5TaG91bGRQcm9jZXNzKCJUaGUgVm9sdW1lU2hhZG93Q29weSBhdCBEZXZpY2VQYXRoICREZXZpY2VQYXRoIHdpbGwgYmUgcmVtb3ZlZCIpKQogICAgICAgIHsKICAgICAgICAgICAgKEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSByb290XGNpbXYyIC1DbGFzcyBXaW4zMl9TaGFkb3dDb3B5IHwgV2hlcmUtT2JqZWN0IHskXy5EZXZpY2VPYmplY3QgLWVxICREZXZpY2VQYXRofSkuRGVsZXRlKCkKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIE1vdW50LVZvbHVtZVNoYWRvd0NvcHkKewo8IwouU1lOT1BTSVMKCiAgICBNb3VudHMgYSB2b2x1bWUgc2hhZG93IGNvcHkuCgogICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IE1vdW50LVZvbHVtZVNoYWRvd0NvcHkKICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAgICBWZXJzaW9uOiAyLjAuMAoKLkRFU0NSSVBUSU9OCgogICAgTW91bnQtVm9sdW1lU2hhZG93Q29weSBtb3VudHMgYSB2b2x1bWUgc2hhZG93IGNvcHkgdm9sdW1lIGJ5IGNyZWF0aW5nIGEgc3ltYm9saWMgbGluay4KCi5QQVJBTUVURVIgUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgcGF0aCB0byB3aGljaCB0aGUgc3ltYm9saWMgbGluayBmb3IgdGhlIG1vdW50ZWQgdm9sdW1lIHNoYWRvdyBjb3B5IHdpbGwgYmUgc2F2ZWQuCgouUEFSQU1FVEVSIERldmljZVBhdGgKCiAgICBTcGVjaWZpZXMgdGhlIHZvbHVtZSBzaGFkb3cgY29weSAnRGV2aWNlT2JqZWN0JyBwYXRoLiBUaGlzIHBhdGggY2FuIGJlIHJldHJpZXZlZCB3aXRoIHRoZSBHZXQtVm9sdW1lU2hhZG93Q29weSBQb3dlclNwbG9pdCBmdW5jdGlvbiBvciB3aXRoIHRoZSBXaW4zMl9TaGFkb3dDb3B5IG9iamVjdC4KCi5FWEFNUExFCgogICAgR2V0LVZvbHVtZVNoYWRvd0NvcHkgfCBNb3VudC1Wb2x1bWVTaGFkb3dDb3B5IC1QYXRoIEM6XFZTUwoKICAgIERlc2NyaXB0aW9uCiAgICAtLS0tLS0tLS0tLQogICAgQ3JlYXRlIGEgbW91bnQgcG9pbnQgaW4gJ0M6XFZTUycgZm9yIGVhY2ggdm9sdW1lIHNoYWRvdyBjb3B5IHZvbHVtZQoKLkVYQU1QTEUKCiAgICBNb3VudC1Wb2x1bWVTaGFkb3dDb3B5IC1QYXRoIEM6XFZTUyAtRGV2aWNlUGF0aCAnXFw/XEdMT0JBTFJPT1RcRGV2aWNlXEhhcmRkaXNrVm9sdW1lU2hhZG93Q29weTQnCgouRVhBTVBMRQoKICAgIEdldC1XbWlPYmplY3QgV2luMzJfU2hhZG93Q29weSB8ICUgeyAkXy5EZXZpY2VPYmplY3QgLVBhdGggQzpcVlNTIC1EZXZpY2VQYXRoICRfIH0KIz4KCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZSA9ICRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVQYXR0ZXJuKCdeXFxcXFw/XFxHTE9CQUxST09UXFxEZXZpY2VcXEhhcmRkaXNrVm9sdW1lU2hhZG93Q29weVswLTldezEsM30kJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICREZXZpY2VQYXRoCiAgICApCgogICAgQkVHSU4KICAgIHsKICAgICAgICAkVXNlcklkZW50aXR5ID0gKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c1ByaW5jaXBhbF1bU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkKCiAgICAgICAgaWYgKC1ub3QgJFVzZXJJZGVudGl0eS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV0nQWRtaW5pc3RyYXRvcicpKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ1lvdSBtdXN0IHJ1biBHZXQtVm9sdW1lU2hhZG93Q29weSBmcm9tIGFuIGVsZXZhdGVkIGNvbW1hbmQgcHJvbXB0LicKICAgICAgICB9CgogICAgICAgICMgVmFsaWRhdGUgdGhhdCB0aGUgcGF0aCBleGlzdHMgYmVmb3JlIHByb2NlZWRpbmcKICAgICAgICBHZXQtQ2hpbGRJdGVtICRQYXRoIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKCiAgICAgICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseU5hbWUoJ1ZTU1V0aWwnKQogICAgICAgICRBc3NlbWJseUJ1aWxkZXIgPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbUmVmbGVjdGlvbi5FbWl0LkFzc2VtYmx5QnVpbGRlckFjY2Vzc106OlJ1bikKICAgICAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnVlNTVXRpbCcsICRGYWxzZSkKCiAgICAgICAgIyBEZWZpbmUgW1ZTUy5LZXJuZWwzMl06OkNyZWF0ZVN5bWJvbGljTGluayBtZXRob2QgdXNpbmcgcmVmbGVjdGlvbgogICAgICAgICMgKGkuZS4gbm9uZSBvZiB0aGUgZm9yZW5zaWMgYXJ0aWZhY3RzIGxlZnQgd2l0aCB1c2luZyBBZGQtVHlwZSkKICAgICAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdWU1MuS2VybmVsMzInLCAnUHVibGljLCBDbGFzcycpCiAgICAgICAgJFBJbnZva2VNZXRob2QgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lUEludm9rZU1ldGhvZCgnQ3JlYXRlU3ltYm9saWNMaW5rJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2tlcm5lbDMyLmRsbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChbUmVmbGVjdGlvbi5NZXRob2RBdHRyaWJ1dGVzXTo6UHVibGljIC1ib3IgW1JlZmxlY3Rpb24uTWV0aG9kQXR0cmlidXRlc106OlN0YXRpYyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbQm9vbF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtUeXBlW11dQChbU3RyaW5nXSwgW1N0cmluZ10sIFtVSW50MzJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXTo6V2luYXBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkF1dG8pCiAgICAgICAgJERsbEltcG9ydENvbnN0cnVjdG9yID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkRsbEltcG9ydEF0dHJpYnV0ZV0uR2V0Q29uc3RydWN0b3IoQChbU3RyaW5nXSkpCiAgICAgICAgJFNldExhc3RFcnJvciA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5EbGxJbXBvcnRBdHRyaWJ1dGVdLkdldEZpZWxkKCdTZXRMYXN0RXJyb3InKQogICAgICAgICRTZXRMYXN0RXJyb3JDdXN0b21BdHRyaWJ1dGUgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uRW1pdC5DdXN0b21BdHRyaWJ1dGVCdWlsZGVyKCREbGxJbXBvcnRDb25zdHJ1Y3RvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAKCdrZXJuZWwzMi5kbGwnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5GaWVsZEluZm9bXV1AKCRTZXRMYXN0RXJyb3IpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEAoJHRydWUpKQogICAgICAgICRQSW52b2tlTWV0aG9kLlNldEN1c3RvbUF0dHJpYnV0ZSgkU2V0TGFzdEVycm9yQ3VzdG9tQXR0cmlidXRlKQoKICAgICAgICAkS2VybmVsMzJUeXBlID0gJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQogICAgfQoKICAgIFBST0NFU1MKICAgIHsKICAgICAgICBmb3JlYWNoICgkVm9sdW1lIGluICREZXZpY2VQYXRoKQogICAgICAgIHsKICAgICAgICAgICAgJFZvbHVtZSAtbWF0Y2ggJ15cXFxcXD9cXEdMT0JBTFJPT1RcXERldmljZVxcKD88TGlua05hbWU+SGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5WzAtOV17MSwzfSkkJyB8IE91dC1OdWxsCiAgICAgICAgICAgIAogICAgICAgICAgICAkTGlua1BhdGggPSBKb2luLVBhdGggJFBhdGggJE1hdGNoZXMuTGlua05hbWUKCiAgICAgICAgICAgIGlmIChUZXN0LVBhdGggJExpbmtQYXRoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICInJExpbmtQYXRoJyBhbHJlYWR5IGV4aXN0cy4iCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoLW5vdCAkS2VybmVsMzJUeXBlOjpDcmVhdGVTeW1ib2xpY0xpbmsoJExpbmtQYXRoLCAiJCgkVm9sdW1lKVwiLCAxKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIlN5bWJvbGljIGxpbmsgY3JlYXRpb24gZmFpbGVkIGZvciAnJFZvbHVtZScuIgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgR2V0LUl0ZW0gJExpbmtQYXRoCiAgICAgICAgfQogICAgfQoKICAgIEVORAogICAgewoKICAgIH0KfQ==
