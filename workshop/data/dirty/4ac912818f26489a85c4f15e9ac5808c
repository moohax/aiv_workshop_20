powerview.ps1,e93e424df25b748496403e16949cb080,Scan result is 32768. IsMalware: 1,I3JlcXVpcmVzIC12ZXJzaW9uIDIKCjwjCgogICAgUG93ZXJTcGxvaXQgRmlsZTogUG93ZXJWaWV3LnBzMQogICAgQXV0aG9yOiBXaWxsIFNjaHJvZWRlciAoQGhhcm1qMHkpCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgojPgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIFBTUmVmbGVjdCBjb2RlIGZvciBXaW5kb3dzIEFQSSBhY2Nlc3MKIyBBdXRob3I6IEBtYXR0aWZlc3RhdGlvbgojICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL21hdHRpZmVzdGF0aW9uL1BTUmVmbGVjdC9tYXN0ZXIvUFNSZWZsZWN0LnBzbTEKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gTmV3LUluTWVtb3J5TW9kdWxlCnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGFuIGluLW1lbW9yeSBhc3NlbWJseSBhbmQgbW9kdWxlCgogICAgICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICAgICAgUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCiAgICAgICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFdoZW4gZGVmaW5pbmcgY3VzdG9tIGVudW1zLCBzdHJ1Y3RzLCBhbmQgdW5tYW5hZ2VkIGZ1bmN0aW9ucywgaXQgaXMKICAgICAgICBuZWNlc3NhcnkgdG8gYXNzb2NpYXRlIHRvIGFuIGFzc2VtYmx5IG1vZHVsZS4gVGhpcyBoZWxwZXIgZnVuY3Rpb24KICAgICAgICBjcmVhdGVzIGFuIGluLW1lbW9yeSBtb2R1bGUgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHRoZSAnZW51bScsCiAgICAgICAgJ3N0cnVjdCcsIGFuZCBBZGQtV2luMzJUeXBlIGZ1bmN0aW9ucy4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZU5hbWUKCiAgICAgICAgU3BlY2lmaWVzIHRoZSBkZXNpcmVkIG5hbWUgZm9yIHRoZSBpbi1tZW1vcnkgYXNzZW1ibHkgYW5kIG1vZHVsZS4gSWYKICAgICAgICBNb2R1bGVOYW1lIGlzIG5vdCBwcm92aWRlZCwgaXQgd2lsbCBkZWZhdWx0IHRvIGEgR1VJRC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kdWxlID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCiM+CgogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRNb2R1bGVOYW1lID0gW0d1aWRdOjpOZXdHdWlkKCkuVG9TdHJpbmcoKQogICAgKQoKICAgICRMb2FkZWRBc3NlbWJsaWVzID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpCgogICAgRm9yRWFjaCAoJEFzc2VtYmx5IGluICRMb2FkZWRBc3NlbWJsaWVzKSB7CiAgICAgICAgaWYgKCRBc3NlbWJseS5GdWxsTmFtZSAtYW5kICgkQXNzZW1ibHkuRnVsbE5hbWUuU3BsaXQoJywnKVswXSAtZXEgJE1vZHVsZU5hbWUpKSB7CiAgICAgICAgICAgIHJldHVybiAkQXNzZW1ibHkKICAgICAgICB9CiAgICB9CgogICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgkTW9kdWxlTmFtZSkKICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgJ1J1bicpCiAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgkTW9kdWxlTmFtZSwgJEZhbHNlKQoKICAgIHJldHVybiAkTW9kdWxlQnVpbGRlcgp9CgoKIyBBIGhlbHBlciBmdW5jdGlvbiB1c2VkIHRvIHJlZHVjZSB0eXBpbmcgd2hpbGUgZGVmaW5pbmcgZnVuY3Rpb24KIyBwcm90b3R5cGVzIGZvciBBZGQtV2luMzJUeXBlLgpmdW5jdGlvbiBmdW5jCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbGxOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZ1bmN0aW9uTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkUmV0dXJuVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMpXQogICAgICAgIFtUeXBlW11dCiAgICAgICAgJFBhcmFtZXRlclR5cGVzLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCldCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXQogICAgICAgICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDUpXQogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XQogICAgICAgICRDaGFyc2V0LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZXRMYXN0RXJyb3IKICAgICkKCiAgICAkUHJvcGVydGllcyA9IEB7CiAgICAgICAgRGxsTmFtZSA9ICREbGxOYW1lCiAgICAgICAgRnVuY3Rpb25OYW1lID0gJEZ1bmN0aW9uTmFtZQogICAgICAgIFJldHVyblR5cGUgPSAkUmV0dXJuVHlwZQogICAgfQoKICAgIGlmICgkUGFyYW1ldGVyVHlwZXMpIHsgJFByb3BlcnRpZXNbJ1BhcmFtZXRlclR5cGVzJ10gPSAkUGFyYW1ldGVyVHlwZXMgfQogICAgaWYgKCROYXRpdmVDYWxsaW5nQ29udmVudGlvbikgeyAkUHJvcGVydGllc1snTmF0aXZlQ2FsbGluZ0NvbnZlbnRpb24nXSA9ICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiB9CiAgICBpZiAoJENoYXJzZXQpIHsgJFByb3BlcnRpZXNbJ0NoYXJzZXQnXSA9ICRDaGFyc2V0IH0KICAgIGlmICgkU2V0TGFzdEVycm9yKSB7ICRQcm9wZXJ0aWVzWydTZXRMYXN0RXJyb3InXSA9ICRTZXRMYXN0RXJyb3IgfQoKICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5ICRQcm9wZXJ0aWVzCn0KCgpmdW5jdGlvbiBBZGQtV2luMzJUeXBlCnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGEgLk5FVCB0eXBlIGZvciBhbiB1bm1hbmFnZWQgV2luMzIgZnVuY3Rpb24uCgogICAgICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICAgICAgUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCiAgICAgICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBmdW5jCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIEFkZC1XaW4zMlR5cGUgZW5hYmxlcyB5b3UgdG8gZWFzaWx5IGludGVyYWN0IHdpdGggdW5tYW5hZ2VkIChpLmUuCiAgICAgICAgV2luMzIgdW5tYW5hZ2VkKSBmdW5jdGlvbnMgaW4gUG93ZXJTaGVsbC4gQWZ0ZXIgcHJvdmlkaW5nCiAgICAgICAgQWRkLVdpbjMyVHlwZSB3aXRoIGEgZnVuY3Rpb24gc2lnbmF0dXJlLCBhIC5ORVQgdHlwZSBpcyBjcmVhdGVkCiAgICAgICAgdXNpbmcgcmVmbGVjdGlvbiAoaS5lLiBjc2MuZXhlIGlzIG5ldmVyIGNhbGxlZCBsaWtlIHdpdGggQWRkLVR5cGUpLgoKICAgICAgICBUaGUgJ2Z1bmMnIGhlbHBlciBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byByZWR1Y2UgdHlwaW5nIHdoZW4gZGVmaW5pbmcKICAgICAgICBtdWx0aXBsZSBmdW5jdGlvbiBkZWZpbml0aW9ucy4KCiAgICAuUEFSQU1FVEVSIERsbE5hbWUKCiAgICAgICAgVGhlIG5hbWUgb2YgdGhlIERMTC4KCiAgICAuUEFSQU1FVEVSIEZ1bmN0aW9uTmFtZQoKICAgICAgICBUaGUgbmFtZSBvZiB0aGUgdGFyZ2V0IGZ1bmN0aW9uLgoKICAgIC5QQVJBTUVURVIgUmV0dXJuVHlwZQoKICAgICAgICBUaGUgcmV0dXJuIHR5cGUgb2YgdGhlIGZ1bmN0aW9uLgoKICAgIC5QQVJBTUVURVIgUGFyYW1ldGVyVHlwZXMKCiAgICAgICAgVGhlIGZ1bmN0aW9uIHBhcmFtZXRlcnMuCgogICAgLlBBUkFNRVRFUiBOYXRpdmVDYWxsaW5nQ29udmVudGlvbgoKICAgICAgICBTcGVjaWZpZXMgdGhlIG5hdGl2ZSBjYWxsaW5nIGNvbnZlbnRpb24gb2YgdGhlIGZ1bmN0aW9uLiBEZWZhdWx0cyB0bwogICAgICAgIHN0ZGNhbGwuCgogICAgLlBBUkFNRVRFUiBDaGFyc2V0CgogICAgICAgIElmIHlvdSBuZWVkIHRvIGV4cGxpY2l0bHkgY2FsbCBhbiAnQScgb3IgJ1cnIFdpbjMyIGZ1bmN0aW9uLCB5b3UgY2FuCiAgICAgICAgc3BlY2lmeSB0aGUgY2hhcmFjdGVyIHNldC4KCiAgICAuUEFSQU1FVEVSIFNldExhc3RFcnJvcgoKICAgICAgICBJbmRpY2F0ZXMgd2hldGhlciB0aGUgY2FsbGVlIGNhbGxzIHRoZSBTZXRMYXN0RXJyb3IgV2luMzIgQVBJCiAgICAgICAgZnVuY3Rpb24gYmVmb3JlIHJldHVybmluZyBmcm9tIHRoZSBhdHRyaWJ1dGVkIG1ldGhvZC4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZQoKICAgICAgICBUaGUgaW4tbWVtb3J5IG1vZHVsZSB0aGF0IHdpbGwgaG9zdCB0aGUgZnVuY3Rpb25zLiBVc2UKICAgICAgICBOZXctSW5NZW1vcnlNb2R1bGUgdG8gZGVmaW5lIGFuIGluLW1lbW9yeSBtb2R1bGUuCgogICAgLlBBUkFNRVRFUiBOYW1lc3BhY2UKCiAgICAgICAgQW4gb3B0aW9uYWwgbmFtZXNwYWNlIHRvIHByZXBlbmQgdG8gdGhlIHR5cGUuIEFkZC1XaW4zMlR5cGUgZGVmYXVsdHMKICAgICAgICB0byBhIG5hbWVzcGFjZSBjb25zaXN0aW5nIG9ubHkgb2YgdGhlIG5hbWUgb2YgdGhlIERMTC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRGdW5jdGlvbkRlZmluaXRpb25zID0gQCgKICAgICAgICAgIChmdW5jIGtlcm5lbDMyIEdldFByb2NBZGRyZXNzIChbSW50UHRyXSkgQChbSW50UHRyXSwgW1N0cmluZ10pIC1DaGFyc2V0IEFuc2kgLVNldExhc3RFcnJvciksCiAgICAgICAgICAoZnVuYyBrZXJuZWwzMiBHZXRNb2R1bGVIYW5kbGUgKFtJbnRwdHJdKSBAKFtTdHJpbmddKSAtU2V0TGFzdEVycm9yKSwKICAgICAgICAgIChmdW5jIG50ZGxsIFJ0bEdldEN1cnJlbnRQZWIgKFtJbnRQdHJdKSBAKCkpCiAgICAgICAgKQoKICAgICAgICAkVHlwZXMgPSAkRnVuY3Rpb25EZWZpbml0aW9ucyB8IEFkZC1XaW4zMlR5cGUgLU1vZHVsZSAkTW9kIC1OYW1lc3BhY2UgJ1dpbjMyJwogICAgICAgICRLZXJuZWwzMiA9ICRUeXBlc1sna2VybmVsMzInXQogICAgICAgICROdGRsbCA9ICRUeXBlc1snbnRkbGwnXQogICAgICAgICROdGRsbDo6UnRsR2V0Q3VycmVudFBlYigpCiAgICAgICAgJG50ZGxsYmFzZSA9ICRLZXJuZWwzMjo6R2V0TW9kdWxlSGFuZGxlKCdudGRsbCcpCiAgICAgICAgJEtlcm5lbDMyOjpHZXRQcm9jQWRkcmVzcygkbnRkbGxiYXNlLCAnUnRsR2V0Q3VycmVudFBlYicpCgogICAgLk5PVEVTCgogICAgICAgIEluc3BpcmVkIGJ5IExlZSBIb2xtZXMnIEludm9rZS1XaW5kb3dzQXBpIGh0dHA6Ly9wb3NoY29kZS5vcmcvMjE4OQoKICAgICAgICBXaGVuIGRlZmluaW5nIG11bHRpcGxlIGZ1bmN0aW9uIHByb3RvdHlwZXMsIGl0IGlzIGlkZWFsIHRvIHByb3ZpZGUKICAgICAgICBBZGQtV2luMzJUeXBlIHdpdGggYW4gYXJyYXkgb2YgZnVuY3Rpb24gc2lnbmF0dXJlcy4gVGhhdCB3YXksIHRoZXkKICAgICAgICBhcmUgYWxsIGluY29ycG9yYXRlZCBpbnRvIHRoZSBzYW1lIGluLW1lbW9yeSBtb2R1bGUuCiM+CgogICAgW091dHB1dFR5cGUoW0hhc2h0YWJsZV0pXQogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbGxOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZ1bmN0aW9uTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkUmV0dXJuVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtUeXBlW11dCiAgICAgICAgJFBhcmFtZXRlclR5cGVzLAoKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWUgPSAkVHJ1ZSldCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXQogICAgICAgICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OlN0ZENhbGwsCgogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF0KICAgICAgICAkQ2hhcnNldCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bywKCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNldExhc3RFcnJvciwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZXNwYWNlID0gJycKICAgICkKCiAgICBCRUdJTgogICAgewogICAgICAgICRUeXBlSGFzaCA9IEB7fQogICAgfQoKICAgIFBST0NFU1MKICAgIHsKICAgICAgICBpZiAoJE1vZHVsZSAtaXMgW1JlZmxlY3Rpb24uQXNzZW1ibHldKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCROYW1lc3BhY2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRUeXBlSGFzaFskRGxsTmFtZV0gPSAkTW9kdWxlLkdldFR5cGUoIiROYW1lc3BhY2UuJERsbE5hbWUiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFR5cGVIYXNoWyREbGxOYW1lXSA9ICRNb2R1bGUuR2V0VHlwZSgkRGxsTmFtZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIERlZmluZSBvbmUgdHlwZSBmb3IgZWFjaCBETEwKICAgICAgICAgICAgaWYgKCEkVHlwZUhhc2guQ29udGFpbnNLZXkoJERsbE5hbWUpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJE5hbWVzcGFjZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkVHlwZUhhc2hbJERsbE5hbWVdID0gJE1vZHVsZS5EZWZpbmVUeXBlKCIkTmFtZXNwYWNlLiREbGxOYW1lIiwgJ1B1YmxpYyxCZWZvcmVGaWVsZEluaXQnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRUeXBlSGFzaFskRGxsTmFtZV0gPSAkTW9kdWxlLkRlZmluZVR5cGUoJERsbE5hbWUsICdQdWJsaWMsQmVmb3JlRmllbGRJbml0JykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJE1ldGhvZCA9ICRUeXBlSGFzaFskRGxsTmFtZV0uRGVmaW5lTWV0aG9kKAogICAgICAgICAgICAgICAgJEZ1bmN0aW9uTmFtZSwKICAgICAgICAgICAgICAgICdQdWJsaWMsU3RhdGljLFBpbnZva2VJbXBsJywKICAgICAgICAgICAgICAgICRSZXR1cm5UeXBlLAogICAgICAgICAgICAgICAgJFBhcmFtZXRlclR5cGVzKQoKICAgICAgICAgICAgIyBNYWtlIGVhY2ggQnlSZWYgcGFyYW1ldGVyIGFuIE91dCBwYXJhbWV0ZXIKICAgICAgICAgICAgJGkgPSAxCiAgICAgICAgICAgIEZvckVhY2goJFBhcmFtZXRlciBpbiAkUGFyYW1ldGVyVHlwZXMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkUGFyYW1ldGVyLklzQnlSZWYpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgW3ZvaWRdICRNZXRob2QuRGVmaW5lUGFyYW1ldGVyKCRpLCAnT3V0JywgJE51bGwpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGkrKwogICAgICAgICAgICB9CgogICAgICAgICAgICAkRGxsSW1wb3J0ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkRsbEltcG9ydEF0dHJpYnV0ZV0KICAgICAgICAgICAgJFNldExhc3RFcnJvckZpZWxkID0gJERsbEltcG9ydC5HZXRGaWVsZCgnU2V0TGFzdEVycm9yJykKICAgICAgICAgICAgJENhbGxpbmdDb252ZW50aW9uRmllbGQgPSAkRGxsSW1wb3J0LkdldEZpZWxkKCdDYWxsaW5nQ29udmVudGlvbicpCiAgICAgICAgICAgICRDaGFyc2V0RmllbGQgPSAkRGxsSW1wb3J0LkdldEZpZWxkKCdDaGFyU2V0JykKICAgICAgICAgICAgaWYgKCRTZXRMYXN0RXJyb3IpIHsgJFNMRVZhbHVlID0gJFRydWUgfSBlbHNlIHsgJFNMRVZhbHVlID0gJEZhbHNlIH0KCiAgICAgICAgICAgICMgRXF1aXZhbGVudCB0byBDIyB2ZXJzaW9uIG9mIFtEbGxJbXBvcnQoRGxsTmFtZSldCiAgICAgICAgICAgICRDb25zdHJ1Y3RvciA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5EbGxJbXBvcnRBdHRyaWJ1dGVdLkdldENvbnN0cnVjdG9yKFtTdHJpbmddKQogICAgICAgICAgICAkRGxsSW1wb3J0QXR0cmlidXRlID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3IsCiAgICAgICAgICAgICAgICAkRGxsTmFtZSwgW1JlZmxlY3Rpb24uUHJvcGVydHlJbmZvW11dIEAoKSwgW09iamVjdFtdXSBAKCksCiAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5GaWVsZEluZm9bXV0gQCgkU2V0TGFzdEVycm9yRmllbGQsICRDYWxsaW5nQ29udmVudGlvbkZpZWxkLCAkQ2hhcnNldEZpZWxkKSwKICAgICAgICAgICAgICAgIFtPYmplY3RbXV0gQCgkU0xFVmFsdWUsIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiksIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF0gJENoYXJzZXQpKSkKCiAgICAgICAgICAgICRNZXRob2QuU2V0Q3VzdG9tQXR0cmlidXRlKCREbGxJbXBvcnRBdHRyaWJ1dGUpCiAgICAgICAgfQogICAgfQoKICAgIEVORAogICAgewogICAgICAgIGlmICgkTW9kdWxlIC1pcyBbUmVmbGVjdGlvbi5Bc3NlbWJseV0pCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJFR5cGVIYXNoCiAgICAgICAgfQoKICAgICAgICAkUmV0dXJuVHlwZXMgPSBAe30KCiAgICAgICAgRm9yRWFjaCAoJEtleSBpbiAkVHlwZUhhc2guS2V5cykKICAgICAgICB7CiAgICAgICAgICAgICRUeXBlID0gJFR5cGVIYXNoWyRLZXldLkNyZWF0ZVR5cGUoKQoKICAgICAgICAgICAgJFJldHVyblR5cGVzWyRLZXldID0gJFR5cGUKICAgICAgICB9CgogICAgICAgIHJldHVybiAkUmV0dXJuVHlwZXMKICAgIH0KfQoKCmZ1bmN0aW9uIHBzZW51bQp7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ3JlYXRlcyBhbiBpbi1tZW1vcnkgZW51bWVyYXRpb24gZm9yIHVzZSBpbiB5b3VyIFBvd2VyU2hlbGwgc2Vzc2lvbi4KCiAgICAgICAgQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgICAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBUaGUgJ3BzZW51bScgZnVuY3Rpb24gZmFjaWxpdGF0ZXMgdGhlIGNyZWF0aW9uIG9mIGVudW1zIGVudGlyZWx5IGluCiAgICAgICAgbWVtb3J5IHVzaW5nIGFzIGNsb3NlIHRvIGEgIkMgc3R5bGUiIGFzIFBvd2VyU2hlbGwgd2lsbCBhbGxvdy4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZQoKICAgICAgICBUaGUgaW4tbWVtb3J5IG1vZHVsZSB0aGF0IHdpbGwgaG9zdCB0aGUgZW51bS4gVXNlCiAgICAgICAgTmV3LUluTWVtb3J5TW9kdWxlIHRvIGRlZmluZSBhbiBpbi1tZW1vcnkgbW9kdWxlLgoKICAgIC5QQVJBTUVURVIgRnVsbE5hbWUKCiAgICAgICAgVGhlIGZ1bGx5LXF1YWxpZmllZCBuYW1lIG9mIHRoZSBlbnVtLgoKICAgIC5QQVJBTUVURVIgVHlwZQoKICAgICAgICBUaGUgdHlwZSBvZiBlYWNoIGVudW0gZWxlbWVudC4KCiAgICAuUEFSQU1FVEVSIEVudW1FbGVtZW50cwoKICAgICAgICBBIGhhc2h0YWJsZSBvZiBlbnVtIGVsZW1lbnRzLgoKICAgIC5QQVJBTUVURVIgQml0ZmllbGQKCiAgICAgICAgU3BlY2lmaWVzIHRoYXQgdGhlIGVudW0gc2hvdWxkIGJlIHRyZWF0ZWQgYXMgYSBiaXRmaWVsZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRJbWFnZVN1YnN5c3RlbSA9IHBzZW51bSAkTW9kIFBFLklNQUdFX1NVQlNZU1RFTSBVSW50MTYgQHsKICAgICAgICAgICAgVU5LTk9XTiA9ICAgICAgICAgICAgICAgICAgMAogICAgICAgICAgICBOQVRJVkUgPSAgICAgICAgICAgICAgICAgICAxICMgSW1hZ2UgZG9lc24ndCByZXF1aXJlIGEgc3Vic3lzdGVtLgogICAgICAgICAgICBXSU5ET1dTX0dVSSA9ICAgICAgICAgICAgICAyICMgSW1hZ2UgcnVucyBpbiB0aGUgV2luZG93cyBHVUkgc3Vic3lzdGVtLgogICAgICAgICAgICBXSU5ET1dTX0NVSSA9ICAgICAgICAgICAgICAzICMgSW1hZ2UgcnVucyBpbiB0aGUgV2luZG93cyBjaGFyYWN0ZXIgc3Vic3lzdGVtLgogICAgICAgICAgICBPUzJfQ1VJID0gICAgICAgICAgICAgICAgICA1ICMgSW1hZ2UgcnVucyBpbiB0aGUgT1MvMiBjaGFyYWN0ZXIgc3Vic3lzdGVtLgogICAgICAgICAgICBQT1NJWF9DVUkgPSAgICAgICAgICAgICAgICA3ICMgSW1hZ2UgcnVucyBpbiB0aGUgUG9zaXggY2hhcmFjdGVyIHN1YnN5c3RlbS4KICAgICAgICAgICAgTkFUSVZFX1dJTkRPV1MgPSAgICAgICAgICAgOCAjIEltYWdlIGlzIGEgbmF0aXZlIFdpbjl4IGRyaXZlci4KICAgICAgICAgICAgV0lORE9XU19DRV9HVUkgPSAgICAgICAgICAgOSAjIEltYWdlIHJ1bnMgaW4gdGhlIFdpbmRvd3MgQ0Ugc3Vic3lzdGVtLgogICAgICAgICAgICBFRklfQVBQTElDQVRJT04gPSAgICAgICAgICAxMAogICAgICAgICAgICBFRklfQk9PVF9TRVJWSUNFX0RSSVZFUiA9ICAxMQogICAgICAgICAgICBFRklfUlVOVElNRV9EUklWRVIgPSAgICAgICAxMgogICAgICAgICAgICBFRklfUk9NID0gICAgICAgICAgICAgICAgICAxMwogICAgICAgICAgICBYQk9YID0gICAgICAgICAgICAgICAgICAgICAxNAogICAgICAgICAgICBXSU5ET1dTX0JPT1RfQVBQTElDQVRJT04gPSAxNgogICAgICAgIH0KCiAgICAuTk9URVMKCiAgICAgICAgUG93ZXJTaGVsbCBwdXJpc3RzIG1heSBkaXNhZ3JlZSB3aXRoIHRoZSBuYW1pbmcgb2YgdGhpcyBmdW5jdGlvbiBidXQKICAgICAgICBhZ2FpbiwgdGhpcyB3YXMgZGV2ZWxvcGVkIGluIHN1Y2ggYSB3YXkgc28gYXMgdG8gZW11bGF0ZSBhICJDIHN0eWxlIgogICAgICAgIGRlZmluaXRpb24gYXMgY2xvc2VseSBhcyBwb3NzaWJsZS4gU29ycnksIEknbSBub3QgZ29pbmcgdG8gbmFtZSBpdAogICAgICAgIE5ldy1FbnVtLiA6UAojPgoKICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRnVsbE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1R5cGVdCiAgICAgICAgJFR5cGUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRFbnVtRWxlbWVudHMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEJpdGZpZWxkCiAgICApCgogICAgaWYgKCRNb2R1bGUgLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSkKICAgIHsKICAgICAgICByZXR1cm4gKCRNb2R1bGUuR2V0VHlwZSgkRnVsbE5hbWUpKQogICAgfQoKICAgICRFbnVtVHlwZSA9ICRUeXBlIC1hcyBbVHlwZV0KCiAgICAkRW51bUJ1aWxkZXIgPSAkTW9kdWxlLkRlZmluZUVudW0oJEZ1bGxOYW1lLCAnUHVibGljJywgJEVudW1UeXBlKQoKICAgIGlmICgkQml0ZmllbGQpCiAgICB7CiAgICAgICAgJEZsYWdzQ29uc3RydWN0b3IgPSBbRmxhZ3NBdHRyaWJ1dGVdLkdldENvbnN0cnVjdG9yKEAoKSkKICAgICAgICAkRmxhZ3NDdXN0b21BdHRyaWJ1dGUgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uRW1pdC5DdXN0b21BdHRyaWJ1dGVCdWlsZGVyKCRGbGFnc0NvbnN0cnVjdG9yLCBAKCkpCiAgICAgICAgJEVudW1CdWlsZGVyLlNldEN1c3RvbUF0dHJpYnV0ZSgkRmxhZ3NDdXN0b21BdHRyaWJ1dGUpCiAgICB9CgogICAgRm9yRWFjaCAoJEtleSBpbiAkRW51bUVsZW1lbnRzLktleXMpCiAgICB7CiAgICAgICAgIyBBcHBseSB0aGUgc3BlY2lmaWVkIGVudW0gdHlwZSB0byBlYWNoIGVsZW1lbnQKICAgICAgICAkTnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCRLZXksICRFbnVtRWxlbWVudHNbJEtleV0gLWFzICRFbnVtVHlwZSkKICAgIH0KCiAgICAkRW51bUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCn0KCgojIEEgaGVscGVyIGZ1bmN0aW9uIHVzZWQgdG8gcmVkdWNlIHR5cGluZyB3aGlsZSBkZWZpbmluZyBzdHJ1Y3QKIyBmaWVsZHMuCmZ1bmN0aW9uIGZpZWxkCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVUludDE2XQogICAgICAgICRQb3NpdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIpXQogICAgICAgIFtVSW50MTZdCiAgICAgICAgJE9mZnNldCwKCiAgICAgICAgW09iamVjdFtdXQogICAgICAgICRNYXJzaGFsQXMKICAgICkKCiAgICBAewogICAgICAgIFBvc2l0aW9uID0gJFBvc2l0aW9uCiAgICAgICAgVHlwZSA9ICRUeXBlIC1hcyBbVHlwZV0KICAgICAgICBPZmZzZXQgPSAkT2Zmc2V0CiAgICAgICAgTWFyc2hhbEFzID0gJE1hcnNoYWxBcwogICAgfQp9CgoKZnVuY3Rpb24gc3RydWN0CnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGFuIGluLW1lbW9yeSBzdHJ1Y3QgZm9yIHVzZSBpbiB5b3VyIFBvd2VyU2hlbGwgc2Vzc2lvbi4KCiAgICAgICAgQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgICAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBPcHRpb25hbCBEZXBlbmRlbmNpZXM6IGZpZWxkCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFRoZSAnc3RydWN0JyBmdW5jdGlvbiBmYWNpbGl0YXRlcyB0aGUgY3JlYXRpb24gb2Ygc3RydWN0cyBlbnRpcmVseSBpbgogICAgICAgIG1lbW9yeSB1c2luZyBhcyBjbG9zZSB0byBhICJDIHN0eWxlIiBhcyBQb3dlclNoZWxsIHdpbGwgYWxsb3cuIFN0cnVjdAogICAgICAgIGZpZWxkcyBhcmUgc3BlY2lmaWVkIHVzaW5nIGEgaGFzaHRhYmxlIHdoZXJlIGVhY2ggZmllbGQgb2YgdGhlIHN0cnVjdAogICAgICAgIGlzIGNvbXByb3NlZCBvZiB0aGUgb3JkZXIgaW4gd2hpY2ggaXQgc2hvdWxkIGJlIGRlZmluZWQsIGl0cyAuTkVUCiAgICAgICAgdHlwZSwgYW5kIG9wdGlvbmFsbHksIGl0cyBvZmZzZXQgYW5kIHNwZWNpYWwgbWFyc2hhbGluZyBhdHRyaWJ1dGVzLgoKICAgICAgICBPbmUgb2YgdGhlIGZlYXR1cmVzIG9mICdzdHJ1Y3QnIGlzIHRoYXQgYWZ0ZXIgeW91ciBzdHJ1Y3QgaXMgZGVmaW5lZCwKICAgICAgICBpdCB3aWxsIGNvbWUgd2l0aCBhIGJ1aWx0LWluIEdldFNpemUgbWV0aG9kIGFzIHdlbGwgYXMgYW4gZXhwbGljaXQKICAgICAgICBjb252ZXJ0ZXIgc28gdGhhdCB5b3UgY2FuIGVhc2lseSBjYXN0IGFuIEludFB0ciB0byB0aGUgc3RydWN0IHdpdGhvdXQKICAgICAgICByZWx5aW5nIHVwb24gY2FsbGluZyBTaXplT2YgYW5kL29yIFB0clRvU3RydWN0dXJlIGluIHRoZSBNYXJzaGFsCiAgICAgICAgY2xhc3MuCgogICAgLlBBUkFNRVRFUiBNb2R1bGUKCiAgICAgICAgVGhlIGluLW1lbW9yeSBtb2R1bGUgdGhhdCB3aWxsIGhvc3QgdGhlIHN0cnVjdC4gVXNlCiAgICAgICAgTmV3LUluTWVtb3J5TW9kdWxlIHRvIGRlZmluZSBhbiBpbi1tZW1vcnkgbW9kdWxlLgoKICAgIC5QQVJBTUVURVIgRnVsbE5hbWUKCiAgICAgICAgVGhlIGZ1bGx5LXF1YWxpZmllZCBuYW1lIG9mIHRoZSBzdHJ1Y3QuCgogICAgLlBBUkFNRVRFUiBTdHJ1Y3RGaWVsZHMKCiAgICAgICAgQSBoYXNodGFibGUgb2YgZmllbGRzLiBVc2UgdGhlICdmaWVsZCcgaGVscGVyIGZ1bmN0aW9uIHRvIGVhc2UKICAgICAgICBkZWZpbmluZyBlYWNoIGZpZWxkLgoKICAgIC5QQVJBTUVURVIgUGFja2luZ1NpemUKCiAgICAgICAgU3BlY2lmaWVzIHRoZSBtZW1vcnkgYWxpZ25tZW50IG9mIGZpZWxkcy4KCiAgICAuUEFSQU1FVEVSIEV4cGxpY2l0TGF5b3V0CgogICAgICAgIEluZGljYXRlcyB0aGF0IGFuIGV4cGxpY2l0IG9mZnNldCBmb3IgZWFjaCBmaWVsZCB3aWxsIGJlIHNwZWNpZmllZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRJbWFnZURvc1NpZ25hdHVyZSA9IHBzZW51bSAkTW9kIFBFLklNQUdFX0RPU19TSUdOQVRVUkUgVUludDE2IEB7CiAgICAgICAgICAgIERPU19TSUdOQVRVUkUgPSAgICAweDVBNEQKICAgICAgICAgICAgT1MyX1NJR05BVFVSRSA9ICAgIDB4NDU0RQogICAgICAgICAgICBPUzJfU0lHTkFUVVJFX0xFID0gMHg0NTRDCiAgICAgICAgICAgIFZYRF9TSUdOQVRVUkUgPSAgICAweDQ1NEMKICAgICAgICB9CgogICAgICAgICRJbWFnZURvc0hlYWRlciA9IHN0cnVjdCAkTW9kIFBFLklNQUdFX0RPU19IRUFERVIgQHsKICAgICAgICAgICAgZV9tYWdpYyA9ICAgIGZpZWxkIDAgJEltYWdlRG9zU2lnbmF0dXJlCiAgICAgICAgICAgIGVfY2JscCA9ICAgICBmaWVsZCAxIFVJbnQxNgogICAgICAgICAgICBlX2NwID0gICAgICAgZmllbGQgMiBVSW50MTYKICAgICAgICAgICAgZV9jcmxjID0gICAgIGZpZWxkIDMgVUludDE2CiAgICAgICAgICAgIGVfY3BhcmhkciA9ICBmaWVsZCA0IFVJbnQxNgogICAgICAgICAgICBlX21pbmFsbG9jID0gZmllbGQgNSBVSW50MTYKICAgICAgICAgICAgZV9tYXhhbGxvYyA9IGZpZWxkIDYgVUludDE2CiAgICAgICAgICAgIGVfc3MgPSAgICAgICBmaWVsZCA3IFVJbnQxNgogICAgICAgICAgICBlX3NwID0gICAgICAgZmllbGQgOCBVSW50MTYKICAgICAgICAgICAgZV9jc3VtID0gICAgIGZpZWxkIDkgVUludDE2CiAgICAgICAgICAgIGVfaXAgPSAgICAgICBmaWVsZCAxMCBVSW50MTYKICAgICAgICAgICAgZV9jcyA9ICAgICAgIGZpZWxkIDExIFVJbnQxNgogICAgICAgICAgICBlX2xmYXJsYyA9ICAgZmllbGQgMTIgVUludDE2CiAgICAgICAgICAgIGVfb3ZubyA9ICAgICBmaWVsZCAxMyBVSW50MTYKICAgICAgICAgICAgZV9yZXMgPSAgICAgIGZpZWxkIDE0IFVJbnQxNltdIC1NYXJzaGFsQXMgQCgnQnlWYWxBcnJheScsIDQpCiAgICAgICAgICAgIGVfb2VtaWQgPSAgICBmaWVsZCAxNSBVSW50MTYKICAgICAgICAgICAgZV9vZW1pbmZvID0gIGZpZWxkIDE2IFVJbnQxNgogICAgICAgICAgICBlX3JlczIgPSAgICAgZmllbGQgMTcgVUludDE2W10gLU1hcnNoYWxBcyBAKCdCeVZhbEFycmF5JywgMTApCiAgICAgICAgICAgIGVfbGZhbmV3ID0gICBmaWVsZCAxOCBJbnQzMgogICAgICAgIH0KCiAgICAgICAgIyBFeGFtcGxlIG9mIHVzaW5nIGFuIGV4cGxpY2l0IGxheW91dCBpbiBvcmRlciB0byBjcmVhdGUgYSB1bmlvbi4KICAgICAgICAkVGVzdFVuaW9uID0gc3RydWN0ICRNb2QgVGVzdFVuaW9uIEB7CiAgICAgICAgICAgIGZpZWxkMSA9IGZpZWxkIDAgVUludDMyIDAKICAgICAgICAgICAgZmllbGQyID0gZmllbGQgMSBJbnRQdHIgMAogICAgICAgIH0gLUV4cGxpY2l0TGF5b3V0CgogICAgLk5PVEVTCgogICAgICAgIFBvd2VyU2hlbGwgcHVyaXN0cyBtYXkgZGlzYWdyZWUgd2l0aCB0aGUgbmFtaW5nIG9mIHRoaXMgZnVuY3Rpb24gYnV0CiAgICAgICAgYWdhaW4sIHRoaXMgd2FzIGRldmVsb3BlZCBpbiBzdWNoIGEgd2F5IHNvIGFzIHRvIGVtdWxhdGUgYSAiQyBzdHlsZSIKICAgICAgICBkZWZpbml0aW9uIGFzIGNsb3NlbHkgYXMgcG9zc2libGUuIFNvcnJ5LCBJJ20gbm90IGdvaW5nIHRvIG5hbWUgaXQKICAgICAgICBOZXctU3RydWN0LiA6UAojPgoKICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMiwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRnVsbE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRTdHJ1Y3RGaWVsZHMsCgogICAgICAgIFtSZWZsZWN0aW9uLkVtaXQuUGFja2luZ1NpemVdCiAgICAgICAgJFBhY2tpbmdTaXplID0gW1JlZmxlY3Rpb24uRW1pdC5QYWNraW5nU2l6ZV06OlVuc3BlY2lmaWVkLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeHBsaWNpdExheW91dAogICAgKQoKICAgIGlmICgkTW9kdWxlIC1pcyBbUmVmbGVjdGlvbi5Bc3NlbWJseV0pCiAgICB7CiAgICAgICAgcmV0dXJuICgkTW9kdWxlLkdldFR5cGUoJEZ1bGxOYW1lKSkKICAgIH0KCiAgICBbUmVmbGVjdGlvbi5UeXBlQXR0cmlidXRlc10gJFN0cnVjdEF0dHJpYnV0ZXMgPSAnQW5zaUNsYXNzLAogICAgICAgIENsYXNzLAogICAgICAgIFB1YmxpYywKICAgICAgICBTZWFsZWQsCiAgICAgICAgQmVmb3JlRmllbGRJbml0JwoKICAgIGlmICgkRXhwbGljaXRMYXlvdXQpCiAgICB7CiAgICAgICAgJFN0cnVjdEF0dHJpYnV0ZXMgPSAkU3RydWN0QXR0cmlidXRlcyAtYm9yIFtSZWZsZWN0aW9uLlR5cGVBdHRyaWJ1dGVzXTo6RXhwbGljaXRMYXlvdXQKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkU3RydWN0QXR0cmlidXRlcyA9ICRTdHJ1Y3RBdHRyaWJ1dGVzIC1ib3IgW1JlZmxlY3Rpb24uVHlwZUF0dHJpYnV0ZXNdOjpTZXF1ZW50aWFsTGF5b3V0CiAgICB9CgogICAgJFN0cnVjdEJ1aWxkZXIgPSAkTW9kdWxlLkRlZmluZVR5cGUoJEZ1bGxOYW1lLCAkU3RydWN0QXR0cmlidXRlcywgW1ZhbHVlVHlwZV0sICRQYWNraW5nU2l6ZSkKICAgICRDb25zdHJ1Y3RvckluZm8gPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbEFzQXR0cmlidXRlXS5HZXRDb25zdHJ1Y3RvcnMoKVswXQogICAgJFNpemVDb25zdCA9IEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxBc0F0dHJpYnV0ZV0uR2V0RmllbGQoJ1NpemVDb25zdCcpKQoKICAgICRGaWVsZHMgPSBOZXctT2JqZWN0IEhhc2h0YWJsZVtdKCRTdHJ1Y3RGaWVsZHMuQ291bnQpCgogICAgIyBTb3J0IGVhY2ggZmllbGQgYWNjb3JkaW5nIHRvIHRoZSBvcmRlcnMgc3BlY2lmaWVkCiAgICAjIFVuZm9ydHVuYXRlbHksIFBTdjIgZG9lc24ndCBoYXZlIHRoZSBsdXh1cnkgb2YgdGhlCiAgICAjIGhhc2h0YWJsZSBbT3JkZXJlZF0gYWNjZWxlcmF0b3IuCiAgICBGb3JFYWNoICgkRmllbGQgaW4gJFN0cnVjdEZpZWxkcy5LZXlzKQogICAgewogICAgICAgICRJbmRleCA9ICRTdHJ1Y3RGaWVsZHNbJEZpZWxkXVsnUG9zaXRpb24nXQogICAgICAgICRGaWVsZHNbJEluZGV4XSA9IEB7RmllbGROYW1lID0gJEZpZWxkOyBQcm9wZXJ0aWVzID0gJFN0cnVjdEZpZWxkc1skRmllbGRdfQogICAgfQoKICAgIEZvckVhY2ggKCRGaWVsZCBpbiAkRmllbGRzKQogICAgewogICAgICAgICRGaWVsZE5hbWUgPSAkRmllbGRbJ0ZpZWxkTmFtZSddCiAgICAgICAgJEZpZWxkUHJvcCA9ICRGaWVsZFsnUHJvcGVydGllcyddCgogICAgICAgICRPZmZzZXQgPSAkRmllbGRQcm9wWydPZmZzZXQnXQogICAgICAgICRUeXBlID0gJEZpZWxkUHJvcFsnVHlwZSddCiAgICAgICAgJE1hcnNoYWxBcyA9ICRGaWVsZFByb3BbJ01hcnNoYWxBcyddCgogICAgICAgICROZXdGaWVsZCA9ICRTdHJ1Y3RCdWlsZGVyLkRlZmluZUZpZWxkKCRGaWVsZE5hbWUsICRUeXBlLCAnUHVibGljJykKCiAgICAgICAgaWYgKCRNYXJzaGFsQXMpCiAgICAgICAgewogICAgICAgICAgICAkVW5tYW5hZ2VkVHlwZSA9ICRNYXJzaGFsQXNbMF0gLWFzIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuVW5tYW5hZ2VkVHlwZV0pCiAgICAgICAgICAgIGlmICgkTWFyc2hhbEFzWzFdKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkU2l6ZSA9ICRNYXJzaGFsQXNbMV0KICAgICAgICAgICAgICAgICRBdHRyaWJCdWlsZGVyID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3JJbmZvLAogICAgICAgICAgICAgICAgICAgICRVbm1hbmFnZWRUeXBlLCAkU2l6ZUNvbnN0LCBAKCRTaXplKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRBdHRyaWJCdWlsZGVyID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3JJbmZvLCBbT2JqZWN0W11dIEAoJFVubWFuYWdlZFR5cGUpKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkTmV3RmllbGQuU2V0Q3VzdG9tQXR0cmlidXRlKCRBdHRyaWJCdWlsZGVyKQogICAgICAgIH0KCiAgICAgICAgaWYgKCRFeHBsaWNpdExheW91dCkgeyAkTmV3RmllbGQuU2V0T2Zmc2V0KCRPZmZzZXQpIH0KICAgIH0KCiAgICAjIE1ha2UgdGhlIHN0cnVjdCBhd2FyZSBvZiBpdHMgb3duIHNpemUuCiAgICAjIE5vIG1vcmUgaGF2aW5nIHRvIGNhbGwgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTaXplT2YhCiAgICAkU2l6ZU1ldGhvZCA9ICRTdHJ1Y3RCdWlsZGVyLkRlZmluZU1ldGhvZCgnR2V0U2l6ZScsCiAgICAgICAgJ1B1YmxpYywgU3RhdGljJywKICAgICAgICBbSW50XSwKICAgICAgICBbVHlwZVtdXSBAKCkpCiAgICAkSUxHZW5lcmF0b3IgPSAkU2l6ZU1ldGhvZC5HZXRJTEdlbmVyYXRvcigpCiAgICAjIFRoYW5rcyBmb3IgdGhlIGhlbHAsIEphc29uIFNoaXJrIQogICAgJElMR2VuZXJhdG9yLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6TGR0b2tlbiwgJFN0cnVjdEJ1aWxkZXIpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtUeXBlXS5HZXRNZXRob2QoJ0dldFR5cGVGcm9tSGFuZGxlJykpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXS5HZXRNZXRob2QoJ1NpemVPZicsIFtUeXBlW11dIEAoW1R5cGVdKSkpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpSZXQpCgogICAgIyBBbGxvdyBmb3IgZXhwbGljaXQgY2FzdGluZyBmcm9tIGFuIEludFB0cgogICAgIyBObyBtb3JlIGhhdmluZyB0byBjYWxsIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJ1Y3R1cmUhCiAgICAkSW1wbGljaXRDb252ZXJ0ZXIgPSAkU3RydWN0QnVpbGRlci5EZWZpbmVNZXRob2QoJ29wX0ltcGxpY2l0JywKICAgICAgICAnUHJpdmF0ZVNjb3BlLCBQdWJsaWMsIFN0YXRpYywgSGlkZUJ5U2lnLCBTcGVjaWFsTmFtZScsCiAgICAgICAgJFN0cnVjdEJ1aWxkZXIsCiAgICAgICAgW1R5cGVbXV0gQChbSW50UHRyXSkpCiAgICAkSUxHZW5lcmF0b3IyID0gJEltcGxpY2l0Q29udmVydGVyLkdldElMR2VuZXJhdG9yKCkKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpOb3ApCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6TGRhcmdfMCkKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpMZHRva2VuLCAkU3RydWN0QnVpbGRlcikKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtUeXBlXS5HZXRNZXRob2QoJ0dldFR5cGVGcm9tSGFuZGxlJykpCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6Q2FsbCwKICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF0uR2V0TWV0aG9kKCdQdHJUb1N0cnVjdHVyZScsIFtUeXBlW11dIEAoW0ludFB0cl0sIFtUeXBlXSkpKQogICAgJElMR2VuZXJhdG9yMi5FbWl0KFtSZWZsZWN0aW9uLkVtaXQuT3BDb2Rlc106OlVuYm94X0FueSwgJFN0cnVjdEJ1aWxkZXIpCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6UmV0KQoKICAgICRTdHJ1Y3RCdWlsZGVyLkNyZWF0ZVR5cGUoKQp9CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIE1pc2MuIGhlbHBlcnMKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZmlsdGVyIEV4cG9ydC1Qb3dlclZpZXdDU1Ygewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgaGVscGVyIGV4cG9ydHMgYW4gLUlucHV0T2JqZWN0IHRvIGEgLmNzdiBpbiBhIHRocmVhZC1zYWZlIG1hbm5lcgogICAgICAgIHVzaW5nIGEgbXV0ZXguIFRoaXMgaXMgc28gdGhlIHZhcmlvdXMgbXVsdGktdGhyZWFkZWQgZnVuY3Rpb25zIGluCiAgICAgICAgUG93ZXJWaWV3IGhhcyBhIHRocmVhZC1zYWZlIHdheSB0byBleHBvcnQgb3V0cHV0IHRvIHRoZSBzYW1lIGZpbGUuCiAgICAgICAgCiAgICAgICAgQmFzZWQgcGFydGlhbGx5IG9uIERtaXRyeSBTb3RuaWtvdidzIEV4cG9ydC1DU1YgY29kZQogICAgICAgICAgICBhdCBodHRwOi8vcG9zaGNvZGUub3JnLzE1OTAKCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vcG9zaGNvZGUub3JnLzE1OTAKICAgICAgICBodHRwOi8vZG1pdHJ5c290bmlrb3Yud29yZHByZXNzLmNvbS8yMDEwLzAxLzE5L0V4cG9ydC1Dc3YtYXBwZW5kLwojPgogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSRUcnVlKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU09iamVjdFtdXQogICAgICAgICRJbnB1dE9iamVjdCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFBvc2l0aW9uPTApXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkT3V0RmlsZQogICAgKQoKICAgICRPYmplY3RDU1YgPSAkSW5wdXRPYmplY3QgfCBDb252ZXJ0VG8tQ3N2IC1Ob1R5cGVJbmZvcm1hdGlvbgoKICAgICMgbXV0ZXggc28gdGhyZWFkZWQgY29kZSBkb2Vzbid0IHN0b21wIG9uIHRoZSBvdXRwdXQgZmlsZQogICAgJE11dGV4ID0gTmV3LU9iamVjdCBTeXN0ZW0uVGhyZWFkaW5nLk11dGV4ICRGYWxzZSwnQ1NWTXV0ZXgnOwogICAgJE51bGwgPSAkTXV0ZXguV2FpdE9uZSgpCgogICAgaWYgKFRlc3QtUGF0aCAtUGF0aCAkT3V0RmlsZSkgewogICAgICAgICMgaGFjayB0byBza2lwIHRoZSBmaXJzdCBsaW5lIG9mIG91dHB1dCBpZiB0aGUgZmlsZSBhbHJlYWR5IGV4aXN0cwogICAgICAgICRPYmplY3RDU1YgfCBGb3JFYWNoLU9iamVjdCB7ICRTdGFydD0kVHJ1ZSB9eyBpZiAoJFN0YXJ0KSB7JFN0YXJ0PSRGYWxzZX0gZWxzZSB7JF99IH0gfCBPdXQtRmlsZSAtRW5jb2RpbmcgJ0FTQ0lJJyAtQXBwZW5kIC1GaWxlUGF0aCAkT3V0RmlsZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJE9iamVjdENTViB8IE91dC1GaWxlIC1FbmNvZGluZyAnQVNDSUknIC1BcHBlbmQgLUZpbGVQYXRoICRPdXRGaWxlCiAgICB9CgogICAgJE11dGV4LlJlbGVhc2VNdXRleCgpCn0KCgpmaWx0ZXIgR2V0LUlQQWRkcmVzcyB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmVzb2x2ZXMgYSBnaXZlbiBob3N0ZW5hbWUgdG8gaXRzIGFzc29jaWF0ZWQgSVB2NCBhZGRyZXNzLiAKICAgICAgICBJZiBubyBob3N0bmFtZSBpcyBwcm92aWRlZCwgaXQgZGVmYXVsdHMgdG8gcmV0dXJuaW5nCiAgICAgICAgdGhlIElQIGFkZHJlc3Mgb2YgdGhlIGxvY2FsaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1JUEFkZHJlc3MgLUNvbXB1dGVyTmFtZSBTRVJWRVIKICAgICAgICAKICAgICAgICBSZXR1cm4gdGhlIElQdjQgYWRkcmVzcyBvZiAnU0VSVkVSJwoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUNvbnRlbnQgLlxob3N0bmFtZXMudHh0IHwgR2V0LUlQQWRkcmVzcwoKICAgICAgICBHZXQgdGhlIElQIGFkZHJlc3NlcyBvZiBhbGwgaG9zdG5hbWVzIGluIGFuIGlucHV0IGZpbGUuCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdE5hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUgPSAkRW52OkNvbXB1dGVyTmFtZQogICAgKQoKICAgIHRyeSB7CiAgICAgICAgIyBleHRyYWN0IHRoZSBjb21wdXRlciBuYW1lIGZyb20gd2hhdGV2ZXIgb2JqZWN0IHdhcyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAgICAgJENvbXB1dGVyID0gJENvbXB1dGVyTmFtZSB8IEdldC1OYW1lRmllbGQKCiAgICAgICAgIyBnZXQgdGhlIElQIHJlc29sdXRpb24gb2YgdGhpcyBzcGVjaWZpZWQgaG9zdG5hbWUKICAgICAgICBAKChbTmV0LkRuc106OkdldEhvc3RFbnRyeSgkQ29tcHV0ZXIpKS5BZGRyZXNzTGlzdCkgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIGlmICgkXy5BZGRyZXNzRmFtaWx5IC1lcSAnSW50ZXJOZXR3b3JrJykgewogICAgICAgICAgICAgICAgJE91dCA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXIKICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSVBBZGRyZXNzJyAkXy5JUEFkZHJlc3NUb1N0cmluZwogICAgICAgICAgICAgICAgJE91dAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgJ0NvdWxkIG5vdCByZXNvbHZlIGhvc3QgdG8gYW4gSVAgQWRkcmVzcy4nCiAgICB9Cn0KCgpmaWx0ZXIgQ29udmVydC1OYW1lVG9TaWQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIENvbnZlcnRzIGEgZ2l2ZW4gdXNlci9ncm91cCBuYW1lIHRvIGEgc2VjdXJpdHkgaWRlbnRpZmllciAoU0lEKS4KCiAgICAuUEFSQU1FVEVSIE9iamVjdE5hbWUKCiAgICAgICAgVGhlIHVzZXIvZ3JvdXAgbmFtZSB0byBjb252ZXJ0LCBjYW4gYmUgJ3VzZXInIG9yICdET01BSU5cdXNlcicgZm9ybWF0LgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFNwZWNpZmljIGRvbWFpbiBmb3IgdGhlIGdpdmVuIHVzZXIgYWNjb3VudCwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQ29udmVydC1OYW1lVG9TaWQgJ0RFVlxkZm0nCiM+CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgIFtBbGlhcygnTmFtZScpXQogICAgICAgICRPYmplY3ROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4KICAgICkKCiAgICAkT2JqZWN0TmFtZSA9ICRPYmplY3ROYW1lIC1SZXBsYWNlICIvIiwiXCIKICAgIAogICAgaWYoJE9iamVjdE5hbWUuQ29udGFpbnMoIlwiKSkgewogICAgICAgICMgaWYgd2UgZ2V0IGEgRE9NQUlOXHVzZXIgZm9ybWF0LCBhdXRvIGNvbnZlcnQgaXQKICAgICAgICAkRG9tYWluID0gJE9iamVjdE5hbWUuU3BsaXQoIlwiKVswXQogICAgICAgICRPYmplY3ROYW1lID0gJE9iamVjdE5hbWUuU3BsaXQoIlwiKVsxXQogICAgfQogICAgZWxzZWlmKCEkRG9tYWluKSB7CiAgICAgICAgJERvbWFpbiA9IChHZXQtTmV0RG9tYWluKS5OYW1lCiAgICB9CgogICAgdHJ5IHsKICAgICAgICAkT2JqID0gKE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5OVEFjY291bnQoJERvbWFpbiwgJE9iamVjdE5hbWUpKQogICAgICAgICRTSUQgPSAkT2JqLlRyYW5zbGF0ZShbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKS5WYWx1ZQogICAgICAgIAogICAgICAgICRPdXQgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgJE91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3ROYW1lJyAkT2JqZWN0TmFtZQogICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU0lEJyAkU0lECiAgICAgICAgJE91dAogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLVZlcmJvc2UgIkludmFsaWQgb2JqZWN0L25hbWU6ICREb21haW5cJE9iamVjdE5hbWUiCiAgICAgICAgJE51bGwKICAgIH0KfQoKCmZpbHRlciBDb252ZXJ0LVNpZFRvTmFtZSB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIENvbnZlcnRzIGEgc2VjdXJpdHkgaWRlbnRpZmllciAoU0lEKSB0byBhIGdyb3VwL3VzZXIgbmFtZS4KCiAgICAuUEFSQU1FVEVSIFNJRAogICAgCiAgICAgICAgVGhlIFNJRCB0byBjb252ZXJ0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQ29udmVydC1TaWRUb05hbWUgUy0xLTUtMjEtMjYyMDg5MTgyOS0yNDExMjYxNDk3LTE3NzM4NTMwODgtMTEwNQojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVQYXR0ZXJuKCdeUy0xLS4qJyldCiAgICAgICAgJFNJRAogICAgKQoKICAgIHRyeSB7CiAgICAgICAgJFNJRDIgPSAkU0lELnRyaW0oJyonKQoKICAgICAgICAjIHRyeSB0byByZXNvbHZlIGFueSBidWlsdC1pbiBTSURzIGZpcnN0CiAgICAgICAgIyAgIGZyb20gaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20vZW4tdXMva2IvMjQzMzMwCiAgICAgICAgU3dpdGNoICgkU0lEMikKICAgICAgICB7CiAgICAgICAgICAgICdTLTEtMCcgICAgICAgICB7ICdOdWxsIEF1dGhvcml0eScgfQogICAgICAgICAgICAnUy0xLTAtMCcgICAgICAgeyAnTm9ib2R5JyB9CiAgICAgICAgICAgICdTLTEtMScgICAgICAgICB7ICdXb3JsZCBBdXRob3JpdHknIH0KICAgICAgICAgICAgJ1MtMS0xLTAnICAgICAgIHsgJ0V2ZXJ5b25lJyB9CiAgICAgICAgICAgICdTLTEtMicgICAgICAgICB7ICdMb2NhbCBBdXRob3JpdHknIH0KICAgICAgICAgICAgJ1MtMS0yLTAnICAgICAgIHsgJ0xvY2FsJyB9CiAgICAgICAgICAgICdTLTEtMi0xJyAgICAgICB7ICdDb25zb2xlIExvZ29uICcgfQogICAgICAgICAgICAnUy0xLTMnICAgICAgICAgeyAnQ3JlYXRvciBBdXRob3JpdHknIH0KICAgICAgICAgICAgJ1MtMS0zLTAnICAgICAgIHsgJ0NyZWF0b3IgT3duZXInIH0KICAgICAgICAgICAgJ1MtMS0zLTEnICAgICAgIHsgJ0NyZWF0b3IgR3JvdXAnIH0KICAgICAgICAgICAgJ1MtMS0zLTInICAgICAgIHsgJ0NyZWF0b3IgT3duZXIgU2VydmVyJyB9CiAgICAgICAgICAgICdTLTEtMy0zJyAgICAgICB7ICdDcmVhdG9yIEdyb3VwIFNlcnZlcicgfQogICAgICAgICAgICAnUy0xLTMtNCcgICAgICAgeyAnT3duZXIgUmlnaHRzJyB9CiAgICAgICAgICAgICdTLTEtNCcgICAgICAgICB7ICdOb24tdW5pcXVlIEF1dGhvcml0eScgfQogICAgICAgICAgICAnUy0xLTUnICAgICAgICAgeyAnTlQgQXV0aG9yaXR5JyB9CiAgICAgICAgICAgICdTLTEtNS0xJyAgICAgICB7ICdEaWFsdXAnIH0KICAgICAgICAgICAgJ1MtMS01LTInICAgICAgIHsgJ05ldHdvcmsnIH0KICAgICAgICAgICAgJ1MtMS01LTMnICAgICAgIHsgJ0JhdGNoJyB9CiAgICAgICAgICAgICdTLTEtNS00JyAgICAgICB7ICdJbnRlcmFjdGl2ZScgfQogICAgICAgICAgICAnUy0xLTUtNicgICAgICAgeyAnU2VydmljZScgfQogICAgICAgICAgICAnUy0xLTUtNycgICAgICAgeyAnQW5vbnltb3VzJyB9CiAgICAgICAgICAgICdTLTEtNS04JyAgICAgICB7ICdQcm94eScgfQogICAgICAgICAgICAnUy0xLTUtOScgICAgICAgeyAnRW50ZXJwcmlzZSBEb21haW4gQ29udHJvbGxlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTEwJyAgICAgIHsgJ1ByaW5jaXBhbCBTZWxmJyB9CiAgICAgICAgICAgICdTLTEtNS0xMScgICAgICB7ICdBdXRoZW50aWNhdGVkIFVzZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0xMicgICAgICB7ICdSZXN0cmljdGVkIENvZGUnIH0KICAgICAgICAgICAgJ1MtMS01LTEzJyAgICAgIHsgJ1Rlcm1pbmFsIFNlcnZlciBVc2VycycgfQogICAgICAgICAgICAnUy0xLTUtMTQnICAgICAgeyAnUmVtb3RlIEludGVyYWN0aXZlIExvZ29uJyB9CiAgICAgICAgICAgICdTLTEtNS0xNScgICAgICB7ICdUaGlzIE9yZ2FuaXphdGlvbiAnIH0KICAgICAgICAgICAgJ1MtMS01LTE3JyAgICAgIHsgJ1RoaXMgT3JnYW5pemF0aW9uICcgfQogICAgICAgICAgICAnUy0xLTUtMTgnICAgICAgeyAnTG9jYWwgU3lzdGVtJyB9CiAgICAgICAgICAgICdTLTEtNS0xOScgICAgICB7ICdOVCBBdXRob3JpdHknIH0KICAgICAgICAgICAgJ1MtMS01LTIwJyAgICAgIHsgJ05UIEF1dGhvcml0eScgfQogICAgICAgICAgICAnUy0xLTUtODAtMCcgICAgeyAnQWxsIFNlcnZpY2VzICcgfQogICAgICAgICAgICAnUy0xLTUtMzItNTQ0JyAgeyAnQlVJTFRJTlxBZG1pbmlzdHJhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTQ1JyAgeyAnQlVJTFRJTlxVc2VycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTQ2JyAgeyAnQlVJTFRJTlxHdWVzdHMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU0NycgIHsgJ0JVSUxUSU5cUG93ZXIgVXNlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU0OCcgIHsgJ0JVSUxUSU5cQWNjb3VudCBPcGVyYXRvcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU0OScgIHsgJ0JVSUxUSU5cU2VydmVyIE9wZXJhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTUwJyAgeyAnQlVJTFRJTlxQcmludCBPcGVyYXRvcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU1MScgIHsgJ0JVSUxUSU5cQmFja3VwIE9wZXJhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTUyJyAgeyAnQlVJTFRJTlxSZXBsaWNhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTU0JyAgeyAnQlVJTFRJTlxQcmUtV2luZG93cyAyMDAwIENvbXBhdGlibGUgQWNjZXNzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NTUnICB7ICdCVUlMVElOXFJlbW90ZSBEZXNrdG9wIFVzZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NTYnICB7ICdCVUlMVElOXE5ldHdvcmsgQ29uZmlndXJhdGlvbiBPcGVyYXRvcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU1NycgIHsgJ0JVSUxUSU5cSW5jb21pbmcgRm9yZXN0IFRydXN0IEJ1aWxkZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NTgnICB7ICdCVUlMVElOXFBlcmZvcm1hbmNlIE1vbml0b3IgVXNlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU1OScgIHsgJ0JVSUxUSU5cUGVyZm9ybWFuY2UgTG9nIFVzZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NjAnICB7ICdCVUlMVElOXFdpbmRvd3MgQXV0aG9yaXphdGlvbiBBY2Nlc3MgR3JvdXAnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU2MScgIHsgJ0JVSUxUSU5cVGVybWluYWwgU2VydmVyIExpY2Vuc2UgU2VydmVycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTYyJyAgeyAnQlVJTFRJTlxEaXN0cmlidXRlZCBDT00gVXNlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU2OScgIHsgJ0JVSUxUSU5cQ3J5cHRvZ3JhcGhpYyBPcGVyYXRvcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU3MycgIHsgJ0JVSUxUSU5cRXZlbnQgTG9nIFJlYWRlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU3NCcgIHsgJ0JVSUxUSU5cQ2VydGlmaWNhdGUgU2VydmljZSBEQ09NIEFjY2VzcycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTc1JyAgeyAnQlVJTFRJTlxSRFMgUmVtb3RlIEFjY2VzcyBTZXJ2ZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NzYnICB7ICdCVUlMVElOXFJEUyBFbmRwb2ludCBTZXJ2ZXJzJyB9CiAgICAgICAgICAgICdTLTEtNS0zMi01NzcnICB7ICdCVUlMVElOXFJEUyBNYW5hZ2VtZW50IFNlcnZlcnMnIH0KICAgICAgICAgICAgJ1MtMS01LTMyLTU3OCcgIHsgJ0JVSUxUSU5cSHlwZXItViBBZG1pbmlzdHJhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTc5JyAgeyAnQlVJTFRJTlxBY2Nlc3MgQ29udHJvbCBBc3Npc3RhbmNlIE9wZXJhdG9ycycgfQogICAgICAgICAgICAnUy0xLTUtMzItNTgwJyAgeyAnQlVJTFRJTlxBY2Nlc3MgQ29udHJvbCBBc3Npc3RhbmNlIE9wZXJhdG9ycycgfQogICAgICAgICAgICBEZWZhdWx0IHsgCiAgICAgICAgICAgICAgICAkT2JqID0gKE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXIoJFNJRDIpKQogICAgICAgICAgICAgICAgJE9iai5UcmFuc2xhdGUoIFtTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLk5UQWNjb3VudF0pLlZhbHVlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgV3JpdGUtRGVidWcgIkludmFsaWQgU0lEOiAkU0lEIgogICAgICAgICRTSUQKICAgIH0KfQoKCmZpbHRlciBDb252ZXJ0LUFETmFtZSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ29udmVydHMgdXNlci9ncm91cCBuYW1lcyBmcm9tIE5UNCAoRE9NQUlOXHVzZXIpIG9yIGRvbWFpblNpbXBsZSAodXNlckBkb21haW4uY29tKQogICAgICAgIHRvIGNhbm9uaWNhbCBmb3JtYXQgKGRvbWFpbi5jb20vVXNlcnMvdXNlcikgb3IgTlQ0LgoKICAgICAgICBCYXNlZCBvbiBCaWxsIFN0ZXdhcnQncyBjb2RlIGZyb20gdGhpcyBhcnRpY2xlOiAKICAgICAgICAgICAgaHR0cDovL3dpbmRvd3NpdHByby5jb20vYWN0aXZlLWRpcmVjdG9yeS90cmFuc2xhdGluZy1hY3RpdmUtZGlyZWN0b3J5LW9iamVjdC1uYW1lcy1iZXR3ZWVuLWZvcm1hdHMKCiAgICAuUEFSQU1FVEVSIE9iamVjdE5hbWUKCiAgICAgICAgVGhlIHVzZXIvZ3JvdXAgbmFtZSB0byBjb252ZXJ0LgoKICAgIC5QQVJBTUVURVIgSW5wdXRUeXBlCgogICAgICAgIFRoZSBJbnB1dFR5cGUgb2YgdGhlIHVzZXIvZ3JvdXAgbmFtZSAoIk5UNCIsIlNpbXBsZSIsIkNhbm9uaWNhbCIpLgoKICAgIC5QQVJBTUVURVIgT3V0cHV0VHlwZQoKICAgICAgICBUaGUgT3V0cHV0VHlwZSBvZiB0aGUgdXNlci9ncm91cCBuYW1lICgiTlQ0IiwiU2ltcGxlIiwiQ2Fub25pY2FsIikuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBDb252ZXJ0LUFETmFtZSAtT2JqZWN0TmFtZSAiZGV2XGRmbSIKICAgICAgICAKICAgICAgICBSZXR1cm5zICJkZXYudGVzdGxhYi5sb2NhbC9Vc2Vycy9EYXZlIgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQ29udmVydC1TaWRUb05hbWUgIlMtLi4uIiB8IENvbnZlcnQtQUROYW1lCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgY2Fub25pY2FsIG5hbWUgZm9yIHRoZSByZXNvbHZlZCBTSUQuCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL3dpbmRvd3NpdHByby5jb20vYWN0aXZlLWRpcmVjdG9yeS90cmFuc2xhdGluZy1hY3RpdmUtZGlyZWN0b3J5LW9iamVjdC1uYW1lcy1iZXR3ZWVuLWZvcm1hdHMKIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE9iamVjdE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJOVDQiLCJTaW1wbGUiLCJDYW5vbmljYWwiKV0KICAgICAgICAkSW5wdXRUeXBlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZVNldCgiTlQ0IiwiU2ltcGxlIiwiQ2Fub25pY2FsIildCiAgICAgICAgJE91dHB1dFR5cGUKICAgICkKCiAgICAkTmFtZVR5cGVzID0gQHsKICAgICAgICAiQ2Fub25pY2FsIiA9IDIKICAgICAgICAiTlQ0IiAgICAgICA9IDMKICAgICAgICAiU2ltcGxlIiAgICA9IDUKICAgIH0KCiAgICBpZighJFBTQm91bmRQYXJhbWV0ZXJzWydJbnB1dFR5cGUnXSkgewogICAgICAgIGlmKCAoJE9iamVjdE5hbWUuc3BsaXQoJy8nKSkuQ291bnQgLWVxIDIgKSB7CiAgICAgICAgICAgICRPYmplY3ROYW1lID0gJE9iamVjdE5hbWUucmVwbGFjZSgnLycsICdcJykKICAgICAgICB9CgogICAgICAgIGlmKCRPYmplY3ROYW1lIC1tYXRjaCAiXltBLVphLXpdK1xcW0EtWmEteiBdKyQiKSB7CiAgICAgICAgICAgICRJbnB1dFR5cGUgPSAnTlQ0JwogICAgICAgIH0KICAgICAgICBlbHNlaWYoJE9iamVjdE5hbWUgLW1hdGNoICJeW0EtWmEteiBdK0BbQS1aYS16XC5dKyIpIHsKICAgICAgICAgICAgJElucHV0VHlwZSA9ICdTaW1wbGUnCiAgICAgICAgfQogICAgICAgIGVsc2VpZigkT2JqZWN0TmFtZSAtbWF0Y2ggIl5bQS1aYS16XC5dKy9bQS1aYS16XSsvW0EtWmEtei8gXSsiKSB7CiAgICAgICAgICAgICRJbnB1dFR5cGUgPSAnQ2Fub25pY2FsJwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiQ2FuIG5vdCBpZGVudGlmeSBJblR5cGUgZm9yICRPYmplY3ROYW1lIgogICAgICAgICAgICByZXR1cm4gJE9iamVjdE5hbWUKICAgICAgICB9CiAgICB9CiAgICBlbHNlaWYoJElucHV0VHlwZSAtZXEgJ05UNCcpIHsKICAgICAgICAkT2JqZWN0TmFtZSA9ICRPYmplY3ROYW1lLnJlcGxhY2UoJy8nLCAnXCcpCiAgICB9CgogICAgaWYoISRQU0JvdW5kUGFyYW1ldGVyc1snT3V0cHV0VHlwZSddKSB7CiAgICAgICAgJE91dHB1dFR5cGUgPSBTd2l0Y2goJElucHV0VHlwZSkgewogICAgICAgICAgICAnTlQ0JyB7J0Nhbm9uaWNhbCd9CiAgICAgICAgICAgICdTaW1wbGUnIHsnTlQ0J30KICAgICAgICAgICAgJ0Nhbm9uaWNhbCcgeydOVDQnfQogICAgICAgIH0KICAgIH0KCiAgICAjIHRyeSB0byBleHRyYWN0IHRoZSBkb21haW4gZnJvbSB0aGUgZ2l2ZW4gZm9ybWF0CiAgICAkRG9tYWluID0gU3dpdGNoKCRJbnB1dFR5cGUpIHsKICAgICAgICAnTlQ0JyB7ICRPYmplY3ROYW1lLnNwbGl0KCJcIilbMF0gfQogICAgICAgICdTaW1wbGUnIHsgJE9iamVjdE5hbWUuc3BsaXQoIkAiKVsxXSB9CiAgICAgICAgJ0Nhbm9uaWNhbCcgeyAkT2JqZWN0TmFtZS5zcGxpdCgiLyIpWzBdIH0KICAgIH0KCiAgICAjIEFjY2Vzc29yIGZ1bmN0aW9ucyB0byBzaW1wbGlmeSBjYWxscyB0byBOYW1lVHJhbnNsYXRlCiAgICBmdW5jdGlvbiBJbnZva2UtTWV0aG9kKFtfX0NvbU9iamVjdF0gJE9iamVjdCwgW1N0cmluZ10gJE1ldGhvZCwgJFBhcmFtZXRlcnMpIHsKICAgICAgICAkT3V0cHV0ID0gJE9iamVjdC5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCRNZXRob2QsICJJbnZva2VNZXRob2QiLCAkTnVsbCwgJE9iamVjdCwgJFBhcmFtZXRlcnMpCiAgICAgICAgaWYgKCAkT3V0cHV0ICkgeyAkT3V0cHV0IH0KICAgIH0KICAgIGZ1bmN0aW9uIFNldC1Qcm9wZXJ0eShbX19Db21PYmplY3RdICRPYmplY3QsIFtTdHJpbmddICRQcm9wZXJ0eSwgJFBhcmFtZXRlcnMpIHsKICAgICAgICBbVm9pZF0gJE9iamVjdC5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCRQcm9wZXJ0eSwgIlNldFByb3BlcnR5IiwgJE51bGwsICRPYmplY3QsICRQYXJhbWV0ZXJzKQogICAgfQoKICAgICRUcmFuc2xhdGUgPSBOZXctT2JqZWN0IC1Db21PYmplY3QgTmFtZVRyYW5zbGF0ZQoKICAgIHRyeSB7CiAgICAgICAgSW52b2tlLU1ldGhvZCAkVHJhbnNsYXRlICJJbml0IiAoMSwgJERvbWFpbikKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLk1ldGhvZEludm9jYXRpb25FeGNlcHRpb25dIHsgCiAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHdpdGggdHJhbnNsYXRlIGluaXQgaW4gQ29udmVydC1BRE5hbWU6ICRfIgogICAgfQoKICAgIFNldC1Qcm9wZXJ0eSAkVHJhbnNsYXRlICJDaGFzZVJlZmVycmFsIiAoMHg2MCkKCiAgICB0cnkgewogICAgICAgIEludm9rZS1NZXRob2QgJFRyYW5zbGF0ZSAiU2V0IiAoJE5hbWVUeXBlc1skSW5wdXRUeXBlXSwgJE9iamVjdE5hbWUpCiAgICAgICAgKEludm9rZS1NZXRob2QgJFRyYW5zbGF0ZSAiR2V0IiAoJE5hbWVUeXBlc1skT3V0cHV0VHlwZV0pKQogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uTWV0aG9kSW52b2NhdGlvbkV4Y2VwdGlvbl0gewogICAgICAgIFdyaXRlLURlYnVnICJFcnJvciB3aXRoIHRyYW5zbGF0ZSBTZXQvR2V0IGluIENvbnZlcnQtQUROYW1lOiAkXyIKICAgIH0KfQoKCmZ1bmN0aW9uIENvbnZlcnRGcm9tLVVBQ1ZhbHVlIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDb252ZXJ0cyBhIFVBQyBpbnQgdmFsdWUgdG8gaHVtYW4gcmVhZGFibGUgZm9ybS4KCiAgICAuUEFSQU1FVEVSIFZhbHVlCgogICAgICAgIFRoZSBpbnQgVUFDIHZhbHVlIHRvIGNvbnZlcnQuCgogICAgLlBBUkFNRVRFUiBTaG93QWxsCgogICAgICAgIFNob3cgYWxsIFVBQyB2YWx1ZXMsIHdpdGggYSArIGluZGljYXRpbmcgdGhlIHZhbHVlIGlzIGN1cnJlbnRseSBzZXQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBDb252ZXJ0RnJvbS1VQUNWYWx1ZSAtVmFsdWUgNjYxNzYKCiAgICAgICAgQ29udmVydCB0aGUgVUFDIHZhbHVlIDY2MTc2IHRvIGh1bWFuIHJlYWRhYmxlIGZvcm1hdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRVc2VyIGphc29uIHwgc2VsZWN0IHVzZXJhY2NvdW50Y29udHJvbCB8IENvbnZlcnRGcm9tLVVBQ1ZhbHVlCgogICAgICAgIENvbnZlcnQgdGhlIFVBQyB2YWx1ZSBmb3IgJ2phc29uJyB0byBodW1hbiByZWFkYWJsZSBmb3JtYXQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0VXNlciBqYXNvbiB8IHNlbGVjdCB1c2VyYWNjb3VudGNvbnRyb2wgfCBDb252ZXJ0RnJvbS1VQUNWYWx1ZSAtU2hvd0FsbAoKICAgICAgICBDb252ZXJ0IHRoZSBVQUMgdmFsdWUgZm9yICdqYXNvbicgdG8gaHVtYW4gcmVhZGFibGUgZm9ybWF0LCBzaG93aW5nIGFsbAogICAgICAgIHBvc3NpYmxlIFVBQyB2YWx1ZXMuCiM+CiAgICAKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgICRWYWx1ZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2hvd0FsbAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAjIHZhbHVlcyBmcm9tIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLXVzL2tiLzMwNTE0NAogICAgICAgICRVQUNWYWx1ZXMgPSBOZXctT2JqZWN0IFN5c3RlbS5Db2xsZWN0aW9ucy5TcGVjaWFsaXplZC5PcmRlcmVkRGljdGlvbmFyeQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJTQ1JJUFQiLCAxKQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJBQ0NPVU5URElTQUJMRSIsIDIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIkhPTUVESVJfUkVRVUlSRUQiLCA4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJMT0NLT1VUIiwgMTYpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBU1NXRF9OT1RSRVFEIiwgMzIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBU1NXRF9DQU5UX0NIQU5HRSIsIDY0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJFTkNSWVBURURfVEVYVF9QV0RfQUxMT1dFRCIsIDEyOCkKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVEVNUF9EVVBMSUNBVEVfQUNDT1VOVCIsIDI1NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiTk9STUFMX0FDQ09VTlQiLCA1MTIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIklOVEVSRE9NQUlOX1RSVVNUX0FDQ09VTlQiLCAyMDQ4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJXT1JLU1RBVElPTl9UUlVTVF9BQ0NPVU5UIiwgNDA5NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiU0VSVkVSX1RSVVNUX0FDQ09VTlQiLCA4MTkyKQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJET05UX0VYUElSRV9QQVNTV09SRCIsIDY1NTM2KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJNTlNfTE9HT05fQUNDT1VOVCIsIDEzMTA3MikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiU01BUlRDQVJEX1JFUVVJUkVEIiwgMjYyMTQ0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJUUlVTVEVEX0ZPUl9ERUxFR0FUSU9OIiwgNTI0Mjg4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJOT1RfREVMRUdBVEVEIiwgMTA0ODU3NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVVNFX0RFU19LRVlfT05MWSIsIDIwOTcxNTIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIkRPTlRfUkVRX1BSRUFVVEgiLCA0MTk0MzA0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJQQVNTV09SRF9FWFBJUkVEIiwgODM4ODYwOCkKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVFJVU1RFRF9UT19BVVRIX0ZPUl9ERUxFR0FUSU9OIiwgMTY3NzcyMTYpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBUlRJQUxfU0VDUkVUU19BQ0NPVU5UIiwgNjcxMDg4NjQpCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgICRSZXN1bHRVQUNWYWx1ZXMgPSBOZXctT2JqZWN0IFN5c3RlbS5Db2xsZWN0aW9ucy5TcGVjaWFsaXplZC5PcmRlcmVkRGljdGlvbmFyeQoKICAgICAgICBpZigkVmFsdWUgLWlzIFtJbnRdKSB7CiAgICAgICAgICAgICRJbnRWYWx1ZSA9ICRWYWx1ZQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRWYWx1ZSAtaXMgW1BTQ3VzdG9tT2JqZWN0XSkgewogICAgICAgICAgICBpZigkVmFsdWUudXNlcmFjY291bnRjb250cm9sKSB7CiAgICAgICAgICAgICAgICAkSW50VmFsdWUgPSAkVmFsdWUudXNlcmFjY291bnRjb250cm9sCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkludmFsaWQgb2JqZWN0IGlucHV0IGZvciAtVmFsdWUgOiAkVmFsdWUiCiAgICAgICAgICAgIHJldHVybiAkTnVsbCAKICAgICAgICB9CgogICAgICAgIGlmKCRTaG93QWxsKSB7CiAgICAgICAgICAgIGZvcmVhY2ggKCRVQUNWYWx1ZSBpbiAkVUFDVmFsdWVzLkdldEVudW1lcmF0b3IoKSkgewogICAgICAgICAgICAgICAgaWYoICgkSW50VmFsdWUgLWJhbmQgJFVBQ1ZhbHVlLlZhbHVlKSAtZXEgJFVBQ1ZhbHVlLlZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFVBQ1ZhbHVlcy5BZGQoJFVBQ1ZhbHVlLk5hbWUsICIkKCRVQUNWYWx1ZS5WYWx1ZSkrIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRSZXN1bHRVQUNWYWx1ZXMuQWRkKCRVQUNWYWx1ZS5OYW1lLCAiJCgkVUFDVmFsdWUuVmFsdWUpIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZm9yZWFjaCAoJFVBQ1ZhbHVlIGluICRVQUNWYWx1ZXMuR2V0RW51bWVyYXRvcigpKSB7CiAgICAgICAgICAgICAgICBpZiggKCRJbnRWYWx1ZSAtYmFuZCAkVUFDVmFsdWUuVmFsdWUpIC1lcSAkVUFDVmFsdWUuVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAkUmVzdWx0VUFDVmFsdWVzLkFkZCgkVUFDVmFsdWUuTmFtZSwgIiQoJFVBQ1ZhbHVlLlZhbHVlKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJFJlc3VsdFVBQ1ZhbHVlcwogICAgfQp9CgoKZmlsdGVyIEdldC1Qcm94eSB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIEVudW1lcmF0ZXMgdGhlIHByb3h5IHNlcnZlciBhbmQgV1BBRCBjb25lbnRzIGZvciB0aGUgY3VycmVudCB1c2VyLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBjb21wdXRlcm5hbWUgdG8gZW51bWVyYXRlIHByb3h5IHNldHRpbmdzIG9uLCBkZWZhdWx0cyB0byBsb2NhbCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVByb3h5IAogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgcHJveHkgc2V0dGluZ3MuCiM+CiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRFTlY6Q09NUFVURVJOQU1FCiAgICApCgogICAgdHJ5IHsKICAgICAgICAkUmVnID0gW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUtleV06Ok9wZW5SZW1vdGVCYXNlS2V5KCdDdXJyZW50VXNlcicsICRDb21wdXRlck5hbWUpCiAgICAgICAgJFJlZ0tleSA9ICRSZWcuT3BlblN1YmtleSgiU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93c1xcQ3VycmVudFZlcnNpb25cXEludGVybmV0IFNldHRpbmdzIikKICAgICAgICAkUHJveHlTZXJ2ZXIgPSAkUmVnS2V5LkdldFZhbHVlKCdQcm94eVNlcnZlcicpCiAgICAgICAgJEF1dG9Db25maWdVUkwgPSAkUmVnS2V5LkdldFZhbHVlKCdBdXRvQ29uZmlnVVJMJykKCiAgICAgICAgJFdwYWQgPSAiIgogICAgICAgIGlmKCRBdXRvQ29uZmlnVVJMIC1hbmQgKCRBdXRvQ29uZmlnVVJMIC1uZSAiIikpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRXcGFkID0gKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJEF1dG9Db25maWdVUkwpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3IgY29ubmVjdGluZyB0byBBdXRvQ29uZmlnVVJMIDogJEF1dG9Db25maWdVUkwiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYoJFByb3h5U2VydmVyIC1vciAkQXV0b0NvbmZpZ1VybCkgewoKICAgICAgICAgICAgJFByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgJ1Byb3h5U2VydmVyJyA9ICRQcm94eVNlcnZlcgogICAgICAgICAgICAgICAgJ0F1dG9Db25maWdVUkwnID0gJEF1dG9Db25maWdVUkwKICAgICAgICAgICAgICAgICdXcGFkJyA9ICRXcGFkCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcGVydGllcwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiTm8gcHJveHkgc2V0dGluZ3MgZm91bmQgZm9yICRDb21wdXRlck5hbWUiCiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIGVudW1lcmF0aW5nIHByb3h5IHNldHRpbmdzIGZvciAkQ29tcHV0ZXJOYW1lIDogJF8iCiAgICB9Cn0KCgpmdW5jdGlvbiBSZXF1ZXN0LVNQTlRpY2tldCB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIFJlcXVlc3QgdGhlIGtlcmJlcm9zIHRpY2tldCBmb3IgYSBzcGVjaWZpZWQgc2VydmljZSBwcmluY2lwYWwgbmFtZSAoU1BOKS4KICAgIAogICAgLlBBUkFNRVRFUiBTUE4KCiAgICAgICAgVGhlIHNlcnZpY2UgcHJpbmNpcGFsIG5hbWUgdG8gcmVxdWVzdCB0aGUgdGlja2V0IGZvci4gUmVxdWlyZWQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBSZXF1ZXN0LVNQTlRpY2tldCAtU1BOICJIVFRQL3dlYi50ZXN0bGFiLmxvY2FsIgogICAgCiAgICAgICAgUmVxdWVzdCBhIGtlcmJlcm9zIHNlcnZpY2UgdGlja2V0IGZvciB0aGUgc3BlY2lmaWVkIFNQTi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+ICJIVFRQL3dlYjEudGVzdGxhYi5sb2NhbCIsIkhUVFAvd2ViMi50ZXN0bGFiLmxvY2FsIiB8IFJlcXVlc3QtU1BOVGlja2V0CgogICAgICAgIFJlcXVlc3Qga2VyYmVyb3Mgc2VydmljZSB0aWNrZXRzIGZvciBhbGwgU1BOcyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFVzZXIgLVNQTiB8IFJlcXVlc3QtU1BOVGlja2V0CgogICAgICAgIFJlcXVlc3Qga2VyYmVyb3Mgc2VydmljZSB0aWNrZXRzIGZvciBhbGwgdXNlcnMgd2l0aCBub24tbnVsbCBTUE5zLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWUgPSAkVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdTZXJ2aWNlUHJpbmNpcGFsTmFtZScpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkU1BOCiAgICApCgogICAgYmVnaW4gewogICAgICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLklkZW50aXR5TW9kZWwKICAgIH0KCiAgICBwcm9jZXNzIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJSZXF1ZXN0aW5nIHRpY2tldCBmb3I6ICRTUE4iCiAgICAgICAgTmV3LU9iamVjdCBTeXN0ZW0uSWRlbnRpdHlNb2RlbC5Ub2tlbnMuS2VyYmVyb3NSZXF1ZXN0b3JTZWN1cml0eVRva2VuIC1Bcmd1bWVudExpc3QgJFNQTgogICAgfQp9CgoKZnVuY3Rpb24gR2V0LVBhdGhBY2wgewo8IwogICAgLlNZTk9QU0lTCiAgICAKICAgICAgICBFbnVtZXJhdGVzIHRoZSBBQ0wgZm9yIGEgZ2l2ZW4gZmlsZSBwYXRoLgoKICAgIC5QQVJBTUVURVIgUGF0aAoKICAgICAgICBUaGUgbG9jYWwvcmVtb3RlIHBhdGggdG8gZW51bWVyYXRlIHRoZSBBQ0xzIGZvci4KCiAgICAuUEFSQU1FVEVSIFJlY3Vyc2UKICAgICAgICAKICAgICAgICBJZiBhbnkgQUNMIHJlc3VsdHMgYXJlIGdyb3VwcywgcmVjdXJzZSBhbmQgcmV0cmlldmUgdXNlciBtZW1iZXJzaGlwLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVBhdGhBY2wgIlxcU0VSVkVSXFNoYXJlXCIgCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBBQ0xzIGZvciB0aGUgZ2l2ZW4gVU5DIHNoYXJlLgojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZQogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgZnVuY3Rpb24gQ29udmVydC1GaWxlUmlnaHQgewoKICAgICAgICAgICAgIyBGcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjgwMjk4NzIvcmV0cmlldmluZy1zZWN1cml0eS1kZXNjcmlwdG9yLWFuZC1nZXR0aW5nLW51bWJlci1mb3ItZmlsZXN5c3RlbXJpZ2h0cwoKICAgICAgICAgICAgW0NtZGxldEJpbmRpbmcoKV0KICAgICAgICAgICAgcGFyYW0oCiAgICAgICAgICAgICAgICBbSW50XQogICAgICAgICAgICAgICAgJEZTUgogICAgICAgICAgICApCgogICAgICAgICAgICAkQWNjZXNzTWFzayA9IEB7CiAgICAgICAgICAgICAgW3VpbnQzMl0nMHg4MDAwMDAwMCcgPSAnR2VuZXJpY1JlYWQnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHg0MDAwMDAwMCcgPSAnR2VuZXJpY1dyaXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MjAwMDAwMDAnID0gJ0dlbmVyaWNFeGVjdXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MTAwMDAwMDAnID0gJ0dlbmVyaWNBbGwnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMjAwMDAwMCcgPSAnTWF4aW11bUFsbG93ZWQnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMTAwMDAwMCcgPSAnQWNjZXNzU3lzdGVtU2VjdXJpdHknCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDEwMDAwMCcgPSAnU3luY2hyb25pemUnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDA4MDAwMCcgPSAnV3JpdGVPd25lcicKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDQwMDAwJyA9ICdXcml0ZURBQycKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDIwMDAwJyA9ICdSZWFkQ29udHJvbCcKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDEwMDAwJyA9ICdEZWxldGUnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDEwMCcgPSAnV3JpdGVBdHRyaWJ1dGVzJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwODAnID0gJ1JlYWRBdHRyaWJ1dGVzJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwNDAnID0gJ0RlbGV0ZUNoaWxkJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwMjAnID0gJ0V4ZWN1dGUvVHJhdmVyc2UnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDAxMCcgPSAnV3JpdGVFeHRlbmRlZEF0dHJpYnV0ZXMnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDAwOCcgPSAnUmVhZEV4dGVuZGVkQXR0cmlidXRlcycKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDA0JyA9ICdBcHBlbmREYXRhL0FkZFN1YmRpcmVjdG9yeScKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDAyJyA9ICdXcml0ZURhdGEvQWRkRmlsZScKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDAxJyA9ICdSZWFkRGF0YS9MaXN0RGlyZWN0b3J5JwogICAgICAgICAgICB9CgogICAgICAgICAgICAkU2ltcGxlUGVybWlzc2lvbnMgPSBAewogICAgICAgICAgICAgIFt1aW50MzJdJzB4MWYwMWZmJyA9ICdGdWxsQ29udHJvbCcKICAgICAgICAgICAgICBbdWludDMyXScweDAzMDFiZicgPSAnTW9kaWZ5JwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDIwMGE5JyA9ICdSZWFkQW5kRXhlY3V0ZScKICAgICAgICAgICAgICBbdWludDMyXScweDAyMDE5ZicgPSAnUmVhZEFuZFdyaXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDIwMDg5JyA9ICdSZWFkJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMTE2JyA9ICdXcml0ZScKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFBlcm1pc3Npb25zID0gQCgpCgogICAgICAgICAgICAjIGdldCBzaW1wbGUgcGVybWlzc2lvbgogICAgICAgICAgICAkUGVybWlzc2lvbnMgKz0gJFNpbXBsZVBlcm1pc3Npb25zLktleXMgfCAgJSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJEZTUiAtYmFuZCAkXykgLWVxICRfKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNpbXBsZVBlcm1pc3Npb25zWyRfXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGU1IgPSAkRlNSIC1iYW5kICgtbm90ICRfKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjIGdldCByZW1haW5pbmcgZXh0ZW5kZWQgcGVybWlzc2lvbnMKICAgICAgICAgICAgJFBlcm1pc3Npb25zICs9ICRBY2Nlc3NNYXNrLktleXMgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB7ICRGU1IgLWJhbmQgJF8gfSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIHsgJEFjY2Vzc01hc2tbJF9dIH0KCiAgICAgICAgICAgICgkUGVybWlzc2lvbnMgfCA/eyRffSkgLWpvaW4gIiwiCiAgICAgICAgfQogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICB0cnkgewogICAgICAgICAgICAkQUNMID0gR2V0LUFjbCAtUGF0aCAkUGF0aAoKICAgICAgICAgICAgJEFDTC5HZXRBY2Nlc3NSdWxlcygkdHJ1ZSwkdHJ1ZSxbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAkTmFtZXMgPSBAKCkKICAgICAgICAgICAgICAgIGlmICgkXy5JZGVudGl0eVJlZmVyZW5jZSAtbWF0Y2ggJ15TLTEtNS0yMS1bMC05XSstWzAtOV0rLVswLTldKy1bMC05XSsnKSB7CiAgICAgICAgICAgICAgICAgICAgJE9iamVjdCA9IEdldC1BRE9iamVjdCAtU0lEICRfLklkZW50aXR5UmVmZXJlbmNlCiAgICAgICAgICAgICAgICAgICAgJE5hbWVzID0gQCgpCiAgICAgICAgICAgICAgICAgICAgJFNJRHMgPSBAKCRPYmplY3Qub2JqZWN0c2lkKQoKICAgICAgICAgICAgICAgICAgICBpZiAoJFJlY3Vyc2UgLWFuZCAoQCgnMjY4NDM1NDU2JywnMjY4NDM1NDU3JywnNTM2ODcwOTEyJywnNTM2ODcwOTEzJykgLWNvbnRhaW5zICRPYmplY3Quc2FtQWNjb3VudFR5cGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTSURzICs9IEdldC1OZXRHcm91cE1lbWJlciAtU0lEICRPYmplY3Qub2JqZWN0c2lkIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgTWVtYmVyU2lkCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkU0lEcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgJE5hbWVzICs9ICxAKCRfLCAoQ29udmVydC1TaWRUb05hbWUgJF8pKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICROYW1lcyArPSAsQCgkXy5JZGVudGl0eVJlZmVyZW5jZS5WYWx1ZSwgKENvbnZlcnQtU2lkVG9OYW1lICRfLklkZW50aXR5UmVmZXJlbmNlLlZhbHVlKSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBGb3JFYWNoKCROYW1lIGluICROYW1lcykgewogICAgICAgICAgICAgICAgICAgICRPdXQgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgJE91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdQYXRoJyAkUGF0aAogICAgICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRmlsZVN5c3RlbVJpZ2h0cycgKENvbnZlcnQtRmlsZVJpZ2h0IC1GU1IgJF8uRmlsZVN5c3RlbVJpZ2h0cy52YWx1ZV9fKQogICAgICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSWRlbnRpdHlSZWZlcmVuY2UnICROYW1lWzFdCiAgICAgICAgICAgICAgICAgICAgJE91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJZGVudGl0eVNJRCcgJE5hbWVbMF0KICAgICAgICAgICAgICAgICAgICAkT3V0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0FjY2Vzc0NvbnRyb2xUeXBlJyAkXy5BY2Nlc3NDb250cm9sVHlwZQogICAgICAgICAgICAgICAgICAgICRPdXQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgJF8KICAgICAgICB9CiAgICB9Cn0KCgpmaWx0ZXIgR2V0LU5hbWVGaWVsZCB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIEhlbHBlciB0aGF0IGF0dGVtcHRzIHRvIGV4dHJhY3QgYXBwcm9wcmlhdGUgZmllbGQgbmFtZXMgZnJvbQogICAgICAgIHBhc3NlZCBjb21wdXRlciBvYmplY3RzLgoKICAgIC5QQVJBTUVURVIgT2JqZWN0CgogICAgICAgIFRoZSBwYXNzZWQgb2JqZWN0IHRvIGV4dHJhY3QgbmFtZSBmaWVsZHMgZnJvbS4KCiAgICAuUEFSQU1FVEVSIERuc0hvc3ROYW1lCiAgICAgICAgCiAgICAgICAgQSBEbnNIb3N0TmFtZSB0byBleHRyYWN0IHRocm91Z2ggVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZS4KCiAgICAuUEFSQU1FVEVSIE5hbWUKICAgICAgICAKICAgICAgICBBIE5hbWUgdG8gZXh0cmFjdCB0aHJvdWdoIFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIgLUZ1bGxEYXRhIHwgR2V0LU5hbWVGaWVsZAojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmUgPSAkVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbT2JqZWN0XQogICAgICAgICRPYmplY3QsCgogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbnNIb3N0TmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE5hbWUKICAgICkKCiAgICBpZigkUFNCb3VuZFBhcmFtZXRlcnNbJ0Ruc0hvc3ROYW1lJ10pIHsKICAgICAgICAkRG5zSG9zdE5hbWUKICAgIH0KICAgIGVsc2VpZigkUFNCb3VuZFBhcmFtZXRlcnNbJ05hbWUnXSkgewogICAgICAgICROYW1lCiAgICB9CiAgICBlbHNlaWYoJE9iamVjdCkgewogICAgICAgIGlmICggW2Jvb2xdKCRPYmplY3QuUFNvYmplY3QuUHJvcGVydGllcy5uYW1lIC1tYXRjaCAiZG5zaG9zdG5hbWUiKSApIHsKICAgICAgICAgICAgIyBvYmplY3RzIGZyb20gR2V0LU5ldENvbXB1dGVyCiAgICAgICAgICAgICRPYmplY3QuZG5zaG9zdG5hbWUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICggW2Jvb2xdKCRPYmplY3QuUFNvYmplY3QuUHJvcGVydGllcy5uYW1lIC1tYXRjaCAibmFtZSIpICkgewogICAgICAgICAgICAjIG9iamVjdHMgZnJvbSBHZXQtTmV0RG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAkT2JqZWN0Lm5hbWUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgc3RyaW5ncyBhbmQgY2F0Y2ggYWxscwogICAgICAgICAgICAkT2JqZWN0CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuICROdWxsCiAgICB9Cn0KCgpmdW5jdGlvbiBDb252ZXJ0LUxEQVBQcm9wZXJ0eSB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIEhlbHBlciB0aGF0IGNvbnZlcnRzIHNwZWNpZmljIExEQVAgcHJvcGVydHkgcmVzdWx0IGZpZWxkcy4KICAgICAgICBVc2VkIGJ5IHNldmVyYWwgb2YgdGhlIEdldC1OZXQqIGZ1bmN0aW9uLgoKICAgIC5QQVJBTUVURVIgUHJvcGVydGllcwoKICAgICAgICBQcm9wZXJ0aWVzIG9iamVjdCB0byBleHRyYWN0IG91dCBMREFQIGZpZWxkcyBmb3IgZGlzcGxheS4KIz4KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkUHJvcGVydGllcwogICAgKQoKICAgICRPYmplY3RQcm9wZXJ0aWVzID0gQHt9CgogICAgJFByb3BlcnRpZXMuUHJvcGVydHlOYW1lcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICBpZiAoKCRfIC1lcSAib2JqZWN0c2lkIikgLW9yICgkXyAtZXEgInNpZGhpc3RvcnkiKSkgewogICAgICAgICAgICAjIGNvbnZlcnQgdGhlIFNJRCB0byBhIHN0cmluZwogICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSAoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkUHJvcGVydGllc1skX11bMF0sMCkpLlZhbHVlCiAgICAgICAgfQogICAgICAgIGVsc2VpZigkXyAtZXEgIm9iamVjdGd1aWQiKSB7CiAgICAgICAgICAgICMgY29udmVydCB0aGUgR1VJRCB0byBhIHN0cmluZwogICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSAoTmV3LU9iamVjdCBHdWlkICgsJFByb3BlcnRpZXNbJF9dWzBdKSkuR3VpZAogICAgICAgIH0KICAgICAgICBlbHNlaWYoICgkXyAtZXEgImxhc3Rsb2dvbiIpIC1vciAoJF8gLWVxICJsYXN0bG9nb250aW1lc3RhbXAiKSAtb3IgKCRfIC1lcSAicHdkbGFzdHNldCIpIC1vciAoJF8gLWVxICJsYXN0bG9nb2ZmIikgLW9yICgkXyAtZXEgImJhZFBhc3N3b3JkVGltZSIpICkgewogICAgICAgICAgICAjIGNvbnZlcnQgdGltZXN0YW1wcwogICAgICAgICAgICBpZiAoJFByb3BlcnRpZXNbJF9dWzBdIC1pcyBbU3lzdGVtLk1hcnNoYWxCeVJlZk9iamVjdF0pIHsKICAgICAgICAgICAgICAgICMgaWYgd2UgaGF2ZSBhIFN5c3RlbS5fX0NvbU9iamVjdAogICAgICAgICAgICAgICAgJFRlbXAgPSAkUHJvcGVydGllc1skX11bMF0KICAgICAgICAgICAgICAgIFtJbnQzMl0kSGlnaCA9ICRUZW1wLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoIkhpZ2hQYXJ0IiwgW1N5c3RlbS5SZWZsZWN0aW9uLkJpbmRpbmdGbGFnc106OkdldFByb3BlcnR5LCAkbnVsbCwgJFRlbXAsICRudWxsKQogICAgICAgICAgICAgICAgW0ludDMyXSRMb3cgID0gJFRlbXAuR2V0VHlwZSgpLkludm9rZU1lbWJlcigiTG93UGFydCIsICBbU3lzdGVtLlJlZmxlY3Rpb24uQmluZGluZ0ZsYWdzXTo6R2V0UHJvcGVydHksICRudWxsLCAkVGVtcCwgJG51bGwpCiAgICAgICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSAoW2RhdGV0aW1lXTo6RnJvbUZpbGVUaW1lKFtJbnQ2NF0oIjB4ezA6eDh9ezE6eDh9IiAtZiAkSGlnaCwgJExvdykpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gKFtkYXRldGltZV06OkZyb21GaWxlVGltZSgoJFByb3BlcnRpZXNbJF9dWzBdKSkpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRQcm9wZXJ0aWVzWyRfXVswXSAtaXMgW1N5c3RlbS5NYXJzaGFsQnlSZWZPYmplY3RdKSB7CiAgICAgICAgICAgICMgdHJ5IHRvIGNvbnZlcnQgbWlzYyBjb20gb2JqZWN0cwogICAgICAgICAgICAkUHJvcCA9ICRQcm9wZXJ0aWVzWyRfXQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJFRlbXAgPSAkUHJvcFskX11bMF0KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJF8KICAgICAgICAgICAgICAgIFtJbnQzMl0kSGlnaCA9ICRUZW1wLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoIkhpZ2hQYXJ0IiwgW1N5c3RlbS5SZWZsZWN0aW9uLkJpbmRpbmdGbGFnc106OkdldFByb3BlcnR5LCAkbnVsbCwgJFRlbXAsICRudWxsKQogICAgICAgICAgICAgICAgW0ludDMyXSRMb3cgID0gJFRlbXAuR2V0VHlwZSgpLkludm9rZU1lbWJlcigiTG93UGFydCIsICBbU3lzdGVtLlJlZmxlY3Rpb24uQmluZGluZ0ZsYWdzXTo6R2V0UHJvcGVydHksICRudWxsLCAkVGVtcCwgJG51bGwpCiAgICAgICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSBbSW50NjRdKCIweHswOng4fXsxOng4fSIgLWYgJEhpZ2gsICRMb3cpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gJFByb3BbJF9dCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRQcm9wZXJ0aWVzWyRfXS5jb3VudCAtZXEgMSkgewogICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSAkUHJvcGVydGllc1skX11bMF0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRPYmplY3RQcm9wZXJ0aWVzWyRfXSA9ICRQcm9wZXJ0aWVzWyRfXQogICAgICAgIH0KICAgIH0KCiAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgJE9iamVjdFByb3BlcnRpZXMKfQoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgRG9tYWluIGluZm8gZnVuY3Rpb25zIGJlbG93LgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmaWx0ZXIgR2V0LURvbWFpblNlYXJjaGVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBIZWxwZXIgdXNlZCBieSB2YXJpb3VzIGZ1bmN0aW9ucyB0aGF0IHRha2VzIGFuIEFEU3BhdGggYW5kCiAgICAgICAgZG9tYWluIHNwZWNpZmllciBhbmQgYnVpbGRzIHRoZSBjb3JyZWN0IEFEU0kgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gdXNlIGZvciB0aGUgcXVlcnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgQURTcHJlZml4CgogICAgICAgIFByZWZpeCB0byBzZXQgZm9yIHRoZSBzZWFyY2hlciAobGlrZSAiQ049U2l0ZXMsQ049Q29uZmlndXJhdGlvbiIpCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluIHRlc3RsYWIubG9jYWwKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluIHRlc3RsYWIubG9jYWwgLURvbWFpbkNvbnRyb2xsZXIgU0VDT05EQVJZLmRldi50ZXN0bGFiLmxvY2FsCiM+CgogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwcmVmaXgsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBpZighJENyZWRlbnRpYWwpIHsKICAgICAgICBpZighJERvbWFpbil7CiAgICAgICAgICAgICREb21haW4gPSAoR2V0LU5ldERvbWFpbikubmFtZQogICAgICAgIH0KICAgICAgICBlbHNlaWYoISREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAjIGlmIHRoZXJlJ3Mgbm8gLURvbWFpbkNvbnRyb2xsZXIgc3BlY2lmaWVkLCB0cnkgdG8gcHVsbCB0aGUgcHJpbWFyeSBEQwogICAgICAgICAgICAgICAgIyAgIHRvIHJlZmxlY3QgcXVlcmllcyB0aHJvdWdoCiAgICAgICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciA9ICgoR2V0LU5ldERvbWFpbikuUGRjUm9sZU93bmVyKS5OYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgdGhyb3cgIkdldC1Eb21haW5TZWFyY2hlcjogRXJyb3IgaW4gcmV0cmlldmluZyBQREMgZm9yIGN1cnJlbnQgZG9tYWluIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZWlmICghJERvbWFpbkNvbnRyb2xsZXIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciA9ICgoR2V0LU5ldERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCkuUGRjUm9sZU93bmVyKS5OYW1lCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgdGhyb3cgIkdldC1Eb21haW5TZWFyY2hlcjogRXJyb3IgaW4gcmV0cmlldmluZyBQREMgZm9yIGN1cnJlbnQgZG9tYWluIgogICAgICAgIH0KCiAgICAgICAgaWYoISREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgIHRocm93ICJHZXQtRG9tYWluU2VhcmNoZXI6IEVycm9yIGluIHJldHJpZXZpbmcgUERDIGZvciBjdXJyZW50IGRvbWFpbiIKICAgICAgICB9CiAgICB9CgogICAgJFNlYXJjaFN0cmluZyA9ICJMREFQOi8vIgoKICAgIGlmKCREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgJFNlYXJjaFN0cmluZyArPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgIGlmKCREb21haW4pewogICAgICAgICAgICAkU2VhcmNoU3RyaW5nICs9ICIvIgogICAgICAgIH0KICAgIH0KCiAgICBpZigkQURTcHJlZml4KSB7CiAgICAgICAgJFNlYXJjaFN0cmluZyArPSAkQURTcHJlZml4ICsgIiwiCiAgICB9CgogICAgaWYoJEFEU3BhdGgpIHsKICAgICAgICBpZigkQURTcGF0aCAtbGlrZSAiR0M6Ly8qIikgewogICAgICAgICAgICAjIGlmIHdlJ3JlIHNlYXJjaGluZyB0aGUgZ2xvYmFsIGNhdGFsb2cKICAgICAgICAgICAgJEROID0gJEFkc1BhdGgKICAgICAgICAgICAgJFNlYXJjaFN0cmluZyA9ICIiCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigkQURTcGF0aCAtbGlrZSAiTERBUDovLyoiKSB7CiAgICAgICAgICAgICAgICBpZigkQURTcGF0aCAtbWF0Y2ggIkxEQVA6Ly8uKy8uKyIpIHsKICAgICAgICAgICAgICAgICAgICAkU2VhcmNoU3RyaW5nID0gIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRBRFNwYXRoID0gJEFEU3BhdGguU3Vic3RyaW5nKDcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJEROID0gJEFEU3BhdGgKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBpZigkRG9tYWluIC1hbmQgKCREb21haW4uVHJpbSgpIC1uZSAiIikpIHsKICAgICAgICAgICAgJEROID0gIkRDPSQoJERvbWFpbi5SZXBsYWNlKCcuJywgJyxEQz0nKSkiCiAgICAgICAgfQogICAgfQoKICAgICRTZWFyY2hTdHJpbmcgKz0gJEROCiAgICBXcml0ZS1WZXJib3NlICJHZXQtRG9tYWluU2VhcmNoZXIgc2VhcmNoIHN0cmluZzogJFNlYXJjaFN0cmluZyIKCiAgICBpZigkQ3JlZGVudGlhbCkgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIGFsdGVybmF0ZSBjcmVkZW50aWFscyBmb3IgTERBUCBjb25uZWN0aW9uIgogICAgICAgICREb21haW5PYmplY3QgPSBOZXctT2JqZWN0IERpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeUVudHJ5KCRTZWFyY2hTdHJpbmcsICRDcmVkZW50aWFsLlVzZXJOYW1lLCAkQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlBhc3N3b3JkKQogICAgICAgICRTZWFyY2hlciA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeVNlYXJjaGVyKCREb21haW5PYmplY3QpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkU2VhcmNoZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5EaXJlY3RvcnlTZWFyY2hlcihbQURTSV0kU2VhcmNoU3RyaW5nKQogICAgfQoKICAgICRTZWFyY2hlci5QYWdlU2l6ZSA9ICRQYWdlU2l6ZQogICAgJFNlYXJjaGVyLkNhY2hlUmVzdWx0cyA9ICRGYWxzZQogICAgJFNlYXJjaGVyCn0KCgpmaWx0ZXIgR2V0LU5ldERvbWFpbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJucyBhIGdpdmVuIGRvbWFpbiBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiBuYW1lIHRvIHF1ZXJ5IGZvciwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3Qgb2YgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzCiAgICAgICAgZm9yIGNvbm5lY3Rpb24gdG8gdGhlIHRhcmdldCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluIC1Eb21haW4gdGVzdGxhYi5sb2NhbAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gInRlc3RsYWIubG9jYWwiIHwgR2V0LU5ldERvbWFpbgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL0ZvcnVtcy9zY3JpcHRjZW50ZXIvZW4tVVMvMGM1YjNmODMtZTUyOC00ZDQ5LTkyYTQtZGVlMzFmNGI0ODFjL2ZpbmRpbmctdGhlLWRuLW9mLXRoZS10aGUtZG9tYWluLXdpdGhvdXQtYWRtb2R1bGUtaW4tcG93ZXJzaGVsbD9mb3J1bT1JVENHCiM+CgogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGlmKCRDcmVkZW50aWFsKSB7CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzIGZvciBHZXQtTmV0RG9tYWluIgoKICAgICAgICBpZighJERvbWFpbikgewogICAgICAgICAgICAjIGlmIG5vIGRvbWFpbiBpcyBzdXBwbGllZCwgZXh0cmFjdCB0aGUgbG9nb24gZG9tYWluIGZyb20gdGhlIFBTQ3JlZGVudGlhbCBwYXNzZWQKICAgICAgICAgICAgJERvbWFpbiA9ICRDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuRG9tYWluCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4dHJhY3RlZCBkb21haW4gJyREb21haW4nIGZyb20gLUNyZWRlbnRpYWwiCiAgICAgICAgfQogICAKICAgICAgICAkRG9tYWluQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0KCdEb21haW4nLCAkRG9tYWluLCAkQ3JlZGVudGlhbC5Vc2VyTmFtZSwgJENyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZCkKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5Eb21haW5dOjpHZXREb21haW4oJERvbWFpbkNvbnRleHQpCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiVGhlIHNwZWNpZmllZCBkb21haW4gZG9lcyAnJERvbWFpbicgbm90IGV4aXN0LCBjb3VsZCBub3QgYmUgY29udGFjdGVkLCB0aGVyZSBpc24ndCBhbiBleGlzdGluZyB0cnVzdCwgb3IgdGhlIHNwZWNpZmllZCBjcmVkZW50aWFscyBhcmUgaW52YWxpZC4iCiAgICAgICAgICAgICROdWxsCiAgICAgICAgfQogICAgfQogICAgZWxzZWlmKCREb21haW4pIHsKICAgICAgICAkRG9tYWluQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0KCdEb21haW4nLCAkRG9tYWluKQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRvbWFpbl06OkdldERvbWFpbigkRG9tYWluQ29udGV4dCkKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJUaGUgc3BlY2lmaWVkIGRvbWFpbiAnJERvbWFpbicgZG9lcyBub3QgZXhpc3QsIGNvdWxkIG5vdCBiZSBjb250YWN0ZWQsIG9yIHRoZXJlIGlzbid0IGFuIGV4aXN0aW5nIHRydXN0LiIKICAgICAgICAgICAgJE51bGwKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5Eb21haW5dOjpHZXRDdXJyZW50RG9tYWluKCkKICAgIH0KfQoKCmZpbHRlciBHZXQtTmV0Rm9yZXN0IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgZ2l2ZW4gZm9yZXN0IG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIEZvcmVzdAoKICAgICAgICBUaGUgZm9yZXN0IG5hbWUgdG8gcXVlcnkgZm9yLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQogICAgCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Rm9yZXN0IC1Gb3Jlc3QgZXh0ZXJuYWwuZG9tYWluCgogICAgLkVYQU1QTEUKICAgIAogICAgICAgIFBTIEM6XD4gImV4dGVybmFsLmRvbWFpbiIgfCBHZXQtTmV0Rm9yZXN0CiM+CgogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRm9yZXN0LAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGlmKCRDcmVkZW50aWFsKSB7CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzIGZvciBHZXQtTmV0Rm9yZXN0IgoKICAgICAgICBpZighJEZvcmVzdCkgewogICAgICAgICAgICAjIGlmIG5vIGRvbWFpbiBpcyBzdXBwbGllZCwgZXh0cmFjdCB0aGUgbG9nb24gZG9tYWluIGZyb20gdGhlIFBTQ3JlZGVudGlhbCBwYXNzZWQKICAgICAgICAgICAgJEZvcmVzdCA9ICRDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuRG9tYWluCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4dHJhY3RlZCBkb21haW4gJyRGb3Jlc3QnIGZyb20gLUNyZWRlbnRpYWwiCiAgICAgICAgfQogICAKICAgICAgICAkRm9yZXN0Q29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0KCdGb3Jlc3QnLCAkRm9yZXN0LCAkQ3JlZGVudGlhbC5Vc2VyTmFtZSwgJENyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZCkKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICAkRm9yZXN0T2JqZWN0ID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRm9yZXN0XTo6R2V0Rm9yZXN0KCRGb3Jlc3RDb250ZXh0KQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIlRoZSBzcGVjaWZpZWQgZm9yZXN0ICckRm9yZXN0JyBkb2VzIG5vdCBleGlzdCwgY291bGQgbm90IGJlIGNvbnRhY3RlZCwgdGhlcmUgaXNuJ3QgYW4gZXhpc3RpbmcgdHJ1c3QsIG9yIHRoZSBzcGVjaWZpZWQgY3JlZGVudGlhbHMgYXJlIGludmFsaWQuIgogICAgICAgICAgICAkTnVsbAogICAgICAgIH0KICAgIH0KICAgIGVsc2VpZigkRm9yZXN0KSB7CiAgICAgICAgJEZvcmVzdENvbnRleHQgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRGlyZWN0b3J5Q29udGV4dCgnRm9yZXN0JywgJEZvcmVzdCkKICAgICAgICB0cnkgewogICAgICAgICAgICAkRm9yZXN0T2JqZWN0ID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRm9yZXN0XTo6R2V0Rm9yZXN0KCRGb3Jlc3RDb250ZXh0KQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIlRoZSBzcGVjaWZpZWQgZm9yZXN0ICckRm9yZXN0JyBkb2VzIG5vdCBleGlzdCwgY291bGQgbm90IGJlIGNvbnRhY3RlZCwgb3IgdGhlcmUgaXNuJ3QgYW4gZXhpc3RpbmcgdHJ1c3QuIgogICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAjIG90aGVyd2lzZSB1c2UgdGhlIGN1cnJlbnQgZm9yZXN0CiAgICAgICAgJEZvcmVzdE9iamVjdCA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkZvcmVzdF06OkdldEN1cnJlbnRGb3Jlc3QoKQogICAgfQoKICAgIGlmKCRGb3Jlc3RPYmplY3QpIHsKICAgICAgICAjIGdldCB0aGUgU0lEIG9mIHRoZSBmb3Jlc3Qgcm9vdAogICAgICAgICRGb3Jlc3RTaWQgPSAoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLk5UQWNjb3VudCgkRm9yZXN0T2JqZWN0LlJvb3REb21haW4sImtyYnRndCIpKS5UcmFuc2xhdGUoW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyXSkuVmFsdWUKICAgICAgICAkUGFydHMgPSAkRm9yZXN0U2lkIC1TcGxpdCAiLSIKICAgICAgICAkRm9yZXN0U2lkID0gJFBhcnRzWzAuLiQoJFBhcnRzLmxlbmd0aC0yKV0gLWpvaW4gIi0iCiAgICAgICAgJEZvcmVzdE9iamVjdCB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5ICdSb290RG9tYWluU2lkJyAkRm9yZXN0U2lkCiAgICAgICAgJEZvcmVzdE9iamVjdAogICAgfQp9CgoKZmlsdGVyIEdldC1OZXRGb3Jlc3REb21haW4gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiBhbGwgZG9tYWlucyBmb3IgYSBnaXZlbiBmb3Jlc3QuCgogICAgLlBBUkFNRVRFUiBGb3Jlc3QKCiAgICAgICAgVGhlIGZvcmVzdCBuYW1lIHRvIHF1ZXJ5IGRvbWFpbiBmb3IuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRGb3Jlc3REb21haW4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRGb3Jlc3REb21haW4gLUZvcmVzdCBleHRlcm5hbC5sb2NhbAojPgoKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZvcmVzdCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICAkRm9yZXN0T2JqZWN0ID0gR2V0LU5ldEZvcmVzdCAtRm9yZXN0ICRGb3Jlc3QgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKCiAgICBpZigkRm9yZXN0T2JqZWN0KSB7CiAgICAgICAgJEZvcmVzdE9iamVjdC5Eb21haW5zCiAgICB9Cn0KCgpmaWx0ZXIgR2V0LU5ldEZvcmVzdENhdGFsb2cgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiBhbGwgZ2xvYmFsIGNhdGFsb2dzIGZvciBhIGdpdmVuIGZvcmVzdC4KCiAgICAuUEFSQU1FVEVSIEZvcmVzdAoKICAgICAgICBUaGUgZm9yZXN0IG5hbWUgdG8gcXVlcnkgZG9tYWluIGZvci4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZvcmVzdENhdGFsb2cKIz4KICAgIAogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRm9yZXN0LAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgICRGb3Jlc3RPYmplY3QgPSBHZXQtTmV0Rm9yZXN0IC1Gb3Jlc3QgJEZvcmVzdCAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAoKICAgIGlmKCRGb3Jlc3RPYmplY3QpIHsKICAgICAgICAkRm9yZXN0T2JqZWN0LkZpbmRBbGxHbG9iYWxDYXRhbG9ncygpCiAgICB9Cn0KCgpmaWx0ZXIgR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiB0aGUgY3VycmVudCBkb21haW4gY29udHJvbGxlcnMgZm9yIHRoZSBhY3RpdmUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIGRvbWFpbiBjb250cm9sbGVycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZGV0ZXJtaW5lIHRoZSBkb21haW4gY29udHJvbGxlcnMuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXREb21haW5Db250cm9sbGVyIC1Eb21haW4gJ3Rlc3QubG9jYWwnCiAgICAgICAgCiAgICAgICAgRGV0ZXJtaW5lIHRoZSBkb21haW4gY29udHJvbGxlcnMgZm9yICd0ZXN0LmxvY2FsJy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXREb21haW5Db250cm9sbGVyIC1Eb21haW4gJ3Rlc3QubG9jYWwnIC1MREFQCgogICAgICAgIERldGVybWluZSB0aGUgZG9tYWluIGNvbnRyb2xsZXJzIGZvciAndGVzdC5sb2NhbCcgdXNpbmcgTERBUCBxdWVyaWVzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gJ3Rlc3QubG9jYWwnIHwgR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRGV0ZXJtaW5lIHRoZSBkb21haW4gY29udHJvbGxlcnMgZm9yICd0ZXN0LmxvY2FsJy4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRMREFQLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGlmKCRMREFQIC1vciAkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICMgZmlsdGVyIHN0cmluZyB0byByZXR1cm4gYWxsIGRvbWFpbiBjb250cm9sbGVycwogICAgICAgIEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1GaWx0ZXIgJyh1c2VyQWNjb3VudENvbnRyb2w6MS4yLjg0MC4xMTM1NTYuMS40LjgwMzo9ODE5MiknCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkRm91bmREb21haW4gPSBHZXQtTmV0RG9tYWluIC1Eb21haW4gJERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAogICAgICAgIGlmKCRGb3VuZERvbWFpbikgewogICAgICAgICAgICAkRm91bmRkb21haW4uRG9tYWluQ29udHJvbGxlcnMKICAgICAgICB9CiAgICB9Cn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgIm5ldCAqIiByZXBsYWNlbWVudHMgYW5kIG90aGVyIGZ1biBzdGFydCBiZWxvdwojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtTmV0VXNlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcnkgaW5mb3JtYXRpb24gZm9yIGEgZ2l2ZW4gdXNlciBvciB1c2VycyBpbiB0aGUgZG9tYWluCiAgICAgICAgdXNpbmcgQURTSSBhbmQgTERBUC4gQW5vdGhlciAtRG9tYWluIGNhbiBiZSBzcGVjaWZpZWQgdG8KICAgICAgICBxdWVyeSBmb3IgdXNlcnMgYWNyb3NzIGEgdHJ1c3QuCiAgICAgICAgUmVwbGFjZW1lbnQgZm9yICJuZXQgdXNlcnMgL2RvbWFpbiIKCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFVzZXJuYW1lIGZpbHRlciBzdHJpbmcsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKCiAgICAuUEFSQU1FVEVSIEFkbWluQ291bnQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlcnMgd2l0aCBhZG1pbkNvdW50PTEuCgogICAgLlBBUkFNRVRFUiBTUE4KCiAgICAgICAgU3dpdGNoLiBPbmx5IHJldHVybiB1c2VyIG9iamVjdHMgd2l0aCBub24tbnVsbCBzZXJ2aWNlIHByaW5jaXBhbCBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIFVuY29uc3RyYWluZWQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlcnMgdGhhdCBoYXZlIHVuY29uc3RyYWluZWQgZGVsZWdhdGlvbi4KCiAgICAuUEFSQU1FVEVSIEFsbG93RGVsZWdhdGlvbgoKICAgICAgICBTd2l0Y2guIFJldHVybiB1c2VyIGFjY291bnRzIHRoYXQgYXJlIG5vdCBtYXJrZWQgYXMgJ3NlbnNpdGl2ZSBhbmQgbm90IGFsbG93ZWQgZm9yIGRlbGVnYXRpb24nCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRVc2VyIC1Eb21haW4gdGVzdGluZwoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFVzZXIgLUFEU3BhdGggIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKIz4KCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNQTiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQWRtaW5Db3VudCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVW5jb25zdHJhaW5lZCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQWxsb3dEZWxlZ2F0aW9uLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgYmVnaW4gewogICAgICAgICMgc28gdGhpcyBpc24ndCByZXBlYXRlZCBpZiB1c2VycyBhcmUgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgICAgICRVc2VyU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1BRFNwYXRoICRBRFNwYXRoIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKICAgIH0KCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkVXNlclNlYXJjaGVyKSB7CgogICAgICAgICAgICAjIGlmIHdlJ3JlIGNoZWNraW5nIGZvciB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24KICAgICAgICAgICAgaWYoJFVuY29uc3RyYWluZWQpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNraW5nIGZvciB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24iCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIodXNlckFjY291bnRDb250cm9sOjEuMi44NDAuMTEzNTU2LjEuNC44MDM6PTUyNDI4OCkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJEFsbG93RGVsZWdhdGlvbikgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2hlY2tpbmcgZm9yIHVzZXJzIHdobyBjYW4gYmUgZGVsZWdhdGVkIgogICAgICAgICAgICAgICAgIyBuZWdhdGlvbiBvZiAiQWNjb3VudHMgdGhhdCBhcmUgc2Vuc2l0aXZlIGFuZCBub3QgdHJ1c3RlZCBmb3IgZGVsZWdhdGlvbiIKICAgICAgICAgICAgICAgICRGaWx0ZXIgKz0gIighKHVzZXJBY2NvdW50Q29udHJvbDoxLjIuODQwLjExMzU1Ni4xLjQuODAzOj0xMDQ4NTc0KSkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJEFkbWluQ291bnQpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNraW5nIGZvciBhZG1pbkNvdW50PTEiCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIoYWRtaW5jb3VudD0xKSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBjaGVjayBpZiB3ZSdyZSB1c2luZyBhIHVzZXJuYW1lIGZpbHRlciBvciBub3QKICAgICAgICAgICAgaWYoJFVzZXJOYW1lKSB7CiAgICAgICAgICAgICAgICAjIHNhbUFjY291bnRUeXBlPTgwNTMwNjM2OCBpbmRpY2F0ZXMgdXNlciBvYmplY3RzCiAgICAgICAgICAgICAgICAkVXNlclNlYXJjaGVyLmZpbHRlcj0iKCYoc2FtQWNjb3VudFR5cGU9ODA1MzA2MzY4KShzYW1BY2NvdW50TmFtZT0kVXNlck5hbWUpJEZpbHRlcikiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRTUE4pIHsKICAgICAgICAgICAgICAgICRVc2VyU2VhcmNoZXIuZmlsdGVyPSIoJihzYW1BY2NvdW50VHlwZT04MDUzMDYzNjgpKHNlcnZpY2VQcmluY2lwYWxOYW1lPSopJEZpbHRlcikiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAjIGZpbHRlciBpcyBzb21ldGhpbmcgbGlrZSAiKHNhbUFjY291bnROYW1lPSpibGFoKikiIGlmIHNwZWNpZmllZAogICAgICAgICAgICAgICAgJFVzZXJTZWFyY2hlci5maWx0ZXI9IigmKHNhbUFjY291bnRUeXBlPTgwNTMwNjM2OCkkRmlsdGVyKSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFJlc3VsdHMgPSAkVXNlclNlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgQ29udmVydC1MREFQUHJvcGVydHkgLVByb3BlcnRpZXMgJF8uUHJvcGVydGllcwogICAgICAgICAgICB9CiAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAkVXNlclNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEFkZC1OZXRVc2VyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBBZGRzIGEgZG9tYWluIHVzZXIgb3IgYSBsb2NhbCB1c2VyIHRvIHRoZSBjdXJyZW50IChvciByZW1vdGUpIG1hY2hpbmUsCiAgICAgICAgaWYgcGVybWlzc2lvbnMgYWxsb3csIHV0aWxpemluZyB0aGUgV2luTlQgc2VydmljZSBwcm92aWRlciBhbmQKICAgICAgICBEaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudCwgcmVzcGVjdGl2ZWx5LgogICAgICAgIAogICAgICAgIFRoZSBkZWZhdWx0IGJlaGF2aW9yIGlzIHRvIGFkZCBhIHVzZXIgdG8gdGhlIGxvY2FsIG1hY2hpbmUuCiAgICAgICAgQW4gb3B0aW9uYWwgZ3JvdXAgbmFtZSB0byBhZGQgdGhlIHVzZXIgdG8gY2FuIGJlIHNwZWNpZmllZC4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFRoZSB1c2VybmFtZSB0byBhZGQuIElmIG5vdCBnaXZlbiwgaXQgZGVmYXVsdHMgdG8gJ2JhY2tkb29yJwoKICAgIC5QQVJBTUVURVIgUGFzc3dvcmQKCiAgICAgICAgVGhlIHBhc3N3b3JkIHRvIHNldCBmb3IgdGhlIGFkZGVkIHVzZXIuIElmIG5vdCBnaXZlbiwgaXQgZGVmYXVsdHMgdG8gJ1Bhc3N3b3JkMTIzIScKCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBHcm91cCB0byBvcHRpb25hbGx5IGFkZCB0aGUgdXNlciB0by4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0bmFtZSB0byBhZGQgdGhlIGxvY2FsIHVzZXIgdG8sIGRlZmF1bHRzIHRvICdsb2NhbGhvc3QnCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgU3BlY2lmaWVkIGRvbWFpbiB0byBhZGQgdGhlIHVzZXIgdG8uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBBZGQtTmV0VXNlciAtVXNlck5hbWUgam9obiAtUGFzc3dvcmQgJ1Bhc3N3b3JkMTIzIScKICAgICAgICAKICAgICAgICBBZGRzIGEgbG9jYWx1c2VyICdqb2huJyB0byB0aGUgbG9jYWwgbWFjaGluZSB3aXRoIHBhc3N3b3JkIG9mICdQYXNzd29yZDEyMyEnCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBBZGQtTmV0VXNlciAtVXNlck5hbWUgam9obiAtUGFzc3dvcmQgJ1Bhc3N3b3JkMTIzIScgLUNvbXB1dGVyTmFtZSBzZXJ2ZXIudGVzdGxhYi5sb2NhbAogICAgICAgIAogICAgICAgIEFkZHMgYSBsb2NhbHVzZXIgJ2pvaG4nIHdpdGggcGFzc3dvcmQgb2YgJ1Bhc3N3b3JkMTIzIScgdG8gc2VydmVyLnRlc3RsYWIubG9jYWwncyBsb2NhbCBBZG1pbmlzdHJhdG9ycyBncm91cC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEFkZC1OZXRVc2VyIC1Vc2VyTmFtZSBqb2huIC1QYXNzd29yZCBwYXNzd29yZCAtR3JvdXBOYW1lICJEb21haW4gQWRtaW5zIiAtRG9tYWluICcnCiAgICAgICAgCiAgICAgICAgQWRkcyB0aGUgdXNlciAiam9obiIgd2l0aCBwYXNzd29yZCAicGFzc3dvcmQiIHRvIHRoZSBjdXJyZW50IGRvbWFpbiBhbmQgYWRkcwogICAgICAgIHRoZSB1c2VyIHRvIHRoZSBkb21haW4gZ3JvdXAgIkRvbWFpbiBBZG1pbnMiCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBBZGQtTmV0VXNlciAtVXNlck5hbWUgam9obiAtUGFzc3dvcmQgcGFzc3dvcmQgLUdyb3VwTmFtZSAiRG9tYWluIEFkbWlucyIgLURvbWFpbiAndGVzdGluZycKICAgICAgICAKICAgICAgICBBZGRzIHRoZSB1c2VyICJqb2huIiB3aXRoIHBhc3N3b3JkICJwYXNzd29yZCIgdG8gdGhlICd0ZXN0aW5nJyBkb21haW4gYW5kIGFkZHMKICAgICAgICB0aGUgdXNlciB0byB0aGUgZG9tYWluIGdyb3VwICJEb21haW4gQWRtaW5zIgoKICAgIC5MaW5rCgogICAgICAgIGh0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL2hleXNjcmlwdGluZ2d1eS9hcmNoaXZlLzIwMTAvMTEvMjMvdXNlLXBvd2Vyc2hlbGwtdG8tY3JlYXRlLWxvY2FsLXVzZXItYWNjb3VudHMuYXNweAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSA9ICdiYWNrZG9vcicsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUGFzc3dvcmQgPSAnUGFzc3dvcmQxMjMhJywKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICdsb2NhbGhvc3QnLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbgogICAgKQoKICAgIGlmICgkRG9tYWluKSB7CgogICAgICAgICREb21haW5PYmplY3QgPSBHZXQtTmV0RG9tYWluIC1Eb21haW4gJERvbWFpbgogICAgICAgIGlmKC1ub3QgJERvbWFpbk9iamVjdCkgewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBpbiBncmFiYmluZyAkRG9tYWluIG9iamVjdCIKICAgICAgICAgICAgcmV0dXJuICROdWxsCiAgICAgICAgfQoKICAgICAgICAjIGFkZCB0aGUgYXNzZW1ibHkgd2UgbmVlZAogICAgICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50CgogICAgICAgICMgaHR0cDovL3JpY2hhcmRzcG93ZXJzaGVsbGJsb2cud29yZHByZXNzLmNvbS8yMDA4LzA1LzI1L3N5c3RlbS1kaXJlY3RvcnlzZXJ2aWNlcy1hY2NvdW50bWFuYWdlbWVudC8KICAgICAgICAjIGdldCB0aGUgZG9tYWluIGNvbnRleHQKICAgICAgICAkQ29udGV4dCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5QcmluY2lwYWxDb250ZXh0IC1Bcmd1bWVudExpc3QgKFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuQ29udGV4dFR5cGVdOjpEb21haW4pLCAkRG9tYWluT2JqZWN0CgogICAgICAgICMgY3JlYXRlIHRoZSB1c2VyIG9iamVjdAogICAgICAgICRVc2VyID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlVzZXJQcmluY2lwYWwgLUFyZ3VtZW50TGlzdCAkQ29udGV4dAoKICAgICAgICAjIHNldCB1c2VyIHByb3BlcnRpZXMKICAgICAgICAkVXNlci5OYW1lID0gJFVzZXJOYW1lCiAgICAgICAgJFVzZXIuU2FtQWNjb3VudE5hbWUgPSAkVXNlck5hbWUKICAgICAgICAkVXNlci5QYXNzd29yZE5vdFJlcXVpcmVkID0gJEZhbHNlCiAgICAgICAgJFVzZXIuU2V0UGFzc3dvcmQoJFBhc3N3b3JkKQogICAgICAgICRVc2VyLkVuYWJsZWQgPSAkVHJ1ZQoKICAgICAgICBXcml0ZS1WZXJib3NlICJDcmVhdGluZyB1c2VyICRVc2VyTmFtZSB0byB3aXRoIHBhc3N3b3JkICckUGFzc3dvcmQnIGluIGRvbWFpbiAkRG9tYWluIgoKICAgICAgICB0cnkgewogICAgICAgICAgICAjIGNvbW1pdCB0aGUgdXNlcgogICAgICAgICAgICAkVXNlci5TYXZlKCkKICAgICAgICAgICAgIlsqXSBVc2VyICRVc2VyTmFtZSBzdWNjZXNzZnVsbHkgY3JlYXRlZCBpbiBkb21haW4gJERvbWFpbiIKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICdbIV0gVXNlciBhbHJlYWR5IGV4aXN0cyEnCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIkNyZWF0aW5nIHVzZXIgJFVzZXJOYW1lIHRvIHdpdGggcGFzc3dvcmQgJyRQYXNzd29yZCcgb24gJENvbXB1dGVyTmFtZSIKCiAgICAgICAgIyBpZiBpdCdzIG5vdCBhIGRvbWFpbiBhZGQsIGl0J3MgYSBsb2NhbCBtYWNoaW5lIGFkZAogICAgICAgICRPYmpPdSA9IFtBRFNJXSJXaW5OVDovLyRDb21wdXRlck5hbWUiCiAgICAgICAgJE9ialVzZXIgPSAkT2JqT3UuQ3JlYXRlKCdVc2VyJywgJFVzZXJOYW1lKQogICAgICAgICRPYmpVc2VyLlNldFBhc3N3b3JkKCRQYXNzd29yZCkKCiAgICAgICAgIyBjb21taXQgdGhlIGNoYW5nZXMgdG8gdGhlIGxvY2FsIG1hY2hpbmUKICAgICAgICB0cnkgewogICAgICAgICAgICAkTnVsbCA9ICRPYmpVc2VyLlNldEluZm8oKQogICAgICAgICAgICAiWypdIFVzZXIgJFVzZXJOYW1lIHN1Y2Nlc3NmdWxseSBjcmVhdGVkIG9uIGhvc3QgJENvbXB1dGVyTmFtZSIKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICdbIV0gQWNjb3VudCBhbHJlYWR5IGV4aXN0cyEnCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgIH0KCiAgICAjIGlmIGEgZ3JvdXAgaXMgc3BlY2lmaWVkLCBpbnZva2UgQWRkLU5ldEdyb3VwVXNlciBhbmQgcmV0dXJuIGl0cyB2YWx1ZQogICAgaWYgKCRHcm91cE5hbWUpIHsKICAgICAgICAjIGlmIHdlJ3JlIGFkZGluZyB0aGUgdXNlciB0byBhIGRvbWFpbgogICAgICAgIGlmICgkRG9tYWluKSB7CiAgICAgICAgICAgIEFkZC1OZXRHcm91cFVzZXIgLVVzZXJOYW1lICRVc2VyTmFtZSAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRG9tYWluCiAgICAgICAgICAgICJbKl0gVXNlciAkVXNlck5hbWUgc3VjY2Vzc2Z1bGx5IGFkZGVkIHRvIGdyb3VwICRHcm91cE5hbWUgaW4gZG9tYWluICREb21haW4iCiAgICAgICAgfQogICAgICAgICMgb3RoZXJ3aXNlLCB3ZSdyZSBhZGRpbmcgdG8gYSBsb2NhbCBncm91cAogICAgICAgIGVsc2UgewogICAgICAgICAgICBBZGQtTmV0R3JvdXBVc2VyIC1Vc2VyTmFtZSAkVXNlck5hbWUgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAiWypdIFVzZXIgJFVzZXJOYW1lIHN1Y2Nlc3NmdWxseSBhZGRlZCB0byBncm91cCAkR3JvdXBOYW1lIG9uIGhvc3QgJENvbXB1dGVyTmFtZSIKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBBZGQtTmV0R3JvdXBVc2VyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBBZGRzIGEgdXNlciB0byBhIGRvbWFpbiBncm91cCBvciBhIGxvY2FsIGdyb3VwIG9uIHRoZSBjdXJyZW50IChvciByZW1vdGUpIG1hY2hpbmUsCiAgICAgICAgaWYgcGVybWlzc2lvbnMgYWxsb3csIHV0aWxpemluZyB0aGUgV2luTlQgc2VydmljZSBwcm92aWRlciBhbmQKICAgICAgICBEaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudCwgcmVzcGVjdGl2ZWx5LgoKICAgIC5QQVJBTUVURVIgVXNlck5hbWUKCiAgICAgICAgVGhlIGRvbWFpbiB1c2VybmFtZSB0byBxdWVyeSBmb3IuCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgR3JvdXAgdG8gYWRkIHRoZSB1c2VyIHRvLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIEhvc3RuYW1lIHRvIGFkZCB0aGUgdXNlciB0bywgZGVmYXVsdHMgdG8gbG9jYWxob3N0LgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBhZGQgdGhlIHVzZXIgdG8uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBBZGQtTmV0R3JvdXBVc2VyIC1Vc2VyTmFtZSBqb2huIC1Hcm91cE5hbWUgQWRtaW5pc3RyYXRvcnMKICAgICAgICAKICAgICAgICBBZGRzIGEgbG9jYWx1c2VyICJqb2huIiB0byB0aGUgbG9jYWwgZ3JvdXAgIkFkbWluaXN0cmF0b3JzIgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQWRkLU5ldEdyb3VwVXNlciAtVXNlck5hbWUgam9obiAtR3JvdXBOYW1lICJEb21haW4gQWRtaW5zIiAtRG9tYWluIGRldi5sb2NhbAogICAgICAgIAogICAgICAgIEFkZHMgdGhlIGV4aXN0aW5nIHVzZXIgImpvaG4iIHRvIHRoZSBkb21haW4gZ3JvdXAgIkRvbWFpbiBBZG1pbnMiIGluICJkZXYubG9jYWwiCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtBbGlhcygnSG9zdE5hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbgogICAgKQoKICAgICMgYWRkIHRoZSBhc3NlbWJseSBpZiB3ZSBuZWVkIGl0CiAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudAoKICAgICMgaWYgd2UncmUgYWRkaW5nIHRvIGEgcmVtb3RlIGhvc3QncyBsb2NhbCBncm91cCwgdXNlIHRoZSBXaW5OVCBwcm92aWRlcgogICAgaWYoJENvbXB1dGVyTmFtZSAtYW5kICgkQ29tcHV0ZXJOYW1lIC1uZSAibG9jYWxob3N0IikpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJBZGRpbmcgdXNlciAkVXNlck5hbWUgdG8gJEdyb3VwTmFtZSBvbiBob3N0ICRDb21wdXRlck5hbWUiCiAgICAgICAgICAgIChbQURTSV0iV2luTlQ6Ly8kQ29tcHV0ZXJOYW1lLyRHcm91cE5hbWUsZ3JvdXAiKS5hZGQoIldpbk5UOi8vJENvbXB1dGVyTmFtZS8kVXNlck5hbWUsdXNlciIpCiAgICAgICAgICAgICJbKl0gVXNlciAkVXNlck5hbWUgc3VjY2Vzc2Z1bGx5IGFkZGVkIHRvIGdyb3VwICRHcm91cE5hbWUgb24gJENvbXB1dGVyTmFtZSIKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJbIV0gRXJyb3IgYWRkaW5nIHVzZXIgJFVzZXJOYW1lIHRvIGdyb3VwICRHcm91cE5hbWUgb24gJENvbXB1dGVyTmFtZSIKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgfQoKICAgICMgb3RoZXJ3aXNlIGl0J3MgYSBsb2NhbCBtYWNoaW5lIG9yIGRvbWFpbiBhZGQKICAgIGVsc2UgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICgkRG9tYWluKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJBZGRpbmcgdXNlciAkVXNlck5hbWUgdG8gJEdyb3VwTmFtZSBvbiBkb21haW4gJERvbWFpbiIKICAgICAgICAgICAgICAgICRDVCA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuQ29udGV4dFR5cGVdOjpEb21haW4KICAgICAgICAgICAgICAgICREb21haW5PYmplY3QgPSBHZXQtTmV0RG9tYWluIC1Eb21haW4gJERvbWFpbgogICAgICAgICAgICAgICAgaWYoLW5vdCAkRG9tYWluT2JqZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICROdWxsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjIGdldCB0aGUgZnVsbCBwcmluY2lwYWwgY29udGV4dAogICAgICAgICAgICAgICAgJENvbnRleHQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuUHJpbmNpcGFsQ29udGV4dCAtQXJndW1lbnRMaXN0ICRDVCwgJERvbWFpbk9iamVjdCAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyBvdGhlcndpc2UsIGdldCB0aGUgbG9jYWwgbWFjaGluZSBjb250ZXh0CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJBZGRpbmcgdXNlciAkVXNlck5hbWUgdG8gJEdyb3VwTmFtZSBvbiBsb2NhbGhvc3QiCiAgICAgICAgICAgICAgICAkQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlByaW5jaXBhbENvbnRleHQoW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5Db250ZXh0VHlwZV06Ok1hY2hpbmUsICRFbnY6Q29tcHV0ZXJOYW1lKQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGZpbmQgdGhlIHBhcnRpY3VsYXIgZ3JvdXAKICAgICAgICAgICAgJEdyb3VwID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5Hcm91cFByaW5jaXBhbF06OkZpbmRCeUlkZW50aXR5KCRDb250ZXh0LCRHcm91cE5hbWUpCgogICAgICAgICAgICAjIGFkZCB0aGUgcGFydGljdWxhciB1c2VyIHRvIHRoZSBncm91cAogICAgICAgICAgICAkR3JvdXAuTWVtYmVycy5hZGQoJENvbnRleHQsIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuSWRlbnRpdHlUeXBlXTo6U2FtQWNjb3VudE5hbWUsICRVc2VyTmFtZSkKCiAgICAgICAgICAgICMgY29tbWl0IHRoZSBjaGFuZ2VzCiAgICAgICAgICAgICRHcm91cC5TYXZlKCkKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBhZGRpbmcgJFVzZXJOYW1lIHRvICRHcm91cE5hbWUgOiAkXyIKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtVXNlclByb3BlcnR5IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgdXNlciBvYmplY3QgcHJvcGVydGllcy4gSWYgYSBwcm9wZXJ0eQogICAgICAgIG5hbWUgaXMgc3BlY2lmaWVkLCBpdCByZXR1cm5zIGFsbCBbdXNlcjpwcm9wZXJ0eV0gdmFsdWVzLgoKICAgICAgICBUYWtlbiBkaXJlY3RseSBmcm9tIEBvYnNjdXJlc2VjJ3MgcG9zdDoKICAgICAgICAgICAgaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxNC8wNC9BRFNJU2VhcmNoZXIuaHRtbAoKICAgIC5QQVJBTUVURVIgUHJvcGVydGllcwoKICAgICAgICBQcm9wZXJ0eSBuYW1lcyB0byBleHRyYWN0IGZvciB1c2Vycy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VyIHByb3BlcnRpZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVVzZXJQcm9wZXJ0eSAtRG9tYWluIHRlc3RpbmcKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFsbCB1c2VyIHByb3BlcnRpZXMgZm9yIHVzZXJzIGluIHRoZSAndGVzdGluZycgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVVzZXJQcm9wZXJ0eSAtUHJvcGVydGllcyBzc24sbGFzdGxvZ29uLGxvY2F0aW9uCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgYW4gYXJyYXkgb2YgdXNlci9zc24vbGFzdGxvZ2luL2xvY2F0aW9uIGNvbWJpbmF0aW9ucwogICAgICAgIGZvciB1c2VycyBpbiB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxNC8wNC9BRFNJU2VhcmNoZXIuaHRtbAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJFByb3BlcnRpZXMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgaWYoJFByb3BlcnRpZXMpIHsKICAgICAgICAjIGV4dHJhY3Qgb3V0IHRoZSBzZXQgb2YgYWxsIHByb3BlcnRpZXMgZm9yIGVhY2ggb2JqZWN0CiAgICAgICAgJFByb3BlcnRpZXMgPSAsIm5hbWUiICsgJFByb3BlcnRpZXMKICAgICAgICBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZSAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCB8IFNlbGVjdC1PYmplY3QgLVByb3BlcnR5ICRQcm9wZXJ0aWVzCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAjIGV4dHJhY3Qgb3V0IGp1c3QgdGhlIHByb3BlcnR5IG5hbWVzCiAgICAgICAgR2V0LU5ldFVzZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxIHwgR2V0LU1lbWJlciAtTWVtYmVyVHlwZSAqUHJvcGVydHkgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSAnTmFtZScKICAgIH0KfQoKCmZpbHRlciBGaW5kLVVzZXJGaWVsZCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgU2VhcmNoZXMgdXNlciBvYmplY3QgZmllbGRzIGZvciBhIGdpdmVuIHdvcmQgKGRlZmF1bHQgKnBhc3MqKS4gRGVmYXVsdAogICAgICAgIGZpZWxkIGJlaW5nIHNlYXJjaGVkIGlzICdkZXNjcmlwdGlvbicuCgogICAgICAgIFRha2VuIGRpcmVjdGx5IGZyb20gQG9ic2N1cmVzZWMncyBwb3N0OgogICAgICAgICAgICBodHRwOi8vb2JzY3VyZXNlY3VyaXR5LmJsb2dzcG90LmNvbS8yMDE0LzA0L0FEU0lTZWFyY2hlci5odG1sCgogICAgLlBBUkFNRVRFUiBTZWFyY2hUZXJtCgogICAgICAgIFRlcm0gdG8gc2VhcmNoIGZvciwgZGVmYXVsdCBvZiAicGFzcyIuCgogICAgLlBBUkFNRVRFUiBTZWFyY2hGaWVsZAoKICAgICAgICBVc2VyIGZpZWxkIHRvIHNlYXJjaCwgZGVmYXVsdCBvZiAiZGVzY3JpcHRpb24iLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHNlYXJjaCBjb21wdXRlciBmaWVsZHMgZm9yLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtVXNlckZpZWxkIC1TZWFyY2hGaWVsZCBpbmZvIC1TZWFyY2hUZXJtIGJhY2t1cAoKICAgICAgICBGaW5kIHVzZXIgYWNjb3VudHMgd2l0aCAiYmFja3VwIiBpbiB0aGUgImluZm8iIGZpZWxkLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlYXJjaFRlcm0gPSAncGFzcycsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlYXJjaEZpZWxkID0gJ2Rlc2NyaXB0aW9uJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCiAKICAgIEdldC1OZXRVc2VyIC1BRFNwYXRoICRBRFNwYXRoIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtRmlsdGVyICIoJFNlYXJjaEZpZWxkPSokU2VhcmNoVGVybSopIiAtUGFnZVNpemUgJFBhZ2VTaXplIHwgU2VsZWN0LU9iamVjdCBzYW1hY2NvdW50bmFtZSwkU2VhcmNoRmllbGQKfQoKCmZpbHRlciBHZXQtVXNlckV2ZW50IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBEdW1wIGFuZCBwYXJzZSBzZWN1cml0eSBldmVudHMgcmVsYXRpbmcgdG8gYW4gYWNjb3VudCBsb2dvbiAoSUQgNDYyNCkKICAgICAgICBvciBhIFRHVCByZXF1ZXN0IGV2ZW50IChJRCA0NzY4KS4gSW50ZW5kZWQgdG8gYmUgdXNlZCBhbmQgdGVzdGVkIG9uCiAgICAgICAgV2luZG93cyAyMDA4IERvbWFpbiBDb250cm9sbGVycy4KICAgICAgICBBZG1pbiBSZXFkPyBZRVMKCiAgICAgICAgQXV0aG9yOiBAc2l4ZHViCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGNvbXB1dGVyIHRvIGdldCBldmVudHMgZnJvbS4gRGVmYXVsdDogTG9jYWxob3N0CgogICAgLlBBUkFNRVRFUiBFdmVudFR5cGUKCiAgICAgICAgRWl0aGVyICdsb2dvbicsICd0Z3QnLCBvciAnYWxsJy4gRGVmYXVsdHM6ICdsb2dvbicKCiAgICAuUEFSQU1FVEVSIERhdGVTdGFydAoKICAgICAgICBGaWx0ZXIgb3V0IGFsbCBldmVudHMgYmVmb3JlIHRoaXMgZGF0ZS4gRGVmYXVsdDogNSBkYXlzCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Vc2VyRXZlbnQgLUNvbXB1dGVyTmFtZSBEb21haW5Db250cm9sbGVyLnRlc3RsYWIubG9jYWwKCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vd3d3LnNpeGR1Yi5uZXQvMjAxNC8xMS8wNy9vZmZlbnNpdmUtZXZlbnQtcGFyc2luZy1icmluZ2luZy1ob21lLXRyb3BoaWVzLwojPgoKICAgIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRFbnY6Q29tcHV0ZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZVNldCgibG9nb24iLCJ0Z3QiLCJhbGwiKV0KICAgICAgICAkRXZlbnRUeXBlID0gImxvZ29uIiwKCiAgICAgICAgW0RhdGVUaW1lXQogICAgICAgICREYXRlU3RhcnQgPSBbRGF0ZVRpbWVdOjpUb2RheS5BZGREYXlzKC01KSwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBpZigkRXZlbnRUeXBlLlRvTG93ZXIoKSAtbGlrZSAibG9nb24iKSB7CiAgICAgICAgW0ludDMyW11dJElEID0gQCg0NjI0KQogICAgfQogICAgZWxzZWlmKCRFdmVudFR5cGUuVG9Mb3dlcigpIC1saWtlICJ0Z3QiKSB7CiAgICAgICAgW0ludDMyW11dJElEID0gQCg0NzY4KQogICAgfQogICAgZWxzZSB7CiAgICAgICAgW0ludDMyW11dJElEID0gQCg0NjI0LCA0NzY4KQogICAgfQoKICAgIGlmKCRDcmVkZW50aWFsKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgYWx0ZXJuYXRpdmUgY3JlZGVudGlhbHMiCiAgICAgICAgJEFyZ3VtZW50cyA9IEB7CiAgICAgICAgICAgICdDb21wdXRlck5hbWUnID0gJENvbXB1dGVyTmFtZTsKICAgICAgICAgICAgJ0NyZWRlbnRpYWwnID0gJENyZWRlbnRpYWw7CiAgICAgICAgICAgICdGaWx0ZXJIYXNoVGFibGUnID0gQHsgTG9nTmFtZSA9ICdTZWN1cml0eSc7IElEPSRJRDsgU3RhcnRUaW1lPSREYXRlU3RhcnR9OwogICAgICAgICAgICAnRXJyb3JBY3Rpb24nID0gJ1NpbGVudGx5Q29udGludWUnOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgICRBcmd1bWVudHMgPSBAewogICAgICAgICAgICAnQ29tcHV0ZXJOYW1lJyA9ICRDb21wdXRlck5hbWU7CiAgICAgICAgICAgICdGaWx0ZXJIYXNoVGFibGUnID0gQHsgTG9nTmFtZSA9ICdTZWN1cml0eSc7IElEPSRJRDsgU3RhcnRUaW1lPSREYXRlU3RhcnR9OwogICAgICAgICAgICAnRXJyb3JBY3Rpb24nID0gJ1NpbGVudGx5Q29udGludWUnOyAgICAgICAgICAgIAogICAgICAgIH0KICAgIH0KCiAgICAjIGdyYWIgYWxsIGV2ZW50cyBtYXRjaGluZyBvdXIgZmlsdGVyIGZvciB0aGUgc3BlY2lmaWVkIGhvc3QKICAgIEdldC1XaW5FdmVudCBAQXJndW1lbnRzIHwgRm9yRWFjaC1PYmplY3QgewoKICAgICAgICBpZigkSUQgLWNvbnRhaW5zIDQ2MjQpIHsgICAgCiAgICAgICAgICAgICMgZmlyc3QgcGFyc2UgYW5kIGNoZWNrIHRoZSBsb2dvbiBldmVudCB0eXBlLiBUaGlzIGNvdWxkIGJlIGxhdGVyIGFkYXB0ZWQgYW5kIHRlc3RlZCBmb3IgUkRQIGxvZ29ucyAodHlwZSAxMCkKICAgICAgICAgICAgaWYoJF8ubWVzc2FnZSAtbWF0Y2ggJyg/cykoPzw9TG9nb24gVHlwZTopLio/KD89KEltcGVyc29uYXRpb24gTGV2ZWw6fE5ldyBMb2dvbjopKScpIHsKICAgICAgICAgICAgICAgIGlmKCRNYXRjaGVzKSB7CiAgICAgICAgICAgICAgICAgICAgJExvZ29uVHlwZSA9ICRNYXRjaGVzWzBdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICRNYXRjaGVzID0gJE51bGwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRMb2dvblR5cGUgPSAiIgogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGludGVyYWN0aXZlIGxvZ29ucyBvciBkb21haW4gbG9nb25zCiAgICAgICAgICAgIGlmICgoJExvZ29uVHlwZSAtZXEgMikgLW9yICgkTG9nb25UeXBlIC1lcSAzKSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAjIHBhcnNlIGFuZCBzdG9yZSB0aGUgYWNjb3VudCB1c2VkIGFuZCB0aGUgYWRkcmVzcyB0aGV5IGNhbWUgZnJvbQogICAgICAgICAgICAgICAgICAgIGlmKCRfLm1lc3NhZ2UgLW1hdGNoICcoP3MpKD88PU5ldyBMb2dvbjopLio/KD89UHJvY2VzcyBJbmZvcm1hdGlvbjopJykgewogICAgICAgICAgICAgICAgICAgICAgICBpZigkTWF0Y2hlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJOYW1lID0gJE1hdGNoZXNbMF0uc3BsaXQoImBuIilbMl0uc3BsaXQoIjoiKVsxXS50cmltKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICREb21haW4gPSAkTWF0Y2hlc1swXS5zcGxpdCgiYG4iKVszXS5zcGxpdCgiOiIpWzFdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1hdGNoZXMgPSAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCRfLm1lc3NhZ2UgLW1hdGNoICcoP3MpKD88PU5ldHdvcmsgSW5mb3JtYXRpb246KS4qPyg/PVNvdXJjZSBQb3J0OiknKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRNYXRjaGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWRkcmVzcyA9ICRNYXRjaGVzWzBdLnNwbGl0KCJgbiIpWzJdLnNwbGl0KCI6IilbMV0udHJpbSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWF0Y2hlcyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICMgb25seSBhZGQgaWYgdGhlcmUgd2FzIGFjY291bnQgaW5mb3JtYXRpb24gbm90IGZvciBhIG1hY2hpbmUgb3IgYW5vbnltb3VzIGxvZ29uCiAgICAgICAgICAgICAgICAgICAgaWYgKCRVc2VyTmFtZSAtYW5kICgtbm90ICRVc2VyTmFtZS5lbmRzV2l0aCgnJCcpKSAtYW5kICgkVXNlck5hbWUgLW5lICdBTk9OWU1PVVMgTE9HT04nKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkTG9nb25FdmVudFByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0RvbWFpbicgPSAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29tcHV0ZXJOYW1lJyA9ICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdVc2VybmFtZScgPSAkVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBZGRyZXNzJyA9ICRBZGRyZXNzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSUQnID0gJzQ2MjQnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTG9nb25UeXBlJyA9ICRMb2dvblR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUaW1lJyA9ICRfLlRpbWVDcmVhdGVkCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5ICRMb2dvbkV2ZW50UHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgcGFyc2luZyBldmVudCBsb2dzOiAkXyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZigkSUQgLWNvbnRhaW5zIDQ3NjgpIHsKICAgICAgICAgICAgIyB0aGUgVEdUIGV2ZW50IHR5cGUKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmKCRfLm1lc3NhZ2UgLW1hdGNoICcoP3MpKD88PUFjY291bnQgSW5mb3JtYXRpb246KS4qPyg/PVNlcnZpY2UgSW5mb3JtYXRpb246KScpIHsKICAgICAgICAgICAgICAgICAgICBpZigkTWF0Y2hlcykgewogICAgICAgICAgICAgICAgICAgICAgICAkVXNlcm5hbWUgPSAkTWF0Y2hlc1swXS5zcGxpdCgiYG4iKVsxXS5zcGxpdCgiOiIpWzFdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluID0gJE1hdGNoZXNbMF0uc3BsaXQoImBuIilbMl0uc3BsaXQoIjoiKVsxXS50cmltKCkKICAgICAgICAgICAgICAgICAgICAgICAgJE1hdGNoZXMgPSAkTnVsbAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkXy5tZXNzYWdlIC1tYXRjaCAnKD9zKSg/PD1OZXR3b3JrIEluZm9ybWF0aW9uOikuKj8oPz1BZGRpdGlvbmFsIEluZm9ybWF0aW9uOiknKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoJE1hdGNoZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEFkZHJlc3MgPSAkTWF0Y2hlc1swXS5zcGxpdCgiYG4iKVsxXS5zcGxpdCgiOiIpWy0xXS50cmltKCkKICAgICAgICAgICAgICAgICAgICAgICAgJE1hdGNoZXMgPSAkTnVsbAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkTG9nb25FdmVudFByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAgICAgICAgICdDb21wdXRlck5hbWUnID0gJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICdVc2VybmFtZScgPSAkVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICAnQWRkcmVzcycgPSAkQWRkcmVzcwogICAgICAgICAgICAgICAgICAgICdJRCcgPSAnNDc2OCcKICAgICAgICAgICAgICAgICAgICAnTG9nb25UeXBlJyA9ICcnCiAgICAgICAgICAgICAgICAgICAgJ1RpbWUnID0gJF8uVGltZUNyZWF0ZWQKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgJExvZ29uRXZlbnRQcm9wZXJ0aWVzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHBhcnNpbmcgZXZlbnQgbG9nczogJF8iCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtT2JqZWN0QWNsIHsKPCMKICAgIC5TWU5PUFNJUwogICAgICAgIFJldHVybnMgdGhlIEFDTHMgYXNzb2NpYXRlZCB3aXRoIGEgc3BlY2lmaWMgYWN0aXZlIGRpcmVjdG9yeSBvYmplY3QuCgogICAgICAgIFRoYW5rcyBTZWFuIE1ldGNhbGYgKEBweXJvdGVrMykgZm9yIHRoZSBpZGVhIGFuZCBndWlkYW5jZS4KCiAgICAuUEFSQU1FVEVSIFNhbUFjY291bnROYW1lCgogICAgICAgIE9iamVjdCBuYW1lIHRvIGZpbHRlciBmb3IuICAgICAgICAKCiAgICAuUEFSQU1FVEVSIE5hbWUKCiAgICAgICAgT2JqZWN0IG5hbWUgdG8gZmlsdGVyIGZvci4KCiAgICAuUEFSQU1FVEVSIERpc3Rpbmd1aXNoZWROYW1lCgogICAgICAgIE9iamVjdCBkaXN0aW5ndWlzaGVkIG5hbWUgdG8gZmlsdGVyIGZvci4KCiAgICAuUEFSQU1FVEVSIFJlc29sdmVHVUlEcwoKICAgICAgICBTd2l0Y2guIFJlc29sdmUgR1VJRHMgdG8gdGhlaXIgZGlzcGxheSBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgogICAgIAogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEFEU3ByZWZpeAoKICAgICAgICBQcmVmaXggdG8gc2V0IGZvciB0aGUgc2VhcmNoZXIgKGxpa2UgIkNOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iKQoKICAgIC5QQVJBTUVURVIgUmlnaHRzRmlsdGVyCgogICAgICAgIE9ubHkgcmV0dXJuIHJlc3VsdHMgd2l0aCB0aGUgYXNzb2NpYXRlZCByaWdodHMsICJBbGwiLCAiUmVzZXRQYXNzd29yZCIsIldyaXRlTWVtYmVycyIKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHVzZSBmb3IgdGhlIHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtT2JqZWN0QWNsIC1TYW1BY2NvdW50TmFtZSBtYXR0LmFkbWluIC1kb21haW4gdGVzdGxhYi5sb2NhbAogICAgICAgIAogICAgICAgIEdldCB0aGUgQUNMcyBmb3IgdGhlIG1hdHQuYWRtaW4gdXNlciBpbiB0aGUgdGVzdGxhYi5sb2NhbCBkb21haW4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1PYmplY3RBY2wgLVNhbUFjY291bnROYW1lIG1hdHQuYWRtaW4gLWRvbWFpbiB0ZXN0bGFiLmxvY2FsIC1SZXNvbHZlR1VJRHMKICAgICAgICAKICAgICAgICBHZXQgdGhlIEFDTHMgZm9yIHRoZSBtYXR0LmFkbWluIHVzZXIgaW4gdGhlIHRlc3RsYWIubG9jYWwgZG9tYWluIGFuZAogICAgICAgIHJlc29sdmUgcmVsZXZhbnQgR1VJRHMgdG8gdGhlaXIgZGlzcGxheSBuYW1lcy4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNhbUFjY291bnROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lID0gIioiLAoKICAgICAgICBbQWxpYXMoJ0ROJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRGlzdGluZ3Vpc2hlZE5hbWUgPSAiKiIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlc29sdmVHVUlEcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwcmVmaXgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJBbGwiLCJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIildCiAgICAgICAgJFJpZ2h0c0ZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgJFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtQURTcHJlZml4ICRBRFNwcmVmaXggLVBhZ2VTaXplICRQYWdlU2l6ZSAKCiAgICAgICAgIyBnZXQgYSBHVUlEIC0+IG5hbWUgbWFwcGluZwogICAgICAgIGlmKCRSZXNvbHZlR1VJRHMpIHsKICAgICAgICAgICAgJEdVSURzID0gR2V0LUdVSURNYXAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmICgkU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmKCRTYW1BY2NvdW50TmFtZSkgewogICAgICAgICAgICAgICAgJFNlYXJjaGVyLmZpbHRlcj0iKCYoc2FtYWNjb3VudG5hbWU9JFNhbUFjY291bnROYW1lKShuYW1lPSROYW1lKShkaXN0aW5ndWlzaGVkbmFtZT0kRGlzdGluZ3Vpc2hlZE5hbWUpJEZpbHRlcikiICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRTZWFyY2hlci5maWx0ZXI9IigmKG5hbWU9JE5hbWUpKGRpc3Rpbmd1aXNoZWRuYW1lPSREaXN0aW5ndWlzaGVkTmFtZSkkRmlsdGVyKSIgIAogICAgICAgICAgICB9CiAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkUmVzdWx0cyA9ICRTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJE9iamVjdCA9IFthZHNpXSgkXy5wYXRoKQoKICAgICAgICAgICAgICAgICAgICBpZigkT2JqZWN0LmRpc3Rpbmd1aXNoZWRuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3MgPSAkT2JqZWN0LlBzQmFzZS5PYmplY3RTZWN1cml0eS5hY2Nlc3MKICAgICAgICAgICAgICAgICAgICAgICAgJEFjY2VzcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgJ09iamVjdEROJyAkT2JqZWN0LmRpc3Rpbmd1aXNoZWRuYW1lWzBdCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJE9iamVjdC5vYmplY3RzaWRbMF0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTID0gKE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXIoJE9iamVjdC5vYmplY3RzaWRbMF0sMCkpLlZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgJ09iamVjdFNJRCcgJFMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmKCRSaWdodHNGaWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEd1aWRGaWx0ZXIgPSBTd2l0Y2ggKCRSaWdodHNGaWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJSZXNldFBhc3N3b3JkIiB7ICIwMDI5OTU3MC0yNDZkLTExZDAtYTc2OC0wMGFhMDA2ZTA1MjkiIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJXcml0ZU1lbWJlcnMiIHsgImJmOTY3OWMwLTBkZTYtMTFkMC1hMjg1LTAwYWEwMDMwNDllMiIgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVmYXVsdCB7ICIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAifQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRfLk9iamVjdFR5cGUgLWVxICRHdWlkRmlsdGVyKSB7ICRfIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICBpZigkR1VJRHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSByZXNvbHZpbmcgR1VJRHMsIG1hcCB0aGVtIHRoZW0gdG8gdGhlIHJlc29sdmVkIGhhc2ggdGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgJEFjbFByb3BlcnRpZXMgPSBAe30KICAgICAgICAgICAgICAgICAgICAgICAgJF8ucHNvYmplY3QucHJvcGVydGllcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAoJF8uTmFtZSAtZXEgJ09iamVjdFR5cGUnKSAtb3IgKCRfLk5hbWUgLWVxICdJbmhlcml0ZWRPYmplY3RUeXBlJykgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEFjbFByb3BlcnRpZXNbJF8uTmFtZV0gPSAkR1VJRFNbJF8uVmFsdWUudG9TdHJpbmcoKV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNsUHJvcGVydGllc1skXy5OYW1lXSA9ICRfLlZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEFjbFByb3BlcnRpZXNbJF8uTmFtZV0gPSAkXy5WYWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkQWNsUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsgJF8gfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFJlc3VsdHMuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAkU2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAkXwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gQWRkLU9iamVjdEFjbCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQWRkcyBhbiBBQ0wgZm9yIGEgc3BlY2lmaWMgYWN0aXZlIGRpcmVjdG9yeSBvYmplY3QuCiAgICAgICAgCiAgICAgICAgQWRtaW5TREhvbGRlciBBQ0wgYXBwcm9hY2ggZnJvbSBTZWFuIE1ldGNhbGYgKEBweXJvdGVrMykKICAgICAgICAgICAgaHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xOTA2CgogICAgICAgIEFDRSBzZXR0aW5nIG1ldGhvZCBhZGFwdGVkIGZyb20gaHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL0ZvcnVtcy93aW5kb3dzc2VydmVyL2VuLVVTL2RmM2JmZDMzLWMwNzAtNGE5Yy1iZTk4LWM0ZGE2ZTU5MWEwYS9mb3J1bS1mYXEtdXNpbmctcG93ZXJzaGVsbC10by1hc3NpZ24tcGVybWlzc2lvbnMtb24tYWN0aXZlLWRpcmVjdG9yeS1vYmplY3RzLgoKICAgICAgICAnUmVzZXRQYXNzd29yZCcgZG9lc24ndCBuZWVkIHRvIGtub3cgdGhlIHVzZXIncyBjdXJyZW50IHBhc3N3b3JkCiAgICAgICAgJ1dyaXRlTWVtYmVycycgYWxsb3dzIGZvciB0aGUgbW9kaWZpY2F0aW9uIG9mIGdyb3VwIG1lbWJlcnNoaXAKCiAgICAuUEFSQU1FVEVSIFRhcmdldFNhbUFjY291bnROYW1lCgogICAgICAgIFRhcmdldCBvYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLiAgICAgICAgCgogICAgLlBBUkFNRVRFUiBUYXJnZXROYW1lCgogICAgICAgIFRhcmdldCBvYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0RGlzdGluZ3Vpc2hlZE5hbWUKCiAgICAgICAgVGFyZ2V0IG9iamVjdCBkaXN0aW5ndWlzaGVkIG5hbWUgdG8gZmlsdGVyIGZvci4KCiAgICAuUEFSQU1FVEVSIFRhcmdldEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSB0byBmaW5kIGEgdGFyZ2V0LCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBUYXJnZXRBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSBmb3IgdGhlIHRhcmdldCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0QURTcHJlZml4CgogICAgICAgIFByZWZpeCB0byBzZXQgZm9yIHRoZSB0YXJnZXQgc2VhcmNoZXIgKGxpa2UgIkNOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iKQoKICAgIC5QQVJBTUVURVIgUHJpbmNpcGFsU0lECgogICAgICAgIFRoZSBTSUQgb2YgdGhlIHByaW5jaXBhbCBvYmplY3QgdG8gYWRkIGZvciBhY2Nlc3MuCgogICAgLlBBUkFNRVRFUiBQcmluY2lwYWxOYW1lCgogICAgICAgIFRoZSBuYW1lIG9mIHRoZSBwcmluY2lwYWwgb2JqZWN0IHRvIGFkZCBmb3IgYWNjZXNzLgoKICAgIC5QQVJBTUVURVIgUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUKCiAgICAgICAgVGhlIHNhbUFjY291bnROYW1lIG9mIHRoZSBwcmluY2lwYWwgb2JqZWN0IHRvIGFkZCBmb3IgYWNjZXNzLgoKICAgIC5QQVJBTUVURVIgUmlnaHRzCgogICAgICAgIFJpZ2h0cyB0byBhZGQgZm9yIHRoZSBwcmluY2lwYWwsICJBbGwiLCJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIiwiRENTeW5jIgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gdXNlIGZvciB0aGUgdGFyZ2V0IHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgQWRkLU9iamVjdEFjbCAtVGFyZ2V0U2FtQWNjb3VudE5hbWUgbWF0dCAtUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUgam9obgoKICAgICAgICBHcmFudHMgJ2pvaG4nIGFsbCBmdWxsIGFjY2VzcyByaWdodHMgdG8gdGhlICdtYXR0JyBhY2NvdW50LgoKICAgIC5FWEFNUExFCgogICAgICAgIEFkZC1PYmplY3RBY2wgLVRhcmdldFNhbUFjY291bnROYW1lIG1hdHQgLVByaW5jaXBhbFNhbUFjY291bnROYW1lIGpvaG4gLVJpZ2h0cyBSZXNldFBhc3N3b3JkCgogICAgICAgIEdyYW50cyAnam9obicgdGhlIHJpZ2h0IHRvIHJlc2V0IHRoZSBwYXNzd29yZCBmb3IgdGhlICdtYXR0JyBhY2NvdW50LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHBzOi8vYWRzZWN1cml0eS5vcmcvP3A9MTkwNgogICAgICAgIAogICAgICAgIGh0dHBzOi8vc29jaWFsLnRlY2huZXQubWljcm9zb2Z0LmNvbS9Gb3J1bXMvd2luZG93c3NlcnZlci9lbi1VUy9kZjNiZmQzMy1jMDcwLTRhOWMtYmU5OC1jNGRhNmU1OTFhMGEvZm9ydW0tZmFxLXVzaW5nLXBvd2Vyc2hlbGwtdG8tYXNzaWduLXBlcm1pc3Npb25zLW9uLWFjdGl2ZS1kaXJlY3Rvcnktb2JqZWN0cz9mb3J1bT13aW5zZXJ2ZXJwb3dlcnNoZWxsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGFyZ2V0TmFtZSA9ICIqIiwKCiAgICAgICAgW0FsaWFzKCdETicpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldERpc3Rpbmd1aXNoZWROYW1lID0gIioiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldEFEU3ByZWZpeCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVQYXR0ZXJuKCdeUy0xLTUtMjEtWzAtOV0rLVswLTldKy1bMC05XSstWzAtOV0rJyldCiAgICAgICAgJFByaW5jaXBhbFNJRCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHJpbmNpcGFsTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJBbGwiLCJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIiwiRENTeW5jIildCiAgICAgICAgJFJpZ2h0cyA9ICJBbGwiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRSaWdodHNHVUlELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAkU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRUYXJnZXRBRFNwYXRoIC1BRFNwcmVmaXggJFRhcmdldEFEU3ByZWZpeCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgIGlmKCEkUHJpbmNpcGFsU0lEKSB7CiAgICAgICAgICAgICRQcmluY2lwYWwgPSBHZXQtQURPYmplY3QgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1OYW1lICRQcmluY2lwYWxOYW1lIC1TYW1BY2NvdW50TmFtZSAkUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAKICAgICAgICAgICAgaWYoISRQcmluY2lwYWwpIHsKICAgICAgICAgICAgICAgIHRocm93ICJFcnJvciByZXNvbHZpbmcgcHJpbmNpcGFsIgogICAgICAgICAgICB9CiAgICAgICAgICAgICRQcmluY2lwYWxTSUQgPSAkUHJpbmNpcGFsLm9iamVjdHNpZAogICAgICAgIH0KICAgICAgICBpZighJFByaW5jaXBhbFNJRCkgewogICAgICAgICAgICB0aHJvdyAiRXJyb3IgcmVzb2x2aW5nIHByaW5jaXBhbCIKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmICgkU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmKCRUYXJnZXRTYW1BY2NvdW50TmFtZSkgewogICAgICAgICAgICAgICAgJFNlYXJjaGVyLmZpbHRlcj0iKCYoc2FtYWNjb3VudG5hbWU9JFRhcmdldFNhbUFjY291bnROYW1lKShuYW1lPSRUYXJnZXROYW1lKShkaXN0aW5ndWlzaGVkbmFtZT0kVGFyZ2V0RGlzdGluZ3Vpc2hlZE5hbWUpJFRhcmdldEZpbHRlcikiICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRTZWFyY2hlci5maWx0ZXI9IigmKG5hbWU9JFRhcmdldE5hbWUpKGRpc3Rpbmd1aXNoZWRuYW1lPSRUYXJnZXREaXN0aW5ndWlzaGVkTmFtZSkkVGFyZ2V0RmlsdGVyKSIgIAogICAgICAgICAgICB9CiAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkUmVzdWx0cyA9ICRTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICMgYWRhcHRlZCBmcm9tIGh0dHBzOi8vc29jaWFsLnRlY2huZXQubWljcm9zb2Z0LmNvbS9Gb3J1bXMvd2luZG93c3NlcnZlci9lbi1VUy9kZjNiZmQzMy1jMDcwLTRhOWMtYmU5OC1jNGRhNmU1OTFhMGEvZm9ydW0tZmFxLXVzaW5nLXBvd2Vyc2hlbGwtdG8tYXNzaWduLXBlcm1pc3Npb25zLW9uLWFjdGl2ZS1kaXJlY3Rvcnktb2JqZWN0cwoKICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0RE4gPSAkXy5Qcm9wZXJ0aWVzLmRpc3Rpbmd1aXNoZWRuYW1lCgogICAgICAgICAgICAgICAgICAgICRJZGVudGl0eSA9IFtTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLklkZW50aXR5UmVmZXJlbmNlXSAoW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyXSRQcmluY2lwYWxTSUQpCiAgICAgICAgICAgICAgICAgICAgJEluaGVyaXRhbmNlVHlwZSA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5U2VjdXJpdHlJbmhlcml0YW5jZV0gIk5vbmUiCiAgICAgICAgICAgICAgICAgICAgJENvbnRyb2xUeXBlID0gW1N5c3RlbS5TZWN1cml0eS5BY2Nlc3NDb250cm9sLkFjY2Vzc0NvbnRyb2xUeXBlXSAiQWxsb3ciCiAgICAgICAgICAgICAgICAgICAgJEFDRXMgPSBAKCkKCiAgICAgICAgICAgICAgICAgICAgaWYoJFJpZ2h0c0dVSUQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEdVSURzID0gQCgkUmlnaHRzR1VJRCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRHVUlEcyA9IFN3aXRjaCAoJFJpZ2h0cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBSZXNldFBhc3N3b3JkIGRvZXNuJ3QgbmVlZCB0byBrbm93IHRoZSB1c2VyJ3MgY3VycmVudCBwYXNzd29yZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJlc2V0UGFzc3dvcmQiIHsgIjAwMjk5NTcwLTI0NmQtMTFkMC1hNzY4LTAwYWEwMDZlMDUyOSIgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhbGxvd3MgZm9yIHRoZSBtb2RpZmljYXRpb24gb2YgZ3JvdXAgbWVtYmVyc2hpcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIldyaXRlTWVtYmVycyIgeyAiYmY5Njc5YzAtMGRlNi0xMWQwLWEyODUtMDBhYTAwMzA0OWUyIiB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjICdEUy1SZXBsaWNhdGlvbi1HZXQtQ2hhbmdlcycgPSAxMTMxZjZhYS05YzA3LTExZDEtZjc5Zi0wMGMwNGZjMmRjZDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgJ0RTLVJlcGxpY2F0aW9uLUdldC1DaGFuZ2VzLUFsbCcgPSAxMTMxZjZhZC05YzA3LTExZDEtZjc5Zi0wMGMwNGZjMmRjZDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgJ0RTLVJlcGxpY2F0aW9uLUdldC1DaGFuZ2VzLUluLUZpbHRlcmVkLVNldCcgPSA4OWU5NWI3Ni00NDRkLTRjNjItOTkxYS0wZmFjYmVkYTY0MGMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgICB3aGVuIGFwcGxpZWQgdG8gYSBkb21haW4ncyBBQ0wsIGFsbG93cyBmb3IgdGhlIHVzZSBvZiBEQ1N5bmMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJEQ1N5bmMiIHsgIjExMzFmNmFhLTljMDctMTFkMS1mNzlmLTAwYzA0ZmMyZGNkMiIsICIxMTMxZjZhZC05YzA3LTExZDEtZjc5Zi0wMGMwNGZjMmRjZDIiLCAiODllOTViNzYtNDQ0ZC00YzYyLTk5MWEtMGZhY2JlZGE2NDBjIn0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYoJEdVSURzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2goJEdVSUQgaW4gJEdVSURzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTmV3R1VJRCA9IE5ldy1PYmplY3QgR3VpZCAkR1VJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEFEUmlnaHRzID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnlSaWdodHNdICJFeHRlbmRlZFJpZ2h0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEFDRXMgKz0gTmV3LU9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5QWNjZXNzUnVsZSAkSWRlbnRpdHksJEFEUmlnaHRzLCRDb250cm9sVHlwZSwkTmV3R1VJRCwkSW5oZXJpdGFuY2VUeXBlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgZGVhdWx0IHRvIEdlbmVyaWNBbGwgcmlnaHRzCiAgICAgICAgICAgICAgICAgICAgICAgICRBRFJpZ2h0cyA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5UmlnaHRzXSAiR2VuZXJpY0FsbCIKICAgICAgICAgICAgICAgICAgICAgICAgJEFDRXMgKz0gTmV3LU9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5QWNjZXNzUnVsZSAkSWRlbnRpdHksJEFEUmlnaHRzLCRDb250cm9sVHlwZSwkSW5oZXJpdGFuY2VUeXBlCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJHcmFudGluZyBwcmluY2lwYWwgJFByaW5jaXBhbFNJRCAnJFJpZ2h0cycgb24gJCgkXy5Qcm9wZXJ0aWVzLmRpc3Rpbmd1aXNoZWRuYW1lKSIKCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBhZGQgYWxsIHRoZSBuZXcgQUNFcyB0byB0aGUgc3BlY2lmaWVkIG9iamVjdAogICAgICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkQUNFIGluICRBQ0VzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJHcmFudGluZyBwcmluY2lwYWwgJFByaW5jaXBhbFNJRCAnJCgkQUNFLk9iamVjdFR5cGUpJyByaWdodHMgb24gJCgkXy5Qcm9wZXJ0aWVzLmRpc3Rpbmd1aXNoZWRuYW1lKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPYmplY3QgPSBbYWRzaV0oJF8ucGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPYmplY3QuUHNCYXNlLk9iamVjdFNlY3VyaXR5LkFkZEFjY2Vzc1J1bGUoJEFDRSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPYmplY3QuUHNCYXNlLmNvbW1pdGNoYW5nZXMoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3IgZ3JhbnRpbmcgcHJpbmNpcGFsICRQcmluY2lwYWxTSUQgJyRSaWdodHMnIG9uICRUYXJnZXRETiA6ICRfIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJFNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1BQ0xTY2FubmVyIHsKPCMKICAgIC5TWU5PUFNJUwogICAgICAgIFNlYXJjaGVzIGZvciBBQ0xzIGZvciBzcGVjaWZhYmxlIEFEIG9iamVjdHMgKGRlZmF1bHQgdG8gYWxsIGRvbWFpbiBvYmplY3RzKQogICAgICAgIHdpdGggYSBkb21haW4gc2lkIG9mID4gLTEwMDAsIGFuZCBoYXZlIG1vZGlmaWFibGUgcmlnaHRzLgoKICAgICAgICBUaGFua3MgU2VhbiBNZXRjYWxmIChAcHlyb3RlazMpIGZvciB0aGUgaWRlYSBhbmQgZ3VpZGFuY2UuCgogICAgLlBBUkFNRVRFUiBTYW1BY2NvdW50TmFtZQoKICAgICAgICBPYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLiAgICAgICAgCgogICAgLlBBUkFNRVRFUiBOYW1lCgogICAgICAgIE9iamVjdCBuYW1lIHRvIGZpbHRlciBmb3IuCgogICAgLlBBUkFNRVRFUiBEaXN0aW5ndWlzaGVkTmFtZQoKICAgICAgICBPYmplY3QgZGlzdGluZ3Vpc2hlZCBuYW1lIHRvIGZpbHRlciBmb3IuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKICAgICAKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBBRFNwcmVmaXgKCiAgICAgICAgUHJlZml4IHRvIHNldCBmb3IgdGhlIHNlYXJjaGVyIChsaWtlICJDTj1TaXRlcyxDTj1Db25maWd1cmF0aW9uIikKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHVzZSBmb3IgdGhlIHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBSZXNvbHZlR1VJRHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIEdVSURzIHRvIHRoZWlyIGRpc3BsYXkgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtQUNMU2Nhbm5lciAtUmVzb2x2ZUdVSURzIHwgRXhwb3J0LUNTViAtTm9UeXBlSW5mb3JtYXRpb24gYWNscy5jc3YKCiAgICAgICAgRW51bWVyYXRlIGFsbCBtb2RpZmFibGUgQUNMcyBpbiB0aGUgY3VycmVudCBkb21haW4sIHJlc29sdmluZyBHVUlEcyB0byBkaXNwbGF5IAogICAgICAgIG5hbWVzLCBhbmQgZXhwb3J0IGV2ZXJ5dGhpbmcgdG8gYSAuY3N2CiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZSA9ICIqIiwKCiAgICAgICAgW0FsaWFzKCdETicpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERpc3Rpbmd1aXNoZWROYW1lID0gIioiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3ByZWZpeCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXNvbHZlR1VJRHMsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgICMgR2V0IGFsbCBkb21haW4gQUNMcyB3aXRoIHRoZSBhcHByb3ByaWF0ZSBwYXJhbWV0ZXJzCiAgICBHZXQtT2JqZWN0QUNMIEBQU0JvdW5kUGFyYW1ldGVycyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAjIGFkZCBpbiB0aGUgdHJhbnNsYXRlZCBTSUQgZm9yIHRoZSBvYmplY3QgaWRlbnRpdHkKICAgICAgICAkXyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJZGVudGl0eVNJRCcgKCRfLklkZW50aXR5UmVmZXJlbmNlLlRyYW5zbGF0ZShbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKS5WYWx1ZSkKICAgICAgICAkXwogICAgfSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgIyBjaGVjayBmb3IgYW55IEFDTHMgd2l0aCBTSURzID4gLTEwMDAKICAgICAgICB0cnkgewogICAgICAgICAgICAjIFRPRE86IGNoYW5nZSB0aGlzIHRvIGEgcmVnZXggZm9yIHNwZWVkdXA/CiAgICAgICAgICAgIFtpbnRdKCRfLklkZW50aXR5U2lkLnNwbGl0KCItIilbLTFdKSAtZ2UgMTAwMAogICAgICAgIH0KICAgICAgICBjYXRjaCB7fQogICAgfSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgIyBmaWx0ZXIgZm9yIG1vZGlmaWFibGUgcmlnaHRzCiAgICAgICAgKCRfLkFjdGl2ZURpcmVjdG9yeVJpZ2h0cyAtZXEgIkdlbmVyaWNBbGwiKSAtb3IgKCRfLkFjdGl2ZURpcmVjdG9yeVJpZ2h0cyAtbWF0Y2ggIldyaXRlIikgLW9yICgkXy5BY3RpdmVEaXJlY3RvcnlSaWdodHMgLW1hdGNoICJDcmVhdGUiKSAtb3IgKCRfLkFjdGl2ZURpcmVjdG9yeVJpZ2h0cyAtbWF0Y2ggIkRlbGV0ZSIpIC1vciAoKCRfLkFjdGl2ZURpcmVjdG9yeVJpZ2h0cyAtbWF0Y2ggIkV4dGVuZGVkUmlnaHQiKSAtYW5kICgkXy5BY2Nlc3NDb250cm9sVHlwZSAtZXEgIkFsbG93IikpCiAgICB9Cn0KCgpmaWx0ZXIgR2V0LUdVSURNYXAgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEhlbHBlciB0byBidWlsZCBhIGhhc2ggdGFibGUgb2YgW0dVSURdIC0+IHJlc29sdmVkIG5hbWVzCgogICAgICAgIEhlYXZpbHkgYWRhcHRlZCBmcm9tIGh0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL2FzaGxleW1jZ2xvbmUvYXJjaGl2ZS8yMDEzLzAzLzI1L2FjdGl2ZS1kaXJlY3Rvcnktb3UtcGVybWlzc2lvbnMtcmVwb3J0LWZyZWUtcG93ZXJzaGVsbC1zY3JpcHQtZG93bmxvYWQuYXNweAoKICAgIC5QQVJBTUVURVIgRG9tYWluCiAgICAKICAgICAgICBUaGUgZG9tYWluIHRvIHVzZSBmb3IgdGhlIHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCiAgICAKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL2FzaGxleW1jZ2xvbmUvYXJjaGl2ZS8yMDEzLzAzLzI1L2FjdGl2ZS1kaXJlY3Rvcnktb3UtcGVybWlzc2lvbnMtcmVwb3J0LWZyZWUtcG93ZXJzaGVsbC1zY3JpcHQtZG93bmxvYWQuYXNweAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICAkR1VJRHMgPSBAeycwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnID0gJ0FsbCd9CgogICAgJFNjaGVtYVBhdGggPSAoR2V0LU5ldEZvcmVzdCkuc2NoZW1hLm5hbWUKCiAgICAkU2NoZW1hU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLUFEU3BhdGggJFNjaGVtYVBhdGggLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgaWYoJFNjaGVtYVNlYXJjaGVyKSB7CiAgICAgICAgJFNjaGVtYVNlYXJjaGVyLmZpbHRlciA9ICIoc2NoZW1hSURHVUlEPSopIgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRSZXN1bHRzID0gJFNjaGVtYVNlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgIyBjb252ZXJ0IHRoZSBHVUlECiAgICAgICAgICAgICAgICAkR1VJRHNbKE5ldy1PYmplY3QgR3VpZCAoLCRfLnByb3BlcnRpZXMuc2NoZW1haWRndWlkWzBdKSkuR3VpZF0gPSAkXy5wcm9wZXJ0aWVzLm5hbWVbMF0KICAgICAgICAgICAgfQogICAgICAgICAgICAkUmVzdWx0cy5kaXNwb3NlKCkKICAgICAgICAgICAgJFNjaGVtYVNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBpbiBidWlsZGluZyBHVUlEIG1hcDogJF8iCiAgICAgICAgfQogICAgfQoKICAgICRSaWdodHNTZWFyY2hlciA9IEdldC1Eb21haW5TZWFyY2hlciAtQURTcGF0aCAkU2NoZW1hUGF0aC5yZXBsYWNlKCJTY2hlbWEiLCJFeHRlbmRlZC1SaWdodHMiKSAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplIC1DcmVkZW50aWFsICRDcmVkZW50aWFsCiAgICBpZiAoJFJpZ2h0c1NlYXJjaGVyKSB7CiAgICAgICAgJFJpZ2h0c1NlYXJjaGVyLmZpbHRlciA9ICIob2JqZWN0Q2xhc3M9Y29udHJvbEFjY2Vzc1JpZ2h0KSIKICAgICAgICB0cnkgewogICAgICAgICAgICAkUmVzdWx0cyA9ICRSaWdodHNTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgJFJlc3VsdHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICMgY29udmVydCB0aGUgR1VJRAogICAgICAgICAgICAgICAgJEdVSURzWyRfLnByb3BlcnRpZXMucmlnaHRzZ3VpZFswXS50b1N0cmluZygpXSA9ICRfLnByb3BlcnRpZXMubmFtZVswXQogICAgICAgICAgICB9CiAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAkUmlnaHRzU2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGluIGJ1aWxkaW5nIEdVSUQgbWFwOiAkXyIKICAgICAgICB9CiAgICB9CgogICAgJEdVSURzCn0KCgpmdW5jdGlvbiBHZXQtTmV0Q29tcHV0ZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gdXRpbGl6ZXMgYWRzaXNlYXJjaGVyIHRvIHF1ZXJ5IHRoZSBjdXJyZW50IEFEIGNvbnRleHQKICAgICAgICBmb3IgY3VycmVudCBjb21wdXRlciBvYmplY3RzLiBCYXNlZCBvZmYgb2YgQ2FybG9zIFBlcmV6J3MgQXVkaXQucHNtMQogICAgICAgIHNjcmlwdCBpbiBQb3NoLVNlY01vZCAobGluayBiZWxvdykuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgUmV0dXJuIGNvbXB1dGVycyB3aXRoIGEgc3BlY2lmaWMgbmFtZSwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgU1BOCgogICAgICAgIFJldHVybiBjb21wdXRlcnMgd2l0aCBhIHNwZWNpZmljIHNlcnZpY2UgcHJpbmNpcGFsIG5hbWUsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIE9wZXJhdGluZ1N5c3RlbQoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBvcGVyYXRpbmcgc3lzdGVtLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBTZXJ2aWNlUGFjawoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBzZXJ2aWNlIHBhY2ssIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgUHJpbnRlcnMKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gb25seSBwcmludGVycy4KCiAgICAuUEFSQU1FVEVSIFBpbmcKCiAgICAgICAgU3dpdGNoLiBQaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBGdWxsRGF0YQoKICAgICAgICBTd2l0Y2guIFJldHVybiBmdWxsIGNvbXB1dGVyIG9iamVjdHMgaW5zdGVhZCBvZiBqdXN0IHN5c3RlbSBuYW1lcyAodGhlIGRlZmF1bHQpLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIGNvbXB1dGVycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCiAgICAKICAgIC5QQVJBTUVURVIgU2l0ZU5hbWUKCiAgICAgICAgVGhlIEFEIFNpdGUgbmFtZSB0byBzZWFyY2ggZm9yIGNvbXB1dGVycy4KCiAgICAuUEFSQU1FVEVSIFVuY29uc3RyYWluZWQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gY29tcHV0ZXIgb2JqZWN0cyB0aGF0IGhhdmUgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3Qgb2YgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzCiAgICAgICAgZm9yIGNvbm5lY3Rpb24gdG8gdGhlIHRhcmdldCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSBjdXJyZW50IGNvbXB1dGVycyBpbiBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRDb21wdXRlciAtU1BOIG1zc3FsKgogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIE1TIFNRTCBzZXJ2ZXJzIG9uIHRoZSBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiB0ZXN0aW5nCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBjb21wdXRlcnMgaW4gJ3Rlc3RpbmcnIGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRDb21wdXRlciAtRG9tYWluIHRlc3RpbmcgLUZ1bGxEYXRhCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBmdWxsIGNvbXB1dGVyIG9iamVjdHMgaW4gdGhlICd0ZXN0aW5nJyBkb21haW4uCgogICAgLkxJTksKCiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2RhcmtvcGVyYXRvci9Qb3NoLVNlY01vZC9ibG9iL21hc3Rlci9BdWRpdC9BdWRpdC5wc20xCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTUE4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE9wZXJhdGluZ1N5c3RlbSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2VydmljZVBhY2ssCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZpbHRlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUHJpbnRlcnMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFBpbmcsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZ1bGxEYXRhLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNpdGVOYW1lLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVbmNvbnN0cmFpbmVkLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgYmVnaW4gewogICAgICAgICMgc28gdGhpcyBpc24ndCByZXBlYXRlZCBpZiBtdWx0aXBsZSBjb21wdXRlciBuYW1lcyBhcmUgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgICAgICRDb21wU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYgKCRDb21wU2VhcmNoZXIpIHsKCiAgICAgICAgICAgICMgaWYgd2UncmUgY2hlY2tpbmcgZm9yIHVuY29uc3RyYWluZWQgZGVsZWdhdGlvbgogICAgICAgICAgICBpZigkVW5jb25zdHJhaW5lZCkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2VhcmNoaW5nIGZvciBjb21wdXRlcnMgd2l0aCBmb3IgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uIgogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKHVzZXJBY2NvdW50Q29udHJvbDoxLjIuODQwLjExMzU1Ni4xLjQuODAzOj01MjQyODgpIgogICAgICAgICAgICB9CiAgICAgICAgICAgICMgc2V0IHRoZSBmaWx0ZXJzIGZvciB0aGUgc2VyYWNoZXIgaWYgaXQgZXhpc3RzCiAgICAgICAgICAgIGlmKCRQcmludGVycykgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2VhcmNoaW5nIGZvciBwcmludGVycyIKICAgICAgICAgICAgICAgICMgJENvbXBTZWFyY2hlci5maWx0ZXI9IigmKG9iamVjdENhdGVnb3J5PXByaW50UXVldWUpJEZpbHRlcikiCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIob2JqZWN0Q2F0ZWdvcnk9cHJpbnRRdWV1ZSkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFNQTikgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2VhcmNoaW5nIGZvciBjb21wdXRlcnMgd2l0aCBTUE46ICRTUE4iCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIoc2VydmljZVByaW5jaXBhbE5hbWU9JFNQTikiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJE9wZXJhdGluZ1N5c3RlbSkgewogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKG9wZXJhdGluZ3N5c3RlbT0kT3BlcmF0aW5nU3lzdGVtKSIKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkU2VydmljZVBhY2spIHsKICAgICAgICAgICAgICAgICRGaWx0ZXIgKz0gIihvcGVyYXRpbmdzeXN0ZW1zZXJ2aWNlcGFjaz0kU2VydmljZVBhY2spIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRTaXRlTmFtZSkgewogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKHNlcnZlcnJlZmVyZW5jZWJsPSRTaXRlTmFtZSkiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRDb21wRmlsdGVyID0gIigmKHNBTUFjY291bnRUeXBlPTgwNTMwNjM2OSkoZG5zaG9zdG5hbWU9JENvbXB1dGVyTmFtZSkkRmlsdGVyKSIKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiR2V0LU5ldENvbXB1dGVyIGZpbHRlciA6ICckQ29tcEZpbHRlciciCiAgICAgICAgICAgICRDb21wU2VhcmNoZXIuZmlsdGVyID0gJENvbXBGaWx0ZXIKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkUmVzdWx0cyA9ICRDb21wU2VhcmNoZXIuRmluZEFsbCgpCiAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBUT0RPOiBob3cgY2FuIHRoZXNlIHJlc3VsdHMgYmUgcGlwZWQgdG8gcGluZyBmb3IgYSBzcGVlZHVwPwogICAgICAgICAgICAgICAgICAgICAgICAkVXAgPSBUZXN0LUNvbm5lY3Rpb24gLUNvdW50IDEgLVF1aWV0IC1Db21wdXRlck5hbWUgJF8ucHJvcGVydGllcy5kbnNob3N0bmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZigkVXApIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyByZXR1cm4gZnVsbCBkYXRhIG9iamVjdHMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udmVydC1MREFQUHJvcGVydHkgLVByb3BlcnRpZXMgJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2Ugd2UncmUganVzdCByZXR1cm5pbmcgdGhlIEROUyBob3N0IG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfLnByb3BlcnRpZXMuZG5zaG9zdG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJENvbXBTZWFyY2hlci5kaXNwb3NlKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvcjogJF8iCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtQURPYmplY3Qgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRha2VzIGEgZG9tYWluIFNJRCBhbmQgcmV0dXJucyB0aGUgdXNlciwgZ3JvdXAsIG9yIGNvbXB1dGVyIG9iamVjdAogICAgICAgIGFzc29jaWF0ZWQgd2l0aCBpdC4KCiAgICAuUEFSQU1FVEVSIFNJRAoKICAgICAgICBUaGUgU0lEIG9mIHRoZSBkb21haW4gb2JqZWN0IHlvdSdyZSBxdWVyeWluZyBmb3IuCgogICAgLlBBUkFNRVRFUiBOYW1lCgogICAgICAgIFRoZSBOYW1lIG9mIHRoZSBkb21haW4gb2JqZWN0IHlvdSdyZSBxdWVyeWluZyBmb3IuCgogICAgLlBBUkFNRVRFUiBTYW1BY2NvdW50TmFtZQoKICAgICAgICBUaGUgU2FtQWNjb3VudE5hbWUgb2YgdGhlIGRvbWFpbiBvYmplY3QgeW91J3JlIHF1ZXJ5aW5nIGZvci4gCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3Igb2JqZWN0cywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQWRkaXRpb25hbCBMREFQIGZpbHRlciBzdHJpbmcgZm9yIHRoZSBxdWVyeS4KCiAgICAuUEFSQU1FVEVSIFJldHVyblJhdwoKICAgICAgICBTd2l0Y2guIFJldHVybiB0aGUgcmF3IG9iamVjdCBpbnN0ZWFkIG9mIHRyYW5zbGF0aW5nIGl0cyBwcm9wZXJ0aWVzLgogICAgICAgIFVzZWQgYnkgU2V0LUFET2JqZWN0IHRvIG1vZGlmeSBvYmplY3QgcHJvcGVydGllcy4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUFET2JqZWN0IC1TSUQgIlMtMS01LTIxLTI2MjA4OTE4MjktMjQxMTI2MTQ5Ny0xNzczODUzMDg4LTExMTAiCiAgICAgICAgCiAgICAgICAgR2V0IHRoZSBkb21haW4gb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIFNJRC4KICAgICAgICAKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUFET2JqZWN0IC1BRFNwYXRoICJDTj1BZG1pblNESG9sZGVyLENOPVN5c3RlbSxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIAogICAgICAgIEdldCB0aGUgQWRtaW5TREhvbGRlciBvYmplY3QgZm9yIHRoZSB0ZXN0bGFiLmxvY2FsIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNJRCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRmlsdGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXR1cm5SYXcsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKICAgIHByb2Nlc3MgewogICAgICAgIGlmKCRTSUQpIHsKICAgICAgICAgICAgIyBpZiBhIFNJRCBpcyBwYXNzZWQsIHRyeSB0byByZXNvbHZlIGl0IHRvIGEgcmVhY2hhYmxlIGRvbWFpbiBuYW1lIGZvciB0aGUgc2VhcmNoZXIKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICROYW1lID0gQ29udmVydC1TaWRUb05hbWUgJFNJRAogICAgICAgICAgICAgICAgaWYoJE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAkQ2Fub25pY2FsID0gQ29udmVydC1BRE5hbWUgLU9iamVjdE5hbWUgJE5hbWUgLUlucHV0VHlwZSBOVDQgLU91dHB1dFR5cGUgQ2Fub25pY2FsCiAgICAgICAgICAgICAgICAgICAgaWYoJENhbm9uaWNhbCkgewogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluID0gJENhbm9uaWNhbC5zcGxpdCgiLyIpWzBdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciByZXNvbHZpbmcgU0lEICckU0lEJyIKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICROdWxsCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIHJlc29sdmluZyBTSUQgJyRTSUQnIDogJF8iCiAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJE9iamVjdFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgIGlmKCRPYmplY3RTZWFyY2hlcikgewogICAgICAgICAgICBpZigkU0lEKSB7CiAgICAgICAgICAgICAgICAkT2JqZWN0U2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdHNpZD0kU0lEKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkTmFtZSkgewogICAgICAgICAgICAgICAgJE9iamVjdFNlYXJjaGVyLmZpbHRlciA9ICIoJihuYW1lPSROYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU2FtQWNjb3VudE5hbWUpIHsKICAgICAgICAgICAgICAgICRPYmplY3RTZWFyY2hlci5maWx0ZXIgPSAiKCYoc2FtQWNjb3VudE5hbWU9JFNhbUFjY291bnROYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICB9CgogICAgICAgICAgICAkUmVzdWx0cyA9ICRPYmplY3RTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgJFJlc3VsdHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgIGlmKCRSZXR1cm5SYXcpIHsKICAgICAgICAgICAgICAgICAgICAkXwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkUmVzdWx0cy5kaXNwb3NlKCkKICAgICAgICAgICAgJE9iamVjdFNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIFNldC1BRE9iamVjdCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGFrZXMgYSBTSUQsIG5hbWUsIG9yIFNhbUFjY291bnROYW1lIHRvIHF1ZXJ5IGZvciBhIHNwZWNpZmllZAogICAgICAgIGRvbWFpbiBvYmplY3QsIGFuZCB0aGVuIHNldHMgYSBzcGVjaWZpZWQgJ1Byb3BlcnR5TmFtZScgdG8gYQogICAgICAgIHNwZWNpZmllZCAnUHJvcGVydHlWYWx1ZScuCgogICAgLlBBUkFNRVRFUiBTSUQKCiAgICAgICAgVGhlIFNJRCBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLgoKICAgIC5QQVJBTUVURVIgTmFtZQoKICAgICAgICBUaGUgTmFtZSBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLgoKICAgIC5QQVJBTUVURVIgU2FtQWNjb3VudE5hbWUKCiAgICAgICAgVGhlIFNhbUFjY291bnROYW1lIG9mIHRoZSBkb21haW4gb2JqZWN0IHlvdSdyZSBxdWVyeWluZyBmb3IuIAoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIG9iamVjdHMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBZGRpdGlvbmFsIExEQVAgZmlsdGVyIHN0cmluZyBmb3IgdGhlIHF1ZXJ5LgoKICAgIC5QQVJBTUVURVIgUHJvcGVydHlOYW1lCgogICAgICAgIFRoZSBwcm9wZXJ0eSBuYW1lIHRvIHNldC4KCiAgICAuUEFSQU1FVEVSIFByb3BlcnR5VmFsdWUKCiAgICAgICAgVGhlIHZhbHVlIHRvIHNldCBmb3IgUHJvcGVydHlOYW1lCgogICAgLlBBUkFNRVRFUiBQcm9wZXJ0eVhvclZhbHVlCgogICAgICAgIEludGVnZXIgdmFsdWUgdG8gYmluYXJ5IHhvciAoLWJ4b3IpIHdpdGggdGhlIGN1cnJlbnQgaW50IHZhbHVlLgoKICAgIC5QQVJBTUVURVIgQ2xlYXJWYWx1ZQoKICAgICAgICBTd2l0Y2guIENsZWFyIHRoZSB2YWx1ZSBvZiBQcm9wZXJ0eU5hbWUKCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gU2V0LUFET2JqZWN0IC1TYW1BY2NvdW50TmFtZSBtYXR0LmFkbWluIC1Qcm9wZXJ0eU5hbWUgY291bnRyeWNvZGUgLVByb3BlcnR5VmFsdWUgMAogICAgICAgIAogICAgICAgIFNldCB0aGUgY291bnRyeWNvZGUgZm9yIG1hdHQuYWRtaW4gdG8gMAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gU2V0LUFET2JqZWN0IC1TYW1BY2NvdW50TmFtZSBtYXR0LmFkbWluIC1Qcm9wZXJ0eU5hbWUgdXNlcmFjY291bnRjb250cm9sIC1Qcm9wZXJ0eVhvclZhbHVlIDY1NTM2CiAgICAgICAgCiAgICAgICAgU2V0IHRoZSBwYXNzd29yZCBub3QgdG8gZXhwaXJlIG9uIG1hdHQuYWRtaW4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNJRCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRmlsdGVyLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQcm9wZXJ0eU5hbWUsCgogICAgICAgICRQcm9wZXJ0eVZhbHVlLAoKICAgICAgICBbSW50XQogICAgICAgICRQcm9wZXJ0eVhvclZhbHVlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRDbGVhclZhbHVlLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgJEFyZ3VtZW50cyA9IEB7CiAgICAgICAgJ1NJRCcgPSAkU0lECiAgICAgICAgJ05hbWUnID0gJE5hbWUKICAgICAgICAnU2FtQWNjb3VudE5hbWUnID0gJFNhbUFjY291bnROYW1lCiAgICAgICAgJ0RvbWFpbicgPSAkRG9tYWluCiAgICAgICAgJ0RvbWFpbkNvbnRyb2xsZXInID0gJERvbWFpbkNvbnRyb2xsZXIKICAgICAgICAnRmlsdGVyJyA9ICRGaWx0ZXIKICAgICAgICAnUGFnZVNpemUnID0gJFBhZ2VTaXplCiAgICAgICAgJ0NyZWRlbnRpYWwnID0gJENyZWRlbnRpYWwKICAgIH0KICAgICMgc3BsYXQgdGhlIGFwcHJvcHJpYXRlIGFyZ3VtZW50cyB0byBHZXQtQURPYmplY3QKICAgICRSYXdPYmplY3QgPSBHZXQtQURPYmplY3QgLVJldHVyblJhdyBAQXJndW1lbnRzCiAgICAKICAgIHRyeSB7CiAgICAgICAgIyBnZXQgdGhlIG1vZGlmaWFibGUgb2JqZWN0IGZvciB0aGlzIHNlYXJjaCByZXN1bHQKICAgICAgICAkRW50cnkgPSAkUmF3T2JqZWN0LkdldERpcmVjdG9yeUVudHJ5KCkKICAgICAgICAKICAgICAgICBpZigkQ2xlYXJWYWx1ZSkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDbGVhcmluZyB2YWx1ZSIKICAgICAgICAgICAgJEVudHJ5LiRQcm9wZXJ0eU5hbWUuY2xlYXIoKQogICAgICAgICAgICAkRW50cnkuY29tbWl0Y2hhbmdlcygpCiAgICAgICAgfQoKICAgICAgICBlbHNlaWYoJFByb3BlcnR5WG9yVmFsdWUpIHsKICAgICAgICAgICAgJFR5cGVOYW1lID0gJEVudHJ5LiRQcm9wZXJ0eU5hbWVbMF0uR2V0VHlwZSgpLm5hbWUKCiAgICAgICAgICAgICMgVUFDIHZhbHVlIHJlZmVyZW5jZXMtIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLXVzL2tiLzMwNTE0NAogICAgICAgICAgICAkUHJvcGVydHlWYWx1ZSA9ICQoJEVudHJ5LiRQcm9wZXJ0eU5hbWUpIC1ieG9yICRQcm9wZXJ0eVhvclZhbHVlIAogICAgICAgICAgICAkRW50cnkuJFByb3BlcnR5TmFtZSA9ICRQcm9wZXJ0eVZhbHVlIC1hcyAkVHlwZU5hbWUgICAgICAgCiAgICAgICAgICAgICRFbnRyeS5jb21taXRjaGFuZ2VzKCkgICAgIAogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRFbnRyeS5wdXQoJFByb3BlcnR5TmFtZSwgJFByb3BlcnR5VmFsdWUpCiAgICAgICAgICAgICRFbnRyeS5zZXRpbmZvKCkKICAgICAgICB9CiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3Igc2V0dGluZyBwcm9wZXJ0eSAkUHJvcGVydHlOYW1lIHRvIHZhbHVlICckUHJvcGVydHlWYWx1ZScgZm9yIG9iamVjdCAkKCRSYXdPYmplY3QuUHJvcGVydGllcy5zYW1hY2NvdW50bmFtZSkgOiAkXyIKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1Eb3duZ3JhZGVBY2NvdW50IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBTZXQgcmV2ZXJzaWJsZSBlbmNyeXB0aW9uIG9uIGEgZ2l2ZW4gYWNjb3VudCBhbmQgdGhlbiBmb3JjZSB0aGUgcGFzc3dvcmQKICAgICAgICB0byBiZSBzZXQgb24gbmV4dCB1c2VyIGxvZ2luLiBUbyByZXBhaXIgdXNlICItUmVwYWlyIi4KCiAgICAuUEFSQU1FVEVSIFNhbUFjY291bnROYW1lCgogICAgICAgIFRoZSBTYW1BY2NvdW50TmFtZSBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLiAKCiAgICAuUEFSQU1FVEVSIE5hbWUKCiAgICAgICAgVGhlIE5hbWUgb2YgdGhlIGRvbWFpbiBvYmplY3QgeW91J3JlIHF1ZXJ5aW5nIGZvci4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBvYmplY3RzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQWRkaXRpb25hbCBMREFQIGZpbHRlciBzdHJpbmcgZm9yIHRoZSBxdWVyeS4KCiAgICAuUEFSQU1FVEVSIFJlcGFpcgoKICAgICAgICBTd2l0Y2guIFVuc2V0IHRoZSByZXZlcnNpYmxlIGVuY3J5cHRpb24gZmxhZyBhbmQgZm9yY2UgcGFzc3dvcmQgcmVzZXQgZmxhZy4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTPiBJbnZva2UtRG93bmdyYWRlQWNjb3VudCAtU2FtQWNjb3VudE5hbWUgamFzb24KCiAgICAgICAgU2V0IHJldmVyc2libGUgZW5jcnlwdGlvbiBvbiB0aGUgJ2phc29uJyBhY2NvdW50IGFuZCBmb3JjZSB0aGUgcGFzc3dvcmQgdG8gYmUgY2hhbmdlZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUz4gSW52b2tlLURvd25ncmFkZUFjY291bnQgLVNhbUFjY291bnROYW1lIGphc29uIC1SZXBhaXIKCiAgICAgICAgVW5zZXQgcmV2ZXJzaWJsZSBlbmNyeXB0aW9uIG9uIHRoZSAnamFzb24nIGFjY291bnQgYW5kIHJlbW92ZSB0aGUgZm9yY2VkIHBhc3N3b3JkIGNoYW5nZS4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdTYW1BY2NvdW50TmFtZScsIFBvc2l0aW9uPTAsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ05hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZpbHRlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVwYWlyLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgICRBcmd1bWVudHMgPSBAewogICAgICAgICAgICAnU2FtQWNjb3VudE5hbWUnID0gJFNhbUFjY291bnROYW1lCiAgICAgICAgICAgICdOYW1lJyA9ICROYW1lCiAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAnRG9tYWluQ29udHJvbGxlcicgPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAnRmlsdGVyJyA9ICRGaWx0ZXIKICAgICAgICAgICAgJ0NyZWRlbnRpYWwnID0gJENyZWRlbnRpYWwKICAgICAgICB9CgogICAgICAgICMgc3BsYXQgdGhlIGFwcHJvcHJpYXRlIGFyZ3VtZW50cyB0byBHZXQtQURPYmplY3QKICAgICAgICAkVUFDVmFsdWVzID0gR2V0LUFET2JqZWN0IEBBcmd1bWVudHMgfCBzZWxlY3QgdXNlcmFjY291bnRjb250cm9sIHwgQ29udmVydEZyb20tVUFDVmFsdWUKCiAgICAgICAgaWYoJFJlcGFpcikgewoKICAgICAgICAgICAgaWYoJFVBQ1ZhbHVlcy5LZXlzIC1jb250YWlucyAiRU5DUllQVEVEX1RFWFRfUFdEX0FMTE9XRUQiKSB7CiAgICAgICAgICAgICAgICAjIGlmIHJldmVyc2libGUgZW5jcnlwdGlvbiBpcyBzZXQsIHVuc2V0IGl0CiAgICAgICAgICAgICAgICBTZXQtQURPYmplY3QgQEFyZ3VtZW50cyAtUHJvcGVydHlOYW1lIHVzZXJhY2NvdW50Y29udHJvbCAtUHJvcGVydHlYb3JWYWx1ZSAxMjgKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyB1bnNldCB0aGUgZm9yY2VkIHBhc3N3b3JkIGNoYW5nZQogICAgICAgICAgICBTZXQtQURPYmplY3QgQEFyZ3VtZW50cyAtUHJvcGVydHlOYW1lIHB3ZGxhc3RzZXQgLVByb3BlcnR5VmFsdWUgLTEKICAgICAgICB9CgogICAgICAgIGVsc2UgewoKICAgICAgICAgICAgaWYoJFVBQ1ZhbHVlcy5LZXlzIC1jb250YWlucyAiRE9OVF9FWFBJUkVfUEFTU1dPUkQiKSB7CiAgICAgICAgICAgICAgICAjIGlmIHRoZSBwYXNzd29yZCBpcyBzZXQgdG8gbmV2ZXIgZXhwaXJlLCB1bnNldAogICAgICAgICAgICAgICAgU2V0LUFET2JqZWN0IEBBcmd1bWVudHMgLVByb3BlcnR5TmFtZSB1c2VyYWNjb3VudGNvbnRyb2wgLVByb3BlcnR5WG9yVmFsdWUgNjU1MzYKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoJFVBQ1ZhbHVlcy5LZXlzIC1ub3Rjb250YWlucyAiRU5DUllQVEVEX1RFWFRfUFdEX0FMTE9XRUQiKSB7CiAgICAgICAgICAgICAgICAjIGlmIHJldmVyc2libGUgZW5jcnlwdGlvbiBpcyBub3Qgc2V0LCBzZXQgaXQKICAgICAgICAgICAgICAgIFNldC1BRE9iamVjdCBAQXJndW1lbnRzIC1Qcm9wZXJ0eU5hbWUgdXNlcmFjY291bnRjb250cm9sIC1Qcm9wZXJ0eVhvclZhbHVlIDEyOAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGZvcmNlIHRoZSBwYXNzd29yZCB0byBiZSBjaGFuZ2VkIG9uIG5leHQgbG9naW4KICAgICAgICAgICAgU2V0LUFET2JqZWN0IEBBcmd1bWVudHMgLVByb3BlcnR5TmFtZSBwd2RsYXN0c2V0IC1Qcm9wZXJ0eVZhbHVlIDAKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtQ29tcHV0ZXJQcm9wZXJ0eSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJucyBhIGxpc3Qgb2YgYWxsIGNvbXB1dGVyIG9iamVjdCBwcm9wZXJ0aWVzLiBJZiBhIHByb3BlcnR5CiAgICAgICAgbmFtZSBpcyBzcGVjaWZpZWQsIGl0IHJldHVybnMgYWxsIFtjb21wdXRlcjpwcm9wZXJ0eV0gdmFsdWVzLgoKICAgICAgICBUYWtlbiBkaXJlY3RseSBmcm9tIEBvYnNjdXJlc2VjJ3MgcG9zdDoKICAgICAgICAgICAgaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxNC8wNC9BRFNJU2VhcmNoZXIuaHRtbAoKICAgIC5QQVJBTUVURVIgUHJvcGVydGllcwoKICAgICAgICBSZXR1cm4gcHJvcGVydHkgbmFtZXMgZm9yIGNvbXB1dGVycy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBjb21wdXRlciBwcm9wZXJ0aWVzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Db21wdXRlclByb3BlcnR5IC1Eb21haW4gdGVzdGluZwogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIHVzZXIgcHJvcGVydGllcyBmb3IgY29tcHV0ZXJzIGluIHRoZSAndGVzdGluZycgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUNvbXB1dGVyUHJvcGVydHkgLVByb3BlcnRpZXMgc3NuLGxhc3Rsb2dvbixsb2NhdGlvbgogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIGFuIGFycmF5IG9mIGNvbXB1dGVyL3Nzbi9sYXN0bG9naW4vbG9jYXRpb24gY29tYmluYXRpb25zCiAgICAgICAgZm9yIGNvbXB1dGVycyBpbiB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxNC8wNC9BRFNJU2VhcmNoZXIuaHRtbAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJFByb3BlcnRpZXMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGlmKCRQcm9wZXJ0aWVzKSB7CiAgICAgICAgIyBleHRyYWN0IG91dCB0aGUgc2V0IG9mIGFsbCBwcm9wZXJ0aWVzIGZvciBlYWNoIG9iamVjdAogICAgICAgICRQcm9wZXJ0aWVzID0gLCJuYW1lIiArICRQcm9wZXJ0aWVzIHwgU29ydC1PYmplY3QgLVVuaXF1ZQogICAgICAgIEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcGVydGllcwogICAgfQogICAgZWxzZSB7CiAgICAgICAgIyBleHRyYWN0IG91dCBqdXN0IHRoZSBwcm9wZXJ0eSBuYW1lcwogICAgICAgIEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBTZWxlY3QtT2JqZWN0IC1maXJzdCAxIHwgR2V0LU1lbWJlciAtTWVtYmVyVHlwZSAqUHJvcGVydHkgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSAiTmFtZSIKICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtQ29tcHV0ZXJGaWVsZCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgU2VhcmNoZXMgY29tcHV0ZXIgb2JqZWN0IGZpZWxkcyBmb3IgYSBnaXZlbiB3b3JkIChkZWZhdWx0ICpwYXNzKikuIERlZmF1bHQKICAgICAgICBmaWVsZCBiZWluZyBzZWFyY2hlZCBpcyAnZGVzY3JpcHRpb24nLgoKICAgICAgICBUYWtlbiBkaXJlY3RseSBmcm9tIEBvYnNjdXJlc2VjJ3MgcG9zdDoKICAgICAgICAgICAgaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxNC8wNC9BRFNJU2VhcmNoZXIuaHRtbAoKICAgIC5QQVJBTUVURVIgU2VhcmNoVGVybQoKICAgICAgICBUZXJtIHRvIHNlYXJjaCBmb3IsIGRlZmF1bHQgb2YgInBhc3MiLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoRmllbGQKCiAgICAgICAgVXNlciBmaWVsZCB0byBzZWFyY2ggaW4sIGRlZmF1bHQgb2YgImRlc2NyaXB0aW9uIi4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBzZWFyY2ggY29tcHV0ZXIgZmllbGRzIGZvciwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3Qgb2YgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzCiAgICAgICAgZm9yIGNvbm5lY3Rpb24gdG8gdGhlIHRhcmdldCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUNvbXB1dGVyRmllbGQgLVNlYXJjaFRlcm0gYmFja3VwIC1TZWFyY2hGaWVsZCBpbmZvCgogICAgICAgIEZpbmQgY29tcHV0ZXIgYWNjb3VudHMgd2l0aCAiYmFja3VwIiBpbiB0aGUgImluZm8iIGZpZWxkLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnVGVybScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlYXJjaFRlcm0gPSAncGFzcycsCgogICAgICAgIFtBbGlhcygnRmllbGQnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZWFyY2hGaWVsZCA9ICdkZXNjcmlwdGlvbicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgIEdldC1OZXRDb21wdXRlciAtQURTcGF0aCAkQURTcGF0aCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1GaWx0ZXIgIigkU2VhcmNoRmllbGQ9KiRTZWFyY2hUZXJtKikiIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBTZWxlY3QtT2JqZWN0IHNhbWFjY291bnRuYW1lLCRTZWFyY2hGaWVsZAogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldE9VIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBHZXRzIGEgbGlzdCBvZiBhbGwgY3VycmVudCBPVXMgaW4gYSBkb21haW4uCgogICAgLlBBUkFNRVRFUiBPVU5hbWUKCiAgICAgICAgVGhlIE9VIG5hbWUgdG8gcXVlcnkgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBHVUlECgogICAgICAgIE9ubHkgcmV0dXJuIE9VcyB3aXRoIHRoZSBzcGVjaWZpZWQgR1VJRCBpbiB0aGVpciBncGxpbmsgcHJvcGVydHkuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgT1VzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgT1Ugb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3Qgb2JqZWN0IG5hbWVzICh0aGUgZGVmYXVsdCkuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRPVQogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgT1VzIGluIHRoZSBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0T1UgLU9VTmFtZSAqYWRtaW4qIC1Eb21haW4gdGVzdGxhYi5sb2NhbAogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIE9VcyB3aXRoICJhZG1pbiIgaW4gdGhlaXIgbmFtZSBpbiB0aGUgdGVzdGxhYi5sb2NhbCBkb21haW4uCgogICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldE9VIC1HVUlEIDEyMy0uLi4KICAgICAgICAKICAgICAgICBSZXR1cm5zIGFsbCBPVXMgd2l0aCBsaW5rZWQgdG8gdGhlIHNwZWNpZmllZCBncm91cCBwb2xpY3kgb2JqZWN0LgoKICAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+ICIqYWRtaW4qIiwiKnNlcnZlcioiIHwgR2V0LU5ldE9VCgogICAgICAgIEdldCB0aGUgZnVsbCBPVSBuYW1lcyBmb3IgdGhlIGdpdmVuIHNlYXJjaCB0ZXJtcyBwaXBlZCBvbiB0aGUgcGlwZWxpbmUuCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRPVU5hbWUgPSAnKicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdVSUQsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRnVsbERhdGEsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgJE9VU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KICAgIHByb2Nlc3MgewogICAgICAgIGlmICgkT1VTZWFyY2hlcikgewogICAgICAgICAgICBpZiAoJEdVSUQpIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgZmlsdGVyaW5nIGZvciBhIEdVSUQgaW4gLmdwbGluawogICAgICAgICAgICAgICAgJE9VU2VhcmNoZXIuZmlsdGVyPSIoJihvYmplY3RDYXRlZ29yeT1vcmdhbml6YXRpb25hbFVuaXQpKG5hbWU9JE9VTmFtZSkoZ3BsaW5rPSokR1VJRCopKSIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRPVVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9b3JnYW5pemF0aW9uYWxVbml0KShuYW1lPSRPVU5hbWUpKSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJE9VU2VhcmNoZXIuRmluZEFsbCgpCiAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmICgkRnVsbERhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgICAgICAgICBDb252ZXJ0LUxEQVBQcm9wZXJ0eSAtUHJvcGVydGllcyAkXy5Qcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgeyAKICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2UganVzdCByZXR1cm5pbmcgdGhlIEFEUyBwYXRocyBvZiB0aGUgT1VzCiAgICAgICAgICAgICAgICAgICAgICAgICRfLnByb3BlcnRpZXMuYWRzcGF0aAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJE9VU2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAkXwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldFNpdGUgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEdldHMgYSBsaXN0IG9mIGFsbCBjdXJyZW50IHNpdGVzIGluIGEgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgU2l0ZU5hbWUKCiAgICAgICAgU2l0ZSBmaWx0ZXIgc3RyaW5nLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3Igc2l0ZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgR1VJRAoKICAgICAgICBPbmx5IHJldHVybiBzaXRlIHdpdGggdGhlIHNwZWNpZmllZCBHVUlEIGluIHRoZWlyIGdwbGluayBwcm9wZXJ0eS4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgc2l0ZSBvYmplY3RzIGluc3RlYWQgb2YganVzdCBvYmplY3QgbmFtZXMgKHRoZSBkZWZhdWx0KS4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFNpdGUgLURvbWFpbiB0ZXN0bGFiLmxvY2FsIC1GdWxsRGF0YQogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGZ1bGwgZGF0YSBvYmplY3RzIGZvciBhbGwgc2l0ZXMgaW4gdGVzdGxhYi5sb2NhbAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2l0ZU5hbWUgPSAiKiIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR1VJRCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRnVsbERhdGEsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYoISREb21haW4pIHsKICAgICAgICAgICAgJERvbWFpbiA9IEdldC1OZXREb21haW4gLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKICAgICAgICB9CgogICAgICAgICRTaXRlU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLUFEU3BhdGggJEFEU3BhdGggLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1BRFNwcmVmaXggIkNOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KICAgIHByb2Nlc3MgewogICAgICAgIGlmKCRTaXRlU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmICgkR1VJRCkgewogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBmaWx0ZXJpbmcgZm9yIGEgR1VJRCBpbiAuZ3BsaW5rCiAgICAgICAgICAgICAgICAkU2l0ZVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9c2l0ZSkobmFtZT0kU2l0ZU5hbWUpKGdwbGluaz0qJEdVSUQqKSkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkU2l0ZVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9c2l0ZSkobmFtZT0kU2l0ZU5hbWUpKSIKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJFNpdGVTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIGp1c3QgcmV0dXJuIHRoZSBzaXRlIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJF8ucHJvcGVydGllcy5uYW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFJlc3VsdHMuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAkU2l0ZVNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgJF8KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRTdWJuZXQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEdldHMgYSBsaXN0IG9mIGFsbCBjdXJyZW50IHN1Ym5ldHMgaW4gYSBkb21haW4uCgogICAgLlBBUkFNRVRFUiBTaXRlTmFtZQoKICAgICAgICBPbmx5IHJldHVybiBzdWJuZXRzIGZyb20gdGhlIHNwZWNpZmllZCBTaXRlTmFtZS4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBzdWJuZXRzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgc3VibmV0IG9iamVjdHMgaW5zdGVhZCBvZiBqdXN0IG9iamVjdCBuYW1lcyAodGhlIGRlZmF1bHQpLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3Qgb2YgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzCiAgICAgICAgZm9yIGNvbm5lY3Rpb24gdG8gdGhlIHRhcmdldCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U3VibmV0CiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgc3VibmV0IG5hbWVzIGluIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRTdWJuZXQgLURvbWFpbiB0ZXN0bGFiLmxvY2FsIC1GdWxsRGF0YQogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGZ1bGwgZGF0YSBvYmplY3RzIGZvciBhbGwgc3VibmV0cyBpbiB0ZXN0bGFiLmxvY2FsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTaXRlTmFtZSA9ICIqIiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZighJERvbWFpbikgewogICAgICAgICAgICAkRG9tYWluID0gR2V0LU5ldERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAogICAgICAgIH0KCiAgICAgICAgJFN1Ym5ldFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtQURTcHJlZml4ICJDTj1TdWJuZXRzLENOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkU3VibmV0U2VhcmNoZXIpIHsKCiAgICAgICAgICAgICRTdWJuZXRTZWFyY2hlci5maWx0ZXI9IigmKG9iamVjdENhdGVnb3J5PXN1Ym5ldCkpIgoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJFN1Ym5ldFNlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAgICAgJFJlc3VsdHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICBpZiAoJEZ1bGxEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgY29udmVydC9wcm9jZXNzIHRoZSBMREFQIGZpZWxkcyBmb3IgZWFjaCByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgQ29udmVydC1MREFQUHJvcGVydHkgLVByb3BlcnRpZXMgJF8uUHJvcGVydGllcyB8IFdoZXJlLU9iamVjdCB7ICRfLnNpdGVvYmplY3QgLW1hdGNoICJDTj0kU2l0ZU5hbWUiIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIGp1c3QgcmV0dXJuIHRoZSBzdWJuZXQgbmFtZSBhbmQgc2l0ZSBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKCRTaXRlTmFtZSAtYW5kICgkXy5wcm9wZXJ0aWVzLnNpdGVvYmplY3QgLW1hdGNoICJDTj0kU2l0ZU5hbWUsIikpIC1vciAoJFNpdGVOYW1lIC1lcSAnKicpKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN1Ym5ldFByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTdWJuZXQnID0gJF8ucHJvcGVydGllcy5uYW1lWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTdWJuZXRQcm9wZXJ0aWVzWydTaXRlJ10gPSAoJF8ucHJvcGVydGllcy5zaXRlb2JqZWN0WzBdKS5zcGxpdCgiLCIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN1Ym5ldFByb3BlcnRpZXNbJ1NpdGUnXSA9ICdFcnJvcicKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgJFN1Ym5ldFByb3BlcnRpZXMgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFJlc3VsdHMuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAkU3VibmV0U2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAkXwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LURvbWFpblNJRCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyB0aGUgU0lEIGZvciB0aGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBDOlw+IEdldC1Eb21haW5TSUQgLURvbWFpbiBURVNUCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBTSUQgZm9yIHRoZSBkb21haW4gJ1RFU1QnCiM+CgogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluCiAgICApCgogICAgJEZvdW5kRG9tYWluID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4KICAgIAogICAgaWYoJEZvdW5kRG9tYWluKSB7CiAgICAgICAgIyBxdWVyeSBmb3IgdGhlIHByaW1hcnkgZG9tYWluIGNvbnRyb2xsZXIgc28gd2UgY2FuIGV4dHJhY3QgdGhlIGRvbWFpbiBTSUQgZm9yIGZpbHRlcmluZwogICAgICAgICRQcmltYXJ5REMgPSAkRm91bmREb21haW4uUGRjUm9sZU93bmVyCiAgICAgICAgJFByaW1hcnlEQ1NJRCA9IChHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Db21wdXRlck5hbWUgJFByaW1hcnlEQyAtRnVsbERhdGEpLm9iamVjdHNpZAogICAgICAgICRQYXJ0cyA9ICRQcmltYXJ5RENTSUQuc3BsaXQoIi0iKQogICAgICAgICRQYXJ0c1swLi4oJFBhcnRzLmxlbmd0aCAtMildIC1qb2luICItIgogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldEdyb3VwIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBHZXRzIGEgbGlzdCBvZiBhbGwgY3VycmVudCBncm91cHMgaW4gYSBkb21haW4sIG9yIGFsbAogICAgICAgIHRoZSBncm91cHMgYSBnaXZlbiB1c2VyL2dyb3VwIG9iamVjdCBiZWxvbmdzIHRvLgoKICAgIC5QQVJBTUVURVIgR3JvdXBOYW1lCgogICAgICAgIFRoZSBncm91cCBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgU0lECgogICAgICAgIFRoZSBncm91cCBTSUQgdG8gcXVlcnkgZm9yLgoKICAgIC5QQVJBTUVURVIgVXNlck5hbWUKCiAgICAgICAgVGhlIHVzZXIgbmFtZSAob3IgZ3JvdXAgbmFtZSkgdG8gcXVlcnkgZm9yIGFsbCBlZmZlY3RpdmUKICAgICAgICBncm91cHMgb2YuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBncm91cHMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgQWRtaW5Db3VudAoKICAgICAgICBTd2l0Y2guIFJldHVybiBncm91cCB3aXRoIGFkbWluQ291bnQ9MS4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgZ3JvdXAgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3Qgb2JqZWN0IG5hbWVzICh0aGUgZGVmYXVsdCkuCgogICAgLlBBUkFNRVRFUiBSYXdTaWRzCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIHJhdyBTSURzIHdoZW4gdXNpbmcgIkdldC1OZXRHcm91cCAtVXNlck5hbWUgWCIKCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEdyb3VwCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBncm91cHMgaW4gdGhlIGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRHcm91cCAtR3JvdXBOYW1lICphZG1pbioKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFsbCBncm91cHMgd2l0aCAiYWRtaW4iIGluIHRoZWlyIGdyb3VwIG5hbWUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0R3JvdXAgLURvbWFpbiB0ZXN0aW5nIC1GdWxsRGF0YQogICAgICAgIAogICAgICAgIFJldHVybnMgZnVsbCBncm91cCBkYXRhIG9iamVjdHMgaW4gdGhlICd0ZXN0aW5nJyBkb21haW4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTSUQsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAogICAgICAgIAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFkbWluQ291bnQsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZ1bGxEYXRhLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSYXdTaWRzLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgYmVnaW4gewogICAgICAgICRHcm91cFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYoJEdyb3VwU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmKCRBZG1pbkNvdW50KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyBmb3IgYWRtaW5Db3VudD0xIgogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKGFkbWluY291bnQ9MSkiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkVXNlck5hbWUpIHsKICAgICAgICAgICAgICAgICMgZ2V0IHRoZSByYXcgdXNlciBvYmplY3QKICAgICAgICAgICAgICAgICRVc2VyID0gR2V0LUFET2JqZWN0IC1TYW1BY2NvdW50TmFtZSAkVXNlck5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1SZXR1cm5SYXcgLVBhZ2VTaXplICRQYWdlU2l6ZQoKICAgICAgICAgICAgICAgICMgY29udmVydCB0aGUgdXNlciB0byBhIGRpcmVjdG9yeSBlbnRyeQogICAgICAgICAgICAgICAgJFVzZXJEaXJlY3RvcnlFbnRyeSA9ICRVc2VyLkdldERpcmVjdG9yeUVudHJ5KCkKCiAgICAgICAgICAgICAgICAjIGNhdXNlIHRoZSBjYWNoZSB0byBjYWxjdWxhdGUgdGhlIHRva2VuIGdyb3VwcyBmb3IgdGhlIHVzZXIKICAgICAgICAgICAgICAgICRVc2VyRGlyZWN0b3J5RW50cnkuUmVmcmVzaENhY2hlKCJ0b2tlbkdyb3VwcyIpCgogICAgICAgICAgICAgICAgJFVzZXJEaXJlY3RvcnlFbnRyeS5Ub2tlbkdyb3VwcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQgdGhlIHRva2VuIGdyb3VwIHNpZAogICAgICAgICAgICAgICAgICAgICRHcm91cFNpZCA9IChOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyKCRfLDApKS5WYWx1ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgaWdub3JlIHRoZSBidWlsdCBpbiB1c2VycyBhbmQgZGVmYXVsdCBkb21haW4gdXNlciBncm91cAogICAgICAgICAgICAgICAgICAgIGlmKCEoJEdyb3VwU2lkIC1tYXRjaCAnXlMtMS01LTMyLTU0NXwtNTEzJCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2V0LUFET2JqZWN0IC1TSUQgJEdyb3VwU2lkIC1QYWdlU2l6ZSAkUGFnZVNpemUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkUmF3U2lkcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cFNpZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udmVydC1TaWRUb05hbWUgJEdyb3VwU2lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoJFNJRCkgewogICAgICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDYXRlZ29yeT1ncm91cCkob2JqZWN0U0lEPSRTSUQpJEZpbHRlcikiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5maWx0ZXIgPSAiKCYob2JqZWN0Q2F0ZWdvcnk9Z3JvdXApKG5hbWU9JEdyb3VwTmFtZSkkRmlsdGVyKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgJFJlc3VsdHMgPSAkR3JvdXBTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSByZXR1cm5pbmcgZnVsbCBkYXRhIG9iamVjdHMKICAgICAgICAgICAgICAgICAgICBpZiAoJEZ1bGxEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgY29udmVydC9wcm9jZXNzIHRoZSBMREFQIGZpZWxkcyBmb3IgZWFjaCByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgQ29udmVydC1MREFQUHJvcGVydHkgLVByb3BlcnRpZXMgJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2Ugd2UncmUganVzdCByZXR1cm5pbmcgdGhlIGdyb3VwIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJF8ucHJvcGVydGllcy5zYW1hY2NvdW50bmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0R3JvdXBNZW1iZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gdXNlcnMgW0FEU0ldIGFuZCBMREFQIHRvIHF1ZXJ5IHRoZSBjdXJyZW50IEFEIGNvbnRleHQKICAgICAgICBvciB0cnVzdGVkIGRvbWFpbiBmb3IgdXNlcnMgaW4gYSBzcGVjaWZpZWQgZ3JvdXAuIElmIG5vIEdyb3VwTmFtZSBpcwogICAgICAgIHNwZWNpZmllZCwgaXQgZGVmYXVsdHMgdG8gcXVlcnlpbmcgdGhlICJEb21haW4gQWRtaW5zIiBncm91cC4KICAgICAgICBUaGlzIGlzIGEgcmVwbGFjZW1lbnQgZm9yICJuZXQgZ3JvdXAgJ25hbWUnIC9kb21haW4iCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgVGhlIGdyb3VwIG5hbWUgdG8gcXVlcnkgZm9yIHVzZXJzLgoKICAgIC5QQVJBTUVURVIgU0lECgogICAgICAgIFRoZSBHcm91cCBTSUQgdG8gcXVlcnkgZm9yIHVzZXJzLiBJZiBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvIDUxMiAiRG9tYWluIEFkbWlucyIKCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIGdyb3VwIHVzZXJzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJucyBmdWxsIGRhdGEgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3QgZ3JvdXAvdXNlcnMuCgogICAgLlBBUkFNRVRFUiBSZWN1cnNlCgogICAgICAgIFN3aXRjaC4gSWYgdGhlIGdyb3VwIG1lbWJlciBpcyBhIGdyb3VwLCByZWN1cnNpdmVseSB0cnkgdG8gcXVlcnkgaXRzIG1lbWJlcnMgYXMgd2VsbC4KCiAgICAuUEFSQU1FVEVSIFVzZU1hdGNoaW5nUnVsZQoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQX01BVENISU5HX1JVTEVfSU5fQ0hBSU4gaW4gdGhlIExEQVAgc2VhcmNoIHF1ZXJ5IHdoZW4gLVJlY3Vyc2UgaXMgc3BlY2lmaWVkLgogICAgICAgIE11Y2ggZmFzdGVyIHRoYW4gbWFudWFsIHJlY3Vyc2lvbiwgYnV0IGRvZXNuJ3QgcmV2ZWFsIGNyb3NzLWRvbWFpbiBncm91cHMuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRHcm91cE1lbWJlcgogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIHVzZXJuYW1lcyB0aGF0IG9mIG1lbWJlcnMgb2YgdGhlICJEb21haW4gQWRtaW5zIiBkb21haW4gZ3JvdXAuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0R3JvdXBNZW1iZXIgLURvbWFpbiB0ZXN0aW5nIC1Hcm91cE5hbWUgIlBvd2VyIFVzZXJzIgogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIHVzZXJuYW1lcyB0aGF0IG9mIG1lbWJlcnMgb2YgdGhlICJQb3dlciBVc2VycyIgZ3JvdXAgaW4gdGhlICd0ZXN0aW5nJyBkb21haW4uCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL3d3dy5wb3dlcnNoZWxsbWFnYXppbmUuY29tLzIwMTMvMDUvMjMvcHN0aXAtcmV0cmlldmUtZ3JvdXAtbWVtYmVyc2hpcC1vZi1hbi1hY3RpdmUtZGlyZWN0b3J5LWdyb3VwLXJlY3Vyc2l2ZWx5LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNJRCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlTWF0Y2hpbmdSdWxlLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgYmVnaW4gewogICAgICAgICMgc28gdGhpcyBpc24ndCByZXBlYXRlZCBpZiB1c2VycyBhcmUgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgICAgICRHcm91cFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgIGlmKCEkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciA9ICgoR2V0LU5ldERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCkuUGRjUm9sZU93bmVyKS5OYW1lCiAgICAgICAgfQoKICAgICAgICBpZighJERvbWFpbikgewogICAgICAgICAgICAkRG9tYWluID0gR2V0LU5ldERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAogICAgICAgIH0KICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYgKCRHcm91cFNlYXJjaGVyKSB7CgogICAgICAgICAgICBpZiAoJFJlY3Vyc2UgLWFuZCAkVXNlTWF0Y2hpbmdSdWxlKSB7CiAgICAgICAgICAgICAgICAjIHJlc29sdmUgdGhlIGdyb3VwIHRvIGEgZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgICAgIGlmICgkR3JvdXBOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgJEdyb3VwID0gR2V0LU5ldEdyb3VwIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJFNJRCkgewogICAgICAgICAgICAgICAgICAgICRHcm91cCA9IEdldC1OZXRHcm91cCAtU0lEICRTSUQgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAjIGRlZmF1bHQgdG8gZG9tYWluIGFkbWlucwogICAgICAgICAgICAgICAgICAgICRTSUQgPSAoR2V0LURvbWFpblNJRCAtRG9tYWluICREb21haW4gLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwpICsgIi01MTIiCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwID0gR2V0LU5ldEdyb3VwIC1TSUQgJFNJRCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRHcm91cEROID0gJEdyb3VwLmRpc3Rpbmd1aXNoZWRuYW1lCiAgICAgICAgICAgICAgICAkR3JvdXBGb3VuZE5hbWUgPSAkR3JvdXAubmFtZQoKICAgICAgICAgICAgICAgIGlmICgkR3JvdXBETikgewogICAgICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmZpbHRlciA9ICIoJihzYW1BY2NvdW50VHlwZT04MDUzMDYzNjgpKG1lbWJlcm9mOjEuMi44NDAuMTEzNTU2LjEuNC4xOTQxOj0kR3JvdXBETikkRmlsdGVyKSIKICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5Qcm9wZXJ0aWVzVG9Mb2FkLkFkZFJhbmdlKCgnZGlzdGluZ3Vpc2hlZE5hbWUnLCdzYW1hY2NvdW50dHlwZScsJ2xhc3Rsb2dvbicsJ2xhc3Rsb2dvbnRpbWVzdGFtcCcsJ2RzY29yZXByb3BhZ2F0aW9uZGF0YScsJ29iamVjdHNpZCcsJ3doZW5jcmVhdGVkJywnYmFkcGFzc3dvcmR0aW1lJywnYWNjb3VudGV4cGlyZXMnLCdpc2NyaXRpY2Fsc3lzdGVtb2JqZWN0JywnbmFtZScsJ3VzbmNoYW5nZWQnLCdvYmplY3RjYXRlZ29yeScsJ2Rlc2NyaXB0aW9uJywnY29kZXBhZ2UnLCdpbnN0YW5jZXR5cGUnLCdjb3VudHJ5Y29kZScsJ2Rpc3Rpbmd1aXNoZWRuYW1lJywnY24nLCdhZG1pbmNvdW50JywnbG9nb25ob3VycycsJ29iamVjdGNsYXNzJywnbG9nb25jb3VudCcsJ3VzbmNyZWF0ZWQnLCd1c2VyYWNjb3VudGNvbnRyb2wnLCdvYmplY3RndWlkJywncHJpbWFyeWdyb3VwaWQnLCdsYXN0bG9nb2ZmJywnc2FtYWNjb3VudG5hbWUnLCdiYWRwd2Rjb3VudCcsJ3doZW5jaGFuZ2VkJywnbWVtYmVyb2YnLCdwd2RsYXN0c2V0JywnYWRzcGF0aCcpKQoKICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9ICRHcm91cFNlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAgICAgICAgICRHcm91cEZvdW5kTmFtZSA9ICRHcm91cE5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJVbmFibGUgdG8gZmluZCBHcm91cCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICgkR3JvdXBOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdENhdGVnb3J5PWdyb3VwKShuYW1lPSRHcm91cE5hbWUpJEZpbHRlcikiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCRTSUQpIHsKICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5maWx0ZXIgPSAiKCYob2JqZWN0Q2F0ZWdvcnk9Z3JvdXApKG9iamVjdFNJRD0kU0lEKSRGaWx0ZXIpIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgIyBkZWZhdWx0IHRvIGRvbWFpbiBhZG1pbnMKICAgICAgICAgICAgICAgICAgICAkU0lEID0gKEdldC1Eb21haW5TSUQgLURvbWFpbiAkRG9tYWluIC1DcmVkZW50aWFsICRDcmVkZW50aWFsKSArICItNTEyIgogICAgICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDYXRlZ29yeT1ncm91cCkob2JqZWN0U0lEPSRTSUQpJEZpbHRlcikiCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJFJlc3VsdHMgPSAkR3JvdXBTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCRfKSAtb3IgISgkXy5wcm9wZXJ0aWVzKSAtb3IgISgkXy5wcm9wZXJ0aWVzLm5hbWUpKSB7IGNvbnRpbnVlIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cEZvdW5kTmFtZSA9ICRfLnByb3BlcnRpZXMubmFtZVswXQogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9IEAoKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfLnByb3BlcnRpZXMubWVtYmVyLkNvdW50IC1lcSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRmluaXNoZWQgPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRCb3R0b20gPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVG9wID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoISRGaW5pc2hlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRUb3AgPSAkQm90dG9tICsgMTQ5OQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJSYW5nZT0ibWVtYmVyO3JhbmdlPSRCb3R0b20tJFRvcCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQm90dG9tICs9IDE1MDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5Qcm9wZXJ0aWVzVG9Mb2FkLkNsZWFyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdm9pZF0kR3JvdXBTZWFyY2hlci5Qcm9wZXJ0aWVzVG9Mb2FkLkFkZCgiJE1lbWJlclJhbmdlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0ID0gJEdyb3VwU2VhcmNoZXIuRmluZE9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkUmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUmFuZ2VkUHJvcGVydHkgPSAkXy5Qcm9wZXJ0aWVzLlByb3BlcnR5TmFtZXMgLWxpa2UgIm1lbWJlcjtyYW5nZT0qIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdHMgPSAkXy5Qcm9wZXJ0aWVzLml0ZW0oJFJhbmdlZFByb3BlcnR5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRSZXN1bHRzLmNvdW50IC1lcSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZpbmlzaGVkID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyArPSAkXwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGaW5pc2hlZCA9ICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLk1ldGhvZEludm9jYXRpb25FeGNlcHRpb25dIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZpbmlzaGVkID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgPSAkXy5wcm9wZXJ0aWVzLm1lbWJlcgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJF8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkUmVzdWx0cy5kaXNwb3NlKCkKICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkTWVtYmVycyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBkb2luZyB0aGUgTERBUF9NQVRDSElOR19SVUxFX0lOX0NIQUlOIHJlY3Vyc2lvbgogICAgICAgICAgICAgICAgaWYgKCRSZWN1cnNlIC1hbmQgJFVzZU1hdGNoaW5nUnVsZSkgewogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0aWVzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHQgPSBbYWRzaV0iTERBUDovLyREb21haW5Db250cm9sbGVyLyRfIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9IFthZHNpXSJMREFQOi8vJF8iCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCRSZXN1bHQpewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvcGVydGllcyA9ICRSZXN1bHQuUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkUHJvcGVydGllcykgewoKICAgICAgICAgICAgICAgICAgICAkSXNHcm91cCA9IEAoJzI2ODQzNTQ1NicsJzI2ODQzNTQ1NycsJzUzNjg3MDkxMicsJzUzNjg3MDkxMycpIC1jb250YWlucyAkUHJvcGVydGllcy5zYW1hY2NvdW50dHlwZQoKICAgICAgICAgICAgICAgICAgICBpZiAoJEZ1bGxEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciA9IENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRQcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBEb21haW4nICREb21haW4KICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBOYW1lJyAkR3JvdXBGb3VuZE5hbWUKCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckROID0gJFByb3BlcnRpZXMuZGlzdGluZ3Vpc2hlZG5hbWVbMF0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICMgZXh0cmFjdCB0aGUgRlFETiBmcm9tIHRoZSBEaXN0aW5ndWlzaGVkIE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckRvbWFpbiA9ICRNZW1iZXJETi5zdWJTdHJpbmcoJE1lbWJlckROLkluZGV4T2YoIkRDPSIpKSAtcmVwbGFjZSAnREM9JywnJyAtcmVwbGFjZSAnLCcsJy4nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckROID0gJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckRvbWFpbiA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoJFByb3BlcnRpZXMuc2FtYWNjb3VudG5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBmb3Jlc3QgdXNlcnMgaGF2ZSB0aGUgc2FtQWNjb3VudE5hbWUgc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gJFByb3BlcnRpZXMuc2FtYWNjb3VudG5hbWVbMF0KICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAjIGV4dGVybmFsIHRydXN0IHVzZXJzIGhhdmUgYSBTSUQsIHNvIGNvbnZlcnQgaXQKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gQ29udmVydC1TaWRUb05hbWUgJFByb3BlcnRpZXMuY25bMF0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZXJlJ3MgYSBwcm9ibGVtIGNvbnRhY3RpbmcgdGhlIGRvbWFpbiB0byByZXNvbHZlIHRoZSBTSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gJFByb3BlcnRpZXMuY24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZigkUHJvcGVydGllcy5vYmplY3RTaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlclNpZCA9ICgoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllciAkUHJvcGVydGllcy5vYmplY3RTaWRbMF0sMCkuVmFsdWUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyU2lkID0gJE51bGwKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICRNZW1iZXJEb21haW4KICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyTmFtZScgJE1lbWJlck5hbWUKICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyU2lkJyAkTWVtYmVyU2lkCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lzR3JvdXAnICRJc0dyb3VwCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlckROJyAkTWVtYmVyRE4KICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIKCiAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBkb2luZyBtYW51YWwgcmVjdXJzaW9uCiAgICAgICAgICAgICAgICAgICAgaWYgKCRSZWN1cnNlIC1hbmQgISRVc2VNYXRjaGluZ1J1bGUgLWFuZCAkSXNHcm91cCAtYW5kICRNZW1iZXJOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2V0LU5ldEdyb3VwTWVtYmVyIC1GdWxsRGF0YSAtRG9tYWluICRNZW1iZXJEb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUdyb3VwTmFtZSAkTWVtYmVyTmFtZSAtUmVjdXJzZSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHZXQtTmV0R3JvdXBNZW1iZXIgLURvbWFpbiAkTWVtYmVyRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1Hcm91cE5hbWUgJE1lbWJlck5hbWUgLVJlY3Vyc2UgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRGaWxlU2VydmVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgZmlsZSBzZXJ2ZXJzIGV4dHJhY3RlZCBmcm9tIHVzZXIgCiAgICAgICAgaG9tZWRpcmVjdG9yeSwgc2NyaXB0cGF0aCwgYW5kIHByb2ZpbGVwYXRoIGZpZWxkcy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VyIGZpbGUgc2VydmVycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0VXNlcnMKCiAgICAgICAgQW4gYXJyYXkgb2YgdXNlcnMgdG8gcXVlcnkgZm9yIGZpbGUgc2VydmVycy4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZpbGVTZXJ2ZXIKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBmaWxlIHNlcnZlcnMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RmlsZVNlcnZlciAtRG9tYWluIHRlc3RpbmcKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBmaWxlIHNlcnZlcnMgZm9yIHRoZSAndGVzdGluZycgZG9tYWluLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkVGFyZ2V0VXNlcnMsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBmdW5jdGlvbiBTcGxpdFBhdGggewogICAgICAgICMgc2hvcnQgaW50ZXJuYWwgaGVscGVyIHRvIHNwbGl0IFVOQyBzZXJ2ZXIgcGF0aHMKICAgICAgICBwYXJhbShbU3RyaW5nXSRQYXRoKQoKICAgICAgICBpZiAoJFBhdGggLWFuZCAoJFBhdGguc3BsaXQoIlxcIikuQ291bnQgLWdlIDMpKSB7CiAgICAgICAgICAgICRUZW1wID0gJFBhdGguc3BsaXQoIlxcIilbMl0KICAgICAgICAgICAgaWYoJFRlbXAgLWFuZCAoJFRlbXAgLW5lICcnKSkgewogICAgICAgICAgICAgICAgJFRlbXAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7JF99IHwgV2hlcmUtT2JqZWN0IHsKICAgICAgICAgICAgIyBmaWx0ZXIgZm9yIGFueSB0YXJnZXQgdXNlcnMKICAgICAgICAgICAgaWYoJFRhcmdldFVzZXJzKSB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgLU1hdGNoICRfLnNhbUFjY291bnROYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7ICRUcnVlIH0gCiAgICAgICAgfSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgIyBzcGxpdCBvdXQgZXZlcnkgcG90ZW50aWFsIGZpbGUgc2VydmVyIHBhdGgKICAgICAgICAgICAgaWYoJF8uaG9tZWRpcmVjdG9yeSkgewogICAgICAgICAgICAgICAgU3BsaXRQYXRoKCRfLmhvbWVkaXJlY3RvcnkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJF8uc2NyaXB0cGF0aCkgewogICAgICAgICAgICAgICAgU3BsaXRQYXRoKCRfLnNjcmlwdHBhdGgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJF8ucHJvZmlsZXBhdGgpIHsKICAgICAgICAgICAgICAgIFNwbGl0UGF0aCgkXy5wcm9maWxlcGF0aCkKICAgICAgICAgICAgfQoKICAgICAgICB9IHwgV2hlcmUtT2JqZWN0IHskX30gfCBTb3J0LU9iamVjdCAtVW5pcXVlCn0KCgpmdW5jdGlvbiBHZXQtREZTc2hhcmUgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybnMgYSBsaXN0IG9mIGFsbCBmYXVsdC10b2xlcmFudCBkaXN0cmlidXRlZCBmaWxlCiAgICAgICAgc3lzdGVtcyBmb3IgYSBnaXZlbiBkb21haW4uCgogICAgLlBBUkFNRVRFUiBWZXJzaW9uCgogICAgICAgIFRoZSB2ZXJzaW9uIG9mIERGUyB0byBxdWVyeSBmb3Igc2VydmVycy4KICAgICAgICAxL3YxLCAyL3YyLCBvciBhbGwKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VyIERGUyBzaGFyZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3Qgb2YgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzCiAgICAgICAgZm9yIGNvbm5lY3Rpb24gdG8gdGhlIHRhcmdldCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtREZTc2hhcmUKCiAgICAgICAgUmV0dXJucyBhbGwgZGlzdHJpYnV0ZWQgZmlsZSBzeXN0ZW0gc2hhcmVzIGZvciB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtREZTc2hhcmUgLURvbWFpbiB0ZXN0CgogICAgICAgIFJldHVybnMgYWxsIGRpc3RyaWJ1dGVkIGZpbGUgc3lzdGVtIHNoYXJlcyBmb3IgdGhlICd0ZXN0JyBkb21haW4uCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJBbGwiLCJWMSIsIjEiLCJWMiIsIjIiKV0KICAgICAgICAkVmVyc2lvbiA9ICJBbGwiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBmdW5jdGlvbiBQYXJzZS1Qa3QgewogICAgICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICAgICAgcGFyYW0oCiAgICAgICAgICAgIFtieXRlW11dCiAgICAgICAgICAgICRQa3QKICAgICAgICApCgogICAgICAgICRiaW4gPSAkUGt0CiAgICAgICAgJGJsb2JfdmVyc2lvbiA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmluWzAuLjNdLDApCiAgICAgICAgJGJsb2JfZWxlbWVudF9jb3VudCA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmluWzQuLjddLDApCiAgICAgICAgI1dyaXRlLUhvc3QgIkVsZW1lbnQgQ291bnQ6ICIgJGJsb2JfZWxlbWVudF9jb3VudAogICAgICAgICRvZmZzZXQgPSA4CiAgICAgICAgI2h0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvY2MyMjcxNDcuYXNweAogICAgICAgICRvYmplY3RfbGlzdCA9IEAoKQogICAgICAgIGZvcigkaT0xOyAkaSAtbGUgJGJsb2JfZWxlbWVudF9jb3VudDsgJGkrKyl7CiAgICAgICAgICAgICAgICRibG9iX25hbWVfc2l6ZV9zdGFydCA9ICRvZmZzZXQKICAgICAgICAgICAgICAgJGJsb2JfbmFtZV9zaXplX2VuZCA9ICRvZmZzZXQgKyAxCiAgICAgICAgICAgICAgICRibG9iX25hbWVfc2l6ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQxNigkYmluWyRibG9iX25hbWVfc2l6ZV9zdGFydC4uJGJsb2JfbmFtZV9zaXplX2VuZF0sMCkKICAgICAgICAgICAgICAgI1dyaXRlLUhvc3QgIkJsb2IgbmFtZSBzaXplOiAiICRibG9iX25hbWVfc2l6ZQogICAgICAgICAgICAgICAkYmxvYl9uYW1lX3N0YXJ0ID0gJGJsb2JfbmFtZV9zaXplX2VuZCArIDEKICAgICAgICAgICAgICAgJGJsb2JfbmFtZV9lbmQgPSAkYmxvYl9uYW1lX3N0YXJ0ICsgJGJsb2JfbmFtZV9zaXplIC0gMQogICAgICAgICAgICAgICAkYmxvYl9uYW1lID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoJGJpblskYmxvYl9uYW1lX3N0YXJ0Li4kYmxvYl9uYW1lX2VuZF0pCiAgICAgICAgICAgICAgICNXcml0ZS1Ib3N0ICAiQmxvYiBOYW1lOiAiICRibG9iX25hbWUKICAgICAgICAgICAgICAgJGJsb2JfZGF0YV9zaXplX3N0YXJ0ID0gJGJsb2JfbmFtZV9lbmQgKyAxCiAgICAgICAgICAgICAgICRibG9iX2RhdGFfc2l6ZV9lbmQgPSAkYmxvYl9kYXRhX3NpemVfc3RhcnQgKyAzCiAgICAgICAgICAgICAgICRibG9iX2RhdGFfc2l6ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmluWyRibG9iX2RhdGFfc2l6ZV9zdGFydC4uJGJsb2JfZGF0YV9zaXplX2VuZF0sMCkKICAgICAgICAgICAgICAgI1dyaXRlLUhvc3QgICJibG9iIGRhdGEgc2l6ZTogIiAkYmxvYl9kYXRhX3NpemUKICAgICAgICAgICAgICAgJGJsb2JfZGF0YV9zdGFydCA9ICRibG9iX2RhdGFfc2l6ZV9lbmQgKyAxCiAgICAgICAgICAgICAgICRibG9iX2RhdGFfZW5kID0gJGJsb2JfZGF0YV9zdGFydCArICRibG9iX2RhdGFfc2l6ZSAtIDEKICAgICAgICAgICAgICAgJGJsb2JfZGF0YSA9ICRiaW5bJGJsb2JfZGF0YV9zdGFydC4uJGJsb2JfZGF0YV9lbmRdCiAgICAgICAgICAgICAgIHN3aXRjaCAtd2lsZGNhcmQgKCRibG9iX25hbWUpIHsKICAgICAgICAgICAgICAgICJcc2l0ZXJvb3QiIHsgIH0KICAgICAgICAgICAgICAgICJcZG9tYWlucm9vdCoiIHsKICAgICAgICAgICAgICAgICAgICAjIFBhcnNlIERGU05hbWVzcGFjZVJvb3RPckxpbmtCbG9iIG9iamVjdC4gU3RhcnRzIHdpdGggdmFyaWFibGUgbGVuZ3RoIERGU1Jvb3RPckxpbmtJREJsb2Igd2hpY2ggd2UgcGFyc2UgZmlyc3QuLi4KICAgICAgICAgICAgICAgICAgICAjIERGU1Jvb3RPckxpbmtJREJsb2IKICAgICAgICAgICAgICAgICAgICAkcm9vdF9vcl9saW5rX2d1aWRfc3RhcnQgPSAwCiAgICAgICAgICAgICAgICAgICAgJHJvb3Rfb3JfbGlua19ndWlkX2VuZCA9IDE1CiAgICAgICAgICAgICAgICAgICAgJHJvb3Rfb3JfbGlua19ndWlkID0gW2J5dGVbXV0kYmxvYl9kYXRhWyRyb290X29yX2xpbmtfZ3VpZF9zdGFydC4uJHJvb3Rfb3JfbGlua19ndWlkX2VuZF0KICAgICAgICAgICAgICAgICAgICAkZ3VpZCA9IE5ldy1PYmplY3QgR3VpZCgsJHJvb3Rfb3JfbGlua19ndWlkKSAjIHNob3VsZCBtYXRjaCAkZ3VpZF9zdHIKICAgICAgICAgICAgICAgICAgICAkcHJlZml4X3NpemVfc3RhcnQgPSAkcm9vdF9vcl9saW5rX2d1aWRfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfc2l6ZV9lbmQgPSAkcHJlZml4X3NpemVfc3RhcnQgKyAxCiAgICAgICAgICAgICAgICAgICAgJHByZWZpeF9zaXplID0gW2JpdGNvbnZlcnRlcl06OlRvVUludDE2KCRibG9iX2RhdGFbJHByZWZpeF9zaXplX3N0YXJ0Li4kcHJlZml4X3NpemVfZW5kXSwwKQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfc3RhcnQgPSAkcHJlZml4X3NpemVfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfZW5kID0gJHByZWZpeF9zdGFydCArICRwcmVmaXhfc2l6ZSAtIDEKICAgICAgICAgICAgICAgICAgICAkcHJlZml4ID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoJGJsb2JfZGF0YVskcHJlZml4X3N0YXJ0Li4kcHJlZml4X2VuZF0pCiAgICAgICAgICAgICAgICAgICAgI3dyaXRlLWhvc3QgIlByZWZpeDogIiAkcHJlZml4CiAgICAgICAgICAgICAgICAgICAgJHNob3J0X3ByZWZpeF9zaXplX3N0YXJ0ID0gJHByZWZpeF9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJHNob3J0X3ByZWZpeF9zaXplX2VuZCA9ICRzaG9ydF9wcmVmaXhfc2l6ZV9zdGFydCArIDEKICAgICAgICAgICAgICAgICAgICAkc2hvcnRfcHJlZml4X3NpemUgPSBbYml0Y29udmVydGVyXTo6VG9VSW50MTYoJGJsb2JfZGF0YVskc2hvcnRfcHJlZml4X3NpemVfc3RhcnQuLiRzaG9ydF9wcmVmaXhfc2l6ZV9lbmRdLDApCiAgICAgICAgICAgICAgICAgICAgJHNob3J0X3ByZWZpeF9zdGFydCA9ICRzaG9ydF9wcmVmaXhfc2l6ZV9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJHNob3J0X3ByZWZpeF9lbmQgPSAkc2hvcnRfcHJlZml4X3N0YXJ0ICsgJHNob3J0X3ByZWZpeF9zaXplIC0gMQogICAgICAgICAgICAgICAgICAgICRzaG9ydF9wcmVmaXggPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVbmljb2RlLkdldFN0cmluZygkYmxvYl9kYXRhWyRzaG9ydF9wcmVmaXhfc3RhcnQuLiRzaG9ydF9wcmVmaXhfZW5kXSkKICAgICAgICAgICAgICAgICAgICAjd3JpdGUtaG9zdCAiU2hvcnQgUHJlZml4OiAiICRzaG9ydF9wcmVmaXgKICAgICAgICAgICAgICAgICAgICAkdHlwZV9zdGFydCA9ICRzaG9ydF9wcmVmaXhfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICR0eXBlX2VuZCA9ICR0eXBlX3N0YXJ0ICsgMwogICAgICAgICAgICAgICAgICAgICR0eXBlID0gW2JpdGNvbnZlcnRlcl06OlRvVUludDMyKCRibG9iX2RhdGFbJHR5cGVfc3RhcnQuLiR0eXBlX2VuZF0sMCkKICAgICAgICAgICAgICAgICAgICAjd3JpdGUtaG9zdCAkdHlwZQogICAgICAgICAgICAgICAgICAgICRzdGF0ZV9zdGFydCA9ICR0eXBlX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAkc3RhdGVfZW5kID0gJHN0YXRlX3N0YXJ0ICsgMwogICAgICAgICAgICAgICAgICAgICRzdGF0ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmxvYl9kYXRhWyRzdGF0ZV9zdGFydC4uJHN0YXRlX2VuZF0sMCkKICAgICAgICAgICAgICAgICAgICAjd3JpdGUtaG9zdCAkc3RhdGUKICAgICAgICAgICAgICAgICAgICAkY29tbWVudF9zaXplX3N0YXJ0ID0gJHN0YXRlX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAkY29tbWVudF9zaXplX2VuZCA9ICRjb21tZW50X3NpemVfc3RhcnQgKyAxCiAgICAgICAgICAgICAgICAgICAgJGNvbW1lbnRfc2l6ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQxNigkYmxvYl9kYXRhWyRjb21tZW50X3NpemVfc3RhcnQuLiRjb21tZW50X3NpemVfZW5kXSwwKQogICAgICAgICAgICAgICAgICAgICRjb21tZW50X3N0YXJ0ID0gJGNvbW1lbnRfc2l6ZV9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJGNvbW1lbnRfZW5kID0gJGNvbW1lbnRfc3RhcnQgKyAkY29tbWVudF9zaXplIC0gMQogICAgICAgICAgICAgICAgICAgIGlmICgkY29tbWVudF9zaXplIC1ndCAwKSAgewogICAgICAgICAgICAgICAgICAgICAgICAkY29tbWVudCA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKCRibG9iX2RhdGFbJGNvbW1lbnRfc3RhcnQuLiRjb21tZW50X2VuZF0pCiAgICAgICAgICAgICAgICAgICAgICAgICNXcml0ZS1Ib3N0ICRjb21tZW50IAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcHJlZml4X3RpbWVzdGFtcF9zdGFydCA9ICRjb21tZW50X2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAkcHJlZml4X3RpbWVzdGFtcF9lbmQgPSAkcHJlZml4X3RpbWVzdGFtcF9zdGFydCArIDcKICAgICAgICAgICAgICAgICAgICAjIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvY2MyMzAzMjQuYXNweCBGSUxFVElNRQogICAgICAgICAgICAgICAgICAgICRwcmVmaXhfdGltZXN0YW1wID0gJGJsb2JfZGF0YVskcHJlZml4X3RpbWVzdGFtcF9zdGFydC4uJHByZWZpeF90aW1lc3RhbXBfZW5kXSAjZHdvcmQgbG93RGF0ZVRpbWUgI2R3b3JkIGhpZ2hkYXRldGltZQogICAgICAgICAgICAgICAgICAgICRzdGF0ZV90aW1lc3RhbXBfc3RhcnQgPSAkcHJlZml4X3RpbWVzdGFtcF9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJHN0YXRlX3RpbWVzdGFtcF9lbmQgPSAkc3RhdGVfdGltZXN0YW1wX3N0YXJ0ICsgNwogICAgICAgICAgICAgICAgICAgICRzdGF0ZV90aW1lc3RhbXAgPSAkYmxvYl9kYXRhWyRzdGF0ZV90aW1lc3RhbXBfc3RhcnQuLiRzdGF0ZV90aW1lc3RhbXBfZW5kXQogICAgICAgICAgICAgICAgICAgICRjb21tZW50X3RpbWVzdGFtcF9zdGFydCA9ICRzdGF0ZV90aW1lc3RhbXBfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICRjb21tZW50X3RpbWVzdGFtcF9lbmQgPSAkY29tbWVudF90aW1lc3RhbXBfc3RhcnQgKyA3CiAgICAgICAgICAgICAgICAgICAgJGNvbW1lbnRfdGltZXN0YW1wID0gJGJsb2JfZGF0YVskY29tbWVudF90aW1lc3RhbXBfc3RhcnQuLiRjb21tZW50X3RpbWVzdGFtcF9lbmRdCiAgICAgICAgICAgICAgICAgICAgJHZlcnNpb25fc3RhcnQgPSAkY29tbWVudF90aW1lc3RhbXBfZW5kICArIDEKICAgICAgICAgICAgICAgICAgICAkdmVyc2lvbl9lbmQgPSAkdmVyc2lvbl9zdGFydCArIDMKICAgICAgICAgICAgICAgICAgICAkdmVyc2lvbiA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmxvYl9kYXRhWyR2ZXJzaW9uX3N0YXJ0Li4kdmVyc2lvbl9lbmRdLDApCgogICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICR2ZXJzaW9uCiAgICAgICAgICAgICAgICAgICAgaWYgKCR2ZXJzaW9uIC1uZSAzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgI3dyaXRlLWhvc3QgImVycm9yIgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyBQYXJzZSByZXN0IG9mIERGU05hbWVzcGFjZVJvb3RPckxpbmtCbG9iIGhlcmUKICAgICAgICAgICAgICAgICAgICAkZGZzX3RhcmdldGxpc3RfYmxvYl9zaXplX3N0YXJ0ID0gJHZlcnNpb25fZW5kICsgMQogICAgICAgICAgICAgICAgICAgICRkZnNfdGFyZ2V0bGlzdF9ibG9iX3NpemVfZW5kID0gJGRmc190YXJnZXRsaXN0X2Jsb2Jfc2l6ZV9zdGFydCArIDMKICAgICAgICAgICAgICAgICAgICAkZGZzX3RhcmdldGxpc3RfYmxvYl9zaXplID0gW2JpdGNvbnZlcnRlcl06OlRvVUludDMyKCRibG9iX2RhdGFbJGRmc190YXJnZXRsaXN0X2Jsb2Jfc2l6ZV9zdGFydC4uJGRmc190YXJnZXRsaXN0X2Jsb2Jfc2l6ZV9lbmRdLDApCiAgICAgICAgICAgICAgICAgICAgI3dyaXRlLWhvc3QgJGRmc190YXJnZXRsaXN0X2Jsb2Jfc2l6ZQogICAgICAgICAgICAgICAgICAgICRkZnNfdGFyZ2V0bGlzdF9ibG9iX3N0YXJ0ID0gJGRmc190YXJnZXRsaXN0X2Jsb2Jfc2l6ZV9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJGRmc190YXJnZXRsaXN0X2Jsb2JfZW5kID0gJGRmc190YXJnZXRsaXN0X2Jsb2Jfc3RhcnQgKyAkZGZzX3RhcmdldGxpc3RfYmxvYl9zaXplIC0gMQogICAgICAgICAgICAgICAgICAgICRkZnNfdGFyZ2V0bGlzdF9ibG9iID0gJGJsb2JfZGF0YVskZGZzX3RhcmdldGxpc3RfYmxvYl9zdGFydC4uJGRmc190YXJnZXRsaXN0X2Jsb2JfZW5kXQogICAgICAgICAgICAgICAgICAgICRyZXNlcnZlZF9ibG9iX3NpemVfc3RhcnQgPSAkZGZzX3RhcmdldGxpc3RfYmxvYl9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgJHJlc2VydmVkX2Jsb2Jfc2l6ZV9lbmQgPSAkcmVzZXJ2ZWRfYmxvYl9zaXplX3N0YXJ0ICsgMwogICAgICAgICAgICAgICAgICAgICRyZXNlcnZlZF9ibG9iX3NpemUgPSBbYml0Y29udmVydGVyXTo6VG9VSW50MzIoJGJsb2JfZGF0YVskcmVzZXJ2ZWRfYmxvYl9zaXplX3N0YXJ0Li4kcmVzZXJ2ZWRfYmxvYl9zaXplX2VuZF0sMCkKICAgICAgICAgICAgICAgICAgICAjd3JpdGUtaG9zdCAkcmVzZXJ2ZWRfYmxvYl9zaXplCiAgICAgICAgICAgICAgICAgICAgJHJlc2VydmVkX2Jsb2Jfc3RhcnQgPSAkcmVzZXJ2ZWRfYmxvYl9zaXplX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAkcmVzZXJ2ZWRfYmxvYl9lbmQgPSAkcmVzZXJ2ZWRfYmxvYl9zdGFydCArICRyZXNlcnZlZF9ibG9iX3NpemUgLSAxCiAgICAgICAgICAgICAgICAgICAgJHJlc2VydmVkX2Jsb2IgPSAkYmxvYl9kYXRhWyRyZXNlcnZlZF9ibG9iX3N0YXJ0Li4kcmVzZXJ2ZWRfYmxvYl9lbmRdCiAgICAgICAgICAgICAgICAgICAgJHJlZmVycmFsX3R0bF9zdGFydCA9ICRyZXNlcnZlZF9ibG9iX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAkcmVmZXJyYWxfdHRsX2VuZCA9ICRyZWZlcnJhbF90dGxfc3RhcnQgKyAzCiAgICAgICAgICAgICAgICAgICAgJHJlZmVycmFsX3R0bCA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkYmxvYl9kYXRhWyRyZWZlcnJhbF90dGxfc3RhcnQuLiRyZWZlcnJhbF90dGxfZW5kXSwwKQoKICAgICAgICAgICAgICAgICAgICAjUGFyc2UgREZTVGFyZ2V0TGlzdEJsb2IKICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X2NvdW50X3N0YXJ0ID0gMAogICAgICAgICAgICAgICAgICAgICR0YXJnZXRfY291bnRfZW5kID0gJHRhcmdldF9jb3VudF9zdGFydCArIDMKICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X2NvdW50ID0gW2JpdGNvbnZlcnRlcl06OlRvVUludDMyKCRkZnNfdGFyZ2V0bGlzdF9ibG9iWyR0YXJnZXRfY291bnRfc3RhcnQuLiR0YXJnZXRfY291bnRfZW5kXSwwKQogICAgICAgICAgICAgICAgICAgICR0X29mZnNldCA9ICR0YXJnZXRfY291bnRfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICR0YXJnZXRfY291bnQKCiAgICAgICAgICAgICAgICAgICAgZm9yKCRqPTE7ICRqIC1sZSAkdGFyZ2V0X2NvdW50OyAkaisrKXsKICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldF9lbnRyeV9zaXplX3N0YXJ0ID0gJHRfb2Zmc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfZW50cnlfc2l6ZV9lbmQgPSAkdGFyZ2V0X2VudHJ5X3NpemVfc3RhcnQgKyAzCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfZW50cnlfc2l6ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkZGZzX3RhcmdldGxpc3RfYmxvYlskdGFyZ2V0X2VudHJ5X3NpemVfc3RhcnQuLiR0YXJnZXRfZW50cnlfc2l6ZV9lbmRdLDApCiAgICAgICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICR0YXJnZXRfZW50cnlfc2l6ZQogICAgICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X3RpbWVfc3RhbXBfc3RhcnQgPSAkdGFyZ2V0X2VudHJ5X3NpemVfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X3RpbWVfc3RhbXBfZW5kID0gJHRhcmdldF90aW1lX3N0YW1wX3N0YXJ0ICsgNwogICAgICAgICAgICAgICAgICAgICAgICAjIEZJTEVUSU1FIGFnYWluIG9yIHNwZWNpYWwgaWYgcHJpb3JpdHkgcmFuayBhbmQgcHJpb3JpdHkgY2xhc3MgMAogICAgICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X3RpbWVfc3RhbXAgPSAkZGZzX3RhcmdldGxpc3RfYmxvYlskdGFyZ2V0X3RpbWVfc3RhbXBfc3RhcnQuLiR0YXJnZXRfdGltZV9zdGFtcF9lbmRdCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfc3RhdGVfc3RhcnQgPSAkdGFyZ2V0X3RpbWVfc3RhbXBfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X3N0YXRlX2VuZCA9ICR0YXJnZXRfc3RhdGVfc3RhcnQgKyAzCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfc3RhdGUgPSBbYml0Y29udmVydGVyXTo6VG9VSW50MzIoJGRmc190YXJnZXRsaXN0X2Jsb2JbJHRhcmdldF9zdGF0ZV9zdGFydC4uJHRhcmdldF9zdGF0ZV9lbmRdLDApCiAgICAgICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICR0YXJnZXRfc3RhdGUKICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldF90eXBlX3N0YXJ0ID0gJHRhcmdldF9zdGF0ZV9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfdHlwZV9lbmQgPSAkdGFyZ2V0X3R5cGVfc3RhcnQgKyAzCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfdHlwZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQzMigkZGZzX3RhcmdldGxpc3RfYmxvYlskdGFyZ2V0X3R5cGVfc3RhcnQuLiR0YXJnZXRfdHlwZV9lbmRdLDApCiAgICAgICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICR0YXJnZXRfdHlwZQogICAgICAgICAgICAgICAgICAgICAgICAkc2VydmVyX25hbWVfc2l6ZV9zdGFydCA9ICR0YXJnZXRfdHlwZV9lbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICRzZXJ2ZXJfbmFtZV9zaXplX2VuZCA9ICRzZXJ2ZXJfbmFtZV9zaXplX3N0YXJ0ICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkc2VydmVyX25hbWVfc2l6ZSA9IFtiaXRjb252ZXJ0ZXJdOjpUb1VJbnQxNigkZGZzX3RhcmdldGxpc3RfYmxvYlskc2VydmVyX25hbWVfc2l6ZV9zdGFydC4uJHNlcnZlcl9uYW1lX3NpemVfZW5kXSwwKQogICAgICAgICAgICAgICAgICAgICAgICAjd3JpdGUtaG9zdCAkc2VydmVyX25hbWVfc2l6ZSAKICAgICAgICAgICAgICAgICAgICAgICAgJHNlcnZlcl9uYW1lX3N0YXJ0ID0gJHNlcnZlcl9uYW1lX3NpemVfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkc2VydmVyX25hbWVfZW5kID0gJHNlcnZlcl9uYW1lX3N0YXJ0ICsgJHNlcnZlcl9uYW1lX3NpemUgLSAxCiAgICAgICAgICAgICAgICAgICAgICAgICRzZXJ2ZXJfbmFtZSA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKCRkZnNfdGFyZ2V0bGlzdF9ibG9iWyRzZXJ2ZXJfbmFtZV9zdGFydC4uJHNlcnZlcl9uYW1lX2VuZF0pCiAgICAgICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICRzZXJ2ZXJfbmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkc2hhcmVfbmFtZV9zaXplX3N0YXJ0ID0gJHNlcnZlcl9uYW1lX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICAgICAgJHNoYXJlX25hbWVfc2l6ZV9lbmQgPSAkc2hhcmVfbmFtZV9zaXplX3N0YXJ0ICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkc2hhcmVfbmFtZV9zaXplID0gW2JpdGNvbnZlcnRlcl06OlRvVUludDE2KCRkZnNfdGFyZ2V0bGlzdF9ibG9iWyRzaGFyZV9uYW1lX3NpemVfc3RhcnQuLiRzaGFyZV9uYW1lX3NpemVfZW5kXSwwKQogICAgICAgICAgICAgICAgICAgICAgICAkc2hhcmVfbmFtZV9zdGFydCA9ICRzaGFyZV9uYW1lX3NpemVfZW5kICsgMQogICAgICAgICAgICAgICAgICAgICAgICAkc2hhcmVfbmFtZV9lbmQgPSAkc2hhcmVfbmFtZV9zdGFydCArICRzaGFyZV9uYW1lX3NpemUgLSAxCiAgICAgICAgICAgICAgICAgICAgICAgICRzaGFyZV9uYW1lID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoJGRmc190YXJnZXRsaXN0X2Jsb2JbJHNoYXJlX25hbWVfc3RhcnQuLiRzaGFyZV9uYW1lX2VuZF0pCiAgICAgICAgICAgICAgICAgICAgICAgICN3cml0ZS1ob3N0ICRzaGFyZV9uYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRfbGlzdCArPSAiXFwkc2VydmVyX25hbWVcJHNoYXJlX25hbWUiCiAgICAgICAgICAgICAgICAgICAgICAgICR0X29mZnNldCA9ICRzaGFyZV9uYW1lX2VuZCArIDEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJG9mZnNldCA9ICRibG9iX2RhdGFfZW5kICsgMQogICAgICAgICAgICAkZGZzX3BrdF9wcm9wZXJ0aWVzID0gQHsKICAgICAgICAgICAgICAgICdOYW1lJyA9ICRibG9iX25hbWUKICAgICAgICAgICAgICAgICdQcmVmaXgnID0gJHByZWZpeAogICAgICAgICAgICAgICAgJ1RhcmdldExpc3QnID0gJHRhcmdldF9saXN0CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJG9iamVjdF9saXN0ICs9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkZGZzX3BrdF9wcm9wZXJ0aWVzCiAgICAgICAgICAgICRwcmVmaXggPSAkbnVsbAogICAgICAgICAgICAkYmxvYl9uYW1lID0gJG51bGwKICAgICAgICAgICAgJHRhcmdldF9saXN0ID0gJG51bGwKICAgICAgICB9CgogICAgICAgICRzZXJ2ZXJzID0gQCgpCiAgICAgICAgJG9iamVjdF9saXN0IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAjd3JpdGUtaG9zdCAkXy5OYW1lOwogICAgICAgICAgICAjd3JpdGUtaG9zdCAkXy5UYXJnZXRMaXN0CiAgICAgICAgICAgIGlmICgkXy5UYXJnZXRMaXN0KSB7CiAgICAgICAgICAgICAgICAkXy5UYXJnZXRMaXN0IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRzZXJ2ZXJzICs9ICRfLnNwbGl0KCJcIilbMl0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJHNlcnZlcnMKICAgIH0KCiAgICBmdW5jdGlvbiBHZXQtREZTc2hhcmVWMSB7CiAgICAgICAgW0NtZGxldEJpbmRpbmcoKV0KICAgICAgICBwYXJhbSgKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbiwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJEFEU3BhdGgsCgogICAgICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0KICAgICAgICAgICAgW0ludF0KICAgICAgICAgICAgJFBhZ2VTaXplID0gMjAwLAoKICAgICAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgICAgICRDcmVkZW50aWFsCiAgICAgICAgKQoKICAgICAgICAkREZTc2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgaWYoJERGU3NlYXJjaGVyKSB7CiAgICAgICAgICAgICRERlNzaGFyZXMgPSBAKCkKICAgICAgICAgICAgJERGU3NlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDbGFzcz1mVERmcykpIgoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJERGU1NlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAgICAgJFJlc3VsdHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAkUHJvcGVydGllcyA9ICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAkUmVtb3RlTmFtZXMgPSAkUHJvcGVydGllcy5yZW1vdGVzZXJ2ZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgJFBrdCA9ICRQcm9wZXJ0aWVzLnBrdAoKICAgICAgICAgICAgICAgICAgICAkREZTc2hhcmVzICs9ICRSZW1vdGVOYW1lcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJF8uQ29udGFpbnMoJ1wnKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgQHsnTmFtZSc9JFByb3BlcnRpZXMubmFtZVswXTsnUmVtb3RlU2VydmVyTmFtZSc9JF8uc3BsaXQoIlwiKVsyXX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgaW4gcGFyc2luZyBERlMgc2hhcmUgOiAkXyIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJERGU1NlYXJjaGVyLmRpc3Bvc2UoKQoKICAgICAgICAgICAgICAgIGlmKCRwa3QgLWFuZCAkcGt0WzBdKSB7CiAgICAgICAgICAgICAgICAgICAgUGFyc2UtUGt0ICRwa3RbMF0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgSWYgYSBmb2xkZXIgZG9lc24ndCBoYXZlIGEgcmVkaXJlY3Rpb24gaXQgd2lsbAogICAgICAgICAgICAgICAgICAgICAgICAjIGhhdmUgYSB0YXJnZXQgbGlrZQogICAgICAgICAgICAgICAgICAgICAgICAjIFxcbnVsbFxUZXN0TmFtZVNwYWNlXGZvbGRlclwuREZTRm9sZGVyTGluayBzbyB3ZQogICAgICAgICAgICAgICAgICAgICAgICAjIGRvIGFjdHVhbGx5IHdhbnQgdG8gbWF0Y2ggb24gIm51bGwiIHJhdGhlciB0aGFuCiAgICAgICAgICAgICAgICAgICAgICAgICMgJG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfIC1uZSAibnVsbCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSBAeydOYW1lJz0kUHJvcGVydGllcy5uYW1lWzBdOydSZW1vdGVTZXJ2ZXJOYW1lJz0kX30KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJHZXQtREZTc2hhcmVWMSBlcnJvciA6ICRfIgogICAgICAgICAgICB9CiAgICAgICAgICAgICRERlNzaGFyZXMgfCBTb3J0LU9iamVjdCAtUHJvcGVydHkgIlJlbW90ZVNlcnZlck5hbWUiCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEdldC1ERlNzaGFyZVYyIHsKICAgICAgICBbQ21kbGV0QmluZGluZygpXQogICAgICAgIHBhcmFtKAogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkRG9tYWluLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICAgICAgW0ludF0KICAgICAgICAgICAgJFBhZ2VTaXplID0gMjAwLAoKICAgICAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgICAgICRDcmVkZW50aWFsCiAgICAgICAgKQoKICAgICAgICAkREZTc2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgaWYoJERGU3NlYXJjaGVyKSB7CiAgICAgICAgICAgICRERlNzaGFyZXMgPSBAKCkKICAgICAgICAgICAgJERGU3NlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDbGFzcz1tc0RGUy1MaW5rdjIpKSIKICAgICAgICAgICAgJERGU1NlYXJjaGVyLlByb3BlcnRpZXNUb0xvYWQuQWRkUmFuZ2UoKCdtc2Rmcy1saW5rcGF0aHYyJywnbXNERlMtVGFyZ2V0TGlzdHYyJykpCgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJFJlc3VsdHMgPSAkREZTU2VhcmNoZXIuRmluZEFsbCgpCiAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0aWVzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICR0YXJnZXRfbGlzdCA9ICRQcm9wZXJ0aWVzLidtc2Rmcy10YXJnZXRsaXN0djInWzBdCiAgICAgICAgICAgICAgICAgICAgJHhtbCA9IFt4bWxdW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoJHRhcmdldF9saXN0WzIuLigkdGFyZ2V0X2xpc3QuTGVuZ3RoLTEpXSkKICAgICAgICAgICAgICAgICAgICAkREZTc2hhcmVzICs9ICR4bWwudGFyZ2V0cy5DaGlsZE5vZGVzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFRhcmdldCA9ICRfLklubmVyVGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkVGFyZ2V0LkNvbnRhaW5zKCdcJykgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJERGU3Jvb3QgPSAkVGFyZ2V0LnNwbGl0KCJcIilbM10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2hhcmVOYW1lID0gJFByb3BlcnRpZXMuJ21zZGZzLWxpbmtwYXRodjInWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5IEB7J05hbWUnPSIkREZTcm9vdCRTaGFyZU5hbWUiOydSZW1vdGVTZXJ2ZXJOYW1lJz0kVGFyZ2V0LnNwbGl0KCJcIilbMl19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGluIHBhcnNpbmcgdGFyZ2V0IDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkUmVzdWx0cy5kaXNwb3NlKCkKICAgICAgICAgICAgICAgICRERlNTZWFyY2hlci5kaXNwb3NlKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJHZXQtREZTc2hhcmVWMiBlcnJvciA6ICRfIgogICAgICAgICAgICB9CiAgICAgICAgICAgICRERlNzaGFyZXMgfCBTb3J0LU9iamVjdCAtVW5pcXVlIC1Qcm9wZXJ0eSAiUmVtb3RlU2VydmVyTmFtZSIKICAgICAgICB9CiAgICB9CgogICAgJERGU3NoYXJlcyA9IEAoKQoKICAgIGlmICggKCRWZXJzaW9uIC1lcSAiYWxsIikgLW9yICgkVmVyc2lvbi5lbmRzV2l0aCgiMSIpKSApIHsKICAgICAgICAkREZTc2hhcmVzICs9IEdldC1ERlNzaGFyZVYxIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CiAgICBpZiAoICgkVmVyc2lvbiAtZXEgImFsbCIpIC1vciAoJFZlcnNpb24uZW5kc1dpdGgoIjIiKSkgKSB7CiAgICAgICAgJERGU3NoYXJlcyArPSBHZXQtREZTc2hhcmVWMiAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUFEU3BhdGggJEFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQoKICAgICRERlNzaGFyZXMgfCBTb3J0LU9iamVjdCAtUHJvcGVydHkgKCJSZW1vdGVTZXJ2ZXJOYW1lIiwiTmFtZSIpIC1VbmlxdWUKfQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBHUE8gcmVsYXRlZCBmdW5jdGlvbnMuCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZ1bmN0aW9uIEdldC1HcHRUbXBsIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBIZWxwZXIgdG8gcGFyc2UgYSBHcHRUbXBsLmluZiBwb2xpY3kgZmlsZSBwYXRoIGludG8gYSBjdXN0b20gb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgR3B0VG1wbFBhdGgKCiAgICAgICAgVGhlIEdwdFRtcGwuaW5mIGZpbGUgcGF0aCBuYW1lIHRvIHBhcnNlLiAKCiAgICAuUEFSQU1FVEVSIFVzZVBTRHJpdmUKCiAgICAgICAgU3dpdGNoLiBNb3VudCB0aGUgdGFyZ2V0IEdwdFRtcGwgZm9sZGVyIHBhdGggYXMgYSB0ZW1wb3JhcnkgUFNEcml2ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1HcHRUbXBsIC1HcHRUbXBsUGF0aCAiXFxkZXYudGVzdGxhYi5sb2NhbFxzeXN2b2xcZGV2LnRlc3RsYWIubG9jYWxcUG9saWNpZXNcezMxQjJGMzQwLTAxNkQtMTFEMi05NDVGLTAwQzA0RkI5ODRGOX1cTUFDSElORVxNaWNyb3NvZnRcV2luZG93cyBOVFxTZWNFZGl0XEdwdFRtcGwuaW5mIgoKICAgICAgICBQYXJzZSB0aGUgZGVmYXVsdCBkb21haW4gcG9saWN5IC5pbmYgZm9yIGRldi50ZXN0bGFiLmxvY2FsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdwdFRtcGxQYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlCiAgICApCgogICAgYmVnaW4gewogICAgICAgIGlmKCRVc2VQU0RyaXZlKSB7CiAgICAgICAgICAgICMgaWYgd2UncmUgUFNEcml2ZXMsIGNyZWF0ZSBhIHRlbXBvcmFyeSBtb3VudCBwb2ludAogICAgICAgICAgICAkUGFydHMgPSAkR3B0VG1wbFBhdGguc3BsaXQoJ1wnKQogICAgICAgICAgICAkRm9sZGVyUGF0aCA9ICRQYXJ0c1swLi4oJFBhcnRzLmxlbmd0aC0yKV0gLWpvaW4gJ1wnCiAgICAgICAgICAgICRGaWxlUGF0aCA9ICRQYXJ0c1stMV0KICAgICAgICAgICAgJFJhbmREcml2ZSA9ICgiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoiLlRvQ2hhckFycmF5KCkgfCBHZXQtUmFuZG9tIC1Db3VudCA3KSAtam9pbiAnJwogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTW91bnRpbmcgcGF0aCAkR3B0VG1wbFBhdGggdXNpbmcgYSB0ZW1wIFBTRHJpdmUgYXQgJFJhbmREcml2ZSIKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkTnVsbCA9IE5ldy1QU0RyaXZlIC1OYW1lICRSYW5kRHJpdmUgLVBTUHJvdmlkZXIgRmlsZVN5c3RlbSAtUm9vdCAkRm9sZGVyUGF0aCAgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgbW91bnRpbmcgcGF0aCAkR3B0VG1wbFBhdGggOiAkXyIKICAgICAgICAgICAgICAgIHJldHVybiAkTnVsbAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHNvIHdlIGNhbiBjZC9kaXIgdGhlIG5ldyBkcml2ZQogICAgICAgICAgICAkR3B0VG1wbFBhdGggPSAkUmFuZERyaXZlICsgIjpcIiArICRGaWxlUGF0aAogICAgICAgIH0gCiAgICB9CgogICAgcHJvY2VzcyB7CiAgICAgICAgJFNlY3Rpb25OYW1lID0gJycKICAgICAgICAkU2VjdGlvbnNUZW1wID0gQHt9CiAgICAgICAgJFNlY3Rpb25zRmluYWwgPSBAe30KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUGFyc2luZyAkR3B0VG1wbFBhdGgiCgogICAgICAgICAgICBHZXQtQ29udGVudCAkR3B0VG1wbFBhdGggLUVycm9yQWN0aW9uIFN0b3AgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICBpZiAoJF8gLW1hdGNoICdcWycpIHsKICAgICAgICAgICAgICAgICAgICAjIHRoaXMgc2lnbmlmaWVzIHRoYXQgd2UncmUgc3RhcnRpbmcgYSBuZXcgc2VjdGlvbgogICAgICAgICAgICAgICAgICAgICRTZWN0aW9uTmFtZSA9ICRfLnRyaW0oJ1tdJykgLXJlcGxhY2UgJyAnLCcnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYoJF8gLW1hdGNoICc9JykgewogICAgICAgICAgICAgICAgICAgICRQYXJ0cyA9ICRfLnNwbGl0KCc9JykKICAgICAgICAgICAgICAgICAgICAkUHJvcGVydHlOYW1lID0gJFBhcnRzWzBdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0eVZhbHVlcyA9ICRQYXJ0c1sxXS50cmltKCkKCiAgICAgICAgICAgICAgICAgICAgaWYoJFByb3BlcnR5VmFsdWVzIC1tYXRjaCAnLCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFByb3BlcnR5VmFsdWVzID0gJFByb3BlcnR5VmFsdWVzLnNwbGl0KCcsJykKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCEkU2VjdGlvbnNUZW1wWyRTZWN0aW9uTmFtZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFNlY3Rpb25zVGVtcC5BZGQoJFNlY3Rpb25OYW1lLCBAe30pCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAjIGFkZCB0aGUgcGFyc2VkIHByb3BlcnR5IGludG8gdGhlIHJlbGV2YW50IFNlY3Rpb24gbmFtZQogICAgICAgICAgICAgICAgICAgICRTZWN0aW9uc1RlbXBbJFNlY3Rpb25OYW1lXS5BZGQoICRQcm9wZXJ0eU5hbWUsICRQcm9wZXJ0eVZhbHVlcyApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEZvckVhY2ggKCRTZWN0aW9uIGluICRTZWN0aW9uc1RlbXAua2V5cykgewogICAgICAgICAgICAgICAgIyB0cmFuc2Zvcm0gZWFjaCBuZXN0ZWQgaGFzaCB0YWJsZSBpbnRvIGEgY3VzdG9tIG9iamVjdAogICAgICAgICAgICAgICAgJFNlY3Rpb25zRmluYWxbJFNlY3Rpb25dID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgJFNlY3Rpb25zVGVtcFskU2VjdGlvbl0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyB0cmFuc2Zvcm0gdGhlIHBhcmVudCBoYXNoIHRhYmxlIGludG8gYSBjdXN0b20gb2JqZWN0CiAgICAgICAgICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5ICRTZWN0aW9uc0ZpbmFsCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHBhcnNpbmcgJEdwdFRtcGxQYXRoIDogJF8iCiAgICAgICAgfQogICAgfQoKICAgIGVuZCB7CiAgICAgICAgaWYoJFVzZVBTRHJpdmUgLWFuZCAkUmFuZERyaXZlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlbW92aW5nIHRlbXAgUFNEcml2ZSAkUmFuZERyaXZlIgogICAgICAgICAgICBHZXQtUFNEcml2ZSAtTmFtZSAkUmFuZERyaXZlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgUmVtb3ZlLVBTRHJpdmUgLUZvcmNlCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LUdyb3Vwc1hNTCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgSGVscGVyIHRvIHBhcnNlIGEgZ3JvdXBzLnhtbCBmaWxlIHBhdGggaW50byBhIGN1c3RvbSBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBHcm91cHNYTUxwYXRoCgogICAgICAgIFRoZSBncm91cHMueG1sIGZpbGUgcGF0aCBuYW1lIHRvIHBhcnNlLiAKCiAgICAuUEFSQU1FVEVSIFJlc29sdmVTaWRzCgogICAgICAgIFN3aXRjaC4gUmVzb2x2ZSBTaWRzIGZyb20gYSBEQyBwb2xpY3kgdG8gb2JqZWN0IG5hbWVzLgoKICAgIC5QQVJBTUVURVIgVXNlUFNEcml2ZQoKICAgICAgICBTd2l0Y2guIE1vdW50IHRoZSB0YXJnZXQgZ3JvdXBzLnhtbCBmb2xkZXIgcGF0aCBhcyBhIHRlbXBvcmFyeSBQU0RyaXZlLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cHNYTUxQYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXNvbHZlU2lkcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZQogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZigkVXNlUFNEcml2ZSkgewogICAgICAgICAgICAjIGlmIHdlJ3JlIFBTRHJpdmVzLCBjcmVhdGUgYSB0ZW1wb3JhcnkgbW91bnQgcG9pbnQKICAgICAgICAgICAgJFBhcnRzID0gJEdyb3Vwc1hNTFBhdGguc3BsaXQoJ1wnKQogICAgICAgICAgICAkRm9sZGVyUGF0aCA9ICRQYXJ0c1swLi4oJFBhcnRzLmxlbmd0aC0yKV0gLWpvaW4gJ1wnCiAgICAgICAgICAgICRGaWxlUGF0aCA9ICRQYXJ0c1stMV0KICAgICAgICAgICAgJFJhbmREcml2ZSA9ICgiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoiLlRvQ2hhckFycmF5KCkgfCBHZXQtUmFuZG9tIC1Db3VudCA3KSAtam9pbiAnJwoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTW91bnRpbmcgcGF0aCAkR3JvdXBzWE1MUGF0aCB1c2luZyBhIHRlbXAgUFNEcml2ZSBhdCAkUmFuZERyaXZlIgoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICROdWxsID0gTmV3LVBTRHJpdmUgLU5hbWUgJFJhbmREcml2ZSAtUFNQcm92aWRlciBGaWxlU3lzdGVtIC1Sb290ICRGb2xkZXJQYXRoICAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBtb3VudGluZyBwYXRoICRHcm91cHNYTUxQYXRoIDogJF8iCiAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBzbyB3ZSBjYW4gY2QvZGlyIHRoZSBuZXcgZHJpdmUKICAgICAgICAgICAgJEdyb3Vwc1hNTFBhdGggPSAkUmFuZERyaXZlICsgIjpcIiArICRGaWxlUGF0aAogICAgICAgIH0gCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFt4bWxdICRHcm91cHNYTUxjb250ZW50ID0gR2V0LUNvbnRlbnQgJEdyb3Vwc1hNTFBhdGggLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgICAgICMgcHJvY2VzcyBhbGwgZ3JvdXAgcHJvcGVydGllcyBpbiB0aGUgWE1MCiAgICAgICAgICAgICRHcm91cHNYTUxjb250ZW50IHwgU2VsZWN0LVhtbCAiLy9Hcm91cHMiIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgbm9kZSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAkTWVtYmVycyA9IEAoKQogICAgICAgICAgICAgICAgJE1lbWJlck9mID0gQCgpCgogICAgICAgICAgICAgICAgIyBleHRyYWN0IHRoZSBsb2NhbGdyb3VwIHNpZCBmb3IgbWVtYmVyb2YKICAgICAgICAgICAgICAgICRMb2NhbFNpZCA9ICRfLlByb3BlcnRpZXMuR3JvdXBTaWQKICAgICAgICAgICAgICAgIGlmKCEkTG9jYWxTaWQpIHsKICAgICAgICAgICAgICAgICAgICBpZigkXy5Qcm9wZXJ0aWVzLmdyb3VwTmFtZSAtbWF0Y2ggJ0FkbWluaXN0cmF0b3JzJykgewogICAgICAgICAgICAgICAgICAgICAgICAkTG9jYWxTaWQgPSAnUy0xLTUtMzItNTQ0JwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlaWYoJF8uUHJvcGVydGllcy5ncm91cE5hbWUgLW1hdGNoICdSZW1vdGUgRGVza3RvcCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsU2lkID0gJ1MtMS01LTMyLTU1NScKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFNpZCA9ICRfLlByb3BlcnRpZXMuZ3JvdXBOYW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJE1lbWJlck9mID0gQCgkTG9jYWxTaWQpCgogICAgICAgICAgICAgICAgJF8uUHJvcGVydGllcy5tZW1iZXJzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICMgcHJvY2VzcyBlYWNoIG1lbWJlciBvZiB0aGUgYWJvdmUgbG9jYWwgZ3JvdXAKICAgICAgICAgICAgICAgICAgICAkXyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IE1lbWJlciB8IFdoZXJlLU9iamVjdCB7ICRfLmFjdGlvbiAtbWF0Y2ggJ0FERCcgfSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRfLnNpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgKz0gJF8uc2lkCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGp1c3QgYSBzdHJhaWdodCBsb2NhbCBhY2NvdW50IG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJzICs9ICRfLm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJE1lbWJlcnMgLW9yICRNZW1iZXJvZikgewogICAgICAgICAgICAgICAgICAgICMgZXh0cmFjdCBvdXQgYW55L2FsbCBmaWx0ZXJzLi4uSSBoYXRlIHlvdSBHUFAKICAgICAgICAgICAgICAgICAgICAkRmlsdGVycyA9ICRfLmZpbHRlcnMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgRmlsdGVyKiB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSBAeydUeXBlJyA9ICRfLkxvY2FsTmFtZTsnVmFsdWUnID0gJF8ubmFtZX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYoJFJlc29sdmVTaWRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJvZiA9ICRNZW1iZXJvZiB8IEZvckVhY2gtT2JqZWN0IHtDb252ZXJ0LVNpZFRvTmFtZSAkX30KICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgPSAkTWVtYmVycyB8IEZvckVhY2gtT2JqZWN0IHtDb252ZXJ0LVNpZFRvTmFtZSAkX30KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCRNZW1iZXJvZiAtaXNub3QgW3N5c3RlbS5hcnJheV0pIHskTWVtYmVyb2YgPSBAKCRNZW1iZXJvZil9CiAgICAgICAgICAgICAgICAgICAgaWYoJE1lbWJlcnMgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7JE1lbWJlcnMgPSBAKCRNZW1iZXJzKX0KCiAgICAgICAgICAgICAgICAgICAgJEdQT1Byb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICAnR1BPRGlzcGxheU5hbWUnID0gJEdQT0Rpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICdHUE9OYW1lJyA9ICRHUE9OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICdHUE9QYXRoJyA9ICRHcm91cHNYTUxQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICdGaWx0ZXJzJyA9ICRGaWx0ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgICdNZW1iZXJPZicgPSAkTWVtYmVyb2YKICAgICAgICAgICAgICAgICAgICAgICAgJ01lbWJlcnMnID0gJE1lbWJlcnMKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkR1BPUHJvcGVydGllcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHBhcnNpbmcgJEdwdFRtcGxQYXRoIDogJF8iCiAgICAgICAgfQogICAgfQoKICAgIGVuZCB7CiAgICAgICAgaWYoJFVzZVBTRHJpdmUgLWFuZCAkUmFuZERyaXZlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlbW92aW5nIHRlbXAgUFNEcml2ZSAkUmFuZERyaXZlIgogICAgICAgICAgICBHZXQtUFNEcml2ZSAtTmFtZSAkUmFuZERyaXZlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgUmVtb3ZlLVBTRHJpdmUgLUZvcmNlCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldEdQTyB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyBhIGxpc3Qgb2YgYWxsIGN1cnJlbnQgR1BPcyBpbiBhIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIEdQT25hbWUKCiAgICAgICAgVGhlIEdQTyBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLiAgIAoKICAgIC5QQVJBTUVURVIgRGlzcGxheU5hbWUKCiAgICAgICAgVGhlIEdQTyBkaXNwbGF5IG5hbWUgdG8gcXVlcnkgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuICAgCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgUmV0dXJuIGFsbCBHUE8gb2JqZWN0cyBhcHBsaWVkIHRvIGEgZ2l2ZW4gY29tcHV0ZXIgKEZRRE4pLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIEdQT3MsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoCiAgICAgICAgZS5nLiAiTERBUDovL2NuPXs4RkY1OUQyOC0xNUQ3LTQyMkEtQkNCNy0yQUU0NTcyNDEyNUF9LGNuPXBvbGljaWVzLGNuPXN5c3RlbSxEQz1kZXYsREM9dGVzdGxhYixEQz1sb2NhbCIKCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEdQTyAtRG9tYWluIHRlc3RsYWIubG9jYWwKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSBHUE9zIGluIHRoZSAndGVzdGxhYi5sb2NhbCcgZG9tYWluLiAKIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR1BPbmFtZSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRGlzcGxheU5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAogICAgICAgIAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgJEdQT1NlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYgKCRHUE9TZWFyY2hlcikgewoKICAgICAgICAgICAgaWYoJENvbXB1dGVyTmFtZSkgewogICAgICAgICAgICAgICAgJEdQT05hbWVzID0gQCgpCiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJzID0gR2V0LU5ldENvbXB1dGVyIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgICAgICAgICBpZighJENvbXB1dGVycykgewogICAgICAgICAgICAgICAgICAgIHRocm93ICJDb21wdXRlciAkQ29tcHV0ZXJOYW1lIGluIGRvbWFpbiAnJERvbWFpbicgbm90IGZvdW5kISBUcnkgYSBmdWxseSBxdWFsaWZpZWQgaG9zdCBuYW1lIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIGdldCB0aGUgZ2l2ZW4gY29tcHV0ZXIncyBPVQogICAgICAgICAgICAgICAgJENvbXB1dGVyT1VzID0gQCgpCiAgICAgICAgICAgICAgICBGb3JFYWNoKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgIyBleHRyYWN0IGFsbCBPVXMgYSBjb21wdXRlciBpcyBhIHBhcnQgb2YKICAgICAgICAgICAgICAgICAgICAkRE4gPSAkQ29tcHV0ZXIuZGlzdGluZ3Vpc2hlZG5hbWUKCiAgICAgICAgICAgICAgICAgICAgJENvbXB1dGVyT1VzICs9ICRETi5zcGxpdCgiLCIpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICBpZigkXy5zdGFydHN3aXRoKCJPVT0iKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEROLnN1YnN0cmluZygkRE4uaW5kZXhvZigkXykpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNvbXB1dGVyT1VzOiAkQ29tcHV0ZXJPVXMiCgogICAgICAgICAgICAgICAgIyBmaW5kIGFsbCB0aGUgR1BPcyBsaW5rZWQgdG8gdGhlIGNvbXB1dGVyJ3MgT1UKICAgICAgICAgICAgICAgIEZvckVhY2goJENvbXB1dGVyT1UgaW4gJENvbXB1dGVyT1VzKSB7CiAgICAgICAgICAgICAgICAgICAgJEdQT05hbWVzICs9IEdldC1OZXRPVSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJENvbXB1dGVyT1UgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JFYWNoLU9iamVjdCB7IAogICAgICAgICAgICAgICAgICAgICAgICAjIGdldCBhbnkgR1BPIGxpbmtzCiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlLXZlcmJvc2UgImJsYWg6ICQoJF8ubmFtZSkiCiAgICAgICAgICAgICAgICAgICAgICAgICRfLmdwbGluay5zcGxpdCgiXVsiKSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkXy5zdGFydHN3aXRoKCJMREFQIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5zcGxpdCgiOyIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkdQT05hbWVzOiAkR1BPTmFtZXMiCgogICAgICAgICAgICAgICAgIyBmaW5kIGFueSBHUE9zIGxpbmtlZCB0byB0aGUgc2l0ZSBmb3IgdGhlIGdpdmVuIGNvbXB1dGVyCiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJTaXRlID0gKEdldC1TaXRlTmFtZSAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUpLlNpdGVOYW1lCiAgICAgICAgICAgICAgICBpZigkQ29tcHV0ZXJTaXRlIC1hbmQgKCRDb21wdXRlclNpdGUgLW5lICdFUlJPUicpKSB7CiAgICAgICAgICAgICAgICAgICAgJEdQT05hbWVzICs9IEdldC1OZXRTaXRlIC1TaXRlTmFtZSAkQ29tcHV0ZXJTaXRlIC1GdWxsRGF0YSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJF8uZ3BsaW5rKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5ncGxpbmsuc3BsaXQoIl1bIikgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfLnN0YXJ0c3dpdGgoIkxEQVAiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5zcGxpdCgiOyIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRHUE9OYW1lcyB8IFdoZXJlLU9iamVjdHskXyAtYW5kICgkXyAtbmUgJycpfSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgIyB1c2UgdGhlIGdwbGluayBhcyBhbiBBRFMgcGF0aCB0byBlbnVtZXJhdGUgYWxsIEdQT3MgZm9yIHRoZSBjb21wdXRlcgogICAgICAgICAgICAgICAgICAgICRHUE9TZWFyY2hlciA9IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUFEU3BhdGggJF8gLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAgICAgICAgICRHUE9TZWFyY2hlci5maWx0ZXI9IigmKG9iamVjdENhdGVnb3J5PWdyb3VwUG9saWN5Q29udGFpbmVyKShuYW1lPSRHUE9uYW1lKSkiCgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJEdQT1NlYXJjaGVyLkZpbmRBbGwoKQogICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dCA9IENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdHMuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICRHUE9TZWFyY2hlci5kaXNwb3NlKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICRfCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmKCREaXNwbGF5TmFtZSkgewogICAgICAgICAgICAgICAgICAgICRHUE9TZWFyY2hlci5maWx0ZXI9IigmKG9iamVjdENhdGVnb3J5PWdyb3VwUG9saWN5Q29udGFpbmVyKShkaXNwbGF5bmFtZT0kRGlzcGxheU5hbWUpKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRHUE9TZWFyY2hlci5maWx0ZXI9IigmKG9iamVjdENhdGVnb3J5PWdyb3VwUG9saWN5Q29udGFpbmVyKShuYW1lPSRHUE9uYW1lKSkiCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAkUmVzdWx0cyA9ICRHUE9TZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJFJlc3VsdHMuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAgICAgJEdQT1NlYXJjaGVyLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgJF8KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIE5ldy1HUE9JbW1lZGlhdGVUYXNrIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBCdWlsZHMgYW4gJ0ltbWVkaWF0ZScgc2NodGFzayB0byBwdXNoIG91dCB0aHJvdWdoIGEgc3BlY2lmaWVkIEdQTy4KCiAgICAuUEFSQU1FVEVSIFRhc2tOYW1lCgogICAgICAgIE5hbWUgZm9yIHRoZSBzY2h0YXNrIHRvIHJlY3JlYXRlLiBSZXF1aXJlZC4KCiAgICAuUEFSQU1FVEVSIENvbW1hbmQKCiAgICAgICAgVGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSB3aXRoIHRoZSB0YXNrLCBkZWZhdWx0cyB0byAncG93ZXJzaGVsbCcKCiAgICAuUEFSQU1FVEVSIENvbW1hbmRBcmd1bWVudHMKCiAgICAgICAgVGhlIGFyZ3VtZW50cyB0byBzdXBwbHkgdG8gdGhlIC1Db21tYW5kIGJlaW5nIGxhdW5jaGVkLgoKICAgIC5QQVJBTUVURVIgVGFza0Rlc2NyaXB0aW9uCgogICAgICAgIEFuIG9wdGlvbmFsIGRlc2NyaXB0aW9uIGZvciB0aGUgdGFzay4KCiAgICAuUEFSQU1FVEVSIFRhc2tBdXRob3IKICAgICAgICAKICAgICAgICBUaGUgZGlzcGxheWVkIGF1dGhvciBvZiB0aGUgdGFzaywgZGVmYXVsdHMgdG8gJydOVCBBVVRIT1JJVFlcU3lzdGVtJwoKICAgIC5QQVJBTUVURVIgVGFza01vZGlmaWVkRGF0ZQogICAgCiAgICAgICAgVGhlIGRpc3BsYXllZCBtb2RpZmllZCBkYXRlIGZvciB0aGUgdGFzaywgZGVmYXVsdHMgdG8gMzAgZGF5cyBhZ28uCgogICAgLlBBUkFNRVRFUiBHUE9uYW1lCgogICAgICAgIFRoZSBHUE8gbmFtZSB0byBidWlsZCB0aGUgdGFzayBmb3IuCgogICAgLlBBUkFNRVRFUiBHUE9EaXNwbGF5TmFtZQoKICAgICAgICBUaGUgR1BPIGRpc3BsYXkgbmFtZSB0byBidWlsZCB0aGUgdGFzayBmb3IuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgdGhlIEdQT3MsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoCiAgICAgICAgZS5nLiAiTERBUDovL2NuPXs4RkY1OUQyOC0xNUQ3LTQyMkEtQkNCNy0yQUU0NTcyNDEyNUF9LGNuPXBvbGljaWVzLGNuPXN5c3RlbSxEQz1kZXYsREM9dGVzdGxhYixEQz1sb2NhbCIKCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFM+IE5ldy1HUE9JbW1lZGlhdGVUYXNrIC1UYXNrTmFtZSBEZWJ1Z2dpbmcgLUdQT0Rpc3BsYXlOYW1lIFNlY3VyZVBvbGljeSAtQ29tbWFuZEFyZ3VtZW50cyAnLWMgIjEyMyB8IE91dC1GaWxlIEM6XFRlbXBcZGVidWcudHh0IicgLUZvcmNlCgogICAgICAgIENyZWF0ZSBhbiBpbW1lZGlhdGUgc2NodGFzayB0aGF0IGV4ZWN1dGVzIHRoZSBzcGVjaWZpZWQgUG93ZXJTaGVsbCBhcmd1bWVudHMgYW5kCiAgICAgICAgcHVzaCBpdCBvdXQgdG8gdGhlICdTZWN1cmVQb2xpY3knIEdQTywgc2tpcHBpbmcgdGhlIGNvbmZpcm1hdGlvbiBwcm9tcHQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFM+IE5ldy1HUE9JbW1lZGlhdGVUYXNrIC1HUE9EaXNwbGF5TmFtZSBTZWN1cmVQb2xpY3kgLVJlbW92ZSAtRm9yY2UKCiAgICAgICAgUmVtb3ZlIGFsbCBzY2h0YXNrcyBmcm9tIHRoZSAnU2VjdXJlUG9saWN5JyBHUE8sIHNraXBwaW5nIHRoZSBjb25maXJtYXRpb24gcHJvbXB0LgojPgogICAgW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJFRhc2tOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21tYW5kID0gJ3Bvd2Vyc2hlbGwnLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21tYW5kQXJndW1lbnRzLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRUYXNrRGVzY3JpcHRpb24gPSAnJywKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkVGFza0F1dGhvciA9ICdOVCBBVVRIT1JJVFlcU3lzdGVtJywKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkVGFza01vZGlmaWVkRGF0ZSA9IChHZXQtRGF0ZSAoR2V0LURhdGUpLkFkZERheXMoLTMwKSAtRm9ybWF0IHUpLnRyaW0oIloiKSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdSZW1vdmUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHUE9uYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ1JlbW92ZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdQT0Rpc3BsYXlOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQ3JlYXRlJyldCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ1JlbW92ZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdSZW1vdmUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAogICAgICAgIAogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdDcmVhdGUnKV0KICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnUmVtb3ZlJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdSZW1vdmUnKV0KICAgICAgICBbU3dpdGNoXQogICAgICAgICRGb3JjZSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ1JlbW92ZScpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlbW92ZSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0NyZWF0ZScpXQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdSZW1vdmUnKV0gICAgICAgIAogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgIyBidWlsZCB0aGUgWE1MIHNwZWMgZm9yIG91ciAnaW1tZWRpYXRlJyBzY2hlZHVsZWQgdGFzawogICAgJFRhc2tYTUwgPSAnPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48U2NoZWR1bGVkVGFza3MgY2xzaWQ9IntDQzYzRjIwMC03MzA5LTRiYTAtQjE1NC1BNzFDRDExOERCQ0N9Ij48SW1tZWRpYXRlVGFza1YyIGNsc2lkPSJ7OTc1NkI1ODEtNzZFQy00MTY5LTlBRkMtMENBOEQ0M0FEQjVGfSIgbmFtZT0iJyskVGFza05hbWUrJyIgaW1hZ2U9IjAiIGNoYW5nZWQ9IicrJFRhc2tNb2RpZmllZERhdGUrJyIgdWlkPSJ7JyskKFtndWlkXTo6TmV3R3VpZCgpKSsnfSIgdXNlckNvbnRleHQ9IjAiIHJlbW92ZVBvbGljeT0iMCI+PFByb3BlcnRpZXMgYWN0aW9uPSJDIiBuYW1lPSInKyRUYXNrTmFtZSsnIiBydW5Bcz0iTlQgQVVUSE9SSVRZXFN5c3RlbSIgbG9nb25UeXBlPSJTNFUiPjxUYXNrIHZlcnNpb249IjEuMyI+PFJlZ2lzdHJhdGlvbkluZm8+PEF1dGhvcj4nKyRUYXNrQXV0aG9yKyc8L0F1dGhvcj48RGVzY3JpcHRpb24+JyskVGFza0Rlc2NyaXB0aW9uKyc8L0Rlc2NyaXB0aW9uPjwvUmVnaXN0cmF0aW9uSW5mbz48UHJpbmNpcGFscz48UHJpbmNpcGFsIGlkPSJBdXRob3IiPjxVc2VySWQ+TlQgQVVUSE9SSVRZXFN5c3RlbTwvVXNlcklkPjxSdW5MZXZlbD5IaWdoZXN0QXZhaWxhYmxlPC9SdW5MZXZlbD48TG9nb25UeXBlPlM0VTwvTG9nb25UeXBlPjwvUHJpbmNpcGFsPjwvUHJpbmNpcGFscz48U2V0dGluZ3M+PElkbGVTZXR0aW5ncz48RHVyYXRpb24+UFQxME08L0R1cmF0aW9uPjxXYWl0VGltZW91dD5QVDFIPC9XYWl0VGltZW91dD48U3RvcE9uSWRsZUVuZD50cnVlPC9TdG9wT25JZGxlRW5kPjxSZXN0YXJ0T25JZGxlPmZhbHNlPC9SZXN0YXJ0T25JZGxlPjwvSWRsZVNldHRpbmdzPjxNdWx0aXBsZUluc3RhbmNlc1BvbGljeT5JZ25vcmVOZXc8L011bHRpcGxlSW5zdGFuY2VzUG9saWN5PjxEaXNhbGxvd1N0YXJ0SWZPbkJhdHRlcmllcz5mYWxzZTwvRGlzYWxsb3dTdGFydElmT25CYXR0ZXJpZXM+PFN0b3BJZkdvaW5nT25CYXR0ZXJpZXM+dHJ1ZTwvU3RvcElmR29pbmdPbkJhdHRlcmllcz48QWxsb3dIYXJkVGVybWluYXRlPmZhbHNlPC9BbGxvd0hhcmRUZXJtaW5hdGU+PFN0YXJ0V2hlbkF2YWlsYWJsZT50cnVlPC9TdGFydFdoZW5BdmFpbGFibGU+PEFsbG93U3RhcnRPbkRlbWFuZD5mYWxzZTwvQWxsb3dTdGFydE9uRGVtYW5kPjxFbmFibGVkPnRydWU8L0VuYWJsZWQ+PEhpZGRlbj50cnVlPC9IaWRkZW4+PEV4ZWN1dGlvblRpbWVMaW1pdD5QVDBTPC9FeGVjdXRpb25UaW1lTGltaXQ+PFByaW9yaXR5Pjc8L1ByaW9yaXR5PjxEZWxldGVFeHBpcmVkVGFza0FmdGVyPlBUMFM8L0RlbGV0ZUV4cGlyZWRUYXNrQWZ0ZXI+PFJlc3RhcnRPbkZhaWx1cmU+PEludGVydmFsPlBUMTVNPC9JbnRlcnZhbD48Q291bnQ+MzwvQ291bnQ+PC9SZXN0YXJ0T25GYWlsdXJlPjwvU2V0dGluZ3M+PEFjdGlvbnMgQ29udGV4dD0iQXV0aG9yIj48RXhlYz48Q29tbWFuZD4nKyRDb21tYW5kKyc8L0NvbW1hbmQ+PEFyZ3VtZW50cz4nKyRDb21tYW5kQXJndW1lbnRzKyc8L0FyZ3VtZW50cz48L0V4ZWM+PC9BY3Rpb25zPjxUcmlnZ2Vycz48VGltZVRyaWdnZXI+PFN0YXJ0Qm91bmRhcnk+JUxvY2FsVGltZVhtbEV4JTwvU3RhcnRCb3VuZGFyeT48RW5kQm91bmRhcnk+JUxvY2FsVGltZVhtbEV4JTwvRW5kQm91bmRhcnk+PEVuYWJsZWQ+dHJ1ZTwvRW5hYmxlZD48L1RpbWVUcmlnZ2VyPjwvVHJpZ2dlcnM+PC9UYXNrPjwvUHJvcGVydGllcz48L0ltbWVkaWF0ZVRhc2tWMj48L1NjaGVkdWxlZFRhc2tzPicKCiAgICBpZiAoISRQU0JvdW5kUGFyYW1ldGVyc1snR1BPbmFtZSddIC1hbmQgISRQU0JvdW5kUGFyYW1ldGVyc1snR1BPRGlzcGxheU5hbWUnXSkgewogICAgICAgIFdyaXRlLVdhcm5pbmcgJ0VpdGhlciAtR1BPTmFtZSBvciAtR1BPRGlzcGxheU5hbWUgbXVzdCBiZSBzcGVjaWZpZWQnCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgIyBldW5tZXJhdGUgdGhlIHNwZWNpZmllZCBHUE8ocykKICAgICRHUE9zID0gR2V0LU5ldEdQTyAtR1BPbmFtZSAkR1BPbmFtZSAtRGlzcGxheU5hbWUgJEdQT0Rpc3BsYXlOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAKICAgIAogICAgaWYoISRHUE9zKSB7CiAgICAgICAgV3JpdGUtV2FybmluZyAnTm8gR1BPIGZvdW5kLicKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAkR1BPcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAkUHJvY2Vzc2VkR1BPTmFtZSA9ICRfLk5hbWUKICAgICAgICB0cnkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJUcnlpbmcgdG8gd2VhcG9uaXplIEdQTzogJFByb2Nlc3NlZEdQT05hbWUiCgogICAgICAgICAgICAjIG1hcCBhIG5ldHdvcmsgZHJpdmUgYXMgTmV3LVBTRHJpdmUvTmV3LUl0ZW0vZXRjLiBkb24ndCBhY2NlcHQgLUNyZWRlbnRpYWwgcHJvcGVybHkgOigKICAgICAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIk1hcHBpbmcgJyQoJF8uZ3BjZmlsZXN5c3BhdGgpJyB0byBuZXR3b3JrIGRyaXZlIE46XCIKICAgICAgICAgICAgICAgICRQYXRoID0gJF8uZ3BjZmlsZXN5c3BhdGguVHJpbUVuZCgnXCcpCiAgICAgICAgICAgICAgICAkTmV0ID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuTmV0d29yawogICAgICAgICAgICAgICAgJE5ldC5NYXBOZXR3b3JrRHJpdmUoIk46IiwgJFBhdGgsICRGYWxzZSwgJENyZWRlbnRpYWwuVXNlck5hbWUsICRDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuUGFzc3dvcmQpCiAgICAgICAgICAgICAgICAkVGFza1BhdGggPSAiTjpcTWFjaGluZVxQcmVmZXJlbmNlc1xTY2hlZHVsZWRUYXNrc1wiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkVGFza1BhdGggPSAkXy5ncGNmaWxlc3lzcGF0aCArICJcTWFjaGluZVxQcmVmZXJlbmNlc1xTY2hlZHVsZWRUYXNrc1wiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCRSZW1vdmUpIHsKICAgICAgICAgICAgICAgIGlmKCEoVGVzdC1QYXRoICIkVGFza1BhdGhcU2NoZWR1bGVkVGFza3MueG1sIikpIHsKICAgICAgICAgICAgICAgICAgICBUaHJvdyAiU2NoZWR1bGVkIHRhc2sgZG9lc24ndCBleGlzdCBhdCAkVGFza1BhdGhcU2NoZWR1bGVkVGFza3MueG1sIgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghJEZvcmNlIC1hbmQgISRwc0NtZGxldC5TaG91bGRDb250aW51ZSgnRG8geW91IHdhbnQgdG8gY29udGludWU/JywiUmVtb3Zpbmcgc2NodGFzayBhdCAkVGFza1BhdGhcU2NoZWR1bGVkVGFza3MueG1sIikpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAiJFRhc2tQYXRoXFNjaGVkdWxlZFRhc2tzLnhtbCIgLUZvcmNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoISRGb3JjZSAtYW5kICEkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoJ0RvIHlvdSB3YW50IHRvIGNvbnRpbnVlPycsIkNyZWF0aW5nIHNjaHRhc2sgYXQgJFRhc2tQYXRoXFNjaGVkdWxlZFRhc2tzLnhtbCIpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgY3JlYXRlIHRoZSBmb2xkZXIgaWYgaXQgZG9lc24ndCBleGlzdAogICAgICAgICAgICAgICAgJE51bGwgPSBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSAtUGF0aCAkVGFza1BhdGgKCiAgICAgICAgICAgICAgICBpZihUZXN0LVBhdGggIiRUYXNrUGF0aFxTY2hlZHVsZWRUYXNrcy54bWwiKSB7CiAgICAgICAgICAgICAgICAgICAgVGhyb3cgIlNjaGVkdWxlZCB0YXNrIGFscmVhZHkgZXhpc3RzIGF0ICRUYXNrUGF0aFxTY2hlZHVsZWRUYXNrcy54bWwgISIKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkVGFza1hNTCB8IFNldC1Db250ZW50IC1FbmNvZGluZyBBU0NJSSAtUGF0aCAiJFRhc2tQYXRoXFNjaGVkdWxlZFRhc2tzLnhtbCIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlbW92aW5nIG1vdW50ZWQgZHJpdmUgYXQgTjpcIgogICAgICAgICAgICAgICAgJE5ldCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCBXU2NyaXB0Lk5ldHdvcmsKICAgICAgICAgICAgICAgICROZXQuUmVtb3ZlTmV0d29ya0RyaXZlKCJOOiIpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBmb3IgR1BPICRQcm9jZXNzZWRHUE9OYW1lIDogJF8iCiAgICAgICAgICAgIGlmKCRDcmVkZW50aWFsKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJSZW1vdmluZyBtb3VudGVkIGRyaXZlIGF0IE46XCIKICAgICAgICAgICAgICAgICROZXQgPSBOZXctT2JqZWN0IC1Db21PYmplY3QgV1NjcmlwdC5OZXR3b3JrCiAgICAgICAgICAgICAgICAkTmV0LlJlbW92ZU5ldHdvcmtEcml2ZSgiTjoiKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldEdQT0dyb3VwIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGFsbCBHUE9zIGluIGEgZG9tYWluIHRoYXQgc2V0ICJSZXN0cmljdGVkIEdyb3VwcyIKICAgICAgICBvciB1c2UgZ3JvdXBzLnhtbCBvbiBvbiB0YXJnZXQgbWFjaGluZXMuCgogICAgLlBBUkFNRVRFUiBHUE9uYW1lCgogICAgICAgIFRoZSBHUE8gbmFtZSB0byBxdWVyeSBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4gICAKCiAgICAuUEFSQU1FVEVSIERpc3BsYXlOYW1lCgogICAgICAgIFRoZSBHUE8gZGlzcGxheSBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLiAgIAoKICAgIC5QQVJBTUVURVIgUmVzb2x2ZVNpZHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIFNpZHMgZnJvbSBhIERDIHBvbGljeSB0byBvYmplY3QgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgR1BPcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gKICAgICAgICBlLmcuICJMREFQOi8vY249ezhGRjU5RDI4LTE1RDctNDIyQS1CQ0I3LTJBRTQ1NzI0MTI1QX0sY249cG9saWNpZXMsY249c3lzdGVtLERDPWRldixEQz10ZXN0bGFiLERDPWxvY2FsIgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5QQVJBTUVURVIgVXNlUFNEcml2ZQoKICAgICAgICBTd2l0Y2guIE1vdW50IGFueSBmb3VuZCBwb2xpY3kgZmlsZXMgd2l0aCB0ZW1wb3JhcnkgUFNEcml2ZXMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0R1BPR3JvdXAKCiAgICAgICAgR2V0IGFsbCBHUE9zIHRoYXQgc2V0IGxvY2FsIGdyb3VwcyBvbiB0aGUgY3VycmVudCBkb21haW4uCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHUE9uYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREaXNwbGF5TmFtZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVzb2x2ZVNpZHMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgIyBnZXQgZXZlcnkgR1BPIGZyb20gdGhlIHNwZWNpZmllZCBkb21haW4gd2l0aCByZXN0cmljdGVkIGdyb3VwcyBzZXQKICAgIEdldC1OZXRHUE8gLUdQT05hbWUgJEdQT25hbWUgLURpc3BsYXlOYW1lICRHUE9uYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgewoKICAgICAgICAkTWVtYmVyb2YgPSAkTnVsbAogICAgICAgICRNZW1iZXJzID0gJE51bGwKICAgICAgICAkR1BPZGlzcGxheU5hbWUgPSAkXy5kaXNwbGF5bmFtZQogICAgICAgICRHUE9uYW1lID0gJF8ubmFtZQogICAgICAgICRHUE9QYXRoID0gJF8uZ3BjZmlsZXN5c3BhdGgKCiAgICAgICAgJFBhcnNlQXJncyA9ICBAewogICAgICAgICAgICAnR3B0VG1wbFBhdGgnID0gIiRHUE9QYXRoXE1BQ0hJTkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcU2VjRWRpdFxHcHRUbXBsLmluZiIKICAgICAgICAgICAgJ1VzZVBTRHJpdmUnID0gJFVzZVBTRHJpdmUKICAgICAgICB9CgogICAgICAgICMgcGFyc2UgdGhlIEdwdFRtcGwuaW5mICdSZXN0cmljdGVkIEdyb3VwcycgZmlsZSBpZiBpdCBleGlzdHMKICAgICAgICAkSW5mID0gR2V0LUdwdFRtcGwgQFBhcnNlQXJncwoKICAgICAgICBpZigkSW5mLkdyb3VwTWVtYmVyc2hpcCkgewoKICAgICAgICAgICAgJE1lbWJlcm9mID0gJEluZi5Hcm91cE1lbWJlcnNoaXAgfCBHZXQtTWVtYmVyICpNZW1iZXJvZiB8IEZvckVhY2gtT2JqZWN0IHsgJEluZi5Hcm91cE1lbWJlcnNoaXAuKCRfLm5hbWUpIH0gfCBGb3JFYWNoLU9iamVjdCB7ICRfLnRyaW0oJyonKSB9CiAgICAgICAgICAgICRNZW1iZXJzID0gJEluZi5Hcm91cE1lbWJlcnNoaXAgfCBHZXQtTWVtYmVyICpNZW1iZXJzIHwgRm9yRWFjaC1PYmplY3QgeyAkSW5mLkdyb3VwTWVtYmVyc2hpcC4oJF8ubmFtZSkgfSB8IEZvckVhY2gtT2JqZWN0IHsgJF8udHJpbSgnKicpIH0KCiAgICAgICAgICAgIGlmKCEkTWVtYmVycykgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAkTWVtYmVyc1JhdyA9ICRJbmYuR3JvdXBNZW1iZXJzaGlwIHwgR2V0LU1lbWJlciAqTWVtYmVycyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IE5hbWUKICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9ICgkTWVtYmVyc1JhdyAtc3BsaXQgIl9fIilbMF0udHJpbSgiKiIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnNSYXcgPSAnJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZighJE1lbWJlcm9mKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICRNZW1iZXJvZlJhdyA9ICRJbmYuR3JvdXBNZW1iZXJzaGlwIHwgR2V0LU1lbWJlciAqTWVtYmVyb2YgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCiAgICAgICAgICAgICAgICAgICAgJE1lbWJlcm9mID0gKCRNZW1iZXJvZlJhdyAtc3BsaXQgIl9fIilbMF0udHJpbSgiKiIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgJE1lbWJlcm9mID0gJycKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoJFJlc29sdmVTaWRzKSB7CiAgICAgICAgICAgICAgICAkTWVtYmVyb2YgPSAkTWVtYmVyb2YgfCBGb3JFYWNoLU9iamVjdCB7IENvbnZlcnQtU2lkVG9OYW1lICRfIH0KICAgICAgICAgICAgICAgICRNZW1iZXJzID0gJE1lbWJlcnMgfCBGb3JFYWNoLU9iamVjdCB7IENvbnZlcnQtU2lkVG9OYW1lICRfIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoJE1lbWJlcm9mIC1pc25vdCBbU3lzdGVtLkFycmF5XSkgeyRNZW1iZXJvZiA9IEAoJE1lbWJlcm9mKX0KICAgICAgICAgICAgaWYoJE1lbWJlcnMgLWlzbm90IFtTeXN0ZW0uQXJyYXldKSB7JE1lbWJlcnMgPSBAKCRNZW1iZXJzKX0KCiAgICAgICAgICAgICRHUE9Qcm9wZXJ0aWVzID0gQHsKICAgICAgICAgICAgICAgICdHUE9EaXNwbGF5TmFtZScgPSAkR1BPRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICdHUE9OYW1lJyA9ICRHUE9OYW1lCiAgICAgICAgICAgICAgICAnR1BPUGF0aCcgPSAkR1BPUGF0aAogICAgICAgICAgICAgICAgJ0ZpbHRlcnMnID0gJE51bGwKICAgICAgICAgICAgICAgICdNZW1iZXJPZicgPSAkTWVtYmVyb2YKICAgICAgICAgICAgICAgICdNZW1iZXJzJyA9ICRNZW1iZXJzCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkR1BPUHJvcGVydGllcwogICAgICAgIH0KCiAgICAgICAgJFBhcnNlQXJncyA9ICBAewogICAgICAgICAgICAnR3JvdXBzWE1McGF0aCcgPSAiJEdQT1BhdGhcTUFDSElORVxQcmVmZXJlbmNlc1xHcm91cHNcR3JvdXBzLnhtbCIKICAgICAgICAgICAgJ1Jlc29sdmVTaWRzJyA9ICRSZXNvbHZlU2lkcwogICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgIH0KCiAgICAgICAgR2V0LUdyb3Vwc1hNTCBAUGFyc2VBcmdzCiAgICB9Cn0KCgpmdW5jdGlvbiBGaW5kLUdQT0xvY2F0aW9uIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUYWtlcyBhIHVzZXIvZ3JvdXAgbmFtZSBhbmQgb3B0aW9uYWwgZG9tYWluLCBhbmQgZGV0ZXJtaW5lcyAKICAgICAgICB0aGUgY29tcHV0ZXJzIGluIHRoZSBkb21haW4gdGhlIHVzZXIvZ3JvdXAgaGFzIGxvY2FsIGFkbWluIAogICAgICAgIChvciBSRFApIHJpZ2h0cyB0by4KCiAgICAgICAgSXQgZG9lcyB0aGlzIGJ5OgogICAgICAgICAgICAxLiAgcmVzb2x2aW5nIHRoZSB1c2VyL2dyb3VwIHRvIGl0cyBwcm9wZXIgc2lkCiAgICAgICAgICAgIDIuICBlbnVtZXJhdGluZyBhbGwgZ3JvdXBzIHRoZSB1c2VyL2dyb3VwIGlzIGEgY3VycmVudCBwYXJ0IG9mIAogICAgICAgICAgICAgICAgYW5kIGV4dHJhY3RpbmcgYWxsIHRhcmdldCBTSURzIHRvIGJ1aWxkIGEgdGFyZ2V0IFNJRCBsaXN0CiAgICAgICAgICAgIDMuICBwdWxsaW5nIGFsbCBHUE9zIHRoYXQgc2V0ICdSZXN0cmljdGVkIEdyb3VwcycgYnkgY2FsbGluZwogICAgICAgICAgICAgICAgR2V0LU5ldEdQT0dyb3VwCiAgICAgICAgICAgIDQuICBtYXRjaGluZyB0aGUgdGFyZ2V0IHNpZCBsaXN0IHRvIHRoZSBxdWVyaWVkIEdQTyBTSUQgbGlzdAogICAgICAgICAgICAgICAgdG8gZW51bWVyYXRlIGFsbCBHUE8gdGhlIHVzZXIgaXMgZWZmZWN0aXZlbHkgYXBwbGllZCB3aXRoCiAgICAgICAgICAgIDUuICBlbnVtZXJhdGluZyBhbGwgT1VzIGFuZCBzaXRlcyBhbmQgYXBwbGljYWJsZSBHUE8gR1VJcyBhcmUKICAgICAgICAgICAgICAgIGFwcGxpZWQgdG8gdGhyb3VnaCBncGxpbmsgZW51bWVyYXRpbmcKICAgICAgICAgICAgNi4gIHF1ZXJ5aW5nIGZvciBhbGwgY29tcHV0ZXJzIHVuZGVyIHRoZSBnaXZlbiBPVXMgb3Igc2l0ZXMKCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIEEgKHNpbmdsZSkgdXNlciBuYW1lIG5hbWUgdG8gcXVlcnkgZm9yIGFjY2Vzcy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBBIChzaW5nbGUpIGdyb3VwIG5hbWUgbmFtZSB0byBxdWVyeSBmb3IgYWNjZXNzLiAKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBPcHRpb25hbCBkb21haW4gdGhlIHVzZXIgZXhpc3RzIGluIGZvciBxdWVyeWluZywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTG9jYWxHcm91cAoKICAgICAgICBUaGUgbG9jYWwgZ3JvdXAgdG8gY2hlY2sgYWNjZXNzIGFnYWluc3QuCiAgICAgICAgQ2FuIGJlICJBZG1pbmlzdHJhdG9ycyIgKFMtMS01LTMyLTU0NCksICJSRFAvUmVtb3RlIERlc2t0b3AgVXNlcnMiIChTLTEtNS0zMi01NTUpLAogICAgICAgIG9yIGEgY3VzdG9tIGxvY2FsIFNJRC4gRGVmYXVsdHMgdG8gbG9jYWwgJ0FkbWluaXN0cmF0b3JzJy4KCiAgICAuUEFSQU1FVEVSIFVzZVBTRHJpdmUKCiAgICAgICAgU3dpdGNoLiBNb3VudCBhbnkgZm91bmQgcG9saWN5IGZpbGVzIHdpdGggdGVtcG9yYXJ5IFBTRHJpdmVzLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1HUE9Mb2NhdGlvbiAtVXNlck5hbWUgZGZtCiAgICAgICAgCiAgICAgICAgRmluZCBhbGwgY29tcHV0ZXJzIHRoYXQgZGZtIHVzZXIgaGFzIGxvY2FsIGFkbWluaXN0cmF0b3IgcmlnaHRzIHRvIGluIAogICAgICAgIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtR1BPTG9jYXRpb24gLVVzZXJOYW1lIGRmbSAtRG9tYWluIGRldi50ZXN0bGFiLmxvY2FsCiAgICAgICAgCiAgICAgICAgRmluZCBhbGwgY29tcHV0ZXJzIHRoYXQgZGZtIHVzZXIgaGFzIGxvY2FsIGFkbWluaXN0cmF0b3IgcmlnaHRzIHRvIGluIAogICAgICAgIHRoZSBkZXYudGVzdGxhYi5sb2NhbCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUdQT0xvY2F0aW9uIC1Vc2VyTmFtZSBqYXNvbiAtTG9jYWxHcm91cCBSRFAKICAgICAgICAKICAgICAgICBGaW5kIGFsbCBjb21wdXRlcnMgdGhhdCBqYXNvbiBoYXMgbG9jYWwgUkRQIGFjY2VzcyByaWdodHMgdG8gaW4gdGhlIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTG9jYWxHcm91cCA9ICdBZG1pbmlzdHJhdG9ycycsCiAgICAgICAgCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgaWYoJFVzZXJOYW1lKSB7CgogICAgICAgICRVc2VyID0gR2V0LU5ldFVzZXIgLVVzZXJOYW1lICRVc2VyTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICRVc2VyU2lkID0gJFVzZXIub2JqZWN0c2lkCgogICAgICAgIGlmKCEkVXNlclNpZCkgeyAgICAKICAgICAgICAgICAgVGhyb3cgIlVzZXIgJyRVc2VyTmFtZScgbm90IGZvdW5kISIKICAgICAgICB9CgogICAgICAgICRUYXJnZXRTaWQgPSAkVXNlclNpZAogICAgICAgICRPYmplY3RTYW1BY2NvdW50TmFtZSA9ICRVc2VyLnNhbWFjY291bnRuYW1lCiAgICAgICAgJFRhcmdldE9iamVjdHMgPSAkVXNlclNpZAogICAgfQogICAgZWxzZWlmKCRHcm91cE5hbWUpIHsKCiAgICAgICAgJEdyb3VwID0gR2V0LU5ldEdyb3VwIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAkR3JvdXBTaWQgPSAkR3JvdXAub2JqZWN0c2lkCgogICAgICAgIGlmKCEkR3JvdXBTaWQpIHsgICAgCiAgICAgICAgICAgIFRocm93ICJHcm91cCAnJEdyb3VwTmFtZScgbm90IGZvdW5kISIKICAgICAgICB9CgogICAgICAgICRUYXJnZXRTaWQgPSAkR3JvdXBTaWQKICAgICAgICAkT2JqZWN0U2FtQWNjb3VudE5hbWUgPSAkR3JvdXAuc2FtYWNjb3VudG5hbWUKICAgICAgICAkVGFyZ2V0T2JqZWN0cyA9ICRHcm91cFNpZAogICAgfQogICAgZWxzZSB7CiAgICAgICAgJFRhcmdldFNpZCA9ICcqJwogICAgfQoKICAgIGlmKCRMb2NhbEdyb3VwIC1saWtlICIqQWRtaW4qIikgewogICAgICAgICRMb2NhbFNJRCA9ICdTLTEtNS0zMi01NDQnCiAgICB9CiAgICBlbHNlaWYgKCAoJExvY2FsR3JvdXAgLWxpa2UgIipSRFAqIikgLW9yICgkTG9jYWxHcm91cCAtbGlrZSAiKlJlbW90ZSoiKSApIHsKICAgICAgICAkTG9jYWxTSUQgPSAnUy0xLTUtMzItNTU1JwogICAgfQogICAgZWxzZWlmICgkTG9jYWxHcm91cCAtbGlrZSAiUy0xLTUtKiIpIHsKICAgICAgICAkTG9jYWxTSUQgPSAkTG9jYWxHcm91cAogICAgfQogICAgZWxzZSB7CiAgICAgICAgdGhyb3cgIkxvY2FsR3JvdXAgbXVzdCBiZSAnQWRtaW5pc3RyYXRvcnMnLCAnUkRQJywgb3IgYSAnUy0xLTUtWCcgdHlwZSBzaWQuIgogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgIkxvY2FsU2lkOiAkTG9jYWxTSUQiCiAgICBXcml0ZS1WZXJib3NlICJUYXJnZXRTaWQ6ICRUYXJnZXRTaWQiCgogICAgaWYoJFRhcmdldFNpZCAtbmUgJyonKSB7CiAgICAgICAgaWYoJFRhcmdldFNpZCAtaXNub3QgW1N5c3RlbS5BcnJheV0pIHsgJFRhcmdldFNpZCA9IEAoJFRhcmdldFNpZCkgfQoKICAgICAgICAjIHVzZSB0aGUgdG9rZW5Hcm91cHMgYXBwcm9hY2ggZnJvbSBHZXQtTmV0R3JvdXAgdG8gZ2V0IGFsbCBlZmZlY3RpdmUKICAgICAgICAjICAgc2VjdXJpdHkgU0lEcyB0aGlzIG9iamVjdCBpcyBhIHBhcnQgb2YKICAgICAgICAkVGFyZ2V0U2lkICs9IEdldC1OZXRHcm91cCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZSAtVXNlck5hbWUgJE9iamVjdFNhbUFjY291bnROYW1lIC1SYXdTaWRzCgogICAgICAgIGlmKCRUYXJnZXRTaWQgLWlzbm90IFtTeXN0ZW0uQXJyYXldKSB7IFtTeXN0ZW0uQXJyYXldJFRhcmdldFNpZCA9IFtTeXN0ZW0uQXJyYXldQCgkVGFyZ2V0U2lkKSB9CiAgICB9CgogICAgV3JpdGUtVmVyYm9zZSAiRWZmZWN0aXZlIHRhcmdldCBzaWRzOiAkVGFyZ2V0U2lkIgoKICAgICRHUE9Hcm91cEFyZ3MgPSAgQHsKICAgICAgICAnRG9tYWluJyA9ICREb21haW4KICAgICAgICAnRG9tYWluQ29udHJvbGxlcicgPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgJ1BhZ2VTaXplJyA9ICRQYWdlU2l6ZQogICAgfQoKICAgICMgZ2V0IGFsbCBHUE8gZ3JvdXBzLCBhbmQgZmlsdGVyIG9uIG9uZXMgdGhhdCBtYXRjaCBvdXIgdGFyZ2V0IFNJRCBsaXN0CiAgICAjICAgYW5kIG1hdGNoIHRoZSB0YXJnZXQgbG9jYWwgc2lkIG1lbWJlcm9mIGxpc3QKICAgICRHUE9ncm91cHMgPSBHZXQtTmV0R1BPR3JvdXAgQEdQT0dyb3VwQXJncyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICBpZiAoJF8ubWVtYmVycykgewogICAgICAgICAgICAkXy5tZW1iZXJzID0gJF8ubWVtYmVycyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgaWYoJF8gLW1hdGNoICdeUy0xLS4qJykgewogICAgICAgICAgICAgICAgICAgICRfCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZXJlIGFyZSBhbnkgcGxhaW4gZ3JvdXAgbmFtZXMsIHRyeSB0byByZXNvbHZlIHRoZW0gdG8gc2lkcwogICAgICAgICAgICAgICAgICAgIChDb252ZXJ0LU5hbWVUb1NpZCAtT2JqZWN0TmFtZSAkXyAtRG9tYWluICREb21haW4pLlNJRAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZQoKICAgICAgICAgICAgIyBzdG9wIFBvd2VyU2hlbGwgMi4wJ3Mgc3RyaW5nIHN0dXBpZCB1bmJveGluZwogICAgICAgICAgICBpZigkXy5tZW1iZXJzIC1pc25vdCBbU3lzdGVtLkFycmF5XSkgeyAkXy5tZW1iZXJzID0gQCgkXy5tZW1iZXJzKSB9CiAgICAgICAgICAgIGlmKCRfLm1lbWJlcm9mIC1pc25vdCBbU3lzdGVtLkFycmF5XSkgeyAkXy5tZW1iZXJvZiA9IEAoJF8ubWVtYmVyb2YpIH0KCiAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIG1lbWJlcm9mIGNvbnRhaW5zIHRoZSBzaWQgb2YgdGhlIGxvY2FsIGFjY291bnQgd2UncmUgc2VhcmNoaW5nIGZvcgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJtZW1iZXJvZjogJCgkXy5tZW1iZXJvZikiCiAgICAgICAgICAgIGlmICgkXy5tZW1iZXJvZiAtY29udGFpbnMgJExvY2FsU2lkKSB7CiAgICAgICAgICAgICAgICAjIGNoZWNrIGlmIHRoZXJlJ3MgYW4gb3ZlcmxhcCBiZXR3ZWVuIHRoZSBtZW1iZXJzIGZpZWxkIGFuZCB0aGUgc2V0IG9mIHRhcmdldCBzaWRzCiAgICAgICAgICAgICAgICAjICAgaWYgJFRhcmdldFNpZCA9ICosIHRoZW4gcmV0dXJuIGFsbCByZXN1bHRzCiAgICAgICAgICAgICAgICBpZiAoICgkVGFyZ2V0U2lkIC1lcSAnKicpIC1vciAoJF8ubWVtYmVycyB8IFdoZXJlLU9iamVjdCB7JF99IHwgV2hlcmUtT2JqZWN0IHsgJFRhcmdldFNpZCAtQ29udGFpbnMgJF8gfSkpIHsKICAgICAgICAgICAgICAgICAgICAkXwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgICRQcm9jZXNzZWRHVUlEcyA9IEB7fQoKICAgICMgcHJvY2VzcyB0aGUgbWF0Y2hlcyBhbmQgYnVpbGQgdGhlIHJlc3VsdCBvYmplY3RzCiAgICAkR1BPZ3JvdXBzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICRHUE9ndWlkID0gJF8uR1BPTmFtZQogICAgICAgICRHUE9NZW1iZXJzID0gJF8uTWVtYmVycwoKICAgICAgICBpZighJFRhcmdldE9iamVjdHMpIHsKICAgICAgICAgICAgIyBpZiB0aGUgKiB3aWxkY2FyZCB3YXMgdXNlZCwgc2V0IHRoZSBPYmplY3REaXN0TmFtZSBhcyB0aGUgR1BPIG1lbWJlciBzaWQgc2V0CiAgICAgICAgICAgICRUYXJnZXRPYmplY3RzID0gJEdQT01lbWJlcnMKICAgICAgICB9CgogICAgICAgIGlmKCAtbm90ICRQcm9jZXNzZWRHVUlEc1skR1BPZ3VpZF0gKSB7CiAgICAgICAgICAgICRHUE9uYW1lID0gJF8uR1BPRGlzcGxheU5hbWUKICAgICAgICAgICAgJEZpbHRlcnMgPSAkXy5GaWx0ZXJzCgogICAgICAgICAgICAjIGZpbmQgYW55IE9VcyB0aGF0IGhhdmUgdGhpcyBHVUlEIGFwcGxpZWQgYW5kIHRoZW4gcmV0cmlldmUgYW55IGNvbXB1dGVycyBmcm9tIHRoZSBPVQogICAgICAgICAgICBHZXQtTmV0T1UgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1HVUlEICRHUE9ndWlkIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgewoKICAgICAgICAgICAgICAgIGlmKCRGaWx0ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgIyBmaWx0ZXIgZm9yIGNvbXB1dGVyIG5hbWUvb3JnIHVuaXQgaWYgYSBmaWx0ZXIgaXMgc3BlY2lmaWVkCiAgICAgICAgICAgICAgICAgICAgIyAgIFRPRE86IGhhbmRsZSBvdGhlciBmaWx0ZXJzPwogICAgICAgICAgICAgICAgICAgICRPVUNvbXB1dGVycyA9IEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUFEU3BhdGggJF8uQURTcGF0aCAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLmFkc3BhdGggLW1hdGNoICgkRmlsdGVycy5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9IHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkT1VDb21wdXRlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1BRFNwYXRoICRfLkFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRUYXJnZXRTaWQgaW4gJFRhcmdldE9iamVjdHMpIHsKCiAgICAgICAgICAgICAgICAgICAgJE9iamVjdCA9IEdldC1BRE9iamVjdCAtU0lEICRUYXJnZXRTaWQgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyICRfIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgICAgICAgICAgICAgJElzR3JvdXAgPSBAKCcyNjg0MzU0NTYnLCcyNjg0MzU0NTcnLCc1MzY4NzA5MTInLCc1MzY4NzA5MTMnKSAtY29udGFpbnMgJE9iamVjdC5zYW1hY2NvdW50dHlwZQoKICAgICAgICAgICAgICAgICAgICAkR1BPTG9jYXRpb24gPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgJEdQT0xvY2F0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdE5hbWUnICRPYmplY3Quc2FtYWNjb3VudG5hbWUKICAgICAgICAgICAgICAgICAgICAkR1BPTG9jYXRpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0RE4nICRPYmplY3QuZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgICAgICAgICAkR1BPTG9jYXRpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0U0lEJyAkT2JqZWN0Lm9iamVjdHNpZAogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0dyb3VwJyAkSXNHcm91cAogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHUE9uYW1lJyAkR1BPbmFtZQogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHUE9ndWlkJyAkR1BPZ3VpZAogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb250YWluZXJOYW1lJyAkXy5kaXN0aW5ndWlzaGVkbmFtZQogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlcnMnICRPVUNvbXB1dGVycwogICAgICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGZpbmQgYW55IHNpdGVzIHRoYXQgaGF2ZSB0aGlzIEdVSUQgYXBwbGllZAogICAgICAgICAgICBHZXQtTmV0U2l0ZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUdVSUQgJEdQT2d1aWQgLVBhZ2VTaXplICRQYWdlU2l6ZSAtRnVsbERhdGEgfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgRm9yRWFjaCAoJFRhcmdldFNpZCBpbiAkVGFyZ2V0T2JqZWN0cykgewogICAgICAgICAgICAgICAgICAgICRPYmplY3QgPSBHZXQtQURPYmplY3QgLVNJRCAkVGFyZ2V0U2lkIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAkXyAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgICAgICAgICAgICAgICRJc0dyb3VwID0gQCgnMjY4NDM1NDU2JywnMjY4NDM1NDU3JywnNTM2ODcwOTEyJywnNTM2ODcwOTEzJykgLWNvbnRhaW5zICRPYmplY3Quc2FtYWNjb3VudHR5cGUKCiAgICAgICAgICAgICAgICAgICAgJEFwcGxpZWRTaXRlID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICRBcHBsaWVkU2l0ZSB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3ROYW1lJyAkT2JqZWN0LnNhbWFjY291bnRuYW1lCiAgICAgICAgICAgICAgICAgICAgJEFwcGxpZWRTaXRlIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdEROJyAkT2JqZWN0LmRpc3Rpbmd1aXNoZWRuYW1lCiAgICAgICAgICAgICAgICAgICAgJEFwcGxpZWRTaXRlIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdFNJRCcgJE9iamVjdC5vYmplY3RzaWQKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJElzR3JvdXAKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPbmFtZScgJEdQT25hbWUKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPZ3VpZCcgJEdQT2d1aWQKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29udGFpbmVyTmFtZScgJF8uZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJzJyAkXy5zaXRlb2JqZWN0YmwKICAgICAgICAgICAgICAgICAgICAkQXBwbGllZFNpdGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBtYXJrIG9mZiB0aGlzIEdQTyBHVUlEIHNvIHdlIGRvbid0IHByb2Nlc3MgaXQgYWdhaW4gaWYgdGhlcmUgYXJlIGR1cGVzCiAgICAgICAgICAgICRQcm9jZXNzZWRHVUlEc1skR1BPZ3VpZF0gPSAkVHJ1ZQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtR1BPQ29tcHV0ZXJBZG1pbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGFrZXMgYSBjb21wdXRlciAob3IgR1BPKSBvYmplY3QgYW5kIGRldGVybWluZXMgd2hhdCB1c2Vycy9ncm91cHMgaGF2ZSAKICAgICAgICBhZG1pbmlzdHJhdGl2ZSBhY2Nlc3Mgb3ZlciBpdC4KCiAgICAgICAgSW52ZXJzZSBvZiBGaW5kLUdQT0xvY2F0aW9uLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBjb21wdXRlciB0byBkZXRlcm1pbmUgbG9jYWwgYWRtaW5pc3RyYXRpdmUgYWNjZXNzIHRvLgoKICAgIC5QQVJBTUVURVIgT1VOYW1lCgogICAgICAgIE9VIG5hbWUgdG8gZGV0ZXJtaW5lIHdobyBoYXMgbG9jYWwgYWRtaW5pc3J0YXRpdmUgYWNlc3MgdG8gY29tcHV0ZXJzCiAgICAgICAgd2l0aGluIGl0LiAKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBPcHRpb25hbCBkb21haW4gdGhlIGNvbXB1dGVyL09VIGV4aXN0cyBpbiwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUmVjdXJzZQoKICAgICAgICBTd2l0Y2guIElmIGEgcmV0dXJuZWQgbWVtYmVyIGlzIGEgZ3JvdXAsIHJlY3Vyc2UgYW5kIGdldCBhbGwgbWVtYmVycy4KCiAgICAuUEFSQU1FVEVSIExvY2FsR3JvdXAKCiAgICAgICAgVGhlIGxvY2FsIGdyb3VwIHRvIGNoZWNrIGFjY2VzcyBhZ2FpbnN0LgogICAgICAgIENhbiBiZSAiQWRtaW5pc3RyYXRvcnMiIChTLTEtNS0zMi01NDQpLCAiUkRQL1JlbW90ZSBEZXNrdG9wIFVzZXJzIiAoUy0xLTUtMzItNTU1KSwKICAgICAgICBvciBhIGN1c3RvbSBsb2NhbCBTSUQuCiAgICAgICAgRGVmYXVsdHMgdG8gbG9jYWwgJ0FkbWluaXN0cmF0b3JzJy4KCiAgICAuUEFSQU1FVEVSIFVzZVBTRHJpdmUKCiAgICAgICAgU3dpdGNoLiBNb3VudCBhbnkgZm91bmQgcG9saWN5IGZpbGVzIHdpdGggdGVtcG9yYXJ5IFBTRHJpdmVzLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1HUE9Db21wdXRlckFkbWluIC1Db21wdXRlck5hbWUgV0lORE9XUzMuZGV2LnRlc3RsYWIubG9jYWwKICAgICAgICAKICAgICAgICBGaW5kcyB1c2VycyB3aG8gaGF2ZSBsb2NhbCBhZG1pbiByaWdodHMgb3ZlciBXSU5ET1dTMyB0aHJvdWdoIEdQTyBjb3JyZWxhdGlvbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtR1BPQ29tcHV0ZXJBZG1pbiAtQ29tcHV0ZXJOYW1lIFdJTkRPV1MzLmRldi50ZXN0bGFiLmxvY2FsIC1Mb2NhbEdyb3VwIFJEUAogICAgICAgIAogICAgICAgIEZpbmRzIHVzZXJzIHdobyBoYXZlIFJEUCByaWdodHMgb3ZlciBXSU5ET1dTMyB0aHJvdWdoIEdQTyBjb3JyZWxhdGlvbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkT1VOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlY3Vyc2UsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExvY2FsR3JvdXAgPSAnQWRtaW5pc3RyYXRvcnMnLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBwcm9jZXNzIHsKICAgIAogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lIC1hbmQgISRPVU5hbWUpIHsKICAgICAgICAgICAgVGhyb3cgIi1Db21wdXRlck5hbWUgb3IgLU9VTmFtZSBtdXN0IGJlIHByb3ZpZGVkIgogICAgICAgIH0KCiAgICAgICAgJEdQT0dyb3VwcyA9IEAoKQoKICAgICAgICBpZigkQ29tcHV0ZXJOYW1lKSB7CiAgICAgICAgICAgICRDb21wdXRlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZQoKICAgICAgICAgICAgaWYoISRDb21wdXRlcnMpIHsKICAgICAgICAgICAgICAgIHRocm93ICJDb21wdXRlciAkQ29tcHV0ZXJOYW1lIGluIGRvbWFpbiAnJERvbWFpbicgbm90IGZvdW5kISBUcnkgYSBmdWxseSBxdWFsaWZpZWQgaG9zdCBuYW1lIgogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAkVGFyZ2V0T1VzID0gQCgpCiAgICAgICAgICAgIEZvckVhY2goJENvbXB1dGVyIGluICRDb21wdXRlcnMpIHsKICAgICAgICAgICAgICAgICMgZXh0cmFjdCBhbGwgT1VzIGEgY29tcHV0ZXIgaXMgYSBwYXJ0IG9mCiAgICAgICAgICAgICAgICAkRE4gPSAkQ29tcHV0ZXIuZGlzdGluZ3Vpc2hlZG5hbWUKCiAgICAgICAgICAgICAgICAkVGFyZ2V0T1VzICs9ICRETi5zcGxpdCgiLCIpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmKCRfLnN0YXJ0c3dpdGgoIk9VPSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRETi5zdWJzdHJpbmcoJEROLmluZGV4b2YoJF8pKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBlbnVtZXJhdGUgYW55IGxpbmtlZCBHUE9zIGZvciB0aGUgY29tcHV0ZXIncyBzaXRlCiAgICAgICAgICAgICRDb21wdXRlclNpdGUgPSAoR2V0LVNpdGVOYW1lIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSkuU2l0ZU5hbWUKICAgICAgICAgICAgaWYoJENvbXB1dGVyU2l0ZSAtYW5kICgkQ29tcHV0ZXJTaXRlIC1uZSAnRVJST1InKSkgewogICAgICAgICAgICAgICAgJEdQT0dyb3VwcyArPSBHZXQtTmV0U2l0ZSAtU2l0ZU5hbWUgJENvbXB1dGVyU2l0ZSAtRnVsbERhdGEgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYoJF8uZ3BsaW5rKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLmdwbGluay5zcGxpdCgiXVsiKSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkXy5zdGFydHN3aXRoKCJMREFQIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5zcGxpdCgiOyIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRHUE9Hcm91cEFyZ3MgPSAgQHsKICAgICAgICAgICAgICAgICAgICAgICAgJ0RvbWFpbicgPSAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICdEb21haW5Db250cm9sbGVyJyA9ICREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgICAgICAgICAgICAgICdBRFNwYXRoJyA9ICRfCiAgICAgICAgICAgICAgICAgICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgICAgICAgICAgICAgICAgICdQYWdlU2l6ZScgPSAkUGFnZVNpemUKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICMgZm9yIGVhY2ggR1BPIGxpbmssIGdldCBhbnkgbG9jYWxseSBzZXQgdXNlci9ncm91cCBTSURzCiAgICAgICAgICAgICAgICAgICAgR2V0LU5ldEdQT0dyb3VwIEBHUE9Hcm91cEFyZ3MKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJFRhcmdldE9VcyA9IEAoJE9VTmFtZSkKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRhcmdldCBPVXM6ICRUYXJnZXRPVXMiCgogICAgICAgICRUYXJnZXRPVXMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICMgZm9yIGVhY2ggT1UgdGhlIGNvbXB1dGVyIGlzIGEgcGFydCBvZiwgZ2V0IHRoZSBmdWxsIE9VIG9iamVjdAogICAgICAgICAgICAkR1BPZ3JvdXBzICs9IEdldC1OZXRPVSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJF8gLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JFYWNoLU9iamVjdCB7IAogICAgICAgICAgICAgICAgIyBhbmQgdGhlbiBnZXQgYW55IEdQTyBsaW5rcwogICAgICAgICAgICAgICAgaWYoJF8uZ3BsaW5rKSB7CiAgICAgICAgICAgICAgICAgICAgJF8uZ3BsaW5rLnNwbGl0KCJdWyIpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF8uc3RhcnRzd2l0aCgiTERBUCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5zcGxpdCgiOyIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAkR1BPR3JvdXBBcmdzID0gIEB7CiAgICAgICAgICAgICAgICAgICAgJ0RvbWFpbicgPSAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgJ0RvbWFpbkNvbnRyb2xsZXInID0gJERvbWFpbkNvbnRyb2xsZXIKICAgICAgICAgICAgICAgICAgICAnQURTcGF0aCcgPSAkXwogICAgICAgICAgICAgICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgICAgICAgICAgICAgJ1BhZ2VTaXplJyA9ICRQYWdlU2l6ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICMgZm9yIGVhY2ggR1BPIGxpbmssIGdldCBhbnkgbG9jYWxseSBzZXQgdXNlci9ncm91cCBTSURzCiAgICAgICAgICAgICAgICBHZXQtTmV0R1BPR3JvdXAgQEdQT0dyb3VwQXJncwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGZvciBlYWNoIGZvdW5kIEdQTyBncm91cCwgcmVzb2x2ZSB0aGUgU0lEcyBvZiB0aGUgbWVtYmVycwogICAgICAgICRHUE9ncm91cHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgJEdQTyA9ICRfCgogICAgICAgICAgICBpZiAoJEdQTy5tZW1iZXJzKSB7CiAgICAgICAgICAgICAgICAkR1BPLm1lbWJlcnMgPSAkR1BPLm1lbWJlcnMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICBpZigkXyAtbWF0Y2ggJ15TLTEtLionKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZXJlIGFyZSBhbnkgcGxhaW4gZ3JvdXAgbmFtZXMsIHRyeSB0byByZXNvbHZlIHRoZW0gdG8gc2lkcwogICAgICAgICAgICAgICAgICAgICAgICAoQ29udmVydC1OYW1lVG9TaWQgLU9iamVjdE5hbWUgJF8gLURvbWFpbiAkRG9tYWluKS5TSUQKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZQogICAgICAgICAgICB9CgogICAgICAgICAgICAkR1BPLm1lbWJlcnMgfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgIyByZXNvbHZlIHRoaXMgU0lEIHRvIGEgZG9tYWluIG9iamVjdAogICAgICAgICAgICAgICAgJE9iamVjdCA9IEdldC1BRE9iamVjdCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZSAtU0lEICRfCgogICAgICAgICAgICAgICAgJElzR3JvdXAgPSBAKCcyNjg0MzU0NTYnLCcyNjg0MzU0NTcnLCc1MzY4NzA5MTInLCc1MzY4NzA5MTMnKSAtY29udGFpbnMgJE9iamVjdC5zYW1hY2NvdW50dHlwZQoKICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHUE9EaXNwbGF5TmFtZScgJEdQTy5HUE9EaXNwbGF5TmFtZQogICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPUGF0aCcgJEdQTy5HUE9QYXRoCiAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3ROYW1lJyAkT2JqZWN0LnNhbWFjY291bnRuYW1lCiAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3RETicgJE9iamVjdC5kaXN0aW5ndWlzaGVkbmFtZQogICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0U0lEJyAkXwogICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJElzR3JvdXAKICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIAoKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgcmVjdXJzaW5nIGFuZCB0aGUgY3VycmVudCByZXN1bHQgb2JqZWN0IGlzIGEgZ3JvdXAKICAgICAgICAgICAgICAgIGlmKCRSZWN1cnNlIC1hbmQgJEdQT0NvbXB1dGVyQWRtaW4uaXNHcm91cCkgewoKICAgICAgICAgICAgICAgICAgICBHZXQtTmV0R3JvdXBNZW1iZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1TSUQgJF8gLUZ1bGxEYXRhIC1SZWN1cnNlIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRE4gPSAkXy5kaXN0aW5ndWlzaGVkTmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBleHRyYWN0IHRoZSBGUUROIGZyb20gdGhlIERpc3Rpbmd1aXNoZWQgTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRG9tYWluID0gJE1lbWJlckROLnN1YlN0cmluZygkTWVtYmVyRE4uSW5kZXhPZigiREM9IikpIC1yZXBsYWNlICdEQz0nLCcnIC1yZXBsYWNlICcsJywnLicKCiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJJc0dyb3VwID0gQCgnMjY4NDM1NDU2JywnMjY4NDM1NDU3JywnNTM2ODcwOTEyJywnNTM2ODcwOTEzJykgLWNvbnRhaW5zICRfLnNhbWFjY291bnR0eXBlCgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF8uc2FtQWNjb3VudE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgZm9yZXN0IHVzZXJzIGhhdmUgdGhlIHNhbUFjY291bnROYW1lIHNldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSAkXy5zYW1BY2NvdW50TmFtZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBleHRlcm5hbCB0cnVzdCB1c2VycyBoYXZlIGEgU0lELCBzbyBjb252ZXJ0IGl0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gQ29udmVydC1TaWRUb05hbWUgJF8uY24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZXJlJ3MgYSBwcm9ibGVtIGNvbnRhY3RpbmcgdGhlIGRvbWFpbiB0byByZXNvbHZlIHRoZSBTSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyTmFtZSA9ICRfLmNuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPRGlzcGxheU5hbWUnICRHUE8uR1BPRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPUGF0aCcgJEdQTy5HUE9QYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdE5hbWUnICRNZW1iZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdEROJyAkTWVtYmVyRE4KICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0U0lEJyAkXy5vYmplY3RzaWQKICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJE1lbWJlcklzR3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LURvbWFpblBvbGljeSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJucyB0aGUgZGVmYXVsdCBkb21haW4gb3IgREMgcG9saWN5IGZvciBhIGdpdmVuCiAgICAgICAgZG9tYWluIG9yIGRvbWFpbiBjb250cm9sbGVyLgoKICAgICAgICBUaGFua3MgU2VhbiBNZXRhY2FsZiAoQHB5cm90ZWszKSBmb3IgdGhlIGlkZWEgYW5kIGd1aWRhbmNlLgoKICAgIC5QQVJBTUVURVIgU291cmNlCgogICAgICAgIEV4dHJhY3QgRG9tYWluIG9yIERDIChkb21haW4gY29udHJvbGxlcikgcG9saWNpZXMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgZGVmYXVsdCBwb2xpY2llcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUmVzb2x2ZVNpZHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIFNpZHMgZnJvbSBhIERDIHBvbGljeSB0byBvYmplY3QgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgYW55IGZvdW5kIHBvbGljeSBmaWxlcyB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5Qb2xpY3kKCiAgICAgICAgUmV0dXJucyB0aGUgZG9tYWluIHBvbGljeSBmb3IgdGhlIGN1cnJlbnQgZG9tYWluLiAKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5Qb2xpY3kgLVNvdXJjZSBEQyAtRG9tYWluQ29udHJvbGxlciBNQVNURVIudGVzdGxhYi5sb2NhbAoKICAgICAgICBSZXR1cm5zIHRoZSBwb2xpY3kgZm9yIHRoZSBNQVNURVIudGVzdGxhYi5sb2NhbCBkb21haW4gY29udHJvbGxlci4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJEb21haW4iLCJEQyIpXQogICAgICAgICRTb3VyY2UgPSJEb21haW4iLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlc29sdmVTaWRzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlCiAgICApCgogICAgaWYoJFNvdXJjZSAtZXEgIkRvbWFpbiIpIHsKICAgICAgICAjIHF1ZXJ5IHRoZSBnaXZlbiBkb21haW4gZm9yIHRoZSBkZWZhdWx0IGRvbWFpbiBwb2xpY3kgb2JqZWN0CiAgICAgICAgJEdQTyA9IEdldC1OZXRHUE8gLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1HUE9uYW1lICJ7MzFCMkYzNDAtMDE2RC0xMUQyLTk0NUYtMDBDMDRGQjk4NEY5fSIKICAgICAgICAKICAgICAgICBpZigkR1BPKSB7CiAgICAgICAgICAgICMgZ3JhYiB0aGUgR3B0VG1wbC5pbmYgZmlsZSBhbmQgcGFyc2UgaXQKICAgICAgICAgICAgJEdwdFRtcGxQYXRoID0gJEdQTy5ncGNmaWxlc3lzcGF0aCArICJcTUFDSElORVxNaWNyb3NvZnRcV2luZG93cyBOVFxTZWNFZGl0XEdwdFRtcGwuaW5mIgoKICAgICAgICAgICAgJFBhcnNlQXJncyA9ICBAewogICAgICAgICAgICAgICAgJ0dwdFRtcGxQYXRoJyA9ICRHcHRUbXBsUGF0aAogICAgICAgICAgICAgICAgJ1VzZVBTRHJpdmUnID0gJFVzZVBTRHJpdmUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBwYXJzZSB0aGUgR3B0VG1wbC5pbmYKICAgICAgICAgICAgR2V0LUdwdFRtcGwgQFBhcnNlQXJncwogICAgICAgIH0KCiAgICB9CiAgICBlbHNlaWYoJFNvdXJjZSAtZXEgIkRDIikgewogICAgICAgICMgcXVlcnkgdGhlIGdpdmVuIGRvbWFpbi9kYyBmb3IgdGhlIGRlZmF1bHQgZG9tYWluIGNvbnRyb2xsZXIgcG9saWN5IG9iamVjdAogICAgICAgICRHUE8gPSBHZXQtTmV0R1BPIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtR1BPbmFtZSAiezZBQzE3ODZDLTAxNkYtMTFEMi05NDVGLTAwQzA0RkI5ODRGOX0iCgogICAgICAgIGlmKCRHUE8pIHsKICAgICAgICAgICAgIyBncmFiIHRoZSBHcHRUbXBsLmluZiBmaWxlIGFuZCBwYXJzZSBpdAogICAgICAgICAgICAkR3B0VG1wbFBhdGggPSAkR1BPLmdwY2ZpbGVzeXNwYXRoICsgIlxNQUNISU5FXE1pY3Jvc29mdFxXaW5kb3dzIE5UXFNlY0VkaXRcR3B0VG1wbC5pbmYiCgogICAgICAgICAgICAkUGFyc2VBcmdzID0gIEB7CiAgICAgICAgICAgICAgICAnR3B0VG1wbFBhdGgnID0gJEdwdFRtcGxQYXRoCiAgICAgICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHBhcnNlIHRoZSBHcHRUbXBsLmluZgogICAgICAgICAgICBHZXQtR3B0VG1wbCBAUGFyc2VBcmdzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgaWYoJFJlc29sdmVTaWRzKSB7CiAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSByZXNvbHZpbmcgc2lkcyBpbiBQcml2aWxlZ2VSaWdodHMgdG8gbmFtZXMKICAgICAgICAgICAgICAgICAgICAkUG9saWN5ID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICRfLnBzb2JqZWN0LnByb3BlcnRpZXMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkXy5OYW1lIC1lcSAnUHJpdmlsZWdlUmlnaHRzJykgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRQcml2aWxlZ2VSaWdodHMgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGZvciBldmVyeSBuZXN0ZWQgU0lEIG1lbWJlciBvZiBQcml2aWxlZ2VSaWdodHMsIHRyeSB0byAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgICB1bnBhY2sgZXZlcnl0aGluZyBhbmQgcmVzb2x2ZSB0aGUgU0lEcyBhcyBhcHByb3ByaWF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8uVmFsdWUucHNvYmplY3QucHJvcGVydGllcyB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNpZHMgPSAkXy5WYWx1ZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRfIC1pc25vdCBbU3lzdGVtLkFycmF5XSkgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb252ZXJ0LVNpZFRvTmFtZSAkXyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgRm9yRWFjaC1PYmplY3QgeyBDb252ZXJ0LVNpZFRvTmFtZSAkXyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHJlc29sdmluZyBTSUQgOiAkXyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFByaXZpbGVnZVJpZ2h0cyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICRfLk5hbWUgJFNpZHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUG9saWN5IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1ByaXZpbGVnZVJpZ2h0cycgJFByaXZpbGVnZVJpZ2h0cwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFBvbGljeSB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICRfLk5hbWUgJF8uVmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkUG9saWN5CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsgJF8gfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBGdW5jdGlvbnMgdGhhdCBlbnVtZXJhdGUgYSBzaW5nbGUgaG9zdCwgZWl0aGVyIHRocm91Z2gKIyBXaW5OVCwgV01JLCByZW1vdGUgcmVnaXN0cnksIG9yIEFQSSBjYWxscyAKIyAod2l0aCBQU1JlZmxlY3QpLgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtTmV0TG9jYWxHcm91cCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyBhIGxpc3Qgb2YgYWxsIGN1cnJlbnQgdXNlcnMgaW4gYSBzcGVjaWZpZWQgbG9jYWwgZ3JvdXAsCiAgICAgICAgb3IgcmV0dXJucyB0aGUgbmFtZXMgb2YgYWxsIGxvY2FsIGdyb3VwcyB3aXRoIC1MaXN0R3JvdXBzLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBob3N0bmFtZSBvciBJUCB0byBxdWVyeSBmb3IgbG9jYWwgZ3JvdXAgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbGUKCiAgICAgICAgRmlsZSBvZiBob3N0bmFtZXMvSVBzIHRvIHF1ZXJ5IGZvciBsb2NhbCBncm91cCB1c2Vycy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBUaGUgbG9jYWwgZ3JvdXAgbmFtZSB0byBxdWVyeSBmb3IgdXNlcnMuIElmIG5vdCBnaXZlbiwgaXQgZGVmYXVsdHMgdG8gIkFkbWluaXN0cmF0b3JzIgoKICAgIC5QQVJBTUVURVIgTGlzdEdyb3VwcwoKICAgICAgICBTd2l0Y2guIExpc3QgYWxsIHRoZSBsb2NhbCBncm91cHMgaW5zdGVhZCBvZiB0aGVpciBtZW1iZXJzLgogICAgICAgIE9sZCBHZXQtTmV0TG9jYWxHcm91cHMgZnVuY3Rpb25hbGl0eS4KCiAgICAuUEFSQU1FVEVSIFJlY3Vyc2UKCiAgICAgICAgU3dpdGNoLiBJZiB0aGUgbG9jYWwgbWVtYmVyIG1lbWJlciBpcyBhIGRvbWFpbiBncm91cCwgcmVjdXJzaXZlbHkgdHJ5IHRvIHJlc29sdmUgaXRzIG1lbWJlcnMgdG8gZ2V0IGEgbGlzdCBvZiBkb21haW4gdXNlcnMgd2hvIGNhbiBhY2Nlc3MgdGhpcyBtYWNoaW5lLgoKICAgIC5QQVJBTUVURVIgQVBJCgogICAgICAgIFN3aXRjaC4gVXNlIEFQSSBjYWxscyBpbnN0ZWFkIG9mIHRoZSBXaW5OVCBzZXJ2aWNlIHByb3ZpZGVyLiBMZXNzIGluZm9ybWF0aW9uLAogICAgICAgIGJ1dCB0aGUgcmVzdWx0cyBhcmUgZmFzdGVyLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldExvY2FsR3JvdXAKCiAgICAgICAgUmV0dXJucyB0aGUgdXNlcm5hbWVzIHRoYXQgb2YgbWVtYmVycyBvZiBsb2NhbGdyb3VwICJBZG1pbmlzdHJhdG9ycyIgb24gdGhlIGxvY2FsIGhvc3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9jYWxHcm91cCAtQ29tcHV0ZXJOYW1lIFdJTkRPV1NYUAoKICAgICAgICBSZXR1cm5zIGFsbCB0aGUgbG9jYWwgYWRtaW5pc3RyYXRvciBhY2NvdW50cyBmb3IgV0lORE9XU1hQCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9jYWxHcm91cCAtQ29tcHV0ZXJOYW1lIFdJTkRPV1M3IC1SZWN1cnNlIAoKICAgICAgICBSZXR1cm5zIGFsbCBlZmZlY3RpdmUgbG9jYWwvZG9tYWluIHVzZXJzL2dyb3VwcyB0aGF0IGNhbiBhY2Nlc3MgV0lORE9XUzcgd2l0aAogICAgICAgIGxvY2FsIGFkbWluaXN0cmF0aXZlIHByaXZpbGVnZXMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9jYWxHcm91cCAtQ29tcHV0ZXJOYW1lIFdJTkRPV1M3IC1MaXN0R3JvdXBzCgogICAgICAgIFJldHVybnMgYWxsIGxvY2FsIGdyb3VwcyBvbiB0aGUgV0lORE9XUzcgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+ICJXSU5ET1dTNyIsICJXSU5ET1dTU1AiIHwgR2V0LU5ldExvY2FsR3JvdXAgLUFQSQoKICAgICAgICBSZXR1cm5zIGFsbCBsb2NhbCBncm91cHMgb24gdGhlIHRoZSBwYXNzZWQgaG9zdHMgdXNpbmcgQVBJIGNhbGxzIGluc3RlYWQgb2YgdGhlCiAgICAgICAgV2luTlQgc2VydmljZSBwcm92aWRlci4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzIxMjg4MjIwL2dldC1hbGwtbG9jYWwtbWVtYmVycy1hbmQtZ3JvdXBzLWRpc3BsYXllZC10b2dldGhlcgogICAgICAgIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9hYTc3MjIxMShWUy44NSkuYXNweAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gJ1dpbk5UJyldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQVBJJywgUG9zaXRpb249MCwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdXaW5OVCcsIFBvc2l0aW9uPTAsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUgPSAiJCgkZW52OkNPTVBVVEVSTkFNRUNPTVBVVEVSTkFNRSkiLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnV2luTlQnKV0KICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnQVBJJyldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ1dpbk5UJyldCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0FQSScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSA9ICdBZG1pbmlzdHJhdG9ycycsCgogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdXaW5OVCcpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJExpc3RHcm91cHMsCgogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdXaW5OVCcpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlY3Vyc2UsCgogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdBUEknKV0KICAgICAgICBbU3dpdGNoXQogICAgICAgICRBUEkKICAgICkKCiAgICBwcm9jZXNzIHsKCiAgICAgICAgJFNlcnZlcnMgPSBAKCkKCiAgICAgICAgIyBpZiB3ZSBoYXZlIGEgaG9zdCBsaXN0IHBhc3NlZCwgZ3JhYiBpdAogICAgICAgIGlmKCRDb21wdXRlckZpbGUpIHsKICAgICAgICAgICAgJFNlcnZlcnMgPSBHZXQtQ29udGVudCAtUGF0aCAkQ29tcHV0ZXJGaWxlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIG90aGVyd2lzZSBhc3N1bWUgYSBzaW5nbGUgaG9zdCBuYW1lCiAgICAgICAgICAgICRTZXJ2ZXJzICs9ICRDb21wdXRlck5hbWUgfCBHZXQtTmFtZUZpZWxkCiAgICAgICAgfQoKICAgICAgICAjIHF1ZXJ5IHRoZSBzcGVjaWZpZWQgZ3JvdXAgdXNpbmcgdGhlIFdJTk5UIHByb3ZpZGVyLCBhbmQKICAgICAgICAjIGV4dHJhY3QgZmllbGRzIGFzIGFwcHJvcHJpYXRlIGZyb20gdGhlIHJlc3VsdHMKICAgICAgICBGb3JFYWNoKCRTZXJ2ZXIgaW4gJFNlcnZlcnMpIHsKCiAgICAgICAgICAgIGlmKCRBUEkpIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhlIE5ldGFwaTMyIE5ldExvY2FsR3JvdXBHZXRNZW1iZXJzIEFQSSBjYWxsIHRvCiAgICAgICAgICAgICAgICAjICAgZ2V0IHRoZSBsb2NhbCBncm91cCBpbmZvcm1hdGlvbgoKICAgICAgICAgICAgICAgICMgYXJndW1lbnRzIGZvciBOZXRMb2NhbEdyb3VwR2V0TWVtYmVycwogICAgICAgICAgICAgICAgJFF1ZXJ5TGV2ZWwgPSAyCiAgICAgICAgICAgICAgICAkUHRySW5mbyA9IFtJbnRQdHJdOjpaZXJvCiAgICAgICAgICAgICAgICAkRW50cmllc1JlYWQgPSAwCiAgICAgICAgICAgICAgICAkVG90YWxSZWFkID0gMAogICAgICAgICAgICAgICAgJFJlc3VtZUhhbmRsZSA9IDAKCiAgICAgICAgICAgICAgICAjIGdldCB0aGUgbG9jYWwgdXNlciBpbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgJFJlc3VsdCA9ICROZXRhcGkzMjo6TmV0TG9jYWxHcm91cEdldE1lbWJlcnMoJFNlcnZlciwgJEdyb3VwTmFtZSwgJFF1ZXJ5TGV2ZWwsIFtyZWZdJFB0ckluZm8sIC0xLCBbcmVmXSRFbnRyaWVzUmVhZCwgW3JlZl0kVG90YWxSZWFkLCBbcmVmXSRSZXN1bWVIYW5kbGUpCgogICAgICAgICAgICAgICAgIyBMb2NhdGUgdGhlIG9mZnNldCBvZiB0aGUgaW5pdGlhbCBpbnRQdHIKICAgICAgICAgICAgICAgICRPZmZzZXQgPSAkUHRySW5mby5Ub0ludDY0KCkKCiAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiTmV0TG9jYWxHcm91cEdldE1lbWJlcnMgcmVzdWx0IGZvciAkU2VydmVyIDogJFJlc3VsdCIKICAgICAgICAgICAgICAgICRMb2NhbFVzZXJzID0gQCgpCgogICAgICAgICAgICAgICAgIyAwID0gc3VjY2VzcwogICAgICAgICAgICAgICAgaWYgKCgkUmVzdWx0IC1lcSAwKSAtYW5kICgkT2Zmc2V0IC1ndCAwKSkgewoKICAgICAgICAgICAgICAgICAgICAjIFdvcmsgb3V0IGhvdyBtdXRjaCB0byBpbmNyZW1lbnQgdGhlIHBvaW50ZXIgYnkgZmluZGluZyBvdXQgdGhlIHNpemUgb2YgdGhlIHN0cnVjdHVyZQogICAgICAgICAgICAgICAgICAgICRJbmNyZW1lbnQgPSAkTE9DQUxHUk9VUF9NRU1CRVJTX0lORk9fMjo6R2V0U2l6ZSgpCgogICAgICAgICAgICAgICAgICAgICMgcGFyc2UgYWxsIHRoZSByZXN1bHQgc3RydWN0dXJlcwogICAgICAgICAgICAgICAgICAgIGZvciAoJGkgPSAwOyAoJGkgLWx0ICRFbnRyaWVzUmVhZCk7ICRpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBjcmVhdGUgYSBuZXcgaW50IHB0ciBhdCB0aGUgZ2l2ZW4gb2Zmc2V0IGFuZCBjYXN0CiAgICAgICAgICAgICAgICAgICAgICAgICMgICB0aGUgcG9pbnRlciBhcyBvdXIgcmVzdWx0IHN0cnVjdHVyZQogICAgICAgICAgICAgICAgICAgICAgICAkTmV3SW50UHRyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldAogICAgICAgICAgICAgICAgICAgICAgICAkSW5mbyA9ICROZXdJbnRQdHIgLWFzICRMT0NBTEdST1VQX01FTUJFUlNfSU5GT18yCgogICAgICAgICAgICAgICAgICAgICAgICAkU2lkU3RyaW5nID0gIiIKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9ICRBZHZhcGkzMjo6Q29udmVydFNpZFRvU3RyaW5nU2lkKCRJbmZvLmxncm1pMl9zaWQsIFtyZWZdJFNpZFN0cmluZykKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIlJlc3VsdCBvZiBDb252ZXJ0U2lkVG9TdHJpbmdTaWQ6ICRSZXN1bHQiCgogICAgICAgICAgICAgICAgICAgICAgICBpZigkUmVzdWx0IC1lcSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGVycm9yIGNvZGVzIC0gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4Mih2PXZzLjg1KS5hc3B4CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRXJyID0gJEtlcm5lbDMyOjpHZXRMYXN0RXJyb3IoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIkNvbnZlcnRTaWRUb1N0cmluZ1NpZCBMYXN0RXJyb3I6ICRFcnIiICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkU2VydmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTG9jYWxVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0FjY291bnROYW1lJyAkSW5mby5sZ3JtaTJfZG9tYWluYW5kbmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTSUQnICRTaWRTdHJpbmcKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkSXNHcm91cCA9ICQoJEluZm8ubGdybWkyX3NpZHVzYWdlIC1lcSAnU2lkVHlwZUdyb3VwJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJElzR3JvdXAKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT2Zmc2V0ID0gJE5ld0ludFB0ci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPZmZzZXQgKz0gJEluY3JlbWVudAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFVzZXJzICs9ICRMb2NhbFVzZXIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyBmcmVlIHVwIHRoZSByZXN1bHQgYnVmZmVyCiAgICAgICAgICAgICAgICAgICAgJE51bGwgPSAkTmV0YXBpMzI6Ok5ldEFwaUJ1ZmZlckZyZWUoJFB0ckluZm8pCgogICAgICAgICAgICAgICAgICAgICMgdHJ5IHRvIGV4dHJhY3Qgb3V0IHRoZSBtYWNoaW5lIFNJRCBieSB1c2luZyB0aGUgLTUwMCBhY2NvdW50IGFzIGEgcmVmZXJlbmNlCiAgICAgICAgICAgICAgICAgICAgJE1hY2hpbmVTaWQgPSAkTG9jYWxVc2VycyB8IFdoZXJlLU9iamVjdCB7JF8uU0lEIC1saWtlICcqLTUwMCd9CiAgICAgICAgICAgICAgICAgICAgJFBhcnRzID0gJE1hY2hpbmVTaWQuU0lELlNwbGl0KCctJykKICAgICAgICAgICAgICAgICAgICAkTWFjaGluZVNpZCA9ICRQYXJ0c1swLi4oJFBhcnRzLkxlbmd0aCAtMildIC1qb2luICctJwoKICAgICAgICAgICAgICAgICAgICAkTG9jYWxVc2VycyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJF8uU0lEIC1tYXRjaCAkTWFjaGluZVNpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNEb21haW4nICRGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNEb21haW4nICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJExvY2FsVXNlcnMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRSZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgKDUpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB1c2VyIGRvZXMgbm90IGhhdmUgYWNjZXNzIHRvIHRoZSByZXF1ZXN0ZWQgaW5mb3JtYXRpb24uJ30KICAgICAgICAgICAgICAgICAgICAgICAgKDEyNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB2YWx1ZSBzcGVjaWZpZWQgZm9yIHRoZSBsZXZlbCBwYXJhbWV0ZXIgaXMgbm90IHZhbGlkLid9CiAgICAgICAgICAgICAgICAgICAgICAgICg4NykgICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgc3BlY2lmaWVkIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgICAgICAgICAgICAgKDIzNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ01vcmUgZW50cmllcyBhcmUgYXZhaWxhYmxlLiBTcGVjaWZ5IGEgbGFyZ2UgZW5vdWdoIGJ1ZmZlciB0byByZWNlaXZlIGFsbCBlbnRyaWVzLid9CiAgICAgICAgICAgICAgICAgICAgICAgICg4KSAgICAgICAgICAge1dyaXRlLURlYnVnICdJbnN1ZmZpY2llbnQgbWVtb3J5IGlzIGF2YWlsYWJsZS4nfQogICAgICAgICAgICAgICAgICAgICAgICAoMjMxMikgICAgICAgIHtXcml0ZS1EZWJ1ZyAnQSBzZXNzaW9uIGRvZXMgbm90IGV4aXN0IHdpdGggdGhlIGNvbXB1dGVyIG5hbWUuJ30KICAgICAgICAgICAgICAgICAgICAgICAgKDIzNTEpICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBjb21wdXRlciBuYW1lIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgICAgICAgICAoMjIyMSkgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVXNlcm5hbWUgbm90IGZvdW5kLid9CiAgICAgICAgICAgICAgICAgICAgICAgICg1MykgICAgICAgICAge1dyaXRlLURlYnVnICdIb3N0bmFtZSBjb3VsZCBub3QgYmUgZm91bmQnfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAjIG90aGVyd2lzZSB3ZSdyZSB1c2luZyB0aGUgV2luTlQgc2VydmljZSBwcm92aWRlcgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZigkTGlzdEdyb3VwcykgewogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGxpc3RpbmcgdGhlIGdyb3VwIG5hbWVzIG9uIGEgcmVtb3RlIHNlcnZlcgogICAgICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXIgPSBbQURTSV0iV2luTlQ6Ly8kU2VydmVyLGNvbXB1dGVyIgoKICAgICAgICAgICAgICAgICAgICAgICAgJENvbXB1dGVyLnBzYmFzZS5jaGlsZHJlbiB8IFdoZXJlLU9iamVjdCB7ICRfLnBzYmFzZS5zY2hlbWFDbGFzc05hbWUgLWVxICdncm91cCcgfSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cCA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTZXJ2ZXInICRTZXJ2ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cCcgKCRfLm5hbWVbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXAgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU0lEJyAoKE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXIgJF8ub2JqZWN0c2lkWzBdLDApLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0Rlc2NyaXB0aW9uJyAoJF8uRGVzY3JpcHRpb25bMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2Ugd2UncmUgbGlzdGluZyB0aGUgZ3JvdXAgbWVtYmVycwogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9IEAoJChbQURTSV0iV2luTlQ6Ly8kU2VydmVyLyRHcm91cE5hbWUsZ3JvdXAiKS5wc2Jhc2UuSW52b2tlKCdNZW1iZXJzJykpCgogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRTZXJ2ZXIKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWRzUGF0aCA9ICgkXy5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCdBZHNwYXRoJywgJ0dldFByb3BlcnR5JywgJE51bGwsICRfLCAkTnVsbCkpLlJlcGxhY2UoJ1dpbk5UOi8vJywgJycpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB0cnkgdG8gdHJhbnNsYXRlIHRoZSBOVDQgZG9tYWluIHRvIGEgRlFETiBpZiBwb3NzaWJsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE5hbWUgPSBDb252ZXJ0LUFETmFtZSAtT2JqZWN0TmFtZSAkQWRzUGF0aCAtSW5wdXRUeXBlICdOVDQnIC1PdXRwdXRUeXBlICdDYW5vbmljYWwnCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRlFETiA9ICROYW1lLnNwbGl0KCIvIilbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT2JqTmFtZSA9ICRBZHNQYXRoLnNwbGl0KCIvIilbLTFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE5hbWUgPSAiJEZRRE4vJE9iak5hbWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJElzRG9tYWluID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICROYW1lID0gJEFkc1BhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkSXNEb21haW4gPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0FjY291bnROYW1lJyAkTmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRJc0RvbWFpbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgdHJhbnNsYXRlIHRoZSBiaW5hcnkgc2lkIHRvIGEgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTSUQnICgoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkXy5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCdPYmplY3RTSUQnLCAnR2V0UHJvcGVydHknLCAkTnVsbCwgJF8sICROdWxsKSwwKSkuVmFsdWUpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRGVzY3JpcHRpb24nICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdEaXNhYmxlZCcgJEZhbHNlCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIG1lbWJlciBpcyBhIGdyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJElzR3JvdXAgPSAoJF8uR2V0VHlwZSgpLkludm9rZU1lbWJlcignQ2xhc3MnLCAnR2V0UHJvcGVydHknLCAkTnVsbCwgJF8sICROdWxsKSAtZXEgJ2dyb3VwJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lzR3JvdXAnICRJc0dyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0RvbWFpbicgJElzRG9tYWluCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRJc0dyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAoICRfLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoJ0xhc3RMb2dpbicsICdHZXRQcm9wZXJ0eScsICROdWxsLCAkXywgJE51bGwpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnUHdkTGFzdFNldCcgIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1B3ZEV4cGlyZWQnICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyRmxhZ3MnICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHJlcHVsbCB0aGlzIHVzZXIgb2JqZWN0IHNvIHdlIGNhbiBlbnN1cmUgY29ycmVjdCBpbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFVzZXIgPSAkKFtBRFNJXSAiV2luTlQ6Ly8kQWRzUGF0aCIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgdHJhbnNsYXRlIHRoZSBiaW5hcnkgc2lkIHRvIGEgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTSUQnICgoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkTG9jYWxVc2VyLm9iamVjdFNpZC52YWx1ZSwwKSkuVmFsdWUpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRGVzY3JpcHRpb24nICgkTG9jYWxVc2VyLkRlc2NyaXB0aW9uWzBdKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFVBQyBmbGFncyBvZiAweDIgbWVhbiB0aGUgYWNjb3VudCBpcyBkaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRGlzYWJsZWQnICQoKCRMb2NhbFVzZXIudXNlckZsYWdzLnZhbHVlIC1iYW5kIDIpIC1lcSAyKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGNoZWNrIGlmIHRoZSBtZW1iZXIgaXMgYSBncm91cAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgKCRMb2NhbFVzZXIuU2NoZW1hQ2xhc3NOYW1lIC1saWtlICdncm91cCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0RvbWFpbicgJElzRG9tYWluCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRJc0dyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAoICRMb2NhbFVzZXIuTGFzdExvZ2luWzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1B3ZExhc3RTZXQnICggKEdldC1EYXRlKS5BZGRTZWNvbmRzKC0kTG9jYWxVc2VyLlBhc3N3b3JkQWdlWzBdKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1B3ZEV4cGlyZWQnICggJExvY2FsVXNlci5QYXNzd29yZEV4cGlyZWRbMF0gLWVxICcxJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJGbGFncycgKCAkTG9jYWxVc2VyLlVzZXJGbGFnc1swXSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB0aGUgcmVzdWx0IGlzIGEgZ3JvdXAgZG9tYWluIG9iamVjdCBhbmQgd2UncmUgcmVjdXJzaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAgIHRyeSB0byByZXNvbHZlIGFsbCB0aGUgZ3JvdXAgbWVtYmVyIHJlc3VsdHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRSZWN1cnNlIC1hbmQgJElzRG9tYWluIC1hbmQgJElzR3JvdXApIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZRRE4gPSAkTmFtZS5zcGxpdCgiLyIpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwTmFtZSA9ICROYW1lLnNwbGl0KCIvIilbMV0udHJpbSgpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdldC1OZXRHcm91cE1lbWJlciAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRlFETiAtRnVsbERhdGEgLVJlY3Vyc2UgfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgIiRGUUROLyQoJF8uR3JvdXBOYW1lKSIKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJETiA9ICRfLmRpc3Rpbmd1aXNoZWROYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgZXh0cmFjdCB0aGUgRlFETiBmcm9tIHRoZSBEaXN0aW5ndWlzaGVkIE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckRvbWFpbiA9ICRNZW1iZXJETi5zdWJTdHJpbmcoJE1lbWJlckROLkluZGV4T2YoIkRDPSIpKSAtcmVwbGFjZSAnREM9JywnJyAtcmVwbGFjZSAnLCcsJy4nCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVySXNHcm91cCA9IEAoJzI2ODQzNTQ1NicsJzI2ODQzNTQ1NycsJzUzNjg3MDkxMicsJzUzNjg3MDkxMycpIC1jb250YWlucyAkXy5zYW1hY2NvdW50dHlwZQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfLnNhbUFjY291bnROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGZvcmVzdCB1c2VycyBoYXZlIHRoZSBzYW1BY2NvdW50TmFtZSBzZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gJF8uc2FtQWNjb3VudE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBleHRlcm5hbCB0cnVzdCB1c2VycyBoYXZlIGEgU0lELCBzbyBjb252ZXJ0IGl0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSBDb252ZXJ0LVNpZFRvTmFtZSAkXy5jbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgaWYgdGhlcmUncyBhIHByb2JsZW0gY29udGFjdGluZyB0aGUgZG9tYWluIHRvIHJlc29sdmUgdGhlIFNJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyTmFtZSA9ICRfLmNuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciByZXNvbHZpbmcgU0lEIDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQWNjb3VudE5hbWUnICIkTWVtYmVyRG9tYWluLyRNZW1iZXJOYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NJRCcgJF8ub2JqZWN0c2lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRGVzY3JpcHRpb24nICRfLmRlc2NyaXB0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRGlzYWJsZWQnICRGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lzR3JvdXAnICRNZW1iZXJJc0dyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNEb21haW4nICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTGFzdExvZ2luJyAnJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1B3ZExhc3RTZXQnICRfLnB3ZExhc3RTZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdQd2RFeHBpcmVkJyAnJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJGbGFncycgJF8udXNlckFjY291bnRDb250cm9sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiWyFdIEVycm9yOiAkXyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZpbHRlciBHZXQtTmV0U2hhcmUgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCBleGVjdXRlIHRoZSBOZXRTaGFyZUVudW0gV2luMzJBUEkgY2FsbCB0byBxdWVyeQogICAgICAgIGEgZ2l2ZW4gaG9zdCBmb3Igb3BlbiBzaGFyZXMuIFRoaXMgaXMgYSByZXBsYWNlbWVudCBmb3IKICAgICAgICAibmV0IHNoYXJlIFxcaG9zdG5hbWUiCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGhvc3RuYW1lIHRvIHF1ZXJ5IGZvciBzaGFyZXMuIEFsc28gYWNjZXB0cyBJUCBhZGRyZXNzZXMuCgogICAgLk9VVFBVVFMKCiAgICAgICAgU0hBUkVfSU5GT18xIHN0cnVjdHVyZS4gQSByZXByZXNlbnRhdGlvbiBvZiB0aGUgU0hBUkVfSU5GT18xCiAgICAgICAgcmVzdWx0IHN0cnVjdHVyZSB3aGljaCBpbmNsdWRlcyB0aGUgbmFtZSBhbmQgbm90ZSBmb3IgZWFjaCBzaGFyZSwKICAgICAgICB3aXRoIHRoZSBDb21wdXRlck5hbWUgYWRkZWQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U2hhcmUKCiAgICAgICAgUmV0dXJucyBhY3RpdmUgc2hhcmVzIG9uIHRoZSBsb2NhbCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFNoYXJlIC1Db21wdXRlck5hbWUgc3Fsc2VydmVyCgogICAgICAgIFJldHVybnMgYWN0aXZlIHNoYXJlcyBvbiB0aGUgJ3NxbHNlcnZlcicgaG9zdAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldENvbXB1dGVyIHwgR2V0LU5ldFNoYXJlCgogICAgICAgIFJldHVybnMgYWxsIHNoYXJlcyBmb3IgYWxsIGNvbXB1dGVycyBpbiB0aGUgZG9tYWluLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly93d3cucG93ZXJzaGVsbG1hZ2F6aW5lLmNvbS8yMDE0LzA5LzI1L2Vhc2lseS1kZWZpbmluZy1lbnVtcy1zdHJ1Y3RzLWFuZC13aW4zMi1mdW5jdGlvbnMtaW4tbWVtb3J5LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW09iamVjdFtdXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICdsb2NhbGhvc3QnCiAgICApCgogICAgIyBleHRyYWN0IHRoZSBjb21wdXRlciBuYW1lIGZyb20gd2hhdGV2ZXIgb2JqZWN0IHdhcyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAkQ29tcHV0ZXIgPSAkQ29tcHV0ZXJOYW1lIHwgR2V0LU5hbWVGaWVsZAoKICAgICMgYXJndW1lbnRzIGZvciBOZXRTaGFyZUVudW0KICAgICRRdWVyeUxldmVsID0gMQogICAgJFB0ckluZm8gPSBbSW50UHRyXTo6WmVybwogICAgJEVudHJpZXNSZWFkID0gMAogICAgJFRvdGFsUmVhZCA9IDAKICAgICRSZXN1bWVIYW5kbGUgPSAwCgogICAgIyBnZXQgdGhlIHNoYXJlIGluZm9ybWF0aW9uCiAgICAkUmVzdWx0ID0gJE5ldGFwaTMyOjpOZXRTaGFyZUVudW0oJENvbXB1dGVyLCAkUXVlcnlMZXZlbCwgW3JlZl0kUHRySW5mbywgLTEsIFtyZWZdJEVudHJpZXNSZWFkLCBbcmVmXSRUb3RhbFJlYWQsIFtyZWZdJFJlc3VtZUhhbmRsZSkKCiAgICAjIExvY2F0ZSB0aGUgb2Zmc2V0IG9mIHRoZSBpbml0aWFsIGludFB0cgogICAgJE9mZnNldCA9ICRQdHJJbmZvLlRvSW50NjQoKQoKICAgIFdyaXRlLURlYnVnICJHZXQtTmV0U2hhcmUgcmVzdWx0IGZvciAkQ29tcHV0ZXIgOiAkUmVzdWx0IgoKICAgICMgMCA9IHN1Y2Nlc3MKICAgIGlmICgoJFJlc3VsdCAtZXEgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgIyBXb3JrIG91dCBob3cgbXV0Y2ggdG8gaW5jcmVtZW50IHRoZSBwb2ludGVyIGJ5IGZpbmRpbmcgb3V0IHRoZSBzaXplIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAkSW5jcmVtZW50ID0gJFNIQVJFX0lORk9fMTo6R2V0U2l6ZSgpCgogICAgICAgICMgcGFyc2UgYWxsIHRoZSByZXN1bHQgc3RydWN0dXJlcwogICAgICAgIGZvciAoJGkgPSAwOyAoJGkgLWx0ICRFbnRyaWVzUmVhZCk7ICRpKyspIHsKICAgICAgICAgICAgIyBjcmVhdGUgYSBuZXcgaW50IHB0ciBhdCB0aGUgZ2l2ZW4gb2Zmc2V0IGFuZCBjYXN0CiAgICAgICAgICAgICMgICB0aGUgcG9pbnRlciBhcyBvdXIgcmVzdWx0IHN0cnVjdHVyZQogICAgICAgICAgICAkTmV3SW50UHRyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldAogICAgICAgICAgICAkSW5mbyA9ICROZXdJbnRQdHIgLWFzICRTSEFSRV9JTkZPXzEKCiAgICAgICAgICAgICMgcmV0dXJuIGFsbCB0aGUgc2VjdGlvbnMgb2YgdGhlIHN0cnVjdHVyZQogICAgICAgICAgICAkU2hhcmVzID0gJEluZm8gfCBTZWxlY3QtT2JqZWN0ICoKICAgICAgICAgICAgJFNoYXJlcyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlcgogICAgICAgICAgICAkT2Zmc2V0ID0gJE5ld0ludFB0ci5Ub0ludDY0KCkKICAgICAgICAgICAgJE9mZnNldCArPSAkSW5jcmVtZW50CiAgICAgICAgICAgICRTaGFyZXMKICAgICAgICB9CgogICAgICAgICMgZnJlZSB1cCB0aGUgcmVzdWx0IGJ1ZmZlcgogICAgICAgICROdWxsID0gJE5ldGFwaTMyOjpOZXRBcGlCdWZmZXJGcmVlKCRQdHJJbmZvKQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHN3aXRjaCAoJFJlc3VsdCkgewogICAgICAgICAgICAoNSkgICAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhY2Nlc3MgdG8gdGhlIHJlcXVlc3RlZCBpbmZvcm1hdGlvbi4nfQogICAgICAgICAgICAoMTI0KSAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIHZhbHVlIHNwZWNpZmllZCBmb3IgdGhlIGxldmVsIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgKDg3KSAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAoMjM0KSAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnTW9yZSBlbnRyaWVzIGFyZSBhdmFpbGFibGUuIFNwZWNpZnkgYSBsYXJnZSBlbm91Z2ggYnVmZmVyIHRvIHJlY2VpdmUgYWxsIGVudHJpZXMuJ30KICAgICAgICAgICAgKDgpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ0luc3VmZmljaWVudCBtZW1vcnkgaXMgYXZhaWxhYmxlLid9CiAgICAgICAgICAgICgyMzEyKSAgICAgICAge1dyaXRlLURlYnVnICdBIHNlc3Npb24gZG9lcyBub3QgZXhpc3Qgd2l0aCB0aGUgY29tcHV0ZXIgbmFtZS4nfQogICAgICAgICAgICAoMjM1MSkgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIGNvbXB1dGVyIG5hbWUgaXMgbm90IHZhbGlkLid9CiAgICAgICAgICAgICgyMjIxKSAgICAgICAge1dyaXRlLURlYnVnICdVc2VybmFtZSBub3QgZm91bmQuJ30KICAgICAgICAgICAgKDUzKSAgICAgICAgICB7V3JpdGUtRGVidWcgJ0hvc3RuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZCd9CiAgICAgICAgfQogICAgfQp9CgoKZmlsdGVyIEdldC1OZXRMb2dnZWRvbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUgdGhlIE5ldFdrc3RhVXNlckVudW0gV2luMzJBUEkgY2FsbCB0byBxdWVyeQogICAgICAgIGEgZ2l2ZW4gaG9zdCBmb3IgYWN0aXZlbHkgbG9nZ2VkIG9uIHVzZXJzLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBob3N0bmFtZSB0byBxdWVyeSBmb3IgbG9nZ2VkIG9uIHVzZXJzLgoKICAgIC5PVVRQVVRTCgogICAgICAgIFdLU1RBX1VTRVJfSU5GT18xIHN0cnVjdHVyZS4gQSByZXByZXNlbnRhdGlvbiBvZiB0aGUgV0tTVEFfVVNFUl9JTkZPXzEKICAgICAgICByZXN1bHQgc3RydWN0dXJlIHdoaWNoIGluY2x1ZGVzIHRoZSB1c2VybmFtZSBhbmQgZG9tYWluIG9mIGxvZ2dlZCBvbiB1c2VycywKICAgICAgICB3aXRoIHRoZSBDb21wdXRlck5hbWUgYWRkZWQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9nZ2Vkb24KCiAgICAgICAgUmV0dXJucyB1c2VycyBhY3RpdmVseSBsb2dnZWQgb250byB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRMb2dnZWRvbiAtQ29tcHV0ZXJOYW1lIHNxbHNlcnZlcgoKICAgICAgICBSZXR1cm5zIHVzZXJzIGFjdGl2ZWx5IGxvZ2dlZCBvbnRvIHRoZSAnc3Fsc2VydmVyJyBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldENvbXB1dGVyIHwgR2V0LU5ldExvZ2dlZG9uCgogICAgICAgIFJldHVybnMgYWxsIGxvZ2dlZCBvbiB1c2Vyc2UgZm9yIGFsbCBjb21wdXRlcnMgaW4gdGhlIGRvbWFpbi4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vd3d3LnBvd2Vyc2hlbGxtYWdhemluZS5jb20vMjAxNC8wOS8yNS9lYXNpbHktZGVmaW5pbmctZW51bXMtc3RydWN0cy1hbmQtd2luMzItZnVuY3Rpb25zLWluLW1lbW9yeS8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JwogICAgKQoKICAgICMgZXh0cmFjdCB0aGUgY29tcHV0ZXIgbmFtZSBmcm9tIHdoYXRldmVyIG9iamVjdCB3YXMgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgJENvbXB1dGVyID0gJENvbXB1dGVyTmFtZSB8IEdldC1OYW1lRmllbGQKCiAgICAjIERlY2xhcmUgdGhlIHJlZmVyZW5jZSB2YXJpYWJsZXMKICAgICRRdWVyeUxldmVsID0gMQogICAgJFB0ckluZm8gPSBbSW50UHRyXTo6WmVybwogICAgJEVudHJpZXNSZWFkID0gMAogICAgJFRvdGFsUmVhZCA9IDAKICAgICRSZXN1bWVIYW5kbGUgPSAwCgogICAgIyBnZXQgbG9nZ2VkIG9uIHVzZXIgaW5mb3JtYXRpb24KICAgICRSZXN1bHQgPSAkTmV0YXBpMzI6Ok5ldFdrc3RhVXNlckVudW0oJENvbXB1dGVyLCAkUXVlcnlMZXZlbCwgW3JlZl0kUHRySW5mbywgLTEsIFtyZWZdJEVudHJpZXNSZWFkLCBbcmVmXSRUb3RhbFJlYWQsIFtyZWZdJFJlc3VtZUhhbmRsZSkKCiAgICAjIExvY2F0ZSB0aGUgb2Zmc2V0IG9mIHRoZSBpbml0aWFsIGludFB0cgogICAgJE9mZnNldCA9ICRQdHJJbmZvLlRvSW50NjQoKQoKICAgIFdyaXRlLURlYnVnICJHZXQtTmV0TG9nZ2Vkb24gcmVzdWx0IGZvciAkQ29tcHV0ZXIgOiAkUmVzdWx0IgoKICAgICMgMCA9IHN1Y2Nlc3MKICAgIGlmICgoJFJlc3VsdCAtZXEgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgIyBXb3JrIG91dCBob3cgbXV0Y2ggdG8gaW5jcmVtZW50IHRoZSBwb2ludGVyIGJ5IGZpbmRpbmcgb3V0IHRoZSBzaXplIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAkSW5jcmVtZW50ID0gJFdLU1RBX1VTRVJfSU5GT18xOjpHZXRTaXplKCkKCiAgICAgICAgIyBwYXJzZSBhbGwgdGhlIHJlc3VsdCBzdHJ1Y3R1cmVzCiAgICAgICAgZm9yICgkaSA9IDA7ICgkaSAtbHQgJEVudHJpZXNSZWFkKTsgJGkrKykgewogICAgICAgICAgICAjIGNyZWF0ZSBhIG5ldyBpbnQgcHRyIGF0IHRoZSBnaXZlbiBvZmZzZXQgYW5kIGNhc3QKICAgICAgICAgICAgIyAgIHRoZSBwb2ludGVyIGFzIG91ciByZXN1bHQgc3RydWN0dXJlCiAgICAgICAgICAgICROZXdJbnRQdHIgPSBOZXctT2JqZWN0IFN5c3RlbS5JbnRwdHIgLUFyZ3VtZW50TGlzdCAkT2Zmc2V0CiAgICAgICAgICAgICRJbmZvID0gJE5ld0ludFB0ciAtYXMgJFdLU1RBX1VTRVJfSU5GT18xCgogICAgICAgICAgICAjIHJldHVybiBhbGwgdGhlIHNlY3Rpb25zIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgJExvZ2dlZE9uID0gJEluZm8gfCBTZWxlY3QtT2JqZWN0ICoKICAgICAgICAgICAgJExvZ2dlZE9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyCiAgICAgICAgICAgICRPZmZzZXQgPSAkTmV3SW50UHRyLlRvSW50NjQoKQogICAgICAgICAgICAkT2Zmc2V0ICs9ICRJbmNyZW1lbnQKICAgICAgICAgICAgJExvZ2dlZE9uCiAgICAgICAgfQoKICAgICAgICAjIGZyZWUgdXAgdGhlIHJlc3VsdCBidWZmZXIKICAgICAgICAkTnVsbCA9ICROZXRhcGkzMjo6TmV0QXBpQnVmZmVyRnJlZSgkUHRySW5mbykKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBzd2l0Y2ggKCRSZXN1bHQpIHsKICAgICAgICAgICAgKDUpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB1c2VyIGRvZXMgbm90IGhhdmUgYWNjZXNzIHRvIHRoZSByZXF1ZXN0ZWQgaW5mb3JtYXRpb24uJ30KICAgICAgICAgICAgKDEyNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB2YWx1ZSBzcGVjaWZpZWQgZm9yIHRoZSBsZXZlbCBwYXJhbWV0ZXIgaXMgbm90IHZhbGlkLid9CiAgICAgICAgICAgICg4NykgICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgc3BlY2lmaWVkIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgKDIzNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ01vcmUgZW50cmllcyBhcmUgYXZhaWxhYmxlLiBTcGVjaWZ5IGEgbGFyZ2UgZW5vdWdoIGJ1ZmZlciB0byByZWNlaXZlIGFsbCBlbnRyaWVzLid9CiAgICAgICAgICAgICg4KSAgICAgICAgICAge1dyaXRlLURlYnVnICdJbnN1ZmZpY2llbnQgbWVtb3J5IGlzIGF2YWlsYWJsZS4nfQogICAgICAgICAgICAoMjMxMikgICAgICAgIHtXcml0ZS1EZWJ1ZyAnQSBzZXNzaW9uIGRvZXMgbm90IGV4aXN0IHdpdGggdGhlIGNvbXB1dGVyIG5hbWUuJ30KICAgICAgICAgICAgKDIzNTEpICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBjb21wdXRlciBuYW1lIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAoMjIyMSkgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVXNlcm5hbWUgbm90IGZvdW5kLid9CiAgICAgICAgICAgICg1MykgICAgICAgICAge1dyaXRlLURlYnVnICdIb3N0bmFtZSBjb3VsZCBub3QgYmUgZm91bmQnfQogICAgICAgIH0KICAgIH0KfQoKCmZpbHRlciBHZXQtTmV0U2Vzc2lvbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUgdGhlIE5ldFNlc3Npb25FbnVtIFdpbjMyQVBJIGNhbGwgdG8gcXVlcnkKICAgICAgICBhIGdpdmVuIGhvc3QgZm9yIGFjdGl2ZSBzZXNzaW9ucyBvbiB0aGUgaG9zdC4KICAgICAgICBIZWF2aWx5IGFkYXB0ZWQgZnJvbSBkdW5lZGluaXRlJ3MgcG9zdCBvbiBzdGFja292ZXJmbG93IChzZWUgTElOSyBiZWxvdykKCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgQ29tcHV0ZXJOYW1lIHRvIHF1ZXJ5IGZvciBhY3RpdmUgc2Vzc2lvbnMuCgogICAgLlBBUkFNRVRFUiBVc2VyTmFtZQoKICAgICAgICBUaGUgdXNlciBuYW1lIHRvIGZpbHRlciBmb3IgYWN0aXZlIHNlc3Npb25zLgoKICAgIC5PVVRQVVRTCgogICAgICAgIFNFU1NJT05fSU5GT18xMCBzdHJ1Y3R1cmUuIEEgcmVwcmVzZW50YXRpb24gb2YgdGhlIFNFU1NJT05fSU5GT18xMAogICAgICAgIHJlc3VsdCBzdHJ1Y3R1cmUgd2hpY2ggaW5jbHVkZXMgdGhlIGhvc3QgYW5kIHVzZXJuYW1lIGFzc29jaWF0ZWQKICAgICAgICB3aXRoIGFjdGl2ZSBzZXNzaW9ucywgd2l0aCB0aGUgQ29tcHV0ZXJOYW1lIGFkZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFNlc3Npb24KCiAgICAgICAgUmV0dXJucyBhY3RpdmUgc2Vzc2lvbnMgb24gdGhlIGxvY2FsIGhvc3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U2Vzc2lvbiAtQ29tcHV0ZXJOYW1lIHNxbHNlcnZlcgoKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBzZXNzaW9ucyBvbiB0aGUgJ3NxbHNlcnZlcicgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXREb21haW5Db250cm9sbGVyIHwgR2V0LU5ldFNlc3Npb24KCiAgICAgICAgUmV0dXJucyBhY3RpdmUgc2Vzc2lvbnMgb24gYWxsIGRvbWFpbiBjb250cm9sbGVycy4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vd3d3LnBvd2Vyc2hlbGxtYWdhemluZS5jb20vMjAxNC8wOS8yNS9lYXNpbHktZGVmaW5pbmctZW51bXMtc3RydWN0cy1hbmQtd2luMzItZnVuY3Rpb25zLWluLW1lbW9yeS8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUgPSAnJwogICAgKQoKICAgICMgZXh0cmFjdCB0aGUgY29tcHV0ZXIgbmFtZSBmcm9tIHdoYXRldmVyIG9iamVjdCB3YXMgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgJENvbXB1dGVyID0gJENvbXB1dGVyTmFtZSB8IEdldC1OYW1lRmllbGQKCiAgICAjIGFyZ3VtZW50cyBmb3IgTmV0U2Vzc2lvbkVudW0KICAgICRRdWVyeUxldmVsID0gMTAKICAgICRQdHJJbmZvID0gW0ludFB0cl06Olplcm8KICAgICRFbnRyaWVzUmVhZCA9IDAKICAgICRUb3RhbFJlYWQgPSAwCiAgICAkUmVzdW1lSGFuZGxlID0gMAoKICAgICMgZ2V0IHNlc3Npb24gaW5mb3JtYXRpb24KICAgICRSZXN1bHQgPSAkTmV0YXBpMzI6Ok5ldFNlc3Npb25FbnVtKCRDb21wdXRlciwgJycsICRVc2VyTmFtZSwgJFF1ZXJ5TGV2ZWwsIFtyZWZdJFB0ckluZm8sIC0xLCBbcmVmXSRFbnRyaWVzUmVhZCwgW3JlZl0kVG90YWxSZWFkLCBbcmVmXSRSZXN1bWVIYW5kbGUpCgogICAgIyBMb2NhdGUgdGhlIG9mZnNldCBvZiB0aGUgaW5pdGlhbCBpbnRQdHIKICAgICRPZmZzZXQgPSAkUHRySW5mby5Ub0ludDY0KCkKCiAgICBXcml0ZS1EZWJ1ZyAiR2V0LU5ldFNlc3Npb24gcmVzdWx0IGZvciAkQ29tcHV0ZXIgOiAkUmVzdWx0IgoKICAgICMgMCA9IHN1Y2Nlc3MKICAgIGlmICgoJFJlc3VsdCAtZXEgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgIyBXb3JrIG91dCBob3cgbXV0Y2ggdG8gaW5jcmVtZW50IHRoZSBwb2ludGVyIGJ5IGZpbmRpbmcgb3V0IHRoZSBzaXplIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAkSW5jcmVtZW50ID0gJFNFU1NJT05fSU5GT18xMDo6R2V0U2l6ZSgpCgogICAgICAgICMgcGFyc2UgYWxsIHRoZSByZXN1bHQgc3RydWN0dXJlcwogICAgICAgIGZvciAoJGkgPSAwOyAoJGkgLWx0ICRFbnRyaWVzUmVhZCk7ICRpKyspIHsKICAgICAgICAgICAgIyBjcmVhdGUgYSBuZXcgaW50IHB0ciBhdCB0aGUgZ2l2ZW4gb2Zmc2V0IGFuZCBjYXN0CiAgICAgICAgICAgICMgdGhlIHBvaW50ZXIgYXMgb3VyIHJlc3VsdCBzdHJ1Y3R1cmUKICAgICAgICAgICAgJE5ld0ludFB0ciA9IE5ldy1PYmplY3QgU3lzdGVtLkludHB0ciAtQXJndW1lbnRMaXN0ICRPZmZzZXQKICAgICAgICAgICAgJEluZm8gPSAkTmV3SW50UHRyIC1hcyAkU0VTU0lPTl9JTkZPXzEwCgogICAgICAgICAgICAjIHJldHVybiBhbGwgdGhlIHNlY3Rpb25zIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgJFNlc3Npb25zID0gJEluZm8gfCBTZWxlY3QtT2JqZWN0ICoKICAgICAgICAgICAgJFNlc3Npb25zIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyCiAgICAgICAgICAgICRPZmZzZXQgPSAkTmV3SW50UHRyLlRvSW50NjQoKQogICAgICAgICAgICAkT2Zmc2V0ICs9ICRJbmNyZW1lbnQKICAgICAgICAgICAgJFNlc3Npb25zCiAgICAgICAgfQogICAgICAgICMgZnJlZSB1cCB0aGUgcmVzdWx0IGJ1ZmZlcgogICAgICAgICROdWxsID0gJE5ldGFwaTMyOjpOZXRBcGlCdWZmZXJGcmVlKCRQdHJJbmZvKQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHN3aXRjaCAoJFJlc3VsdCkgewogICAgICAgICAgICAoNSkgICAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhY2Nlc3MgdG8gdGhlIHJlcXVlc3RlZCBpbmZvcm1hdGlvbi4nfQogICAgICAgICAgICAoMTI0KSAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIHZhbHVlIHNwZWNpZmllZCBmb3IgdGhlIGxldmVsIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgKDg3KSAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAoMjM0KSAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnTW9yZSBlbnRyaWVzIGFyZSBhdmFpbGFibGUuIFNwZWNpZnkgYSBsYXJnZSBlbm91Z2ggYnVmZmVyIHRvIHJlY2VpdmUgYWxsIGVudHJpZXMuJ30KICAgICAgICAgICAgKDgpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ0luc3VmZmljaWVudCBtZW1vcnkgaXMgYXZhaWxhYmxlLid9CiAgICAgICAgICAgICgyMzEyKSAgICAgICAge1dyaXRlLURlYnVnICdBIHNlc3Npb24gZG9lcyBub3QgZXhpc3Qgd2l0aCB0aGUgY29tcHV0ZXIgbmFtZS4nfQogICAgICAgICAgICAoMjM1MSkgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIGNvbXB1dGVyIG5hbWUgaXMgbm90IHZhbGlkLid9CiAgICAgICAgICAgICgyMjIxKSAgICAgICAge1dyaXRlLURlYnVnICdVc2VybmFtZSBub3QgZm91bmQuJ30KICAgICAgICAgICAgKDUzKSAgICAgICAgICB7V3JpdGUtRGVidWcgJ0hvc3RuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZCd9CiAgICAgICAgfQogICAgfQp9CgoKZmlsdGVyIEdldC1OZXRSRFBTZXNzaW9uIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHdpbGwgZXhlY3V0ZSB0aGUgV1RTRW51bWVyYXRlU2Vzc2lvbnNFeCBhbmQgCiAgICAgICAgV1RTUXVlcnlTZXNzaW9uSW5mb3JtYXRpb24gV2luMzJBUEkgY2FsbHMgdG8gcXVlcnkgYSBnaXZlbgogICAgICAgIFJEUCByZW1vdGUgc2VydmljZSBmb3IgYWN0aXZlIHNlc3Npb25zIGFuZCBvcmlnaW5hdGluZyBJUHMuCiAgICAgICAgVGhpcyBpcyBhIHJlcGxhY2VtZW50IGZvciBxd2luc3RhLgoKICAgICAgICBOb3RlOiBvbmx5IG1lbWJlcnMgb2YgdGhlIEFkbWluaXN0cmF0b3JzIG9yIEFjY291bnQgT3BlcmF0b3JzIGxvY2FsIGdyb3VwCiAgICAgICAgY2FuIHN1Y2Nlc3NmdWxseSBleGVjdXRlIHRoaXMgZnVuY3Rpb25hbGl0eSBvbiBhIHJlbW90ZSB0YXJnZXQuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGhvc3RuYW1lIHRvIHF1ZXJ5IGZvciBhY3RpdmUgUkRQIHNlc3Npb25zLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFJEUFNlc3Npb24KCiAgICAgICAgUmV0dXJucyBhY3RpdmUgUkRQL3Rlcm1pbmFsIHNlc3Npb25zIG9uIHRoZSBsb2NhbCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFJEUFNlc3Npb24gLUNvbXB1dGVyTmFtZSAic3Fsc2VydmVyIgoKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBSRFAvdGVybWluYWwgc2Vzc2lvbnMgb24gdGhlICdzcWxzZXJ2ZXInIGhvc3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluQ29udHJvbGxlciB8IEdldC1OZXRSRFBTZXNzaW9uCgogICAgICAgIFJldHVybnMgYWN0aXZlIFJEUC90ZXJtaW5hbCBzZXNzaW9ucyBvbiBhbGwgZG9tYWluIGNvbnRyb2xsZXJzLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW09iamVjdFtdXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICdsb2NhbGhvc3QnCiAgICApCgogICAgIyBleHRyYWN0IHRoZSBjb21wdXRlciBuYW1lIGZyb20gd2hhdGV2ZXIgb2JqZWN0IHdhcyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAkQ29tcHV0ZXIgPSAkQ29tcHV0ZXJOYW1lIHwgR2V0LU5hbWVGaWVsZAoKICAgICMgb3BlbiB1cCBhIGhhbmRsZSB0byB0aGUgUmVtb3RlIERlc2t0b3AgU2Vzc2lvbiBob3N0CiAgICAkSGFuZGxlID0gJFd0c2FwaTMyOjpXVFNPcGVuU2VydmVyRXgoJENvbXB1dGVyKQoKICAgICMgaWYgd2UgZ2V0IGEgbm9uLXplcm8gaGFuZGxlIGJhY2ssIGV2ZXJ5dGhpbmcgd2FzIHN1Y2Nlc3NmdWwKICAgIGlmICgkSGFuZGxlIC1uZSAwKSB7CgogICAgICAgIFdyaXRlLURlYnVnICJXVFNPcGVuU2VydmVyRXggaGFuZGxlOiAkSGFuZGxlIgoKICAgICAgICAjIGFyZ3VtZW50cyBmb3IgV1RTRW51bWVyYXRlU2Vzc2lvbnNFeAogICAgICAgICRwcFNlc3Npb25JbmZvID0gW0ludFB0cl06Olplcm8KICAgICAgICAkcENvdW50ID0gMAogICAgICAgIAogICAgICAgICMgZ2V0IGluZm9ybWF0aW9uIG9uIGFsbCBjdXJyZW50IHNlc3Npb25zCiAgICAgICAgJFJlc3VsdCA9ICRXdHNhcGkzMjo6V1RTRW51bWVyYXRlU2Vzc2lvbnNFeCgkSGFuZGxlLCBbcmVmXTEsIDAsIFtyZWZdJHBwU2Vzc2lvbkluZm8sIFtyZWZdJHBDb3VudCkKCiAgICAgICAgIyBMb2NhdGUgdGhlIG9mZnNldCBvZiB0aGUgaW5pdGlhbCBpbnRQdHIKICAgICAgICAkT2Zmc2V0ID0gJHBwU2Vzc2lvbkluZm8uVG9JbnQ2NCgpCgogICAgICAgIFdyaXRlLURlYnVnICJXVFNFbnVtZXJhdGVTZXNzaW9uc0V4IHJlc3VsdDogJFJlc3VsdCIKICAgICAgICBXcml0ZS1EZWJ1ZyAicENvdW50OiAkcENvdW50IgoKICAgICAgICBpZiAoKCRSZXN1bHQgLW5lIDApIC1hbmQgKCRPZmZzZXQgLWd0IDApKSB7CgogICAgICAgICAgICAjIFdvcmsgb3V0IGhvdyBtdXRjaCB0byBpbmNyZW1lbnQgdGhlIHBvaW50ZXIgYnkgZmluZGluZyBvdXQgdGhlIHNpemUgb2YgdGhlIHN0cnVjdHVyZQogICAgICAgICAgICAkSW5jcmVtZW50ID0gJFdUU19TRVNTSU9OX0lORk9fMTo6R2V0U2l6ZSgpCgogICAgICAgICAgICAjIHBhcnNlIGFsbCB0aGUgcmVzdWx0IHN0cnVjdHVyZXMKICAgICAgICAgICAgZm9yICgkaSA9IDA7ICgkaSAtbHQgJHBDb3VudCk7ICRpKyspIHsKIAogICAgICAgICAgICAgICAgIyBjcmVhdGUgYSBuZXcgaW50IHB0ciBhdCB0aGUgZ2l2ZW4gb2Zmc2V0IGFuZCBjYXN0CiAgICAgICAgICAgICAgICAjICAgdGhlIHBvaW50ZXIgYXMgb3VyIHJlc3VsdCBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICROZXdJbnRQdHIgPSBOZXctT2JqZWN0IFN5c3RlbS5JbnRwdHIgLUFyZ3VtZW50TGlzdCAkT2Zmc2V0CiAgICAgICAgICAgICAgICAkSW5mbyA9ICROZXdJbnRQdHIgLWFzICRXVFNfU0VTU0lPTl9JTkZPXzEKCiAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiA9IE5ldy1PYmplY3QgUFNPYmplY3QKCiAgICAgICAgICAgICAgICBpZiAoJEluZm8ucEhvc3ROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgJFJEUFNlc3Npb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkSW5mby5wSG9zdE5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICMgaWYgbm8gaG9zdG5hbWUgcmV0dXJuZWQsIHVzZSB0aGUgc3BlY2lmaWVkIGhvc3RuYW1lCiAgICAgICAgICAgICAgICAgICAgJFJEUFNlc3Npb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXIKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTZXNzaW9uTmFtZScgJEluZm8ucFNlc3Npb25OYW1lCgogICAgICAgICAgICAgICAgaWYgKCQoLW5vdCAkSW5mby5wRG9tYWluTmFtZSkgLW9yICgkSW5mby5wRG9tYWluTmFtZSAtZXEgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgIyBpZiBhIGRvbWFpbiBpc24ndCByZXR1cm5lZCBqdXN0IHVzZSB0aGUgdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgIiQoJEluZm8ucFVzZXJOYW1lKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAiJCgkSW5mby5wRG9tYWluTmFtZSlcJCgkSW5mby5wVXNlck5hbWUpIgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lEJyAkSW5mby5TZXNzaW9uSUQKICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1N0YXRlJyAkSW5mby5TdGF0ZQoKICAgICAgICAgICAgICAgICRwcEJ1ZmZlciA9IFtJbnRQdHJdOjpaZXJvCiAgICAgICAgICAgICAgICAkcEJ5dGVzUmV0dXJuZWQgPSAwCgogICAgICAgICAgICAgICAgIyBxdWVyeSBmb3IgdGhlIHNvdXJjZSBjbGllbnQgSVAgd2l0aCBXVFNRdWVyeVNlc3Npb25JbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgIyAgIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvYWEzODM4NjEodj12cy44NSkuYXNweAogICAgICAgICAgICAgICAgJFJlc3VsdDIgPSAkV3RzYXBpMzI6OldUU1F1ZXJ5U2Vzc2lvbkluZm9ybWF0aW9uKCRIYW5kbGUsICRJbmZvLlNlc3Npb25JRCwgMTQsIFtyZWZdJHBwQnVmZmVyLCBbcmVmXSRwQnl0ZXNSZXR1cm5lZCkKCiAgICAgICAgICAgICAgICAkT2Zmc2V0MiA9ICRwcEJ1ZmZlci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICROZXdJbnRQdHIyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldDIKICAgICAgICAgICAgICAgICRJbmZvMiA9ICROZXdJbnRQdHIyIC1hcyAkV1RTX0NMSUVOVF9BRERSRVNTCgogICAgICAgICAgICAgICAgJFNvdXJjZUlQID0gJEluZm8yLkFkZHJlc3MgICAgICAgCiAgICAgICAgICAgICAgICBpZigkU291cmNlSVBbMl0gLW5lIDApIHsKICAgICAgICAgICAgICAgICAgICAkU291cmNlSVAgPSBbU3RyaW5nXSRTb3VyY2VJUFsyXSsiLiIrW1N0cmluZ10kU291cmNlSVBbM10rIi4iK1tTdHJpbmddJFNvdXJjZUlQWzRdKyIuIitbU3RyaW5nXSRTb3VyY2VJUFs1XQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNvdXJjZUlQID0gJE51bGwKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTb3VyY2VJUCcgJFNvdXJjZUlQCiAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbgoKICAgICAgICAgICAgICAgICMgZnJlZSB1cCB0aGUgbWVtb3J5IGJ1ZmZlcgogICAgICAgICAgICAgICAgJE51bGwgPSAkV3RzYXBpMzI6OldUU0ZyZWVNZW1vcnkoJHBwQnVmZmVyKQoKICAgICAgICAgICAgICAgICRPZmZzZXQgKz0gJEluY3JlbWVudAogICAgICAgICAgICB9CiAgICAgICAgICAgICMgZnJlZSB1cCB0aGUgbWVtb3J5IHJlc3VsdCBidWZmZXIKICAgICAgICAgICAgJE51bGwgPSAkV3RzYXBpMzI6OldUU0ZyZWVNZW1vcnlFeCgyLCAkcHBTZXNzaW9uSW5mbywgJHBDb3VudCkKICAgICAgICB9CiAgICAgICAgIyBDbG9zZSBvZmYgdGhlIHNlcnZpY2UgaGFuZGxlCiAgICAgICAgJE51bGwgPSAkV3RzYXBpMzI6OldUU0Nsb3NlU2VydmVyKCRIYW5kbGUpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAjIG90aGVyd2lzZSBpdCBmYWlsZWQgLSBnZXQgdGhlIGxhc3QgZXJyb3IKICAgICAgICAjICAgZXJyb3IgY29kZXMgLSBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjgxMzgyKHY9dnMuODUpLmFzcHgKICAgICAgICAkRXJyID0gJEtlcm5lbDMyOjpHZXRMYXN0RXJyb3IoKQogICAgICAgIFdyaXRlLVZlcmJvc2UgIkxhc3RFcnJvcjogJEVyciIKICAgIH0KfQoKCmZpbHRlciBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHdpbGwgdXNlIHRoZSBPcGVuU0NNYW5hZ2VyVyBXaW4zMkFQSSBjYWxsIHRvIGVzdGFibGlzaAogICAgICAgIGEgaGFuZGxlIHRvIHRoZSByZW1vdGUgaG9zdC4gSWYgdGhpcyBzdWNjZWVkcywgdGhlIGN1cnJlbnQgdXNlciBjb250ZXh0CiAgICAgICAgaGFzIGxvY2FsIGFkbWluaXN0cmF0b3IgYWNlc3MgdG8gdGhlIHRhcmdldC4KCiAgICAgICAgSWRlYSBzdG9sZW4gZnJvbSB0aGUgbG9jYWxfYWRtaW5fc2VhcmNoX2VudW0gcG9zdCBtb2R1bGUgaW4gTWV0YXNwbG9pdCB3cml0dGVuIGJ5OgogICAgICAgICAgICAnQnJhbmRvbiBNY0Nhbm4gInpla25veCIgPGJtY2Nhbm5bYXRdYWNjdXZhbnQuY29tPicKICAgICAgICAgICAgJ1Rob21hcyBNY0NhcnRoeSAic21pbGluZ3JhY2Nvb24iIDxzbWlsaW5ncmFjY29vblthdF1nbWFpbC5jb20+JwogICAgICAgICAgICAnUm95Y2UgRGF2aXMgInIzZHkiIDxyZGF2aXNbYXRdYWNjdXZhbnQuY29tPicKCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgZm9yIGFjdGl2ZSBzZXNzaW9ucy4KCiAgICAuT1VUUFVUUwoKICAgICAgICAkVHJ1ZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbCBhZG1pbiBhY2Nlc3MgdG8gdGhlIGhvc3RuYW1lLCAkRmFsc2Ugb3RoZXJ3aXNlCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlck5hbWUgc3Fsc2VydmVyCgogICAgICAgIFJldHVybnMgYWN0aXZlIHNlc3Npb25zIG9uIHRoZSBsb2NhbCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldENvbXB1dGVyIHwgSW52b2tlLUNoZWNrTG9jYWxBZG1pbkFjY2VzcwoKICAgICAgICBTZWVzIHdoYXQgbWFjaGluZXMgaW4gdGhlIGRvbWFpbiB0aGUgY3VycmVudCB1c2VyIGhhcyBhY2Nlc3MgdG8uCgogICAgLkxJTksKCiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yay9ibG9iL21hc3Rlci9tb2R1bGVzL3Bvc3Qvd2luZG93cy9nYXRoZXIvbG9jYWxfYWRtaW5fc2VhcmNoX2VudW0ucmIKICAgICAgICBodHRwOi8vd3d3LnBvd2Vyc2hlbGxtYWdhemluZS5jb20vMjAxNC8wOS8yNS9lYXNpbHktZGVmaW5pbmctZW51bXMtc3RydWN0cy1hbmQtd2luMzItZnVuY3Rpb25zLWluLW1lbW9yeS8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JwogICAgKQoKICAgICMgZXh0cmFjdCB0aGUgY29tcHV0ZXIgbmFtZSBmcm9tIHdoYXRldmVyIG9iamVjdCB3YXMgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgJENvbXB1dGVyID0gJENvbXB1dGVyTmFtZSB8IEdldC1OYW1lRmllbGQKCiAgICAjIDB4RjAwM0YgLSBTQ19NQU5BR0VSX0FMTF9BQ0NFU1MKICAgICMgICBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjg1OTgxKHY9dnMuODUpLmFzcHgKICAgICRIYW5kbGUgPSAkQWR2YXBpMzI6Ok9wZW5TQ01hbmFnZXJXKCJcXCRDb21wdXRlciIsICdTZXJ2aWNlc0FjdGl2ZScsIDB4RjAwM0YpCgogICAgV3JpdGUtRGVidWcgIkludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3MgaGFuZGxlOiAkSGFuZGxlIgoKICAgICRJc0FkbWluID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgJElzQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXIKCiAgICAjIGlmIHdlIGdldCBhIG5vbi16ZXJvIGhhbmRsZSBiYWNrLCBldmVyeXRoaW5nIHdhcyBzdWNjZXNzZnVsCiAgICBpZiAoJEhhbmRsZSAtbmUgMCkgewogICAgICAgICMgQ2xvc2Ugb2ZmIHRoZSBzZXJ2aWNlIGhhbmRsZQogICAgICAgICROdWxsID0gJEFkdmFwaTMyOjpDbG9zZVNlcnZpY2VIYW5kbGUoJEhhbmRsZSkKICAgICAgICAkSXNBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0FkbWluJyAkVHJ1ZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgIyBvdGhlcndpc2UgaXQgZmFpbGVkIC0gZ2V0IHRoZSBsYXN0IGVycm9yCiAgICAgICAgIyAgIGVycm9yIGNvZGVzIC0gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4Mih2PXZzLjg1KS5hc3B4CiAgICAgICAgJEVyciA9ICRLZXJuZWwzMjo6R2V0TGFzdEVycm9yKCkKICAgICAgICBXcml0ZS1EZWJ1ZyAiSW52b2tlLUNoZWNrTG9jYWxBZG1pbkFjY2VzcyBMYXN0RXJyb3I6ICRFcnIiCiAgICAgICAgJElzQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNBZG1pbicgJEZhbHNlCiAgICB9CgogICAgJElzQWRtaW4KfQoKCmZpbHRlciBHZXQtU2l0ZU5hbWUgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCB1c2UgdGhlIERzR2V0U2l0ZU5hbWUgV2luMzJBUEkgY2FsbCB0byBsb29rIHVwIHRoZQogICAgICAgIG5hbWUgb2YgdGhlIHNpdGUgd2hlcmUgYSBzcGVjaWZpZWQgY29tcHV0ZXIgcmVzaWRlcy4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gbG9vayB0aGUgc2l0ZSB1cCBmb3IsIGRlZmF1bHQgdG8gbG9jYWxob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVNpdGVOYW1lIC1Db21wdXRlck5hbWUgV0lORE9XUzEKCiAgICAgICAgUmV0dXJucyB0aGUgc2l0ZSBmb3IgV0lORE9XUzEudGVzdGxhYi5sb2NhbC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRDb21wdXRlciB8IEludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3MKCiAgICAgICAgUmV0dXJucyB0aGUgc2l0ZXMgZm9yIGV2ZXJ5IG1hY2hpbmUgaW4gQUQuCiM+CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAkRW52OkNvbXB1dGVyTmFtZQogICAgKQoKICAgICMgZXh0cmFjdCB0aGUgY29tcHV0ZXIgbmFtZSBmcm9tIHdoYXRldmVyIG9iamVjdCB3YXMgcGFzc2VkIG9uIHRoZSBwaXBlbGluZQogICAgJENvbXB1dGVyID0gJENvbXB1dGVyTmFtZSB8IEdldC1OYW1lRmllbGQKCiAgICAjIGlmIHdlIGdldCBhbiBJUCBhZGRyZXNzLCB0cnkgdG8gcmVzb2x2ZSB0aGUgSVAgdG8gYSBob3N0bmFtZQogICAgaWYoJENvbXB1dGVyIC1tYXRjaCAnXig/OlswLTldezEsM31cLil7M31bMC05XXsxLDN9JCcpIHsKICAgICAgICAkSVBBZGRyZXNzID0gJENvbXB1dGVyCiAgICAgICAgJENvbXB1dGVyID0gW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEJ5QWRkcmVzcygkQ29tcHV0ZXIpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkSVBBZGRyZXNzID0gQChHZXQtSVBBZGRyZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyKVswXS5JUEFkZHJlc3MKICAgIH0KCiAgICAkUHRySW5mbyA9IFtJbnRQdHJdOjpaZXJvCgogICAgJFJlc3VsdCA9ICROZXRhcGkzMjo6RHNHZXRTaXRlTmFtZSgkQ29tcHV0ZXIsIFtyZWZdJFB0ckluZm8pCiAgICBXcml0ZS1EZWJ1ZyAiR2V0LVNpdGVOYW1lIHJlc3VsdCBmb3IgJENvbXB1dGVyIDogJFJlc3VsdCIKCiAgICAkQ29tcHV0ZXJTaXRlID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgJENvbXB1dGVyU2l0ZSB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlcgogICAgJENvbXB1dGVyU2l0ZSB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJUEFkZHJlc3MnICRJUEFkZHJlc3MKCiAgICBpZiAoJFJlc3VsdCAtZXEgMCkgewogICAgICAgICRTaXRlbmFtZSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlB0clRvU3RyaW5nQXV0bygkUHRySW5mbykKICAgICAgICAkQ29tcHV0ZXJTaXRlIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NpdGVOYW1lJyAkU2l0ZW5hbWUKICAgIH0KICAgIGVsc2VpZigkUmVzdWx0IC1lcSAxMjEwKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29tcHV0ZXJuYW1lICckQ29tcHV0ZXInIGlzIG5vdCBpbiBhIHZhbGlkIGZvcm0uIgogICAgICAgICRDb21wdXRlclNpdGUgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU2l0ZU5hbWUnICdFUlJPUicKICAgIH0KICAgIGVsc2VpZigkUmVzdWx0IC1lcSAxOTE5KSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29tcHV0ZXIgJyRDb21wdXRlcicgaXMgbm90IGluIGEgc2l0ZSIKICAgICAgICAKICAgICAgICAkQ29tcHV0ZXJTaXRlIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NpdGVOYW1lJyAkTnVsbAogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXJyb3IiCiAgICAgICAgJENvbXB1dGVyU2l0ZSB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTaXRlTmFtZScgJ0VSUk9SJwogICAgfQoKICAgICROdWxsID0gJE5ldGFwaTMyOjpOZXRBcGlCdWZmZXJGcmVlKCRQdHJJbmZvKQogICAgJENvbXB1dGVyU2l0ZQp9CgoKZmlsdGVyIEdldC1MYXN0TG9nZ2VkT24gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gdXNlcyByZW1vdGUgcmVnaXN0cnkgZnVuY3Rpb25hbGl0eSB0byByZXR1cm4KICAgICAgICB0aGUgbGFzdCB1c2VyIGxvZ2dlZCBvbnRvIGEgdGFyZ2V0IG1hY2hpbmUuCgogICAgICAgIE5vdGU6IFRoaXMgZnVuY3Rpb24gcmVxdWlyZXMgYWRtaW5pc3RyYXRpdmUgcmlnaHRzIG9uIHRoZQogICAgICAgIG1hY2hpbmUgeW91J3JlIGVudW1lcmF0aW5nLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBob3N0bmFtZSB0byBxdWVyeSBmb3IgdGhlIGxhc3QgbG9nZ2VkIG9uIHVzZXIuCiAgICAgICAgRGVmYXVsdHMgdG8gdGhlIGxvY2FsaG9zdC4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IGZvciB0aGUgcmVtb3RlIGNvbm5lY3Rpb24uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTGFzdExvZ2dlZE9uCgogICAgICAgIFJldHVybnMgdGhlIGxhc3QgdXNlciBsb2dnZWQgb250byB0aGUgbG9jYWwgbWFjaGluZS4KCiAgICAuRVhBTVBMRQogICAgICAgIAogICAgICAgIFBTIEM6XD4gR2V0LUxhc3RMb2dnZWRPbiAtQ29tcHV0ZXJOYW1lIFdJTkRPV1MxCgogICAgICAgIFJldHVybnMgdGhlIGxhc3QgdXNlciBsb2dnZWQgb250byBXSU5ET1dTMQoKICAgIC5FWEFNUExFCiAgICAgICAgCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIgfCBHZXQtTGFzdExvZ2dlZE9uCgogICAgICAgIFJldHVybnMgdGhlIGxhc3QgdXNlciBsb2dnZWQgb250byBhbGwgbWFjaGluZXMgaW4gdGhlIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICAjIGV4dHJhY3QgdGhlIGNvbXB1dGVyIG5hbWUgZnJvbSB3aGF0ZXZlciBvYmplY3Qgd2FzIHBhc3NlZCBvbiB0aGUgcGlwZWxpbmUKICAgICRDb21wdXRlciA9ICRDb21wdXRlck5hbWUgfCBHZXQtTmFtZUZpZWxkCgogICAgIyBIS0VZX0xPQ0FMX01BQ0hJTkUKICAgICRIS0xNID0gMjE0NzQ4MzY1MAoKICAgICMgdHJ5IHRvIG9wZW4gdXAgdGhlIHJlbW90ZSByZWdpc3RyeSBrZXkgdG8gZ3JhYiB0aGUgbGFzdCBsb2dnZWQgb24gdXNlcgogICAgdHJ5IHsKCiAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgJFJlZyA9IEdldC1XbWlPYmplY3QgLUxpc3QgJ1N0ZFJlZ1Byb3YnIC1OYW1lc3BhY2Ugcm9vdFxkZWZhdWx0IC1Db21wdXRlcm5hbWUgJENvbXB1dGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkUmVnID0gR2V0LVdtaU9iamVjdCAtTGlzdCAnU3RkUmVnUHJvdicgLU5hbWVzcGFjZSByb290XGRlZmF1bHQgLUNvbXB1dGVybmFtZSAkQ29tcHV0ZXIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICB9CgogICAgICAgICRLZXkgPSAiU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXV0aGVudGljYXRpb25cTG9nb25VSSIKICAgICAgICAkVmFsdWUgPSAiTGFzdExvZ2dlZE9uVXNlciIKICAgICAgICAkTGFzdFVzZXIgPSAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS0xNLCAkS2V5LCAkVmFsdWUpLnNWYWx1ZQoKICAgICAgICAkTGFzdExvZ2dlZE9uID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICRMYXN0TG9nZ2VkT24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXIKICAgICAgICAkTGFzdExvZ2dlZE9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0xhc3RMb2dnZWRPbicgJExhc3RVc2VyCiAgICAgICAgJExhc3RMb2dnZWRPbgogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLVdhcm5pbmcgIlshXSBFcnJvciBvcGVuaW5nIHJlbW90ZSByZWdpc3RyeSBvbiAkQ29tcHV0ZXIuIFJlbW90ZSByZWdpc3RyeSBsaWtlbHkgbm90IGVuYWJsZWQuIgogICAgfQp9CgoKZmlsdGVyIEdldC1DYWNoZWRSRFBDb25uZWN0aW9uIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBVc2VzIHJlbW90ZSByZWdpc3RyeSBmdW5jdGlvbmFsaXR5IHRvIHF1ZXJ5IGFsbCBlbnRyaWVzIGZvciB0aGUKICAgICAgICAiV2luZG93cyBSZW1vdGUgRGVza3RvcCBDb25uZWN0aW9uIENsaWVudCIgb24gYSBtYWNoaW5lLCBzZXBhcmF0ZWQgYnkKICAgICAgICB1c2VyIGFuZCB0YXJnZXQgc2VydmVyLgoKICAgICAgICBOb3RlOiBUaGlzIGZ1bmN0aW9uIHJlcXVpcmVzIGFkbWluaXN0cmF0aXZlIHJpZ2h0cyBvbiB0aGUKICAgICAgICBtYWNoaW5lIHlvdSdyZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgZm9yIFJEUCBjbGllbnQgaW5mb3JtYXRpb24uCiAgICAgICAgRGVmYXVsdHMgdG8gbG9jYWxob3N0LgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3QgZm9yIHRoZSByZW1vdGUgY29ubmVjdGlvbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1DYWNoZWRSRFBDb25uZWN0aW9uCgogICAgICAgIFJldHVybnMgdGhlIFJEUCBjb25uZWN0aW9uIGNsaWVudCBpbmZvcm1hdGlvbiBmb3IgdGhlIGxvY2FsIG1hY2hpbmUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtQ2FjaGVkUkRQQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lIFdJTkRPV1MyLnRlc3RsYWIubG9jYWwKCiAgICAgICAgUmV0dXJucyB0aGUgUkRQIGNvbm5lY3Rpb24gY2xpZW50IGluZm9ybWF0aW9uIGZvciB0aGUgV0lORE9XUzIudGVzdGxhYi5sb2NhbCBtYWNoaW5lCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtQ2FjaGVkUkRQQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lIFdJTkRPV1MyLnRlc3RsYWIubG9jYWwgLUNyZWRlbnRpYWwgJENyZWQKCiAgICAgICAgUmV0dXJucyB0aGUgUkRQIGNvbm5lY3Rpb24gY2xpZW50IGluZm9ybWF0aW9uIGZvciB0aGUgV0lORE9XUzIudGVzdGxhYi5sb2NhbCBtYWNoaW5lIHVzaW5nIGFsdGVybmF0ZSBjcmVkZW50aWFscy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRDb21wdXRlciB8IEdldC1DYWNoZWRSRFBDb25uZWN0aW9uCgogICAgICAgIEdldCBjYWNoZWQgUkRQIGluZm9ybWF0aW9uIGZvciBhbGwgbWFjaGluZXMgaW4gdGhlIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICAjIGV4dHJhY3QgdGhlIGNvbXB1dGVyIG5hbWUgZnJvbSB3aGF0ZXZlciBvYmplY3Qgd2FzIHBhc3NlZCBvbiB0aGUgcGlwZWxpbmUKICAgICRDb21wdXRlciA9ICRDb21wdXRlck5hbWUgfCBHZXQtTmFtZUZpZWxkCgogICAgIyBIS0VZX1VTRVJTCiAgICAkSEtVID0gMjE0NzQ4MzY1MQoKICAgIHRyeSB7CiAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgJFJlZyA9IEdldC1XbWlPYmplY3QgLUxpc3QgJ1N0ZFJlZ1Byb3YnIC1OYW1lc3BhY2Ugcm9vdFxkZWZhdWx0IC1Db21wdXRlcm5hbWUgJENvbXB1dGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkUmVnID0gR2V0LVdtaU9iamVjdCAtTGlzdCAnU3RkUmVnUHJvdicgLU5hbWVzcGFjZSByb290XGRlZmF1bHQgLUNvbXB1dGVybmFtZSAkQ29tcHV0ZXIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICB9CgogICAgICAgICMgZXh0cmFjdCBvdXQgdGhlIFNJRHMgb2YgZG9tYWluIHVzZXJzIGluIHRoaXMgaGl2ZQogICAgICAgICRVc2VyU0lEcyA9ICgkUmVnLkVudW1LZXkoJEhLVSwgIiIpKS5zTmFtZXMgfCA/IHsgJF8gLW1hdGNoICdTLTEtNS0yMS1bMC05XSstWzAtOV0rLVswLTldKy1bMC05XSskJyB9CgogICAgICAgIGZvcmVhY2ggKCRVc2VyU0lEIGluICRVc2VyU0lEcykgewoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRVc2VyTmFtZSA9IENvbnZlcnQtU2lkVG9OYW1lICRVc2VyU0lECgogICAgICAgICAgICAgICAgIyBwdWxsIG91dCBhbGwgdGhlIGNhY2hlZCBSRFAgY29ubmVjdGlvbnMKICAgICAgICAgICAgICAgICRDb25uZWN0aW9uS2V5cyA9ICRSZWcuRW51bVZhbHVlcygkSEtVLCIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxEZWZhdWx0Iikuc05hbWVzCgogICAgICAgICAgICAgICAgZm9yZWFjaCAoJENvbm5lY3Rpb24gaW4gJENvbm5lY3Rpb25LZXlzKSB7CiAgICAgICAgICAgICAgICAgICAgIyBtYWtlIHN1cmUgdGhpcyBrZXkgaXMgYSBjYWNoZWQgY29ubmVjdGlvbgogICAgICAgICAgICAgICAgICAgIGlmKCRDb25uZWN0aW9uIC1tYXRjaCAnTVJVLionKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRUYXJnZXRTZXJ2ZXIgPSAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS1UsICIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxEZWZhdWx0IiwgJENvbm5lY3Rpb24pLnNWYWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlcgogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAkVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyU0lEJyAkVXNlclNJRAogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RhcmdldFNlcnZlcicgJFRhcmdldFNlcnZlcgogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJuYW1lSGludCcgJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjIHB1bGwgb3V0IGFsbCB0aGUgY2FjaGVkIHNlcnZlciBpbmZvIHdpdGggdXNlcm5hbWUgaGludHMKICAgICAgICAgICAgICAgICRTZXJ2ZXJLZXlzID0gJFJlZy5FbnVtS2V5KCRIS1UsIiRVc2VyU0lEXFNvZnR3YXJlXE1pY3Jvc29mdFxUZXJtaW5hbCBTZXJ2ZXIgQ2xpZW50XFNlcnZlcnMiKS5zTmFtZXMKCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkU2VydmVyIGluICRTZXJ2ZXJLZXlzKSB7CgogICAgICAgICAgICAgICAgICAgICRVc2VybmFtZUhpbnQgPSAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS1UsICIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxTZXJ2ZXJzXCRTZXJ2ZXIiLCAnVXNlcm5hbWVIaW50Jykuc1ZhbHVlCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyCiAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgJFVzZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyU0lEJyAkVXNlclNJRAogICAgICAgICAgICAgICAgICAgICRGb3VuZENvbm5lY3Rpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVGFyZ2V0U2VydmVyJyAkU2VydmVyCiAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VybmFtZUhpbnQnICRVc2VybmFtZUhpbnQKICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uICAgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvcjogJF8iCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIGFjY2Vzc2luZyAkQ29tcHV0ZXIsIGxpa2VseSBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMgb3IgZmlyZXdhbGwgcnVsZXMgb24gaG9zdDogJF8iCiAgICB9Cn0KCgpmaWx0ZXIgR2V0LU5ldFByb2Nlc3Mgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEdldHMgYSBsaXN0IG9mIHByb2Nlc3Nlcy9vd25lcnMgb24gYSByZW1vdGUgbWFjaGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgcHJvY2Vzc2VzLiBEZWZhdWx0cyB0byB0aGUgbG9jYWwgaG9zdCBuYW1lLgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBBIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSBvYmplY3QgZm9yIHRoZSByZW1vdGUgY29ubmVjdGlvbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRQcm9jZXNzIC1Db21wdXRlck5hbWUgV0lORE9XUzEKICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgcHJvY2Vzc2VzIGZvciBXSU5ET1dTMQojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW09iamVjdFtdXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJENvbXB1dGVyTmFtZSA9IFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3ROYW1lKCksCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgIyBleHRyYWN0IHRoZSBjb21wdXRlciBuYW1lIGZyb20gd2hhdGV2ZXIgb2JqZWN0IHdhcyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAkQ29tcHV0ZXIgPSAkQ29tcHV0ZXJOYW1lIHwgR2V0LU5hbWVGaWVsZAoKICAgIHRyeSB7CiAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgJFByb2Nlc3NlcyA9IEdldC1XTUlvYmplY3QgLUNsYXNzIFdpbjMyX3Byb2Nlc3MgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1DcmVkZW50aWFsICRDcmVkZW50aWFsCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkUHJvY2Vzc2VzID0gR2V0LVdNSW9iamVjdCAtQ2xhc3MgV2luMzJfcHJvY2VzcyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICB9CgogICAgICAgICRQcm9jZXNzZXMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICRPd25lciA9ICRfLmdldG93bmVyKCk7CiAgICAgICAgICAgICRQcm9jZXNzID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAkUHJvY2VzcyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlcgogICAgICAgICAgICAkUHJvY2VzcyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdQcm9jZXNzTmFtZScgJF8uUHJvY2Vzc05hbWUKICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnUHJvY2Vzc0lEJyAkXy5Qcm9jZXNzSUQKICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRG9tYWluJyAkT3duZXIuRG9tYWluCiAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXInICRPd25lci5Vc2VyCiAgICAgICAgICAgICRQcm9jZXNzICAgICAgICAgICAgICAgIAogICAgICAgIH0KICAgIH0KICAgIGNhdGNoIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJbIV0gRXJyb3IgZW51bWVyYXRpbmcgcmVtb3RlIHByb2Nlc3NlcyBvbiAkQ29tcHV0ZXIsIGFjY2VzcyBsaWtlbHkgZGVuaWVkOiAkXyIKICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtSW50ZXJlc3RpbmdGaWxlIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHJlY3Vyc2l2ZWx5IHNlYXJjaGVzIGEgZ2l2ZW4gVU5DIHBhdGggZm9yIGZpbGVzIHdpdGgKICAgICAgICBzcGVjaWZpYyBrZXl3b3JkcyBpbiB0aGUgbmFtZSAoZGVmYXVsdCBvZiBwYXNzLCBzZW5zaXRpdmUsIHNlY3JldCwgYWRtaW4sCiAgICAgICAgbG9naW4gYW5kIHVuYXR0ZW5kKi54bWwpLiBUaGUgb3V0cHV0IGNhbiBiZSBwaXBlZCBvdXQgdG8gYSBjc3Ygd2l0aCB0aGUKICAgICAgICAtT3V0RmlsZSBmbGFnLiBCeSBkZWZhdWx0LCBoaWRkZW4gZmlsZXMvZm9sZGVycyBhcmUgaW5jbHVkZWQgaW4gc2VhcmNoIHJlc3VsdHMuCgogICAgLlBBUkFNRVRFUiBQYXRoCgogICAgICAgIFVOQy9sb2NhbCBwYXRoIHRvIHJlY3Vyc2l2ZWx5IHNlYXJjaC4KCiAgICAuUEFSQU1FVEVSIFRlcm1zCgogICAgICAgIFRlcm1zIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBPZmZpY2VEb2NzCgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGZvciBvZmZpY2UgZG9jdW1lbnRzICgqLmRvYyosICoueGxzKiwgKi5wcHQqKQoKICAgIC5QQVJBTUVURVIgRnJlc2hFWEVzCgogICAgICAgIFN3aXRjaC4gRmluZCAuRVhFcyBhY2Nlc3NlZCB3aXRoaW4gdGhlIGxhc3Qgd2Vlay4KCiAgICAuUEFSQU1FVEVSIExhc3RBY2Nlc3NUaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBMYXN0QWNjZXNzVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgTGFzdFdyaXRlVGltZQoKICAgICAgICBPbmx5IHJldHVybiBmaWxlcyB3aXRoIGEgTGFzdFdyaXRlVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgQ3JlYXRpb25UaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBDcmVhdGlvblRpbWUgZ3JlYXRlciB0aGFuIHRoaXMgZGF0ZSB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIEV4Y2x1ZGVGb2xkZXJzCgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSBmb2xkZXJzIGZyb20gdGhlIHNlYXJjaCByZXN1bHRzLgoKICAgIC5QQVJBTUVURVIgRXhjbHVkZUhpZGRlbgoKICAgICAgICBTd2l0Y2guIEV4Y2x1ZGUgaGlkZGVuIGZpbGVzIGFuZCBmb2xkZXJzIGZyb20gdGhlIHNlYXJjaCByZXN1bHRzLgoKICAgIC5QQVJBTUVURVIgQ2hlY2tXcml0ZUFjY2VzcwoKICAgICAgICBTd2l0Y2guIE9ubHkgcmV0dXJucyBmaWxlcyB0aGUgY3VycmVudCB1c2VyIGhhcyB3cml0ZSBhY2Nlc3MgdG8uCgogICAgLlBBUkFNRVRFUiBPdXRGaWxlCgogICAgICAgIE91dHB1dCByZXN1bHRzIHRvIGEgc3BlY2lmaWVkIGNzdiBvdXRwdXQgZmlsZS4KCiAgICAuUEFSQU1FVEVSIFVzZVBTRHJpdmUKCiAgICAgICAgU3dpdGNoLiBNb3VudCB0YXJnZXQgcmVtb3RlIHBhdGggd2l0aCB0ZW1wb3JhcnkgUFNEcml2ZXMuCgogICAgLk9VVFBVVFMKCiAgICAgICAgVGhlIGZ1bGwgcGF0aCwgb3duZXIsIGxhc3RhY2Nlc3MgdGltZSwgbGFzdHdyaXRlIHRpbWUsIGFuZCBzaXplIGZvciBlYWNoIGZvdW5kIGZpbGUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUludGVyZXN0aW5nRmlsZSAtUGF0aCBDOlxCYWNrdXBcCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbnkgZmlsZXMgb24gdGhlIGxvY2FsIHBhdGggQzpcQmFja3VwXCB0aGF0IGhhdmUgdGhlIGRlZmF1bHQKICAgICAgICBzZWFyY2ggdGVybSBzZXQgaW4gdGhlIHRpdGxlLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1JbnRlcmVzdGluZ0ZpbGUgLVBhdGggXFxXSU5ET1dTN1xVc2Vyc1wgLVRlcm1zIHNhbGFyaWVzLGVtYWlsIC1PdXRGaWxlIG91dC5jc3YKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFueSBmaWxlcyBvbiB0aGUgcmVtb3RlIHBhdGggXFxXSU5ET1dTN1xVc2Vyc1wgdGhhdCBoYXZlICdzYWxhcmllcycKICAgICAgICBvciAnZW1haWwnIGluIHRoZSB0aXRsZSwgYW5kIHdyaXRlcyB0aGUgcmVzdWx0cyBvdXQgdG8gYSBjc3YgZmlsZQogICAgICAgIG5hbWVkICdvdXQuY3N2JwoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1JbnRlcmVzdGluZ0ZpbGUgLVBhdGggXFxXSU5ET1dTN1xVc2Vyc1wgLUxhc3RBY2Nlc3NUaW1lIChHZXQtRGF0ZSkuQWRkRGF5cygtNykKCiAgICAgICAgUmV0dXJucyBhbnkgZmlsZXMgb24gdGhlIHJlbW90ZSBwYXRoIFxcV0lORE9XUzdcVXNlcnNcIHRoYXQgaGF2ZSB0aGUgZGVmYXVsdAogICAgICAgIHNlYXJjaCB0ZXJtIHNldCBpbiB0aGUgdGl0bGUgYW5kIHdlcmUgYWNjZXNzZWQgd2l0aGluIHRoZSBsYXN0IHdlZWsuCgogICAgLkxJTksKICAgICAgICAKICAgICAgICBodHRwOi8vd3d3Lmhhcm1qMHkubmV0L2Jsb2cvcmVkdGVhbWluZy9maWxlLXNlcnZlci10cmlhZ2Utb24tcmVkLXRlYW0tZW5nYWdlbWVudHMvCiM+CiAgICAKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGggPSAnLlwnLAoKICAgICAgICBbQWxpYXMoJ1Rlcm1zJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRTZWFyY2hUZXJtcyA9IEAoJ3Bhc3MnLCAnc2Vuc2l0aXZlJywgJ2FkbWluJywgJ2xvZ2luJywgJ3NlY3JldCcsICd1bmF0dGVuZCoueG1sJywgJy52bWRrJywgJ2NyZWRzJywgJ2NyZWRlbnRpYWwnLCAnLmNvbmZpZycpLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRPZmZpY2VEb2NzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGcmVzaEVYRXMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExhc3RBY2Nlc3NUaW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRMYXN0V3JpdGVUaW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDcmVhdGlvblRpbWUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEV4Y2x1ZGVGb2xkZXJzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlSGlkZGVuLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRDaGVja1dyaXRlQWNjZXNzLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRPdXRGaWxlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlCiAgICApCgogICAgYmVnaW4gewoKICAgICAgICAkUGF0aCArPSBpZighJFBhdGguRW5kc1dpdGgoJ1wnKSkgeyJcIn0KCiAgICAgICAgaWYgKCRDcmVkZW50aWFsKSB7CiAgICAgICAgICAgICRVc2VQU0RyaXZlID0gJFRydWUKICAgICAgICB9CgogICAgICAgICMgYXBwZW5kIHdpbGRjYXJkcyB0byB0aGUgZnJvbnQgYW5kIGJhY2sgb2YgYWxsIHNlYXJjaCB0ZXJtcwogICAgICAgICRTZWFyY2hUZXJtcyA9ICRTZWFyY2hUZXJtcyB8IEZvckVhY2gtT2JqZWN0IHsgaWYoJF8gLW5vdG1hdGNoICdeXCouKlwqJCcpIHsiKiQoJF8pKiJ9IGVsc2V7JF99IH0KCiAgICAgICAgIyBzZWFyY2gganVzdCBmb3Igb2ZmaWNlIGRvY3VtZW50cyBpZiBzcGVjaWZpZWQKICAgICAgICBpZiAoJE9mZmljZURvY3MpIHsKICAgICAgICAgICAgJFNlYXJjaFRlcm1zID0gQCgnKi5kb2MnLCAnKi5kb2N4JywgJyoueGxzJywgJyoueGxzeCcsICcqLnBwdCcsICcqLnBwdHgnKQogICAgICAgIH0KCiAgICAgICAgIyBmaW5kIC5leGUncyBhY2Nlc3NlZCB3aXRoaW4gdGhlIGxhc3QgNyBkYXlzCiAgICAgICAgaWYoJEZyZXNoRVhFcykgewogICAgICAgICAgICAjIGdldCBhbiBhY2Nlc3MgdGltZSBsaW1pdCBvZiA3IGRheXMgYWdvCiAgICAgICAgICAgICRMYXN0QWNjZXNzVGltZSA9IChHZXQtRGF0ZSkuQWRkRGF5cygtNykuVG9TdHJpbmcoJ01NL2RkL3l5eXknKQogICAgICAgICAgICAkU2VhcmNoVGVybXMgPSAnKi5leGUnCiAgICAgICAgfQoKICAgICAgICBpZigkVXNlUFNEcml2ZSkgewogICAgICAgICAgICAjIGlmIHdlJ3JlIFBTRHJpdmVzLCBjcmVhdGUgYSB0ZW1wb3JhcnkgbW91bnQgcG9pbnQKCiAgICAgICAgICAgICRQYXJ0cyA9ICRQYXRoLnNwbGl0KCdcJykKICAgICAgICAgICAgJEZvbGRlclBhdGggPSAkUGFydHNbMC4uKCRQYXJ0cy5sZW5ndGgtMildIC1qb2luICdcJwogICAgICAgICAgICAkRmlsZVBhdGggPSAkUGFydHNbLTFdCgogICAgICAgICAgICAkUmFuZERyaXZlID0gKCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIuVG9DaGFyQXJyYXkoKSB8IEdldC1SYW5kb20gLUNvdW50IDcpIC1qb2luICcnCiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJNb3VudGluZyBwYXRoICckUGF0aCcgdXNpbmcgYSB0ZW1wIFBTRHJpdmUgYXQgJFJhbmREcml2ZSIKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkTnVsbCA9IE5ldy1QU0RyaXZlIC1OYW1lICRSYW5kRHJpdmUgLVBTUHJvdmlkZXIgRmlsZVN5c3RlbSAtUm9vdCAkRm9sZGVyUGF0aCAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBtb3VudGluZyBwYXRoICckUGF0aCcgOiAkXyIKICAgICAgICAgICAgICAgIHJldHVybiAkTnVsbAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHNvIHdlIGNhbiBjZC9kaXIgdGhlIG5ldyBkcml2ZQogICAgICAgICAgICAkUGF0aCA9ICIke1JhbmREcml2ZX06XCR7RmlsZVBhdGh9IgogICAgICAgIH0KICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFNlYXJjaCBwYXRoICRQYXRoIgoKICAgICAgICBmdW5jdGlvbiBJbnZva2UtQ2hlY2tXcml0ZSB7CiAgICAgICAgICAgICMgc2hvcnQgaGVscGVyIHRvIGNoZWNrIGlzIHRoZSBjdXJyZW50IHVzZXIgY2FuIHdyaXRlIHRvIGEgZmlsZQogICAgICAgICAgICBbQ21kbGV0QmluZGluZygpXXBhcmFtKFtTdHJpbmddJFBhdGgpCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkRmlsZXRlc3QgPSBbSU8uRklMRV06Ok9wZW5Xcml0ZSgkUGF0aCkKICAgICAgICAgICAgICAgICRGaWxldGVzdC5DbG9zZSgpCiAgICAgICAgICAgICAgICAkVHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgJEVycm9yWzBdCiAgICAgICAgICAgICAgICAkRmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJFNlYXJjaEFyZ3MgPSAgQHsKICAgICAgICAgICAgJ1BhdGgnID0gJFBhdGgKICAgICAgICAgICAgJ1JlY3Vyc2UnID0gJFRydWUKICAgICAgICAgICAgJ0ZvcmNlJyA9ICQoLW5vdCAkRXhjbHVkZUhpZGRlbikKICAgICAgICAgICAgJ0luY2x1ZGUnID0gJFNlYXJjaFRlcm1zCiAgICAgICAgICAgICdFcnJvckFjdGlvbicgPSAnU2lsZW50bHlDb250aW51ZScKICAgICAgICB9CgogICAgICAgIEdldC1DaGlsZEl0ZW0gQFNlYXJjaEFyZ3MgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJF8KICAgICAgICAgICAgIyBjaGVjayBpZiB3ZSdyZSBleGNsdWRpbmcgZm9sZGVycwogICAgICAgICAgICBpZighJEV4Y2x1ZGVGb2xkZXJzIC1vciAhJF8uUFNJc0NvbnRhaW5lcikgeyRffQogICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIGlmKCRMYXN0QWNjZXNzVGltZSAtb3IgJExhc3RXcml0ZVRpbWUgLW9yICRDcmVhdGlvblRpbWUpIHsKICAgICAgICAgICAgICAgIGlmKCRMYXN0QWNjZXNzVGltZSAtYW5kICgkXy5MYXN0QWNjZXNzVGltZSAtZ3QgJExhc3RBY2Nlc3NUaW1lKSkgeyRffQogICAgICAgICAgICAgICAgZWxzZWlmKCRMYXN0V3JpdGVUaW1lIC1hbmQgKCRfLkxhc3RXcml0ZVRpbWUgLWd0ICRMYXN0V3JpdGVUaW1lKSkgeyRffQogICAgICAgICAgICAgICAgZWxzZWlmKCRDcmVhdGlvblRpbWUgLWFuZCAoJF8uQ3JlYXRpb25UaW1lIC1ndCAkQ3JlYXRpb25UaW1lKSkgeyRffQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgeyRffQogICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICMgZmlsdGVyIGZvciB3cml0ZSBhY2Nlc3MgKGlmIGFwcGxpY2FibGUpCiAgICAgICAgICAgIGlmKCgtbm90ICRDaGVja1dyaXRlQWNjZXNzKSAtb3IgKEludm9rZS1DaGVja1dyaXRlIC1QYXRoICRfLkZ1bGxOYW1lKSkgeyRffQogICAgICAgIH0gfCBTZWxlY3QtT2JqZWN0IEZ1bGxOYW1lLEB7TmFtZT0nT3duZXInO0V4cHJlc3Npb249eyhHZXQtQWNsICRfLkZ1bGxOYW1lKS5Pd25lcn19LExhc3RBY2Nlc3NUaW1lLExhc3RXcml0ZVRpbWUsQ3JlYXRpb25UaW1lLExlbmd0aCB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgIyBjaGVjayBpZiB3ZSdyZSBvdXRwdXR0aW5nIHRvIHRoZSBwaXBlbGluZSBvciBhbiBvdXRwdXQgZmlsZQogICAgICAgICAgICBpZigkT3V0RmlsZSkge0V4cG9ydC1Qb3dlclZpZXdDU1YgLUlucHV0T2JqZWN0ICRfIC1PdXRGaWxlICRPdXRGaWxlfQogICAgICAgICAgICBlbHNlIHskX30KICAgICAgICB9CiAgICB9CgogICAgZW5kIHsKICAgICAgICBpZigkVXNlUFNEcml2ZSAtYW5kICRSYW5kRHJpdmUpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUmVtb3ZpbmcgdGVtcCBQU0RyaXZlICRSYW5kRHJpdmUiCiAgICAgICAgICAgIEdldC1QU0RyaXZlIC1OYW1lICRSYW5kRHJpdmUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBSZW1vdmUtUFNEcml2ZSAtRm9yY2UKICAgICAgICB9CiAgICB9Cn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgJ01ldGEnLWZ1bmN0aW9ucyBzdGFydCBiZWxvdwojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiB7CiAgICAjIEhlbHBlciB1c2VkIGJ5IGFueSB0aHJlYWRlZCBob3N0IGVudW1lcmF0aW9uIGZ1bmN0aW9ucwogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnk9JFRydWUpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTEsTWFuZGF0b3J5PSRUcnVlKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5TY3JpcHRCbG9ja10KICAgICAgICAkU2NyaXB0QmxvY2ssCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MildCiAgICAgICAgW0hhc2h0YWJsZV0KICAgICAgICAkU2NyaXB0UGFyYW1ldGVycywKCiAgICAgICAgW0ludF0KICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgICRUaHJlYWRzID0gMjAsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vSW1wb3J0cwogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKCiAgICAgICAgIyBBZGFwdGVkIGZyb206CiAgICAgICAgIyAgIGh0dHA6Ly9wb3dlcnNoZWxsLm9yZy93cC9mb3J1bXMvdG9waWMvaW52cGtlLXBhcmFsbGVsLW5lZWQtaGVscC10by1jbG9uZS10aGUtY3VycmVudC1ydW5zcGFjZS8KICAgICAgICAkU2Vzc2lvblN0YXRlID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUnVuc3BhY2VzLkluaXRpYWxTZXNzaW9uU3RhdGVdOjpDcmVhdGVEZWZhdWx0KCkKICAgICAgICAkU2Vzc2lvblN0YXRlLkFwYXJ0bWVudFN0YXRlID0gW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6Q3VycmVudFRocmVhZC5HZXRBcGFydG1lbnRTdGF0ZSgpCgogICAgICAgICMgaW1wb3J0IHRoZSBjdXJyZW50IHNlc3Npb24gc3RhdGUncyB2YXJpYWJsZXMgYW5kIGZ1bmN0aW9ucyBzbyB0aGUgY2hhaW5lZCBQb3dlclZpZXcKICAgICAgICAjICAgZnVuY3Rpb25hbGl0eSBjYW4gYmUgdXNlZCBieSB0aGUgdGhyZWFkZWQgYmxvY2tzCiAgICAgICAgaWYoISROb0ltcG9ydHMpIHsKCiAgICAgICAgICAgICMgZ3JhYiBhbGwgdGhlIGN1cnJlbnQgdmFyaWFibGVzIGZvciB0aGlzIHJ1bnNwYWNlCiAgICAgICAgICAgICRNeVZhcnMgPSBHZXQtVmFyaWFibGUgLVNjb3BlIDIKCiAgICAgICAgICAgICMgdGhlc2UgVmFyaWFibGVzIGFyZSBhZGRlZCBieSBSdW5zcGFjZS5PcGVuKCkgTWV0aG9kIGFuZCBwcm9kdWNlIFN0b3AgZXJyb3JzIGlmIHlvdSBhZGQgdGhlbSB0d2ljZQogICAgICAgICAgICAkVm9yYmlkZGVuVmFycyA9IEAoIj8iLCJhcmdzIiwiQ29uc29sZUZpbGVOYW1lIiwiRXJyb3IiLCJFeGVjdXRpb25Db250ZXh0IiwiZmFsc2UiLCJIT01FIiwiSG9zdCIsImlucHV0IiwiSW5wdXRPYmplY3QiLCJNYXhpbXVtQWxpYXNDb3VudCIsIk1heGltdW1Ecml2ZUNvdW50IiwiTWF4aW11bUVycm9yQ291bnQiLCJNYXhpbXVtRnVuY3Rpb25Db3VudCIsIk1heGltdW1IaXN0b3J5Q291bnQiLCJNYXhpbXVtVmFyaWFibGVDb3VudCIsIk15SW52b2NhdGlvbiIsIm51bGwiLCJQSUQiLCJQU0JvdW5kUGFyYW1ldGVycyIsIlBTQ29tbWFuZFBhdGgiLCJQU0N1bHR1cmUiLCJQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXMiLCJQU0hPTUUiLCJQU1NjcmlwdFJvb3QiLCJQU1VJQ3VsdHVyZSIsIlBTVmVyc2lvblRhYmxlIiwiUFdEIiwiU2hlbGxJZCIsIlN5bmNocm9uaXplZEhhc2giLCJ0cnVlIikKCiAgICAgICAgICAgICMgQWRkIFZhcmlhYmxlcyBmcm9tIFBhcmVudCBTY29wZSAoY3VycmVudCBydW5zcGFjZSkgaW50byB0aGUgSW5pdGlhbFNlc3Npb25TdGF0ZQogICAgICAgICAgICBGb3JFYWNoKCRWYXIgaW4gJE15VmFycykgewogICAgICAgICAgICAgICAgaWYoJFZvcmJpZGRlblZhcnMgLU5vdENvbnRhaW5zICRWYXIuTmFtZSkgewogICAgICAgICAgICAgICAgJFNlc3Npb25TdGF0ZS5WYXJpYWJsZXMuQWRkKChOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlJ1bnNwYWNlcy5TZXNzaW9uU3RhdGVWYXJpYWJsZUVudHJ5IC1Bcmd1bWVudExpc3QgJFZhci5uYW1lLCRWYXIuVmFsdWUsJFZhci5kZXNjcmlwdGlvbiwkVmFyLm9wdGlvbnMsJFZhci5hdHRyaWJ1dGVzKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBBZGQgRnVuY3Rpb25zIGZyb20gY3VycmVudCBydW5zcGFjZSB0byB0aGUgSW5pdGlhbFNlc3Npb25TdGF0ZQogICAgICAgICAgICBGb3JFYWNoKCRGdW5jdGlvbiBpbiAoR2V0LUNoaWxkSXRlbSBGdW5jdGlvbjopKSB7CiAgICAgICAgICAgICAgICAkU2Vzc2lvblN0YXRlLkNvbW1hbmRzLkFkZCgoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SdW5zcGFjZXMuU2Vzc2lvblN0YXRlRnVuY3Rpb25FbnRyeSAtQXJndW1lbnRMaXN0ICRGdW5jdGlvbi5OYW1lLCAkRnVuY3Rpb24uRGVmaW5pdGlvbikpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgdGhyZWFkaW5nIGFkYXB0ZWQgZnJvbQogICAgICAgICMgaHR0cHM6Ly9naXRodWIuY29tL2RhcmtvcGVyYXRvci9Qb3NoLVNlY01vZC9ibG9iL21hc3Rlci9EaXNjb3ZlcnkvRGlzY292ZXJ5LnBzbTEjTDQwNwogICAgICAgICMgICBUaGFua3MgQ2FybG9zIQoKICAgICAgICAjIGNyZWF0ZSBhIHBvb2wgb2YgbWF4VGhyZWFkIHJ1bnNwYWNlcwogICAgICAgICRQb29sID0gW3J1bnNwYWNlZmFjdG9yeV06OkNyZWF0ZVJ1bnNwYWNlUG9vbCgxLCAkVGhyZWFkcywgJFNlc3Npb25TdGF0ZSwgJEhvc3QpCiAgICAgICAgJFBvb2wuT3BlbigpCgogICAgICAgICRKb2JzID0gQCgpCiAgICAgICAgJFBTID0gQCgpCiAgICAgICAgJFdhaXQgPSBAKCkKCiAgICAgICAgJENvdW50ZXIgPSAwCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIEZvckVhY2ggKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJOYW1lKSB7CgogICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZSBnZXQgYSBzZXJ2ZXIgbmFtZQogICAgICAgICAgICBpZiAoJENvbXB1dGVyIC1uZSAnJykgewogICAgICAgICAgICAgICAgIyBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJCgkQ291bnRlcisxKSBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKCiAgICAgICAgICAgICAgICBXaGlsZSAoJCgkUG9vbC5HZXRBdmFpbGFibGVSdW5zcGFjZXMoKSkgLWxlIDApIHsKICAgICAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlTZWNvbmRzIDUwMAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICMgY3JlYXRlIGEgInBvd2Vyc2hlbGwgcGlwZWxpbmUgcnVubmVyIgogICAgICAgICAgICAgICAgJFBTICs9IFtwb3dlcnNoZWxsXTo6Y3JlYXRlKCkKCiAgICAgICAgICAgICAgICAkUFNbJENvdW50ZXJdLnJ1bnNwYWNlcG9vbCA9ICRQb29sCgogICAgICAgICAgICAgICAgIyBhZGQgdGhlIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cwogICAgICAgICAgICAgICAgJE51bGwgPSAkUFNbJENvdW50ZXJdLkFkZFNjcmlwdCgkU2NyaXB0QmxvY2spLkFkZFBhcmFtZXRlcignQ29tcHV0ZXJOYW1lJywgJENvbXB1dGVyKQogICAgICAgICAgICAgICAgaWYoJFNjcmlwdFBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkUGFyYW0gaW4gJFNjcmlwdFBhcmFtZXRlcnMuR2V0RW51bWVyYXRvcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICROdWxsID0gJFBTWyRDb3VudGVyXS5BZGRQYXJhbWV0ZXIoJFBhcmFtLk5hbWUsICRQYXJhbS5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyBzdGFydCBqb2IKICAgICAgICAgICAgICAgICRKb2JzICs9ICRQU1skQ291bnRlcl0uQmVnaW5JbnZva2UoKTsKCiAgICAgICAgICAgICAgICAjIHN0b3JlIHdhaXQgaGFuZGxlcyBmb3IgV2FpdEZvckFsbCBjYWxsCiAgICAgICAgICAgICAgICAkV2FpdCArPSAkSm9ic1skQ291bnRlcl0uQXN5bmNXYWl0SGFuZGxlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKICAgICAgICB9CiAgICB9CgogICAgZW5kIHsKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV2FpdGluZyBmb3Igc2Nhbm5pbmcgdGhyZWFkcyB0byBmaW5pc2guLi4iCgogICAgICAgICRXYWl0VGltZW91dCA9IEdldC1EYXRlCgogICAgICAgICMgc2V0IGEgNjAgc2Vjb25kIHRpbWVvdXQgZm9yIHRoZSBzY2FubmluZyB0aHJlYWRzCiAgICAgICAgd2hpbGUgKCQoJEpvYnMgfCBXaGVyZS1PYmplY3QgeyRfLklzQ29tcGxldGVkIC1lcSAkRmFsc2V9KS5jb3VudCAtZ3QgMCAtb3IgJCgkKCQoR2V0LURhdGUpIC0gJFdhaXRUaW1lb3V0KS50b3RhbFNlY29uZHMpIC1ndCA2MCkgewogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpU2Vjb25kcyA1MDAKICAgICAgICAgICAgfQoKICAgICAgICAjIGVuZCBhc3luYyBjYWxsCiAgICAgICAgZm9yICgkeSA9IDA7ICR5IC1sdCAkQ291bnRlcjsgJHkrKykgewoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICMgY29tcGxldGUgYXN5bmMgam9iCiAgICAgICAgICAgICAgICAkUFNbJHldLkVuZEludm9rZSgkSm9ic1skeV0pCgogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgImVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICRQU1skeV0uRGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgJFBvb2wuRGlzcG9zZSgpCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWxsIHRocmVhZHMgY29tcGxldGVkISIKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1Vc2VySHVudGVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBGaW5kcyB3aGljaCBtYWNoaW5lcyB1c2VycyBvZiBhIHNwZWNpZmllZCBncm91cCBhcmUgbG9nZ2VkIGludG8uCgogICAgICAgIEF1dGhvcjogQGhhcm1qMHkKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKCiAgICAuREVTQ1JJUFRJT04KCiAgICAgICAgVGhpcyBmdW5jdGlvbiBmaW5kcyB0aGUgbG9jYWwgZG9tYWluIG5hbWUgZm9yIGEgaG9zdCB1c2luZyBHZXQtTmV0RG9tYWluLAogICAgICAgIHF1ZXJpZXMgdGhlIGRvbWFpbiBmb3IgdXNlcnMgb2YgYSBzcGVjaWZpZWQgZ3JvdXAgKGRlZmF1bHQgImRvbWFpbiBhZG1pbnMiKQogICAgICAgIHdpdGggR2V0LU5ldEdyb3VwTWVtYmVyIG9yIHJlYWRzIGluIGEgdGFyZ2V0IHVzZXIgbGlzdCwgcXVlcmllcyB0aGUgZG9tYWluIGZvciBhbGwKICAgICAgICBhY3RpdmUgbWFjaGluZXMgd2l0aCBHZXQtTmV0Q29tcHV0ZXIgb3IgcmVhZHMgaW4gYSBwcmUtcG9wdWxhdGVkIGhvc3QgbGlzdCwKICAgICAgICByYW5kb21seSBzaHVmZmxlcyB0aGUgdGFyZ2V0IGxpc3QsIHRoZW4gZm9yIGVhY2ggc2VydmVyIGl0IGdldHMgYSBsaXN0IG9mCiAgICAgICAgYWN0aXZlIHVzZXJzIHdpdGggR2V0LU5ldFNlc3Npb24vR2V0LU5ldExvZ2dlZG9uLiBUaGUgZm91bmQgdXNlciBsaXN0IGlzIGNvbXBhcmVkCiAgICAgICAgYWdhaW5zdCB0aGUgdGFyZ2V0IGxpc3QsIGFuZCBhIHN0YXR1cyBtZXNzYWdlIGlzIGRpc3BsYXllZCBmb3IgYW55IGhpdHMuCiAgICAgICAgVGhlIGZsYWcgLUNoZWNrQWNjZXNzIHdpbGwgY2hlY2sgZWFjaCBwb3NpdGl2ZSBob3N0IHRvIHNlZSBpZiB0aGUgY3VycmVudAogICAgICAgIHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byB0aGUgbWFjaGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0IGFycmF5IHRvIGVudW1lcmF0ZSwgcGFzc2FibGUgb24gdGhlIHBpcGVsaW5lLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWxlCgogICAgICAgIEZpbGUgb2YgaG9zdG5hbWVzL0lQcyB0byBzZWFyY2guCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbHRlcgoKICAgICAgICBIb3N0IGZpbHRlciBuYW1lIHRvIHF1ZXJ5IEFEIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCBmb3IgaG9zdHMsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBVbmNvbnN0cmFpbmVkCgogICAgICAgIFN3aXRjaC4gT25seSBlbnVtZXJhdGUgY29tcHV0ZXJzIHRoYXQgaGF2ZSB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24uCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgR3JvdXAgbmFtZSB0byBxdWVyeSBmb3IgdGFyZ2V0IHVzZXJzLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0U2VydmVyCgogICAgICAgIEh1bnQgZm9yIHVzZXJzIHdobyBhcmUgZWZmZWN0aXZlIGxvY2FsIGFkbWlucyBvbiBhIHRhcmdldCBzZXJ2ZXIuCgogICAgLlBBUkFNRVRFUiBVc2VyTmFtZQoKICAgICAgICBTcGVjaWZpYyB1c2VybmFtZSB0byBzZWFyY2ggZm9yLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSBmb3IgdXNlciBlbnVtZXJhdGlvbiwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgVXNlckFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoIGZvciB1c2VycywgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIFVzZXJGaWxlCgogICAgICAgIEZpbGUgb2YgdXNlcm5hbWVzIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBBZG1pbkNvdW50CgogICAgICAgIFN3aXRjaC4gSHVudCBmb3IgdXNlcnMgd2l0aCBhZG1pbkNvdW50PTEuCgogICAgLlBBUkFNRVRFUiBBbGxvd0RlbGVnYXRpb24KCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlciBhY2NvdW50cyB0aGF0IGFyZSBub3QgbWFya2VkIGFzICdzZW5zaXRpdmUgYW5kIG5vdCBhbGxvd2VkIGZvciBkZWxlZ2F0aW9uJwoKICAgIC5QQVJBTUVURVIgU3RvcE9uU3VjY2VzcwoKICAgICAgICBTd2l0Y2guIFN0b3AgaHVudGluZyBhZnRlciBmaW5kaW5nIGFmdGVyIGZpbmRpbmcgYSB0YXJnZXQgdXNlci4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBDaGVja0FjY2VzcwoKICAgICAgICBTd2l0Y2guIENoZWNrIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byBmb3VuZCBtYWNoaW5lcy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNob3dBbGwKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gYWxsIHVzZXIgbG9jYXRpb24gcmVzdWx0cywgaS5lLiBJbnZva2UtVXNlclZpZXcgZnVuY3Rpb25hbGl0eS4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgU3RlYWx0aAoKICAgICAgICBTd2l0Y2guIE9ubHkgZW51bWVyYXRlIHNlc3Npb25zIGZyb20gY29ubm9ubHkgdXNlZCB0YXJnZXQgc2VydmVycy4KCiAgICAuUEFSQU1FVEVSIFN0ZWFsdGhTb3VyY2UKCiAgICAgICAgVGhlIHNvdXJjZSBvZiB0YXJnZXQgc2VydmVycyB0byB1c2UsICdERlMnIChkaXN0cmlidXRlZCBmaWxlIHNlcnZlcnMpLAogICAgICAgICdEQycgKGRvbWFpbiBjb250cm9sbGVycyksICdGaWxlJyAoZmlsZSBzZXJ2ZXJzKSwgb3IgJ0FsbCcKCiAgICAuUEFSQU1FVEVSIEZvcmVpZ25Vc2VycwoKICAgICAgICBTd2l0Y2guIE9ubHkgcmV0dXJuIHJlc3VsdHMgdGhhdCBhcmUgbm90IHBhcnQgb2Ygc2VhcmNoZWQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1DaGVja0FjY2VzcwoKICAgICAgICBGaW5kcyBtYWNoaW5lcyBvbiB0aGUgbG9jYWwgZG9tYWluIHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbnRvCiAgICAgICAgYW5kIGNoZWNrcyBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbCBhZG1pbmlzdHJhdG9yIGFjY2Vzcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1Eb21haW4gJ3Rlc3RpbmcnCgogICAgICAgIEZpbmRzIG1hY2hpbmVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbnRvLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVRocmVhZHMgMjAKCiAgICAgICAgTXVsdGktdGhyZWFkZWQgdXNlciBodW50aW5nLCByZXBsYWNlcyBJbnZva2UtVXNlckh1bnRlclRocmVhZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVVzZXJGaWxlIHVzZXJzLnR4dCAtQ29tcHV0ZXJGaWxlIGhvc3RzLnR4dAoKICAgICAgICBGaW5kcyBtYWNoaW5lcyBpbiBob3N0cy50eHQgd2hlcmUgYW55IG1lbWJlcnMgb2YgdXNlcnMudHh0IGFyZSBsb2dnZWQgaW4KICAgICAgICBvciBoYXZlIHNlc3Npb25zLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLUdyb3VwTmFtZSAiUG93ZXIgVXNlcnMiIC1EZWxheSA2MAoKICAgICAgICBGaW5kIG1hY2hpbmVzIG9uIHRoZSBkb21haW4gd2hlcmUgbWVtYmVycyBvZiB0aGUgIlBvd2VyIFVzZXJzIiBncm91cHMgYXJlCiAgICAgICAgbG9nZ2VkIGludG8gd2l0aCBhIDYwIHNlY29uZCAoKy8tICouMykgcmFuZG9taXplZCBkZWxheSBiZXR3ZWVuCiAgICAgICAgdG91Y2hpbmcgZWFjaCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVRhcmdldFNlcnZlciBGSUxFU0VSVkVSCgogICAgICAgIFF1ZXJ5IEZJTEVTRVJWRVIgZm9yIHVzZXJlcyB3aG8gYXJlIGVmZmVjdGl2ZSBsb2NhbCBhZG1pbmlzdHJhdG9ycyB1c2luZwogICAgICAgIEdldC1OZXRMb2NhbEdyb3VwIC1SZWN1cnNlLCBhbmQgaHVudCBmb3IgdGhhdCB1c2VyIHNldCBvbiB0aGUgbmV0d29yay4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1TZWFyY2hGb3Jlc3QKCiAgICAgICAgRmluZCBhbGwgbWFjaGluZXMgaW4gdGhlIGN1cnJlbnQgZm9yZXN0IHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1TdGVhbHRoCgogICAgICAgIEV4ZWN1dGVzIG9sZCBJbnZva2UtU3RlYWx0aFVzZXJIdW50ZXIgZnVuY3Rpb25hbGl0eSwgZW51bWVyYXRpbmcgY29tbW9ubHkKICAgICAgICB1c2VkIHNlcnZlcnMgYW5kIGNoZWNraW5nIGp1c3Qgc2Vzc2lvbnMgZm9yIGVhY2guCgogICAgLkxJTksKICAgICAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVW5jb25zdHJhaW5lZCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJ0RvbWFpbiBBZG1pbnMnLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRTZXJ2ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbGUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFkbWluQ291bnQsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFsbG93RGVsZWdhdGlvbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tBY2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0b3BPblN1Y2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTaG93QWxsLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0ZWFsdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJERlMiLCJEQyIsIkZpbGUiLCJBbGwiKV0KICAgICAgICAkU3RlYWx0aFNvdXJjZSA9IkFsbCIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZvcmVpZ25Vc2VycywKCiAgICAgICAgW0ludF0KICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldCiAgICAgICAgJFRocmVhZHMKICAgICkKCiAgICBiZWdpbiB7CgogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CgogICAgICAgICMgcmFuZG9tIG9iamVjdCBmb3IgZGVsYXkKICAgICAgICAkUmFuZE5vID0gTmV3LU9iamVjdCBTeXN0ZW0uUmFuZG9tCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBSdW5uaW5nIEludm9rZS1Vc2VySHVudGVyIHdpdGggZGVsYXkgb2YgJERlbGF5IgoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIEZpcnN0IHdlIGJ1aWxkIHRoZSBob3N0IHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIGEgaG9zdCBsaXN0LCByZWFkIHRoZSB0YXJnZXRzIGluIGFuZCBhZGQgdGhlbSB0byB0aGUgdGFyZ2V0IGxpc3QKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1Db250ZW50IC1QYXRoICRDb21wdXRlckZpbGUKICAgICAgICB9CgogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7IAogICAgICAgICAgICBbQXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQoKICAgICAgICAgICAgaWYoJERvbWFpbikgewogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCREb21haW4pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRTZWFyY2hGb3Jlc3QpIHsKICAgICAgICAgICAgICAgICMgZ2V0IEFMTCB0aGUgZG9tYWlucyBpbiB0aGUgZm9yZXN0IHRvIHNlYXJjaAogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCggKEdldC1OZXREb21haW4pLm5hbWUgKQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpZigkU3RlYWx0aCkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU3RlYWx0aCBtb2RlISBFbnVtZXJhdGluZyBjb21tb25seSB1c2VkIHNlcnZlcnMiCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTdGVhbHRoIHNvdXJjZTogJFN0ZWFsdGhTb3VyY2UiCgogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIGlmICgoJFN0ZWFsdGhTb3VyY2UgLWVxICJGaWxlIikgLW9yICgkU3RlYWx0aFNvdXJjZSAtZXEgIkFsbCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgRmlsZSBTZXJ2ZXJzLi4uIgogICAgICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRGaWxlU2VydmVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoKCRTdGVhbHRoU291cmNlIC1lcSAiREZTIikgLW9yICgkU3RlYWx0aFNvdXJjZSAtZXEgIkFsbCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgREZTIFNlcnZlcnMuLi4iCiAgICAgICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LURGU3NoYXJlIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciB8IEZvckVhY2gtT2JqZWN0IHskXy5SZW1vdGVTZXJ2ZXJOYW1lfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoKCRTdGVhbHRoU291cmNlIC1lcSAiREMiKSAtb3IgKCRTdGVhbHRoU291cmNlIC1lcSAiQWxsIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBEb21haW4gQ29udHJvbGxlcnMuLi4iCiAgICAgICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgLUxEQVAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKCiAgICAgICAgICAgICAgICAgICAgJEFyZ3VtZW50cyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAnRG9tYWluQ29udHJvbGxlcicgPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgICAgICAnQURTcGF0aCcgPSAkQURTcGF0aAogICAgICAgICAgICAgICAgICAgICAgICAnRmlsdGVyJyA9ICRDb21wdXRlckZpbHRlcgogICAgICAgICAgICAgICAgICAgICAgICAnVW5jb25zdHJhaW5lZCcgPSAkVW5jb25zdHJhaW5lZAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgQEFyZ3VtZW50cwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuQ291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIE5vdyB3ZSBidWlsZCB0aGUgdXNlciB0YXJnZXQgc2V0CiAgICAgICAgIwogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgICAgICMgdXNlcnMgd2UncmUgZ29pbmcgdG8gYmUgc2VhcmNoaW5nIGZvcgogICAgICAgICRUYXJnZXRVc2VycyA9IEAoKQoKICAgICAgICAjIGdldCB0aGUgY3VycmVudCB1c2VyIHNvIHdlIGNhbiBpZ25vcmUgaXQgaW4gdGhlIHJlc3VsdHMKICAgICAgICAkQ3VycmVudFVzZXIgPSAoW0Vudmlyb25tZW50XTo6VXNlck5hbWUpLnRvTG93ZXIoKQoKICAgICAgICAjIGlmIHdlJ3JlIHNob3dpbmcgYWxsIHJlc3VsdHMsIHNraXAgdXNlcm5hbWUgZW51bWVyYXRpb24KICAgICAgICBpZigkU2hvd0FsbCAtb3IgJEZvcmVpZ25Vc2VycykgewogICAgICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyRG9tYWluJyAkTnVsbAogICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAnKicKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gQCgkVXNlcikKCiAgICAgICAgICAgIGlmKCRGb3JlaWduVXNlcnMpIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgc2VhcmNoaW5nIGZvciB1c2VyIHJlc3VsdHMgbm90IGluIHRoZSBwcmltYXJ5IGRvbWFpbgogICAgICAgICAgICAgICAgJGtyYnRndE5hbWUgPSBDb252ZXJ0LUFETmFtZSAtT2JqZWN0TmFtZSAia3JidGd0QCQoJERvbWFpbikiIC1JbnB1dFR5cGUgU2ltcGxlIC1PdXRwdXRUeXBlIE5UNAogICAgICAgICAgICAgICAgJERvbWFpblNob3J0TmFtZSA9ICRrcmJ0Z3ROYW1lLnNwbGl0KCJcIilbMF0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjIGlmIHdlIHdhbnQgdG8gaHVudCBmb3IgdGhlIGVmZmVjdGl2ZSBkb21haW4gdXNlcnMgd2hvIGNhbiBhY2Nlc3MgYSB0YXJnZXQgc2VydmVyCiAgICAgICAgZWxzZWlmKCRUYXJnZXRTZXJ2ZXIpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUXVlcnlpbmcgdGFyZ2V0IHNlcnZlciAnJFRhcmdldFNlcnZlcicgZm9yIGxvY2FsIHVzZXJzIgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBHZXQtTmV0TG9jYWxHcm91cCAkVGFyZ2V0U2VydmVyIC1SZWN1cnNlIHwgV2hlcmUtT2JqZWN0IHsoLW5vdCAkXy5Jc0dyb3VwKSAtYW5kICRfLklzRG9tYWluIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlckRvbWFpbicgKCRfLkFjY291bnROYW1lKS5zcGxpdCgiLyIpWzBdLnRvTG93ZXIoKSAKICAgICAgICAgICAgICAgICRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlck5hbWUnICgkXy5BY2NvdW50TmFtZSkuc3BsaXQoIi8iKVsxXS50b0xvd2VyKCkgCiAgICAgICAgICAgICAgICAkVXNlcgogICAgICAgICAgICB9ICB8IFdoZXJlLU9iamVjdCB7JF99CiAgICAgICAgfQogICAgICAgICMgaWYgd2UgZ2V0IGEgc3BlY2lmaWMgdXNlcm5hbWUsIG9ubHkgdXNlIHRoYXQKICAgICAgICBlbHNlaWYoJFVzZXJOYW1lKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBVc2luZyB0YXJnZXQgdXNlciAnJFVzZXJOYW1lJy4uLiIKICAgICAgICAgICAgJFVzZXIgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgIGlmKCRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICRUYXJnZXREb21haW5zWzBdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICROdWxsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyTmFtZScgJFVzZXJOYW1lLlRvTG93ZXIoKQogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCRVc2VyKQogICAgICAgIH0KICAgICAgICAjIHJlYWQgaW4gYSB0YXJnZXQgdXNlciBsaXN0IGlmIHdlIGhhdmUgb25lCiAgICAgICAgZWxzZWlmKCRVc2VyRmlsZSkgewogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBHZXQtQ29udGVudCAtUGF0aCAkVXNlckZpbGUgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgIGlmKCRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyRG9tYWluJyAkVGFyZ2V0RG9tYWluc1swXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyRG9tYWluJyAkTnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyTmFtZScgJF8KICAgICAgICAgICAgICAgICRVc2VyCiAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRVc2VyQURTcGF0aCAtb3IgJFVzZXJGaWx0ZXIgLW9yICRBZG1pbkNvdW50KSB7CiAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKCiAgICAgICAgICAgICAgICAkQXJndW1lbnRzID0gQHsKICAgICAgICAgICAgICAgICAgICAnRG9tYWluJyA9ICREb21haW4KICAgICAgICAgICAgICAgICAgICAnRG9tYWluQ29udHJvbGxlcicgPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgICdBRFNwYXRoJyA9ICRVc2VyQURTcGF0aAogICAgICAgICAgICAgICAgICAgICdGaWx0ZXInID0gJFVzZXJGaWx0ZXIKICAgICAgICAgICAgICAgICAgICAnQWRtaW5Db3VudCcgPSAkQWRtaW5Db3VudAogICAgICAgICAgICAgICAgICAgICdBbGxvd0RlbGVnYXRpb24nID0gJEFsbG93RGVsZWdhdGlvbgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgdXNlcnMiCiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgKz0gR2V0LU5ldFVzZXIgQEFyZ3VtZW50cyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICREb21haW4KICAgICAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAkXy5zYW1hY2NvdW50bmFtZQogICAgICAgICAgICAgICAgICAgICRVc2VyCiAgICAgICAgICAgICAgICB9ICB8IFdoZXJlLU9iamVjdCB7JF99CgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIHVzZXJzIG9mIGdyb3VwICckR3JvdXBOYW1lJyIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0R3JvdXBNZW1iZXIgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoKCAoLW5vdCAkU2hvd0FsbCkgLWFuZCAoLW5vdCAkRm9yZWlnblVzZXJzKSApIC1hbmQgKCghJFRhcmdldFVzZXJzKSAtb3IgKCRUYXJnZXRVc2Vycy5Db3VudCAtZXEgMCkpKSB7CiAgICAgICAgICAgIHRocm93ICJbIV0gTm8gdXNlcnMgZm91bmQgdG8gc2VhcmNoIGZvciEiCiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRUYXJnZXRVc2VycywgJEN1cnJlbnRVc2VyLCAkU3RlYWx0aCwgJERvbWFpblNob3J0TmFtZSkKCiAgICAgICAgICAgICMgb3B0aW9uYWxseSBjaGVjayBpZiB0aGUgc2VydmVyIGlzIHVwIGZpcnN0CiAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAkVXAgPSBUZXN0LUNvbm5lY3Rpb24gLUNvdW50IDEgLVF1aWV0IC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRVcCkgewogICAgICAgICAgICAgICAgaWYoISREb21haW5TaG9ydE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIG5vdCBzZWFyY2hpbmcgZm9yIGZvcmVpZ24gdXNlcnMsIGNoZWNrIHNlc3Npb24gaW5mb3JtYXRpb24KICAgICAgICAgICAgICAgICAgICAkU2Vzc2lvbnMgPSBHZXQtTmV0U2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkU2Vzc2lvbiBpbiAkU2Vzc2lvbnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJOYW1lID0gJFNlc3Npb24uc2VzaTEwX3VzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRDTmFtZSA9ICRTZXNzaW9uLnNlc2kxMF9jbmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJENOYW1lIC1hbmQgJENOYW1lLlN0YXJ0c1dpdGgoIlxcIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRDTmFtZSA9ICRDTmFtZS5UcmltU3RhcnQoIlwiKQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJFVzZXJOYW1lKSAtYW5kICgkVXNlck5hbWUudHJpbSgpIC1uZSAnJykgLWFuZCAoISgkVXNlck5hbWUgLW1hdGNoICRDdXJyZW50VXNlcikpKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzIHwgV2hlcmUtT2JqZWN0IHskVXNlck5hbWUgLWxpa2UgJF8uTWVtYmVyTmFtZX0gfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRJUEFkZHJlc3MgPSBAKEdldC1JUEFkZHJlc3MgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lKVswXS5JUEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckRvbWFpbicgJF8uTWVtYmVyRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgJFVzZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lQQWRkcmVzcycgJElQQWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU2Vzc2lvbkZyb20nICRDTmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHNlZSBpZiB3ZSdyZSBjaGVja2luZyB0byBzZWUgaWYgd2UgaGF2ZSBsb2NhbCBhZG1pbiBhY2Nlc3Mgb24gdGhpcyBtYWNoaW5lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRDaGVja0FjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWRtaW4gPSBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlck5hbWUgJENOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTG9jYWxBZG1pbicgJEFkbWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0xvY2FsQWRtaW4nICROdWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCEkU3RlYWx0aCkgewogICAgICAgICAgICAgICAgICAgICMgaWYgd2UncmUgbm90ICdzdGVhbHRoeScsIGVudW1lcmF0ZSBsb2dnZWRvbiB1c2VycyBhcyB3ZWxsCiAgICAgICAgICAgICAgICAgICAgJExvZ2dlZE9uID0gR2V0LU5ldExvZ2dlZG9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgIEZvckVhY2ggKCRVc2VyIGluICRMb2dnZWRPbikgewogICAgICAgICAgICAgICAgICAgICAgICAkVXNlck5hbWUgPSAkVXNlci53a3VpMV91c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAjIFRPRE86IHRyYW5zbGF0ZSBkb21haW4gdG8gYXV0aG9yYXRhdGl2ZSBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICMgICB0aGVuIG1hdGNoIGRvbWFpbiBuYW1lID8KICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJEb21haW4gPSAkVXNlci53a3VpMV9sb2dvbl9kb21haW4KCiAgICAgICAgICAgICAgICAgICAgICAgICMgbWFrZSBzdXJlIHdldCBoYXZlIGEgcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJFVzZXJOYW1lKSAtYW5kICgkVXNlck5hbWUudHJpbSgpIC1uZSAnJykpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgfCBXaGVyZS1PYmplY3QgeyRVc2VyTmFtZSAtbGlrZSAkXy5NZW1iZXJOYW1lfSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFByb2NlZWQgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCREb21haW5TaG9ydE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCREb21haW5TaG9ydE5hbWUuVG9Mb3dlcigpIC1uZSAkVXNlckRvbWFpbi5Ub0xvd2VyKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZWVkID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZWVkID0gJEZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJFByb2NlZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJElQQWRkcmVzcyA9IEAoR2V0LUlQQWRkcmVzcyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUpWzBdLklQQWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJEb21haW4nICRVc2VyRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlck5hbWUnICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lQQWRkcmVzcycgJElQQWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1Nlc3Npb25Gcm9tJyAkTnVsbAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzZWUgaWYgd2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIHdlIGhhdmUgbG9jYWwgYWRtaW4gYWNjZXNzIG9uIHRoaXMgbWFjaGluZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJENoZWNrQWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWRtaW4gPSBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdMb2NhbEFkbWluJyAkQWRtaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTG9jYWxBZG1pbicgJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYoJFRocmVhZHMpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgdGhyZWFkaW5nIHdpdGggdGhyZWFkcyA9ICRUaHJlYWRzIgoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyB0aHJlYWRpbmcsIGtpY2sgb2ZmIHRoZSBzY3JpcHQgYmxvY2sgd2l0aCBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbgogICAgICAgICAgICAkU2NyaXB0UGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICdQaW5nJyA9ICQoLW5vdCAkTm9QaW5nKQogICAgICAgICAgICAgICAgJ1RhcmdldFVzZXJzJyA9ICRUYXJnZXRVc2VycwogICAgICAgICAgICAgICAgJ0N1cnJlbnRVc2VyJyA9ICRDdXJyZW50VXNlcgogICAgICAgICAgICAgICAgJ1N0ZWFsdGgnID0gJFN0ZWFsdGgKICAgICAgICAgICAgICAgICdEb21haW5TaG9ydE5hbWUnID0gJERvbWFpblNob3J0TmFtZQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMgCiAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcyAtVGhyZWFkcyAkVGhyZWFkcwogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1uZSAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgRm9yRWFjaCAoJENvbXB1dGVyIGluICRDb21wdXRlck5hbWUpIHsKCiAgICAgICAgICAgICAgICAkQ291bnRlciA9ICRDb3VudGVyICsgMQoKICAgICAgICAgICAgICAgICMgc2xlZXAgZm9yIG91ciBzZW1pLXJhbmRvbWl6ZWQgaW50ZXJ2YWwKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSYW5kTm8uTmV4dCgoMS0kSml0dGVyKSokRGVsYXksICgxKyRKaXR0ZXIpKiREZWxheSkKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCiAgICAgICAgICAgICAgICAkUmVzdWx0ID0gSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJENvbXB1dGVyLCAkRmFsc2UsICRUYXJnZXRVc2VycywgJEN1cnJlbnRVc2VyLCAkU3RlYWx0aCwgJERvbWFpblNob3J0TmFtZQogICAgICAgICAgICAgICAgJFJlc3VsdAoKICAgICAgICAgICAgICAgIGlmKCRSZXN1bHQgLWFuZCAkU3RvcE9uU3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBUYXJnZXQgdXNlciBmb3VuZCwgcmV0dXJuaW5nIGVhcmx5IgogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1TdGVhbHRoVXNlckh1bnRlciB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSA9ICdEb21haW4gQWRtaW5zJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGFyZ2V0U2VydmVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckFEU3BhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJGaWxlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRDaGVja0FjY2VzcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU3RvcE9uU3VjY2VzcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTm9QaW5nLAoKICAgICAgICBbVUludDMyXQogICAgICAgICREZWxheSA9IDAsCgogICAgICAgIFtEb3VibGVdCiAgICAgICAgJEppdHRlciA9IC4zLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNob3dBbGwsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIkRGUyIsIkRDIiwiRmlsZSIsIkFsbCIpXQogICAgICAgICRTdGVhbHRoU291cmNlID0iQWxsIgogICAgKQogICAgIyBraWNrIG9mZiBJbnZva2UtVXNlckh1bnRlciB3aXRoIHN0ZWFsdGggb3B0aW9ucwogICAgSW52b2tlLVVzZXJIdW50ZXIgLVN0ZWFsdGggQFBTQm91bmRQYXJhbWV0ZXJzCn0KCgpmdW5jdGlvbiBJbnZva2UtUHJvY2Vzc0h1bnRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcnkgdGhlIHByb2Nlc3MgbGlzdHMgb2YgcmVtb3RlIG1hY2hpbmVzLCBzZWFyY2hpbmcgZm9yCiAgICAgICAgcHJvY2Vzc2VzIHdpdGggYSBzcGVjaWZpYyBuYW1lIG9yIG93bmVkIGJ5IGEgc3BlY2lmaWMgdXNlci4KICAgICAgICBUaGFua3MgdG8gQHBhdWxicmFuZGF1IGZvciB0aGUgYXBwcm9hY2ggaWRlYS4KICAgICAgICAKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgUHJvY2Vzc05hbWUKCiAgICAgICAgVGhlIG5hbWUgb2YgdGhlIHByb2Nlc3MgdG8gaHVudCwgb3IgYSBjb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBHcm91cCBuYW1lIHRvIHF1ZXJ5IGZvciB0YXJnZXQgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBUYXJnZXRTZXJ2ZXIKCiAgICAgICAgSHVudCBmb3IgdXNlcnMgd2hvIGFyZSBlZmZlY3RpdmUgbG9jYWwgYWRtaW5zIG9uIGEgdGFyZ2V0IHNlcnZlci4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFNwZWNpZmljIHVzZXJuYW1lIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBVc2VyRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlIGZvciB1c2VyIGVudW1lcmF0aW9uLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBVc2VyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIHVzZXJzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbGUKCiAgICAgICAgRmlsZSBvZiB1c2VybmFtZXMgdG8gc2VhcmNoIGZvci4KCiAgICAuUEFSQU1FVEVSIFN0b3BPblN1Y2Nlc3MKCiAgICAgICAgU3dpdGNoLiBTdG9wIGh1bnRpbmcgYWZ0ZXIgZmluZGluZyBhZnRlciBmaW5kaW5nIGEgdGFyZ2V0IHVzZXIvcHJvY2Vzcy4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBTd2l0Y2guIERvbid0IHBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNob3dBbGwKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gYWxsIHVzZXIgbG9jYXRpb24gcmVzdWx0cy4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgbWFjaGluZS9kb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtUHJvY2Vzc0h1bnRlciAtRG9tYWluICd0ZXN0aW5nJwogICAgICAgIAogICAgICAgIEZpbmRzIG1hY2hpbmVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdoZXJlIGRvbWFpbiBhZG1pbnMgaGF2ZSBhCiAgICAgICAgcnVubmluZyBwcm9jZXNzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVByb2Nlc3NIdW50ZXIgLVRocmVhZHMgMjAKCiAgICAgICAgTXVsdGktdGhyZWFkZWQgcHJvY2VzcyBodW50aW5nLCByZXBsYWNlcyBJbnZva2UtUHJvY2Vzc0h1bnRlclRocmVhZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVByb2Nlc3NIdW50ZXIgLVVzZXJGaWxlIHVzZXJzLnR4dCAtQ29tcHV0ZXJGaWxlIGhvc3RzLnR4dAogICAgICAgIAogICAgICAgIEZpbmRzIG1hY2hpbmVzIGluIGhvc3RzLnR4dCB3aGVyZSBhbnkgbWVtYmVycyBvZiB1c2Vycy50eHQgaGF2ZSBydW5uaW5nCiAgICAgICAgcHJvY2Vzc2VzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVByb2Nlc3NIdW50ZXIgLUdyb3VwTmFtZSAiUG93ZXIgVXNlcnMiIC1EZWxheSA2MAogICAgICAgIAogICAgICAgIEZpbmQgbWFjaGluZXMgb24gdGhlIGRvbWFpbiB3aGVyZSBtZW1iZXJzIG9mIHRoZSAiUG93ZXIgVXNlcnMiIGdyb3VwcyBoYXZlCiAgICAgICAgcnVubmluZyBwcm9jZXNzZXMgd2l0aCBhIDYwIHNlY29uZCAoKy8tICouMykgcmFuZG9taXplZCBkZWxheSBiZXR3ZWVuCiAgICAgICAgdG91Y2hpbmcgZWFjaCBob3N0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9nLmhhcm1qMHkubmV0CiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0cycpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbQWxpYXMoJ0hvc3RMaXN0JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWxlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRQcm9jZXNzTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJ0RvbWFpbiBBZG1pbnMnLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRTZXJ2ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbGUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0b3BPblN1Y2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTaG93QWxsLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkVGhyZWFkcywKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBiZWdpbiB7CgogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CgogICAgICAgICMgcmFuZG9tIG9iamVjdCBmb3IgZGVsYXkKICAgICAgICAkUmFuZE5vID0gTmV3LU9iamVjdCBTeXN0ZW0uUmFuZG9tCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBSdW5uaW5nIEludm9rZS1Qcm9jZXNzSHVudGVyIHdpdGggZGVsYXkgb2YgJERlbGF5IgoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIEZpcnN0IHdlIGJ1aWxkIHRoZSBob3N0IHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyBhIGhvc3QgbGlzdCwgcmVhZCB0aGUgdGFyZ2V0cyBpbiBhbmQgYWRkIHRoZW0gdG8gdGhlIHRhcmdldCBsaXN0CiAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgIH0KCiAgICAgICAgaWYoISRDb21wdXRlck5hbWUpIHsgCiAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCgogICAgICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoJERvbWFpbikKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAgICAgIyBnZXQgQUxMIHRoZSBkb21haW5zIGluIHRoZSBmb3Jlc3QgdG8gc2VhcmNoCiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEdldC1OZXRGb3Jlc3REb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgfCBGb3JFYWNoLU9iamVjdCB7ICRfLk5hbWUgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyB1c2UgdGhlIGxvY2FsIGRvbWFpbgogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4gLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwpLm5hbWUgKQogICAgICAgICAgICB9CgogICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1GaWx0ZXIgJENvbXB1dGVyRmlsdGVyIC1BRFNwYXRoICRDb21wdXRlckFEU3BhdGgKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuQ291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIE5vdyB3ZSBidWlsZCB0aGUgdXNlciB0YXJnZXQgc2V0CiAgICAgICAgIwogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgICAgIGlmKCEkUHJvY2Vzc05hbWUpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTm8gcHJvY2VzcyBuYW1lIHNwZWNpZmllZCwgYnVpbGRpbmcgYSB0YXJnZXQgdXNlciBzZXQiCgogICAgICAgICAgICAjIHVzZXJzIHdlJ3JlIGdvaW5nIHRvIGJlIHNlYXJjaGluZyBmb3IKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gQCgpCgogICAgICAgICAgICAjIGlmIHdlIHdhbnQgdG8gaHVudCBmb3IgdGhlIGVmZmVjdGl2ZSBkb21haW4gdXNlcnMgd2hvIGNhbiBhY2Nlc3MgYSB0YXJnZXQgc2VydmVyCiAgICAgICAgICAgIGlmKCRUYXJnZXRTZXJ2ZXIpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlF1ZXJ5aW5nIHRhcmdldCBzZXJ2ZXIgJyRUYXJnZXRTZXJ2ZXInIGZvciBsb2NhbCB1c2VycyIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyA9IEdldC1OZXRMb2NhbEdyb3VwICRUYXJnZXRTZXJ2ZXIgLVJlY3Vyc2UgfCBXaGVyZS1PYmplY3Qgeygtbm90ICRfLklzR3JvdXApIC1hbmQgJF8uSXNEb21haW4gfSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAoJF8uQWNjb3VudE5hbWUpLnNwbGl0KCIvIilbMV0udG9Mb3dlcigpCiAgICAgICAgICAgICAgICB9ICB8IFdoZXJlLU9iamVjdCB7JF99CiAgICAgICAgICAgIH0KICAgICAgICAgICAgIyBpZiB3ZSBnZXQgYSBzcGVjaWZpYyB1c2VybmFtZSwgb25seSB1c2UgdGhhdAogICAgICAgICAgICBlbHNlaWYoJFVzZXJOYW1lKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVXNpbmcgdGFyZ2V0IHVzZXIgJyRVc2VyTmFtZScuLi4iCiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCAkVXNlck5hbWUuVG9Mb3dlcigpICkKICAgICAgICAgICAgfQogICAgICAgICAgICAjIHJlYWQgaW4gYSB0YXJnZXQgdXNlciBsaXN0IGlmIHdlIGhhdmUgb25lCiAgICAgICAgICAgIGVsc2VpZigkVXNlckZpbGUpIHsKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyA9IEdldC1Db250ZW50IC1QYXRoICRVc2VyRmlsZSB8IFdoZXJlLU9iamVjdCB7JF99CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRVc2VyQURTcGF0aCAtb3IgJFVzZXJGaWx0ZXIpIHsKICAgICAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIHVzZXJzIgogICAgICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUFEU3BhdGggJFVzZXJBRFNwYXRoIC1GaWx0ZXIgJFVzZXJGaWx0ZXIgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLnNhbWFjY291bnRuYW1lCiAgICAgICAgICAgICAgICAgICAgfSAgfCBXaGVyZS1PYmplY3QgeyRffQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgdXNlcnMgb2YgZ3JvdXAgJyRHcm91cE5hbWUnIgogICAgICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0R3JvdXBNZW1iZXIgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAkXy5NZW1iZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKC1ub3QgJFNob3dBbGwpIC1hbmQgKCghJFRhcmdldFVzZXJzKSAtb3IgKCRUYXJnZXRVc2Vycy5Db3VudCAtZXEgMCkpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyFdIE5vIHVzZXJzIGZvdW5kIHRvIHNlYXJjaCBmb3IhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRQcm9jZXNzTmFtZSwgJFRhcmdldFVzZXJzLCAkQ3JlZGVudGlhbCkKCiAgICAgICAgICAgICMgb3B0aW9uYWxseSBjaGVjayBpZiB0aGUgc2VydmVyIGlzIHVwIGZpcnN0CiAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAkVXAgPSBUZXN0LUNvbm5lY3Rpb24gLUNvdW50IDEgLVF1aWV0IC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRVcCkgewogICAgICAgICAgICAgICAgIyB0cnkgdG8gZW51bWVyYXRlIGFsbCBhY3RpdmUgcHJvY2Vzc2VzIG9uIHRoZSByZW1vdGUgaG9zdAogICAgICAgICAgICAgICAgIyBhbmQgc2VhcmNoIGZvciBhIHNwZWNpZmljIHByb2Nlc3MgbmFtZQogICAgICAgICAgICAgICAgJFByb2Nlc3NlcyA9IEdldC1OZXRQcm9jZXNzIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQoKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRQcm9jZXNzIGluICRQcm9jZXNzZXMpIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGh1bnRpbmcgZm9yIGEgcHJvY2VzcyBuYW1lIG9yIGNvbW1hLXNlcGFyYXRlZCBuYW1lcwogICAgICAgICAgICAgICAgICAgIGlmKCRQcm9jZXNzTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2Vzc05hbWUuc3BsaXQoIiwiKSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkUHJvY2Vzcy5Qcm9jZXNzTmFtZSAtbWF0Y2ggJF8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICMgaWYgdGhlIHNlc3Npb24gdXNlciBpcyBpbiB0aGUgdGFyZ2V0IGxpc3QsIGRpc3BsYXkgc29tZSBvdXRwdXQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRUYXJnZXRVc2VycyAtY29udGFpbnMgJFByb2Nlc3MuVXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdQcm9jZXNzTmFtZScgPSAkUHJvY2Vzc05hbWUKICAgICAgICAgICAgICAgICdUYXJnZXRVc2VycycgPSAkVGFyZ2V0VXNlcnMKICAgICAgICAgICAgICAgICdDcmVkZW50aWFsJyA9ICRDcmVkZW50aWFsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMga2ljayBvZmYgdGhlIHRocmVhZGVkIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cyAKICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zIC1UaHJlYWRzICRUaHJlYWRzCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoLW5vdCAkTm9QaW5nIC1hbmQgKCRDb21wdXRlck5hbWUuY291bnQgLW5lIDEpKSB7CiAgICAgICAgICAgICAgICAjIHBpbmcgYWxsIGhvc3RzIGluIHBhcmFsbGVsCiAgICAgICAgICAgICAgICAkUGluZyA9IHtwYXJhbSgkQ29tcHV0ZXJOYW1lKSBpZihUZXN0LUNvbm5lY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Db3VudCAxIC1RdWlldCAtRXJyb3JBY3Rpb24gU3RvcCl7JENvbXB1dGVyTmFtZX19CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLU5vSW1wb3J0cyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRQaW5nIC1UaHJlYWRzIDEwMAogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVG90YWwgbnVtYmVyIG9mIGFjdGl2ZSBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKICAgICAgICAgICAgJENvdW50ZXIgPSAwCgogICAgICAgICAgICBGb3JFYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgICRDb3VudGVyID0gJENvdW50ZXIgKyAxCgogICAgICAgICAgICAgICAgIyBzbGVlcCBmb3Igb3VyIHNlbWktcmFuZG9taXplZCBpbnRlcnZhbAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBFbnVtZXJhdGluZyBzZXJ2ZXIgJENvbXB1dGVyICgkQ291bnRlciBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKICAgICAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtQ29tbWFuZCAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLUFyZ3VtZW50TGlzdCAkQ29tcHV0ZXIsICRGYWxzZSwgJFByb2Nlc3NOYW1lLCAkVGFyZ2V0VXNlcnMsICRDcmVkZW50aWFsCiAgICAgICAgICAgICAgICAkUmVzdWx0CgogICAgICAgICAgICAgICAgaWYoJFJlc3VsdCAtYW5kICRTdG9wT25TdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRhcmdldCB1c2VyL3Byb2Nlc3MgZm91bmQsIHJldHVybmluZyBlYXJseSIKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1FdmVudEh1bnRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcmllcyBhbGwgZG9tYWluIGNvbnRyb2xsZXJzIG9uIHRoZSBuZXR3b3JrIGZvciBhY2NvdW50CiAgICAgICAgbG9nb24gZXZlbnRzIChJRCA0NjI0KSBhbmQgVEdUIHJlcXVlc3QgZXZlbnRzIChJRCA0NzY4KSwKICAgICAgICBzZWFyY2hpbmcgZm9yIHRhcmdldCB1c2Vycy4KCiAgICAgICAgTm90ZTogRG9tYWluIEFkbWluIChvciBlcXVpdikgcmlnaHRzIGFyZSBuZWVkZWQgdG8gcXVlcnkKICAgICAgICB0aGlzIGluZm9ybWF0aW9uIGZyb20gdGhlIERDcy4KCiAgICAgICAgQXV0aG9yOiBAc2l4ZHViLCBAaGFybWoweQogICAgICAgIExpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIEhvc3QgYXJyYXkgdG8gZW51bWVyYXRlLCBwYXNzYWJsZSBvbiB0aGUgcGlwZWxpbmUuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbGUKCiAgICAgICAgRmlsZSBvZiBob3N0bmFtZXMvSVBzIHRvIHNlYXJjaC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsdGVyCgogICAgICAgIEhvc3QgZmlsdGVyIG5hbWUgdG8gcXVlcnkgQUQgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoIGZvciBob3N0cywgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBHcm91cCBuYW1lIHRvIHF1ZXJ5IGZvciB0YXJnZXQgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBUYXJnZXRTZXJ2ZXIKCiAgICAgICAgSHVudCBmb3IgdXNlcnMgd2hvIGFyZSBlZmZlY3RpdmUgbG9jYWwgYWRtaW5zIG9uIGEgdGFyZ2V0IHNlcnZlci4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFNwZWNpZmljIHVzZXJuYW1lIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBVc2VyRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlIGZvciB1c2VyIGVudW1lcmF0aW9uLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBVc2VyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIHVzZXJzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbGUKCiAgICAgICAgRmlsZSBvZiB1c2VybmFtZXMgdG8gc2VhcmNoIGZvci4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaERheXMKCiAgICAgICAgTnVtYmVyIG9mIGRheXMgYmFjayB0byBzZWFyY2ggbG9ncyBmb3IuIERlZmF1bHQgMy4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gb2JqZWN0IG9mIGFsdGVybmF0ZSBjcmVkZW50aWFscwogICAgICAgIGZvciBjb25uZWN0aW9uIHRvIHRoZSB0YXJnZXQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLUV2ZW50SHVudGVyCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL2Jsb2cuaGFybWoweS5uZXQKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSA9ICdEb21haW4gQWRtaW5zJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGFyZ2V0U2VydmVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckFEU3BhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJGaWxlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtJbnQzMl0KICAgICAgICAkU2VhcmNoRGF5cyA9IDMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzLAoKICAgICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLUV2ZW50SHVudGVyIgoKICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCgkRG9tYWluKQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAjIGdldCBBTEwgdGhlIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCB0byBzZWFyY2gKICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCkubmFtZSApCiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIEZpcnN0IHdlIGJ1aWxkIHRoZSBob3N0IHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgaWYoISRDb21wdXRlck5hbWUpIHsgCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgICAgICBpZigkQ29tcHV0ZXJGaWxlKSB7CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkQ29tcHV0ZXJGaWx0ZXIgLW9yICRDb21wdXRlckFEU3BhdGgpIHsKICAgICAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUZpbHRlciAkQ29tcHV0ZXJGaWx0ZXIgLUFEU3BhdGggJENvbXB1dGVyQURTcGF0aAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyBpZiBhIGNvbXB1dGVyIHNwZWNpZmllciBpc24ndCBnaXZlbiwgdHJ5IHRvIGVudW1lcmF0ZSBhbGwgZG9tYWluIGNvbnRyb2xsZXJzCiAgICAgICAgICAgICAgICBbYXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgZG9tYWluIGNvbnRyb2xsZXJzIgogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgLUxEQVAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZX0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyByZW1vdmUgYW55IG51bGwgdGFyZ2V0IGhvc3RzLCB1bmlxdWlmeSB0aGUgbGlzdCBhbmQgc2h1ZmZsZSBpdAogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7ICRfIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlIHwgU29ydC1PYmplY3QgeyBHZXQtUmFuZG9tIH0KICAgICAgICAgICAgaWYoJCgkQ29tcHV0ZXJOYW1lLkNvdW50KSAtZXEgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIk5vIGhvc3RzIGZvdW5kISIKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAjCiAgICAgICAgIyBOb3cgd2UgYnVpbGQgdGhlIHVzZXIgdGFyZ2V0IHNldAogICAgICAgICMKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICAgICAjIHVzZXJzIHdlJ3JlIGdvaW5nIHRvIGJlIHNlYXJjaGluZyBmb3IKICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCkKCiAgICAgICAgIyBpZiB3ZSB3YW50IHRvIGh1bnQgZm9yIHRoZSBlZmZlY3RpdmUgZG9tYWluIHVzZXJzIHdobyBjYW4gYWNjZXNzIGEgdGFyZ2V0IHNlcnZlcgogICAgICAgIGlmKCRUYXJnZXRTZXJ2ZXIpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUXVlcnlpbmcgdGFyZ2V0IHNlcnZlciAnJFRhcmdldFNlcnZlcicgZm9yIGxvY2FsIHVzZXJzIgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBHZXQtTmV0TG9jYWxHcm91cCAkVGFyZ2V0U2VydmVyIC1SZWN1cnNlIHwgV2hlcmUtT2JqZWN0IHsoLW5vdCAkXy5Jc0dyb3VwKSAtYW5kICRfLklzRG9tYWluIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAoJF8uQWNjb3VudE5hbWUpLnNwbGl0KCIvIilbMV0udG9Mb3dlcigpCiAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICB9CiAgICAgICAgIyBpZiB3ZSBnZXQgYSBzcGVjaWZpYyB1c2VybmFtZSwgb25seSB1c2UgdGhhdAogICAgICAgIGVsc2VpZigkVXNlck5hbWUpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFVzaW5nIHRhcmdldCB1c2VyICckVXNlck5hbWUnLi4uIgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCAkVXNlck5hbWUuVG9Mb3dlcigpICkKICAgICAgICB9CiAgICAgICAgIyByZWFkIGluIGEgdGFyZ2V0IHVzZXIgbGlzdCBpZiB3ZSBoYXZlIG9uZQogICAgICAgIGVsc2VpZigkVXNlckZpbGUpIHsKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LUNvbnRlbnQgLVBhdGggJFVzZXJGaWxlIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRVc2VyQURTcGF0aCAtb3IgJFVzZXJGaWx0ZXIpIHsKICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUFEU3BhdGggJFVzZXJBRFNwYXRoIC1GaWx0ZXIgJFVzZXJGaWx0ZXIgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJF8uc2FtYWNjb3VudG5hbWUKICAgICAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyBvZiBncm91cCAnJEdyb3VwTmFtZSciCiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgKz0gR2V0LU5ldEdyb3VwTWVtYmVyIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJF8uTWVtYmVyTmFtZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoKCghJFRhcmdldFVzZXJzKSAtb3IgKCRUYXJnZXRVc2Vycy5Db3VudCAtZXEgMCkpKSB7CiAgICAgICAgICAgIHRocm93ICJbIV0gTm8gdXNlcnMgZm91bmQgdG8gc2VhcmNoIGZvciEiCiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRUYXJnZXRVc2VycywgJFNlYXJjaERheXMsICRDcmVkZW50aWFsKQoKICAgICAgICAgICAgIyBvcHRpb25hbGx5IGNoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgdXAgZmlyc3QKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAjIHRyeSB0byBlbnVtZXJhdGUKICAgICAgICAgICAgICAgIGlmKCRDcmVkZW50aWFsKSB7CiAgICAgICAgICAgICAgICAgICAgR2V0LVVzZXJFdmVudCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUV2ZW50VHlwZSAnYWxsJyAtRGF0ZVN0YXJ0IChbRGF0ZVRpbWVdOjpUb2RheS5BZGREYXlzKC0kU2VhcmNoRGF5cykpIHwgV2hlcmUtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBmaWx0ZXIgZm9yIHRoZSB0YXJnZXQgdXNlciBzZXQKICAgICAgICAgICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzIC1jb250YWlucyAkXy5Vc2VyTmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIEdldC1Vc2VyRXZlbnQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1FdmVudFR5cGUgJ2FsbCcgLURhdGVTdGFydCAoW0RhdGVUaW1lXTo6VG9kYXkuQWRkRGF5cygtJFNlYXJjaERheXMpKSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgZmlsdGVyIGZvciB0aGUgdGFyZ2V0IHVzZXIgc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyAtY29udGFpbnMgJF8uVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICBpZigkVGhyZWFkcykgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJVc2luZyB0aHJlYWRpbmcgd2l0aCB0aHJlYWRzID0gJFRocmVhZHMiCgogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIHRocmVhZGluZywga2ljayBvZmYgdGhlIHNjcmlwdCBibG9jayB3aXRoIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uCiAgICAgICAgICAgICRTY3JpcHRQYXJhbXMgPSBAewogICAgICAgICAgICAgICAgJ1BpbmcnID0gJCgtbm90ICROb1BpbmcpCiAgICAgICAgICAgICAgICAnVGFyZ2V0VXNlcnMnID0gJFRhcmdldFVzZXJzCiAgICAgICAgICAgICAgICAnU2VhcmNoRGF5cycgPSAkU2VhcmNoRGF5cwogICAgICAgICAgICAgICAgJ0NyZWRlbnRpYWwnID0gJENyZWRlbnRpYWwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBraWNrIG9mZiB0aGUgdGhyZWFkZWQgc2NyaXB0IGJsb2NrICsgYXJndW1lbnRzIAogICAgICAgICAgICBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1TY3JpcHRQYXJhbWV0ZXJzICRTY3JpcHRQYXJhbXMgLVRocmVhZHMgJFRocmVhZHMKICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigtbm90ICROb1BpbmcgLWFuZCAoJENvbXB1dGVyTmFtZS5jb3VudCAtbmUgMSkpIHsKICAgICAgICAgICAgICAgICMgcGluZyBhbGwgaG9zdHMgaW4gcGFyYWxsZWwKICAgICAgICAgICAgICAgICRQaW5nID0ge3BhcmFtKCRDb21wdXRlck5hbWUpIGlmKFRlc3QtQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUNvdW50IDEgLVF1aWV0IC1FcnJvckFjdGlvbiBTdG9wKXskQ29tcHV0ZXJOYW1lfX0KICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtTm9JbXBvcnRzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJFBpbmcgLVRocmVhZHMgMTAwCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBUb3RhbCBudW1iZXIgb2YgYWN0aXZlIGhvc3RzOiAkKCRDb21wdXRlck5hbWUuY291bnQpIgogICAgICAgICAgICAkQ291bnRlciA9IDAKCiAgICAgICAgICAgIEZvckVhY2ggKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJOYW1lKSB7CgogICAgICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKCiAgICAgICAgICAgICAgICAjIHNsZWVwIGZvciBvdXIgc2VtaS1yYW5kb21pemVkIGludGVydmFsCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkQ29tcHV0ZXIgKCRDb3VudGVyIG9mICQoJENvbXB1dGVyTmFtZS5jb3VudCkpIgogICAgICAgICAgICAgICAgSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJENvbXB1dGVyLCAkKC1ub3QgJE5vUGluZyksICRUYXJnZXRVc2VycywgJFNlYXJjaERheXMsICRDcmVkZW50aWFsCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQp9CgoKZnVuY3Rpb24gSW52b2tlLVNoYXJlRmluZGVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIGZpbmRzIHRoZSBsb2NhbCBkb21haW4gbmFtZSBmb3IgYSBob3N0IHVzaW5nIEdldC1OZXREb21haW4sCiAgICAgICAgcXVlcmllcyB0aGUgZG9tYWluIGZvciBhbGwgYWN0aXZlIG1hY2hpbmVzIHdpdGggR2V0LU5ldENvbXB1dGVyLCB0aGVuIGZvcgogICAgICAgIGVhY2ggc2VydmVyIGl0IGxpc3RzIG9mIGFjdGl2ZSBzaGFyZXMgd2l0aCBHZXQtTmV0U2hhcmUuIE5vbi1zdGFuZGFyZCBzaGFyZXMKICAgICAgICBjYW4gYmUgZmlsdGVyZWQgb3V0IHdpdGggLUV4Y2x1ZGUqIGZsYWdzLgoKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgRXhjbHVkZVN0YW5kYXJkCgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSBzdGFuZGFyZCBzaGFyZXMgZnJvbSBkaXNwbGF5IChDJCwgSVBDJCwgcHJpbnQkIGV0Yy4pCgogICAgLlBBUkFNRVRFUiBFeGNsdWRlUHJpbnQKCiAgICAgICAgU3dpdGNoLiBFeGNsdWRlIHRoZSBwcmludCQgc2hhcmUuCgogICAgLlBBUkFNRVRFUiBFeGNsdWRlSVBDCgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSB0aGUgSVBDJCBzaGFyZS4KCiAgICAuUEFSQU1FVEVSIENoZWNrU2hhcmVBY2Nlc3MKCiAgICAgICAgU3dpdGNoLiBPbmx5IGRpc3BsYXkgZm91bmQgc2hhcmVzIHRoYXQgdGhlIGxvY2FsIHVzZXIgaGFzIGFjY2VzcyB0by4KCiAgICAuUEFSQU1FVEVSIENoZWNrQWRtaW4KCiAgICAgICAgU3dpdGNoLiBPbmx5IGRpc3BsYXkgQURNSU4kIHNoYXJlcyB0aGUgbG9jYWwgdXNlciBoYXMgYWNjZXNzIHRvLgoKICAgIC5QQVJBTUVURVIgTm9QaW5nCgogICAgICAgIFN3aXRjaC4gRG9uJ3QgcGluZyBlYWNoIGhvc3QgdG8gZW5zdXJlIGl0J3MgdXAgYmVmb3JlIGVudW1lcmF0aW5nLgoKICAgIC5QQVJBTUVURVIgRGVsYXkKCiAgICAgICAgRGVsYXkgYmV0d2VlbiBlbnVtZXJhdGluZyBob3N0cywgZGVmYXVsdHMgdG8gMC4KCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1TaGFyZUZpbmRlciAtRXhjbHVkZVN0YW5kYXJkCgogICAgICAgIEZpbmQgbm9uLXN0YW5kYXJkIHNoYXJlcyBvbiB0aGUgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVNoYXJlRmluZGVyIC1UaHJlYWRzIDIwCgogICAgICAgIE11bHRpLXRocmVhZGVkIHNoYXJlIGZpbmRpbmcsIHJlcGxhY2VzIEludm9rZS1TaGFyZUZpbmRlclRocmVhZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVNoYXJlRmluZGVyIC1EZWxheSA2MAoKICAgICAgICBGaW5kIHNoYXJlcyBvbiB0aGUgZG9tYWluIHdpdGggYSA2MCBzZWNvbmQgKCsvLSAqLjMpCiAgICAgICAgcmFuZG9taXplZCBkZWxheSBiZXR3ZWVuIHRvdWNoaW5nIGVhY2ggaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1TaGFyZUZpbmRlciAtQ29tcHV0ZXJGaWxlIGhvc3RzLnR4dAoKICAgICAgICBGaW5kIHNoYXJlcyBmb3IgbWFjaGluZXMgaW4gdGhlIHNwZWNpZmllZCBob3N0cyBmaWxlLgoKICAgIC5MSU5LCiAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRXhjbHVkZVN0YW5kYXJkLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlUHJpbnQsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEV4Y2x1ZGVJUEMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tTaGFyZUFjY2VzcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tBZG1pbiwKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAogCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2VhcmNoRm9yZXN0LAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFRocmVhZHMKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLVNoYXJlRmluZGVyIHdpdGggZGVsYXkgb2YgJERlbGF5IgoKICAgICAgICAjIGZpZ3VyZSBvdXQgdGhlIHNoYXJlcyB3ZSB3YW50IHRvIGlnbm9yZQogICAgICAgIFtTdHJpbmdbXV0gJEV4Y2x1ZGVkU2hhcmVzID0gQCgnJykKCiAgICAgICAgaWYgKCRFeGNsdWRlUHJpbnQpIHsKICAgICAgICAgICAgJEV4Y2x1ZGVkU2hhcmVzID0gJEV4Y2x1ZGVkU2hhcmVzICsgIlBSSU5UJCIKICAgICAgICB9CiAgICAgICAgaWYgKCRFeGNsdWRlSVBDKSB7CiAgICAgICAgICAgICRFeGNsdWRlZFNoYXJlcyA9ICRFeGNsdWRlZFNoYXJlcyArICJJUEMkIgogICAgICAgIH0KICAgICAgICBpZiAoJEV4Y2x1ZGVTdGFuZGFyZCkgewogICAgICAgICAgICAkRXhjbHVkZWRTaGFyZXMgPSBAKCcnLCAiQURNSU4kIiwgIklQQyQiLCAiQyQiLCAiUFJJTlQkIikKICAgICAgICB9CgogICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGZpbGUgbGlzdCwgcmVhZCB0aGUgdGFyZ2V0cyBpbiBhbmQgYWRkIHRoZW0gdG8gdGhlIHRhcmdldCBsaXN0CiAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgIH0KCiAgICAgICAgaWYoISRDb21wdXRlck5hbWUpIHsgCiAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCgogICAgICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoJERvbWFpbikKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAgICAgIyBnZXQgQUxMIHRoZSBkb21haW5zIGluIHRoZSBmb3Jlc3QgdG8gc2VhcmNoCiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEdldC1OZXRGb3Jlc3REb21haW4gfCBGb3JFYWNoLU9iamVjdCB7ICRfLk5hbWUgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyB1c2UgdGhlIGxvY2FsIGRvbWFpbgogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbikubmFtZSApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GaWx0ZXIgJENvbXB1dGVyRmlsdGVyIC1BRFNwYXRoICRDb21wdXRlckFEU3BhdGgKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuY291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRDaGVja1NoYXJlQWNjZXNzLCAkRXhjbHVkZWRTaGFyZXMsICRDaGVja0FkbWluKQoKICAgICAgICAgICAgIyBvcHRpb25hbGx5IGNoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgdXAgZmlyc3QKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAjIGdldCB0aGUgc2hhcmVzIGZvciB0aGlzIGhvc3QgYW5kIGNoZWNrIHdoYXQgd2UgZmluZAogICAgICAgICAgICAgICAgJFNoYXJlcyA9IEdldC1OZXRTaGFyZSAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRTaGFyZSBpbiAkU2hhcmVzKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIlsqXSBTZXJ2ZXIgc2hhcmU6ICRTaGFyZSIKICAgICAgICAgICAgICAgICAgICAkTmV0TmFtZSA9ICRTaGFyZS5zaGkxX25ldG5hbWUKICAgICAgICAgICAgICAgICAgICAkUmVtYXJrID0gJFNoYXJlLnNoaTFfcmVtYXJrCiAgICAgICAgICAgICAgICAgICAgJFBhdGggPSAnXFwnKyRDb21wdXRlck5hbWUrJ1wnKyROZXROYW1lCgogICAgICAgICAgICAgICAgICAgICMgbWFrZSBzdXJlIHdlIGdldCBhIHJlYWwgc2hhcmUgbmFtZSBiYWNrCiAgICAgICAgICAgICAgICAgICAgaWYgKCgkTmV0TmFtZSkgLWFuZCAoJE5ldE5hbWUudHJpbSgpIC1uZSAnJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBqdXN0IGNoZWNraW5nIGZvciBhY2Nlc3MgdG8gQURNSU4kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRDaGVja0FkbWluKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkTmV0TmFtZS5Ub1VwcGVyKCkgLWVxICJBRE1JTiQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE51bGwgPSBbSU8uRGlyZWN0b3J5XTo6R2V0RmlsZXMoJFBhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcXCRDb21wdXRlck5hbWVcJE5ldE5hbWUgYHQtICRSZW1hcmsiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGFjY2Vzc2luZyBwYXRoICRQYXRoIDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICMgc2tpcCB0aGlzIHNoYXJlIGlmIGl0J3MgaW4gdGhlIGV4Y2x1ZGUgbGlzdAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRFeGNsdWRlZFNoYXJlcyAtTm90Q29udGFpbnMgJE5ldE5hbWUuVG9VcHBlcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHNlZSBpZiB3ZSB3YW50IHRvIGNoZWNrIGFjY2VzcyB0byB0aGlzIHNoYXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkQ2hlY2tTaGFyZUFjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIHVzZXIgaGFzIGFjY2VzcyB0byB0aGlzIHBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTnVsbCA9IFtJTy5EaXJlY3RvcnldOjpHZXRGaWxlcygkUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlxcJENvbXB1dGVyTmFtZVwkTmV0TmFtZSBgdC0gJFJlbWFyayIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgYWNjZXNzaW5nIHBhdGggJFBhdGggOiAkXyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXFwkQ29tcHV0ZXJOYW1lXCROZXROYW1lIGB0LSAkUmVtYXJrIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYoJFRocmVhZHMpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgdGhyZWFkaW5nIHdpdGggdGhyZWFkcyA9ICRUaHJlYWRzIgoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyB0aHJlYWRpbmcsIGtpY2sgb2ZmIHRoZSBzY3JpcHQgYmxvY2sgd2l0aCBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbgogICAgICAgICAgICAkU2NyaXB0UGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICdQaW5nJyA9ICQoLW5vdCAkTm9QaW5nKQogICAgICAgICAgICAgICAgJ0NoZWNrU2hhcmVBY2Nlc3MnID0gJENoZWNrU2hhcmVBY2Nlc3MKICAgICAgICAgICAgICAgICdFeGNsdWRlZFNoYXJlcycgPSAkRXhjbHVkZWRTaGFyZXMKICAgICAgICAgICAgICAgICdDaGVja0FkbWluJyA9ICRDaGVja0FkbWluCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMga2ljayBvZmYgdGhlIHRocmVhZGVkIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cyAKICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zIC1UaHJlYWRzICRUaHJlYWRzCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoLW5vdCAkTm9QaW5nIC1hbmQgKCRDb21wdXRlck5hbWUuY291bnQgLW5lIDEpKSB7CiAgICAgICAgICAgICAgICAjIHBpbmcgYWxsIGhvc3RzIGluIHBhcmFsbGVsCiAgICAgICAgICAgICAgICAkUGluZyA9IHtwYXJhbSgkQ29tcHV0ZXJOYW1lKSBpZihUZXN0LUNvbm5lY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Db3VudCAxIC1RdWlldCAtRXJyb3JBY3Rpb24gU3RvcCl7JENvbXB1dGVyTmFtZX19CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLU5vSW1wb3J0cyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRQaW5nIC1UaHJlYWRzIDEwMAogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVG90YWwgbnVtYmVyIG9mIGFjdGl2ZSBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKICAgICAgICAgICAgJENvdW50ZXIgPSAwCgogICAgICAgICAgICBGb3JFYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgICRDb3VudGVyID0gJENvdW50ZXIgKyAxCgogICAgICAgICAgICAgICAgIyBzbGVlcCBmb3Igb3VyIHNlbWktcmFuZG9taXplZCBpbnRlcnZhbAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBFbnVtZXJhdGluZyBzZXJ2ZXIgJENvbXB1dGVyICgkQ291bnRlciBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKICAgICAgICAgICAgICAgIEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtQXJndW1lbnRMaXN0ICRDb21wdXRlciwgJEZhbHNlLCAkQ2hlY2tTaGFyZUFjY2VzcywgJEV4Y2x1ZGVkU2hhcmVzLCAkQ2hlY2tBZG1pbgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgfQp9CgoKZnVuY3Rpb24gSW52b2tlLUZpbGVGaW5kZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEZpbmRzIHNlbnNpdGl2ZSBmaWxlcyBvbiB0aGUgZG9tYWluLgoKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFRoaXMgZnVuY3Rpb24gZmluZHMgdGhlIGxvY2FsIGRvbWFpbiBuYW1lIGZvciBhIGhvc3QgdXNpbmcgR2V0LU5ldERvbWFpbiwKICAgICAgICBxdWVyaWVzIHRoZSBkb21haW4gZm9yIGFsbCBhY3RpdmUgbWFjaGluZXMgd2l0aCBHZXQtTmV0Q29tcHV0ZXIsIGdyYWJzCiAgICAgICAgdGhlIHJlYWRhYmxlIHNoYXJlcyBmb3IgZWFjaCBzZXJ2ZXIsIGFuZCByZWN1cnNpdmVseSBzZWFyY2hlcyBldmVyeQogICAgICAgIHNoYXJlIGZvciBmaWxlcyB3aXRoIHNwZWNpZmljIGtleXdvcmRzIGluIHRoZSBuYW1lLgogICAgICAgIElmIGEgc2hhcmUgbGlzdCBpcyBwYXNzZWQsIEVWRVJZIHNoYXJlIGlzIGVudW1lcmF0ZWQgcmVnYXJkbGVzcyBvZgogICAgICAgIG90aGVyIG9wdGlvbnMuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgU2hhcmVMaXN0CgogICAgICAgIExpc3QgaWYgXFxIT1NUXHNoYXJlcyB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFRlcm1zCgogICAgICAgIFRlcm1zIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBPZmZpY2VEb2NzCgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGZvciBvZmZpY2UgZG9jdW1lbnRzICgqLmRvYyosICoueGxzKiwgKi5wcHQqKQoKICAgIC5QQVJBTUVURVIgRnJlc2hFWEVzCgogICAgICAgIFN3aXRjaC4gRmluZCAuRVhFcyBhY2Nlc3NlZCB3aXRoaW4gdGhlIGxhc3Qgd2Vlay4KCiAgICAuUEFSQU1FVEVSIExhc3RBY2Nlc3NUaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBMYXN0QWNjZXNzVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgTGFzdFdyaXRlVGltZQoKICAgICAgICBPbmx5IHJldHVybiBmaWxlcyB3aXRoIGEgTGFzdFdyaXRlVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgQ3JlYXRpb25UaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBDcmVhdGlvbkRhdGUgZ3JlYXRlciB0aGFuIHRoaXMgZGF0ZSB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIEluY2x1ZGVDCgogICAgICAgIFN3aXRjaC4gSW5jbHVkZSBhbnkgQyQgc2hhcmVzIGluIHJlY3Vyc2l2ZSBzZWFyY2hpbmcgKGRlZmF1bHQgaWdub3JlKS4KCiAgICAuUEFSQU1FVEVSIEluY2x1ZGVBZG1pbgoKICAgICAgICBTd2l0Y2guIEluY2x1ZGUgYW55IEFETUlOJCBzaGFyZXMgaW4gcmVjdXJzaXZlIHNlYXJjaGluZyAoZGVmYXVsdCBpZ25vcmUpLgoKICAgIC5QQVJBTUVURVIgRXhjbHVkZUZvbGRlcnMKCiAgICAgICAgU3dpdGNoLiBFeGNsdWRlIGZvbGRlcnMgZnJvbSB0aGUgc2VhcmNoIHJlc3VsdHMuCgogICAgLlBBUkFNRVRFUiBFeGNsdWRlSGlkZGVuCgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSBoaWRkZW4gZmlsZXMgYW5kIGZvbGRlcnMgZnJvbSB0aGUgc2VhcmNoIHJlc3VsdHMuCgogICAgLlBBUkFNRVRFUiBDaGVja1dyaXRlQWNjZXNzCgogICAgICAgIFN3aXRjaC4gT25seSByZXR1cm5zIGZpbGVzIHRoZSBjdXJyZW50IHVzZXIgaGFzIHdyaXRlIGFjY2VzcyB0by4KCiAgICAuUEFSQU1FVEVSIE91dEZpbGUKCiAgICAgICAgT3V0cHV0IHJlc3VsdHMgdG8gYSBzcGVjaWZpZWQgY3N2IG91dHB1dCBmaWxlLgoKICAgIC5QQVJBTUVURVIgTm9DbG9iYmVyCgogICAgICAgIFN3aXRjaC4gRG9uJ3Qgb3ZlcndyaXRlIGFueSBleGlzdGluZyBvdXRwdXQgZmlsZS4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBTd2l0Y2guIERvbid0IHBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHF1ZXJ5IGZvciBtYWNoaW5lcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoRm9yZXN0CgogICAgICAgIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoU1lTVk9MCgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGZvciBsb2dpbiBzY3JpcHRzIG9uIHRoZSBTWVNWT0wgb2YgdGhlIHByaW1hcnkgRENzIGZvciBlYWNoIHNwZWNpZmllZCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBUaHJlYWRzCgogICAgICAgIFRoZSBtYXhpbXVtIGNvbmN1cnJlbnQgdGhyZWFkcyB0byBleGVjdXRlLgoKICAgIC5QQVJBTUVURVIgVXNlUFNEcml2ZQoKICAgICAgICBTd2l0Y2guIE1vdW50IHRhcmdldCByZW1vdGUgcGF0aCB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1GaWxlRmluZGVyCgogICAgICAgIEZpbmQgcmVhZGFibGUgZmlsZXMgb24gdGhlIGRvbWFpbiB3aXRoICdwYXNzJywgJ3NlbnNpdGl2ZScsCiAgICAgICAgJ3NlY3JldCcsICdhZG1pbicsICdsb2dpbicsIG9yICd1bmF0dGVuZCoueG1sJyBpbiB0aGUgbmFtZSwKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1GaWxlRmluZGVyIC1Eb21haW4gdGVzdGluZwoKICAgICAgICBGaW5kIHJlYWRhYmxlIGZpbGVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdpdGggJ3Bhc3MnLCAnc2Vuc2l0aXZlJywKICAgICAgICAnc2VjcmV0JywgJ2FkbWluJywgJ2xvZ2luJywgb3IgJ3VuYXR0ZW5kKi54bWwnIGluIHRoZSBuYW1lLAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLUZpbGVGaW5kZXIgLUluY2x1ZGVDCgogICAgICAgIEZpbmQgcmVhZGFibGUgZmlsZXMgb24gdGhlIGRvbWFpbiB3aXRoICdwYXNzJywgJ3NlbnNpdGl2ZScsCiAgICAgICAgJ3NlY3JldCcsICdhZG1pbicsICdsb2dpbicgb3IgJ3VuYXR0ZW5kKi54bWwnIGluIHRoZSBuYW1lLAogICAgICAgIGluY2x1ZGluZyBDJCBzaGFyZXMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtRmlsZUZpbmRlciAtU2hhcmVMaXN0IHNoYXJlcy50eHQgLVRlcm1zIGFjY291bnRzLHNzbiAtT3V0RmlsZSBvdXQuY3N2CgogICAgICAgIEVudW1lcmF0ZSBhIHNwZWNpZmllZCBzaGFyZSBsaXN0IGZvciBmaWxlcyB3aXRoICdhY2NvdW50cycgb3IKICAgICAgICAnc3NuJyBpbiB0aGUgbmFtZSwgYW5kIHdyaXRlIGV2ZXJ5dGhpbmcgdG8gIm91dC5jc3YiCgogICAgLkxJTksKICAgICAgICBodHRwOi8vd3d3Lmhhcm1qMHkubmV0L2Jsb2cvcmVkdGVhbWluZy9maWxlLXNlcnZlci10cmlhZ2Utb24tcmVkLXRlYW0tZW5nYWdlbWVudHMvCgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2hhcmVMaXN0LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRPZmZpY2VEb2NzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGcmVzaEVYRXMsCgogICAgICAgIFtBbGlhcygnVGVybXMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJFNlYXJjaFRlcm1zLCAKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGVybUxpc3QsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExhc3RBY2Nlc3NUaW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRMYXN0V3JpdGVUaW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDcmVhdGlvblRpbWUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEluY2x1ZGVDLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRJbmNsdWRlQWRtaW4sCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEV4Y2x1ZGVGb2xkZXJzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlSGlkZGVuLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRDaGVja1dyaXRlQWNjZXNzLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRPdXRGaWxlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb0Nsb2JiZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAogICAgICAgIAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2VhcmNoU1lTVk9MLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFRocmVhZHMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFVzZVBTRHJpdmUKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLUZpbGVGaW5kZXIgd2l0aCBkZWxheSBvZiAkRGVsYXkiCgogICAgICAgICRTaGFyZXMgPSBAKCkKCiAgICAgICAgIyBmaWd1cmUgb3V0IHRoZSBzaGFyZXMgd2Ugd2FudCB0byBpZ25vcmUKICAgICAgICBbU3RyaW5nW11dICRFeGNsdWRlZFNoYXJlcyA9IEAoIkMkIiwgIkFETUlOJCIpCgogICAgICAgICMgc2VlIGlmIHdlJ3JlIHNwZWNpZmljYWxseSBpbmNsdWRpbmcgYW55IG9mIHRoZSBub3JtYWxseSBleGNsdWRlZCBzZXRzCiAgICAgICAgaWYgKCRJbmNsdWRlQykgewogICAgICAgICAgICBpZiAoJEluY2x1ZGVBZG1pbikgewogICAgICAgICAgICAgICAgJEV4Y2x1ZGVkU2hhcmVzID0gQCgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkRXhjbHVkZWRTaGFyZXMgPSBAKCJBRE1JTiQiKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoJEluY2x1ZGVBZG1pbikgewogICAgICAgICAgICBpZiAoJEluY2x1ZGVDKSB7CiAgICAgICAgICAgICAgICAkRXhjbHVkZWRTaGFyZXMgPSBAKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRFeGNsdWRlZFNoYXJlcyA9IEAoIkMkIikKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBkZWxldGUgYW55IGV4aXN0aW5nIG91dHB1dCBmaWxlIGlmIGl0IGFscmVhZHkgZXhpc3RzCiAgICAgICAgaWYoISROb0Nsb2JiZXIpIHsKICAgICAgICAgICAgaWYgKCRPdXRGaWxlIC1hbmQgKFRlc3QtUGF0aCAtUGF0aCAkT3V0RmlsZSkpIHsgUmVtb3ZlLUl0ZW0gLVBhdGggJE91dEZpbGUgfQogICAgICAgIH0KCiAgICAgICAgIyBpZiB0aGVyZSdzIGEgc2V0IG9mIHRlcm1zIHNwZWNpZmllZCB0byBzZWFyY2ggZm9yCiAgICAgICAgaWYgKCRUZXJtTGlzdCkgewogICAgICAgICAgICBGb3JFYWNoICgkVGVybSBpbiBHZXQtQ29udGVudCAtUGF0aCAkVGVybUxpc3QpIHsKICAgICAgICAgICAgICAgIGlmICgoJFRlcm0gLW5lICROdWxsKSAtYW5kICgkVGVybS50cmltKCkgLW5lICcnKSkgewogICAgICAgICAgICAgICAgICAgICRTZWFyY2hUZXJtcyArPSAkVGVybQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGlmIHdlJ3JlIGhhcmQtcGFzc2VkIGEgc2V0IG9mIHNoYXJlcwogICAgICAgIGlmKCRTaGFyZUxpc3QpIHsKICAgICAgICAgICAgRm9yRWFjaCAoJEl0ZW0gaW4gR2V0LUNvbnRlbnQgLVBhdGggJFNoYXJlTGlzdCkgewogICAgICAgICAgICAgICAgaWYgKCgkSXRlbSAtbmUgJE51bGwpIC1hbmQgKCRJdGVtLnRyaW0oKSAtbmUgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgIyBleGNsdWRlIGFueSAiW3RhYl0tIGNvbW1hbnRzIiwgaS5lLiB0aGUgb3V0cHV0IGZyb20gSW52b2tlLVNoYXJlRmluZGVyCiAgICAgICAgICAgICAgICAgICAgJFNoYXJlID0gJEl0ZW0uU3BsaXQoImB0IilbMF0KICAgICAgICAgICAgICAgICAgICAkU2hhcmVzICs9ICRTaGFyZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIGEgaG9zdCBmaWxlIGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgICAgICBpZigkQ29tcHV0ZXJGaWxlKSB7CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZighJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgIGlmKCREb21haW4pIHsKICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoJERvbWFpbikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZigkU2VhcmNoRm9yZXN0KSB7CiAgICAgICAgICAgICAgICAgICAgIyBnZXQgQUxMIHRoZSBkb21haW5zIGluIHRoZSBmb3Jlc3QgdG8gc2VhcmNoCiAgICAgICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoIChHZXQtTmV0RG9tYWluKS5uYW1lICkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkU2VhcmNoU1lTVk9MKSB7CiAgICAgICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgICAgICAkRENTZWFyY2hQYXRoID0gIlxcJERvbWFpblxTWVNWT0xcIgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gQWRkaW5nIHNoYXJlIHNlYXJjaCBwYXRoICREQ1NlYXJjaFBhdGgiCiAgICAgICAgICAgICAgICAgICAgICAgICRTaGFyZXMgKz0gJERDU2VhcmNoUGF0aAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZighJFNlYXJjaFRlcm1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgc2VhcmNoIGZvciBpbnRlcmVzdGluZyBzY3JpcHRzIG9uIFNZU1ZPTAogICAgICAgICAgICAgICAgICAgICAgICAkU2VhcmNoVGVybXMgPSBAKCcudmJzJywgJy5iYXQnLCAnLnBzMScpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgW2FycmF5XSRDb21wdXRlck5hbWUgPSBAKCkKCiAgICAgICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRmlsdGVyICRDb21wdXRlckZpbHRlciAtQURTcGF0aCAkQ29tcHV0ZXJBRFNwYXRoIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyByZW1vdmUgYW55IG51bGwgdGFyZ2V0IGhvc3RzLCB1bmlxdWlmeSB0aGUgbGlzdCBhbmQgc2h1ZmZsZSBpdAogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICAgICAgICAgIGlmKCQoJENvbXB1dGVyTmFtZS5Db3VudCkgLWVxIDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgIk5vIGhvc3RzIGZvdW5kISIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBzaGFyZXMgYW5kIGZpbGVzIG9uIGEgc2VydmVyCiAgICAgICAgJEhvc3RFbnVtQmxvY2sgPSB7CiAgICAgICAgICAgIHBhcmFtKCRDb21wdXRlck5hbWUsICRQaW5nLCAkRXhjbHVkZWRTaGFyZXMsICRTZWFyY2hUZXJtcywgJEV4Y2x1ZGVGb2xkZXJzLCAkT2ZmaWNlRG9jcywgJEV4Y2x1ZGVIaWRkZW4sICRGcmVzaEVYRXMsICRDaGVja1dyaXRlQWNjZXNzLCAkT3V0RmlsZSwgJFVzZVBTRHJpdmUpCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDb21wdXRlck5hbWU6ICRDb21wdXRlck5hbWUiCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4Y2x1ZGVkU2hhcmVzOiAkRXhjbHVkZWRTaGFyZXMiCiAgICAgICAgICAgICRTZWFyY2hTaGFyZXMgPSBAKCkKCiAgICAgICAgICAgIGlmKCRDb21wdXRlck5hbWUuU3RhcnRzV2l0aCgiXFwiKSkgewogICAgICAgICAgICAgICAgIyBpZiBhIHNoYXJlIGlzIHBhc3NlZCBhcyB0aGUgc2VydmVyCiAgICAgICAgICAgICAgICAkU2VhcmNoU2hhcmVzICs9ICRDb21wdXRlck5hbWUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgZW51bWVyYXRpbmcgdGhlIHNoYXJlcyBvbiB0aGUgdGFyZ2V0IHNlcnZlciBmaXJzdAogICAgICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgJFVwID0gVGVzdC1Db25uZWN0aW9uIC1Db3VudCAxIC1RdWlldCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCRVcCkgewogICAgICAgICAgICAgICAgICAgICMgZ2V0IHRoZSBzaGFyZXMgZm9yIHRoaXMgaG9zdCBhbmQgZGlzcGxheSB3aGF0IHdlIGZpbmQKICAgICAgICAgICAgICAgICAgICAkU2hhcmVzID0gR2V0LU5ldFNoYXJlIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgIEZvckVhY2ggKCRTaGFyZSBpbiAkU2hhcmVzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkTmV0TmFtZSA9ICRTaGFyZS5zaGkxX25ldG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFBhdGggPSAnXFwnKyRDb21wdXRlck5hbWUrJ1wnKyROZXROYW1lCgogICAgICAgICAgICAgICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZSBnZXQgYSByZWFsIHNoYXJlIG5hbWUgYmFjawogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCROZXROYW1lKSAtYW5kICgkTmV0TmFtZS50cmltKCkgLW5lICcnKSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc2tpcCB0aGlzIHNoYXJlIGlmIGl0J3MgaW4gdGhlIGV4Y2x1ZGUgbGlzdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRFeGNsdWRlZFNoYXJlcyAtTm90Q29udGFpbnMgJE5ldE5hbWUuVG9VcHBlcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBjaGVjayBpZiB0aGUgdXNlciBoYXMgYWNjZXNzIHRvIHRoaXMgcGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICROdWxsID0gW0lPLkRpcmVjdG9yeV06OkdldEZpbGVzKCRQYXRoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2VhcmNoU2hhcmVzICs9ICRQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIlshXSBObyBhY2Nlc3MgdG8gJFBhdGgiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBGb3JFYWNoKCRTaGFyZSBpbiAkU2VhcmNoU2hhcmVzKSB7CiAgICAgICAgICAgICAgICAkU2VhcmNoQXJncyA9ICBAewogICAgICAgICAgICAgICAgICAgICdQYXRoJyA9ICRTaGFyZQogICAgICAgICAgICAgICAgICAgICdTZWFyY2hUZXJtcycgPSAkU2VhcmNoVGVybXMKICAgICAgICAgICAgICAgICAgICAnT2ZmaWNlRG9jcycgPSAkT2ZmaWNlRG9jcwogICAgICAgICAgICAgICAgICAgICdGcmVzaEVYRXMnID0gJEZyZXNoRVhFcwogICAgICAgICAgICAgICAgICAgICdMYXN0QWNjZXNzVGltZScgPSAkTGFzdEFjY2Vzc1RpbWUKICAgICAgICAgICAgICAgICAgICAnTGFzdFdyaXRlVGltZScgPSAkTGFzdFdyaXRlVGltZQogICAgICAgICAgICAgICAgICAgICdDcmVhdGlvblRpbWUnID0gJENyZWF0aW9uVGltZQogICAgICAgICAgICAgICAgICAgICdFeGNsdWRlRm9sZGVycycgPSAkRXhjbHVkZUZvbGRlcnMKICAgICAgICAgICAgICAgICAgICAnRXhjbHVkZUhpZGRlbicgPSAkRXhjbHVkZUhpZGRlbgogICAgICAgICAgICAgICAgICAgICdDaGVja1dyaXRlQWNjZXNzJyA9ICRDaGVja1dyaXRlQWNjZXNzCiAgICAgICAgICAgICAgICAgICAgJ091dEZpbGUnID0gJE91dEZpbGUKICAgICAgICAgICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEZpbmQtSW50ZXJlc3RpbmdGaWxlIEBTZWFyY2hBcmdzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdFeGNsdWRlZFNoYXJlcycgPSAkRXhjbHVkZWRTaGFyZXMKICAgICAgICAgICAgICAgICdTZWFyY2hUZXJtcycgPSAkU2VhcmNoVGVybXMKICAgICAgICAgICAgICAgICdFeGNsdWRlRm9sZGVycycgPSAkRXhjbHVkZUZvbGRlcnMKICAgICAgICAgICAgICAgICdPZmZpY2VEb2NzJyA9ICRPZmZpY2VEb2NzCiAgICAgICAgICAgICAgICAnRXhjbHVkZUhpZGRlbicgPSAkRXhjbHVkZUhpZGRlbgogICAgICAgICAgICAgICAgJ0ZyZXNoRVhFcycgPSAkRnJlc2hFWEVzCiAgICAgICAgICAgICAgICAnQ2hlY2tXcml0ZUFjY2VzcycgPSAkQ2hlY2tXcml0ZUFjY2VzcwogICAgICAgICAgICAgICAgJ091dEZpbGUnID0gJE91dEZpbGUKICAgICAgICAgICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMga2ljayBvZmYgdGhlIHRocmVhZGVkIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cyAKICAgICAgICAgICAgaWYoJFNoYXJlcykgewogICAgICAgICAgICAgICAgIyBwYXNzIHRoZSBzaGFyZXMgYXMgdGhlIGhvc3RzIHNvIHRoZSB0aHJlYWRlZCBmdW5jdGlvbiBjb2RlIGRvZXNuJ3QgaGF2ZSB0byBiZSBoYWNrZWQgdXAKICAgICAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJFNoYXJlcyAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcyAtVGhyZWFkcyAkVGhyZWFkcwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zIC1UaHJlYWRzICRUaHJlYWRzCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigkU2hhcmVzKXsKICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkU2hhcmVzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1ndCAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29tcHV0ZXI6ICRfIgogICAgICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKCiAgICAgICAgICAgICAgICAjIHNsZWVwIGZvciBvdXIgc2VtaS1yYW5kb21pemVkIGludGVydmFsCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkXyAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCgogICAgICAgICAgICAgICAgSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJF8sICRGYWxzZSwgJEV4Y2x1ZGVkU2hhcmVzLCAkU2VhcmNoVGVybXMsICRFeGNsdWRlRm9sZGVycywgJE9mZmljZURvY3MsICRFeGNsdWRlSGlkZGVuLCAkRnJlc2hFWEVzLCAkQ2hlY2tXcml0ZUFjY2VzcywgJE91dEZpbGUsICRVc2VQU0RyaXZlICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gRmluZC1Mb2NhbEFkbWluQWNjZXNzIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBGaW5kcyBtYWNoaW5lcyBvbiB0aGUgbG9jYWwgZG9tYWluIHdoZXJlIHRoZSBjdXJyZW50IHVzZXIgaGFzCiAgICAgICAgbG9jYWwgYWRtaW5pc3RyYXRvciBhY2Nlc3MuIFVzZXMgbXVsdGl0aHJlYWRpbmcgdG8KICAgICAgICBzcGVlZCB1cCBlbnVtZXJhdGlvbi4KCiAgICAgICAgQXV0aG9yOiBAaGFybWoweQogICAgICAgIExpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBUaGlzIGZ1bmN0aW9uIGZpbmRzIHRoZSBsb2NhbCBkb21haW4gbmFtZSBmb3IgYSBob3N0IHVzaW5nIEdldC1OZXREb21haW4sCiAgICAgICAgcXVlcmllcyB0aGUgZG9tYWluIGZvciBhbGwgYWN0aXZlIG1hY2hpbmVzIHdpdGggR2V0LU5ldENvbXB1dGVyLCB0aGVuIGZvcgogICAgICAgIGVhY2ggc2VydmVyIGl0IGNoZWNrcyBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbCBhZG1pbmlzdHJhdG9yCiAgICAgICAgYWNjZXNzIHVzaW5nIEludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3MuCgogICAgICAgIElkZWEgc3RvbGVuIGZyb20gdGhlIGxvY2FsX2FkbWluX3NlYXJjaF9lbnVtIHBvc3QgbW9kdWxlIGluCiAgICAgICAgTWV0YXNwbG9pdCB3cml0dGVuIGJ5OgogICAgICAgICAgICAnQnJhbmRvbiBNY0Nhbm4gInpla25veCIgPGJtY2Nhbm5bYXRdYWNjdXZhbnQuY29tPicKICAgICAgICAgICAgJ1Rob21hcyBNY0NhcnRoeSAic21pbGluZ3JhY2Nvb24iIDxzbWlsaW5ncmFjY29vblthdF1nbWFpbC5jb20+JwogICAgICAgICAgICAnUm95Y2UgRGF2aXMgInIzZHkiIDxyZGF2aXNbYXRdYWNjdXZhbnQuY29tPicKCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0IGFycmF5IHRvIGVudW1lcmF0ZSwgcGFzc2FibGUgb24gdGhlIHBpcGVsaW5lLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWxlCgogICAgICAgIEZpbGUgb2YgaG9zdG5hbWVzL0lQcyB0byBzZWFyY2guCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbHRlcgoKICAgICAgICBIb3N0IGZpbHRlciBuYW1lIHRvIHF1ZXJ5IEFEIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCBmb3IgaG9zdHMsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBOb1BpbmcKCiAgICAgICAgU3dpdGNoLiBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBEZWxheQoKICAgICAgICBEZWxheSBiZXR3ZWVuIGVudW1lcmF0aW5nIGhvc3RzLCBkZWZhdWx0cyB0byAwCgogICAgLlBBUkFNRVRFUiBKaXR0ZXIKCiAgICAgICAgSml0dGVyIGZvciB0aGUgaG9zdCBkZWxheSwgZGVmYXVsdHMgdG8gKy8tIDAuMwoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KICAgIAogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBTZWFyY2hGb3Jlc3QKCiAgICAgICAgU3dpdGNoLiBTZWFyY2ggYWxsIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCBmb3IgdGFyZ2V0IHVzZXJzIGluc3RlYWQgb2YganVzdAogICAgICAgIGEgc2luZ2xlIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIFRocmVhZHMKCiAgICAgICAgVGhlIG1heGltdW0gY29uY3VycmVudCB0aHJlYWRzIHRvIGV4ZWN1dGUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUxvY2FsQWRtaW5BY2Nlc3MKCiAgICAgICAgRmluZCBtYWNoaW5lcyBvbiB0aGUgbG9jYWwgZG9tYWluIHdoZXJlIHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsCiAgICAgICAgYWRtaW5pc3RyYXRvciBhY2Nlc3MuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUxvY2FsQWRtaW5BY2Nlc3MgLVRocmVhZHMgMTAKCiAgICAgICAgTXVsdGktdGhyZWFkZWQgYWNjZXNzIGh1bnRpbmcsIHJlcGxhY2VzIEZpbmQtTG9jYWxBZG1pbkFjY2Vzc1RocmVhZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1Mb2NhbEFkbWluQWNjZXNzIC1Eb21haW4gdGVzdGluZwoKICAgICAgICBGaW5kIG1hY2hpbmVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdoZXJlIHRoZSBjdXJyZW50IHVzZXIgaGFzCiAgICAgICAgbG9jYWwgYWRtaW5pc3RyYXRvciBhY2Nlc3MuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUxvY2FsQWRtaW5BY2Nlc3MgLUNvbXB1dGVyRmlsZSBob3N0cy50eHQKCiAgICAgICAgRmluZCB3aGljaCBtYWNoaW5lcyBpbiB0aGUgaG9zdCBsaXN0IHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsCiAgICAgICAgYWRtaW5pc3RyYXRvciBhY2Nlc3MuCgogICAgLkxJTksKCiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yay9ibG9iL21hc3Rlci9tb2R1bGVzL3Bvc3Qvd2luZG93cy9nYXRoZXIvbG9jYWxfYWRtaW5fc2VhcmNoX2VudW0ucmIKICAgICAgICBodHRwOi8vd3d3Lmhhcm1qMHkubmV0L2Jsb2cvcGVuZXRlc3RpbmcvZmluZGluZy1sb2NhbC1hZG1pbi13aXRoLXRoZS12ZWlsLWZyYW1ld29yay8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkVGhyZWFkcwogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydEZWJ1ZyddKSB7CiAgICAgICAgICAgICREZWJ1Z1ByZWZlcmVuY2UgPSAnQ29udGludWUnCiAgICAgICAgfQoKICAgICAgICAjIHJhbmRvbSBvYmplY3QgZm9yIGRlbGF5CiAgICAgICAgJFJhbmRObyA9IE5ldy1PYmplY3QgU3lzdGVtLlJhbmRvbQoKICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUnVubmluZyBGaW5kLUxvY2FsQWRtaW5BY2Nlc3Mgd2l0aCBkZWxheSBvZiAkRGVsYXkiCgogICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgIGlmKCRDb21wdXRlckZpbGUpIHsKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1Db250ZW50IC1QYXRoICRDb21wdXRlckZpbGUKICAgICAgICB9CgogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7CiAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCgogICAgICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoJERvbWFpbikKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAgICAgIyBnZXQgQUxMIHRoZSBkb21haW5zIGluIHRoZSBmb3Jlc3QgdG8gc2VhcmNoCiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEdldC1OZXRGb3Jlc3REb21haW4gfCBGb3JFYWNoLU9iamVjdCB7ICRfLk5hbWUgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyB1c2UgdGhlIGxvY2FsIGRvbWFpbgogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbikubmFtZSApCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgaG9zdHMiCiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRmlsdGVyICRDb21wdXRlckZpbHRlciAtQURTcGF0aCAkQ29tcHV0ZXJBRFNwYXRoIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgICMgcmVtb3ZlIGFueSBudWxsIHRhcmdldCBob3N0cywgdW5pcXVpZnkgdGhlIGxpc3QgYW5kIHNodWZmbGUgaXQKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRDb21wdXRlck5hbWUgfCBXaGVyZS1PYmplY3QgeyAkXyB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZSB8IFNvcnQtT2JqZWN0IHsgR2V0LVJhbmRvbSB9CiAgICAgICAgICAgIGlmKCQoJENvbXB1dGVyTmFtZS5Db3VudCkgLWVxIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJObyBob3N0cyBmb3VuZCEiCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBhIHNlcnZlcgogICAgICAgICRIb3N0RW51bUJsb2NrID0gewogICAgICAgICAgICBwYXJhbSgkQ29tcHV0ZXJOYW1lLCAkUGluZykKCiAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAkVXAgPSBUZXN0LUNvbm5lY3Rpb24gLUNvdW50IDEgLVF1aWV0IC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRVcCkgewogICAgICAgICAgICAgICAgIyBjaGVjayBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbCBhZG1pbiBhY2Nlc3MgdG8gdGhpcyBzZXJ2ZXIKICAgICAgICAgICAgICAgICRBY2Nlc3MgPSBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgaWYgKCRBY2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICBpZigkVGhyZWFkcykgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJVc2luZyB0aHJlYWRpbmcgd2l0aCB0aHJlYWRzID0gJFRocmVhZHMiCgogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIHRocmVhZGluZywga2ljayBvZmYgdGhlIHNjcmlwdCBibG9jayB3aXRoIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uCiAgICAgICAgICAgICRTY3JpcHRQYXJhbXMgPSBAewogICAgICAgICAgICAgICAgJ1BpbmcnID0gJCgtbm90ICROb1BpbmcpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMga2ljayBvZmYgdGhlIHRocmVhZGVkIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cyAKICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zIC1UaHJlYWRzICRUaHJlYWRzCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoLW5vdCAkTm9QaW5nIC1hbmQgKCRDb21wdXRlck5hbWUuY291bnQgLW5lIDEpKSB7CiAgICAgICAgICAgICAgICAjIHBpbmcgYWxsIGhvc3RzIGluIHBhcmFsbGVsCiAgICAgICAgICAgICAgICAkUGluZyA9IHtwYXJhbSgkQ29tcHV0ZXJOYW1lKSBpZihUZXN0LUNvbm5lY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Db3VudCAxIC1RdWlldCAtRXJyb3JBY3Rpb24gU3RvcCl7JENvbXB1dGVyTmFtZX19CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLU5vSW1wb3J0cyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRQaW5nIC1UaHJlYWRzIDEwMAogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVG90YWwgbnVtYmVyIG9mIGFjdGl2ZSBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKICAgICAgICAgICAgJENvdW50ZXIgPSAwCgogICAgICAgICAgICBGb3JFYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgICRDb3VudGVyID0gJENvdW50ZXIgKyAxCgogICAgICAgICAgICAgICAgIyBzbGVlcCBmb3Igb3VyIHNlbWktcmFuZG9taXplZCBpbnRlcnZhbAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBFbnVtZXJhdGluZyBzZXJ2ZXIgJENvbXB1dGVyICgkQ291bnRlciBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKICAgICAgICAgICAgICAgIEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtQXJndW1lbnRMaXN0ICRDb21wdXRlciwgJEZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtRXhwbG9pdGFibGVTeXN0ZW0gewo8IwogICAgLlN5bm9wc2lzCgogICAgICAgIFRoaXMgbW9kdWxlIHdpbGwgcXVlcnkgQWN0aXZlIERpcmVjdG9yeSBmb3IgdGhlIGhvc3RuYW1lLCBPUyB2ZXJzaW9uLCBhbmQgc2VydmljZSBwYWNrIGxldmVsICAKICAgICAgICBmb3IgZWFjaCBjb21wdXRlciBhY2NvdW50LiAgVGhhdCBpbmZvcm1hdGlvbiBpcyB0aGVuIGNyb3NzLXJlZmVyZW5jZWQgYWdhaW5zdCBhIGxpc3Qgb2YgY29tbW9uCiAgICAgICAgTWV0YXNwbG9pdCBleHBsb2l0cyB0aGF0IGNhbiBiZSB1c2VkIGR1cmluZyBwZW5ldHJhdGlvbiB0ZXN0aW5nLgoKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBUaGlzIG1vZHVsZSB3aWxsIHF1ZXJ5IEFjdGl2ZSBEaXJlY3RvcnkgZm9yIHRoZSBob3N0bmFtZSwgT1MgdmVyc2lvbiwgYW5kIHNlcnZpY2UgcGFjayBsZXZlbCAgCiAgICAgICAgZm9yIGVhY2ggY29tcHV0ZXIgYWNjb3VudC4gIFRoYXQgaW5mb3JtYXRpb24gaXMgdGhlbiBjcm9zcy1yZWZlcmVuY2VkIGFnYWluc3QgYSBsaXN0IG9mIGNvbW1vbgogICAgICAgIE1ldGFzcGxvaXQgZXhwbG9pdHMgdGhhdCBjYW4gYmUgdXNlZCBkdXJpbmcgcGVuZXRyYXRpb24gdGVzdGluZy4gIFRoZSBzY3JpcHQgZmlsdGVycyBvdXQgZGlzYWJsZWQKICAgICAgICBkb21haW4gY29tcHV0ZXJzIGFuZCBwcm92aWRlcyB0aGUgY29tcHV0ZXIncyBsYXN0IGxvZ29uIHRpbWUgdG8gaGVscCBkZXRlcm1pbmUgaWYgaXQncyBiZWVuIAogICAgICAgIGRlY29tbWlzc2lvbmVkLiAgQWxzbywgc2luY2UgdGhlIHNjcmlwdCB1c2VzIGRhdGEgdGFibGVzIHRvIG91dHB1dCBhZmZlY3RlZCBzeXN0ZW1zIHRoZSByZXN1bHRzCiAgICAgICAgY2FuIGJlIGVhc2lseSBwaXBlZCB0byBvdGhlciBjb21tYW5kcyBzdWNoIGFzIHRlc3QtY29ubmVjdGlvbiBvciBhIEV4cG9ydC1Dc3YuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgUmV0dXJuIGNvbXB1dGVycyB3aXRoIGEgc3BlY2lmaWMgbmFtZSwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgU1BOCgogICAgICAgIFJldHVybiBjb21wdXRlcnMgd2l0aCBhIHNwZWNpZmljIHNlcnZpY2UgcHJpbmNpcGFsIG5hbWUsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIE9wZXJhdGluZ1N5c3RlbQoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBvcGVyYXRpbmcgc3lzdGVtLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBTZXJ2aWNlUGFjawoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBzZXJ2aWNlIHBhY2ssIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgUGluZwoKICAgICAgICBTd2l0Y2guIFBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBjb21wdXRlcnMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVW5jb25zdHJhaW5lZAoKICAgICAgICBTd2l0Y2guIFJldHVybiBjb21wdXRlciBvYmplY3RzIHRoYXQgaGF2ZSB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24uCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQogICAgICAgCiAgICAgICAgVGhlIGV4YW1wbGUgYmVsb3cgc2hvd3MgdGhlIHN0YW5kYXJkIGNvbW1hbmQgdXNhZ2UuICBEaXNhYmxlZCBzeXN0ZW0gYXJlIGV4Y2x1ZGVkIGJ5IGRlZmF1bHQsIGJ1dAogICAgICAgIHRoZSAiTGFzdExnb24iIGNvbHVtbiBjYW4gYmUgdXNlZCB0byBkZXRlcm1pbmUgd2hpY2ggc3lzdGVtcyBhcmUgbGl2ZS4gIFVzdWFsbHksIGlmIGEgc3lzdGVtIGhhc24ndCAKICAgICAgICBsb2dnZWQgb24gZm9yIHR3byBvciBtb3JlIHdlZWtzIGl0J3MgYmVlbiBkZWNvbW1pc3Npb25lZC4gICAgICAKICAgICAgICBQUyBDOlw+IEdldC1FeHBsb2l0YWJsZVN5c3RlbSAtRG9tYWluQ29udHJvbGxlciAxOTIuMTY4LjEuMSAtQ3JlZGVudGlhbCBkZW1vLmNvbVx1c2VyIHwgRm9ybWF0LVRhYmxlIC1BdXRvU2l6ZQogICAgICAgIFsqXSBHcmFiYmluZyBjb21wdXRlciBhY2NvdW50cyBmcm9tIEFjdGl2ZSBEaXJlY3RvcnkuLi4KICAgICAgICBbKl0gTG9hZGluZyBleHBsb2l0IGxpc3QgZm9yIGNyaXRpY2FsIG1pc3NpbmcgcGF0Y2hlcy4uLgogICAgICAgIFsqXSBDaGVja2luZyBjb21wdXRlcnMgZm9yIHZ1bG5lcmFibGUgT1MgYW5kIFNQIGxldmVscy4uLgogICAgICAgIFsrXSBGb3VuZCA1IHBvdGVudGlhbGx5IHZ1bG5lcmFibGUgc3lzdGVtcyEKICAgICAgICBDb21wdXRlck5hbWUgICAgICAgICAgT3BlcmF0aW5nU3lzdGVtICAgICAgICAgU2VydmljZVBhY2sgICAgTGFzdExvZ29uICAgICAgICAgICAgTXNmTW9kdWxlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDVkUgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgLS0tLS0tLS0tLS0tICAgICAgICAgIC0tLS0tLS0tLS0tLS0tLSAgICAgICAgIC0tLS0tLS0tLS0tICAgIC0tLS0tLS0tLSAgICAgICAgICAgIC0tLS0tLS0tLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0tICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIEFEUy5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiA0LzgvMjAxNSA1OjQ2OjUyIFBNICBleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDdfMDI5X21zZG5zX3pvbmVuYW1lIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBBRFMuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgNC84LzIwMTUgNTo0Njo1MiBQTSAgZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkgICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgQURTLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDQvOC8yMDE1IDU6NDY6NTIgUE0gIGV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIExWQS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiA0LzgvMjAxNSAxOjQ0OjQ2IFBNICBleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDdfMDI5X21zZG5zX3pvbmVuYW1lIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBMVkEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgNC84LzIwMTUgMTo0NDo0NiBQTSAgZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkgICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgTFZBLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDQvOC8yMDE1IDE6NDQ6NDYgUE0gIGV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIGFzc2Vzcy14cHByby5kZW1vLmNvbSBXaW5kb3dzIFhQIFByb2Zlc3Npb25hbCBTZXJ2aWNlIFBhY2sgMyA0LzEvMjAxNCAxMToxMTo1NCBBTSBleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSAgICAgICAgICAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBhc3Nlc3MteHBwcm8uZGVtby5jb20gV2luZG93cyBYUCBQcm9mZXNzaW9uYWwgU2VydmljZSBQYWNrIDMgNC8xLzIwMTQgMTE6MTE6NTQgQU0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczEwXzA2MV9zcG9vbHNzICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgSFZBLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDExLzUvMjAxMyA5OjE2OjMxIFBNIGV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIEhWQS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiAxMS81LzIwMTMgOToxNjozMSBQTSBleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSAgICAgICAgICAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBIVkEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgMTEvNS8yMDEzIDk6MTY6MzEgUE0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczEwXzA2MV9zcG9vbHNzICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgREIxLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDMvMjIvMjAxMiA1OjA1OjM0IFBNIGV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIERCMS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiAzLzIyLzIwMTIgNTowNTozNCBQTSBleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSAgICAgICAgICAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBEQjEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgMy8yMi8yMDEyIDU6MDU6MzQgUE0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczEwXzA2MV9zcG9vbHNzICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uICAgICAgICAgICAgICAgICAgICAgCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtRXhwbG9pdGFibGVTeXN0ZW0gfCBFeHBvcnQtQ3N2IGM6XHRlbXBcb3V0cHV0LmNzdiAtTm9UeXBlSW5mb3JtYXRpb24KCiAgICAgICAgSG93IHRvIHdyaXRlIHRoZSBvdXRwdXQgdG8gYSBjc3YgZmlsZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1FeHBsb2l0YWJsZVN5c3RlbSAtRG9tYWluIHRlc3RsYWIubG9jYWwgLVBpbmcKCiAgICAgICAgUmV0dXJuIGEgc2V0IG9mIGxpdmUgaG9zdHMgZnJvbSB0aGUgdGVzdGxhYi5sb2NhbCBkb21haW4KCiAgICAgLkxJTksKICAgICAgIAogICAgICAgaHR0cDovL3d3dy5uZXRzcGkuY29tCiAgICAgICBodHRwczovL2dpdGh1Yi5jb20vbnVsbGJpbmQvUG93ZXJzaGVsbGVyeS9ibG9iL21hc3Rlci9TdGFibGUtaXNoL0FEUy9HZXQtRXhwbG9pdGFibGVTeXN0ZW1zLnBzbTEKICAgICAgIAogICAgIC5OT1RFUwogICAgICAgCiAgICAgICBBdXRob3I6ICBTY290dCBTdXRoZXJsYW5kIC0gMjAxNSwgTmV0U1BJCiAgICAgICAgICAgICAgICBNb2RpZmljYXRpb25zIHRvIGludGVncmF0ZSBpbnRvIFBvd2VyVmlldyBieSBAaGFybWoweQogICAgICAgVmVyc2lvbjogR2V0LUV4cGxvaXRhYmxlU3lzdGVtLnBzbTEgdjEuMQogICAgICAgQ29tbWVudHM6IFRoZSB0ZWNobmlxdWUgdXNlZCB0byBxdWVyeSBMREFQIHdhcyBiYXNlZCBvbiB0aGUgIkdldC1BdWRpdERTQ29tcHV0ZXJBY2NvdW50IiAKICAgICAgIGZ1bmN0aW9uIGZvdW5kIGluIENhcm9scyBQZXJleidzIFBvc2hTZWMtTW9kIHByb2plY3QuICBUaGUgZ2VuZXJhbCBpZGVhIGlzIGJhc2VkIG9mZiBvZiAgCiAgICAgICBXaWxsIFNjaHJvZWRlcidzICJJbnZva2UtRmluZFZ1bG5TeXN0ZW1zIiBmdW5jdGlvbiBmcm9tIHRoZSBQb3dlclZpZXcgdG9vbGtpdC4KIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTUE4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE9wZXJhdGluZ1N5c3RlbSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2VydmljZVBhY2sgPSAnKicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZpbHRlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUGluZywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVbmNvbnN0cmFpbmVkLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAiWypdIEdyYWJiaW5nIGNvbXB1dGVyIGFjY291bnRzIGZyb20gQWN0aXZlIERpcmVjdG9yeS4uLiIKCiAgICAjIENyZWF0ZSBkYXRhIHRhYmxlIGZvciBob3N0bmFtZXMsIG9zLCBhbmQgc2VydmljZSBwYWNrcyBmcm9tIExEQVAKICAgICRUYWJsZUFkc0NvbXB1dGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVBZHNDb21wdXRlcnMuQ29sdW1ucy5BZGQoJ0hvc3RuYW1lJykgICAgICAgCiAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Db2x1bW5zLkFkZCgnT3BlcmF0aW5nU3lzdGVtJykKICAgICROdWxsID0gJFRhYmxlQWRzQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Db2x1bW5zLkFkZCgnTGFzdExvZ29uJykKCiAgICBHZXQtTmV0Q29tcHV0ZXIgLUZ1bGxEYXRhIEBQU0JvdW5kUGFyYW1ldGVycyB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgJEN1cnJlbnRIb3N0ID0gJF8uZG5zaG9zdG5hbWUKICAgICAgICAkQ3VycmVudE9zID0gJF8ub3BlcmF0aW5nc3lzdGVtCiAgICAgICAgJEN1cnJlbnRTcCA9ICRfLm9wZXJhdGluZ3N5c3RlbXNlcnZpY2VwYWNrCiAgICAgICAgJEN1cnJlbnRMYXN0ID0gJF8ubGFzdGxvZ29uCiAgICAgICAgJEN1cnJlbnRVYWMgPSAkXy51c2VyYWNjb3VudGNvbnRyb2wKCiAgICAgICAgJEN1cnJlbnRVYWNCaW4gPSBbY29udmVydF06OlRvU3RyaW5nKCRfLnVzZXJhY2NvdW50Y29udHJvbCwyKQoKICAgICAgICAjIENoZWNrIHRoZSAybmQgdG8gbGFzdCB2YWx1ZSB0byBkZXRlcm1pbmUgaWYgaXRzIGRpc2FibGVkCiAgICAgICAgJERpc2FibGVPZmZzZXQgPSAkQ3VycmVudFVhY0Jpbi5MZW5ndGggLSAyCiAgICAgICAgJEN1cnJlbnREaXNhYmxlZCA9ICRDdXJyZW50VWFjQmluLlN1YnN0cmluZygkRGlzYWJsZU9mZnNldCwxKQoKICAgICAgICAjIEFkZCBjb21wdXRlciB0byBsaXN0IGlmIGl0J3MgZW5hYmxlZAogICAgICAgIGlmICgkQ3VycmVudERpc2FibGVkICAtZXEgMCkgewogICAgICAgICAgICAjIEFkZCBkb21haW4gY29tcHV0ZXIgdG8gZGF0YSB0YWJsZQogICAgICAgICAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Sb3dzLkFkZCgkQ3VycmVudEhvc3QsJEN1cnJlbnRPUywkQ3VycmVudFNQLCRDdXJyZW50TGFzdCkKICAgICAgICB9CiAgICB9CgogICAgIyBTdGF0dXMgdXNlciAgICAgICAgCiAgICBXcml0ZS1WZXJib3NlICJbKl0gTG9hZGluZyBleHBsb2l0IGxpc3QgZm9yIGNyaXRpY2FsIG1pc3NpbmcgcGF0Y2hlcy4uLiIKCiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgU2V0dXAgZGF0YSB0YWJsZSBmb3IgbGlzdCBvZiBtc2YgZXhwbG9pdHMKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgICMgQ3JlYXRlIGRhdGEgdGFibGUgZm9yIGxpc3Qgb2YgcGF0Y2hlcyBsZXZlbHMgd2l0aCBhIE1TRiBleHBsb2l0CiAgICAkVGFibGVFeHBsb2l0cyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Db2x1bW5zLkFkZCgnT3BlcmF0aW5nU3lzdGVtJykgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdNc2ZNb2R1bGUnKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdDVkUnKQogICAgCiAgICAjIEFkZCBleHBsb2l0cyB0byBkYXRhIHRhYmxlCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIDciLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL2lpcy9tczAzXzAwN19udGRsbF93ZWJkYXYiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAxMDkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczAzXzAyNl9kY29tIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMzUyLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9paXMvbXMwM18wMDdfbnRkbGxfd2ViZGF2IiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMTA5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDVfMDE3X21zbXEiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA1LTAwNTkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3MvaWlzL21zMDNfMDA3X250ZGxsX3dlYmRhdiIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDEwOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczAzXzAyNl9kY29tIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMzUyLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA3LTE3NDgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDQiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDRfMDExX2xzYXNzIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wNTMzLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA2Nl9ud2FwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtNDY4OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNzBfd2tzc3ZjIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi00NjkxIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDQiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3MvaWlzL21zMDNfMDA3X250ZGxsX3dlYmRhdiIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDEwOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDVfMDM5X3BucCIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMTk4MyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczA3XzAyOV9tc2Ruc196b25lbmFtZSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDctMTc0OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA0MF9uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTM0MzkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNjZfbndhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTQ2ODgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA3LTE3NDgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyBSMiIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA0MF9uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTM0MzkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3dpbnMvbXMwNF8wNDVfd2lucyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDQtMTA4MC8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA5XzA1MF9zbWIyX25lZ290aWF0ZV9mdW5jX2luZGV4IiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOS0zMTAzIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwOCIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDggUjIiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFZpc3RhIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBWaXN0YSIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFZpc3RhIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOV8wNTBfc21iMl9uZWdvdGlhdGVfZnVuY19pbmRleCIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDktMzEwMyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNV8wMzlfcG5wIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNS0xOTgzIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDZfMDQwX25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtMzQzOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA2Nl9ud2FwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtNDY4OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNzBfd2tzc3ZjIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi00NjkxIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDZfMDQwX25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtMzQzOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKCiAgICAjIFN0YXR1cyB1c2VyICAgICAgICAKICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBDaGVja2luZyBjb21wdXRlcnMgZm9yIHZ1bG5lcmFibGUgT1MgYW5kIFNQIGxldmVscy4uLiIKCiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgU2V0dXAgZGF0YSB0YWJsZSB0byBzdG9yZSB2dWxuZXJhYmxlIHN5c3RlbXMKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgICMgQ3JlYXRlIGRhdGEgdGFibGUgdG8gaG91c2UgdnVsbmVyYWJsZSBzZXJ2ZXIgbGlzdAogICAgJFRhYmxlVnVsbkNvbXB1dGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdDb21wdXRlck5hbWUnKQogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdPcGVyYXRpbmdTeXN0ZW0nKQogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ0xhc3RMb2dvbicpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ01zZk1vZHVsZScpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ0NWRScpCgogICAgIyBJdGVyYXRlIHRocm91Z2ggZWFjaCBleHBsb2l0CiAgICAkVGFibGVFeHBsb2l0cyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAKICAgICAgICAkRXhwbG9pdE9TID0gJF8uT3BlcmF0aW5nU3lzdGVtCiAgICAgICAgJEV4cGxvaXRTUCA9ICRfLlNlcnZpY2VQYWNrCiAgICAgICAgJEV4cGxvaXRNc2YgPSAkXy5Nc2ZNb2R1bGUKICAgICAgICAkRXhwbG9pdENWRSA9ICRfLkNWRQoKICAgICAgICAjIEl0ZXJhdGUgdGhyb3VnaCBlYWNoIEFEUyBjb21wdXRlcgogICAgICAgICRUYWJsZUFkc0NvbXB1dGVycyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgCiAgICAgICAgICAgICRBZHNIb3N0bmFtZSA9ICRfLkhvc3RuYW1lCiAgICAgICAgICAgICRBZHNPUyA9ICRfLk9wZXJhdGluZ1N5c3RlbQogICAgICAgICAgICAkQWRzU1AgPSAkXy5TZXJ2aWNlUGFjayAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICRBZHNMYXN0ID0gJF8uTGFzdExvZ29uCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEFkZCBleHBsb2l0YWJsZSBzeXN0ZW1zIHRvIHZ1bCBjb21wdXRlcnMgZGF0YSB0YWJsZQogICAgICAgICAgICBpZiAoJEFkc09TIC1saWtlICIkRXhwbG9pdE9TKiIgLWFuZCAkQWRzU1AgLWxpa2UgIiRFeHBsb2l0U1AiICkgeyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIEFkZCBkb21haW4gY29tcHV0ZXIgdG8gZGF0YSB0YWJsZSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuUm93cy5BZGQoJEFkc0hvc3RuYW1lLCRBZHNPUywkQWRzU1AsJEFkc0xhc3QsJEV4cGxvaXRNc2YsJEV4cGxvaXRDVkUpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgICMgRGlzcGxheSByZXN1bHRzCiAgICAkVnVsbkNvbXB1dGVyID0gJFRhYmxlVnVsbkNvbXB1dGVycyB8IFNlbGVjdC1PYmplY3QgQ29tcHV0ZXJOYW1lIC1VbmlxdWUgfCBNZWFzdXJlLU9iamVjdAogICAgJFZ1bG5Db21wdXRlckNvdW50ID0gJFZ1bG5Db21wdXRlci5Db3VudAoKICAgIGlmICgkVnVsbkNvbXB1dGVyLkNvdW50IC1ndCAwKSB7CiAgICAgICAgIyBSZXR1cm4gdnVsbmVyYWJsZSBzZXJ2ZXIgbGlzdCBvcmRlciB3aXRoIHNvbWUgaGFjayBkYXRlIGNhc3RpbmcKICAgICAgICBXcml0ZS1WZXJib3NlICJbK10gRm91bmQgJFZ1bG5Db21wdXRlckNvdW50IHBvdGVudGlhbGx5IHZ1bG5lcmFibGUgc3lzdGVtcyEiCiAgICAgICAgJFRhYmxlVnVsbkNvbXB1dGVycyB8IFNvcnQtT2JqZWN0IHsgJF8ubGFzdGxvZ29uIC1hcyBbZGF0ZXRpbWVdfSAtRGVzY2VuZGluZwogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWy1dIE5vIHZ1bG5lcmFibGUgc3lzdGVtcyB3ZXJlIGZvdW5kLiIKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHF1ZXJpZXMgdGhlIGRvbWFpbiBmb3IgYWxsIGFjdGl2ZSBtYWNoaW5lcyB3aXRoCiAgICAgICAgR2V0LU5ldENvbXB1dGVyLCB0aGVuIGZvciBlYWNoIHNlcnZlciBpdCBxdWVyaWVzIHRoZSBsb2NhbAogICAgICAgIEFkbWluaXN0cmF0b3JzIHdpdGggR2V0LU5ldExvY2FsR3JvdXAuCgogICAgICAgIEF1dGhvcjogQGhhcm1qMHkKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0IGFycmF5IHRvIGVudW1lcmF0ZSwgcGFzc2FibGUgb24gdGhlIHBpcGVsaW5lLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWxlCgogICAgICAgIEZpbGUgb2YgaG9zdG5hbWVzL0lQcyB0byBzZWFyY2guCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbHRlcgoKICAgICAgICBIb3N0IGZpbHRlciBuYW1lIHRvIHF1ZXJ5IEFEIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCBmb3IgaG9zdHMsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBOb1BpbmcKCiAgICAgICAgU3dpdGNoLiBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBEZWxheQoKICAgICAgICBEZWxheSBiZXR3ZWVuIGVudW1lcmF0aW5nIGhvc3RzLCBkZWZhdWx0cyB0byAwCgogICAgLlBBUkFNRVRFUiBKaXR0ZXIKCiAgICAgICAgSml0dGVyIGZvciB0aGUgaG9zdCBkZWxheSwgZGVmYXVsdHMgdG8gKy8tIDAuMwoKICAgIC5QQVJBTUVURVIgT3V0RmlsZQoKICAgICAgICBPdXRwdXQgcmVzdWx0cyB0byBhIHNwZWNpZmllZCBjc3Ygb3V0cHV0IGZpbGUuCgogICAgLlBBUkFNRVRFUiBOb0Nsb2JiZXIKCiAgICAgICAgU3dpdGNoLiBEb24ndCBvdmVyd3JpdGUgYW55IGV4aXN0aW5nIG91dHB1dCBmaWxlLgoKICAgIC5QQVJBTUVURVIgVHJ1c3RHcm91cHMKCiAgICAgICAgU3dpdGNoLiBPbmx5IHJldHVybiByZXN1bHRzIHRoYXQgYXJlIG5vdCBwYXJ0IG9mIHRoZSBsb2NhbCBtYWNoaW5lCiAgICAgICAgb3IgdGhlIG1hY2hpbmUncyBkb21haW4uIE9sZCBJbnZva2UtRW51bWVyYXRlTG9jYWxUcnVzdEdyb3VwCiAgICAgICAgZnVuY3Rpb25hbGl0eS4KICAgIAogICAgLlBBUkFNRVRFUiBEb21haW5Pbmx5CgogICAgICAgIFN3aXRjaC4gT25seSByZXR1cm4gZG9tYWluIChub24tbG9jYWwpIHJlc3VsdHMgIAoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KICAgIAogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBTZWFyY2hGb3Jlc3QKCiAgICAgICAgU3dpdGNoLiBTZWFyY2ggYWxsIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCBmb3IgdGFyZ2V0IHVzZXJzIGluc3RlYWQgb2YganVzdAogICAgICAgIGEgc2luZ2xlIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIEFQSQoKICAgICAgICBTd2l0Y2guIFVzZSBBUEkgY2FsbHMgaW5zdGVhZCBvZiB0aGUgV2luTlQgc2VydmljZSBwcm92aWRlci4gTGVzcyBpbmZvcm1hdGlvbiwKICAgICAgICBidXQgdGhlIHJlc3VsdHMgYXJlIGZhc3Rlci4KCiAgICAuUEFSQU1FVEVSIFRocmVhZHMKCiAgICAgICAgVGhlIG1heGltdW0gY29uY3VycmVudCB0aHJlYWRzIHRvIGV4ZWN1dGUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtRW51bWVyYXRlTG9jYWxBZG1pbgoKICAgICAgICBFbnVtZXJhdGVzIHRoZSBtZW1iZXJzIG9mIGxvY2FsIGFkbWluaXN0cmF0b3JzIGZvciBhbGwgbWFjaGluZXMKICAgICAgICBpbiB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtRW51bWVyYXRlTG9jYWxBZG1pbiAtVGhyZWFkcyAxMAoKICAgICAgICBUaHJlYWRlZCBsb2NhbCBhZG1pbiBlbnVtZXJhdGlvbiwgcmVwbGFjZXMgSW52b2tlLUVudW1lcmF0ZUxvY2FsQWRtaW5UaHJlYWRlZAoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9nLmhhcm1qMHkubmV0LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTm9QaW5nLAoKICAgICAgICBbVUludDMyXQogICAgICAgICREZWxheSA9IDAsCgogICAgICAgIFtEb3VibGVdCiAgICAgICAgJEppdHRlciA9IC4zLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRPdXRGaWxlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb0Nsb2JiZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFRydXN0R3JvdXBzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICREb21haW5Pbmx5LAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRBUEkKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLUVudW1lcmF0ZUxvY2FsQWRtaW4gd2l0aCBkZWxheSBvZiAkRGVsYXkiCgogICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgIGlmKCRDb21wdXRlckZpbGUpIHsKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1Db250ZW50IC1QYXRoICRDb21wdXRlckZpbGUKICAgICAgICB9CgogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7IAogICAgICAgICAgICBbYXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQoKICAgICAgICAgICAgaWYoJERvbWFpbikgewogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCREb21haW4pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRTZWFyY2hGb3Jlc3QpIHsKICAgICAgICAgICAgICAgICMgZ2V0IEFMTCB0aGUgZG9tYWlucyBpbiB0aGUgZm9yZXN0IHRvIHNlYXJjaAogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCggKEdldC1OZXREb21haW4pLm5hbWUgKQogICAgICAgICAgICB9CgogICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgLUZpbHRlciAkQ29tcHV0ZXJGaWx0ZXIgLUFEU3BhdGggJENvbXB1dGVyQURTcGF0aCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgIyByZW1vdmUgYW55IG51bGwgdGFyZ2V0IGhvc3RzLCB1bmlxdWlmeSB0aGUgbGlzdCBhbmQgc2h1ZmZsZSBpdAogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7ICRfIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlIHwgU29ydC1PYmplY3QgeyBHZXQtUmFuZG9tIH0KICAgICAgICAgICAgaWYoJCgkQ29tcHV0ZXJOYW1lLkNvdW50KSAtZXEgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIk5vIGhvc3RzIGZvdW5kISIKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBkZWxldGUgYW55IGV4aXN0aW5nIG91dHB1dCBmaWxlIGlmIGl0IGFscmVhZHkgZXhpc3RzCiAgICAgICAgaWYoISROb0Nsb2JiZXIpIHsKICAgICAgICAgICAgaWYgKCRPdXRGaWxlIC1hbmQgKFRlc3QtUGF0aCAtUGF0aCAkT3V0RmlsZSkpIHsgUmVtb3ZlLUl0ZW0gLVBhdGggJE91dEZpbGUgfQogICAgICAgIH0KCiAgICAgICAgaWYoJFRydXN0R3JvdXBzKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJEZXRlcm1pbmluZyBkb21haW4gdHJ1c3QgZ3JvdXBzIgoKICAgICAgICAgICAgIyBmaW5kIGFsbCBncm91cCBuYW1lcyB0aGF0IGhhdmUgb25lIG9yIG1vcmUgdXNlcnMgaW4gYW5vdGhlciBkb21haW4KICAgICAgICAgICAgJFRydXN0R3JvdXBOYW1lcyA9IEZpbmQtRm9yZWlnbkdyb3VwIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciB8IEZvckVhY2gtT2JqZWN0IHsgJF8uR3JvdXBOYW1lIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlCgogICAgICAgICAgICAkVHJ1c3RHcm91cHNTSURzID0gJFRydXN0R3JvdXBOYW1lcyB8IEZvckVhY2gtT2JqZWN0IHsgCiAgICAgICAgICAgICAgICAjIGlnbm9yZSB0aGUgYnVpbHRpbiBhZG1pbmlzdHJhdG9ycyBncm91cCBmb3IgYSBEQyAoUy0xLTUtMzItNTQ0KQogICAgICAgICAgICAgICAgIyBUT0RPOiBpZ25vcmUgYWxsIGRlZmF1bHQgYnVpbHQgaW4gc2lkcz8KICAgICAgICAgICAgICAgIEdldC1OZXRHcm91cCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUdyb3VwTmFtZSAkXyAtRnVsbERhdGEgfCBXaGVyZS1PYmplY3QgeyAkXy5vYmplY3RzaWQgLW5vdG1hdGNoICJTLTEtNS0zMi01NDQiIH0gfCBGb3JFYWNoLU9iamVjdCB7ICRfLm9iamVjdHNpZCB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgcXVlcnkgZm9yIHRoZSBwcmltYXJ5IGRvbWFpbiBjb250cm9sbGVyIHNvIHdlIGNhbiBleHRyYWN0IHRoZSBkb21haW4gU0lEIGZvciBmaWx0ZXJpbmcKICAgICAgICAgICAgJERvbWFpblNJRCA9IEdldC1Eb21haW5TSUQgLURvbWFpbiAkRG9tYWluCiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRPdXRGaWxlLCAkRG9tYWluU0lELCAkVHJ1c3RHcm91cHNTSURzLCAkQVBJLCAkRG9tYWluT25seSkKCiAgICAgICAgICAgICMgb3B0aW9uYWxseSBjaGVjayBpZiB0aGUgc2VydmVyIGlzIHVwIGZpcnN0CiAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAkVXAgPSBUZXN0LUNvbm5lY3Rpb24gLUNvdW50IDEgLVF1aWV0IC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRVcCkgewogICAgICAgICAgICAgICAgIyBncmFiIHRoZSB1c2VycyBmb3IgdGhlIGxvY2FsIGFkbWlucyBvbiB0aGlzIHNlcnZlcgogICAgICAgICAgICAgICAgaWYoJEFQSSkgewogICAgICAgICAgICAgICAgICAgICRMb2NhbEFkbWlucyA9IEdldC1OZXRMb2NhbEdyb3VwIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQVBJCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkTG9jYWxBZG1pbnMgPSBHZXQtTmV0TG9jYWxHcm91cCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjIGlmIHdlIGp1c3Qgd2FudCB0byByZXR1cm4gY3Jvc3MtdHJ1c3QgdXNlcnMKICAgICAgICAgICAgICAgIGlmKCREb21haW5TSUQpIHsKICAgICAgICAgICAgICAgICAgICAjIGdldCB0aGUgbG9jYWwgbWFjaGluZSBTSUQKICAgICAgICAgICAgICAgICAgICAkTG9jYWxTSUQgPSAoJExvY2FsQWRtaW5zIHwgV2hlcmUtT2JqZWN0IHsgJF8uU0lEIC1tYXRjaCAnLiotNTAwJCcgfSkuU0lEIC1yZXBsYWNlICItNTAwJCIKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJMb2NhbFNpZCBmb3IgJENvbXB1dGVyTmFtZSA6ICRMb2NhbFNJRCIKICAgICAgICAgICAgICAgICAgICAjIGZpbHRlciBvdXQgYWNjb3VudHMgdGhhdCBiZWdpbiB3aXRoIHRoZSBtYWNoaW5lIFNJRCBhbmQgZG9tYWluIFNJRAogICAgICAgICAgICAgICAgICAgICMgICBidXQgcHJlc2VydmUgYW55IGdyb3VwcyB0aGF0IGhhdmUgdXNlcnMgYWNyb3NzIGEgdHJ1c3QgKCRUcnVzdEdyb3VwU0lEUykKICAgICAgICAgICAgICAgICAgICAkTG9jYWxBZG1pbnMgPSAkTG9jYWxBZG1pbnMgfCBXaGVyZS1PYmplY3QgeyAoJFRydXN0R3JvdXBzU0lEcyAtY29udGFpbnMgJF8uU0lEKSAtb3IgKCgtbm90ICRfLlNJRC5zdGFydHNXaXRoKCRMb2NhbFNJRCkpIC1hbmQgKC1ub3QgJF8uU0lELnN0YXJ0c1dpdGgoJERvbWFpblNJRCkpKSB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYoJERvbWFpbk9ubHkpIHsKICAgICAgICAgICAgICAgICAgICAkTG9jYWxBZG1pbnMgPSAkTG9jYWxBZG1pbnMgfCBXaGVyZS1PYmplY3QgeyRfLklzRG9tYWlufQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCRMb2NhbEFkbWlucyAtYW5kICgkTG9jYWxBZG1pbnMuTGVuZ3RoIC1uZSAwKSkgewogICAgICAgICAgICAgICAgICAgICMgb3V0cHV0IHRoZSByZXN1bHRzIHRvIGEgY3N2IGlmIHNwZWNpZmllZAogICAgICAgICAgICAgICAgICAgIGlmKCRPdXRGaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbEFkbWlucyB8IEV4cG9ydC1Qb3dlclZpZXdDU1YgLU91dEZpbGUgJE91dEZpbGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIHJldHVybiB0aGUgdXNlciBvYmplY3RzCiAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbEFkbWlucwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlshXSBObyB1c2VycyByZXR1cm5lZCBmcm9tICRDb21wdXRlck5hbWUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdPdXRGaWxlJyA9ICRPdXRGaWxlCiAgICAgICAgICAgICAgICAnRG9tYWluU0lEJyA9ICREb21haW5TSUQKICAgICAgICAgICAgICAgICdUcnVzdEdyb3Vwc1NJRHMnID0gJFRydXN0R3JvdXBzU0lEcwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMKICAgICAgICAgICAgaWYoJEFQSSkgewogICAgICAgICAgICAgICAgJFNjcmlwdFBhcmFtc1snQVBJJ10gPSAkVHJ1ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZigkRG9tYWluT25seSkgewogICAgICAgICAgICAgICAgJFNjcmlwdFBhcmFtc1snRG9tYWluT25seSddID0gJFRydWUKICAgICAgICAgICAgfQogICAgICAgICAKICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zIC1UaHJlYWRzICRUaHJlYWRzCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoLW5vdCAkTm9QaW5nIC1hbmQgKCRDb21wdXRlck5hbWUuY291bnQgLW5lIDEpKSB7CiAgICAgICAgICAgICAgICAjIHBpbmcgYWxsIGhvc3RzIGluIHBhcmFsbGVsCiAgICAgICAgICAgICAgICAkUGluZyA9IHtwYXJhbSgkQ29tcHV0ZXJOYW1lKSBpZihUZXN0LUNvbm5lY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Db3VudCAxIC1RdWlldCAtRXJyb3JBY3Rpb24gU3RvcCl7JENvbXB1dGVyTmFtZX19CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLU5vSW1wb3J0cyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRQaW5nIC1UaHJlYWRzIDEwMAogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVG90YWwgbnVtYmVyIG9mIGFjdGl2ZSBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKICAgICAgICAgICAgJENvdW50ZXIgPSAwCgogICAgICAgICAgICBGb3JFYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgICRDb3VudGVyID0gJENvdW50ZXIgKyAxCgogICAgICAgICAgICAgICAgIyBzbGVlcCBmb3Igb3VyIHNlbWktcmFuZG9taXplZCBpbnRlcnZhbAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkQ29tcHV0ZXIgKCRDb3VudGVyIG9mICQoJENvbXB1dGVyTmFtZS5jb3VudCkpIgoKICAgICAgICAgICAgICAgICRTY3JpcHRBcmdzID0gQCgkQ29tcHV0ZXIsICRGYWxzZSwgJE91dEZpbGUsICREb21haW5TSUQsICRUcnVzdEdyb3Vwc1NJRHMsICRBUEksICREb21haW5Pbmx5KQoKICAgICAgICAgICAgICAgIEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtQXJndW1lbnRMaXN0ICRTY3JpcHRBcmdzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgRG9tYWluIHRydXN0IGZ1bmN0aW9ucyBiZWxvdy4KIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gR2V0LU5ldERvbWFpblRydXN0IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm4gYWxsIGRvbWFpbiB0cnVzdHMgZm9yIHRoZSBjdXJyZW50IGRvbWFpbiBvcgogICAgICAgIGEgc3BlY2lmaWVkIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHdob3NlIHRydXN0cyB0byBlbnVtZXJhdGUsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIExEQVAKCiAgICAgICAgU3dpdGNoLiBVc2UgTERBUCBxdWVyaWVzIHRvIGVudW1lcmF0ZSB0aGUgdHJ1c3RzIGluc3RlYWQgb2YgZGlyZWN0IGRvbWFpbiBjb25uZWN0aW9ucy4gCiAgICAgICAgTW9yZSBsaWtlbHkgdG8gZ2V0IGFyb3VuZCBuZXR3b3JrIHNlZ21lbnRhdGlvbiwgYnV0IG5vdCBhcyBhY2N1cmF0ZS4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXREb21haW5UcnVzdAoKICAgICAgICBSZXR1cm4gZG9tYWluIHRydXN0cyBmb3IgdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldERvbWFpblRydXN0IC1Eb21haW4gInByb2QudGVzdGxhYi5sb2NhbCIKCiAgICAgICAgUmV0dXJuIGRvbWFpbiB0cnVzdHMgZm9yIHRoZSAicHJvZC50ZXN0bGFiLmxvY2FsIiBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluVHJ1c3QgLURvbWFpbiAicHJvZC50ZXN0bGFiLmxvY2FsIiAtRG9tYWluQ29udHJvbGxlciAiUFJJTUFSWS50ZXN0bGFiLmxvY2FsIgoKICAgICAgICBSZXR1cm4gZG9tYWluIHRydXN0cyBmb3IgdGhlICJwcm9kLnRlc3RsYWIubG9jYWwiIGRvbWFpbiwgcmVmbGVjdGluZwogICAgICAgIHF1ZXJpZXMgdGhyb3VnaCB0aGUgIlByaW1hcnkudGVzdGxhYi5sb2NhbCIgZG9tYWluIGNvbnRyb2xsZXIKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJExEQVAsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYoISREb21haW4pIHsKICAgICAgICAgICAgJERvbWFpbiA9IChHZXQtTmV0RG9tYWluIC1DcmVkZW50aWFsICRDcmVkZW50aWFsKS5OYW1lCiAgICAgICAgfQoKICAgICAgICBpZigkTERBUCAtb3IgJERvbWFpbkNvbnRyb2xsZXIpIHsKCiAgICAgICAgICAgICRUcnVzdFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgICAgICBpZigkVHJ1c3RTZWFyY2hlcikgewoKICAgICAgICAgICAgICAgICRUcnVzdFNlYXJjaGVyLmZpbHRlciA9ICcoJihvYmplY3RDbGFzcz10cnVzdGVkRG9tYWluKSknCgogICAgICAgICAgICAgICAgJFJlc3VsdHMgPSAkVHJ1c3RTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICRSZXN1bHRzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJFByb3BzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAkVHJ1c3RBdHRyaWIgPSBTd2l0Y2ggKCRQcm9wcy50cnVzdGF0dHJpYnV0ZXMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAweDAwMSB7ICJub25fdHJhbnNpdGl2ZSIgfQogICAgICAgICAgICAgICAgICAgICAgICAweDAwMiB7ICJ1cGxldmVsX29ubHkiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMHgwMDQgeyAicXVhcmFudGluZWRfZG9tYWluIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDA4IHsgImZvcmVzdF90cmFuc2l0aXZlIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEwIHsgImNyb3NzX29yZ2FuaXphdGlvbiIgfQogICAgICAgICAgICAgICAgICAgICAgICAweDAyMCB7ICJ3aXRoaW5fZm9yZXN0IiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDQwIHsgInRyZWF0X2FzX2V4dGVybmFsIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDgwIHsgInRydXN0X3VzZXNfcmM0X2VuY3J5cHRpb24iIH0KICAgICAgICAgICAgICAgICAgICAgICAgMHgxMDAgeyAidHJ1c3RfdXNlc19hZXNfa2V5cyIgfQogICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0IHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJVbmtub3duIHRydXN0IGF0dHJpYnV0ZTogJCgkUHJvcHMudHJ1c3RhdHRyaWJ1dGVzKSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJCgkUHJvcHMudHJ1c3RhdHRyaWJ1dGVzKSI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJERpcmVjdGlvbiA9IFN3aXRjaCAoJFByb3BzLnRydXN0ZGlyZWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDAgeyAiRGlzYWJsZWQiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMSB7ICJJbmJvdW5kIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDIgeyAiT3V0Ym91bmQiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMyB7ICJCaWRpcmVjdGlvbmFsIiB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRPYmplY3RHdWlkID0gTmV3LU9iamVjdCBHdWlkIEAoLCRQcm9wcy5vYmplY3RndWlkWzBdKQogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTb3VyY2VOYW1lJyAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RhcmdldE5hbWUnICRQcm9wcy5uYW1lWzBdCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdEd1aWQnICJ7JE9iamVjdEd1aWR9IgogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdUcnVzdFR5cGUnICIkVHJ1c3RBdHRyaWIiCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RydXN0RGlyZWN0aW9uJyAiJERpcmVjdGlvbiIKICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRSZXN1bHRzLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgJFRydXN0U2VhcmNoZXIuZGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIGRpcmVjdCBkb21haW4gY29ubmVjdGlvbnMKICAgICAgICAgICAgJEZvdW5kRG9tYWluID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4gLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmKCRGb3VuZERvbWFpbikgewogICAgICAgICAgICAgICAgJEZvdW5kRG9tYWluLkdldEFsbFRydXN0UmVsYXRpb25zaGlwcygpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0Rm9yZXN0VHJ1c3Qgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiBhbGwgdHJ1c3RzIGZvciB0aGUgY3VycmVudCBmb3Jlc3QuCgogICAgLlBBUkFNRVRFUiBGb3Jlc3QKCiAgICAgICAgUmV0dXJuIHRydXN0cyBmb3IgdGhlIHNwZWNpZmllZCBmb3Jlc3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRGb3Jlc3RUcnVzdAoKICAgICAgICBSZXR1cm4gY3VycmVudCBmb3Jlc3QgdHJ1c3RzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZvcmVzdFRydXN0IC1Gb3Jlc3QgInRlc3QiCgogICAgICAgIFJldHVybiB0cnVzdHMgZm9yIHRoZSAidGVzdCIgZm9yZXN0LgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZvcmVzdCwKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICAkRm91bmRGb3Jlc3QgPSBHZXQtTmV0Rm9yZXN0IC1Gb3Jlc3QgJEZvcmVzdCAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAoKICAgICAgICBpZigkRm91bmRGb3Jlc3QpIHsKICAgICAgICAgICAgJEZvdW5kRm9yZXN0LkdldEFsbFRydXN0UmVsYXRpb25zaGlwcygpCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gRmluZC1Gb3JlaWduVXNlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgRW51bWVyYXRlcyB1c2VycyB3aG8gYXJlIGluIGdyb3VwcyBvdXRzaWRlIG9mIHRoZWlyCiAgICAgICAgcHJpbmNpcGFsIGRvbWFpbi4gVGhlIC1SZWN1cnNlIG9wdGlvbiB3aWxsIHRyeSB0byBtYXAgYWxsIAogICAgICAgIHRyYW5zaXRpdmUgZG9tYWluIHRydXN0IHJlbGF0aW9uc2hpcHMgYW5kIGVudW1lcmF0ZSBhbGwgCiAgICAgICAgdXNlcnMgd2hvIGFyZSBpbiBncm91cHMgb3V0c2lkZSBvZiB0aGVpciBwcmluY2lwYWwgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVXNlck5hbWUKCiAgICAgICAgVXNlcm5hbWUgdG8gZmlsdGVyIHJlc3VsdHMgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZW51bWVyYXRlIHRoZSB0cnVzdHMgaW5zdGVhZCBvZiBkaXJlY3QgZG9tYWluIGNvbm5lY3Rpb25zLgogICAgICAgIE1vcmUgbGlrZWx5IHRvIGdldCBhcm91bmQgbmV0d29yayBzZWdtZW50YXRpb24sIGJ1dCBub3QgYXMgYWNjdXJhdGUuCgogICAgLlBBUkFNRVRFUiBSZWN1cnNlCgogICAgICAgIFN3aXRjaC4gRW51bWVyYXRlIGFsbCB1c2VyIHRydXN0IGdyb3VwcyBmcm9tIGFsbCByZWFjaGFibGUgZG9tYWlucyByZWN1cnNpdmVseS4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldC8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTERBUCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgZnVuY3Rpb24gR2V0LUZvcmVpZ25Vc2VyIHsKICAgICAgICAjIGhlbHBlciB1c2VkIHRvIGVudW1lcmF0ZSB1c2VycyB3aG8gYXJlIGluIGdyb3VwcyBvdXRzaWRlIG9mIHRoZWlyIHByaW5jaXBhbCBkb21haW4KICAgICAgICBwYXJhbSgKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbiwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgICAgICBbSW50XQogICAgICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICAgICApCgogICAgICAgIGlmICgkRG9tYWluKSB7CiAgICAgICAgICAgICMgZ2V0IHRoZSBkb21haW4gbmFtZSBpbnRvIGRpc3Rpbmd1aXNoZWQgZm9ybQogICAgICAgICAgICAkRGlzdGluZ3Vpc2hlZERvbWFpbk5hbWUgPSAiREM9IiArICREb21haW4gLXJlcGxhY2UgJ1wuJywnLERDPScKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICREaXN0aW5ndWlzaGVkRG9tYWluTmFtZSA9IFtTdHJpbmddIChbYWRzaV0nJykuZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgJERvbWFpbiA9ICREaXN0aW5ndWlzaGVkRG9tYWluTmFtZSAtcmVwbGFjZSAnREM9JywnJyAtcmVwbGFjZSAnLCcsJy4nCiAgICAgICAgfQoKICAgICAgICBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVVzZXJOYW1lICRVc2VyTmFtZSAtUGFnZVNpemUgJFBhZ2VTaXplIHwgV2hlcmUtT2JqZWN0IHskXy5tZW1iZXJvZn0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIEZvckVhY2ggKCRNZW1iZXJzaGlwIGluICRfLm1lbWJlcm9mKSB7CiAgICAgICAgICAgICAgICAkSW5kZXggPSAkTWVtYmVyc2hpcC5JbmRleE9mKCJEQz0iKQogICAgICAgICAgICAgICAgaWYoJEluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwRG9tYWluID0gJCgkTWVtYmVyc2hpcC5zdWJzdHJpbmcoJEluZGV4KSkgLXJlcGxhY2UgJ0RDPScsJycgLXJlcGxhY2UgJywnLCcuJwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmICgkR3JvdXBEb21haW4uQ29tcGFyZVRvKCREb21haW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgaWYgdGhlIGdyb3VwIGRvbWFpbiBkb2Vzbid0IG1hdGNoIHRoZSB1c2VyIGRvbWFpbiwgb3V0cHV0CiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cE5hbWUgPSAkTWVtYmVyc2hpcC5zcGxpdCgiLCIpWzBdLnNwbGl0KCI9IilbMV0KICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Vc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnblVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckRvbWFpbicgJERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnblVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlck5hbWUnICRfLnNhbWFjY291bnRuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cERvbWFpbicgJEdyb3VwRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cE5hbWUnICRHcm91cE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Vc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dyb3VwRE4nICRNZW1iZXJzaGlwCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduVXNlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBpZiAoJFJlY3Vyc2UpIHsKICAgICAgICAjIGdldCBhbGwgcmVjaGFibGUgZG9tYWlucyBpbiB0aGUgdHJ1c3QgbWVzaCBhbmQgdW5pcXVpZnkgdGhlbQogICAgICAgIGlmKCRMREFQIC1vciAkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICAgICAkRG9tYWluVHJ1c3RzID0gSW52b2tlLU1hcERvbWFpblRydXN0IC1MREFQIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JFYWNoLU9iamVjdCB7ICRfLlNvdXJjZURvbWFpbiB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJERvbWFpblRydXN0cyA9IEludm9rZS1NYXBEb21haW5UcnVzdCAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Tb3VyY2VEb21haW4gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKICAgICAgICB9CgogICAgICAgIEZvckVhY2goJERvbWFpblRydXN0IGluICREb21haW5UcnVzdHMpIHsKICAgICAgICAgICAgIyBnZXQgdGhlIHRydXN0IGdyb3VwcyBmb3IgZWFjaCBkb21haW4gaW4gdGhlIHRydXN0IG1lc2gKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRW51bWVyYXRpbmcgdHJ1c3QgZ3JvdXBzIGluIGRvbWFpbiAkRG9tYWluVHJ1c3QiCiAgICAgICAgICAgIEdldC1Gb3JlaWduVXNlciAtRG9tYWluICREb21haW5UcnVzdCAtVXNlck5hbWUgJFVzZXJOYW1lIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBHZXQtRm9yZWlnblVzZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1Vc2VyTmFtZSAkVXNlck5hbWUgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQp9CgoKZnVuY3Rpb24gRmluZC1Gb3JlaWduR3JvdXAgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEVudW1lcmF0ZXMgYWxsIHRoZSBtZW1iZXJzIG9mIGEgZ2l2ZW4gZG9tYWluJ3MgZ3JvdXBzCiAgICAgICAgYW5kIGZpbmRzIHVzZXJzIHRoYXQgYXJlIG5vdCBpbiB0aGUgcXVlcmllZCBkb21haW4uCiAgICAgICAgVGhlIC1SZWN1cnNlIGZsYWcgd2lsbCBwZXJmb3JtIHRoaXMgZW51bWVyYXRpb24gZm9yIGFsbAogICAgICAgIGVhY2hhYmxlIGRvbWFpbiB0cnVzdHMuCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgR3JvdXBuYW1lIHRvIGZpbHRlciByZXN1bHRzIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBxdWVyeSBmb3IgZ3JvdXBzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBMREFQCgogICAgICAgIFN3aXRjaC4gVXNlIExEQVAgcXVlcmllcyB0byBlbnVtZXJhdGUgdGhlIHRydXN0cyBpbnN0ZWFkIG9mIGRpcmVjdCBkb21haW4gY29ubmVjdGlvbnMuCiAgICAgICAgTW9yZSBsaWtlbHkgdG8gZ2V0IGFyb3VuZCBuZXR3b3JrIHNlZ21lbnRhdGlvbiwgYnV0IG5vdCBhcyBhY2N1cmF0ZS4KCiAgICAuUEFSQU1FVEVSIFJlY3Vyc2UKCiAgICAgICAgU3dpdGNoLiBFbnVtZXJhdGUgYWxsIGdyb3VwIHRydXN0IHVzZXJzIGZyb20gYWxsIHJlYWNoYWJsZSBkb21haW5zIHJlY3Vyc2l2ZWx5LgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9nLmhhcm1qMHkubmV0LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUgPSAnKicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTERBUCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgZnVuY3Rpb24gR2V0LUZvcmVpZ25Hcm91cCB7CiAgICAgICAgcGFyYW0oCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRHcm91cE5hbWUgPSAnKicsCgogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkRG9tYWluLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgICAgIFtJbnRdCiAgICAgICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgICAgICkKCiAgICAgICAgaWYoLW5vdCAkRG9tYWluKSB7CiAgICAgICAgICAgICREb21haW4gPSAoR2V0LU5ldERvbWFpbikuTmFtZQogICAgICAgIH0KCiAgICAgICAgJERvbWFpbkROID0gIkRDPSQoJERvbWFpbi5SZXBsYWNlKCcuJywgJyxEQz0nKSkiCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRG9tYWluRE46ICREb21haW5ETiIKCiAgICAgICAgIyBzdGFuZGFyZCBncm91cCBuYW1lcyB0byBpZ25vcmUKICAgICAgICAkRXhjbHVkZUdyb3VwcyA9IEAoIlVzZXJzIiwgIkRvbWFpbiBVc2VycyIsICJHdWVzdHMiKQoKICAgICAgICAjIGdldCBhbGwgdGhlIGdyb3VwbmFtZXMgZm9yIHRoZSBnaXZlbiBkb21haW4KICAgICAgICBHZXQtTmV0R3JvdXAgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7JF8ubWVtYmVyfSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICMgZXhjbHVkZSBjb21tb24gbGFyZ2UgZ3JvdXBzCiAgICAgICAgICAgIC1ub3QgKCRFeGNsdWRlR3JvdXBzIC1jb250YWlucyAkXy5zYW1hY2NvdW50bmFtZSkgfSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgJEdyb3VwTmFtZSA9ICRfLnNhbUFjY291bnROYW1lCgogICAgICAgICAgICAgICAgJF8ubWVtYmVyIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICMgZmlsdGVyIGZvciBmb3JlaWduIFNJRHMgaW4gdGhlIGNuIGZpZWxkIGZvciB1c2VycyBpbiBhbm90aGVyIGRvbWFpbiwKICAgICAgICAgICAgICAgICAgICAjICAgb3IgaWYgdGhlIEROIGRvZXNuJ3QgZW5kIHdpdGggdGhlIHByb3BlciBETiBmb3IgdGhlIHF1ZXJpZWQgZG9tYWluICAKICAgICAgICAgICAgICAgICAgICBpZiAoKCRfIC1tYXRjaCAnQ049Uy0xLTUtMjEuKi0uKicpIC1vciAoJERvbWFpbkROIC1uZSAoJF8uc3Vic3RyaW5nKCRfLkluZGV4T2YoIkRDPSIpKSkpKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkVXNlckRvbWFpbiA9ICRfLnN1YlN0cmluZygkXy5JbmRleE9mKCJEQz0iKSkgLXJlcGxhY2UgJ0RDPScsJycgLXJlcGxhY2UgJywnLCcuJwogICAgICAgICAgICAgICAgICAgICAgICAkVXNlck5hbWUgPSAkXy5zcGxpdCgiLCIpWzBdLnNwbGl0KCI9IilbMV0KCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduR3JvdXBVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnbkdyb3VwVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cERvbWFpbicgJERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnbkdyb3VwVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cE5hbWUnICRHcm91cE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Hcm91cFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckRvbWFpbicgJFVzZXJEb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Hcm91cFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlck5hbWUnICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnbkdyb3VwVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyRE4nICRfCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduR3JvdXBVc2VyCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBpZiAoJFJlY3Vyc2UpIHsKICAgICAgICAjIGdldCBhbGwgcmVjaGFibGUgZG9tYWlucyBpbiB0aGUgdHJ1c3QgbWVzaCBhbmQgdW5pcXVpZnkgdGhlbQogICAgICAgIGlmKCRMREFQIC1vciAkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICAgICAkRG9tYWluVHJ1c3RzID0gSW52b2tlLU1hcERvbWFpblRydXN0IC1MREFQIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JFYWNoLU9iamVjdCB7ICRfLlNvdXJjZURvbWFpbiB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJERvbWFpblRydXN0cyA9IEludm9rZS1NYXBEb21haW5UcnVzdCAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Tb3VyY2VEb21haW4gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKICAgICAgICB9CgogICAgICAgIEZvckVhY2goJERvbWFpblRydXN0IGluICREb21haW5UcnVzdHMpIHsKICAgICAgICAgICAgIyBnZXQgdGhlIHRydXN0IGdyb3VwcyBmb3IgZWFjaCBkb21haW4gaW4gdGhlIHRydXN0IG1lc2gKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRW51bWVyYXRpbmcgdHJ1c3QgZ3JvdXBzIGluIGRvbWFpbiAkRG9tYWluVHJ1c3QiCiAgICAgICAgICAgIEdldC1Gb3JlaWduR3JvdXAgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgR2V0LUZvcmVpZ25Hcm91cCAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtTWFuYWdlZFNlY3VyaXR5R3JvdXBzIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHJldHJpZXZlcyBhbGwgc2VjdXJpdHkgZ3JvdXBzIGluIHRoZSBkb21haW4gYW5kIGlkZW50aWZpZXMgb25lcyB0aGF0CiAgICAgICAgaGF2ZSBhIG1hbmFnZXIgc2V0LiBJdCBhbHNvIGRldGVybWluZXMgd2hldGhlciB0aGUgbWFuYWdlciBoYXMgdGhlIGFiaWxpdHkgdG8gYWRkCiAgICAgICAgb3IgcmVtb3ZlIG1lbWJlcnMgZnJvbSB0aGUgZ3JvdXAuCgogICAgICAgIEF1dGhvcjogU3R1YXJ0IE1vcmdhbiAoQHVrc3R1ZnVzKSA8c3R1YXJ0Lm1vcmdhbkBtd3JpbmZvc2VjdXJpdHkuY29tPgogICAgICAgIExpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1NYW5hZ2VkU2VjdXJpdHlHcm91cHMgfCBFeHBvcnQtUG93ZXJWaWV3Q1NWIC1Ob1R5cGVJbmZvcm1hdGlvbiBncm91cC1tYW5hZ2Vycy5jc3YKCiAgICAgICAgU3RvcmUgYSBsaXN0IG9mIGFsbCBzZWN1cml0eSBncm91cHMgd2l0aCBtYW5hZ2VycyBpbiBncm91cC1tYW5hZ2Vycy5jc3YKCiAgICAuREVTQ1JJUFRJT04KCiAgICAgICAgQXV0aG9yaXR5IHRvIG1hbmlwdWxhdGUgdGhlIGdyb3VwIG1lbWJlcnNoaXAgb2YgQUQgc2VjdXJpdHkgZ3JvdXBzIGFuZCBkaXN0cmlidXRpb24gZ3JvdXBzIAogICAgICAgIGNhbiBiZSBkZWxlZ2F0ZWQgdG8gbm9uLWFkbWluaXN0cmF0b3JzIGJ5IHNldHRpbmcgdGhlICdtYW5hZ2VkQnknIGF0dHJpYnV0ZS4gVGhpcyBpcyB0eXBpY2FsbHkKICAgICAgICB1c2VkIHRvIGRlbGVnYXRlIG1hbmFnZW1lbnQgYXV0aG9yaXR5IHRvIGRpc3RyaWJ1dGlvbiBncm91cHMsIGJ1dCBXaW5kb3dzIHN1cHBvcnRzIHNlY3VyaXR5IGdyb3VwcwogICAgICAgIGJlaW5nIG1hbmFnZWQgaW4gdGhlIHNhbWUgd2F5LgoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHNlYXJjaGVzIGZvciBBRCBncm91cHMgd2hpY2ggaGF2ZSBhIGdyb3VwIG1hbmFnZXIgc2V0LCBhbmQgZGV0ZXJtaW5lcyB3aGV0aGVyIHRoYXQKICAgICAgICB1c2VyIGNhbiBtYW5pcHVsYXRlIGdyb3VwIG1lbWJlcnNoaXAuIFRoaXMgY291bGQgYmUgYSB1c2VmdWwgbWV0aG9kIG9mIGhvcml6b250YWwgcHJpdmlsZWdlCiAgICAgICAgZXNjYWxhdGlvbiwgZXNwZWNpYWxseSBpZiB0aGUgbWFuYWdlciBjYW4gbWFuaXB1bGF0ZSB0aGUgbWVtYmVyc2hpcCBvZiBhIHByaXZpbGVnZWQgZ3JvdXAuCgogICAgLkxJTksKCiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxFbXBpcmUvRW1waXJlL3B1bGwvMTE5CgojPgoKICAgICMgR28gdGhyb3VnaCB0aGUgbGlzdCBvZiBzZWN1cml0eSBncm91cHMgb24gdGhlIGRvbWFpbiBhbmQgaWRlbnRpZnkgdGhvc2Ugd2hvIGhhdmUgYSBtYW5hZ2VyCiAgICBHZXQtTmV0R3JvdXAgLUZ1bGxEYXRhIC1GaWx0ZXIgJygmKG1hbmFnZWRCeT0qKShncm91cFR5cGU6MS4yLjg0MC4xMTM1NTYuMS40LjgwMzo9MjE0NzQ4MzY0OCkpJyB8IFNlbGVjdC1PYmplY3QgLVVuaXF1ZSBkaXN0aW5ndWlzaGVkTmFtZSxtYW5hZ2VkQnksY24gfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICMgUmV0cmlldmUgdGhlIG9iamVjdCB0aGF0IHRoZSBtYW5hZ2VkQnkgRE4gcmVmZXJzIHRvCiAgICAgICAgJGdyb3VwX21hbmFnZXIgPSBHZXQtQURPYmplY3QgLUFEU1BhdGggJF8ubWFuYWdlZEJ5IHwgU2VsZWN0LU9iamVjdCBjbixkaXN0aW5ndWlzaGVkbmFtZSxuYW1lLHNhbWFjY291bnR0eXBlLHNhbWFjY291bnRuYW1lCgogICAgICAgICMgQ3JlYXRlIGEgcmVzdWx0cyBvYmplY3QgdG8gc3RvcmUgb3VyIGZpbmRpbmdzCiAgICAgICAgJHJlc3VsdHNfb2JqZWN0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5IEB7CiAgICAgICAgICAgICdHcm91cENOJyA9ICRfLmNuCiAgICAgICAgICAgICdHcm91cEROJyA9ICRfLmRpc3Rpbmd1aXNoZWRuYW1lCiAgICAgICAgICAgICdNYW5hZ2VyQ04nID0gJGdyb3VwX21hbmFnZXIuY24KICAgICAgICAgICAgJ01hbmFnZXJETicgPSAkZ3JvdXBfbWFuYWdlci5kaXN0aW5ndWlzaGVkTmFtZQogICAgICAgICAgICAnTWFuYWdlclNBTicgPSAkZ3JvdXBfbWFuYWdlci5zYW1hY2NvdW50bmFtZQogICAgICAgICAgICAnTWFuYWdlclR5cGUnID0gJycKICAgICAgICAgICAgJ0Nhbk1hbmFnZXJXcml0ZScgPSAkRkFMU0UKICAgICAgICB9CgogICAgICAgICMgRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIG1hbmFnZXIgaXMgYSB1c2VyIG9yIGEgZ3JvdXAKICAgICAgICBpZiAoJGdyb3VwX21hbmFnZXIuc2FtYWNjb3VudHR5cGUgLWVxIDB4MTAwMDAwMDApIHsKICAgICAgICAgICAgJHJlc3VsdHNfb2JqZWN0Lk1hbmFnZXJUeXBlID0gJ0dyb3VwJwogICAgICAgIH0gZWxzZWlmICgkZ3JvdXBfbWFuYWdlci5zYW1hY2NvdW50dHlwZSAtZXEgMHgzMDAwMDAwMCkgewogICAgICAgICAgICAkcmVzdWx0c19vYmplY3QuTWFuYWdlclR5cGUgPSAnVXNlcicKICAgICAgICB9CgogICAgICAgICMgRmluZCB0aGUgQUNMcyB0aGF0IHJlbGF0ZSB0byB0aGUgYWJpbGl0eSB0byB3cml0ZSB0byB0aGUgZ3JvdXAKICAgICAgICAkeGFjbCA9IEdldC1PYmplY3RBY2wgLUFEU1BhdGggJF8uZGlzdGluZ3Vpc2hlZG5hbWUgLVJpZ2h0cyBXcml0ZU1lbWJlcnMKCiAgICAgICAgIyBEb3VibGUtY2hlY2sgdGhhdCB0aGUgbWFuYWdlcgogICAgICAgIGlmICgkeGFjbC5PYmplY3RUeXBlIC1lcSAnYmY5Njc5YzAtMGRlNi0xMWQwLWEyODUtMDBhYTAwMzA0OWUyJyAtYW5kICR4YWNsLkFjY2Vzc0NvbnRyb2xUeXBlIC1lcSAnQWxsb3cnIC1hbmQgJHhhY2wuSWRlbnRpdHlSZWZlcmVuY2UuVmFsdWUuQ29udGFpbnMoJGdyb3VwX21hbmFnZXIuc2FtYWNjb3VudG5hbWUpKSB7CiAgICAgICAgICAgICRyZXN1bHRzX29iamVjdC5DYW5NYW5hZ2VyV3JpdGUgPSAkVFJVRQogICAgICAgIH0KICAgICAgICAkcmVzdWx0c19vYmplY3QKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1NYXBEb21haW5UcnVzdCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiBnZXRzIGFsbCB0cnVzdHMgZm9yIHRoZSBjdXJyZW50IGRvbWFpbiwKICAgICAgICBhbmQgdHJpZXMgdG8gZ2V0IGFsbCB0cnVzdHMgZm9yIGVhY2ggZG9tYWluIGl0IGZpbmRzLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZW51bWVyYXRlIHRoZSB0cnVzdHMgaW5zdGVhZCBvZiBkaXJlY3QgZG9tYWluIGNvbm5lY3Rpb25zLgogICAgICAgIE1vcmUgbGlrZWx5IHRvIGdldCBhcm91bmQgbmV0d29yayBzZWdtZW50YXRpb24sIGJ1dCBub3QgYXMgYWNjdXJhdGUuCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBDcmVkZW50aWFsCgogICAgICAgIEEgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIG9iamVjdCBvZiBhbHRlcm5hdGUgY3JlZGVudGlhbHMKICAgICAgICBmb3IgY29ubmVjdGlvbiB0byB0aGUgdGFyZ2V0IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1NYXBEb21haW5UcnVzdCB8IEV4cG9ydC1DU1YgLU5vVHlwZUluZm9ybWF0aW9uIHRydXN0cy5jc3YKICAgICAgICAKICAgICAgICBNYXAgYWxsIHJlYWNoYWJsZSBkb21haW4gdHJ1c3RzIGFuZCBvdXRwdXQgZXZlcnl0aGluZyB0byBhIC5jc3YgZmlsZS4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldC8KIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbU3dpdGNoXQogICAgICAgICRMREFQLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCgogICAgKQoKICAgICMga2VlcCB0cmFjayBvZiBkb21haW5zIHNlZW4gc28gd2UgZG9uJ3QgaGl0IGluZmluaXRlIHJlY3Vyc2lvbgogICAgJFNlZW5Eb21haW5zID0gQHt9CgogICAgIyBvdXIgZG9tYWluIHN0YXR1cyB0cmFja2VyCiAgICAkRG9tYWlucyA9IE5ldy1PYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlN0YWNrCgogICAgIyBnZXQgdGhlIGN1cnJlbnQgZG9tYWluIGFuZCBwdXNoIGl0IG9udG8gdGhlIHN0YWNrCiAgICAkQ3VycmVudERvbWFpbiA9IChHZXQtTmV0RG9tYWluIC1DcmVkZW50aWFsICRDcmVkZW50aWFsKS5OYW1lCiAgICAkRG9tYWlucy5wdXNoKCRDdXJyZW50RG9tYWluKQoKICAgIHdoaWxlKCREb21haW5zLkNvdW50IC1uZSAwKSB7CgogICAgICAgICREb21haW4gPSAkRG9tYWlucy5Qb3AoKQoKICAgICAgICAjIGlmIHdlIGhhdmVuJ3Qgc2VlbiB0aGlzIGRvbWFpbiBiZWZvcmUKICAgICAgICBpZiAoJERvbWFpbiAtYW5kICgkRG9tYWluLlRyaW0oKSAtbmUgIiIpIC1hbmQgKC1ub3QgJFNlZW5Eb21haW5zLkNvbnRhaW5zS2V5KCREb21haW4pKSkgewogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRW51bWVyYXRpbmcgdHJ1c3RzIGZvciBkb21haW4gJyREb21haW4nIgoKICAgICAgICAgICAgIyBtYXJrIGl0IGFzIHNlZW4gaW4gb3VyIGxpc3QKICAgICAgICAgICAgJE51bGwgPSAkU2VlbkRvbWFpbnMuYWRkKCREb21haW4sICIiKQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICMgZ2V0IGFsbCB0aGUgdHJ1c3RzIGZvciB0aGlzIGRvbWFpbgogICAgICAgICAgICAgICAgaWYoJExEQVAgLW9yICREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgICAgICAgICAgJFRydXN0cyA9IEdldC1OZXREb21haW5UcnVzdCAtRG9tYWluICREb21haW4gLUxEQVAgLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZSAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFRydXN0cyA9IEdldC1OZXREb21haW5UcnVzdCAtRG9tYWluICREb21haW4gLVBhZ2VTaXplICRQYWdlU2l6ZSAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCRUcnVzdHMgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7CiAgICAgICAgICAgICAgICAgICAgJFRydXN0cyA9IEAoJFRydXN0cykKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjIGdldCBhbnkgZm9yZXN0IHRydXN0cywgaWYgdGhleSBleGlzdAogICAgICAgICAgICAgICAgJFRydXN0cyArPSBHZXQtTmV0Rm9yZXN0VHJ1c3QgLUZvcmVzdCAkRG9tYWluIC1DcmVkZW50aWFsICRDcmVkZW50aWFsCgogICAgICAgICAgICAgICAgaWYgKCRUcnVzdHMpIHsKCiAgICAgICAgICAgICAgICAgICAgIyBlbnVtZXJhdGUgZWFjaCB0cnVzdCBmb3VuZAogICAgICAgICAgICAgICAgICAgIEZvckVhY2ggKCRUcnVzdCBpbiAkVHJ1c3RzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTb3VyY2VEb21haW4gPSAkVHJ1c3QuU291cmNlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWluID0gJFRydXN0LlRhcmdldE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFRydXN0VHlwZSA9ICRUcnVzdC5UcnVzdFR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgJFRydXN0RGlyZWN0aW9uID0gJFRydXN0LlRydXN0RGlyZWN0aW9uCgogICAgICAgICAgICAgICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZSBwcm9jZXNzIHRoZSB0YXJnZXQKICAgICAgICAgICAgICAgICAgICAgICAgJE51bGwgPSAkRG9tYWlucy5wdXNoKCRUYXJnZXREb21haW4pCgogICAgICAgICAgICAgICAgICAgICAgICAjIGJ1aWxkIHRoZSBuaWNlbHktcGFyc2FibGUgY3VzdG9tIG91dHB1dCBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0ID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU291cmNlRG9tYWluJyAiJFNvdXJjZURvbWFpbiIKICAgICAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RhcmdldERvbWFpbicgIiRUYXJnZXREb21haW4iCiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdUcnVzdFR5cGUnICIkVHJ1c3RUeXBlIgogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVHJ1c3REaXJlY3Rpb24nICIkVHJ1c3REaXJlY3Rpb24iCiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJbIV0gRXJyb3I6ICRfIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIEV4cG9zZSB0aGUgV2luMzJBUEkgZnVuY3Rpb25zIGFuZCBkYXRhc3RydWN0dXJlcyBiZWxvdwojIHVzaW5nIFBTUmVmbGVjdC4gCiMgV2FybmluZzogT25jZSB0aGVzZSBhcmUgZXhlY3V0ZWQsIHRoZXkgYXJlIGJha2VkIGluIAojIGFuZCBjYW4ndCBiZSBjaGFuZ2VkIHdoaWxlIHRoZSBzY3JpcHQgaXMgcnVubmluZyEKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKJE1vZCA9IE5ldy1Jbk1lbW9yeU1vZHVsZSAtTW9kdWxlTmFtZSBXaW4zMgoKIyBhbGwgb2YgdGhlIFdpbjMyIEFQSSBmdW5jdGlvbnMgd2UgbmVlZAokRnVuY3Rpb25EZWZpbml0aW9ucyA9IEAoCiAgICAoZnVuYyBuZXRhcGkzMiBOZXRTaGFyZUVudW0gKFtJbnRdKSBAKFtTdHJpbmddLCBbSW50XSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50XSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkpLAogICAgKGZ1bmMgbmV0YXBpMzIgTmV0V2tzdGFVc2VyRW51bSAoW0ludF0pIEAoW1N0cmluZ10sIFtJbnRdLCBbSW50UHRyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnRdLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyBuZXRhcGkzMiBOZXRTZXNzaW9uRW51bSAoW0ludF0pIEAoW1N0cmluZ10sIFtTdHJpbmddLCBbU3RyaW5nXSwgW0ludF0sIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludF0sIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCkpKSwKICAgIChmdW5jIG5ldGFwaTMyIE5ldExvY2FsR3JvdXBHZXRNZW1iZXJzIChbSW50XSkgQChbU3RyaW5nXSwgW1N0cmluZ10sIFtJbnRdLCBbSW50UHRyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnRdLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyBuZXRhcGkzMiBEc0dldFNpdGVOYW1lIChbSW50XSkgQChbU3RyaW5nXSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyBuZXRhcGkzMiBOZXRBcGlCdWZmZXJGcmVlIChbSW50XSkgQChbSW50UHRyXSkpLAogICAgKGZ1bmMgYWR2YXBpMzIgQ29udmVydFNpZFRvU3RyaW5nU2lkIChbSW50XSkgQChbSW50UHRyXSwgW1N0cmluZ10uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyBhZHZhcGkzMiBPcGVuU0NNYW5hZ2VyVyAoW0ludFB0cl0pIEAoW1N0cmluZ10sIFtTdHJpbmddLCBbSW50XSkpLAogICAgKGZ1bmMgYWR2YXBpMzIgQ2xvc2VTZXJ2aWNlSGFuZGxlIChbSW50XSkgQChbSW50UHRyXSkpLAogICAgKGZ1bmMgd3RzYXBpMzIgV1RTT3BlblNlcnZlckV4IChbSW50UHRyXSkgQChbU3RyaW5nXSkpLAogICAgKGZ1bmMgd3RzYXBpMzIgV1RTRW51bWVyYXRlU2Vzc2lvbnNFeCAoW0ludF0pIEAoW0ludFB0cl0sIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50XSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkpLAogICAgKGZ1bmMgd3RzYXBpMzIgV1RTUXVlcnlTZXNzaW9uSW5mb3JtYXRpb24gKFtJbnRdKSBAKFtJbnRQdHJdLCBbSW50XSwgW0ludF0sIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCkpKSwKICAgIChmdW5jIHd0c2FwaTMyIFdUU0ZyZWVNZW1vcnlFeCAoW0ludF0pIEAoW0ludDMyXSwgW0ludFB0cl0sIFtJbnQzMl0pKSwKICAgIChmdW5jIHd0c2FwaTMyIFdUU0ZyZWVNZW1vcnkgKFtJbnRdKSBAKFtJbnRQdHJdKSksCiAgICAoZnVuYyB3dHNhcGkzMiBXVFNDbG9zZVNlcnZlciAoW0ludF0pIEAoW0ludFB0cl0pKSwKICAgIChmdW5jIGtlcm5lbDMyIEdldExhc3RFcnJvciAoW0ludF0pIEAoKSkKKQoKIyBlbnVtIHVzZWQgYnkgJFdUU19TRVNTSU9OX0lORk9fMSBiZWxvdwokV1RTQ29ubmVjdFN0YXRlID0gcHNlbnVtICRNb2QgV1RTX0NPTk5FQ1RTVEFURV9DTEFTUyBVSW50MTYgQHsKICAgIEFjdGl2ZSAgICAgICA9ICAgIDAKICAgIENvbm5lY3RlZCAgICA9ICAgIDEKICAgIENvbm5lY3RRdWVyeSA9ICAgIDIKICAgIFNoYWRvdyAgICAgICA9ICAgIDMKICAgIERpc2Nvbm5lY3RlZCA9ICAgIDQKICAgIElkbGUgICAgICAgICA9ICAgIDUKICAgIExpc3RlbiAgICAgICA9ICAgIDYKICAgIFJlc2V0ICAgICAgICA9ICAgIDcKICAgIERvd24gICAgICAgICA9ICAgIDgKICAgIEluaXQgICAgICAgICA9ICAgIDkKfQoKIyB0aGUgV1RTRW51bWVyYXRlU2Vzc2lvbnNFeCByZXN1bHQgc3RydWN0dXJlCiRXVFNfU0VTU0lPTl9JTkZPXzEgPSBzdHJ1Y3QgJE1vZCBXVFNfU0VTU0lPTl9JTkZPXzEgQHsKICAgIEV4ZWNFbnZJZCA9IGZpZWxkIDAgVUludDMyCiAgICBTdGF0ZSA9IGZpZWxkIDEgJFdUU0Nvbm5lY3RTdGF0ZQogICAgU2Vzc2lvbklkID0gZmllbGQgMiBVSW50MzIKICAgIHBTZXNzaW9uTmFtZSA9IGZpZWxkIDMgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHBIb3N0TmFtZSA9IGZpZWxkIDQgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHBVc2VyTmFtZSA9IGZpZWxkIDUgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHBEb21haW5OYW1lID0gZmllbGQgNiBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgcEZhcm1OYW1lID0gZmllbGQgNyBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQp9CgojIHRoZSBwYXJ0aWN1bGFyIFdUU1F1ZXJ5U2Vzc2lvbkluZm9ybWF0aW9uIHJlc3VsdCBzdHJ1Y3R1cmUKJFdUU19DTElFTlRfQUREUkVTUyA9IHN0cnVjdCAkbW9kIFdUU19DTElFTlRfQUREUkVTUyBAewogICAgQWRkcmVzc0ZhbWlseSA9IGZpZWxkIDAgVUludDMyCiAgICBBZGRyZXNzID0gZmllbGQgMSBCeXRlW10gLU1hcnNoYWxBcyBAKCdCeVZhbEFycmF5JywgMjApCn0KCiMgdGhlIE5ldFNoYXJlRW51bSByZXN1bHQgc3RydWN0dXJlCiRTSEFSRV9JTkZPXzEgPSBzdHJ1Y3QgJE1vZCBTSEFSRV9JTkZPXzEgQHsKICAgIHNoaTFfbmV0bmFtZSA9IGZpZWxkIDAgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHNoaTFfdHlwZSA9IGZpZWxkIDEgVUludDMyCiAgICBzaGkxX3JlbWFyayA9IGZpZWxkIDIgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKfQoKIyB0aGUgTmV0V2tzdGFVc2VyRW51bSByZXN1bHQgc3RydWN0dXJlCiRXS1NUQV9VU0VSX0lORk9fMSA9IHN0cnVjdCAkTW9kIFdLU1RBX1VTRVJfSU5GT18xIEB7CiAgICB3a3VpMV91c2VybmFtZSA9IGZpZWxkIDAgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHdrdWkxX2xvZ29uX2RvbWFpbiA9IGZpZWxkIDEgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHdrdWkxX290aF9kb21haW5zID0gZmllbGQgMiBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgd2t1aTFfbG9nb25fc2VydmVyID0gZmllbGQgMyBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQp9CgojIHRoZSBOZXRTZXNzaW9uRW51bSByZXN1bHQgc3RydWN0dXJlCiRTRVNTSU9OX0lORk9fMTAgPSBzdHJ1Y3QgJE1vZCBTRVNTSU9OX0lORk9fMTAgQHsKICAgIHNlc2kxMF9jbmFtZSA9IGZpZWxkIDAgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHNlc2kxMF91c2VybmFtZSA9IGZpZWxkIDEgU3RyaW5nIC1NYXJzaGFsQXMgQCgnTFBXU3RyJykKICAgIHNlc2kxMF90aW1lID0gZmllbGQgMiBVSW50MzIKICAgIHNlc2kxMF9pZGxlX3RpbWUgPSBmaWVsZCAzIFVJbnQzMgp9CgojIGVudW0gdXNlZCBieSAkTE9DQUxHUk9VUF9NRU1CRVJTX0lORk9fMiBiZWxvdwokU0lEX05BTUVfVVNFID0gcHNlbnVtICRNb2QgU0lEX05BTUVfVVNFIFVJbnQxNiBAewogICAgU2lkVHlwZVVzZXIgICAgICAgICAgICAgPSAxCiAgICBTaWRUeXBlR3JvdXAgICAgICAgICAgICA9IDIKICAgIFNpZFR5cGVEb21haW4gICAgICAgICAgID0gMwogICAgU2lkVHlwZUFsaWFzICAgICAgICAgICAgPSA0CiAgICBTaWRUeXBlV2VsbEtub3duR3JvdXAgICA9IDUKICAgIFNpZFR5cGVEZWxldGVkQWNjb3VudCAgID0gNgogICAgU2lkVHlwZUludmFsaWQgICAgICAgICAgPSA3CiAgICBTaWRUeXBlVW5rbm93biAgICAgICAgICA9IDgKICAgIFNpZFR5cGVDb21wdXRlciAgICAgICAgID0gOQp9CgojIHRoZSBOZXRMb2NhbEdyb3VwR2V0TWVtYmVycyByZXN1bHQgc3RydWN0dXJlCiRMT0NBTEdST1VQX01FTUJFUlNfSU5GT18yID0gc3RydWN0ICRNb2QgTE9DQUxHUk9VUF9NRU1CRVJTX0lORk9fMiBAewogICAgbGdybWkyX3NpZCA9IGZpZWxkIDAgSW50UHRyCiAgICBsZ3JtaTJfc2lkdXNhZ2UgPSBmaWVsZCAxICRTSURfTkFNRV9VU0UKICAgIGxncm1pMl9kb21haW5hbmRuYW1lID0gZmllbGQgMiBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQp9CgoKJFR5cGVzID0gJEZ1bmN0aW9uRGVmaW5pdGlvbnMgfCBBZGQtV2luMzJUeXBlIC1Nb2R1bGUgJE1vZCAtTmFtZXNwYWNlICdXaW4zMicKJE5ldGFwaTMyID0gJFR5cGVzWyduZXRhcGkzMiddCiRBZHZhcGkzMiA9ICRUeXBlc1snYWR2YXBpMzInXQokS2VybmVsMzIgPSAkVHlwZXNbJ2tlcm5lbDMyJ10KJFd0c2FwaTMyID0gJFR5cGVzWyd3dHNhcGkzMiddCg==
