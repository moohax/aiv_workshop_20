Invoke-WmiCommand.ps1,28e5f4f9eaad865788a038487667e181,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLVdtaUNvbW1hbmQgewo8IwouU1lOT1BTSVMKCkV4ZWN1dGVzIGEgUG93ZXJTaGVsbCBTY3JpcHRCbG9jayBvbiBhIHRhcmdldCBjb21wdXRlciB1c2luZyBXTUkgYXMgYQpwdXJlIEMyIGNoYW5uZWwuCgpBdXRob3I6IE1hdHRoZXcgR3JhZWJlcgpMaWNlbnNlOiBCU0QgMy1DbGF1c2UKUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCk9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQoKLkRFU0NSSVBUSU9OCgpJbnZva2UtV21pQ29tbWFuZCBleGVjdXRlcyBhIFBvd2VyU2hlbGwgU2NyaXB0QmxvY2sgb24gYSB0YXJnZXQKY29tcHV0ZXIgdXNpbmcgV01JIGFzIGEgcHVyZSBDMiBjaGFubmVsLiBJdCBkb2VzIHRoaXMgYnkgdXNpbmcgdGhlClN0ZFJlZ1Byb3YgV01JIHJlZ2lzdHJ5IHByb3ZpZGVyIG1ldGhvZHMgdG8gc3RvcmUgYSBwYXlsb2FkIGludG8gYQpyZWdpc3RyeSB2YWx1ZS4gVGhlIGNvbW1hbmQgaXMgdGhlbiBleGVjdXRlZCBvbiB0aGUgdmljdGltIHN5c3RlbSBhbmQKdGhlIG91dHB1dCBpcyBzdG9yZWQgaW4gYW5vdGhlciByZWdpc3RyeSB2YWx1ZSB0aGF0IGlzIHRoZW4gcmV0cmlldmVkCnJlbW90ZWx5LgoKLlBBUkFNRVRFUiBQYXlsb2FkCgpTcGVjaWZpZXMgdGhlIHBheWxvYWQgdG8gYmUgZXhlY3V0ZWQgb24gdGhlIHJlbW90ZSBzeXN0ZW0uCgouUEFSQU1FVEVSIFJlZ2lzdHJ5S2V5UGF0aAoKU3BlY2lmaWVzIHRoZSByZWdpc3RyeSBrZXkgd2hlcmUgdGhlIHBheWxvYWQgYW5kIHBheWxvYWQgb3V0cHV0IHdpbGwKYmUgc3RvcmVkLgoKLlBBUkFNRVRFUiBSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUKClNwZWNpZmllcyB0aGUgcmVnaXN0cnkgdmFsdWUgbmFtZSB3aGVyZSB0aGUgcGF5bG9hZCB3aWxsIGJlIHN0b3JlZC4KCi5QQVJBTUVURVIgUmVnaXN0cnlSZXN1bHRWYWx1ZU5hbWUKClNwZWNpZmllcyB0aGUgcmVnaXN0cnkgdmFsdWUgbmFtZSB3aGVyZSB0aGUgcGF5bG9hZCBvdXRwdXQgd2lsbCBiZQpzdG9yZWQuCgouUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKUnVucyB0aGUgY29tbWFuZCBvbiB0aGUgc3BlY2lmaWVkIGNvbXB1dGVycy4gVGhlIGRlZmF1bHQgaXMgdGhlIGxvY2FsCmNvbXB1dGVyLgoKVHlwZSB0aGUgTmV0QklPUyBuYW1lLCBhbiBJUCBhZGRyZXNzLCBvciBhIGZ1bGx5IHF1YWxpZmllZCBkb21haW4KbmFtZSBvZiBvbmUgb3IgbW9yZSBjb21wdXRlcnMuIFRvIHNwZWNpZnkgdGhlIGxvY2FsIGNvbXB1dGVyLCB0eXBlCnRoZSBjb21wdXRlciBuYW1lLCBhIGRvdCAoLiksIG9yICJsb2NhbGhvc3QiLgoKVGhpcyBwYXJhbWV0ZXIgZG9lcyBub3QgcmVseSBvbiBXaW5kb3dzIFBvd2VyU2hlbGwgcmVtb3RpbmcuIFlvdSBjYW4KdXNlIHRoZSBDb21wdXRlck5hbWUgcGFyYW1ldGVyIGV2ZW4gaWYgeW91ciBjb21wdXRlciBpcyBub3QKY29uZmlndXJlZCB0byBydW4gcmVtb3RlIGNvbW1hbmRzLgoKLlBBUkFNRVRFUiBDcmVkZW50aWFsCgpTcGVjaWZpZXMgYSB1c2VyIGFjY291bnQgdGhhdCBoYXMgcGVybWlzc2lvbiB0byBwZXJmb3JtIHRoaXMgYWN0aW9uLgpUaGUgZGVmYXVsdCBpcyB0aGUgY3VycmVudCB1c2VyLiBUeXBlIGEgdXNlciBuYW1lLCBzdWNoIGFzICJVc2VyMDEiLAoiRG9tYWluMDFcVXNlcjAxIiwgb3IgVXNlckBDb250b3NvLmNvbS4gT3IsIGVudGVyIGEgUFNDcmVkZW50aWFsCm9iamVjdCwgc3VjaCBhcyBhbiBvYmplY3QgdGhhdCBpcyByZXR1cm5lZCBieSB0aGUgR2V0LUNyZWRlbnRpYWwKY21kbGV0LiBXaGVuIHlvdSB0eXBlIGEgdXNlciBuYW1lLCB5b3Ugd2lsbCBiZSBwcm9tcHRlZCBmb3IgYQpwYXNzd29yZC4KCi5QQVJBTUVURVIgSW1wZXJzb25hdGlvbgoKU3BlY2lmaWVzIHRoZSBpbXBlcnNvbmF0aW9uIGxldmVsIHRvIHVzZS4gVmFsaWQgdmFsdWVzIGFyZToKCjA6IERlZmF1bHQgKFJlYWRzIHRoZSBsb2NhbCByZWdpc3RyeSBmb3IgdGhlIGRlZmF1bHQgaW1wZXJzb25hdGlvbiBsZXZlbCwgd2hpY2ggaXMgdXN1YWxseSBzZXQgdG8gIjM6IEltcGVyc29uYXRlIi4pCgoxOiBBbm9ueW1vdXMgKEhpZGVzIHRoZSBjcmVkZW50aWFscyBvZiB0aGUgY2FsbGVyLikKCjI6IElkZW50aWZ5IChBbGxvd3Mgb2JqZWN0cyB0byBxdWVyeSB0aGUgY3JlZGVudGlhbHMgb2YgdGhlIGNhbGxlci4pCgozOiBJbXBlcnNvbmF0ZSAoQWxsb3dzIG9iamVjdHMgdG8gdXNlIHRoZSBjcmVkZW50aWFscyBvZiB0aGUgY2FsbGVyLikKCjQ6IERlbGVnYXRlIChBbGxvd3Mgb2JqZWN0cyB0byBwZXJtaXQgb3RoZXIgb2JqZWN0cyB0byB1c2UgdGhlIGNyZWRlbnRpYWxzIG9mIHRoZSBjYWxsZXIuKQoKLlBBUkFNRVRFUiBBdXRoZW50aWNhdGlvbgoKU3BlY2lmaWVzIHRoZSBhdXRoZW50aWNhdGlvbiBsZXZlbCB0byBiZSB1c2VkIHdpdGggdGhlIFdNSSBjb25uZWN0aW9uLiBWYWxpZCB2YWx1ZXMgYXJlOgoKLTE6IFVuY2hhbmdlZAoKMDogRGVmYXVsdAoKMTogTm9uZSAoTm8gYXV0aGVudGljYXRpb24gaW4gcGVyZm9ybWVkLikKCjI6IENvbm5lY3QgKEF1dGhlbnRpY2F0aW9uIGlzIHBlcmZvcm1lZCBvbmx5IHdoZW4gdGhlIGNsaWVudCBlc3RhYmxpc2hlcyBhIHJlbGF0aW9uc2hpcCB3aXRoIHRoZSBhcHBsaWNhdGlvbi4pCgozOiBDYWxsIChBdXRoZW50aWNhdGlvbiBpcyBwZXJmb3JtZWQgb25seSBhdCB0aGUgYmVnaW5uaW5nIG9mIGVhY2ggY2FsbCB3aGVuIHRoZSBhcHBsaWNhdGlvbiByZWNlaXZlcyB0aGUgcmVxdWVzdC4pCgo0OiBQYWNrZXQgKEF1dGhlbnRpY2F0aW9uIGlzIHBlcmZvcm1lZCBvbiBhbGwgdGhlIGRhdGEgdGhhdCBpcyByZWNlaXZlZCBmcm9tIHRoZSBjbGllbnQuKQoKNTogUGFja2V0SW50ZWdyaXR5IChBbGwgdGhlIGRhdGEgdGhhdCBpcyB0cmFuc2ZlcnJlZCBiZXR3ZWVuIHRoZSBjbGllbnQgIGFuZCB0aGUgYXBwbGljYXRpb24gaXMgYXV0aGVudGljYXRlZCBhbmQgdmVyaWZpZWQuKQoKNjogUGFja2V0UHJpdmFjeSAoVGhlIHByb3BlcnRpZXMgb2YgdGhlIG90aGVyIGF1dGhlbnRpY2F0aW9uIGxldmVscyBhcmUgdXNlZCwgYW5kIGFsbCB0aGUgZGF0YSBpcyBlbmNyeXB0ZWQuKQoKLlBBUkFNRVRFUiBFbmFibGVBbGxQcml2aWxlZ2VzCgpFbmFibGVzIGFsbCB0aGUgcHJpdmlsZWdlcyBvZiB0aGUgY3VycmVudCB1c2VyIGJlZm9yZSB0aGUgY29tbWFuZAptYWtlcyB0aGUgV01JIGNhbGwuCgouUEFSQU1FVEVSIEF1dGhvcml0eQoKU3BlY2lmaWVzIHRoZSBhdXRob3JpdHkgdG8gdXNlIHRvIGF1dGhlbnRpY2F0ZSB0aGUgV01JIGNvbm5lY3Rpb24uCllvdSBjYW4gc3BlY2lmeSBzdGFuZGFyZCBOVExNIG9yIEtlcmJlcm9zIGF1dGhlbnRpY2F0aW9uLiBUbyB1c2UKTlRMTSwgc2V0IHRoZSBhdXRob3JpdHkgc2V0dGluZyB0byBudGxtZG9tYWluOjxEb21haW5OYW1lPiwgd2hlcmUKPERvbWFpbk5hbWU+IGlkZW50aWZpZXMgYSB2YWxpZCBOVExNIGRvbWFpbiBuYW1lLiBUbyB1c2UgS2VyYmVyb3MsCnNwZWNpZnkga2VyYmVyb3M6PERvbWFpbk5hbWVcU2VydmVyTmFtZT4uIFlvdSBjYW5ub3QgaW5jbHVkZSB0aGUKYXV0aG9yaXR5IHNldHRpbmcgd2hlbiB5b3UgY29ubmVjdCB0byB0aGUgbG9jYWwgY29tcHV0ZXIuCgouRVhBTVBMRQoKUFMgQzpcPkludm9rZS1XbWlDb21tYW5kIC1QYXlsb2FkIHsgaWYgKCRUcnVlKSB7ICdEbyBFdmlsJyB9IH0gLUNyZWRlbnRpYWwgJ1RhcmdldERvbWFpblxUYXJnZXRVc2VyJyAtQ29tcHV0ZXJOYW1lICcxMC4xMC4xLjEnCgouRVhBTVBMRQoKUFMgQzpcPiRIb3N0cyA9IEdldC1Db250ZW50IGhvc3RuYW1lcy50eHQKUFMgQzpcPiRQYXlsb2FkID0gR2V0LUNvbnRlbnQgcGF5bG9hZC5wczEKUFMgQzpcPiRDcmVkZW50aWFsID0gR2V0LUNyZWRlbnRpYWwgJ1RhcmdldERvbWFpblxUYXJnZXRVc2VyJwpQUyBDOlw+JEhvc3RzIHwgSW52b2tlLVdtaUNvbW1hbmQgLVBheWxvYWQgJFBheWxvYWQgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwKCi5FWEFNUExFCgpQUyBDOlw+JFBheWxvYWQgPSBHZXQtQ29udGVudCBwYXlsb2FkLnBzMQpQUyBDOlw+SW52b2tlLVdtaUNvbW1hbmQgLVBheWxvYWQgJFBheWxvYWQgLUNyZWRlbnRpYWwgJ1RhcmdldERvbWFpblxUYXJnZXRVc2VyJyAtQ29tcHV0ZXJOYW1lICcxMC4xMC4xLjEnLCAnMTAuMTAuMS4yJwoKLkVYQU1QTEUKClBTIEM6Lz5JbnZva2UtV21pQ29tbWFuZCAtUGF5bG9hZCB7IDErMysyKzErMSB9IC1SZWdpc3RyeUhpdmUgSEtFWV9MT0NBTF9NQUNISU5FIC1SZWdpc3RyeUtleVBhdGggJ1NPRlRXQVJFXHRlc3RrZXknIC1SZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUgJ3Rlc3R2YWx1ZScgLVJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lICd0ZXN0cmVzdWx0JyAtQ29tcHV0ZXJOYW1lICcxMC4xMC4xLjEnIC1DcmVkZW50aWFsICdUYXJnZXRIb3N0XEFkbWluaXN0cmF0b3InIC1WZXJib3NlCgouSU5QVVRTCgpTeXN0ZW0uU3RyaW5nW10KCkFjY2VwdHMgb25lIG9yIG1vcmUgaG9zdCBuYW1lcy9JUCBhZGRyZXNzZXMgb3ZlciB0aGUgcGlwZWxpbmUuCgouT1VUUFVUUwoKU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU09iamVjdAoKT3V0cHV0cyBhIGN1c3RvbSBvYmplY3QgY29uc2lzdGluZyBvZiB0aGUgdGFyZ2V0IGNvbXB1dGVyIG5hbWUgYW5kCnRoZSBvdXRwdXQgb2YgdGhlIGNvbW1hbmQgZXhlY3V0ZWQuCgouTk9URVMKCkluIG9yZGVyIHRvIHJlY2VpdmUgdGhlIG91dHB1dCBmcm9tIHlvdXIgcGF5bG9hZCwgaXQgbXVzdCByZXR1cm4KYWN0dWFsIG9iamVjdHMuIEZvciBleGFtcGxlLCBXcml0ZS1Ib3N0IGRvZXNuJ3QgcmV0dXJuIG9iamVjdHMKcmF0aGVyLCBpdCB3cml0ZXMgZGlyZWN0bHkgdG8gdGhlIGNvbnNvbGUuIElmIHlvdSdyZSB1c2luZwpXcml0ZS1Ib3N0IGluIHlvdXIgc2NyaXB0cyB0aG91Z2gsIHlvdSBwcm9iYWJseSBkb24ndCBkZXNlcnZlIHRvIGdldAp0aGUgb3V0cHV0IG9mIHlvdXIgcGF5bG9hZCBiYWNrLiA6UAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlciggTWFuZGF0b3J5ID0gJFRydWUgKV0KICAgICAgICBbU2NyaXB0QmxvY2tdCiAgICAgICAgJFBheWxvYWQsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCAnSEtFWV9MT0NBTF9NQUNISU5FJywKICAgICAgICAgICAgICAgICAgICAgICdIS0VZX0NVUlJFTlRfVVNFUicsCiAgICAgICAgICAgICAgICAgICAgICAnSEtFWV9DTEFTU0VTX1JPT1QnLAogICAgICAgICAgICAgICAgICAgICAgJ0hLRVlfVVNFUlMnLAogICAgICAgICAgICAgICAgICAgICAgJ0hLRVlfQ1VSUkVOVF9DT05GSUcnICldCiAgICAgICAgJFJlZ2lzdHJ5SGl2ZSA9ICdIS0VZX0NVUlJFTlRfVVNFUicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkUmVnaXN0cnlLZXlQYXRoID0gJ1NPRlRXQVJFXE1pY3Jvc29mdFxDcnlwdG9ncmFwaHlcUk5HJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUgPSAnU2VlZCcsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkUmVnaXN0cnlSZXN1bHRWYWx1ZU5hbWUgPSAnVmFsdWUnLAoKICAgICAgICBbUGFyYW1ldGVyKCBWYWx1ZUZyb21QaXBlbGluZSA9ICRUcnVlICldCiAgICAgICAgW0FsaWFzKCdDbicpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgW01hbmFnZW1lbnQuQXV0b21hdGlvbi5DcmVkZW50aWFsQXR0cmlidXRlKCldCiAgICAgICAgJENyZWRlbnRpYWwgPSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF06OkVtcHR5LAoKICAgICAgICBbTWFuYWdlbWVudC5JbXBlcnNvbmF0aW9uTGV2ZWxdCiAgICAgICAgJEltcGVyc29uYXRpb24sCgogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRoZW50aWNhdGlvbkxldmVsXQogICAgICAgICRBdXRoZW50aWNhdGlvbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRW5hYmxlQWxsUHJpdmlsZWdlcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQXV0aG9yaXR5CiAgICApCgogICAgQkVHSU4gewogICAgICAgIHN3aXRjaCAoJFJlZ2lzdHJ5SGl2ZSkgewogICAgICAgICAgICAnSEtFWV9MT0NBTF9NQUNISU5FJyB7ICRIaXZlID0gMjE0NzQ4MzY1MCB9CiAgICAgICAgICAgICdIS0VZX0NVUlJFTlRfVVNFUicgeyAkSGl2ZSA9IDIxNDc0ODM2NDkgfQogICAgICAgICAgICAnSEtFWV9DTEFTU0VTX1JPT1QnIHsgJEhpdmUgPSAyMTQ3NDgzNjQ4IH0KICAgICAgICAgICAgJ0hLRVlfVVNFUlMnIHsgJEhpdmUgPSAyMTQ3NDgzNjUxIH0KICAgICAgICAgICAgJ0hLRVlfQ1VSUkVOVF9DT05GSUcnIHsgJEhpdmUgPSAyMTQ3NDgzNjUzIH0KICAgICAgICB9CgogICAgICAgICRIS0VZX0xPQ0FMX01BQ0hJTkUgPSAyMTQ3NDgzNjUwCgogICAgICAgICRXbWlNZXRob2RBcmdzID0gQHt9CgogICAgICAgICMgSWYgYWRkaXRpb25hbCBXTUkgY21kbGV0IHByb3BlcnRpZXMgd2VyZSBwcm92aWRlZCwgcHJveHkgdGhlbSB0byBJbnZva2UtV21pTWV0aG9kCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQ3JlZGVudGlhbCddKSB7ICRXbWlNZXRob2RBcmdzWydDcmVkZW50aWFsJ10gPSAkQ3JlZGVudGlhbCB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snSW1wZXJzb25hdGlvbiddKSB7ICRXbWlNZXRob2RBcmdzWydJbXBlcnNvbmF0aW9uJ10gPSAkSW1wZXJzb25hdGlvbiB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQXV0aGVudGljYXRpb24nXSkgeyAkV21pTWV0aG9kQXJnc1snQXV0aGVudGljYXRpb24nXSA9ICRBdXRoZW50aWNhdGlvbiB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRW5hYmxlQWxsUHJpdmlsZWdlcyddKSB7ICRXbWlNZXRob2RBcmdzWydFbmFibGVBbGxQcml2aWxlZ2VzJ10gPSAkRW5hYmxlQWxsUHJpdmlsZWdlcyB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQXV0aG9yaXR5J10pIHsgJFdtaU1ldGhvZEFyZ3NbJ0F1dGhvcml0eSddID0gJEF1dGhvcml0eSB9CgogICAgICAgICRBY2Nlc3NQZXJtaXNzaW9ucyA9IEB7CiAgICAgICAgICAgIEtFWV9RVUVSWV9WQUxVRSA9IDEKICAgICAgICAgICAgS0VZX1NFVF9WQUxVRSA9IDIKICAgICAgICAgICAgS0VZX0NSRUFURV9TVUJfS0VZID0gNAogICAgICAgICAgICBLRVlfQ1JFQVRFID0gMzIKICAgICAgICAgICAgREVMRVRFID0gNjU1MzYKICAgICAgICB9CgogICAgICAgICMgVGhlc2UgYXJlIGFsbCBvZiB0aGUgcmVnaXN0cnkgcGVybWlzc2lvbnMgd2UnbGwgcmVxdWlyZQogICAgICAgICRSZXF1aXJlZFBlcm1pc3Npb25zID0gJEFjY2Vzc1Blcm1pc3Npb25zWydLRVlfUVVFUllfVkFMVUUnXSAtYm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNjZXNzUGVybWlzc2lvbnNbJ0tFWV9TRVRfVkFMVUUnXSAtYm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNjZXNzUGVybWlzc2lvbnNbJ0tFWV9DUkVBVEVfU1VCX0tFWSddIC1ib3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3NQZXJtaXNzaW9uc1snS0VZX0NSRUFURSddIC1ib3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3NQZXJtaXNzaW9uc1snREVMRVRFJ10KICAgIH0KCiAgICBQUk9DRVNTIHsKICAgICAgICBmb3JlYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewogICAgICAgICAgICAjIFBhc3MgdGhlIGluZGl2aWR1YWwgY29tcHV0ZXIgbmFtZSB0byBJbnZva2UtV21pTWV0aG9kCiAgICAgICAgICAgICRXbWlNZXRob2RBcmdzWydDb21wdXRlck5hbWUnXSA9ICRDb21wdXRlcgoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gQ3JlYXRpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSBrZXk6ICRSZWdpc3RyeUhpdmVcJFJlZ2lzdHJ5S2V5UGF0aCIKICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWVzcGFjZSAnUm9vdFxkZWZhdWx0JyAtQ2xhc3MgJ1N0ZFJlZ1Byb3YnIC1OYW1lICdDcmVhdGVLZXknIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgKCiAgICAgICAgICAgIGlmICgkUmVzdWx0LlJldHVyblZhbHVlIC1uZSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyRDb21wdXRlcl0gVW5hYmxlIHRvIGNyZWF0ZSB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IGtleTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoIgogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbJENvbXB1dGVyXSBWYWxpZGF0aW5nIHJlYWQvd3JpdGUvZGVsZXRlIHByaXZpbGVnZXMgZm9yIHRoZSBmb2xsb3dpbmcgcmVnaXN0cnkga2V5OiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGgiCiAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnQ2hlY2tBY2Nlc3MnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZXF1aXJlZFBlcm1pc3Npb25zCgogICAgICAgICAgICBpZiAoLW5vdCAkUmVzdWx0LmJHcmFudGVkKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyRDb21wdXRlcl0gWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gcGVyZm9ybSBhbGwgdGhlIHJlZ2lzdHJ5IG9wZXJhdGlvbnMgbmVjZXNzYXJ5IGZvciBJbnZva2UtV21pQ29tbWFuZC4iCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRQU1NldHRpbmdzUGF0aCA9ICdTT0ZUV0FSRVxNaWNyb3NvZnRcUG93ZXJTaGVsbFwxXFNoZWxsSWRzXE1pY3Jvc29mdC5Qb3dlclNoZWxsJwogICAgICAgICAgICAkUFNQYXRoVmFsdWVOYW1lID0gJ1BhdGgnCgogICAgICAgICAgICAkUmVzdWx0ID0gSW52b2tlLVdtaU1ldGhvZCBAV21pTWV0aG9kQXJncyAtTmFtZXNwYWNlICdSb290XGRlZmF1bHQnIC1DbGFzcyAnU3RkUmVnUHJvdicgLU5hbWUgJ0dldFN0cmluZ1ZhbHVlJyAtQXJndW1lbnRMaXN0ICRIS0VZX0xPQ0FMX01BQ0hJTkUsICRQU1NldHRpbmdzUGF0aCwgJFBTUGF0aFZhbHVlTmFtZQoKICAgICAgICAgICAgaWYgKCRSZXN1bHQuUmV0dXJuVmFsdWUgLW5lIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJbJENvbXB1dGVyXSBVbmFibGUgdG8gb2J0YWluIHBvd2Vyc2hlbGwuZXhlIHBhdGggZnJvbSB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IHZhbHVlOiBIS0VZX0xPQ0FMX01BQ0hJTkVcJFBTU2V0dGluZ3NQYXRoXCRQU1BhdGhWYWx1ZU5hbWUiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRQb3dlclNoZWxsUGF0aCA9ICRSZXN1bHQuc1ZhbHVlCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlskQ29tcHV0ZXJdIEZ1bGwgUG93ZXJTaGVsbCBwYXRoOiAkUG93ZXJTaGVsbFBhdGgiCgogICAgICAgICAgICAkRW5jb2RlZFBheWxvYWQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkUGF5bG9hZCkpCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbJENvbXB1dGVyXSBTdG9yaW5nIHRoZSBwYXlsb2FkIGludG8gdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUiCiAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnU2V0U3RyaW5nVmFsdWUnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRFbmNvZGVkUGF5bG9hZCwgJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZQoKICAgICAgICAgICAgaWYgKCRSZXN1bHQuUmV0dXJuVmFsdWUgLW5lIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJbJENvbXB1dGVyXSBVbmFibGUgdG8gc3RvcmUgdGhlIHBheWxvYWQgaW4gdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgUHJlcCB0aGUgc2NyaXB0IHJ1bm5lciBwYXlsb2FkIGZyb20gdGhlIHJlbW90ZSBzeXN0ZW0KICAgICAgICAgICAgJFBheWxvYWRSdW5uZXJBcmdzID0gQCIKICAgICAgICAgICAgICAgIGAkSGl2ZSA9ICckSGl2ZScKICAgICAgICAgICAgICAgIGAkUmVnaXN0cnlLZXlQYXRoID0gJyRSZWdpc3RyeUtleVBhdGgnCiAgICAgICAgICAgICAgICBgJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZSA9ICckUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lJwogICAgICAgICAgICAgICAgYCRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSA9ICckUmVnaXN0cnlSZXN1bHRWYWx1ZU5hbWUnCiAgICAgICAgICAgICAgICBgbgoiQAoKICAgICAgICAgICAgJFJlbW90ZVBheWxvYWRSdW5uZXIgPSAkUGF5bG9hZFJ1bm5lckFyZ3MgKyB7CiAgICAgICAgICAgICAgICAkV21pTWV0aG9kQXJncyA9IEB7CiAgICAgICAgICAgICAgICAgICAgTmFtZXNwYWNlID0gJ1Jvb3RcZGVmYXVsdCcKICAgICAgICAgICAgICAgICAgICBDbGFzcyA9ICdTdGRSZWdQcm92JwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lICdHZXRTdHJpbmdWYWx1ZScgLUFyZ3VtZW50TGlzdCAkSGl2ZSwgJFJlZ2lzdHJ5S2V5UGF0aCwgJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZQoKICAgICAgICAgICAgICAgIGlmICgoJFJlc3VsdC5SZXR1cm5WYWx1ZSAtZXEgMCkgLWFuZCAoJFJlc3VsdC5zVmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgJFBheWxvYWQgPSBbVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygkUmVzdWx0LnNWYWx1ZSkpCgogICAgICAgICAgICAgICAgICAgICRUZW1wU2VyaWFsaXplZFJlc3VsdFBhdGggPSBbSU8uUGF0aF06OkdldFRlbXBGaWxlTmFtZSgpCgogICAgICAgICAgICAgICAgICAgICRQYXlsb2FkUmVzdWx0ID0gSW52b2tlLUV4cHJlc3Npb24gKCRQYXlsb2FkKQoKICAgICAgICAgICAgICAgICAgICBFeHBvcnQtQ2xpeG1sIC1JbnB1dE9iamVjdCAkUGF5bG9hZFJlc3VsdCAtUGF0aCAkVGVtcFNlcmlhbGl6ZWRSZXN1bHRQYXRoCgogICAgICAgICAgICAgICAgICAgICRTZXJpbGl6ZWRQYXlsb2FkVGV4dCA9IFtJTy5GaWxlXTo6UmVhZEFsbFRleHQoJFRlbXBTZXJpYWxpemVkUmVzdWx0UGF0aCkKCiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lICdTZXRTdHJpbmdWYWx1ZScgLUFyZ3VtZW50TGlzdCAkSGl2ZSwgJFJlZ2lzdHJ5S2V5UGF0aCwgJFNlcmlsaXplZFBheWxvYWRUZXh0LCAkUmVnaXN0cnlSZXN1bHRWYWx1ZU5hbWUKCiAgICAgICAgICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gLVBhdGggJFNlcmlsaXplZFBheWxvYWRSZXN1bHQgLUZvcmNlCgogICAgICAgICAgICAgICAgICAgICRudWxsID0gSW52b2tlLVdtaU1ldGhvZCBAV21pTWV0aG9kQXJncyAtTmFtZSAnRGVsZXRlVmFsdWUnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJEJhc2U2NFBheWxvYWQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkUmVtb3RlUGF5bG9hZFJ1bm5lcikpCgogICAgICAgICAgICAkQ21kbGluZSA9ICIkUG93ZXJTaGVsbFBhdGggLVdpbmRvd1N0eWxlIEhpZGRlbiAtTm9Qcm9maWxlIC1FbmNvZGVkQ29tbWFuZCAkQmFzZTY0UGF5bG9hZCIKCiAgICAgICAgICAgICMgRXhlY3V0ZSB0aGUgcGF5bG9hZCBydW5uZXIgb24gdGhlIHJlbW90ZSBzeXN0ZW0KICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWVzcGFjZSAnUm9vdFxjaW12MicgLUNsYXNzICdXaW4zMl9Qcm9jZXNzJyAtTmFtZSAnQ3JlYXRlJyAtQXJndW1lbnRMaXN0ICRDbWRsaW5lCgogICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA1CgogICAgICAgICAgICBpZiAoJFJlc3VsdC5SZXR1cm5WYWx1ZSAtbmUgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIlskQ29tcHV0ZXJdIFVuYWJsZSB0byBleGVjdXRlIHBheWxvYWQgc3RvcmVkIHdpdGhpbiB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IHZhbHVlOiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGhcJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUGF5bG9hZCBzdWNjZXNzZnVsbHkgZXhlY3V0ZWQgZnJvbTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUiCgogICAgICAgICAgICAkUmVzdWx0ID0gSW52b2tlLVdtaU1ldGhvZCBAV21pTWV0aG9kQXJncyAtTmFtZXNwYWNlICdSb290XGRlZmF1bHQnIC1DbGFzcyAnU3RkUmVnUHJvdicgLU5hbWUgJ0dldFN0cmluZ1ZhbHVlJyAtQXJndW1lbnRMaXN0ICRIaXZlLCAkUmVnaXN0cnlLZXlQYXRoLCAkUmVnaXN0cnlSZXN1bHRWYWx1ZU5hbWUKCiAgICAgICAgICAgIGlmICgkUmVzdWx0LlJldHVyblZhbHVlIC1uZSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyRDb21wdXRlcl0gVW5hYmxlIHJldHJpZXZlIHRoZSBwYXlsb2FkIHJlc3VsdHMgZnJvbSB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IHZhbHVlOiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGhcJFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lIgogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbJENvbXB1dGVyXSBQYXlsb2FkIHJlc3VsdHMgc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBmcm9tOiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGhcJFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lIgoKICAgICAgICAgICAgJFNlcmlsaXplZFBheWxvYWRSZXN1bHQgPSAkUmVzdWx0LnNWYWx1ZQoKICAgICAgICAgICAgJFRlbXBTZXJpYWxpemVkUmVzdWx0UGF0aCA9IFtJTy5QYXRoXTo6R2V0VGVtcEZpbGVOYW1lKCkKCiAgICAgICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAkU2VyaWxpemVkUGF5bG9hZFJlc3VsdCAtRmlsZVBhdGggJFRlbXBTZXJpYWxpemVkUmVzdWx0UGF0aAogICAgICAgICAgICAkUGF5bG9hZFJlc3VsdCA9IEltcG9ydC1DbGl4bWwgLVBhdGggJFRlbXBTZXJpYWxpemVkUmVzdWx0UGF0aAoKICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gLVBhdGggJFRlbXBTZXJpYWxpemVkUmVzdWx0UGF0aAoKICAgICAgICAgICAgJEZpbmFsUmVzdWx0ID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsKICAgICAgICAgICAgICAgIFBTQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyCiAgICAgICAgICAgICAgICBQYXlsb2FkT3V0cHV0ID0gJFBheWxvYWRSZXN1bHQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUmVtb3ZpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSIKICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnRGVsZXRlVmFsdWUnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUmVtb3ZpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSBrZXk6ICRSZWdpc3RyeUhpdmVcJFJlZ2lzdHJ5S2V5UGF0aCIKICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnRGVsZXRlS2V5JyAtQXJndW1lbnRMaXN0ICRIaXZlLCAkUmVnaXN0cnlLZXlQYXRoCgogICAgICAgICAgICByZXR1cm4gJEZpbmFsUmVzdWx0CiAgICAgICAgfQogICAgfQp9Cg==
