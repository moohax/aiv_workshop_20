powerview.ps1,d10a027202e13026401eacf5e24cabd2,Scan result is 32768. IsMalware: 1,I3JlcXVpcmVzIC12ZXJzaW9uIDIKCjwjCgogICAgUG93ZXJTcGxvaXQgRmlsZTogUG93ZXJWaWV3LnBzMQogICAgQXV0aG9yOiBXaWxsIFNjaHJvZWRlciAoQGhhcm1qMHkpCiAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgIFJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQogICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgojPgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIFBTUmVmbGVjdCBjb2RlIGZvciBXaW5kb3dzIEFQSSBhY2Nlc3MKIyBBdXRob3I6IEBtYXR0aWZlc3RhdGlvbgojICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL21hdHRpZmVzdGF0aW9uL1BTUmVmbGVjdC9tYXN0ZXIvUFNSZWZsZWN0LnBzbTEKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gTmV3LUluTWVtb3J5TW9kdWxlCnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGFuIGluLW1lbW9yeSBhc3NlbWJseSBhbmQgbW9kdWxlCgogICAgICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICAgICAgUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCiAgICAgICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFdoZW4gZGVmaW5pbmcgY3VzdG9tIGVudW1zLCBzdHJ1Y3RzLCBhbmQgdW5tYW5hZ2VkIGZ1bmN0aW9ucywgaXQgaXMKICAgICAgICBuZWNlc3NhcnkgdG8gYXNzb2NpYXRlIHRvIGFuIGFzc2VtYmx5IG1vZHVsZS4gVGhpcyBoZWxwZXIgZnVuY3Rpb24KICAgICAgICBjcmVhdGVzIGFuIGluLW1lbW9yeSBtb2R1bGUgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHRoZSAnZW51bScsCiAgICAgICAgJ3N0cnVjdCcsIGFuZCBBZGQtV2luMzJUeXBlIGZ1bmN0aW9ucy4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZU5hbWUKCiAgICAgICAgU3BlY2lmaWVzIHRoZSBkZXNpcmVkIG5hbWUgZm9yIHRoZSBpbi1tZW1vcnkgYXNzZW1ibHkgYW5kIG1vZHVsZS4gSWYKICAgICAgICBNb2R1bGVOYW1lIGlzIG5vdCBwcm92aWRlZCwgaXQgd2lsbCBkZWZhdWx0IHRvIGEgR1VJRC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kdWxlID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCiM+CgogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRNb2R1bGVOYW1lID0gW0d1aWRdOjpOZXdHdWlkKCkuVG9TdHJpbmcoKQogICAgKQoKICAgICRMb2FkZWRBc3NlbWJsaWVzID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpCgogICAgRm9yRWFjaCAoJEFzc2VtYmx5IGluICRMb2FkZWRBc3NlbWJsaWVzKSB7CiAgICAgICAgaWYgKCRBc3NlbWJseS5GdWxsTmFtZSAtYW5kICgkQXNzZW1ibHkuRnVsbE5hbWUuU3BsaXQoJywnKVswXSAtZXEgJE1vZHVsZU5hbWUpKSB7CiAgICAgICAgICAgIHJldHVybiAkQXNzZW1ibHkKICAgICAgICB9CiAgICB9CgogICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgkTW9kdWxlTmFtZSkKICAgICREb21haW4gPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbgogICAgJEFzc2VtYmx5QnVpbGRlciA9ICREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgJ1J1bicpCiAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgkTW9kdWxlTmFtZSwgJEZhbHNlKQoKICAgIHJldHVybiAkTW9kdWxlQnVpbGRlcgp9CgoKIyBBIGhlbHBlciBmdW5jdGlvbiB1c2VkIHRvIHJlZHVjZSB0eXBpbmcgd2hpbGUgZGVmaW5pbmcgZnVuY3Rpb24KIyBwcm90b3R5cGVzIGZvciBBZGQtV2luMzJUeXBlLgpmdW5jdGlvbiBmdW5jCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbGxOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZ1bmN0aW9uTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkUmV0dXJuVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMpXQogICAgICAgIFtUeXBlW11dCiAgICAgICAgJFBhcmFtZXRlclR5cGVzLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCldCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXQogICAgICAgICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDUpXQogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XQogICAgICAgICRDaGFyc2V0LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZXRMYXN0RXJyb3IKICAgICkKCiAgICAkUHJvcGVydGllcyA9IEB7CiAgICAgICAgRGxsTmFtZSA9ICREbGxOYW1lCiAgICAgICAgRnVuY3Rpb25OYW1lID0gJEZ1bmN0aW9uTmFtZQogICAgICAgIFJldHVyblR5cGUgPSAkUmV0dXJuVHlwZQogICAgfQoKICAgIGlmICgkUGFyYW1ldGVyVHlwZXMpIHsgJFByb3BlcnRpZXNbJ1BhcmFtZXRlclR5cGVzJ10gPSAkUGFyYW1ldGVyVHlwZXMgfQogICAgaWYgKCROYXRpdmVDYWxsaW5nQ29udmVudGlvbikgeyAkUHJvcGVydGllc1snTmF0aXZlQ2FsbGluZ0NvbnZlbnRpb24nXSA9ICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiB9CiAgICBpZiAoJENoYXJzZXQpIHsgJFByb3BlcnRpZXNbJ0NoYXJzZXQnXSA9ICRDaGFyc2V0IH0KICAgIGlmICgkU2V0TGFzdEVycm9yKSB7ICRQcm9wZXJ0aWVzWydTZXRMYXN0RXJyb3InXSA9ICRTZXRMYXN0RXJyb3IgfQoKICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5ICRQcm9wZXJ0aWVzCn0KCgpmdW5jdGlvbiBBZGQtV2luMzJUeXBlCnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGEgLk5FVCB0eXBlIGZvciBhbiB1bm1hbmFnZWQgV2luMzIgZnVuY3Rpb24uCgogICAgICAgIEF1dGhvcjogTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICAgICAgUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBOb25lCiAgICAgICAgT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBmdW5jCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIEFkZC1XaW4zMlR5cGUgZW5hYmxlcyB5b3UgdG8gZWFzaWx5IGludGVyYWN0IHdpdGggdW5tYW5hZ2VkIChpLmUuCiAgICAgICAgV2luMzIgdW5tYW5hZ2VkKSBmdW5jdGlvbnMgaW4gUG93ZXJTaGVsbC4gQWZ0ZXIgcHJvdmlkaW5nCiAgICAgICAgQWRkLVdpbjMyVHlwZSB3aXRoIGEgZnVuY3Rpb24gc2lnbmF0dXJlLCBhIC5ORVQgdHlwZSBpcyBjcmVhdGVkCiAgICAgICAgdXNpbmcgcmVmbGVjdGlvbiAoaS5lLiBjc2MuZXhlIGlzIG5ldmVyIGNhbGxlZCBsaWtlIHdpdGggQWRkLVR5cGUpLgoKICAgICAgICBUaGUgJ2Z1bmMnIGhlbHBlciBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byByZWR1Y2UgdHlwaW5nIHdoZW4gZGVmaW5pbmcKICAgICAgICBtdWx0aXBsZSBmdW5jdGlvbiBkZWZpbml0aW9ucy4KCiAgICAuUEFSQU1FVEVSIERsbE5hbWUKCiAgICAgICAgVGhlIG5hbWUgb2YgdGhlIERMTC4KCiAgICAuUEFSQU1FVEVSIEZ1bmN0aW9uTmFtZQoKICAgICAgICBUaGUgbmFtZSBvZiB0aGUgdGFyZ2V0IGZ1bmN0aW9uLgoKICAgIC5QQVJBTUVURVIgUmV0dXJuVHlwZQoKICAgICAgICBUaGUgcmV0dXJuIHR5cGUgb2YgdGhlIGZ1bmN0aW9uLgoKICAgIC5QQVJBTUVURVIgUGFyYW1ldGVyVHlwZXMKCiAgICAgICAgVGhlIGZ1bmN0aW9uIHBhcmFtZXRlcnMuCgogICAgLlBBUkFNRVRFUiBOYXRpdmVDYWxsaW5nQ29udmVudGlvbgoKICAgICAgICBTcGVjaWZpZXMgdGhlIG5hdGl2ZSBjYWxsaW5nIGNvbnZlbnRpb24gb2YgdGhlIGZ1bmN0aW9uLiBEZWZhdWx0cyB0bwogICAgICAgIHN0ZGNhbGwuCgogICAgLlBBUkFNRVRFUiBDaGFyc2V0CgogICAgICAgIElmIHlvdSBuZWVkIHRvIGV4cGxpY2l0bHkgY2FsbCBhbiAnQScgb3IgJ1cnIFdpbjMyIGZ1bmN0aW9uLCB5b3UgY2FuCiAgICAgICAgc3BlY2lmeSB0aGUgY2hhcmFjdGVyIHNldC4KCiAgICAuUEFSQU1FVEVSIFNldExhc3RFcnJvcgoKICAgICAgICBJbmRpY2F0ZXMgd2hldGhlciB0aGUgY2FsbGVlIGNhbGxzIHRoZSBTZXRMYXN0RXJyb3IgV2luMzIgQVBJCiAgICAgICAgZnVuY3Rpb24gYmVmb3JlIHJldHVybmluZyBmcm9tIHRoZSBhdHRyaWJ1dGVkIG1ldGhvZC4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZQoKICAgICAgICBUaGUgaW4tbWVtb3J5IG1vZHVsZSB0aGF0IHdpbGwgaG9zdCB0aGUgZnVuY3Rpb25zLiBVc2UKICAgICAgICBOZXctSW5NZW1vcnlNb2R1bGUgdG8gZGVmaW5lIGFuIGluLW1lbW9yeSBtb2R1bGUuCgogICAgLlBBUkFNRVRFUiBOYW1lc3BhY2UKCiAgICAgICAgQW4gb3B0aW9uYWwgbmFtZXNwYWNlIHRvIHByZXBlbmQgdG8gdGhlIHR5cGUuIEFkZC1XaW4zMlR5cGUgZGVmYXVsdHMKICAgICAgICB0byBhIG5hbWVzcGFjZSBjb25zaXN0aW5nIG9ubHkgb2YgdGhlIG5hbWUgb2YgdGhlIERMTC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRGdW5jdGlvbkRlZmluaXRpb25zID0gQCgKICAgICAgICAgIChmdW5jIGtlcm5lbDMyIEdldFByb2NBZGRyZXNzIChbSW50UHRyXSkgQChbSW50UHRyXSwgW1N0cmluZ10pIC1DaGFyc2V0IEFuc2kgLVNldExhc3RFcnJvciksCiAgICAgICAgICAoZnVuYyBrZXJuZWwzMiBHZXRNb2R1bGVIYW5kbGUgKFtJbnRwdHJdKSBAKFtTdHJpbmddKSAtU2V0TGFzdEVycm9yKSwKICAgICAgICAgIChmdW5jIG50ZGxsIFJ0bEdldEN1cnJlbnRQZWIgKFtJbnRQdHJdKSBAKCkpCiAgICAgICAgKQoKICAgICAgICAkVHlwZXMgPSAkRnVuY3Rpb25EZWZpbml0aW9ucyB8IEFkZC1XaW4zMlR5cGUgLU1vZHVsZSAkTW9kIC1OYW1lc3BhY2UgJ1dpbjMyJwogICAgICAgICRLZXJuZWwzMiA9ICRUeXBlc1sna2VybmVsMzInXQogICAgICAgICROdGRsbCA9ICRUeXBlc1snbnRkbGwnXQogICAgICAgICROdGRsbDo6UnRsR2V0Q3VycmVudFBlYigpCiAgICAgICAgJG50ZGxsYmFzZSA9ICRLZXJuZWwzMjo6R2V0TW9kdWxlSGFuZGxlKCdudGRsbCcpCiAgICAgICAgJEtlcm5lbDMyOjpHZXRQcm9jQWRkcmVzcygkbnRkbGxiYXNlLCAnUnRsR2V0Q3VycmVudFBlYicpCgogICAgLk5PVEVTCgogICAgICAgIEluc3BpcmVkIGJ5IExlZSBIb2xtZXMnIEludm9rZS1XaW5kb3dzQXBpIGh0dHA6Ly9wb3NoY29kZS5vcmcvMjE4OQoKICAgICAgICBXaGVuIGRlZmluaW5nIG11bHRpcGxlIGZ1bmN0aW9uIHByb3RvdHlwZXMsIGl0IGlzIGlkZWFsIHRvIHByb3ZpZGUKICAgICAgICBBZGQtV2luMzJUeXBlIHdpdGggYW4gYXJyYXkgb2YgZnVuY3Rpb24gc2lnbmF0dXJlcy4gVGhhdCB3YXksIHRoZXkKICAgICAgICBhcmUgYWxsIGluY29ycG9yYXRlZCBpbnRvIHRoZSBzYW1lIGluLW1lbW9yeSBtb2R1bGUuCiM+CgogICAgW091dHB1dFR5cGUoW0hhc2h0YWJsZV0pXQogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREbGxOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZ1bmN0aW9uTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkUmV0dXJuVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtUeXBlW11dCiAgICAgICAgJFBhcmFtZXRlclR5cGVzLAoKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWUgPSAkVHJ1ZSldCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXQogICAgICAgICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OlN0ZENhbGwsCgogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICRUcnVlKV0KICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF0KICAgICAgICAkQ2hhcnNldCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bywKCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJFRydWUpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNldExhc3RFcnJvciwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZXNwYWNlID0gJycKICAgICkKCiAgICBCRUdJTgogICAgewogICAgICAgICRUeXBlSGFzaCA9IEB7fQogICAgfQoKICAgIFBST0NFU1MKICAgIHsKICAgICAgICBpZiAoJE1vZHVsZSAtaXMgW1JlZmxlY3Rpb24uQXNzZW1ibHldKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCROYW1lc3BhY2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRUeXBlSGFzaFskRGxsTmFtZV0gPSAkTW9kdWxlLkdldFR5cGUoIiROYW1lc3BhY2UuJERsbE5hbWUiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFR5cGVIYXNoWyREbGxOYW1lXSA9ICRNb2R1bGUuR2V0VHlwZSgkRGxsTmFtZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIERlZmluZSBvbmUgdHlwZSBmb3IgZWFjaCBETEwKICAgICAgICAgICAgaWYgKCEkVHlwZUhhc2guQ29udGFpbnNLZXkoJERsbE5hbWUpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJE5hbWVzcGFjZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkVHlwZUhhc2hbJERsbE5hbWVdID0gJE1vZHVsZS5EZWZpbmVUeXBlKCIkTmFtZXNwYWNlLiREbGxOYW1lIiwgJ1B1YmxpYyxCZWZvcmVGaWVsZEluaXQnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRUeXBlSGFzaFskRGxsTmFtZV0gPSAkTW9kdWxlLkRlZmluZVR5cGUoJERsbE5hbWUsICdQdWJsaWMsQmVmb3JlRmllbGRJbml0JykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJE1ldGhvZCA9ICRUeXBlSGFzaFskRGxsTmFtZV0uRGVmaW5lTWV0aG9kKAogICAgICAgICAgICAgICAgJEZ1bmN0aW9uTmFtZSwKICAgICAgICAgICAgICAgICdQdWJsaWMsU3RhdGljLFBpbnZva2VJbXBsJywKICAgICAgICAgICAgICAgICRSZXR1cm5UeXBlLAogICAgICAgICAgICAgICAgJFBhcmFtZXRlclR5cGVzKQoKICAgICAgICAgICAgIyBNYWtlIGVhY2ggQnlSZWYgcGFyYW1ldGVyIGFuIE91dCBwYXJhbWV0ZXIKICAgICAgICAgICAgJGkgPSAxCiAgICAgICAgICAgIEZvckVhY2goJFBhcmFtZXRlciBpbiAkUGFyYW1ldGVyVHlwZXMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkUGFyYW1ldGVyLklzQnlSZWYpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgW3ZvaWRdICRNZXRob2QuRGVmaW5lUGFyYW1ldGVyKCRpLCAnT3V0JywgJE51bGwpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGkrKwogICAgICAgICAgICB9CgogICAgICAgICAgICAkRGxsSW1wb3J0ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkRsbEltcG9ydEF0dHJpYnV0ZV0KICAgICAgICAgICAgJFNldExhc3RFcnJvckZpZWxkID0gJERsbEltcG9ydC5HZXRGaWVsZCgnU2V0TGFzdEVycm9yJykKICAgICAgICAgICAgJENhbGxpbmdDb252ZW50aW9uRmllbGQgPSAkRGxsSW1wb3J0LkdldEZpZWxkKCdDYWxsaW5nQ29udmVudGlvbicpCiAgICAgICAgICAgICRDaGFyc2V0RmllbGQgPSAkRGxsSW1wb3J0LkdldEZpZWxkKCdDaGFyU2V0JykKICAgICAgICAgICAgaWYgKCRTZXRMYXN0RXJyb3IpIHsgJFNMRVZhbHVlID0gJFRydWUgfSBlbHNlIHsgJFNMRVZhbHVlID0gJEZhbHNlIH0KCiAgICAgICAgICAgICMgRXF1aXZhbGVudCB0byBDIyB2ZXJzaW9uIG9mIFtEbGxJbXBvcnQoRGxsTmFtZSldCiAgICAgICAgICAgICRDb25zdHJ1Y3RvciA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5EbGxJbXBvcnRBdHRyaWJ1dGVdLkdldENvbnN0cnVjdG9yKFtTdHJpbmddKQogICAgICAgICAgICAkRGxsSW1wb3J0QXR0cmlidXRlID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3IsCiAgICAgICAgICAgICAgICAkRGxsTmFtZSwgW1JlZmxlY3Rpb24uUHJvcGVydHlJbmZvW11dIEAoKSwgW09iamVjdFtdXSBAKCksCiAgICAgICAgICAgICAgICBbUmVmbGVjdGlvbi5GaWVsZEluZm9bXV0gQCgkU2V0TGFzdEVycm9yRmllbGQsICRDYWxsaW5nQ29udmVudGlvbkZpZWxkLCAkQ2hhcnNldEZpZWxkKSwKICAgICAgICAgICAgICAgIFtPYmplY3RbXV0gQCgkU0xFVmFsdWUsIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2FsbGluZ0NvbnZlbnRpb25dICROYXRpdmVDYWxsaW5nQ29udmVudGlvbiksIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF0gJENoYXJzZXQpKSkKCiAgICAgICAgICAgICRNZXRob2QuU2V0Q3VzdG9tQXR0cmlidXRlKCREbGxJbXBvcnRBdHRyaWJ1dGUpCiAgICAgICAgfQogICAgfQoKICAgIEVORAogICAgewogICAgICAgIGlmICgkTW9kdWxlIC1pcyBbUmVmbGVjdGlvbi5Bc3NlbWJseV0pCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJFR5cGVIYXNoCiAgICAgICAgfQoKICAgICAgICAkUmV0dXJuVHlwZXMgPSBAe30KCiAgICAgICAgRm9yRWFjaCAoJEtleSBpbiAkVHlwZUhhc2guS2V5cykKICAgICAgICB7CiAgICAgICAgICAgICRUeXBlID0gJFR5cGVIYXNoWyRLZXldLkNyZWF0ZVR5cGUoKQoKICAgICAgICAgICAgJFJldHVyblR5cGVzWyRLZXldID0gJFR5cGUKICAgICAgICB9CgogICAgICAgIHJldHVybiAkUmV0dXJuVHlwZXMKICAgIH0KfQoKCmZ1bmN0aW9uIHBzZW51bQp7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ3JlYXRlcyBhbiBpbi1tZW1vcnkgZW51bWVyYXRpb24gZm9yIHVzZSBpbiB5b3VyIFBvd2VyU2hlbGwgc2Vzc2lvbi4KCiAgICAgICAgQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgICAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBUaGUgJ3BzZW51bScgZnVuY3Rpb24gZmFjaWxpdGF0ZXMgdGhlIGNyZWF0aW9uIG9mIGVudW1zIGVudGlyZWx5IGluCiAgICAgICAgbWVtb3J5IHVzaW5nIGFzIGNsb3NlIHRvIGEgIkMgc3R5bGUiIGFzIFBvd2VyU2hlbGwgd2lsbCBhbGxvdy4KCiAgICAuUEFSQU1FVEVSIE1vZHVsZQoKICAgICAgICBUaGUgaW4tbWVtb3J5IG1vZHVsZSB0aGF0IHdpbGwgaG9zdCB0aGUgZW51bS4gVXNlCiAgICAgICAgTmV3LUluTWVtb3J5TW9kdWxlIHRvIGRlZmluZSBhbiBpbi1tZW1vcnkgbW9kdWxlLgoKICAgIC5QQVJBTUVURVIgRnVsbE5hbWUKCiAgICAgICAgVGhlIGZ1bGx5LXF1YWxpZmllZCBuYW1lIG9mIHRoZSBlbnVtLgoKICAgIC5QQVJBTUVURVIgVHlwZQoKICAgICAgICBUaGUgdHlwZSBvZiBlYWNoIGVudW0gZWxlbWVudC4KCiAgICAuUEFSQU1FVEVSIEVudW1FbGVtZW50cwoKICAgICAgICBBIGhhc2h0YWJsZSBvZiBlbnVtIGVsZW1lbnRzLgoKICAgIC5QQVJBTUVURVIgQml0ZmllbGQKCiAgICAgICAgU3BlY2lmaWVzIHRoYXQgdGhlIGVudW0gc2hvdWxkIGJlIHRyZWF0ZWQgYXMgYSBiaXRmaWVsZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRJbWFnZVN1YnN5c3RlbSA9IHBzZW51bSAkTW9kIFBFLklNQUdFX1NVQlNZU1RFTSBVSW50MTYgQHsKICAgICAgICAgICAgVU5LTk9XTiA9ICAgICAgICAgICAgICAgICAgMAogICAgICAgICAgICBOQVRJVkUgPSAgICAgICAgICAgICAgICAgICAxICMgSW1hZ2UgZG9lc24ndCByZXF1aXJlIGEgc3Vic3lzdGVtLgogICAgICAgICAgICBXSU5ET1dTX0dVSSA9ICAgICAgICAgICAgICAyICMgSW1hZ2UgcnVucyBpbiB0aGUgV2luZG93cyBHVUkgc3Vic3lzdGVtLgogICAgICAgICAgICBXSU5ET1dTX0NVSSA9ICAgICAgICAgICAgICAzICMgSW1hZ2UgcnVucyBpbiB0aGUgV2luZG93cyBjaGFyYWN0ZXIgc3Vic3lzdGVtLgogICAgICAgICAgICBPUzJfQ1VJID0gICAgICAgICAgICAgICAgICA1ICMgSW1hZ2UgcnVucyBpbiB0aGUgT1MvMiBjaGFyYWN0ZXIgc3Vic3lzdGVtLgogICAgICAgICAgICBQT1NJWF9DVUkgPSAgICAgICAgICAgICAgICA3ICMgSW1hZ2UgcnVucyBpbiB0aGUgUG9zaXggY2hhcmFjdGVyIHN1YnN5c3RlbS4KICAgICAgICAgICAgTkFUSVZFX1dJTkRPV1MgPSAgICAgICAgICAgOCAjIEltYWdlIGlzIGEgbmF0aXZlIFdpbjl4IGRyaXZlci4KICAgICAgICAgICAgV0lORE9XU19DRV9HVUkgPSAgICAgICAgICAgOSAjIEltYWdlIHJ1bnMgaW4gdGhlIFdpbmRvd3MgQ0Ugc3Vic3lzdGVtLgogICAgICAgICAgICBFRklfQVBQTElDQVRJT04gPSAgICAgICAgICAxMAogICAgICAgICAgICBFRklfQk9PVF9TRVJWSUNFX0RSSVZFUiA9ICAxMQogICAgICAgICAgICBFRklfUlVOVElNRV9EUklWRVIgPSAgICAgICAxMgogICAgICAgICAgICBFRklfUk9NID0gICAgICAgICAgICAgICAgICAxMwogICAgICAgICAgICBYQk9YID0gICAgICAgICAgICAgICAgICAgICAxNAogICAgICAgICAgICBXSU5ET1dTX0JPT1RfQVBQTElDQVRJT04gPSAxNgogICAgICAgIH0KCiAgICAuTk9URVMKCiAgICAgICAgUG93ZXJTaGVsbCBwdXJpc3RzIG1heSBkaXNhZ3JlZSB3aXRoIHRoZSBuYW1pbmcgb2YgdGhpcyBmdW5jdGlvbiBidXQKICAgICAgICBhZ2FpbiwgdGhpcyB3YXMgZGV2ZWxvcGVkIGluIHN1Y2ggYSB3YXkgc28gYXMgdG8gZW11bGF0ZSBhICJDIHN0eWxlIgogICAgICAgIGRlZmluaXRpb24gYXMgY2xvc2VseSBhcyBwb3NzaWJsZS4gU29ycnksIEknbSBub3QgZ29pbmcgdG8gbmFtZSBpdAogICAgICAgIE5ldy1FbnVtLiA6UAojPgoKICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRnVsbE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1R5cGVdCiAgICAgICAgJFR5cGUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRFbnVtRWxlbWVudHMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEJpdGZpZWxkCiAgICApCgogICAgaWYgKCRNb2R1bGUgLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSkKICAgIHsKICAgICAgICByZXR1cm4gKCRNb2R1bGUuR2V0VHlwZSgkRnVsbE5hbWUpKQogICAgfQoKICAgICRFbnVtVHlwZSA9ICRUeXBlIC1hcyBbVHlwZV0KCiAgICAkRW51bUJ1aWxkZXIgPSAkTW9kdWxlLkRlZmluZUVudW0oJEZ1bGxOYW1lLCAnUHVibGljJywgJEVudW1UeXBlKQoKICAgIGlmICgkQml0ZmllbGQpCiAgICB7CiAgICAgICAgJEZsYWdzQ29uc3RydWN0b3IgPSBbRmxhZ3NBdHRyaWJ1dGVdLkdldENvbnN0cnVjdG9yKEAoKSkKICAgICAgICAkRmxhZ3NDdXN0b21BdHRyaWJ1dGUgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uRW1pdC5DdXN0b21BdHRyaWJ1dGVCdWlsZGVyKCRGbGFnc0NvbnN0cnVjdG9yLCBAKCkpCiAgICAgICAgJEVudW1CdWlsZGVyLlNldEN1c3RvbUF0dHJpYnV0ZSgkRmxhZ3NDdXN0b21BdHRyaWJ1dGUpCiAgICB9CgogICAgRm9yRWFjaCAoJEtleSBpbiAkRW51bUVsZW1lbnRzLktleXMpCiAgICB7CiAgICAgICAgIyBBcHBseSB0aGUgc3BlY2lmaWVkIGVudW0gdHlwZSB0byBlYWNoIGVsZW1lbnQKICAgICAgICAkTnVsbCA9ICRFbnVtQnVpbGRlci5EZWZpbmVMaXRlcmFsKCRLZXksICRFbnVtRWxlbWVudHNbJEtleV0gLWFzICRFbnVtVHlwZSkKICAgIH0KCiAgICAkRW51bUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCn0KCgojIEEgaGVscGVyIGZ1bmN0aW9uIHVzZWQgdG8gcmVkdWNlIHR5cGluZyB3aGlsZSBkZWZpbmluZyBzdHJ1Y3QKIyBmaWVsZHMuCmZ1bmN0aW9uIGZpZWxkCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVUludDE2XQogICAgICAgICRQb3NpdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVHlwZV0KICAgICAgICAkVHlwZSwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIpXQogICAgICAgIFtVSW50MTZdCiAgICAgICAgJE9mZnNldCwKCiAgICAgICAgW09iamVjdFtdXQogICAgICAgICRNYXJzaGFsQXMKICAgICkKCiAgICBAewogICAgICAgIFBvc2l0aW9uID0gJFBvc2l0aW9uCiAgICAgICAgVHlwZSA9ICRUeXBlIC1hcyBbVHlwZV0KICAgICAgICBPZmZzZXQgPSAkT2Zmc2V0CiAgICAgICAgTWFyc2hhbEFzID0gJE1hcnNoYWxBcwogICAgfQp9CgoKZnVuY3Rpb24gc3RydWN0CnsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDcmVhdGVzIGFuIGluLW1lbW9yeSBzdHJ1Y3QgZm9yIHVzZSBpbiB5b3VyIFBvd2VyU2hlbGwgc2Vzc2lvbi4KCiAgICAgICAgQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgICAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBPcHRpb25hbCBEZXBlbmRlbmNpZXM6IGZpZWxkCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFRoZSAnc3RydWN0JyBmdW5jdGlvbiBmYWNpbGl0YXRlcyB0aGUgY3JlYXRpb24gb2Ygc3RydWN0cyBlbnRpcmVseSBpbgogICAgICAgIG1lbW9yeSB1c2luZyBhcyBjbG9zZSB0byBhICJDIHN0eWxlIiBhcyBQb3dlclNoZWxsIHdpbGwgYWxsb3cuIFN0cnVjdAogICAgICAgIGZpZWxkcyBhcmUgc3BlY2lmaWVkIHVzaW5nIGEgaGFzaHRhYmxlIHdoZXJlIGVhY2ggZmllbGQgb2YgdGhlIHN0cnVjdAogICAgICAgIGlzIGNvbXByb3NlZCBvZiB0aGUgb3JkZXIgaW4gd2hpY2ggaXQgc2hvdWxkIGJlIGRlZmluZWQsIGl0cyAuTkVUCiAgICAgICAgdHlwZSwgYW5kIG9wdGlvbmFsbHksIGl0cyBvZmZzZXQgYW5kIHNwZWNpYWwgbWFyc2hhbGluZyBhdHRyaWJ1dGVzLgoKICAgICAgICBPbmUgb2YgdGhlIGZlYXR1cmVzIG9mICdzdHJ1Y3QnIGlzIHRoYXQgYWZ0ZXIgeW91ciBzdHJ1Y3QgaXMgZGVmaW5lZCwKICAgICAgICBpdCB3aWxsIGNvbWUgd2l0aCBhIGJ1aWx0LWluIEdldFNpemUgbWV0aG9kIGFzIHdlbGwgYXMgYW4gZXhwbGljaXQKICAgICAgICBjb252ZXJ0ZXIgc28gdGhhdCB5b3UgY2FuIGVhc2lseSBjYXN0IGFuIEludFB0ciB0byB0aGUgc3RydWN0IHdpdGhvdXQKICAgICAgICByZWx5aW5nIHVwb24gY2FsbGluZyBTaXplT2YgYW5kL29yIFB0clRvU3RydWN0dXJlIGluIHRoZSBNYXJzaGFsCiAgICAgICAgY2xhc3MuCgogICAgLlBBUkFNRVRFUiBNb2R1bGUKCiAgICAgICAgVGhlIGluLW1lbW9yeSBtb2R1bGUgdGhhdCB3aWxsIGhvc3QgdGhlIHN0cnVjdC4gVXNlCiAgICAgICAgTmV3LUluTWVtb3J5TW9kdWxlIHRvIGRlZmluZSBhbiBpbi1tZW1vcnkgbW9kdWxlLgoKICAgIC5QQVJBTUVURVIgRnVsbE5hbWUKCiAgICAgICAgVGhlIGZ1bGx5LXF1YWxpZmllZCBuYW1lIG9mIHRoZSBzdHJ1Y3QuCgogICAgLlBBUkFNRVRFUiBTdHJ1Y3RGaWVsZHMKCiAgICAgICAgQSBoYXNodGFibGUgb2YgZmllbGRzLiBVc2UgdGhlICdmaWVsZCcgaGVscGVyIGZ1bmN0aW9uIHRvIGVhc2UKICAgICAgICBkZWZpbmluZyBlYWNoIGZpZWxkLgoKICAgIC5QQVJBTUVURVIgUGFja2luZ1NpemUKCiAgICAgICAgU3BlY2lmaWVzIHRoZSBtZW1vcnkgYWxpZ25tZW50IG9mIGZpZWxkcy4KCiAgICAuUEFSQU1FVEVSIEV4cGxpY2l0TGF5b3V0CgogICAgICAgIEluZGljYXRlcyB0aGF0IGFuIGV4cGxpY2l0IG9mZnNldCBmb3IgZWFjaCBmaWVsZCB3aWxsIGJlIHNwZWNpZmllZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICAkTW9kID0gTmV3LUluTWVtb3J5TW9kdWxlIC1Nb2R1bGVOYW1lIFdpbjMyCgogICAgICAgICRJbWFnZURvc1NpZ25hdHVyZSA9IHBzZW51bSAkTW9kIFBFLklNQUdFX0RPU19TSUdOQVRVUkUgVUludDE2IEB7CiAgICAgICAgICAgIERPU19TSUdOQVRVUkUgPSAgICAweDVBNEQKICAgICAgICAgICAgT1MyX1NJR05BVFVSRSA9ICAgIDB4NDU0RQogICAgICAgICAgICBPUzJfU0lHTkFUVVJFX0xFID0gMHg0NTRDCiAgICAgICAgICAgIFZYRF9TSUdOQVRVUkUgPSAgICAweDQ1NEMKICAgICAgICB9CgogICAgICAgICRJbWFnZURvc0hlYWRlciA9IHN0cnVjdCAkTW9kIFBFLklNQUdFX0RPU19IRUFERVIgQHsKICAgICAgICAgICAgZV9tYWdpYyA9ICAgIGZpZWxkIDAgJEltYWdlRG9zU2lnbmF0dXJlCiAgICAgICAgICAgIGVfY2JscCA9ICAgICBmaWVsZCAxIFVJbnQxNgogICAgICAgICAgICBlX2NwID0gICAgICAgZmllbGQgMiBVSW50MTYKICAgICAgICAgICAgZV9jcmxjID0gICAgIGZpZWxkIDMgVUludDE2CiAgICAgICAgICAgIGVfY3BhcmhkciA9ICBmaWVsZCA0IFVJbnQxNgogICAgICAgICAgICBlX21pbmFsbG9jID0gZmllbGQgNSBVSW50MTYKICAgICAgICAgICAgZV9tYXhhbGxvYyA9IGZpZWxkIDYgVUludDE2CiAgICAgICAgICAgIGVfc3MgPSAgICAgICBmaWVsZCA3IFVJbnQxNgogICAgICAgICAgICBlX3NwID0gICAgICAgZmllbGQgOCBVSW50MTYKICAgICAgICAgICAgZV9jc3VtID0gICAgIGZpZWxkIDkgVUludDE2CiAgICAgICAgICAgIGVfaXAgPSAgICAgICBmaWVsZCAxMCBVSW50MTYKICAgICAgICAgICAgZV9jcyA9ICAgICAgIGZpZWxkIDExIFVJbnQxNgogICAgICAgICAgICBlX2xmYXJsYyA9ICAgZmllbGQgMTIgVUludDE2CiAgICAgICAgICAgIGVfb3ZubyA9ICAgICBmaWVsZCAxMyBVSW50MTYKICAgICAgICAgICAgZV9yZXMgPSAgICAgIGZpZWxkIDE0IFVJbnQxNltdIC1NYXJzaGFsQXMgQCgnQnlWYWxBcnJheScsIDQpCiAgICAgICAgICAgIGVfb2VtaWQgPSAgICBmaWVsZCAxNSBVSW50MTYKICAgICAgICAgICAgZV9vZW1pbmZvID0gIGZpZWxkIDE2IFVJbnQxNgogICAgICAgICAgICBlX3JlczIgPSAgICAgZmllbGQgMTcgVUludDE2W10gLU1hcnNoYWxBcyBAKCdCeVZhbEFycmF5JywgMTApCiAgICAgICAgICAgIGVfbGZhbmV3ID0gICBmaWVsZCAxOCBJbnQzMgogICAgICAgIH0KCiAgICAgICAgIyBFeGFtcGxlIG9mIHVzaW5nIGFuIGV4cGxpY2l0IGxheW91dCBpbiBvcmRlciB0byBjcmVhdGUgYSB1bmlvbi4KICAgICAgICAkVGVzdFVuaW9uID0gc3RydWN0ICRNb2QgVGVzdFVuaW9uIEB7CiAgICAgICAgICAgIGZpZWxkMSA9IGZpZWxkIDAgVUludDMyIDAKICAgICAgICAgICAgZmllbGQyID0gZmllbGQgMSBJbnRQdHIgMAogICAgICAgIH0gLUV4cGxpY2l0TGF5b3V0CgogICAgLk5PVEVTCgogICAgICAgIFBvd2VyU2hlbGwgcHVyaXN0cyBtYXkgZGlzYWdyZWUgd2l0aCB0aGUgbmFtaW5nIG9mIHRoaXMgZnVuY3Rpb24gYnV0CiAgICAgICAgYWdhaW4sIHRoaXMgd2FzIGRldmVsb3BlZCBpbiBzdWNoIGEgd2F5IHNvIGFzIHRvIGVtdWxhdGUgYSAiQyBzdHlsZSIKICAgICAgICBkZWZpbml0aW9uIGFzIGNsb3NlbHkgYXMgcG9zc2libGUuIFNvcnJ5LCBJJ20gbm90IGdvaW5nIHRvIG5hbWUgaXQKICAgICAgICBOZXctU3RydWN0LiA6UAojPgoKICAgIFtPdXRwdXRUeXBlKFtUeXBlXSldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHsoJF8gLWlzIFtSZWZsZWN0aW9uLkVtaXQuTW9kdWxlQnVpbGRlcl0pIC1vciAoJF8gLWlzIFtSZWZsZWN0aW9uLkFzc2VtYmx5XSl9KV0KICAgICAgICAkTW9kdWxlLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMiwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRnVsbE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRTdHJ1Y3RGaWVsZHMsCgogICAgICAgIFtSZWZsZWN0aW9uLkVtaXQuUGFja2luZ1NpemVdCiAgICAgICAgJFBhY2tpbmdTaXplID0gW1JlZmxlY3Rpb24uRW1pdC5QYWNraW5nU2l6ZV06OlVuc3BlY2lmaWVkLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeHBsaWNpdExheW91dAogICAgKQoKICAgIGlmICgkTW9kdWxlIC1pcyBbUmVmbGVjdGlvbi5Bc3NlbWJseV0pCiAgICB7CiAgICAgICAgcmV0dXJuICgkTW9kdWxlLkdldFR5cGUoJEZ1bGxOYW1lKSkKICAgIH0KCiAgICBbUmVmbGVjdGlvbi5UeXBlQXR0cmlidXRlc10gJFN0cnVjdEF0dHJpYnV0ZXMgPSAnQW5zaUNsYXNzLAogICAgICAgIENsYXNzLAogICAgICAgIFB1YmxpYywKICAgICAgICBTZWFsZWQsCiAgICAgICAgQmVmb3JlRmllbGRJbml0JwoKICAgIGlmICgkRXhwbGljaXRMYXlvdXQpCiAgICB7CiAgICAgICAgJFN0cnVjdEF0dHJpYnV0ZXMgPSAkU3RydWN0QXR0cmlidXRlcyAtYm9yIFtSZWZsZWN0aW9uLlR5cGVBdHRyaWJ1dGVzXTo6RXhwbGljaXRMYXlvdXQKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkU3RydWN0QXR0cmlidXRlcyA9ICRTdHJ1Y3RBdHRyaWJ1dGVzIC1ib3IgW1JlZmxlY3Rpb24uVHlwZUF0dHJpYnV0ZXNdOjpTZXF1ZW50aWFsTGF5b3V0CiAgICB9CgogICAgJFN0cnVjdEJ1aWxkZXIgPSAkTW9kdWxlLkRlZmluZVR5cGUoJEZ1bGxOYW1lLCAkU3RydWN0QXR0cmlidXRlcywgW1ZhbHVlVHlwZV0sICRQYWNraW5nU2l6ZSkKICAgICRDb25zdHJ1Y3RvckluZm8gPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbEFzQXR0cmlidXRlXS5HZXRDb25zdHJ1Y3RvcnMoKVswXQogICAgJFNpemVDb25zdCA9IEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxBc0F0dHJpYnV0ZV0uR2V0RmllbGQoJ1NpemVDb25zdCcpKQoKICAgICRGaWVsZHMgPSBOZXctT2JqZWN0IEhhc2h0YWJsZVtdKCRTdHJ1Y3RGaWVsZHMuQ291bnQpCgogICAgIyBTb3J0IGVhY2ggZmllbGQgYWNjb3JkaW5nIHRvIHRoZSBvcmRlcnMgc3BlY2lmaWVkCiAgICAjIFVuZm9ydHVuYXRlbHksIFBTdjIgZG9lc24ndCBoYXZlIHRoZSBsdXh1cnkgb2YgdGhlCiAgICAjIGhhc2h0YWJsZSBbT3JkZXJlZF0gYWNjZWxlcmF0b3IuCiAgICBGb3JFYWNoICgkRmllbGQgaW4gJFN0cnVjdEZpZWxkcy5LZXlzKQogICAgewogICAgICAgICRJbmRleCA9ICRTdHJ1Y3RGaWVsZHNbJEZpZWxkXVsnUG9zaXRpb24nXQogICAgICAgICRGaWVsZHNbJEluZGV4XSA9IEB7RmllbGROYW1lID0gJEZpZWxkOyBQcm9wZXJ0aWVzID0gJFN0cnVjdEZpZWxkc1skRmllbGRdfQogICAgfQoKICAgIEZvckVhY2ggKCRGaWVsZCBpbiAkRmllbGRzKQogICAgewogICAgICAgICRGaWVsZE5hbWUgPSAkRmllbGRbJ0ZpZWxkTmFtZSddCiAgICAgICAgJEZpZWxkUHJvcCA9ICRGaWVsZFsnUHJvcGVydGllcyddCgogICAgICAgICRPZmZzZXQgPSAkRmllbGRQcm9wWydPZmZzZXQnXQogICAgICAgICRUeXBlID0gJEZpZWxkUHJvcFsnVHlwZSddCiAgICAgICAgJE1hcnNoYWxBcyA9ICRGaWVsZFByb3BbJ01hcnNoYWxBcyddCgogICAgICAgICROZXdGaWVsZCA9ICRTdHJ1Y3RCdWlsZGVyLkRlZmluZUZpZWxkKCRGaWVsZE5hbWUsICRUeXBlLCAnUHVibGljJykKCiAgICAgICAgaWYgKCRNYXJzaGFsQXMpCiAgICAgICAgewogICAgICAgICAgICAkVW5tYW5hZ2VkVHlwZSA9ICRNYXJzaGFsQXNbMF0gLWFzIChbUnVudGltZS5JbnRlcm9wU2VydmljZXMuVW5tYW5hZ2VkVHlwZV0pCiAgICAgICAgICAgIGlmICgkTWFyc2hhbEFzWzFdKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkU2l6ZSA9ICRNYXJzaGFsQXNbMV0KICAgICAgICAgICAgICAgICRBdHRyaWJCdWlsZGVyID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3JJbmZvLAogICAgICAgICAgICAgICAgICAgICRVbm1hbmFnZWRUeXBlLCAkU2l6ZUNvbnN0LCBAKCRTaXplKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRBdHRyaWJCdWlsZGVyID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkVtaXQuQ3VzdG9tQXR0cmlidXRlQnVpbGRlcigkQ29uc3RydWN0b3JJbmZvLCBbT2JqZWN0W11dIEAoJFVubWFuYWdlZFR5cGUpKQogICAgICAgICAgICB9CgogICAgICAgICAgICAkTmV3RmllbGQuU2V0Q3VzdG9tQXR0cmlidXRlKCRBdHRyaWJCdWlsZGVyKQogICAgICAgIH0KCiAgICAgICAgaWYgKCRFeHBsaWNpdExheW91dCkgeyAkTmV3RmllbGQuU2V0T2Zmc2V0KCRPZmZzZXQpIH0KICAgIH0KCiAgICAjIE1ha2UgdGhlIHN0cnVjdCBhd2FyZSBvZiBpdHMgb3duIHNpemUuCiAgICAjIE5vIG1vcmUgaGF2aW5nIHRvIGNhbGwgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTaXplT2YhCiAgICAkU2l6ZU1ldGhvZCA9ICRTdHJ1Y3RCdWlsZGVyLkRlZmluZU1ldGhvZCgnR2V0U2l6ZScsCiAgICAgICAgJ1B1YmxpYywgU3RhdGljJywKICAgICAgICBbSW50XSwKICAgICAgICBbVHlwZVtdXSBAKCkpCiAgICAkSUxHZW5lcmF0b3IgPSAkU2l6ZU1ldGhvZC5HZXRJTEdlbmVyYXRvcigpCiAgICAjIFRoYW5rcyBmb3IgdGhlIGhlbHAsIEphc29uIFNoaXJrIQogICAgJElMR2VuZXJhdG9yLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6TGR0b2tlbiwgJFN0cnVjdEJ1aWxkZXIpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtUeXBlXS5HZXRNZXRob2QoJ0dldFR5cGVGcm9tSGFuZGxlJykpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXS5HZXRNZXRob2QoJ1NpemVPZicsIFtUeXBlW11dIEAoW1R5cGVdKSkpCiAgICAkSUxHZW5lcmF0b3IuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpSZXQpCgogICAgIyBBbGxvdyBmb3IgZXhwbGljaXQgY2FzdGluZyBmcm9tIGFuIEludFB0cgogICAgIyBObyBtb3JlIGhhdmluZyB0byBjYWxsIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJ1Y3R1cmUhCiAgICAkSW1wbGljaXRDb252ZXJ0ZXIgPSAkU3RydWN0QnVpbGRlci5EZWZpbmVNZXRob2QoJ29wX0ltcGxpY2l0JywKICAgICAgICAnUHJpdmF0ZVNjb3BlLCBQdWJsaWMsIFN0YXRpYywgSGlkZUJ5U2lnLCBTcGVjaWFsTmFtZScsCiAgICAgICAgJFN0cnVjdEJ1aWxkZXIsCiAgICAgICAgW1R5cGVbXV0gQChbSW50UHRyXSkpCiAgICAkSUxHZW5lcmF0b3IyID0gJEltcGxpY2l0Q29udmVydGVyLkdldElMR2VuZXJhdG9yKCkKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpOb3ApCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6TGRhcmdfMCkKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpMZHRva2VuLCAkU3RydWN0QnVpbGRlcikKICAgICRJTEdlbmVyYXRvcjIuRW1pdChbUmVmbGVjdGlvbi5FbWl0Lk9wQ29kZXNdOjpDYWxsLAogICAgICAgIFtUeXBlXS5HZXRNZXRob2QoJ0dldFR5cGVGcm9tSGFuZGxlJykpCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6Q2FsbCwKICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF0uR2V0TWV0aG9kKCdQdHJUb1N0cnVjdHVyZScsIFtUeXBlW11dIEAoW0ludFB0cl0sIFtUeXBlXSkpKQogICAgJElMR2VuZXJhdG9yMi5FbWl0KFtSZWZsZWN0aW9uLkVtaXQuT3BDb2Rlc106OlVuYm94X0FueSwgJFN0cnVjdEJ1aWxkZXIpCiAgICAkSUxHZW5lcmF0b3IyLkVtaXQoW1JlZmxlY3Rpb24uRW1pdC5PcENvZGVzXTo6UmV0KQoKICAgICRTdHJ1Y3RCdWlsZGVyLkNyZWF0ZVR5cGUoKQp9CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIE1pc2MuIGhlbHBlcnMKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gRXhwb3J0LVBvd2VyVmlld0NTViB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiBleHBvcnRzIHRvIGEgLmNzdiBpbiBhIHRocmVhZC1zYWZlIG1hbm5lci4KICAgICAgICAKICAgICAgICBCYXNlZCBwYXJ0aWFsbHkgb24gRG1pdHJ5IFNvdG5pa292J3MgRXhwb3J0LUNTViBjb2RlCiAgICAgICAgICAgIGF0IGh0dHA6Ly9wb3NoY29kZS5vcmcvMTU5MAoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9wb3NoY29kZS5vcmcvMTU5MAogICAgICAgIGh0dHA6Ly9kbWl0cnlzb3RuaWtvdi53b3JkcHJlc3MuY29tLzIwMTAvMDEvMTkvRXhwb3J0LUNzdi1hcHBlbmQvCiM+CiAgICBQYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUsCiAgICAgICAgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kVHJ1ZSldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNPYmplY3RdCiAgICAgICAgJElucHV0T2JqZWN0LAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSwgUG9zaXRpb249MCldCiAgICAgICAgW0FsaWFzKCdQU1BhdGgnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRPdXRGaWxlCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgCiAgICAgICAgJE9iamVjdENTViA9ICRJbnB1dE9iamVjdCB8IENvbnZlcnRUby1Dc3YgLU5vVHlwZUluZm9ybWF0aW9uCgogICAgICAgICMgbXV0ZXggc28gdGhyZWFkZWQgY29kZSBkb2Vzbid0IHN0b21wIG9uIHRoZSBvdXRwdXQgZmlsZQogICAgICAgICRNdXRleCA9IE5ldy1PYmplY3QgU3lzdGVtLlRocmVhZGluZy5NdXRleCAkRmFsc2UsJ0NTVk11dGV4JzsKICAgICAgICAkTnVsbCA9ICRNdXRleC5XYWl0T25lKCkKCiAgICAgICAgaWYgKFRlc3QtUGF0aCAtUGF0aCAkT3V0RmlsZSkgewogICAgICAgICAgICAjIGhhY2sgdG8gc2tpcCB0aGUgZmlyc3QgbGluZSBvZiBvdXRwdXQgaWYgdGhlIGZpbGUgYWxyZWFkeSBleGlzdHMKICAgICAgICAgICAgJE9iamVjdENTViB8IEZvcmVhY2gtT2JqZWN0IHskU3RhcnQ9JFRydWV9e2lmICgkU3RhcnQpIHskU3RhcnQ9JEZhbHNlfSBlbHNlIHskX319IHwgT3V0LUZpbGUgLUVuY29kaW5nICdBU0NJSScgLUFwcGVuZCAtRmlsZVBhdGggJE91dEZpbGUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRPYmplY3RDU1YgfCBPdXQtRmlsZSAtRW5jb2RpbmcgJ0FTQ0lJJyAtQXBwZW5kIC1GaWxlUGF0aCAkT3V0RmlsZQogICAgICAgIH0KCiAgICAgICAgJE11dGV4LlJlbGVhc2VNdXRleCgpCiAgICB9Cn0KCgojIHN0b2xlbiBkaXJlY3RseSBmcm9tIGh0dHA6Ly9vYnNjdXJlc2VjdXJpdHkuYmxvZ3Nwb3QuY29tLzIwMTQvMDUvdG91Y2guaHRtbApmdW5jdGlvbiBTZXQtTWFjQXR0cmlidXRlIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBTZXRzIHRoZSBtb2RpZmllZCwgYWNjZXNzZWQgYW5kIGNyZWF0ZWQgKE1hYykgYXR0cmlidXRlcyBmb3IgYSBmaWxlIGJhc2VkIG9uIGFub3RoZXIgZmlsZSBvciBpbnB1dC4KCiAgICAgICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IFNldC1NYWNBdHRyaWJ1dGUKICAgICAgICBBdXRob3I6IENocmlzIENhbXBiZWxsIChAb2JzY3VyZXNlYykKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKICAgICAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgICAgICBWZXJzaW9uOiAxLjAuMAoKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBTZXQtTWFjQXR0cmlidXRlIHNldHMgb25lIG9yIG1vcmUgTWFjIGF0dHJpYnV0ZXMgYW5kIHJldHVybnMgdGhlIG5ldyBhdHRyaWJ1dGUgdmFsdWVzIG9mIHRoZSBmaWxlLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gU2V0LU1hY0F0dHJpYnV0ZSAtRmlsZVBhdGggYzpcdGVzdFxuZXdmaWxlIC1PbGRGaWxlUGF0aCBjOlx0ZXN0XG9sZGZpbGUKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IFNldC1NYWNBdHRyaWJ1dGUgLUZpbGVQYXRoIGM6XGRlbW9cdGVzdC54dCAtQWxsICIwMS8wMy8yMDA2IDEyOjEyIHBtIgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gU2V0LU1hY0F0dHJpYnV0ZSAtRmlsZVBhdGggYzpcZGVtb1x0ZXN0LnR4dCAtTW9kaWZpZWQgIjAxLzAzLzIwMDYgMTI6MTIgcG0iIC1BY2Nlc3NlZCAiMDEvMDMvMjAwNiAxMjoxMSBwbSIgLUNyZWF0ZWQgIjAxLzAzLzIwMDYgMTI6MTAgcG0iCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL3d3dy5vYnNjdXJlc2VjLmNvbS8yMDE0LzA1L3RvdWNoLmh0bWwKIz4KICAgIFtDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gJ1RvdWNoJyldCiAgICBQYXJhbSAoCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWxlUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ1RvdWNoJyldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkT2xkRmlsZVBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdJbmRpdmlkdWFsJyldCiAgICAgICAgW0RhdGVUaW1lXQogICAgICAgICRNb2RpZmllZCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0luZGl2aWR1YWwnKV0KICAgICAgICBbRGF0ZVRpbWVdCiAgICAgICAgJEFjY2Vzc2VkLAoKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnSW5kaXZpZHVhbCcpXQogICAgICAgIFtEYXRlVGltZV0KICAgICAgICAkQ3JlYXRlZCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0FsbCcpXQogICAgICAgIFtEYXRlVGltZV0KICAgICAgICAkQWxsTWFjQXR0cmlidXRlcwogICAgKQoKICAgICNIZWxwZXIgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIG9iamVjdCB3aXRoIHRoZSBNQUMgYXR0cmlidXRlcyBvZiBhIGZpbGUuCiAgICBmdW5jdGlvbiBHZXQtTWFjQXR0cmlidXRlIHsKCiAgICAgICAgcGFyYW0oJE9sZEZpbGVOYW1lKQoKICAgICAgICBpZiAoIShUZXN0LVBhdGggLVBhdGggJE9sZEZpbGVOYW1lKSkge1Rocm93ICdGaWxlIE5vdCBGb3VuZCd9CiAgICAgICAgJEZpbGVJbmZvT2JqZWN0ID0gKEdldC1JdGVtICRPbGRGaWxlTmFtZSkKCiAgICAgICAgJE9iamVjdFByb3BlcnRpZXMgPSBAeydNb2RpZmllZCcgPSAoJEZpbGVJbmZvT2JqZWN0Lkxhc3RXcml0ZVRpbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQWNjZXNzZWQnID0gKCRGaWxlSW5mb09iamVjdC5MYXN0QWNjZXNzVGltZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDcmVhdGVkJyA9ICgkRmlsZUluZm9PYmplY3QuQ3JlYXRpb25UaW1lKX07CiAgICAgICAgJFJlc3VsdE9iamVjdCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkT2JqZWN0UHJvcGVydGllcwogICAgICAgIFJldHVybiAkUmVzdWx0T2JqZWN0CiAgICB9CgogICAgJEZpbGVJbmZvT2JqZWN0ID0gKEdldC1JdGVtIC1QYXRoICRGaWxlUGF0aCkKCiAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydBbGxNYWNBdHRyaWJ1dGVzJ10pIHsKICAgICAgICAkTW9kaWZpZWQgPSAkQWxsTWFjQXR0cmlidXRlcwogICAgICAgICRBY2Nlc3NlZCA9ICRBbGxNYWNBdHRyaWJ1dGVzCiAgICAgICAgJENyZWF0ZWQgPSAkQWxsTWFjQXR0cmlidXRlcwogICAgfQoKICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ09sZEZpbGVQYXRoJ10pIHsKICAgICAgICAkQ29weUZpbGVNYWMgPSAoR2V0LU1hY0F0dHJpYnV0ZSAkT2xkRmlsZVBhdGgpCiAgICAgICAgJE1vZGlmaWVkID0gJENvcHlGaWxlTWFjLk1vZGlmaWVkCiAgICAgICAgJEFjY2Vzc2VkID0gJENvcHlGaWxlTWFjLkFjY2Vzc2VkCiAgICAgICAgJENyZWF0ZWQgPSAkQ29weUZpbGVNYWMuQ3JlYXRlZAogICAgfQoKICAgIGlmICgkTW9kaWZpZWQpIHskRmlsZUluZm9PYmplY3QuTGFzdFdyaXRlVGltZSA9ICRNb2RpZmllZH0KICAgIGlmICgkQWNjZXNzZWQpIHskRmlsZUluZm9PYmplY3QuTGFzdEFjY2Vzc1RpbWUgPSAkQWNjZXNzZWR9CiAgICBpZiAoJENyZWF0ZWQpIHskRmlsZUluZm9PYmplY3QuQ3JlYXRpb25UaW1lID0gJENyZWF0ZWR9CgogICAgUmV0dXJuIChHZXQtTWFjQXR0cmlidXRlICRGaWxlUGF0aCkKfQoKCmZ1bmN0aW9uIENvcHktQ2xvbmVkRmlsZSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ29weSBhIHNvdXJjZSBmaWxlIHRvIGEgZGVzdGluYXRpb24gbG9jYXRpb24sIG1hdGNoaW5nIGFueSBNQUMKICAgICAgICBwcm9wZXJ0aWVzIGFzIGFwcHJvcHJpYXRlLgoKICAgIC5QQVJBTUVURVIgU291cmNlRmlsZQoKICAgICAgICBTb3VyY2UgZmlsZSB0byBjb3B5LgoKICAgIC5QQVJBTUVURVIgRGVzdEZpbGUKCiAgICAgICAgRGVzdGluYXRpb24gZmlsZSBwYXRoIHRvIGNvcHkgZmlsZSB0by4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IENvcHktQ2xvbmVkRmlsZSAtU291cmNlRmlsZSBwcm9ncmFtLmV4ZSAtRGVzdEZpbGUgXFxXSU5ET1dTN1x0b29sc1xwcm9ncmFtLmV4ZQogICAgICAgIAogICAgICAgIENvcHkgdGhlIGxvY2FsIHByb2dyYW0uZXhlIGJpbmFyeSB0byBhIHJlbW90ZSBsb2NhdGlvbiwgbWF0Y2hpbmcgdGhlIE1BQyBwcm9wZXJ0aWVzIG9mIHRoZSByZW1vdGUgZXhlLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9vYnNjdXJlc2VjdXJpdHkuYmxvZ3Nwb3QuY29tLzIwMTQvMDUvdG91Y2guaHRtbAojPgoKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkU291cmNlRmlsZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgICREZXN0RmlsZQogICAgKQoKICAgICMgY2xvbmUgdGhlIE1BQyBwcm9wZXJ0aWVzCiAgICBTZXQtTWFjQXR0cmlidXRlIC1GaWxlUGF0aCAkU291cmNlRmlsZSAtT2xkRmlsZVBhdGggJERlc3RGaWxlCgogICAgIyBjb3B5IHRoZSBmaWxlIG9mZgogICAgQ29weS1JdGVtIC1QYXRoICRTb3VyY2VGaWxlIC1EZXN0aW5hdGlvbiAkRGVzdEZpbGUKfQoKCmZ1bmN0aW9uIEdldC1JUEFkZHJlc3Mgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gcmVzb2x2ZXMgYSBnaXZlbiBob3N0ZW5hbWUgdG8gaXRzIGFzc29jaWF0ZWQgSVB2NAogICAgICAgIGFkZHJlc3MuIElmIG5vIGhvc3RuYW1lIGlzIHByb3ZpZGVkLCBpdCBkZWZhdWx0cyB0byByZXR1cm5pbmcKICAgICAgICB0aGUgSVAgYWRkcmVzcyBvZiB0aGUgbG9jYWwgaG9zdCB0aGUgc2NyaXB0IGJlIGJlaW5nIHJ1biBvbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1JUEFkZHJlc3MgLUNvbXB1dGVyTmFtZSBTRVJWRVIKICAgICAgICAKICAgICAgICBSZXR1cm4gdGhlIElQdjQgYWRkcmVzcyBvZiAnU0VSVkVSJwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdE5hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnJwogICAgKQogICAgcHJvY2VzcyB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgIyBnZXQgdGhlIElQIHJlc29sdXRpb24gb2YgdGhpcyBzcGVjaWZpZWQgaG9zdG5hbWUKICAgICAgICAgICAgJFJlc3VsdHMgPSBAKChbTmV0LkRuc106OkdldEhvc3RFbnRyeSgkQ29tcHV0ZXJOYW1lKSkuQWRkcmVzc0xpc3QpCgogICAgICAgICAgICBpZiAoJFJlc3VsdHMuQ291bnQgLW5lIDApIHsKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRSZXN1bHQgaW4gJFJlc3VsdHMpIHsKICAgICAgICAgICAgICAgICAgICAjIG1ha2Ugc3VyZSB0aGUgcmV0dXJuZWQgcmVzdWx0IGlzIElQdjQKICAgICAgICAgICAgICAgICAgICBpZiAoJFJlc3VsdC5BZGRyZXNzRmFtaWx5IC1lcSAnSW50ZXJOZXR3b3JrJykgewogICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0LklQQWRkcmVzc1RvU3RyaW5nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAnQ291bGQgbm90IHJlc29sdmUgaG9zdCB0byBhbiBJUCBBZGRyZXNzLicKICAgICAgICB9CiAgICB9CiAgICBlbmQge30KfQoKCmZ1bmN0aW9uIENvbnZlcnQtTmFtZVRvU2lkIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBDb252ZXJ0cyBhIGdpdmVuIHVzZXIvZ3JvdXAgbmFtZSB0byBhIHNlY3VyaXR5IGlkZW50aWZpZXIgKFNJRCkuCgogICAgLlBBUkFNRVRFUiBPYmplY3ROYW1lCgogICAgICAgIFRoZSB1c2VyL2dyb3VwIG5hbWUgdG8gY29udmVydCwgY2FuIGJlICd1c2VyJyBvciAnRE9NQUlOXHVzZXInIGZvcm1hdC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBTcGVjaWZpYyBkb21haW4gZm9yIHRoZSBnaXZlbiB1c2VyIGFjY291bnQsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IENvbnZlcnQtTmFtZVRvU2lkICdERVZcZGZtJwojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgIFtBbGlhcygnTmFtZScpXQogICAgICAgICRPYmplY3ROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4gPSAoR2V0LU5ldERvbWFpbikuTmFtZQogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgIAogICAgICAgICRPYmplY3ROYW1lID0gJE9iamVjdE5hbWUgLXJlcGxhY2UgIi8iLCJcIgogICAgICAgIAogICAgICAgIGlmKCRPYmplY3ROYW1lLmNvbnRhaW5zKCJcIikpIHsKICAgICAgICAgICAgIyBpZiB3ZSBnZXQgYSBET01BSU5cdXNlciBmb3JtYXQsIGF1dG8gY29udmVydCBpdAogICAgICAgICAgICAkRG9tYWluID0gJE9iamVjdE5hbWUuc3BsaXQoIlwiKVswXQogICAgICAgICAgICAkT2JqZWN0TmFtZSA9ICRPYmplY3ROYW1lLnNwbGl0KCJcIilbMV0KICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRPYmogPSAoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLk5UQWNjb3VudCgkRG9tYWluLCRPYmplY3ROYW1lKSkKICAgICAgICAgICAgJE9iai5UcmFuc2xhdGUoW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyXSkuVmFsdWUKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJJbnZhbGlkIG9iamVjdC9uYW1lOiAkRG9tYWluXCRPYmplY3ROYW1lIgogICAgICAgICAgICAkTnVsbAogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIENvbnZlcnQtU2lkVG9OYW1lIHsKPCMKICAgIC5TWU5PUFNJUwogICAgCiAgICAgICAgQ29udmVydHMgYSBzZWN1cml0eSBpZGVudGlmaWVyIChTSUQpIHRvIGEgZ3JvdXAvdXNlciBuYW1lLgoKICAgIC5QQVJBTUVURVIgU0lECiAgICAKICAgICAgICBUaGUgU0lEIHRvIGNvbnZlcnQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBDb252ZXJ0LVNpZFRvTmFtZSBTLTEtNS0yMS0yNjIwODkxODI5LTI0MTEyNjE0OTctMTc3Mzg1MzA4OC0xMTA1CiM+CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNJRAogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRTSUQyID0gJFNJRC50cmltKCcqJykKCiAgICAgICAgICAgICMgdHJ5IHRvIHJlc29sdmUgYW55IGJ1aWx0LWluIFNJRHMgZmlyc3QKICAgICAgICAgICAgIyAgIGZyb20gaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20vZW4tdXMva2IvMjQzMzMwCiAgICAgICAgICAgIFN3aXRjaCAoJFNJRDIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICdTLTEtMCcgICAgICAgICB7ICdOdWxsIEF1dGhvcml0eScgfQogICAgICAgICAgICAgICAgJ1MtMS0wLTAnICAgICAgIHsgJ05vYm9keScgfQogICAgICAgICAgICAgICAgJ1MtMS0xJyAgICAgICAgIHsgJ1dvcmxkIEF1dGhvcml0eScgfQogICAgICAgICAgICAgICAgJ1MtMS0xLTAnICAgICAgIHsgJ0V2ZXJ5b25lJyB9CiAgICAgICAgICAgICAgICAnUy0xLTInICAgICAgICAgeyAnTG9jYWwgQXV0aG9yaXR5JyB9CiAgICAgICAgICAgICAgICAnUy0xLTItMCcgICAgICAgeyAnTG9jYWwnIH0KICAgICAgICAgICAgICAgICdTLTEtMi0xJyAgICAgICB7ICdDb25zb2xlIExvZ29uICcgfQogICAgICAgICAgICAgICAgJ1MtMS0zJyAgICAgICAgIHsgJ0NyZWF0b3IgQXV0aG9yaXR5JyB9CiAgICAgICAgICAgICAgICAnUy0xLTMtMCcgICAgICAgeyAnQ3JlYXRvciBPd25lcicgfQogICAgICAgICAgICAgICAgJ1MtMS0zLTEnICAgICAgIHsgJ0NyZWF0b3IgR3JvdXAnIH0KICAgICAgICAgICAgICAgICdTLTEtMy0yJyAgICAgICB7ICdDcmVhdG9yIE93bmVyIFNlcnZlcicgfQogICAgICAgICAgICAgICAgJ1MtMS0zLTMnICAgICAgIHsgJ0NyZWF0b3IgR3JvdXAgU2VydmVyJyB9CiAgICAgICAgICAgICAgICAnUy0xLTMtNCcgICAgICAgeyAnT3duZXIgUmlnaHRzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTQnICAgICAgICAgeyAnTm9uLXVuaXF1ZSBBdXRob3JpdHknIH0KICAgICAgICAgICAgICAgICdTLTEtNScgICAgICAgICB7ICdOVCBBdXRob3JpdHknIH0KICAgICAgICAgICAgICAgICdTLTEtNS0xJyAgICAgICB7ICdEaWFsdXAnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0yJyAgICAgICB7ICdOZXR3b3JrJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMycgICAgICAgeyAnQmF0Y2gnIH0KICAgICAgICAgICAgICAgICdTLTEtNS00JyAgICAgICB7ICdJbnRlcmFjdGl2ZScgfQogICAgICAgICAgICAgICAgJ1MtMS01LTYnICAgICAgIHsgJ1NlcnZpY2UnIH0KICAgICAgICAgICAgICAgICdTLTEtNS03JyAgICAgICB7ICdBbm9ueW1vdXMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS04JyAgICAgICB7ICdQcm94eScgfQogICAgICAgICAgICAgICAgJ1MtMS01LTknICAgICAgIHsgJ0VudGVycHJpc2UgRG9tYWluIENvbnRyb2xsZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTAnICAgICAgeyAnUHJpbmNpcGFsIFNlbGYnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0xMScgICAgICB7ICdBdXRoZW50aWNhdGVkIFVzZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTInICAgICAgeyAnUmVzdHJpY3RlZCBDb2RlJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTMnICAgICAgeyAnVGVybWluYWwgU2VydmVyIFVzZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTQnICAgICAgeyAnUmVtb3RlIEludGVyYWN0aXZlIExvZ29uJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTUnICAgICAgeyAnVGhpcyBPcmdhbml6YXRpb24gJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTcnICAgICAgeyAnVGhpcyBPcmdhbml6YXRpb24gJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTgnICAgICAgeyAnTG9jYWwgU3lzdGVtJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMTknICAgICAgeyAnTlQgQXV0aG9yaXR5JyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMjAnICAgICAgeyAnTlQgQXV0aG9yaXR5JyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtODAtMCcgICAgeyAnQWxsIFNlcnZpY2VzICcgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU0NCcgIHsgJ0JVSUxUSU5cQWRtaW5pc3RyYXRvcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NDUnICB7ICdCVUlMVElOXFVzZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTQ2JyAgeyAnQlVJTFRJTlxHdWVzdHMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NDcnICB7ICdCVUlMVElOXFBvd2VyIFVzZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTQ4JyAgeyAnQlVJTFRJTlxBY2NvdW50IE9wZXJhdG9ycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU0OScgIHsgJ0JVSUxUSU5cU2VydmVyIE9wZXJhdG9ycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU1MCcgIHsgJ0JVSUxUSU5cUHJpbnQgT3BlcmF0b3JzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTUxJyAgeyAnQlVJTFRJTlxCYWNrdXAgT3BlcmF0b3JzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTUyJyAgeyAnQlVJTFRJTlxSZXBsaWNhdG9ycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU1NCcgIHsgJ0JVSUxUSU5cUHJlLVdpbmRvd3MgMjAwMCBDb21wYXRpYmxlIEFjY2VzcycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU1NScgIHsgJ0JVSUxUSU5cUmVtb3RlIERlc2t0b3AgVXNlcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NTYnICB7ICdCVUlMVElOXE5ldHdvcmsgQ29uZmlndXJhdGlvbiBPcGVyYXRvcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NTcnICB7ICdCVUlMVElOXEluY29taW5nIEZvcmVzdCBUcnVzdCBCdWlsZGVycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU1OCcgIHsgJ0JVSUxUSU5cUGVyZm9ybWFuY2UgTW9uaXRvciBVc2VycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU1OScgIHsgJ0JVSUxUSU5cUGVyZm9ybWFuY2UgTG9nIFVzZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTYwJyAgeyAnQlVJTFRJTlxXaW5kb3dzIEF1dGhvcml6YXRpb24gQWNjZXNzIEdyb3VwJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTYxJyAgeyAnQlVJTFRJTlxUZXJtaW5hbCBTZXJ2ZXIgTGljZW5zZSBTZXJ2ZXJzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTYyJyAgeyAnQlVJTFRJTlxEaXN0cmlidXRlZCBDT00gVXNlcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NjknICB7ICdCVUlMVElOXENyeXB0b2dyYXBoaWMgT3BlcmF0b3JzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTczJyAgeyAnQlVJTFRJTlxFdmVudCBMb2cgUmVhZGVycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU3NCcgIHsgJ0JVSUxUSU5cQ2VydGlmaWNhdGUgU2VydmljZSBEQ09NIEFjY2VzcycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU3NScgIHsgJ0JVSUxUSU5cUkRTIFJlbW90ZSBBY2Nlc3MgU2VydmVycycgfQogICAgICAgICAgICAgICAgJ1MtMS01LTMyLTU3NicgIHsgJ0JVSUxUSU5cUkRTIEVuZHBvaW50IFNlcnZlcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NzcnICB7ICdCVUlMVElOXFJEUyBNYW5hZ2VtZW50IFNlcnZlcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NzgnICB7ICdCVUlMVElOXEh5cGVyLVYgQWRtaW5pc3RyYXRvcnMnIH0KICAgICAgICAgICAgICAgICdTLTEtNS0zMi01NzknICB7ICdCVUlMVElOXEFjY2VzcyBDb250cm9sIEFzc2lzdGFuY2UgT3BlcmF0b3JzJyB9CiAgICAgICAgICAgICAgICAnUy0xLTUtMzItNTgwJyAgeyAnQlVJTFRJTlxBY2Nlc3MgQ29udHJvbCBBc3Npc3RhbmNlIE9wZXJhdG9ycycgfQogICAgICAgICAgICAgICAgRGVmYXVsdCB7IAogICAgICAgICAgICAgICAgICAgICRPYmogPSAoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkU0lEMikpCiAgICAgICAgICAgICAgICAgICAgJE9iai5UcmFuc2xhdGUoIFtTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLk5UQWNjb3VudF0pLlZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAjIFdyaXRlLVdhcm5pbmcgIkludmFsaWQgU0lEOiAkU0lEIgogICAgICAgICAgICAkU0lECiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gQ29udmVydC1OVDR0b0Nhbm9uaWNhbCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ29udmVydHMgYSB1c2VyL2dyb3VwIE5UNCBuYW1lIChpLmUuIGRldi9qb2huKSB0byBjYW5vbmljYWwgZm9ybWF0LgoKICAgICAgICBCYXNlZCBvbiBCaWxsIFN0ZXdhcnQncyBjb2RlIGZyb20gdGhpcyBhcnRpY2xlOiAKICAgICAgICAgICAgaHR0cDovL3dpbmRvd3NpdHByby5jb20vYWN0aXZlLWRpcmVjdG9yeS90cmFuc2xhdGluZy1hY3RpdmUtZGlyZWN0b3J5LW9iamVjdC1uYW1lcy1iZXR3ZWVuLWZvcm1hdHMKCiAgICAuUEFSQU1FVEVSIE9iamVjdE5hbWUKCiAgICAgICAgVGhlIHVzZXIvZ3JvdXAgbmFtZSB0byBjb252ZXJ0LCBuZWVkcyB0byBiZSBpbiAnRE9NQUlOXHVzZXInIGZvcm1hdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IENvbnZlcnQtTlQ0dG9DYW5vbmljYWwgLU9iamVjdE5hbWUgImRldlxkZm0iCiAgICAgICAgCiAgICAgICAgUmV0dXJucyAiZGV2LnRlc3RsYWIubG9jYWwvVXNlcnMvRGF2ZSIKCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vd2luZG93c2l0cHJvLmNvbS9hY3RpdmUtZGlyZWN0b3J5L3RyYW5zbGF0aW5nLWFjdGl2ZS1kaXJlY3Rvcnktb2JqZWN0LW5hbWVzLWJldHdlZW4tZm9ybWF0cwojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRPYmplY3ROYW1lCiAgICApCgogICAgcHJvY2VzcyB7CgogICAgICAgICRPYmplY3ROYW1lID0gJE9iamVjdE5hbWUgLXJlcGxhY2UgIi8iLCJcIgogICAgICAgIAogICAgICAgIGlmKCRPYmplY3ROYW1lLmNvbnRhaW5zKCJcIikpIHsKICAgICAgICAgICAgIyBpZiB3ZSBnZXQgYSBET01BSU5cdXNlciBmb3JtYXQsIHRyeSB0byBleHRyYWN0IHRoZSBkb21haW4KICAgICAgICAgICAgJERvbWFpbiA9ICRPYmplY3ROYW1lLnNwbGl0KCJcIilbMF0KICAgICAgICB9CgogICAgICAgICMgQWNjZXNzb3IgZnVuY3Rpb25zIHRvIHNpbXBsaWZ5IGNhbGxzIHRvIE5hbWVUcmFuc2xhdGUKICAgICAgICBmdW5jdGlvbiBJbnZva2UtTWV0aG9kKFtfX0NvbU9iamVjdF0gJE9iamVjdCwgW1N0cmluZ10gJE1ldGhvZCwgJFBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgJE91dHB1dCA9ICRPYmplY3QuR2V0VHlwZSgpLkludm9rZU1lbWJlcigkTWV0aG9kLCAiSW52b2tlTWV0aG9kIiwgJE51bGwsICRPYmplY3QsICRQYXJhbWV0ZXJzKQogICAgICAgICAgICBpZiAoICRPdXRwdXQgKSB7ICRPdXRwdXQgfQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBTZXQtUHJvcGVydHkoW19fQ29tT2JqZWN0XSAkT2JqZWN0LCBbU3RyaW5nXSAkUHJvcGVydHksICRQYXJhbWV0ZXJzKSB7CiAgICAgICAgICAgIFtWb2lkXSAkT2JqZWN0LkdldFR5cGUoKS5JbnZva2VNZW1iZXIoJFByb3BlcnR5LCAiU2V0UHJvcGVydHkiLCAkTnVsbCwgJE9iamVjdCwgJFBhcmFtZXRlcnMpCiAgICAgICAgfQoKICAgICAgICAkVHJhbnNsYXRlID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IE5hbWVUcmFuc2xhdGUKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgSW52b2tlLU1ldGhvZCAkVHJhbnNsYXRlICJJbml0IiAoMSwgJERvbWFpbikKICAgICAgICB9CiAgICAgICAgY2F0Y2ggW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uTWV0aG9kSW52b2NhdGlvbkV4Y2VwdGlvbl0geyAKICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHdpdGggdHJhbnNsYXRlIGluaXQgaW4gQ29udmVydC1OVDR0b0Nhbm9uaWNhbDogJF8iCiAgICAgICAgfQoKICAgICAgICBTZXQtUHJvcGVydHkgJFRyYW5zbGF0ZSAiQ2hhc2VSZWZlcnJhbCIgKDB4NjApCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEludm9rZS1NZXRob2QgJFRyYW5zbGF0ZSAiU2V0IiAoMywgJE9iamVjdE5hbWUpCiAgICAgICAgICAgIChJbnZva2UtTWV0aG9kICRUcmFuc2xhdGUgIkdldCIgKDIpKQogICAgICAgIH0KICAgICAgICBjYXRjaCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5NZXRob2RJbnZvY2F0aW9uRXhjZXB0aW9uXSB7CiAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciB3aXRoIHRyYW5zbGF0ZSBTZXQvR2V0IGluIENvbnZlcnQtTlQ0dG9DYW5vbmljYWw6ICRfIgogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIENvbnZlcnQtQ2Fub25pY2FsdG9OVDQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIENvbnZlcnRzIGEgdXNlckBmcWRuIHRvIE5UNCBmb3JtYXQuCgogICAgLlBBUkFNRVRFUiBPYmplY3ROYW1lCgogICAgICAgIFRoZSB1c2VyL2dyb3VwIG5hbWUgdG8gY29udmVydCwgbmVlZHMgdG8gYmUgaW4gJ0RPTUFJTlx1c2VyJyBmb3JtYXQuCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL3dpbmRvd3NpdHByby5jb20vYWN0aXZlLWRpcmVjdG9yeS90cmFuc2xhdGluZy1hY3RpdmUtZGlyZWN0b3J5LW9iamVjdC1uYW1lcy1iZXR3ZWVuLWZvcm1hdHMKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10gJE9iamVjdE5hbWUKICAgICkKCiAgICAkRG9tYWluID0gKCRPYmplY3ROYW1lIC1zcGxpdCAiQCIpWzFdCgogICAgJE9iamVjdE5hbWUgPSAkT2JqZWN0TmFtZSAtcmVwbGFjZSAiLyIsIlwiCgogICAgIyBBY2Nlc3NvciBmdW5jdGlvbnMgdG8gc2ltcGxpZnkgY2FsbHMgdG8gTmFtZVRyYW5zbGF0ZQogICAgZnVuY3Rpb24gSW52b2tlLU1ldGhvZChbX19Db21PYmplY3RdICRvYmplY3QsIFtTdHJpbmddICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICAgICAgJG91dHB1dCA9ICRvYmplY3QuR2V0VHlwZSgpLkludm9rZU1lbWJlcigkbWV0aG9kLCAiSW52b2tlTWV0aG9kIiwgJE5VTEwsICRvYmplY3QsICRwYXJhbWV0ZXJzKQogICAgICAgIGlmICggJG91dHB1dCApIHsgJG91dHB1dCB9CiAgICB9CiAgICBmdW5jdGlvbiBTZXQtUHJvcGVydHkoW19fQ29tT2JqZWN0XSAkb2JqZWN0LCBbU3RyaW5nXSAkcHJvcGVydHksICRwYXJhbWV0ZXJzKSB7CiAgICAgICAgW1ZvaWRdICRvYmplY3QuR2V0VHlwZSgpLkludm9rZU1lbWJlcigkcHJvcGVydHksICJTZXRQcm9wZXJ0eSIsICROVUxMLCAkb2JqZWN0LCAkcGFyYW1ldGVycykKICAgIH0KCiAgICAkVHJhbnNsYXRlID0gTmV3LU9iamVjdCAtY29tb2JqZWN0IE5hbWVUcmFuc2xhdGUKCiAgICB0cnkgewogICAgICAgIEludm9rZS1NZXRob2QgJFRyYW5zbGF0ZSAiSW5pdCIgKDEsICREb21haW4pCiAgICB9CiAgICBjYXRjaCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5NZXRob2RJbnZvY2F0aW9uRXhjZXB0aW9uXSB7IH0KCiAgICBTZXQtUHJvcGVydHkgJFRyYW5zbGF0ZSAiQ2hhc2VSZWZlcnJhbCIgKDB4NjApCgogICAgdHJ5IHsKICAgICAgICBJbnZva2UtTWV0aG9kICRUcmFuc2xhdGUgIlNldCIgKDUsICRPYmplY3ROYW1lKQogICAgICAgIChJbnZva2UtTWV0aG9kICRUcmFuc2xhdGUgIkdldCIgKDMpKQogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uTWV0aG9kSW52b2NhdGlvbkV4Y2VwdGlvbl0geyAkXyB9Cn0KCgpmdW5jdGlvbiBDb252ZXJ0RnJvbS1VQUNWYWx1ZSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQ29udmVydHMgYSBVQUMgaW50IHZhbHVlIHRvIGh1bWFuIHJlYWRhYmxlIGZvcm0uCgogICAgLlBBUkFNRVRFUiBWYWx1ZQoKICAgICAgICBUaGUgaW50IFVBQyB2YWx1ZSB0byBjb252ZXJ0LgoKICAgIC5QQVJBTUVURVIgU2hvd0FsbAoKICAgICAgICBTaG93IGFsbCBVQUMgdmFsdWVzLCB3aXRoIGEgKyBpbmRpY2F0aW5nIHRoZSB2YWx1ZSBpcyBjdXJyZW50bHkgc2V0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQ29udmVydEZyb20tVUFDVmFsdWUgLVZhbHVlIDY2MTc2CgogICAgICAgIENvbnZlcnQgdGhlIFVBQyB2YWx1ZSA2NjE3NiB0byBodW1hbiByZWFkYWJsZSBmb3JtYXQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0VXNlciBqYXNvbiB8IHNlbGVjdCB1c2VyYWNjb3VudGNvbnRyb2wgfCBDb252ZXJ0RnJvbS1VQUNWYWx1ZQoKICAgICAgICBDb252ZXJ0IHRoZSBVQUMgdmFsdWUgZm9yICdqYXNvbicgdG8gaHVtYW4gcmVhZGFibGUgZm9ybWF0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFVzZXIgamFzb24gfCBzZWxlY3QgdXNlcmFjY291bnRjb250cm9sIHwgQ29udmVydEZyb20tVUFDVmFsdWUgLVNob3dBbGwKCiAgICAgICAgQ29udmVydCB0aGUgVUFDIHZhbHVlIGZvciAnamFzb24nIHRvIGh1bWFuIHJlYWRhYmxlIGZvcm1hdCwgc2hvd2luZyBhbGwKICAgICAgICBwb3NzaWJsZSBVQUMgdmFsdWVzLgojPgogICAgCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgJFZhbHVlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTaG93QWxsCiAgICApCgogICAgYmVnaW4gewoKICAgICAgICAjIHZhbHVlcyBmcm9tIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLXVzL2tiLzMwNTE0NAogICAgICAgICRVQUNWYWx1ZXMgPSBOZXctT2JqZWN0IFN5c3RlbS5Db2xsZWN0aW9ucy5TcGVjaWFsaXplZC5PcmRlcmVkRGljdGlvbmFyeQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJTQ1JJUFQiLCAxKQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJBQ0NPVU5URElTQUJMRSIsIDIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIkhPTUVESVJfUkVRVUlSRUQiLCA4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJMT0NLT1VUIiwgMTYpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBU1NXRF9OT1RSRVFEIiwgMzIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBU1NXRF9DQU5UX0NIQU5HRSIsIDY0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJFTkNSWVBURURfVEVYVF9QV0RfQUxMT1dFRCIsIDEyOCkKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVEVNUF9EVVBMSUNBVEVfQUNDT1VOVCIsIDI1NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiTk9STUFMX0FDQ09VTlQiLCA1MTIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIklOVEVSRE9NQUlOX1RSVVNUX0FDQ09VTlQiLCAyMDQ4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJXT1JLU1RBVElPTl9UUlVTVF9BQ0NPVU5UIiwgNDA5NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiU0VSVkVSX1RSVVNUX0FDQ09VTlQiLCA4MTkyKQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJET05UX0VYUElSRV9QQVNTV09SRCIsIDY1NTM2KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJNTlNfTE9HT05fQUNDT1VOVCIsIDEzMTA3MikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiU01BUlRDQVJEX1JFUVVJUkVEIiwgMjYyMTQ0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJUUlVTVEVEX0ZPUl9ERUxFR0FUSU9OIiwgNTI0Mjg4KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJOT1RfREVMRUdBVEVEIiwgMTA0ODU3NikKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVVNFX0RFU19LRVlfT05MWSIsIDIwOTcxNTIpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIkRPTlRfUkVRX1BSRUFVVEgiLCA0MTk0MzA0KQogICAgICAgICRVQUNWYWx1ZXMuQWRkKCJQQVNTV09SRF9FWFBJUkVEIiwgODM4ODYwOCkKICAgICAgICAkVUFDVmFsdWVzLkFkZCgiVFJVU1RFRF9UT19BVVRIX0ZPUl9ERUxFR0FUSU9OIiwgMTY3NzcyMTYpCiAgICAgICAgJFVBQ1ZhbHVlcy5BZGQoIlBBUlRJQUxfU0VDUkVUU19BQ0NPVU5UIiwgNjcxMDg4NjQpCgogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICAkUmVzdWx0VUFDVmFsdWVzID0gTmV3LU9iamVjdCBTeXN0ZW0uQ29sbGVjdGlvbnMuU3BlY2lhbGl6ZWQuT3JkZXJlZERpY3Rpb25hcnkKCiAgICAgICAgaWYoJFZhbHVlIC1pcyBbSW50XSkgewogICAgICAgICAgICAkSW50VmFsdWUgPSAkVmFsdWUKICAgICAgICB9CgogICAgICAgIGlmICgkVmFsdWUgLWlzIFtQU0N1c3RvbU9iamVjdF0pIHsKICAgICAgICAgICAgaWYoJFZhbHVlLnVzZXJhY2NvdW50Y29udHJvbCkgewogICAgICAgICAgICAgICAgJEludFZhbHVlID0gJFZhbHVlLnVzZXJhY2NvdW50Y29udHJvbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZigkSW50VmFsdWUpIHsKCiAgICAgICAgICAgIGlmKCRTaG93QWxsKSB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkVUFDVmFsdWUgaW4gJFVBQ1ZhbHVlcy5HZXRFbnVtZXJhdG9yKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiggKCRJbnRWYWx1ZSAtYmFuZCAkVUFDVmFsdWUuVmFsdWUpIC1lcSAkVUFDVmFsdWUuVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFVBQ1ZhbHVlcy5BZGQoJFVBQ1ZhbHVlLk5hbWUsICIkKCRVQUNWYWx1ZS5WYWx1ZSkrIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRVQUNWYWx1ZXMuQWRkKCRVQUNWYWx1ZS5OYW1lLCAiJCgkVUFDVmFsdWUuVmFsdWUpIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkVUFDVmFsdWUgaW4gJFVBQ1ZhbHVlcy5HZXRFbnVtZXJhdG9yKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiggKCRJbnRWYWx1ZSAtYmFuZCAkVUFDVmFsdWUuVmFsdWUpIC1lcSAkVUFDVmFsdWUuVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdFVBQ1ZhbHVlcy5BZGQoJFVBQ1ZhbHVlLk5hbWUsICIkKCRVQUNWYWx1ZS5WYWx1ZSkiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRSZXN1bHRVQUNWYWx1ZXMKICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1Qcm94eSB7CjwjCiAgICAuU1lOT1BTSVMKICAgIAogICAgICAgIEVudW1lcmF0ZXMgdGhlIHByb3h5IHNlcnZlciBhbmQgV1BBRCBjb25lbnRzIGZvciB0aGUgY3VycmVudCB1c2VyLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBjb21wdXRlcm5hbWUgdG8gZW51bWVyYXRlIHByb3h5IHNldHRpbmdzIG9uLCBkZWZhdWx0cyB0byBsb2NhbCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVByb3h5IAogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgcHJveHkgc2V0dGluZ3MuCiM+CiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRFTlY6Q09NUFVURVJOQU1FCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJFJlZyA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuUmVtb3RlQmFzZUtleSgnQ3VycmVudFVzZXInLCAkQ29tcHV0ZXJOYW1lKQogICAgICAgICAgICAkUmVnS2V5ID0gJFJlZy5PcGVuU3Via2V5KCJTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzXFxDdXJyZW50VmVyc2lvblxcSW50ZXJuZXQgU2V0dGluZ3MiKQogICAgICAgICAgICAkUHJveHlTZXJ2ZXIgPSAkUmVnS2V5LkdldFZhbHVlKCdQcm94eVNlcnZlcicpCiAgICAgICAgICAgICRBdXRvQ29uZmlnVVJMID0gJFJlZ0tleS5HZXRWYWx1ZSgnQXV0b0NvbmZpZ1VSTCcpCgogICAgICAgICAgICBpZigkQXV0b0NvbmZpZ1VSTCAtYW5kICgkQXV0b0NvbmZpZ1VSTCAtbmUgIiIpKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICRXcGFkID0gKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJEF1dG9Db25maWdVUkwpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgJFdwYWQgPSAiIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJFdwYWQgPSAiIgogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpZigkUHJveHlTZXJ2ZXIgLW9yICRBdXRvQ29uZmlnVXJsKSB7CgogICAgICAgICAgICAgICAgJFByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICdQcm94eVNlcnZlcicgPSAkUHJveHlTZXJ2ZXIKICAgICAgICAgICAgICAgICAgICAnQXV0b0NvbmZpZ1VSTCcgPSAkQXV0b0NvbmZpZ1VSTAogICAgICAgICAgICAgICAgICAgICdXcGFkJyA9ICRXcGFkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcGVydGllcwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiTm8gcHJveHkgc2V0dGluZ3MgZm91bmQgZm9yICRDb21wdXRlck5hbWUiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBlbnVtZXJhdGluZyBwcm94eSBzZXR0aW5ncyBmb3IgJENvbXB1dGVyTmFtZSIKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtUGF0aEFjbCB7CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW3N0cmluZ10KICAgICAgICAkUGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZQogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgZnVuY3Rpb24gQ29udmVydC1GaWxlUmlnaHQgewoKICAgICAgICAgICAgIyBGcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjgwMjk4NzIvcmV0cmlldmluZy1zZWN1cml0eS1kZXNjcmlwdG9yLWFuZC1nZXR0aW5nLW51bWJlci1mb3ItZmlsZXN5c3RlbXJpZ2h0cwoKICAgICAgICAgICAgW0NtZGxldEJpbmRpbmcoKV0KICAgICAgICAgICAgcGFyYW0oCiAgICAgICAgICAgICAgICBbSW50XQogICAgICAgICAgICAgICAgJEZTUgogICAgICAgICAgICApCgogICAgICAgICAgICAkQWNjZXNzTWFzayA9IEB7CiAgICAgICAgICAgICAgW3VpbnQzMl0nMHg4MDAwMDAwMCcgPSAnR2VuZXJpY1JlYWQnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHg0MDAwMDAwMCcgPSAnR2VuZXJpY1dyaXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MjAwMDAwMDAnID0gJ0dlbmVyaWNFeGVjdXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MTAwMDAwMDAnID0gJ0dlbmVyaWNBbGwnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMjAwMDAwMCcgPSAnTWF4aW11bUFsbG93ZWQnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMTAwMDAwMCcgPSAnQWNjZXNzU3lzdGVtU2VjdXJpdHknCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDEwMDAwMCcgPSAnU3luY2hyb25pemUnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDA4MDAwMCcgPSAnV3JpdGVPd25lcicKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDQwMDAwJyA9ICdXcml0ZURBQycKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDIwMDAwJyA9ICdSZWFkQ29udHJvbCcKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDEwMDAwJyA9ICdEZWxldGUnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDEwMCcgPSAnV3JpdGVBdHRyaWJ1dGVzJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwODAnID0gJ1JlYWRBdHRyaWJ1dGVzJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwNDAnID0gJ0RlbGV0ZUNoaWxkJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMDAwMjAnID0gJ0V4ZWN1dGUvVHJhdmVyc2UnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDAxMCcgPSAnV3JpdGVFeHRlbmRlZEF0dHJpYnV0ZXMnCiAgICAgICAgICAgICAgW3VpbnQzMl0nMHgwMDAwMDAwOCcgPSAnUmVhZEV4dGVuZGVkQXR0cmlidXRlcycKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDA0JyA9ICdBcHBlbmREYXRhL0FkZFN1YmRpcmVjdG9yeScKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDAyJyA9ICdXcml0ZURhdGEvQWRkRmlsZScKICAgICAgICAgICAgICBbdWludDMyXScweDAwMDAwMDAxJyA9ICdSZWFkRGF0YS9MaXN0RGlyZWN0b3J5JwogICAgICAgICAgICB9CgogICAgICAgICAgICAkU2ltcGxlUGVybWlzc2lvbnMgPSBAewogICAgICAgICAgICAgIFt1aW50MzJdJzB4MWYwMWZmJyA9ICdGdWxsQ29udHJvbCcKICAgICAgICAgICAgICBbdWludDMyXScweDAzMDFiZicgPSAnTW9kaWZ5JwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDIwMGE5JyA9ICdSZWFkQW5kRXhlY3V0ZScKICAgICAgICAgICAgICBbdWludDMyXScweDAyMDE5ZicgPSAnUmVhZEFuZFdyaXRlJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDIwMDg5JyA9ICdSZWFkJwogICAgICAgICAgICAgIFt1aW50MzJdJzB4MDAwMTE2JyA9ICdXcml0ZScKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFBlcm1pc3Npb25zID0gQCgpCgogICAgICAgICAgICAjIGdldCBzaW1wbGUgcGVybWlzc2lvbgogICAgICAgICAgICAkUGVybWlzc2lvbnMgKz0gJFNpbXBsZVBlcm1pc3Npb25zLktleXMgfCAgJSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJEZTUiAtYmFuZCAkXykgLWVxICRfKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNpbXBsZVBlcm1pc3Npb25zWyRfXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGU1IgPSAkRlNSIC1iYW5kICgtbm90ICRfKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjIGdldCByZW1haW5pbmcgZXh0ZW5kZWQgcGVybWlzc2lvbnMKICAgICAgICAgICAgJFBlcm1pc3Npb25zICs9ICRBY2Nlc3NNYXNrLktleXMgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB7ICRGU1IgLWJhbmQgJF8gfSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIHsgJEFjY2Vzc01hc2tbJF9dIH0KCiAgICAgICAgICAgICgkUGVybWlzc2lvbnMgfCA/eyRffSkgLWpvaW4gIiwiCiAgICAgICAgfQogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICB0cnkgewogICAgICAgICAgICAkQUNMID0gR2V0LUFjbCAtUGF0aCAkUGF0aAoKICAgICAgICAgICAgJEFDTC5HZXRBY2Nlc3NSdWxlcygkdHJ1ZSwkdHJ1ZSxbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAkTmFtZXMgPSBAKCkKICAgICAgICAgICAgICAgIGlmICgkXy5JZGVudGl0eVJlZmVyZW5jZSAtbWF0Y2ggJ15TLTEtNS0yMS1bMC05XSstWzAtOV0rLVswLTldKy1bMC05XSsnKSB7CiAgICAgICAgICAgICAgICAgICAgJE9iamVjdCA9IEdldC1BRE9iamVjdCAtU0lEICRfLklkZW50aXR5UmVmZXJlbmNlCiAgICAgICAgICAgICAgICAgICAgJE5hbWVzID0gQCgpCiAgICAgICAgICAgICAgICAgICAgJFNJRHMgPSBAKCRPYmplY3Qub2JqZWN0c2lkKQoKICAgICAgICAgICAgICAgICAgICBpZiAoJFJlY3Vyc2UgLWFuZCAoJE9iamVjdC5zYW1BY2NvdW50VHlwZSAtbmUgIjgwNTMwNjM2OCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTSURzICs9IEdldC1OZXRHcm91cE1lbWJlciAtU0lEICRPYmplY3Qub2JqZWN0c2lkIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgTWVtYmVyU2lkCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkU0lEcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgJE5hbWVzICs9ICxAKCRfLCAoQ29udmVydC1TaWRUb05hbWUgJF8pKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICROYW1lcyArPSAsQCgkXy5JZGVudGl0eVJlZmVyZW5jZS5WYWx1ZSwgKENvbnZlcnQtU2lkVG9OYW1lICRfLklkZW50aXR5UmVmZXJlbmNlLlZhbHVlKSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBGb3JFYWNoKCROYW1lIGluICROYW1lcykgewogICAgICAgICAgICAgICAgICAgICRPdXQgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgJE91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdQYXRoJyAkUGF0aAogICAgICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRmlsZVN5c3RlbVJpZ2h0cycgKENvbnZlcnQtRmlsZVJpZ2h0IC1GU1IgJF8uRmlsZVN5c3RlbVJpZ2h0cy52YWx1ZV9fKQogICAgICAgICAgICAgICAgICAgICRPdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSWRlbnRpdHlSZWZlcmVuY2UnICROYW1lWzFdCiAgICAgICAgICAgICAgICAgICAgJE91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJZGVudGl0eVNJRCcgJE5hbWVbMF0KICAgICAgICAgICAgICAgICAgICAkT3V0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0FjY2Vzc0NvbnRyb2xUeXBlJyAkXy5BY2Nlc3NDb250cm9sVHlwZQogICAgICAgICAgICAgICAgICAgICRPdXQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgJF8KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmFtZUZpZWxkIHsKICAgICMgZnVuY3Rpb24gdGhhdCBhdHRlbXB0cyB0byBleHRyYWN0IHRoZSBhcHByb3ByaWF0ZSBmaWVsZCBuYW1lCiAgICAjIGZyb20gdmFyaW91cyBwYXNzZWQgb2JqZWN0cy4gVGhpcyBpcyBzbyBmdW5jdGlvbnMgY2FuIGhhdmUKICAgICMgbXVsdGlwbGUgdHlwZXMgb2Ygb2JqZWN0cyBwYXNzZWQgb24gdGhlIHBpcGVsaW5lLgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICAkT2JqZWN0CiAgICApCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkT2JqZWN0KSB7CiAgICAgICAgICAgIGlmICggW2Jvb2xdKCRPYmplY3QuUFNvYmplY3QuUHJvcGVydGllcy5uYW1lIC1tYXRjaCAiZG5zaG9zdG5hbWUiKSApIHsKICAgICAgICAgICAgICAgICMgb2JqZWN0cyBmcm9tIEdldC1OZXRDb21wdXRlcgogICAgICAgICAgICAgICAgJE9iamVjdC5kbnNob3N0bmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiAoIFtib29sXSgkT2JqZWN0LlBTb2JqZWN0LlByb3BlcnRpZXMubmFtZSAtbWF0Y2ggIm5hbWUiKSApIHsKICAgICAgICAgICAgICAgICMgb2JqZWN0cyBmcm9tIEdldC1OZXREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgICAgICAkT2JqZWN0Lm5hbWUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgc3RyaW5ncyBhbmQgY2F0Y2ggYWxscwogICAgICAgICAgICAgICAgJE9iamVjdAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBDb252ZXJ0LUxEQVBQcm9wZXJ0eSB7CiAgICAjIGhlbHBlciB0byBjb252ZXJ0IHNwZWNpZmljIExEQVAgcHJvcGVydHkgcmVzdWx0IGZpZWxkcwogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJFByb3BlcnRpZXMKICAgICkKCiAgICAkT2JqZWN0UHJvcGVydGllcyA9IEB7fQoKICAgICRQcm9wZXJ0aWVzLlByb3BlcnR5TmFtZXMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgaWYgKCgkXyAtZXEgIm9iamVjdHNpZCIpIC1vciAoJF8gLWVxICJzaWRoaXN0b3J5IikpIHsKICAgICAgICAgICAgIyBjb252ZXJ0IHRoZSBTSUQgdG8gYSBzdHJpbmcKICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gKE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXIoJFByb3BlcnRpZXNbJF9dWzBdLDApKS5WYWx1ZQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJF8gLWVxICJvYmplY3RndWlkIikgewogICAgICAgICAgICAjIGNvbnZlcnQgdGhlIEdVSUQgdG8gYSBzdHJpbmcKICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gKE5ldy1PYmplY3QgR3VpZCAoLCRQcm9wZXJ0aWVzWyRfXVswXSkpLkd1aWQKICAgICAgICB9CiAgICAgICAgZWxzZWlmKCAoJF8gLWVxICJsYXN0bG9nb24iKSAtb3IgKCRfIC1lcSAibGFzdGxvZ29udGltZXN0YW1wIikgLW9yICgkXyAtZXEgInB3ZGxhc3RzZXQiKSAtb3IgKCRfIC1lcSAibGFzdGxvZ29mZiIpIC1vciAoJF8gLWVxICJiYWRQYXNzd29yZFRpbWUiKSApIHsKICAgICAgICAgICAgIyBjb252ZXJ0IHRpbWVzdGFtcHMKICAgICAgICAgICAgaWYgKCRQcm9wZXJ0aWVzWyRfXVswXSAtaXMgW1N5c3RlbS5NYXJzaGFsQnlSZWZPYmplY3RdKSB7CiAgICAgICAgICAgICAgICAjIGlmIHdlIGhhdmUgYSBTeXN0ZW0uX19Db21PYmplY3QKICAgICAgICAgICAgICAgICRUZW1wID0gJFByb3BlcnRpZXNbJF9dWzBdCiAgICAgICAgICAgICAgICBbSW50MzJdJEhpZ2ggPSAkVGVtcC5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCJIaWdoUGFydCIsIFtTeXN0ZW0uUmVmbGVjdGlvbi5CaW5kaW5nRmxhZ3NdOjpHZXRQcm9wZXJ0eSwgJG51bGwsICRUZW1wLCAkbnVsbCkKICAgICAgICAgICAgICAgIFtJbnQzMl0kTG93ICA9ICRUZW1wLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoIkxvd1BhcnQiLCAgW1N5c3RlbS5SZWZsZWN0aW9uLkJpbmRpbmdGbGFnc106OkdldFByb3BlcnR5LCAkbnVsbCwgJFRlbXAsICRudWxsKQogICAgICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gKFtkYXRldGltZV06OkZyb21GaWxlVGltZShbSW50NjRdKCIweHswOng4fXsxOng4fSIgLWYgJEhpZ2gsICRMb3cpKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRPYmplY3RQcm9wZXJ0aWVzWyRfXSA9IChbZGF0ZXRpbWVdOjpGcm9tRmlsZVRpbWUoKCRQcm9wZXJ0aWVzWyRfXVswXSkpKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2VpZigkUHJvcGVydGllc1skX11bMF0gLWlzIFtTeXN0ZW0uTWFyc2hhbEJ5UmVmT2JqZWN0XSkgewogICAgICAgICAgICAjIGNvbnZlcnQgbWlzYyBjb20gb2JqZWN0cwogICAgICAgICAgICAkUHJvcCA9ICRQcm9wZXJ0aWVzWyRfXQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJFRlbXAgPSAkUHJvcFskX11bMF0KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJF8KICAgICAgICAgICAgICAgIFtJbnQzMl0kSGlnaCA9ICRUZW1wLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoIkhpZ2hQYXJ0IiwgW1N5c3RlbS5SZWZsZWN0aW9uLkJpbmRpbmdGbGFnc106OkdldFByb3BlcnR5LCAkbnVsbCwgJFRlbXAsICRudWxsKQogICAgICAgICAgICAgICAgW0ludDMyXSRMb3cgID0gJFRlbXAuR2V0VHlwZSgpLkludm9rZU1lbWJlcigiTG93UGFydCIsICBbU3lzdGVtLlJlZmxlY3Rpb24uQmluZGluZ0ZsYWdzXTo6R2V0UHJvcGVydHksICRudWxsLCAkVGVtcCwgJG51bGwpCiAgICAgICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSBbSW50NjRdKCIweHswOng4fXsxOng4fSIgLWYgJEhpZ2gsICRMb3cpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgJE9iamVjdFByb3BlcnRpZXNbJF9dID0gJFByb3BbJF9dCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRQcm9wZXJ0aWVzWyRfXS5jb3VudCAtZXEgMSkgewogICAgICAgICAgICAkT2JqZWN0UHJvcGVydGllc1skX10gPSAkUHJvcGVydGllc1skX11bMF0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRPYmplY3RQcm9wZXJ0aWVzWyRfXSA9ICRQcm9wZXJ0aWVzWyRfXQogICAgICAgIH0KICAgIH0KCiAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgJE9iamVjdFByb3BlcnRpZXMKfQoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgRG9tYWluIGluZm8gZnVuY3Rpb25zIGJlbG93LgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtRG9tYWluU2VhcmNoZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEhlbHBlciB1c2VkIGJ5IHZhcmlvdXMgZnVuY3Rpb25zIHRoYXQgdGFrZXMgYW4gQURTcGF0aCBhbmQKICAgICAgICBkb21haW4gc3BlY2lmaWVyIGFuZCBidWlsZHMgdGhlIGNvcnJlY3QgQURTSSBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byB1c2UgZm9yIHRoZSBxdWVyeSwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBBRFNwcmVmaXgKCiAgICAgICAgUHJlZml4IHRvIHNldCBmb3IgdGhlIHNlYXJjaGVyIChsaWtlICJDTj1TaXRlcyxDTj1Db25maWd1cmF0aW9uIikKCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluIHRlc3RsYWIubG9jYWwKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluIHRlc3RsYWIubG9jYWwgLURvbWFpbkNvbnRyb2xsZXIgU0VDT05EQVJZLmRldi50ZXN0bGFiLmxvY2FsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcHJlZml4LAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBpZighJERvbWFpbikgewogICAgICAgICREb21haW4gPSAoR2V0LU5ldERvbWFpbikubmFtZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgaWYoISREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAjIGlmIHRoZXJlJ3Mgbm8gLURvbWFpbkNvbnRyb2xsZXIgc3BlY2lmaWVkLCB0cnkgdG8gcHVsbCB0aGUgcHJpbWFyeSBEQwogICAgICAgICAgICAgICAgIyAgIHRvIHJlZmxlY3QgcXVlcmllcyB0aHJvdWdoCiAgICAgICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciA9ICgoR2V0LU5ldERvbWFpbikuUGRjUm9sZU93bmVyKS5OYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgdGhyb3cgIkdldC1Eb21haW5TZWFyY2hlcjogRXJyb3IgaW4gcmV0cmlldmluZyBQREMgZm9yIGN1cnJlbnQgZG9tYWluIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgICRTZWFyY2hTdHJpbmcgPSAiTERBUDovLyIKCiAgICBpZigkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICRTZWFyY2hTdHJpbmcgKz0gJERvbWFpbkNvbnRyb2xsZXIgKyAiLyIKICAgIH0KICAgIGlmKCRBRFNwcmVmaXgpIHsKICAgICAgICAkU2VhcmNoU3RyaW5nICs9ICRBRFNwcmVmaXggKyAiLCIKICAgIH0KCiAgICBpZigkQURTcGF0aCkgewogICAgICAgIGlmKCRBRFNwYXRoIC1saWtlICJHQzovLyoiKSB7CiAgICAgICAgICAgICMgaWYgd2UncmUgc2VhcmNoaW5nIHRoZSBnbG9iYWwgY2F0YWxvZwogICAgICAgICAgICAkRGlzdGluZ3Vpc2hlZE5hbWUgPSAkQWRzUGF0aAogICAgICAgICAgICAkU2VhcmNoU3RyaW5nID0gIiIKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKCRBRFNwYXRoIC1saWtlICJMREFQOi8vKiIpIHsKICAgICAgICAgICAgICAgICRBRFNwYXRoID0gJEFEU3BhdGguU3Vic3RyaW5nKDcpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJERpc3Rpbmd1aXNoZWROYW1lID0gJEFEU3BhdGgKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkRGlzdGluZ3Vpc2hlZE5hbWUgPSAiREM9JCgkRG9tYWluLlJlcGxhY2UoJy4nLCAnLERDPScpKSIKICAgIH0KCiAgICAkU2VhcmNoU3RyaW5nICs9ICREaXN0aW5ndWlzaGVkTmFtZQogICAgV3JpdGUtVmVyYm9zZSAiR2V0LURvbWFpblNlYXJjaGVyIHNlYXJjaCBzdHJpbmc6ICRTZWFyY2hTdHJpbmciCgogICAgJFNlYXJjaGVyID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuRGlyZWN0b3J5U2VhcmNoZXIoW0FEU0ldJFNlYXJjaFN0cmluZykKICAgICRTZWFyY2hlci5QYWdlU2l6ZSA9ICRQYWdlU2l6ZQogICAgJFNlYXJjaGVyCn0KCgpmdW5jdGlvbiBHZXQtTmV0RG9tYWluIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgZ2l2ZW4gZG9tYWluIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIG5hbWUgdG8gcXVlcnkgZm9yLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluIC1Eb21haW4gdGVzdGxhYi5sb2NhbAoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL0ZvcnVtcy9zY3JpcHRjZW50ZXIvZW4tVVMvMGM1YjNmODMtZTUyOC00ZDQ5LTkyYTQtZGVlMzFmNGI0ODFjL2ZpbmRpbmctdGhlLWRuLW9mLXRoZS10aGUtZG9tYWluLXdpdGhvdXQtYWRtb2R1bGUtaW4tcG93ZXJzaGVsbD9mb3J1bT1JVENHCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbgogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgIGlmKCREb21haW4pIHsKICAgICAgICAgICAgJERvbWFpbkNvbnRleHQgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRGlyZWN0b3J5Q29udGV4dCgnRG9tYWluJywgJERvbWFpbikKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRvbWFpbl06OkdldERvbWFpbigkRG9tYWluQ29udGV4dCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJUaGUgc3BlY2lmaWVkIGRvbWFpbiAkRG9tYWluIGRvZXMgbm90IGV4aXN0LCBjb3VsZCBub3QgYmUgY29udGFjdGVkLCBvciB0aGVyZSBpc24ndCBhbiBleGlzdGluZyB0cnVzdC4iCiAgICAgICAgICAgICAgICAkTnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5Eb21haW5dOjpHZXRDdXJyZW50RG9tYWluKCkKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0Rm9yZXN0IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgZ2l2ZW4gZm9yZXN0IG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIEZvcmVzdAoKICAgICAgICBUaGUgZm9yZXN0IG5hbWUgdG8gcXVlcnkgZm9yLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKICAgIAogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZvcmVzdCAtRm9yZXN0IGV4dGVybmFsLmRvbWFpbgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRGb3Jlc3QKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkRm9yZXN0KSB7CiAgICAgICAgICAgICRGb3Jlc3RDb250ZXh0ID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRpcmVjdG9yeUNvbnRleHQoJ0ZvcmVzdCcsICRGb3Jlc3QpCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkRm9yZXN0T2JqZWN0ID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRm9yZXN0XTo6R2V0Rm9yZXN0KCRGb3Jlc3RDb250ZXh0KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJUaGUgc3BlY2lmaWVkIGZvcmVzdCAkRm9yZXN0IGRvZXMgbm90IGV4aXN0LCBjb3VsZCBub3QgYmUgY29udGFjdGVkLCBvciB0aGVyZSBpc24ndCBhbiBleGlzdGluZyB0cnVzdC4iCiAgICAgICAgICAgICAgICAkTnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIG90aGVyd2lzZSB1c2UgdGhlIGN1cnJlbnQgZm9yZXN0CiAgICAgICAgICAgICRGb3Jlc3RPYmplY3QgPSBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5Gb3Jlc3RdOjpHZXRDdXJyZW50Rm9yZXN0KCkKICAgICAgICB9CgogICAgICAgIGlmKCRGb3Jlc3RPYmplY3QpIHsKICAgICAgICAgICAgIyBnZXQgdGhlIFNJRCBvZiB0aGUgZm9yZXN0IHJvb3QKICAgICAgICAgICAgJEZvcmVzdFNpZCA9IChOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuTlRBY2NvdW50KCRGb3Jlc3RPYmplY3QuUm9vdERvbWFpbiwia3JidGd0IikpLlRyYW5zbGF0ZShbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKS5WYWx1ZQogICAgICAgICAgICAkUGFydHMgPSAkRm9yZXN0U2lkIC1TcGxpdCAiLSIKICAgICAgICAgICAgJEZvcmVzdFNpZCA9ICRQYXJ0c1swLi4kKCRQYXJ0cy5sZW5ndGgtMildIC1qb2luICItIgogICAgICAgICAgICAkRm9yZXN0T2JqZWN0IHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgJ1Jvb3REb21haW5TaWQnICRGb3Jlc3RTaWQKICAgICAgICAgICAgJEZvcmVzdE9iamVjdAogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRGb3Jlc3REb21haW4gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiBhbGwgZG9tYWlucyBmb3IgYSBnaXZlbiBmb3Jlc3QuCgogICAgLlBBUkFNRVRFUiBGb3Jlc3QKCiAgICAgICAgVGhlIGZvcmVzdCBuYW1lIHRvIHF1ZXJ5IGRvbWFpbiBmb3IuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgUmV0dXJuIGRvbWFpbnMgdGhhdCBtYXRjaCB0aGlzIHRlcm0vd2lsZGNhcmQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Rm9yZXN0RG9tYWluCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Rm9yZXN0RG9tYWluIC1Gb3Jlc3QgZXh0ZXJuYWwubG9jYWwKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRm9yZXN0LAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4KICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICMgdHJ5IHRvIGRldGVjdCBhIHdpbGQgY2FyZCBzbyB3ZSB1c2UgLWxpa2UKICAgICAgICAgICAgaWYoJERvbWFpbi5Db250YWlucygnKicpKSB7CiAgICAgICAgICAgICAgICAoR2V0LU5ldEZvcmVzdCAtRm9yZXN0ICRGb3Jlc3QpLkRvbWFpbnMgfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLWxpa2UgJERvbWFpbn0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgbWF0Y2ggdGhlIGV4YWN0IGRvbWFpbiBuYW1lIGlmIHRoZXJlJ3Mgbm90IGEgd2lsZGNhcmQKICAgICAgICAgICAgICAgIChHZXQtTmV0Rm9yZXN0IC1Gb3Jlc3QgJEZvcmVzdCkuRG9tYWlucyB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZS5Ub0xvd2VyKCkgLWVxICREb21haW4uVG9Mb3dlcigpfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIHJldHVybiBhbGwgZG9tYWlucwogICAgICAgICAgICAkRm9yZXN0T2JqZWN0ID0gR2V0LU5ldEZvcmVzdCAtRm9yZXN0ICRGb3Jlc3QKICAgICAgICAgICAgaWYoJEZvcmVzdE9iamVjdCkgewogICAgICAgICAgICAgICAgJEZvcmVzdE9iamVjdC5Eb21haW5zCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0Rm9yZXN0Q2F0YWxvZyB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJuIGFsbCBnbG9iYWwgY2F0YWxvZ3MgZm9yIGEgZ2l2ZW4gZm9yZXN0LgoKICAgIC5QQVJBTUVURVIgRm9yZXN0CgogICAgICAgIFRoZSBmb3Jlc3QgbmFtZSB0byBxdWVyeSBkb21haW4gZm9yLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZvcmVzdENhdGFsb2cKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRm9yZXN0CiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgJEZvcmVzdE9iamVjdCA9IEdldC1OZXRGb3Jlc3QgLUZvcmVzdCAkRm9yZXN0CiAgICAgICAgaWYoJEZvcmVzdE9iamVjdCkgewogICAgICAgICAgICAkRm9yZXN0T2JqZWN0LkZpbmRBbGxHbG9iYWxDYXRhbG9ncygpCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiB0aGUgY3VycmVudCBkb21haW4gY29udHJvbGxlcnMgZm9yIHRoZSBhY3RpdmUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIGRvbWFpbiBjb250cm9sbGVycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZGV0ZXJtaW5lIHRoZSBkb21haW4gY29udHJvbGxlcnMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluQ29udHJvbGxlciAtRG9tYWluIHRlc3QKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRMREFQCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYoJExEQVAgLW9yICREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgICMgZmlsdGVyIHN0cmluZyB0byByZXR1cm4gYWxsIGRvbWFpbiBjb250cm9sbGVycwogICAgICAgICAgICBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GdWxsRGF0YSAtRmlsdGVyICcodXNlckFjY291bnRDb250cm9sOjEuMi44NDAuMTEzNTU2LjEuNC44MDM6PTgxOTIpJwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJEZvdW5kRG9tYWluID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmKCRGb3VuZERvbWFpbikgewogICAgICAgICAgICAgICAgJEZvdW5kZG9tYWluLkRvbWFpbkNvbnRyb2xsZXJzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgIm5ldCAqIiByZXBsYWNlbWVudHMgYW5kIG90aGVyIGZ1biBzdGFydCBiZWxvdwojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtTmV0VXNlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcnkgaW5mb3JtYXRpb24gZm9yIGEgZ2l2ZW4gdXNlciBvciB1c2VycyBpbiB0aGUgZG9tYWluCiAgICAgICAgdXNpbmcgQURTSSBhbmQgTERBUC4gQW5vdGhlciAtRG9tYWluIGNhbiBiZSBzcGVjaWZpZWQgdG8KICAgICAgICBxdWVyeSBmb3IgdXNlcnMgYWNyb3NzIGEgdHJ1c3QuCiAgICAgICAgUmVwbGFjZW1lbnQgZm9yICJuZXQgdXNlcnMgL2RvbWFpbiIKCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFVzZXJuYW1lIGZpbHRlciBzdHJpbmcsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKCiAgICAuUEFSQU1FVEVSIEFkbWluQ291bnQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlcnMgd2l0aCBhZG1pbkNvdW50PTEuCgogICAgLlBBUkFNRVRFUiBTUE4KCiAgICAgICAgU3dpdGNoLiBPbmx5IHJldHVybiB1c2VyIG9iamVjdHMgd2l0aCBub24tbnVsbCBzZXJ2aWNlIHByaW5jaXBhbCBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIFVuY29uc3RyYWluZWQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlcnMgdGhhdCBoYXZlIHVuY29uc3RyYWluZWQgZGVsZWdhdGlvbi4KCiAgICAuUEFSQU1FVEVSIEFsbG93RGVsZWdhdGlvbgoKICAgICAgICBTd2l0Y2guIFJldHVybiB1c2VyIGFjY291bnRzIHRoYXQgYXJlIG5vdCBtYXJrZWQgYXMgJ3NlbnNpdGl2ZSBhbmQgbm90IGFsbG93ZWQgZm9yIGRlbGVnYXRpb24nCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0VXNlciAtRG9tYWluIHRlc3RpbmcKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRVc2VyIC1BRFNwYXRoICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZpbHRlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU1BOLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRBZG1pbkNvdW50LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVbmNvbnN0cmFpbmVkLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRBbGxvd0RlbGVnYXRpb24sCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAjIHNvIHRoaXMgaXNuJ3QgcmVwZWF0ZWQgaWYgdXNlcnMgYXJlIHBhc3NlZCBvbiB0aGUgcGlwZWxpbmUKICAgICAgICAkVXNlclNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtQURTcGF0aCAkQURTcGF0aCAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYoJFVzZXJTZWFyY2hlcikgewoKICAgICAgICAgICAgIyBpZiB3ZSdyZSBjaGVja2luZyBmb3IgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uCiAgICAgICAgICAgIGlmKCRVbmNvbnN0cmFpbmVkKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyBmb3IgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uIgogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKHVzZXJBY2NvdW50Q29udHJvbDoxLjIuODQwLjExMzU1Ni4xLjQuODAzOj01MjQyODgpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRBbGxvd0RlbGVnYXRpb24pIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNraW5nIGZvciB1c2VycyB3aG8gY2FuIGJlIGRlbGVnYXRlZCIKICAgICAgICAgICAgICAgICMgbmVnYXRpb24gb2YgIkFjY291bnRzIHRoYXQgYXJlIHNlbnNpdGl2ZSBhbmQgbm90IHRydXN0ZWQgZm9yIGRlbGVnYXRpb24iCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIoISh1c2VyQWNjb3VudENvbnRyb2w6MS4yLjg0MC4xMTM1NTYuMS40LjgwMzo9MTA0ODU3NCkpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRBZG1pbkNvdW50KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyBmb3IgYWRtaW5Db3VudD0xIgogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKGFkbWluY291bnQ9MSkiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgY2hlY2sgaWYgd2UncmUgdXNpbmcgYSB1c2VybmFtZSBmaWx0ZXIgb3Igbm90CiAgICAgICAgICAgIGlmKCRVc2VyTmFtZSkgewogICAgICAgICAgICAgICAgIyBzYW1BY2NvdW50VHlwZT04MDUzMDYzNjggaW5kaWNhdGVzIHVzZXIgb2JqZWN0cwogICAgICAgICAgICAgICAgJFVzZXJTZWFyY2hlci5maWx0ZXI9IigmKHNhbUFjY291bnRUeXBlPTgwNTMwNjM2OCkoc2FtQWNjb3VudE5hbWU9JFVzZXJOYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU1BOKSB7CiAgICAgICAgICAgICAgICAkVXNlclNlYXJjaGVyLmZpbHRlcj0iKCYoc2FtQWNjb3VudFR5cGU9ODA1MzA2MzY4KShzZXJ2aWNlUHJpbmNpcGFsTmFtZT0qKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyBmaWx0ZXIgaXMgc29tZXRoaW5nIGxpa2UgIihzYW1BY2NvdW50TmFtZT0qYmxhaCopIiBpZiBzcGVjaWZpZWQKICAgICAgICAgICAgICAgICRVc2VyU2VhcmNoZXIuZmlsdGVyPSIoJihzYW1BY2NvdW50VHlwZT04MDUzMDYzNjgpJEZpbHRlcikiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRVc2VyU2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICBDb252ZXJ0LUxEQVBQcm9wZXJ0eSAtUHJvcGVydGllcyAkXy5Qcm9wZXJ0aWVzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBBZGQtTmV0VXNlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQWRkcyBhIGRvbWFpbiB1c2VyIG9yIGEgbG9jYWwgdXNlciB0byB0aGUgY3VycmVudCAob3IgcmVtb3RlKSBtYWNoaW5lLAogICAgICAgIGlmIHBlcm1pc3Npb25zIGFsbG93LCB1dGlsaXppbmcgdGhlIFdpbk5UIHNlcnZpY2UgcHJvdmlkZXIgYW5kCiAgICAgICAgRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQsIHJlc3BlY3RpdmVseS4KICAgICAgICAKICAgICAgICBUaGUgZGVmYXVsdCBiZWhhdmlvciBpcyB0byBhZGQgYSB1c2VyIHRvIHRoZSBsb2NhbCBtYWNoaW5lLgogICAgICAgIEFuIG9wdGlvbmFsIGdyb3VwIG5hbWUgdG8gYWRkIHRoZSB1c2VyIHRvIGNhbiBiZSBzcGVjaWZpZWQuCgogICAgLlBBUkFNRVRFUiBVc2VyTmFtZQoKICAgICAgICBUaGUgdXNlcm5hbWUgdG8gYWRkLiBJZiBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvICdiYWNrZG9vcicKCiAgICAuUEFSQU1FVEVSIFBhc3N3b3JkCgogICAgICAgIFRoZSBwYXNzd29yZCB0byBzZXQgZm9yIHRoZSBhZGRlZCB1c2VyLiBJZiBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvICdQYXNzd29yZDEyMyEnCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgR3JvdXAgdG8gb3B0aW9uYWxseSBhZGQgdGhlIHVzZXIgdG8uCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdG5hbWUgdG8gYWRkIHRoZSBsb2NhbCB1c2VyIHRvLCBkZWZhdWx0cyB0byAnbG9jYWxob3N0JwoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFNwZWNpZmllZCBkb21haW4gdG8gYWRkIHRoZSB1c2VyIHRvLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQWRkLU5ldFVzZXIgLVVzZXJOYW1lIGpvaG4gLVBhc3N3b3JkICdQYXNzd29yZDEyMyEnCiAgICAgICAgCiAgICAgICAgQWRkcyBhIGxvY2FsdXNlciAnam9obicgdG8gdGhlIGxvY2FsIG1hY2hpbmUgd2l0aCBwYXNzd29yZCBvZiAnUGFzc3dvcmQxMjMhJwoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQWRkLU5ldFVzZXIgLVVzZXJOYW1lIGpvaG4gLVBhc3N3b3JkICdQYXNzd29yZDEyMyEnIC1Db21wdXRlck5hbWUgc2VydmVyLnRlc3RsYWIubG9jYWwKICAgICAgICAKICAgICAgICBBZGRzIGEgbG9jYWx1c2VyICdqb2huJyB3aXRoIHBhc3N3b3JkIG9mICdQYXNzd29yZDEyMyEnIHRvIHNlcnZlci50ZXN0bGFiLmxvY2FsJ3MgbG9jYWwgQWRtaW5pc3RyYXRvcnMgZ3JvdXAuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBBZGQtTmV0VXNlciAtVXNlck5hbWUgam9obiAtUGFzc3dvcmQgcGFzc3dvcmQgLUdyb3VwTmFtZSAiRG9tYWluIEFkbWlucyIgLURvbWFpbiAnJwogICAgICAgIAogICAgICAgIEFkZHMgdGhlIHVzZXIgImpvaG4iIHdpdGggcGFzc3dvcmQgInBhc3N3b3JkIiB0byB0aGUgY3VycmVudCBkb21haW4gYW5kIGFkZHMKICAgICAgICB0aGUgdXNlciB0byB0aGUgZG9tYWluIGdyb3VwICJEb21haW4gQWRtaW5zIgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQWRkLU5ldFVzZXIgLVVzZXJOYW1lIGpvaG4gLVBhc3N3b3JkIHBhc3N3b3JkIC1Hcm91cE5hbWUgIkRvbWFpbiBBZG1pbnMiIC1Eb21haW4gJ3Rlc3RpbmcnCiAgICAgICAgCiAgICAgICAgQWRkcyB0aGUgdXNlciAiam9obiIgd2l0aCBwYXNzd29yZCAicGFzc3dvcmQiIHRvIHRoZSAndGVzdGluZycgZG9tYWluIGFuZCBhZGRzCiAgICAgICAgdGhlIHVzZXIgdG8gdGhlIGRvbWFpbiBncm91cCAiRG9tYWluIEFkbWlucyIKCiAgICAuTGluawoKICAgICAgICBodHRwOi8vYmxvZ3MudGVjaG5ldC5jb20vYi9oZXlzY3JpcHRpbmdndXkvYXJjaGl2ZS8yMDEwLzExLzIzL3VzZS1wb3dlcnNoZWxsLXRvLWNyZWF0ZS1sb2NhbC11c2VyLWFjY291bnRzLmFzcHgKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUgPSAnYmFja2Rvb3InLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhc3N3b3JkID0gJ1Bhc3N3b3JkMTIzIScsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtBbGlhcygnSG9zdE5hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4KICAgICkKCiAgICBpZiAoJERvbWFpbikgewoKICAgICAgICAkRG9tYWluT2JqZWN0ID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4KICAgICAgICBpZigtbm90ICREb21haW5PYmplY3QpIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3IgaW4gZ3JhYmJpbmcgJERvbWFpbiBvYmplY3QiCiAgICAgICAgICAgIHJldHVybiAkTnVsbAogICAgICAgIH0KCiAgICAgICAgIyBhZGQgdGhlIGFzc2VtYmx5IHdlIG5lZWQKICAgICAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudAoKICAgICAgICAjIGh0dHA6Ly9yaWNoYXJkc3Bvd2Vyc2hlbGxibG9nLndvcmRwcmVzcy5jb20vMjAwOC8wNS8yNS9zeXN0ZW0tZGlyZWN0b3J5c2VydmljZXMtYWNjb3VudG1hbmFnZW1lbnQvCiAgICAgICAgIyBnZXQgdGhlIGRvbWFpbiBjb250ZXh0CiAgICAgICAgJENvbnRleHQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuUHJpbmNpcGFsQ29udGV4dCAtQXJndW1lbnRMaXN0IChbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LkNvbnRleHRUeXBlXTo6RG9tYWluKSwgJERvbWFpbk9iamVjdAoKICAgICAgICAjIGNyZWF0ZSB0aGUgdXNlciBvYmplY3QKICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5Vc2VyUHJpbmNpcGFsIC1Bcmd1bWVudExpc3QgJENvbnRleHQKCiAgICAgICAgIyBzZXQgdXNlciBwcm9wZXJ0aWVzCiAgICAgICAgJFVzZXIuTmFtZSA9ICRVc2VyTmFtZQogICAgICAgICRVc2VyLlNhbUFjY291bnROYW1lID0gJFVzZXJOYW1lCiAgICAgICAgJFVzZXIuUGFzc3dvcmROb3RSZXF1aXJlZCA9ICRGYWxzZQogICAgICAgICRVc2VyLlNldFBhc3N3b3JkKCRQYXNzd29yZCkKICAgICAgICAkVXNlci5FbmFibGVkID0gJFRydWUKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ3JlYXRpbmcgdXNlciAkVXNlck5hbWUgdG8gd2l0aCBwYXNzd29yZCAnJFBhc3N3b3JkJyBpbiBkb21haW4gJERvbWFpbiIKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgIyBjb21taXQgdGhlIHVzZXIKICAgICAgICAgICAgJFVzZXIuU2F2ZSgpCiAgICAgICAgICAgICJbKl0gVXNlciAkVXNlck5hbWUgc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQgaW4gZG9tYWluICREb21haW4iCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAnWyFdIFVzZXIgYWxyZWFkeSBleGlzdHMhJwogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJDcmVhdGluZyB1c2VyICRVc2VyTmFtZSB0byB3aXRoIHBhc3N3b3JkICckUGFzc3dvcmQnIG9uICRDb21wdXRlck5hbWUiCgogICAgICAgICMgaWYgaXQncyBub3QgYSBkb21haW4gYWRkLCBpdCdzIGEgbG9jYWwgbWFjaGluZSBhZGQKICAgICAgICAkT2JqT3UgPSBbQURTSV0iV2luTlQ6Ly8kQ29tcHV0ZXJOYW1lIgogICAgICAgICRPYmpVc2VyID0gJE9iak91LkNyZWF0ZSgnVXNlcicsICRVc2VyTmFtZSkKICAgICAgICAkT2JqVXNlci5TZXRQYXNzd29yZCgkUGFzc3dvcmQpCgogICAgICAgICMgY29tbWl0IHRoZSBjaGFuZ2VzIHRvIHRoZSBsb2NhbCBtYWNoaW5lCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJE51bGwgPSAkT2JqVXNlci5TZXRJbmZvKCkKICAgICAgICAgICAgIlsqXSBVc2VyICRVc2VyTmFtZSBzdWNjZXNzZnVsbHkgY3JlYXRlZCBvbiBob3N0ICRDb21wdXRlck5hbWUiCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAnWyFdIEFjY291bnQgYWxyZWFkeSBleGlzdHMhJwogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICB9CgogICAgIyBpZiBhIGdyb3VwIGlzIHNwZWNpZmllZCwgaW52b2tlIEFkZC1OZXRHcm91cFVzZXIgYW5kIHJldHVybiBpdHMgdmFsdWUKICAgIGlmICgkR3JvdXBOYW1lKSB7CiAgICAgICAgIyBpZiB3ZSdyZSBhZGRpbmcgdGhlIHVzZXIgdG8gYSBkb21haW4KICAgICAgICBpZiAoJERvbWFpbikgewogICAgICAgICAgICBBZGQtTmV0R3JvdXBVc2VyIC1Vc2VyTmFtZSAkVXNlck5hbWUgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbgogICAgICAgICAgICAiWypdIFVzZXIgJFVzZXJOYW1lIHN1Y2Nlc3NmdWxseSBhZGRlZCB0byBncm91cCAkR3JvdXBOYW1lIGluIGRvbWFpbiAkRG9tYWluIgogICAgICAgIH0KICAgICAgICAjIG90aGVyd2lzZSwgd2UncmUgYWRkaW5nIHRvIGEgbG9jYWwgZ3JvdXAKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgQWRkLU5ldEdyb3VwVXNlciAtVXNlck5hbWUgJFVzZXJOYW1lIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgIlsqXSBVc2VyICRVc2VyTmFtZSBzdWNjZXNzZnVsbHkgYWRkZWQgdG8gZ3JvdXAgJEdyb3VwTmFtZSBvbiBob3N0ICRDb21wdXRlck5hbWUiCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gQWRkLU5ldEdyb3VwVXNlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQWRkcyBhIHVzZXIgdG8gYSBkb21haW4gZ3JvdXAgb3IgYSBsb2NhbCBncm91cCBvbiB0aGUgY3VycmVudCAob3IgcmVtb3RlKSBtYWNoaW5lLAogICAgICAgIGlmIHBlcm1pc3Npb25zIGFsbG93LCB1dGlsaXppbmcgdGhlIFdpbk5UIHNlcnZpY2UgcHJvdmlkZXIgYW5kCiAgICAgICAgRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQsIHJlc3BlY3RpdmVseS4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFRoZSBkb21haW4gdXNlcm5hbWUgdG8gcXVlcnkgZm9yLgoKICAgIC5QQVJBTUVURVIgR3JvdXBOYW1lCgogICAgICAgIEdyb3VwIHRvIGFkZCB0aGUgdXNlciB0by4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0bmFtZSB0byBhZGQgdGhlIHVzZXIgdG8sIGRlZmF1bHRzIHRvIGxvY2FsaG9zdC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBEb21haW4gdG8gYWRkIHRoZSB1c2VyIHRvLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gQWRkLU5ldEdyb3VwVXNlciAtVXNlck5hbWUgam9obiAtR3JvdXBOYW1lIEFkbWluaXN0cmF0b3JzCiAgICAgICAgCiAgICAgICAgQWRkcyBhIGxvY2FsdXNlciAiam9obiIgdG8gdGhlIGxvY2FsIGdyb3VwICJBZG1pbmlzdHJhdG9ycyIKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEFkZC1OZXRHcm91cFVzZXIgLVVzZXJOYW1lIGpvaG4gLUdyb3VwTmFtZSAiRG9tYWluIEFkbWlucyIgLURvbWFpbiBkZXYubG9jYWwKICAgICAgICAKICAgICAgICBBZGRzIHRoZSBleGlzdGluZyB1c2VyICJqb2huIiB0byB0aGUgZG9tYWluIGdyb3VwICJEb21haW4gQWRtaW5zIiBpbiAiZGV2LmxvY2FsIgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4KICAgICkKCiAgICAjIGFkZCB0aGUgYXNzZW1ibHkgaWYgd2UgbmVlZCBpdAogICAgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQKCiAgICAjIGlmIHdlJ3JlIGFkZGluZyB0byBhIHJlbW90ZSBob3N0J3MgbG9jYWwgZ3JvdXAsIHVzZSB0aGUgV2luTlQgcHJvdmlkZXIKICAgIGlmKCRDb21wdXRlck5hbWUgLWFuZCAoJENvbXB1dGVyTmFtZSAtbmUgImxvY2FsaG9zdCIpKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWRkaW5nIHVzZXIgJFVzZXJOYW1lIHRvICRHcm91cE5hbWUgb24gaG9zdCAkQ29tcHV0ZXJOYW1lIgogICAgICAgICAgICAoW0FEU0ldIldpbk5UOi8vJENvbXB1dGVyTmFtZS8kR3JvdXBOYW1lLGdyb3VwIikuYWRkKCJXaW5OVDovLyRDb21wdXRlck5hbWUvJFVzZXJOYW1lLHVzZXIiKQogICAgICAgICAgICAiWypdIFVzZXIgJFVzZXJOYW1lIHN1Y2Nlc3NmdWxseSBhZGRlZCB0byBncm91cCAkR3JvdXBOYW1lIG9uICRDb21wdXRlck5hbWUiCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiWyFdIEVycm9yIGFkZGluZyB1c2VyICRVc2VyTmFtZSB0byBncm91cCAkR3JvdXBOYW1lIG9uICRDb21wdXRlck5hbWUiCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgIH0KCiAgICAjIG90aGVyd2lzZSBpdCdzIGEgbG9jYWwgbWFjaGluZSBvciBkb21haW4gYWRkCiAgICBlbHNlIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoJERvbWFpbikgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWRkaW5nIHVzZXIgJFVzZXJOYW1lIHRvICRHcm91cE5hbWUgb24gZG9tYWluICREb21haW4iCiAgICAgICAgICAgICAgICAkQ1QgPSBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LkNvbnRleHRUeXBlXTo6RG9tYWluCiAgICAgICAgICAgICAgICAkRG9tYWluT2JqZWN0ID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4KICAgICAgICAgICAgICAgIGlmKC1ub3QgJERvbWFpbk9iamVjdCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkTnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIyBnZXQgdGhlIGZ1bGwgcHJpbmNpcGFsIGNvbnRleHQKICAgICAgICAgICAgICAgICRDb250ZXh0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlByaW5jaXBhbENvbnRleHQgLUFyZ3VtZW50TGlzdCAkQ1QsICREb21haW5PYmplY3QgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlLCBnZXQgdGhlIGxvY2FsIG1hY2hpbmUgY29udGV4dAogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWRkaW5nIHVzZXIgJFVzZXJOYW1lIHRvICRHcm91cE5hbWUgb24gbG9jYWxob3N0IgogICAgICAgICAgICAgICAgJENvbnRleHQgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5QcmluY2lwYWxDb250ZXh0KFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuQ29udGV4dFR5cGVdOjpNYWNoaW5lLCAkRW52OkNvbXB1dGVyTmFtZSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBmaW5kIHRoZSBwYXJ0aWN1bGFyIGdyb3VwCiAgICAgICAgICAgICRHcm91cCA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuR3JvdXBQcmluY2lwYWxdOjpGaW5kQnlJZGVudGl0eSgkQ29udGV4dCwkR3JvdXBOYW1lKQoKICAgICAgICAgICAgIyBhZGQgdGhlIHBhcnRpY3VsYXIgdXNlciB0byB0aGUgZ3JvdXAKICAgICAgICAgICAgJEdyb3VwLk1lbWJlcnMuYWRkKCRDb250ZXh0LCBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LklkZW50aXR5VHlwZV06OlNhbUFjY291bnROYW1lLCAkVXNlck5hbWUpCgogICAgICAgICAgICAjIGNvbW1pdCB0aGUgY2hhbmdlcwogICAgICAgICAgICAkR3JvdXAuU2F2ZSgpCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3IgYWRkaW5nICRVc2VyTmFtZSB0byAkR3JvdXBOYW1lIDogJF8iCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LVVzZXJQcm9wZXJ0eSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJucyBhIGxpc3Qgb2YgYWxsIHVzZXIgb2JqZWN0IHByb3BlcnRpZXMuIElmIGEgcHJvcGVydHkKICAgICAgICBuYW1lIGlzIHNwZWNpZmllZCwgaXQgcmV0dXJucyBhbGwgW3VzZXI6cHJvcGVydHldIHZhbHVlcy4KCiAgICAgICAgVGFrZW4gZGlyZWN0bHkgZnJvbSBAb2JzY3VyZXNlYydzIHBvc3Q6CiAgICAgICAgICAgIGh0dHA6Ly9vYnNjdXJlc2VjdXJpdHkuYmxvZ3Nwb3QuY29tLzIwMTQvMDQvQURTSVNlYXJjaGVyLmh0bWwKCiAgICAuUEFSQU1FVEVSIFByb3BlcnRpZXMKCiAgICAgICAgUHJvcGVydHkgbmFtZXMgdG8gZXh0cmFjdCBmb3IgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgdXNlciBwcm9wZXJ0aWVzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtVXNlclByb3BlcnR5IC1Eb21haW4gdGVzdGluZwogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIHVzZXIgcHJvcGVydGllcyBmb3IgdXNlcnMgaW4gdGhlICd0ZXN0aW5nJyBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtVXNlclByb3BlcnR5IC1Qcm9wZXJ0aWVzIHNzbixsYXN0bG9nb24sbG9jYXRpb24KICAgICAgICAKICAgICAgICBSZXR1cm5zIGFsbCBhbiBhcnJheSBvZiB1c2VyL3Nzbi9sYXN0bG9naW4vbG9jYXRpb24gY29tYmluYXRpb25zCiAgICAgICAgZm9yIHVzZXJzIGluIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vb2JzY3VyZXNlY3VyaXR5LmJsb2dzcG90LmNvbS8yMDE0LzA0L0FEU0lTZWFyY2hlci5odG1sCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkUHJvcGVydGllcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAogICAgICAgIAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGlmKCRQcm9wZXJ0aWVzKSB7CiAgICAgICAgIyBleHRyYWN0IG91dCB0aGUgc2V0IG9mIGFsbCBwcm9wZXJ0aWVzIGZvciBlYWNoIG9iamVjdAogICAgICAgICRQcm9wZXJ0aWVzID0gLCJuYW1lIiArICRQcm9wZXJ0aWVzCiAgICAgICAgR2V0LU5ldFVzZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSAkUHJvcGVydGllcwogICAgfQogICAgZWxzZSB7CiAgICAgICAgIyBleHRyYWN0IG91dCBqdXN0IHRoZSBwcm9wZXJ0eSBuYW1lcwogICAgICAgIEdldC1OZXRVc2VyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKlByb3BlcnR5IHwgU2VsZWN0LU9iamVjdCAtUHJvcGVydHkgJ05hbWUnCiAgICB9Cn0KCgpmdW5jdGlvbiBGaW5kLVVzZXJGaWVsZCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgU2VhcmNoZXMgdXNlciBvYmplY3QgZmllbGRzIGZvciBhIGdpdmVuIHdvcmQgKGRlZmF1bHQgKnBhc3MqKS4gRGVmYXVsdAogICAgICAgIGZpZWxkIGJlaW5nIHNlYXJjaGVkIGlzICdkZXNjcmlwdGlvbicuCgogICAgICAgIFRha2VuIGRpcmVjdGx5IGZyb20gQG9ic2N1cmVzZWMncyBwb3N0OgogICAgICAgICAgICBodHRwOi8vb2JzY3VyZXNlY3VyaXR5LmJsb2dzcG90LmNvbS8yMDE0LzA0L0FEU0lTZWFyY2hlci5odG1sCgogICAgLlBBUkFNRVRFUiBTZWFyY2hUZXJtCgogICAgICAgIFRlcm0gdG8gc2VhcmNoIGZvciwgZGVmYXVsdCBvZiAicGFzcyIuCgogICAgLlBBUkFNRVRFUiBTZWFyY2hGaWVsZAoKICAgICAgICBVc2VyIGZpZWxkIHRvIHNlYXJjaCwgZGVmYXVsdCBvZiAiZGVzY3JpcHRpb24iLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHNlYXJjaCBjb21wdXRlciBmaWVsZHMgZm9yLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLVVzZXJGaWVsZCAtU2VhcmNoRmllbGQgaW5mbyAtU2VhcmNoVGVybSBiYWNrdXAKCiAgICAgICAgRmluZCB1c2VyIGFjY291bnRzIHdpdGggImJhY2t1cCIgaW4gdGhlICJpbmZvIiBmaWVsZC4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZWFyY2hUZXJtID0gJ3Bhc3MnLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZWFyY2hGaWVsZCA9ICdkZXNjcmlwdGlvbicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgR2V0LU5ldFVzZXIgLUFEU3BhdGggJEFEU3BhdGggLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GaWx0ZXIgIigkU2VhcmNoRmllbGQ9KiRTZWFyY2hUZXJtKikiIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBTZWxlY3QtT2JqZWN0IHNhbWFjY291bnRuYW1lLCRTZWFyY2hGaWVsZAogICAgfQp9CgoKZnVuY3Rpb24gR2V0LVVzZXJFdmVudCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgRHVtcCBhbmQgcGFyc2Ugc2VjdXJpdHkgZXZlbnRzIHJlbGF0aW5nIHRvIGFuIGFjY291bnQgbG9nb24gKElEIDQ2MjQpCiAgICAgICAgb3IgYSBUR1QgcmVxdWVzdCBldmVudCAoSUQgNDc2OCkuIEludGVuZGVkIHRvIGJlIHVzZWQgYW5kIHRlc3RlZCBvbgogICAgICAgIFdpbmRvd3MgMjAwOCBEb21haW4gQ29udHJvbGxlcnMuCiAgICAgICAgQWRtaW4gUmVxZD8gWUVTCgogICAgICAgIEF1dGhvcjogQHNpeGR1YgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBjb21wdXRlciB0byBnZXQgZXZlbnRzIGZyb20uIERlZmF1bHQ6IExvY2FsaG9zdAoKICAgIC5QQVJBTUVURVIgRXZlbnRUeXBlCgogICAgICAgIEVpdGhlciAnbG9nb24nLCAndGd0Jywgb3IgJ2FsbCcuIERlZmF1bHRzOiAnbG9nb24nCgogICAgLlBBUkFNRVRFUiBEYXRlU3RhcnQKCiAgICAgICAgRmlsdGVyIG91dCBhbGwgZXZlbnRzIGJlZm9yZSB0aGlzIGRhdGUuIERlZmF1bHQ6IDUgZGF5cwogICAKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LVVzZXJFdmVudCAtQ29tcHV0ZXJOYW1lIERvbWFpbkNvbnRyb2xsZXIudGVzdGxhYi5sb2NhbAoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly93d3cuc2l4ZHViLm5ldC8yMDE0LzExLzA3L29mZmVuc2l2ZS1ldmVudC1wYXJzaW5nLWJyaW5naW5nLWhvbWUtdHJvcGhpZXMvCiM+CgogICAgUGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJEVudjpDb21wdXRlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJsb2dvbiIsInRndCIsImFsbCIpXQogICAgICAgICRFdmVudFR5cGUgPSAibG9nb24iLAoKICAgICAgICBbRGF0ZVRpbWVdCiAgICAgICAgJERhdGVTdGFydD1bRGF0ZVRpbWVdOjpUb2RheS5BZGREYXlzKC01KQogICAgKQoKICAgIGlmKCRFdmVudFR5cGUuVG9Mb3dlcigpIC1saWtlICJsb2dvbiIpIHsKICAgICAgICBbSW50MzJbXV0kSUQgPSBAKDQ2MjQpCiAgICB9CiAgICBlbHNlaWYoJEV2ZW50VHlwZS5Ub0xvd2VyKCkgLWxpa2UgInRndCIpIHsKICAgICAgICBbSW50MzJbXV0kSUQgPSBAKDQ3NjgpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICBbSW50MzJbXV0kSUQgPSBAKDQ2MjQsIDQ3NjgpCiAgICB9CgogICAgI2dyYWIgYWxsIGV2ZW50cyBtYXRjaGluZyBvdXIgZmlsdGVyIGZvciB0aGUgc3BlY2lmaWVkIGhvc3QKICAgIEdldC1XaW5FdmVudCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUZpbHRlckhhc2hUYWJsZSBAeyBMb2dOYW1lID0gJ1NlY3VyaXR5JzsgSUQ9JElEOyBTdGFydFRpbWU9JERhdGVTdGFydH0gLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgIGlmKCRJRCAtY29udGFpbnMgNDYyNCkgeyAgICAKICAgICAgICAgICAgIyBmaXJzdCBwYXJzZSBhbmQgY2hlY2sgdGhlIGxvZ29uIGV2ZW50IHR5cGUuIFRoaXMgY291bGQgYmUgbGF0ZXIgYWRhcHRlZCBhbmQgdGVzdGVkIGZvciBSRFAgbG9nb25zICh0eXBlIDEwKQogICAgICAgICAgICBpZigkXy5tZXNzYWdlIC1tYXRjaCAnKD9zKSg/PD1Mb2dvbiBUeXBlOikuKj8oPz0oSW1wZXJzb25hdGlvbiBMZXZlbDp8TmV3IExvZ29uOikpJykgewogICAgICAgICAgICAgICAgaWYoJE1hdGNoZXMpIHsKICAgICAgICAgICAgICAgICAgICAkTG9nb25UeXBlID0gJE1hdGNoZXNbMF0udHJpbSgpCiAgICAgICAgICAgICAgICAgICAgJE1hdGNoZXMgPSAkTnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJExvZ29uVHlwZSA9ICIiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgaW50ZXJhY3RpdmUgbG9nb25zIG9yIGRvbWFpbiBsb2dvbnMKICAgICAgICAgICAgaWYgKCgkTG9nb25UeXBlIC1lcSAyKSAtb3IgKCRMb2dvblR5cGUgLWVxIDMpKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICMgcGFyc2UgYW5kIHN0b3JlIHRoZSBhY2NvdW50IHVzZWQgYW5kIHRoZSBhZGRyZXNzIHRoZXkgY2FtZSBmcm9tCiAgICAgICAgICAgICAgICAgICAgaWYoJF8ubWVzc2FnZSAtbWF0Y2ggJyg/cykoPzw9TmV3IExvZ29uOikuKj8oPz1Qcm9jZXNzIEluZm9ybWF0aW9uOiknKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRNYXRjaGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNlck5hbWUgPSAkTWF0Y2hlc1swXS5zcGxpdCgiYG4iKVsyXS5zcGxpdCgiOiIpWzFdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJERvbWFpbiA9ICRNYXRjaGVzWzBdLnNwbGl0KCJgbiIpWzNdLnNwbGl0KCI6IilbMV0udHJpbSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWF0Y2hlcyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoJF8ubWVzc2FnZSAtbWF0Y2ggJyg/cykoPzw9TmV0d29yayBJbmZvcm1hdGlvbjopLio/KD89U291cmNlIFBvcnQ6KScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJE1hdGNoZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBZGRyZXNzID0gJE1hdGNoZXNbMF0uc3BsaXQoImBuIilbMl0uc3BsaXQoIjoiKVsxXS50cmltKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNYXRjaGVzID0gJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyBvbmx5IGFkZCBpZiB0aGVyZSB3YXMgYWNjb3VudCBpbmZvcm1hdGlvbiBub3QgZm9yIGEgbWFjaGluZSBvciBhbm9ueW1vdXMgbG9nb24KICAgICAgICAgICAgICAgICAgICBpZiAoJFVzZXJOYW1lIC1hbmQgKC1ub3QgJFVzZXJOYW1lLmVuZHNXaXRoKCckJykpIC1hbmQgKCRVc2VyTmFtZSAtbmUgJ0FOT05ZTU9VUyBMT0dPTicpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRMb2dvbkV2ZW50UHJvcGVydGllcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRG9tYWluJyA9ICREb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb21wdXRlck5hbWUnID0gJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1VzZXJuYW1lJyA9ICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0FkZHJlc3MnID0gJEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJRCcgPSAnNDYyNCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMb2dvblR5cGUnID0gJExvZ29uVHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RpbWUnID0gJF8uVGltZUNyZWF0ZWQKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdCAtUHJvcGVydHkgJExvZ29uRXZlbnRQcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBwYXJzaW5nIGV2ZW50IGxvZ3M6ICRfIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmKCRJRCAtY29udGFpbnMgNDc2OCkgewogICAgICAgICAgICAjIHRoZSBUR1QgZXZlbnQgdHlwZQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYoJF8ubWVzc2FnZSAtbWF0Y2ggJyg/cykoPzw9QWNjb3VudCBJbmZvcm1hdGlvbjopLio/KD89U2VydmljZSBJbmZvcm1hdGlvbjopJykgewogICAgICAgICAgICAgICAgICAgIGlmKCRNYXRjaGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRVc2VybmFtZSA9ICRNYXRjaGVzWzBdLnNwbGl0KCJgbiIpWzFdLnNwbGl0KCI6IilbMV0udHJpbSgpCiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW4gPSAkTWF0Y2hlc1swXS5zcGxpdCgiYG4iKVsyXS5zcGxpdCgiOiIpWzFdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICAkTWF0Y2hlcyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCRfLm1lc3NhZ2UgLW1hdGNoICcoP3MpKD88PU5ldHdvcmsgSW5mb3JtYXRpb246KS4qPyg/PUFkZGl0aW9uYWwgSW5mb3JtYXRpb246KScpIHsKICAgICAgICAgICAgICAgICAgICBpZigkTWF0Y2hlcykgewogICAgICAgICAgICAgICAgICAgICAgICAkQWRkcmVzcyA9ICRNYXRjaGVzWzBdLnNwbGl0KCJgbiIpWzFdLnNwbGl0KCI6IilbLTFdLnRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICAkTWF0Y2hlcyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRMb2dvbkV2ZW50UHJvcGVydGllcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgJ0RvbWFpbicgPSAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgJ0NvbXB1dGVyTmFtZScgPSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgJ1VzZXJuYW1lJyA9ICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgICdBZGRyZXNzJyA9ICRBZGRyZXNzCiAgICAgICAgICAgICAgICAgICAgJ0lEJyA9ICc0NzY4JwogICAgICAgICAgICAgICAgICAgICdMb2dvblR5cGUnID0gJycKICAgICAgICAgICAgICAgICAgICAnVGltZScgPSAkXy5UaW1lQ3JlYXRlZAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkTG9nb25FdmVudFByb3BlcnRpZXMKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgcGFyc2luZyBldmVudCBsb2dzOiAkXyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1PYmplY3RBY2wgewo8IwogICAgLlNZTk9QU0lTCiAgICAgICAgUmV0dXJucyB0aGUgQUNMcyBhc3NvY2lhdGVkIHdpdGggYSBzcGVjaWZpYyBhY3RpdmUgZGlyZWN0b3J5IG9iamVjdC4KCiAgICAgICAgVGhhbmtzIFNlYW4gTWV0Y2FsZiAoQHB5cm90ZWszKSBmb3IgdGhlIGlkZWEgYW5kIGd1aWRhbmNlLgoKICAgIC5QQVJBTUVURVIgU2FtQWNjb3VudE5hbWUKCiAgICAgICAgT2JqZWN0IG5hbWUgdG8gZmlsdGVyIGZvci4gICAgICAgIAoKICAgIC5QQVJBTUVURVIgTmFtZQoKICAgICAgICBPYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLgoKICAgIC5QQVJBTUVURVIgRGlzdGluZ3Vpc2hlZE5hbWUKCiAgICAgICAgT2JqZWN0IGRpc3Rpbmd1aXNoZWQgbmFtZSB0byBmaWx0ZXIgZm9yLgoKICAgIC5QQVJBTUVURVIgUmVzb2x2ZUdVSURzCgogICAgICAgIFN3aXRjaC4gUmVzb2x2ZSBHVUlEcyB0byB0aGVpciBkaXNwbGF5IG5hbWVzLgoKICAgIC5QQVJBTUVURVIgRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCiAgICAgCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgQURTcHJlZml4CgogICAgICAgIFByZWZpeCB0byBzZXQgZm9yIHRoZSBzZWFyY2hlciAobGlrZSAiQ049U2l0ZXMsQ049Q29uZmlndXJhdGlvbiIpCgogICAgLlBBUkFNRVRFUiBSaWdodHNGaWx0ZXIKCiAgICAgICAgT25seSByZXR1cm4gcmVzdWx0cyB3aXRoIHRoZSBhc3NvY2lhdGVkIHJpZ2h0cywgIkFsbCIsICJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gdXNlIGZvciB0aGUgcXVlcnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1PYmplY3RBY2wgLVNhbUFjY291bnROYW1lIG1hdHQuYWRtaW4gLWRvbWFpbiB0ZXN0bGFiLmxvY2FsCiAgICAgICAgCiAgICAgICAgR2V0IHRoZSBBQ0xzIGZvciB0aGUgbWF0dC5hZG1pbiB1c2VyIGluIHRoZSB0ZXN0bGFiLmxvY2FsIGRvbWFpbgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU9iamVjdEFjbCAtU2FtQWNjb3VudE5hbWUgbWF0dC5hZG1pbiAtZG9tYWluIHRlc3RsYWIubG9jYWwgLVJlc29sdmVHVUlEcwogICAgICAgIAogICAgICAgIEdldCB0aGUgQUNMcyBmb3IgdGhlIG1hdHQuYWRtaW4gdXNlciBpbiB0aGUgdGVzdGxhYi5sb2NhbCBkb21haW4gYW5kCiAgICAgICAgcmVzb2x2ZSByZWxldmFudCBHVUlEcyB0byB0aGVpciBkaXNwbGF5IG5hbWVzLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE5hbWUgPSAiKiIsCgogICAgICAgIFtBbGlhcygnRE4nKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREaXN0aW5ndWlzaGVkTmFtZSA9ICIqIiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVzb2x2ZUdVSURzLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3ByZWZpeCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIkFsbCIsIlJlc2V0UGFzc3dvcmQiLCJXcml0ZU1lbWJlcnMiKV0KICAgICAgICAkUmlnaHRzRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAkU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1BRFNwcmVmaXggJEFEU3ByZWZpeCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgICMgZ2V0IGEgR1VJRCAtPiBuYW1lIG1hcHBpbmcKICAgICAgICBpZigkUmVzb2x2ZUdVSURzKSB7CiAgICAgICAgICAgICRHVUlEcyA9IEdldC1HVUlETWFwIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgfQogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICBpZiAoJFNlYXJjaGVyKSB7CgogICAgICAgICAgICBpZigkU2FtQWNjb3VudE5hbWUpIHsKICAgICAgICAgICAgICAgICRTZWFyY2hlci5maWx0ZXI9IigmKHNhbWFjY291bnRuYW1lPSRTYW1BY2NvdW50TmFtZSkobmFtZT0kTmFtZSkoZGlzdGluZ3Vpc2hlZG5hbWU9JERpc3Rpbmd1aXNoZWROYW1lKSRGaWx0ZXIpIiAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkU2VhcmNoZXIuZmlsdGVyPSIoJihuYW1lPSROYW1lKShkaXN0aW5ndWlzaGVkbmFtZT0kRGlzdGluZ3Vpc2hlZE5hbWUpJEZpbHRlcikiICAKICAgICAgICAgICAgfQogIAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJFNlYXJjaGVyLkZpbmRBbGwoKSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRPYmplY3QgPSBbYWRzaV0oJF8ucGF0aCkKICAgICAgICAgICAgICAgICAgICBpZigkT2JqZWN0LmRpc3Rpbmd1aXNoZWRuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3MgPSAkT2JqZWN0LlBzQmFzZS5PYmplY3RTZWN1cml0eS5hY2Nlc3MKICAgICAgICAgICAgICAgICAgICAgICAgJEFjY2VzcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgJ09iamVjdEROJyAoJE9iamVjdC5kaXN0aW5ndWlzaGVkbmFtZVswXSkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkT2JqZWN0Lm9iamVjdHNpZFswXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFMgPSAoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkT2JqZWN0Lm9iamVjdHNpZFswXSwwKSkuVmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTID0gJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8gfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSAnT2JqZWN0U0lEJyAkUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYoJFJpZ2h0c0ZpbHRlcikgewogICAgICAgICAgICAgICAgICAgICAgICAkR3VpZEZpbHRlciA9IFN3aXRjaCAoJFJpZ2h0c0ZpbHRlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJlc2V0UGFzc3dvcmQiIHsgIjAwMjk5NTcwLTI0NmQtMTFkMC1hNzY4LTAwYWEwMDZlMDUyOSIgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIldyaXRlTWVtYmVycyIgeyAiYmY5Njc5YzAtMGRlNi0xMWQwLWEyODUtMDBhYTAwMzA0OWUyIiB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0IHsgIjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCJ9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoJF8uT2JqZWN0VHlwZSAtZXEgJEd1aWRGaWx0ZXIpIHsgJF8gfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJF8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmKCRHVUlEcykgewogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIHJlc29sdmluZyBHVUlEcywgbWFwIHRoZW0gdGhlbSB0byB0aGUgcmVzb2x2ZWQgaGFzaCB0YWJsZQogICAgICAgICAgICAgICAgICAgICAgICAkQWNsUHJvcGVydGllcyA9IEB7fQogICAgICAgICAgICAgICAgICAgICAgICAkXy5wc29iamVjdC5wcm9wZXJ0aWVzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICgkXy5OYW1lIC1lcSAnT2JqZWN0VHlwZScpIC1vciAoJF8uTmFtZSAtZXEgJ0luaGVyaXRlZE9iamVjdFR5cGUnKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNsUHJvcGVydGllc1skXy5OYW1lXSA9ICRHVUlEU1skXy5WYWx1ZS50b1N0cmluZygpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBY2xQcm9wZXJ0aWVzWyRfLk5hbWVdID0gJF8uVmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNsUHJvcGVydGllc1skXy5OYW1lXSA9ICRfLlZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5ICRBY2xQcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgeyAkXyB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAkXwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gQWRkLU9iamVjdEFjbCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgQWRkcyBhbiBBQ0wgZm9yIGEgc3BlY2lmaWMgYWN0aXZlIGRpcmVjdG9yeSBvYmplY3QuCiAgICAgICAgCiAgICAgICAgQWRtaW5TREhvbGRlciBBQ0wgYXBwcm9hY2ggZnJvbSBTZWFuIE1ldGNhbGYgKEBweXJvdGVrMykKICAgICAgICAgICAgaHR0cHM6Ly9hZHNlY3VyaXR5Lm9yZy8/cD0xOTA2CgogICAgICAgIEFDRSBzZXR0aW5nIG1ldGhvZCBhZGFwdGVkIGZyb20gaHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL0ZvcnVtcy93aW5kb3dzc2VydmVyL2VuLVVTL2RmM2JmZDMzLWMwNzAtNGE5Yy1iZTk4LWM0ZGE2ZTU5MWEwYS9mb3J1bS1mYXEtdXNpbmctcG93ZXJzaGVsbC10by1hc3NpZ24tcGVybWlzc2lvbnMtb24tYWN0aXZlLWRpcmVjdG9yeS1vYmplY3RzLgoKICAgICAgICAnUmVzZXRQYXNzd29yZCcgZG9lc24ndCBuZWVkIHRvIGtub3cgdGhlIHVzZXIncyBjdXJyZW50IHBhc3N3b3JkCiAgICAgICAgJ1dyaXRlTWVtYmVycycgYWxsb3dzIGZvciB0aGUgbW9kaWZpY2F0aW9uIG9mIGdyb3VwIG1lbWJlcnNoaXAKCiAgICAuUEFSQU1FVEVSIFRhcmdldFNhbUFjY291bnROYW1lCgogICAgICAgIFRhcmdldCBvYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLiAgICAgICAgCgogICAgLlBBUkFNRVRFUiBUYXJnZXROYW1lCgogICAgICAgIFRhcmdldCBvYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0RGlzdGluZ3Vpc2hlZE5hbWUKCiAgICAgICAgVGFyZ2V0IG9iamVjdCBkaXN0aW5ndWlzaGVkIG5hbWUgdG8gZmlsdGVyIGZvci4KCiAgICAuUEFSQU1FVEVSIFRhcmdldEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSB0byBmaW5kIGEgdGFyZ2V0LCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBUYXJnZXRBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSBmb3IgdGhlIHRhcmdldCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0QURTcHJlZml4CgogICAgICAgIFByZWZpeCB0byBzZXQgZm9yIHRoZSB0YXJnZXQgc2VhcmNoZXIgKGxpa2UgIkNOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iKQoKICAgIC5QQVJBTUVURVIgUHJpbmNpcGFsU0lECgogICAgICAgIFRoZSBTSUQgb2YgdGhlIHByaW5jaXBhbCBvYmplY3QgdG8gYWRkIGZvciBhY2Nlc3MuCgogICAgLlBBUkFNRVRFUiBQcmluY2lwYWxOYW1lCgogICAgICAgIFRoZSBuYW1lIG9mIHRoZSBwcmluY2lwYWwgb2JqZWN0IHRvIGFkZCBmb3IgYWNjZXNzLgoKICAgIC5QQVJBTUVURVIgUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUKCiAgICAgICAgVGhlIHNhbUFjY291bnROYW1lIG9mIHRoZSBwcmluY2lwYWwgb2JqZWN0IHRvIGFkZCBmb3IgYWNjZXNzLgoKICAgIC5QQVJBTUVURVIgUmlnaHRzCgogICAgICAgIFJpZ2h0cyB0byBhZGQgZm9yIHRoZSBwcmluY2lwYWwsICJBbGwiLCJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIiwiRENTeW5jIgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gdXNlIGZvciB0aGUgdGFyZ2V0IHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgQWRkLU9iamVjdEFjbCAtVGFyZ2V0U2FtQWNjb3VudE5hbWUgbWF0dCAtUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUgam9obgoKICAgICAgICBHcmFudHMgJ2pvaG4nIGFsbCBmdWxsIGFjY2VzcyByaWdodHMgdG8gdGhlICdtYXR0JyBhY2NvdW50LgoKICAgIC5FWEFNUExFCgogICAgICAgIEFkZC1PYmplY3RBY2wgLVRhcmdldFNhbUFjY291bnROYW1lIG1hdHQgLVByaW5jaXBhbFNhbUFjY291bnROYW1lIGpvaG4gLVJpZ2h0cyBSZXNldFBhc3N3b3JkCgogICAgICAgIEdyYW50cyAnam9obicgdGhlIHJpZ2h0IHRvIHJlc2V0IHRoZSBwYXNzd29yZCBmb3IgdGhlICdtYXR0JyBhY2NvdW50LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHBzOi8vYWRzZWN1cml0eS5vcmcvP3A9MTkwNgogICAgICAgIAogICAgICAgIGh0dHBzOi8vc29jaWFsLnRlY2huZXQubWljcm9zb2Z0LmNvbS9Gb3J1bXMvd2luZG93c3NlcnZlci9lbi1VUy9kZjNiZmQzMy1jMDcwLTRhOWMtYmU5OC1jNGRhNmU1OTFhMGEvZm9ydW0tZmFxLXVzaW5nLXBvd2Vyc2hlbGwtdG8tYXNzaWduLXBlcm1pc3Npb25zLW9uLWFjdGl2ZS1kaXJlY3Rvcnktb2JqZWN0cz9mb3J1bT13aW5zZXJ2ZXJwb3dlcnNoZWxsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGFyZ2V0TmFtZSA9ICIqIiwKCiAgICAgICAgW0FsaWFzKCdETicpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldERpc3Rpbmd1aXNoZWROYW1lID0gIioiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldEFEU3ByZWZpeCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVQYXR0ZXJuKCdeUy0xLTUtMjEtWzAtOV0rLVswLTldKy1bMC05XSstWzAtOV0rJyldCiAgICAgICAgJFByaW5jaXBhbFNJRCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHJpbmNpcGFsTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJBbGwiLCJSZXNldFBhc3N3b3JkIiwiV3JpdGVNZW1iZXJzIiwiRENTeW5jIildCiAgICAgICAgJFJpZ2h0cyA9ICJBbGwiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRSaWdodHNHVUlELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAkU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRUYXJnZXRBRFNwYXRoIC1BRFNwcmVmaXggJFRhcmdldEFEU3ByZWZpeCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgIGlmKCEkUHJpbmNpcGFsU0lEKSB7CiAgICAgICAgICAgICRQcmluY2lwYWwgPSBHZXQtQURPYmplY3QgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1OYW1lICRQcmluY2lwYWxOYW1lIC1TYW1BY2NvdW50TmFtZSAkUHJpbmNpcGFsU2FtQWNjb3VudE5hbWUgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAKICAgICAgICAgICAgaWYoISRQcmluY2lwYWwpIHsKICAgICAgICAgICAgICAgIHRocm93ICJFcnJvciByZXNvbHZpbmcgcHJpbmNpcGFsIgogICAgICAgICAgICB9CiAgICAgICAgICAgICRQcmluY2lwYWxTSUQgPSAkUHJpbmNpcGFsLm9iamVjdHNpZAogICAgICAgIH0KICAgICAgICBpZighJFByaW5jaXBhbFNJRCkgewogICAgICAgICAgICB0aHJvdyAiRXJyb3IgcmVzb2x2aW5nIHByaW5jaXBhbCIKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmICgkU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmKCRUYXJnZXRTYW1BY2NvdW50TmFtZSkgewogICAgICAgICAgICAgICAgJFNlYXJjaGVyLmZpbHRlcj0iKCYoc2FtYWNjb3VudG5hbWU9JFRhcmdldFNhbUFjY291bnROYW1lKShuYW1lPSRUYXJnZXROYW1lKShkaXN0aW5ndWlzaGVkbmFtZT0kVGFyZ2V0RGlzdGluZ3Vpc2hlZE5hbWUpJFRhcmdldEZpbHRlcikiICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRTZWFyY2hlci5maWx0ZXI9IigmKG5hbWU9JFRhcmdldE5hbWUpKGRpc3Rpbmd1aXNoZWRuYW1lPSRUYXJnZXREaXN0aW5ndWlzaGVkTmFtZSkkVGFyZ2V0RmlsdGVyKSIgIAogICAgICAgICAgICB9CiAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkU2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgIyBhZGFwdGVkIGZyb20gaHR0cHM6Ly9zb2NpYWwudGVjaG5ldC5taWNyb3NvZnQuY29tL0ZvcnVtcy93aW5kb3dzc2VydmVyL2VuLVVTL2RmM2JmZDMzLWMwNzAtNGE5Yy1iZTk4LWM0ZGE2ZTU5MWEwYS9mb3J1bS1mYXEtdXNpbmctcG93ZXJzaGVsbC10by1hc3NpZ24tcGVybWlzc2lvbnMtb24tYWN0aXZlLWRpcmVjdG9yeS1vYmplY3RzCgogICAgICAgICAgICAgICAgICAgICRUYXJnZXRETiA9ICRfLlByb3BlcnRpZXMuZGlzdGluZ3Vpc2hlZG5hbWUKCiAgICAgICAgICAgICAgICAgICAgJElkZW50aXR5ID0gW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuSWRlbnRpdHlSZWZlcmVuY2VdIChbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdJFByaW5jaXBhbFNJRCkKICAgICAgICAgICAgICAgICAgICAkSW5oZXJpdGFuY2VUeXBlID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnlTZWN1cml0eUluaGVyaXRhbmNlXSAiTm9uZSIKICAgICAgICAgICAgICAgICAgICAkQ29udHJvbFR5cGUgPSBbU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuQWNjZXNzQ29udHJvbFR5cGVdICJBbGxvdyIKICAgICAgICAgICAgICAgICAgICAkQUNFcyA9IEAoKQoKICAgICAgICAgICAgICAgICAgICBpZigkUmlnaHRzR1VJRCkgewogICAgICAgICAgICAgICAgICAgICAgICAkR1VJRHMgPSBAKCRSaWdodHNHVUlEKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEdVSURzID0gU3dpdGNoICgkUmlnaHRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFJlc2V0UGFzc3dvcmQgZG9lc24ndCBuZWVkIHRvIGtub3cgdGhlIHVzZXIncyBjdXJyZW50IHBhc3N3b3JkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUmVzZXRQYXNzd29yZCIgeyAiMDAyOTk1NzAtMjQ2ZC0xMWQwLWE3NjgtMDBhYTAwNmUwNTI5IiB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFsbG93cyBmb3IgdGhlIG1vZGlmaWNhdGlvbiBvZiBncm91cCBtZW1iZXJzaGlwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiV3JpdGVNZW1iZXJzIiB7ICJiZjk2NzljMC0wZGU2LTExZDAtYTI4NS0wMGFhMDAzMDQ5ZTIiIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgJ0RTLVJlcGxpY2F0aW9uLUdldC1DaGFuZ2VzJyA9IDExMzFmNmFhLTljMDctMTFkMS1mNzlmLTAwYzA0ZmMyZGNkMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAnRFMtUmVwbGljYXRpb24tR2V0LUNoYW5nZXMtQWxsJyA9IDExMzFmNmFkLTljMDctMTFkMS1mNzlmLTAwYzA0ZmMyZGNkMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAnRFMtUmVwbGljYXRpb24tR2V0LUNoYW5nZXMtSW4tRmlsdGVyZWQtU2V0JyA9IDg5ZTk1Yjc2LTQ0NGQtNGM2Mi05OTFhLTBmYWNiZWRhNjQwYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAgIHdoZW4gYXBwbGllZCB0byBhIGRvbWFpbidzIEFDTCwgYWxsb3dzIGZvciB0aGUgdXNlIG9mIERDU3luYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkRDU3luYyIgeyAiMTEzMWY2YWEtOWMwNy0xMWQxLWY3OWYtMDBjMDRmYzJkY2QyIiwgIjExMzFmNmFkLTljMDctMTFkMS1mNzlmLTAwYzA0ZmMyZGNkMiIsICI4OWU5NWI3Ni00NDRkLTRjNjItOTkxYS0wZmFjYmVkYTY0MGMifQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZigkR1VJRHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkR1VJRCBpbiAkR1VJRHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICROZXdHVUlEID0gTmV3LU9iamVjdCBHdWlkICRHVUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQURSaWdodHMgPSBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeVJpZ2h0c10gIkV4dGVuZGVkUmlnaHQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQUNFcyArPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnlBY2Nlc3NSdWxlICRJZGVudGl0eSwkQURSaWdodHMsJENvbnRyb2xUeXBlLCROZXdHVUlELCRJbmhlcml0YW5jZVR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBkZWF1bHQgdG8gR2VuZXJpY0FsbCByaWdodHMKICAgICAgICAgICAgICAgICAgICAgICAgJEFEUmlnaHRzID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnlSaWdodHNdICJHZW5lcmljQWxsIgogICAgICAgICAgICAgICAgICAgICAgICAkQUNFcyArPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnlBY2Nlc3NSdWxlICRJZGVudGl0eSwkQURSaWdodHMsJENvbnRyb2xUeXBlLCRJbmhlcml0YW5jZVR5cGUKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkdyYW50aW5nIHByaW5jaXBhbCAkUHJpbmNpcGFsU0lEICckUmlnaHRzJyBvbiAkKCRfLlByb3BlcnRpZXMuZGlzdGluZ3Vpc2hlZG5hbWUpIgoKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGFkZCBhbGwgdGhlIG5ldyBBQ0VzIHRvIHRoZSBzcGVjaWZpZWQgb2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgIEZvckVhY2ggKCRBQ0UgaW4gJEFDRXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkdyYW50aW5nIHByaW5jaXBhbCAkUHJpbmNpcGFsU0lEICckKCRBQ0UuT2JqZWN0VHlwZSknIHJpZ2h0cyBvbiAkKCRfLlByb3BlcnRpZXMuZGlzdGluZ3Vpc2hlZG5hbWUpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE9iamVjdCA9IFthZHNpXSgkXy5wYXRoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE9iamVjdC5Qc0Jhc2UuT2JqZWN0U2VjdXJpdHkuQWRkQWNjZXNzUnVsZSgkQUNFKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE9iamVjdC5Qc0Jhc2UuY29tbWl0Y2hhbmdlcygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBncmFudGluZyBwcmluY2lwYWwgJFByaW5jaXBhbFNJRCAnJFJpZ2h0cycgb24gJFRhcmdldEROIDogJF8iCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1BQ0xTY2FubmVyIHsKPCMKICAgIC5TWU5PUFNJUwogICAgICAgIFNlYXJjaGVzIGZvciBBQ0xzIGZvciBzcGVjaWZhYmxlIEFEIG9iamVjdHMgKGRlZmF1bHQgdG8gYWxsIGRvbWFpbiBvYmplY3RzKQogICAgICAgIHdpdGggYSBkb21haW4gc2lkIG9mID4gLTEwMDAsIGFuZCBoYXZlIG1vZGlmaWFibGUgcmlnaHRzLgoKICAgICAgICBUaGFua3MgU2VhbiBNZXRjYWxmIChAcHlyb3RlazMpIGZvciB0aGUgaWRlYSBhbmQgZ3VpZGFuY2UuCgogICAgLlBBUkFNRVRFUiBTYW1BY2NvdW50TmFtZQoKICAgICAgICBPYmplY3QgbmFtZSB0byBmaWx0ZXIgZm9yLiAgICAgICAgCgogICAgLlBBUkFNRVRFUiBOYW1lCgogICAgICAgIE9iamVjdCBuYW1lIHRvIGZpbHRlciBmb3IuCgogICAgLlBBUkFNRVRFUiBEaXN0aW5ndWlzaGVkTmFtZQoKICAgICAgICBPYmplY3QgZGlzdGluZ3Vpc2hlZCBuYW1lIHRvIGZpbHRlciBmb3IuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKICAgICAKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBBRFNwcmVmaXgKCiAgICAgICAgUHJlZml4IHRvIHNldCBmb3IgdGhlIHNlYXJjaGVyIChsaWtlICJDTj1TaXRlcyxDTj1Db25maWd1cmF0aW9uIikKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHVzZSBmb3IgdGhlIHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBSZXNvbHZlR1VJRHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIEdVSURzIHRvIHRoZWlyIGRpc3BsYXkgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtQUNMU2Nhbm5lciAtUmVzb2x2ZUdVSURzIHwgRXhwb3J0LUNTViAtTm9UeXBlSW5mb3JtYXRpb24gYWNscy5jc3YKCiAgICAgICAgRW51bWVyYXRlIGFsbCBtb2RpZmFibGUgQUNMcyBpbiB0aGUgY3VycmVudCBkb21haW4sIHJlc29sdmluZyBHVUlEcyB0byBkaXNwbGF5IAogICAgICAgIG5hbWVzLCBhbmQgZXhwb3J0IGV2ZXJ5dGhpbmcgdG8gYSAuY3N2CiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTmFtZSA9ICIqIiwKCiAgICAgICAgW0FsaWFzKCdETicpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERpc3Rpbmd1aXNoZWROYW1lID0gIioiLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3ByZWZpeCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXNvbHZlR1VJRHMsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgICMgR2V0IGFsbCBkb21haW4gQUNMcyB3aXRoIHRoZSBhcHByb3ByaWF0ZSBwYXJhbWV0ZXJzCiAgICBHZXQtT2JqZWN0QUNMIEBQU0JvdW5kUGFyYW1ldGVycyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAjIGFkZCBpbiB0aGUgdHJhbnNsYXRlZCBTSUQgZm9yIHRoZSBvYmplY3QgaWRlbnRpdHkKICAgICAgICAkXyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJZGVudGl0eVNJRCcgKCRfLklkZW50aXR5UmVmZXJlbmNlLlRyYW5zbGF0ZShbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5TZWN1cml0eUlkZW50aWZpZXJdKS5WYWx1ZSkKICAgICAgICAkXwogICAgfSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgIyBjaGVjayBmb3IgYW55IEFDTHMgd2l0aCBTSURzID4gLTEwMDAKICAgICAgICB0cnkgewogICAgICAgICAgICBbaW50XSgkXy5JZGVudGl0eVNpZC5zcGxpdCgiLSIpWy0xXSkgLWdlIDEwMDAKICAgICAgICB9CiAgICAgICAgY2F0Y2gge30KICAgIH0gfCBXaGVyZS1PYmplY3QgewogICAgICAgICMgZmlsdGVyIGZvciBtb2RpZmlhYmxlIHJpZ2h0cwogICAgICAgICgkXy5BY3RpdmVEaXJlY3RvcnlSaWdodHMgLWVxICJHZW5lcmljQWxsIikgLW9yICgkXy5BY3RpdmVEaXJlY3RvcnlSaWdodHMgLW1hdGNoICJXcml0ZSIpIC1vciAoJF8uQWN0aXZlRGlyZWN0b3J5UmlnaHRzIC1tYXRjaCAiQ3JlYXRlIikgLW9yICgkXy5BY3RpdmVEaXJlY3RvcnlSaWdodHMgLW1hdGNoICJEZWxldGUiKSAtb3IgKCgkXy5BY3RpdmVEaXJlY3RvcnlSaWdodHMgLW1hdGNoICJFeHRlbmRlZFJpZ2h0IikgLWFuZCAoJF8uQWNjZXNzQ29udHJvbFR5cGUgLWVxICJBbGxvdyIpKQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LUdVSURNYXAgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEhlbHBlciB0byBidWlsZCBhIGhhc2ggdGFibGUgb2YgW0dVSURdIC0+IHJlc29sdmVkIG5hbWVzCgogICAgICAgIEhlYXZpbHkgYWRhcHRlZCBmcm9tIGh0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL2FzaGxleW1jZ2xvbmUvYXJjaGl2ZS8yMDEzLzAzLzI1L2FjdGl2ZS1kaXJlY3Rvcnktb3UtcGVybWlzc2lvbnMtcmVwb3J0LWZyZWUtcG93ZXJzaGVsbC1zY3JpcHQtZG93bmxvYWQuYXNweAoKICAgIC5QQVJBTUVURVIgRG9tYWluCiAgICAKICAgICAgICBUaGUgZG9tYWluIHRvIHVzZSBmb3IgdGhlIHF1ZXJ5LCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCiAgICAKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL2FzaGxleW1jZ2xvbmUvYXJjaGl2ZS8yMDEzLzAzLzI1L2FjdGl2ZS1kaXJlY3Rvcnktb3UtcGVybWlzc2lvbnMtcmVwb3J0LWZyZWUtcG93ZXJzaGVsbC1zY3JpcHQtZG93bmxvYWQuYXNweAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICAkR1VJRHMgPSBAeycwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnID0gJ0FsbCd9CgogICAgJFNjaGVtYVBhdGggPSAoR2V0LU5ldEZvcmVzdCkuc2NoZW1hLm5hbWUKCiAgICAkU2NoZW1hU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLUFEU3BhdGggJFNjaGVtYVBhdGggLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgaWYoJFNjaGVtYVNlYXJjaGVyKSB7CiAgICAgICAgJFNjaGVtYVNlYXJjaGVyLmZpbHRlciA9ICIoc2NoZW1hSURHVUlEPSopIgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRTY2hlbWFTZWFyY2hlci5GaW5kQWxsKCkgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICMgY29udmVydCB0aGUgR1VJRAogICAgICAgICAgICAgICAgJEdVSURzWyhOZXctT2JqZWN0IEd1aWQgKCwkXy5wcm9wZXJ0aWVzLnNjaGVtYWlkZ3VpZFswXSkpLkd1aWRdID0gJF8ucHJvcGVydGllcy5uYW1lWzBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgaW4gYnVpbGRpbmcgR1VJRCBtYXA6ICRfIgogICAgICAgIH0gICAgICAKICAgIH0KCiAgICAkUmlnaHRzU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLUFEU3BhdGggJFNjaGVtYVBhdGgucmVwbGFjZSgiU2NoZW1hIiwiRXh0ZW5kZWQtUmlnaHRzIikgLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgaWYgKCRSaWdodHNTZWFyY2hlcikgewogICAgICAgICRSaWdodHNTZWFyY2hlci5maWx0ZXIgPSAiKG9iamVjdENsYXNzPWNvbnRyb2xBY2Nlc3NSaWdodCkiCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJFJpZ2h0c1NlYXJjaGVyLkZpbmRBbGwoKSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgIyBjb252ZXJ0IHRoZSBHVUlECiAgICAgICAgICAgICAgICAkR1VJRHNbJF8ucHJvcGVydGllcy5yaWdodHNndWlkWzBdLnRvU3RyaW5nKCldID0gJF8ucHJvcGVydGllcy5uYW1lWzBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgaW4gYnVpbGRpbmcgR1VJRCBtYXA6ICRfIgogICAgICAgIH0KICAgIH0KCiAgICAkR1VJRHMKfQoKCmZ1bmN0aW9uIEdldC1OZXRDb21wdXRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB1dGlsaXplcyBhZHNpc2VhcmNoZXIgdG8gcXVlcnkgdGhlIGN1cnJlbnQgQUQgY29udGV4dAogICAgICAgIGZvciBjdXJyZW50IGNvbXB1dGVyIG9iamVjdHMuIEJhc2VkIG9mZiBvZiBDYXJsb3MgUGVyZXoncyBBdWRpdC5wc20xCiAgICAgICAgc2NyaXB0IGluIFBvc2gtU2VjTW9kIChsaW5rIGJlbG93KS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBuYW1lLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBTUE4KCiAgICAgICAgUmV0dXJuIGNvbXB1dGVycyB3aXRoIGEgc3BlY2lmaWMgc2VydmljZSBwcmluY2lwYWwgbmFtZSwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgT3BlcmF0aW5nU3lzdGVtCgogICAgICAgIFJldHVybiBjb21wdXRlcnMgd2l0aCBhIHNwZWNpZmljIG9wZXJhdGluZyBzeXN0ZW0sIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIFNlcnZpY2VQYWNrCgogICAgICAgIFJldHVybiBjb21wdXRlcnMgd2l0aCBhIHNwZWNpZmljIHNlcnZpY2UgcGFjaywgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBQcmludGVycwoKICAgICAgICBTd2l0Y2guIFJldHVybiBvbmx5IHByaW50ZXJzLgoKICAgIC5QQVJBTUVURVIgUGluZwoKICAgICAgICBTd2l0Y2guIFBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgY29tcHV0ZXIgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3Qgc3lzdGVtIG5hbWVzICh0aGUgZGVmYXVsdCkuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgY29tcHV0ZXJzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIFVuY29uc3RyYWluZWQKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gY29tcHV0ZXIgb2JqZWN0cyB0aGF0IGhhdmUgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldENvbXB1dGVyCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBjb21wdXRlcnMgaW4gY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIgLVNQTiBtc3NxbCoKICAgICAgICAKICAgICAgICBSZXR1cm5zIGFsbCBNUyBTUUwgc2VydmVycyBvbiB0aGUgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldENvbXB1dGVyIC1Eb21haW4gdGVzdGluZwogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgY29tcHV0ZXJzIGluICd0ZXN0aW5nJyBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiB0ZXN0aW5nIC1GdWxsRGF0YQogICAgICAgIAogICAgICAgIFJldHVybnMgZnVsbCBjb21wdXRlciBvYmplY3RzIGluIHRoZSAndGVzdGluZycgZG9tYWluLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrb3BlcmF0b3IvUG9zaC1TZWNNb2QvYmxvYi9tYXN0ZXIvQXVkaXQvQXVkaXQucHNtMQojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU1BOLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRPcGVyYXRpbmdTeXN0ZW0sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlcnZpY2VQYWNrLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFByaW50ZXJzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRQaW5nLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVbmNvbnN0cmFpbmVkLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgIyBzbyB0aGlzIGlzbid0IHJlcGVhdGVkIGlmIHVzZXJzIGFyZSBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAgICAgJENvbXBTZWFyY2hlciA9IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJEFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICBpZiAoJENvbXBTZWFyY2hlcikgewoKICAgICAgICAgICAgIyBpZiB3ZSdyZSBjaGVja2luZyBmb3IgdW5jb25zdHJhaW5lZCBkZWxlZ2F0aW9uCiAgICAgICAgICAgIGlmKCRVbmNvbnN0cmFpbmVkKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZWFyY2hpbmcgZm9yIGNvbXB1dGVycyB3aXRoIGZvciB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24iCiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIodXNlckFjY291bnRDb250cm9sOjEuMi44NDAuMTEzNTU2LjEuNC44MDM6PTUyNDI4OCkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgIyBzZXQgdGhlIGZpbHRlcnMgZm9yIHRoZSBzZXJhY2hlciBpZiBpdCBleGlzdHMKICAgICAgICAgICAgaWYoJFByaW50ZXJzKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZWFyY2hpbmcgZm9yIHByaW50ZXJzIgogICAgICAgICAgICAgICAgIyAkQ29tcFNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9cHJpbnRRdWV1ZSkkRmlsdGVyKSIKICAgICAgICAgICAgICAgICRGaWx0ZXIgKz0gIihvYmplY3RDYXRlZ29yeT1wcmludFF1ZXVlKSIKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkU1BOKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZWFyY2hpbmcgZm9yIGNvbXB1dGVycyB3aXRoIFNQTjogJFNQTiIKICAgICAgICAgICAgICAgICRGaWx0ZXIgKz0gIihzZXJ2aWNlUHJpbmNpcGFsTmFtZT0kU1BOKSIKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkT3BlcmF0aW5nU3lzdGVtKSB7CiAgICAgICAgICAgICAgICAkRmlsdGVyICs9ICIob3BlcmF0aW5nc3lzdGVtPSRPcGVyYXRpbmdTeXN0ZW0pIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRTZXJ2aWNlUGFjaykgewogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKG9wZXJhdGluZ3N5c3RlbXNlcnZpY2VwYWNrPSRTZXJ2aWNlUGFjaykiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRDb21wU2VhcmNoZXIuZmlsdGVyID0gIigmKHNBTUFjY291bnRUeXBlPTgwNTMwNjM2OSkoZG5zaG9zdG5hbWU9JENvbXB1dGVyTmFtZSkkRmlsdGVyKSIKCiAgICAgICAgICAgIHRyeSB7CgogICAgICAgICAgICAgICAgJENvbXBTZWFyY2hlci5GaW5kQWxsKCkgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAkVXAgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgIGlmKCRQaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgVE9ETzogaG93IGNhbiB0aGVzZSByZXN1bHRzIGJlIHBpcGVkIHRvIHBpbmcgZm9yIGEgc3BlZWR1cD8KICAgICAgICAgICAgICAgICAgICAgICAgJFVwID0gVGVzdC1Db25uZWN0aW9uIC1Db3VudCAxIC1RdWlldCAtQ29tcHV0ZXJOYW1lICRfLnByb3BlcnRpZXMuZG5zaG9zdG5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgcmV0dXJuIGZ1bGwgZGF0YSBvYmplY3RzCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkRnVsbERhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY29udmVydC9wcm9jZXNzIHRoZSBMREFQIGZpZWxkcyBmb3IgZWFjaCByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIHdlJ3JlIGp1c3QgcmV0dXJuaW5nIHRoZSBETlMgaG9zdCBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5wcm9wZXJ0aWVzLmRuc2hvc3RuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3I6ICRfIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LUFET2JqZWN0IHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBUYWtlcyBhIGRvbWFpbiBTSUQgYW5kIHJldHVybnMgdGhlIHVzZXIsIGdyb3VwLCBvciBjb21wdXRlciBvYmplY3QKICAgICAgICBhc3NvY2lhdGVkIHdpdGggaXQuCgogICAgLlBBUkFNRVRFUiBTSUQKCiAgICAgICAgVGhlIFNJRCBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLgoKICAgIC5QQVJBTUVURVIgTmFtZQoKICAgICAgICBUaGUgTmFtZSBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLgoKICAgIC5QQVJBTUVURVIgU2FtQWNjb3VudE5hbWUKCiAgICAgICAgVGhlIFNhbUFjY291bnROYW1lIG9mIHRoZSBkb21haW4gb2JqZWN0IHlvdSdyZSBxdWVyeWluZyBmb3IuIAoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIG9iamVjdHMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgRmlsdGVyCgogICAgICAgIEFkZGl0aW9uYWwgTERBUCBmaWx0ZXIgc3RyaW5nIGZvciB0aGUgcXVlcnkuCgogICAgLlBBUkFNRVRFUiBSZXR1cm5SYXcKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdGhlIHJhdyBvYmplY3QgaW5zdGVhZCBvZiB0cmFuc2xhdGluZyBpdHMgcHJvcGVydGllcy4KICAgICAgICBVc2VkIGJ5IFNldC1BRE9iamVjdCB0byBtb2RpZnkgb2JqZWN0IHByb3BlcnRpZXMuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtQURPYmplY3QgLVNJRCAiUy0xLTUtMjEtMjYyMDg5MTgyOS0yNDExMjYxNDk3LTE3NzM4NTMwODgtMTExMCIKICAgICAgICAKICAgICAgICBHZXQgdGhlIGRvbWFpbiBvYmplY3QgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgU0lELgogICAgICAgIAogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtQURPYmplY3QgLUFEU3BhdGggIkNOPUFkbWluU0RIb2xkZXIsQ049U3lzdGVtLERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgCiAgICAgICAgR2V0IHRoZSBBZG1pblNESG9sZGVyIG9iamVjdCBmb3IgdGhlIHRlc3RsYWIubG9jYWwgZG9tYWluLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU0lELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJldHVyblJhdywKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkU0lEKSB7CiAgICAgICAgICAgICMgaWYgYSBTSUQgaXMgcGFzc2VkLCB0cnkgdG8gcmVzb2x2ZSBpdCB0byBhIHJlYWNoYWJsZSBkb21haW4gbmFtZSBmb3IgdGhlIHNlYXJjaGVyCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkTmFtZSA9IENvbnZlcnQtU2lkVG9OYW1lICRTSUQKICAgICAgICAgICAgICAgIGlmKCROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgJENhbm9uaWNhbCA9IENvbnZlcnQtTlQ0dG9DYW5vbmljYWwgLU9iamVjdE5hbWUgJE5hbWUKICAgICAgICAgICAgICAgICAgICBpZigkQ2Fub25pY2FsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW4gPSAkQ2Fub25pY2FsLnNwbGl0KCIvIilbMF0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIHJlc29sdmluZyBTSUQgJyRTSUQnIgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRXJyb3IgcmVzb2x2aW5nIFNJRCAnJFNJRCcgOiAkXyIKICAgICAgICAgICAgICAgIHJldHVybiAkTnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkT2JqZWN0U2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgaWYoJE9iamVjdFNlYXJjaGVyKSB7CgogICAgICAgICAgICBpZigkU0lEKSB7CiAgICAgICAgICAgICAgICAkT2JqZWN0U2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdHNpZD0kU0lEKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkTmFtZSkgewogICAgICAgICAgICAgICAgJE9iamVjdFNlYXJjaGVyLmZpbHRlciA9ICIoJihuYW1lPSROYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU2FtQWNjb3VudE5hbWUpIHsKICAgICAgICAgICAgICAgICRPYmplY3RTZWFyY2hlci5maWx0ZXIgPSAiKCYoc2FtQWNjb3VudE5hbWU9JFNhbUFjY291bnROYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICB9CgogICAgICAgICAgICAkT2JqZWN0U2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICBpZigkUmV0dXJuUmF3KSB7CiAgICAgICAgICAgICAgICAgICAgJF8KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICMgY29udmVydC9wcm9jZXNzIHRoZSBMREFQIGZpZWxkcyBmb3IgZWFjaCByZXN1bHQKICAgICAgICAgICAgICAgICAgICBDb252ZXJ0LUxEQVBQcm9wZXJ0eSAtUHJvcGVydGllcyAkXy5Qcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBTZXQtQURPYmplY3Qgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRha2VzIGEgU0lELCBuYW1lLCBvciBTYW1BY2NvdW50TmFtZSB0byBxdWVyeSBmb3IgYSBzcGVjaWZpZWQKICAgICAgICBkb21haW4gb2JqZWN0LCBhbmQgdGhlbiBzZXRzIGEgc3BlY2lmaWVkICdQcm9wZXJ0eU5hbWUnIHRvIGEKICAgICAgICBzcGVjaWZpZWQgJ1Byb3BlcnR5VmFsdWUnLgoKICAgIC5QQVJBTUVURVIgU0lECgogICAgICAgIFRoZSBTSUQgb2YgdGhlIGRvbWFpbiBvYmplY3QgeW91J3JlIHF1ZXJ5aW5nIGZvci4KCiAgICAuUEFSQU1FVEVSIE5hbWUKCiAgICAgICAgVGhlIE5hbWUgb2YgdGhlIGRvbWFpbiBvYmplY3QgeW91J3JlIHF1ZXJ5aW5nIGZvci4KCiAgICAuUEFSQU1FVEVSIFNhbUFjY291bnROYW1lCgogICAgICAgIFRoZSBTYW1BY2NvdW50TmFtZSBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLiAKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBvYmplY3RzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQWRkaXRpb25hbCBMREFQIGZpbHRlciBzdHJpbmcgZm9yIHRoZSBxdWVyeS4KCiAgICAuUEFSQU1FVEVSIFByb3BlcnR5TmFtZQoKICAgICAgICBUaGUgcHJvcGVydHkgbmFtZSB0byBzZXQuCgogICAgLlBBUkFNRVRFUiBQcm9wZXJ0eVZhbHVlCgogICAgICAgIFRoZSB2YWx1ZSB0byBzZXQgZm9yIFByb3BlcnR5TmFtZQoKICAgIC5QQVJBTUVURVIgUHJvcGVydHlYb3JWYWx1ZQoKICAgICAgICBJbnRlZ2VyIHZhbHVlIHRvIGJpbmFyeSB4b3IgKC1ieG9yKSB3aXRoIHRoZSBjdXJyZW50IGludCB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIENsZWFyVmFsdWUKCiAgICAgICAgU3dpdGNoLiBDbGVhciB0aGUgdmFsdWUgb2YgUHJvcGVydHlOYW1lCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBTZXQtQURPYmplY3QgLVNhbUFjY291bnROYW1lIG1hdHQuYWRtaW4gLVByb3BlcnR5TmFtZSBjb3VudHJ5Y29kZSAtUHJvcGVydHlWYWx1ZSAwCiAgICAgICAgCiAgICAgICAgU2V0IHRoZSBjb3VudHJ5Y29kZSBmb3IgbWF0dC5hZG1pbiB0byAwCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBTZXQtQURPYmplY3QgLVNhbUFjY291bnROYW1lIG1hdHQuYWRtaW4gLVByb3BlcnR5TmFtZSB1c2VyYWNjb3VudGNvbnRyb2wgLVByb3BlcnR5WG9yVmFsdWUgNjU1MzYKICAgICAgICAKICAgICAgICBTZXQgdGhlIHBhc3N3b3JkIG5vdCB0byBleHBpcmUgb24gbWF0dC5hZG1pbgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU0lELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTYW1BY2NvdW50TmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFByb3BlcnR5TmFtZSwKCiAgICAgICAgJFByb3BlcnR5VmFsdWUsCgogICAgICAgIFtJbnRdCiAgICAgICAgJFByb3BlcnR5WG9yVmFsdWUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJENsZWFyVmFsdWUsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgICRBcmd1bWVudHMgPSBAewogICAgICAgICdTSUQnID0gJFNJRAogICAgICAgICdOYW1lJyA9ICROYW1lCiAgICAgICAgJ1NhbUFjY291bnROYW1lJyA9ICRTYW1BY2NvdW50TmFtZQogICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICdEb21haW5Db250cm9sbGVyJyA9ICREb21haW5Db250cm9sbGVyCiAgICAgICAgJ0ZpbHRlcicgPSAkRmlsdGVyCiAgICAgICAgJ1BhZ2VTaXplJyA9ICRQYWdlU2l6ZQogICAgfQogICAgIyBzcGxhdCB0aGUgYXBwcm9wcmlhdGUgYXJndW1lbnRzIHRvIEdldC1BRE9iamVjdAogICAgJFJhd09iamVjdCA9IEdldC1BRE9iamVjdCAtUmV0dXJuUmF3IEBBcmd1bWVudHMKICAgIAogICAgdHJ5IHsKICAgICAgICAjIGdldCB0aGUgbW9kaWZpYWJsZSBvYmplY3QgZm9yIHRoaXMgc2VhcmNoIHJlc3VsdAogICAgICAgICRFbnRyeSA9ICRSYXdPYmplY3QuR2V0RGlyZWN0b3J5RW50cnkoKQogICAgICAgIAogICAgICAgIGlmKCRDbGVhclZhbHVlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNsZWFyaW5nIHZhbHVlIgogICAgICAgICAgICAkRW50cnkuJFByb3BlcnR5TmFtZS5jbGVhcigpCiAgICAgICAgICAgICRFbnRyeS5jb21taXRjaGFuZ2VzKCkKICAgICAgICB9CgogICAgICAgIGVsc2VpZigkUHJvcGVydHlYb3JWYWx1ZSkgewogICAgICAgICAgICAkVHlwZU5hbWUgPSAkRW50cnkuJFByb3BlcnR5TmFtZVswXS5HZXRUeXBlKCkubmFtZQoKICAgICAgICAgICAgIyBVQUMgdmFsdWUgcmVmZXJlbmNlcy0gaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20vZW4tdXMva2IvMzA1MTQ0CiAgICAgICAgICAgICRQcm9wZXJ0eVZhbHVlID0gJCgkRW50cnkuJFByb3BlcnR5TmFtZSkgLWJ4b3IgJFByb3BlcnR5WG9yVmFsdWUgCiAgICAgICAgICAgICRFbnRyeS4kUHJvcGVydHlOYW1lID0gJFByb3BlcnR5VmFsdWUgLWFzICRUeXBlTmFtZSAgICAgICAKICAgICAgICAgICAgJEVudHJ5LmNvbW1pdGNoYW5nZXMoKSAgICAgCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJEVudHJ5LnB1dCgkUHJvcGVydHlOYW1lLCAkUHJvcGVydHlWYWx1ZSkKICAgICAgICAgICAgJEVudHJ5LnNldGluZm8oKQogICAgICAgIH0KICAgIH0KICAgIGNhdGNoIHsKICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBzZXR0aW5nIHByb3BlcnR5ICRQcm9wZXJ0eU5hbWUgdG8gdmFsdWUgJyRQcm9wZXJ0eVZhbHVlJyBmb3Igb2JqZWN0ICQoJFJhd09iamVjdC5Qcm9wZXJ0aWVzLnNhbWFjY291bnRuYW1lKSA6ICRfIgogICAgfQp9CgoKZnVuY3Rpb24gSW52b2tlLURvd25ncmFkZUFjY291bnQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFNldCByZXZlcnNpYmxlIGVuY3J5cHRpb24gb24gYSBnaXZlbiBhY2NvdW50IGFuZCB0aGVuIGZvcmNlIHRoZSBwYXNzd29yZAogICAgICAgIHRvIGJlIHNldCBvbiBuZXh0IHVzZXIgbG9naW4uIFRvIHJlcGFpciB1c2UgIi1SZXBhaXIiLgoKICAgIC5QQVJBTUVURVIgU2FtQWNjb3VudE5hbWUKCiAgICAgICAgVGhlIFNhbUFjY291bnROYW1lIG9mIHRoZSBkb21haW4gb2JqZWN0IHlvdSdyZSBxdWVyeWluZyBmb3IuIAoKICAgIC5QQVJBTUVURVIgTmFtZQoKICAgICAgICBUaGUgTmFtZSBvZiB0aGUgZG9tYWluIG9iamVjdCB5b3UncmUgcXVlcnlpbmcgZm9yLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIG9iamVjdHMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBZGRpdGlvbmFsIExEQVAgZmlsdGVyIHN0cmluZyBmb3IgdGhlIHF1ZXJ5LgoKICAgIC5QQVJBTUVURVIgUmVwYWlyCgogICAgICAgIFN3aXRjaC4gVW5zZXQgdGhlIHJldmVyc2libGUgZW5jcnlwdGlvbiBmbGFnIGFuZCBmb3JjZSBwYXNzd29yZCByZXNldCBmbGFnLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTPiBJbnZva2UtRG93bmdyYWRlQWNjb3VudCAtU2FtQWNjb3VudE5hbWUgamFzb24KCiAgICAgICAgU2V0IHJldmVyc2libGUgZW5jcnlwdGlvbiBvbiB0aGUgJ2phc29uJyBhY2NvdW50IGFuZCBmb3JjZSB0aGUgcGFzc3dvcmQgdG8gYmUgY2hhbmdlZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUz4gSW52b2tlLURvd25ncmFkZUFjY291bnQgLVNhbUFjY291bnROYW1lIGphc29uIC1SZXBhaXIKCiAgICAgICAgVW5zZXQgcmV2ZXJzaWJsZSBlbmNyeXB0aW9uIG9uIHRoZSAnamFzb24nIGFjY291bnQgYW5kIHJlbW92ZSB0aGUgZm9yY2VkIHBhc3N3b3JkIGNoYW5nZS4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2FtQWNjb3VudE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRmlsdGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXBhaXIKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICAkQXJndW1lbnRzID0gQHsKICAgICAgICAgICAgJ1NhbUFjY291bnROYW1lJyA9ICRTYW1BY2NvdW50TmFtZQogICAgICAgICAgICAnTmFtZScgPSAkTmFtZQogICAgICAgICAgICAnRG9tYWluJyA9ICREb21haW4KICAgICAgICAgICAgJ0RvbWFpbkNvbnRyb2xsZXInID0gJERvbWFpbkNvbnRyb2xsZXIKICAgICAgICAgICAgJ0ZpbHRlcicgPSAkRmlsdGVyCiAgICAgICAgfQoKICAgICAgICAjIHNwbGF0IHRoZSBhcHByb3ByaWF0ZSBhcmd1bWVudHMgdG8gR2V0LUFET2JqZWN0CiAgICAgICAgJFVBQ1ZhbHVlcyA9IEdldC1BRE9iamVjdCBAQXJndW1lbnRzIHwgc2VsZWN0IHVzZXJhY2NvdW50Y29udHJvbCB8IENvbnZlcnRGcm9tLVVBQ1ZhbHVlCgogICAgICAgIGlmKCRSZXBhaXIpIHsKCiAgICAgICAgICAgIGlmKCRVQUNWYWx1ZXMuS2V5cyAtY29udGFpbnMgIkVOQ1JZUFRFRF9URVhUX1BXRF9BTExPV0VEIikgewogICAgICAgICAgICAgICAgIyBpZiByZXZlcnNpYmxlIGVuY3J5cHRpb24gaXMgc2V0LCB1bnNldCBpdAogICAgICAgICAgICAgICAgU2V0LUFET2JqZWN0IEBBcmd1bWVudHMgLVByb3BlcnR5TmFtZSB1c2VyYWNjb3VudGNvbnRyb2wgLVByb3BlcnR5WG9yVmFsdWUgMTI4CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgdW5zZXQgdGhlIGZvcmNlZCBwYXNzd29yZCBjaGFuZ2UKICAgICAgICAgICAgU2V0LUFET2JqZWN0IEBBcmd1bWVudHMgLVByb3BlcnR5TmFtZSBwd2RsYXN0c2V0IC1Qcm9wZXJ0eVZhbHVlIC0xCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKCiAgICAgICAgICAgIGlmKCRVQUNWYWx1ZXMuS2V5cyAtY29udGFpbnMgIkRPTlRfRVhQSVJFX1BBU1NXT1JEIikgewogICAgICAgICAgICAgICAgIyBpZiB0aGUgcGFzc3dvcmQgaXMgc2V0IHRvIG5ldmVyIGV4cGlyZSwgdW5zZXQKICAgICAgICAgICAgICAgIFNldC1BRE9iamVjdCBAQXJndW1lbnRzIC1Qcm9wZXJ0eU5hbWUgdXNlcmFjY291bnRjb250cm9sIC1Qcm9wZXJ0eVhvclZhbHVlIDY1NTM2CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCRVQUNWYWx1ZXMuS2V5cyAtbm90Y29udGFpbnMgIkVOQ1JZUFRFRF9URVhUX1BXRF9BTExPV0VEIikgewogICAgICAgICAgICAgICAgIyBpZiByZXZlcnNpYmxlIGVuY3J5cHRpb24gaXMgbm90IHNldCwgc2V0IGl0CiAgICAgICAgICAgICAgICBTZXQtQURPYmplY3QgQEFyZ3VtZW50cyAtUHJvcGVydHlOYW1lIHVzZXJhY2NvdW50Y29udHJvbCAtUHJvcGVydHlYb3JWYWx1ZSAxMjgKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBmb3JjZSB0aGUgcGFzc3dvcmQgdG8gYmUgY2hhbmdlZCBvbiBuZXh0IGxvZ2luCiAgICAgICAgICAgIFNldC1BRE9iamVjdCBAQXJndW1lbnRzIC1Qcm9wZXJ0eU5hbWUgcHdkbGFzdHNldCAtUHJvcGVydHlWYWx1ZSAwCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LUNvbXB1dGVyUHJvcGVydHkgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybnMgYSBsaXN0IG9mIGFsbCBjb21wdXRlciBvYmplY3QgcHJvcGVydGllcy4gSWYgYSBwcm9wZXJ0eQogICAgICAgIG5hbWUgaXMgc3BlY2lmaWVkLCBpdCByZXR1cm5zIGFsbCBbY29tcHV0ZXI6cHJvcGVydHldIHZhbHVlcy4KCiAgICAgICAgVGFrZW4gZGlyZWN0bHkgZnJvbSBAb2JzY3VyZXNlYydzIHBvc3Q6CiAgICAgICAgICAgIGh0dHA6Ly9vYnNjdXJlc2VjdXJpdHkuYmxvZ3Nwb3QuY29tLzIwMTQvMDQvQURTSVNlYXJjaGVyLmh0bWwKCiAgICAuUEFSQU1FVEVSIFByb3BlcnRpZXMKCiAgICAgICAgUmV0dXJuIHByb3BlcnR5IG5hbWVzIGZvciBjb21wdXRlcnMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgY29tcHV0ZXIgcHJvcGVydGllcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUNvbXB1dGVyUHJvcGVydHkgLURvbWFpbiB0ZXN0aW5nCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgdXNlciBwcm9wZXJ0aWVzIGZvciBjb21wdXRlcnMgaW4gdGhlICd0ZXN0aW5nJyBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtQ29tcHV0ZXJQcm9wZXJ0eSAtUHJvcGVydGllcyBzc24sbGFzdGxvZ29uLGxvY2F0aW9uCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgYW4gYXJyYXkgb2YgY29tcHV0ZXIvc3NuL2xhc3Rsb2dpbi9sb2NhdGlvbiBjb21iaW5hdGlvbnMKICAgICAgICBmb3IgY29tcHV0ZXJzIGluIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vb2JzY3VyZXNlY3VyaXR5LmJsb2dzcG90LmNvbS8yMDE0LzA0L0FEU0lTZWFyY2hlci5odG1sCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkUHJvcGVydGllcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBpZigkUHJvcGVydGllcykgewogICAgICAgICMgZXh0cmFjdCBvdXQgdGhlIHNldCBvZiBhbGwgcHJvcGVydGllcyBmb3IgZWFjaCBvYmplY3QKICAgICAgICAkUHJvcGVydGllcyA9ICwibmFtZSIgKyAkUHJvcGVydGllcyB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKICAgICAgICBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplIHwgU2VsZWN0LU9iamVjdCAtUHJvcGVydHkgJFByb3BlcnRpZXMKICAgIH0KICAgIGVsc2UgewogICAgICAgICMgZXh0cmFjdCBvdXQganVzdCB0aGUgcHJvcGVydHkgbmFtZXMKICAgICAgICBHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplIHwgU2VsZWN0LU9iamVjdCAtZmlyc3QgMSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKlByb3BlcnR5IHwgU2VsZWN0LU9iamVjdCAtUHJvcGVydHkgIk5hbWUiCiAgICB9Cn0KCgpmdW5jdGlvbiBGaW5kLUNvbXB1dGVyRmllbGQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFNlYXJjaGVzIGNvbXB1dGVyIG9iamVjdCBmaWVsZHMgZm9yIGEgZ2l2ZW4gd29yZCAoZGVmYXVsdCAqcGFzcyopLiBEZWZhdWx0CiAgICAgICAgZmllbGQgYmVpbmcgc2VhcmNoZWQgaXMgJ2Rlc2NyaXB0aW9uJy4KCiAgICAgICAgVGFrZW4gZGlyZWN0bHkgZnJvbSBAb2JzY3VyZXNlYydzIHBvc3Q6CiAgICAgICAgICAgIGh0dHA6Ly9vYnNjdXJlc2VjdXJpdHkuYmxvZ3Nwb3QuY29tLzIwMTQvMDQvQURTSVNlYXJjaGVyLmh0bWwKCiAgICAuUEFSQU1FVEVSIFNlYXJjaFRlcm0KCiAgICAgICAgVGVybSB0byBzZWFyY2ggZm9yLCBkZWZhdWx0IG9mICJwYXNzIi4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZpZWxkCgogICAgICAgIFVzZXIgZmllbGQgdG8gc2VhcmNoIGluLCBkZWZhdWx0IG9mICJkZXNjcmlwdGlvbiIuCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBEb21haW4gdG8gc2VhcmNoIGNvbXB1dGVyIGZpZWxkcyBmb3IsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtQ29tcHV0ZXJGaWVsZCAtU2VhcmNoVGVybSBiYWNrdXAgLVNlYXJjaEZpZWxkIGluZm8KCiAgICAgICAgRmluZCBjb21wdXRlciBhY2NvdW50cyB3aXRoICJiYWNrdXAiIGluIHRoZSAiaW5mbyIgZmllbGQuCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdUZXJtJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2VhcmNoVGVybSA9ICdwYXNzJywKCiAgICAgICAgW0FsaWFzKCdGaWVsZCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlYXJjaEZpZWxkID0gJ2Rlc2NyaXB0aW9uJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBHZXQtTmV0Q29tcHV0ZXIgLUFEU3BhdGggJEFEU3BhdGggLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GdWxsRGF0YSAtRmlsdGVyICIoJFNlYXJjaEZpZWxkPSokU2VhcmNoVGVybSopIiAtUGFnZVNpemUgJFBhZ2VTaXplIHwgU2VsZWN0LU9iamVjdCBzYW1hY2NvdW50bmFtZSwkU2VhcmNoRmllbGQKICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRPVSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyBhIGxpc3Qgb2YgYWxsIGN1cnJlbnQgT1VzIGluIGEgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgT1VOYW1lCgogICAgICAgIFRoZSBPVSBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgR1VJRAoKICAgICAgICBPbmx5IHJldHVybiBPVXMgd2l0aCB0aGUgc3BlY2lmaWVkIEdVSUQgaW4gdGhlaXIgZ3BsaW5rIHByb3BlcnR5LgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIE9VcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBGdWxsRGF0YQoKICAgICAgICBTd2l0Y2guIFJldHVybiBmdWxsIE9VIG9iamVjdHMgaW5zdGVhZCBvZiBqdXN0IG9iamVjdCBuYW1lcyAodGhlIGRlZmF1bHQpLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldE9VCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBPVXMgaW4gdGhlIGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRPVSAtT1VOYW1lICphZG1pbiogLURvbWFpbiB0ZXN0bGFiLmxvY2FsCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgT1VzIHdpdGggImFkbWluIiBpbiB0aGVpciBuYW1lIGluIHRoZSB0ZXN0bGFiLmxvY2FsIGRvbWFpbi4KCiAgICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0T1UgLUdVSUQgMTIzLS4uLgogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIE9VcyB3aXRoIGxpbmtlZCB0byB0aGUgc3BlY2lmaWVkIGdyb3VwIHBvbGljeSBvYmplY3QuICAgIAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkT1VOYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHVUlELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFEU3BhdGgsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZ1bGxEYXRhLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgJE9VU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KICAgIHByb2Nlc3MgewogICAgICAgIGlmICgkT1VTZWFyY2hlcikgewogICAgICAgICAgICBpZiAoJEdVSUQpIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgZmlsdGVyaW5nIGZvciBhIEdVSUQgaW4gLmdwbGluawogICAgICAgICAgICAgICAgJE9VU2VhcmNoZXIuZmlsdGVyPSIoJihvYmplY3RDYXRlZ29yeT1vcmdhbml6YXRpb25hbFVuaXQpKG5hbWU9JE9VTmFtZSkoZ3BsaW5rPSokR1VJRCopKSIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRPVVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9b3JnYW5pemF0aW9uYWxVbml0KShuYW1lPSRPVU5hbWUpKSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJE9VU2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICBpZiAoJEZ1bGxEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgeyAKICAgICAgICAgICAgICAgICAgICAjIG90aGVyd2lzZSBqdXN0IHJldHVybmluZyB0aGUgQURTIHBhdGhzIG9mIHRoZSBPVXMKICAgICAgICAgICAgICAgICAgICAkXy5wcm9wZXJ0aWVzLmFkc3BhdGgKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRTaXRlIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBHZXRzIGEgbGlzdCBvZiBhbGwgY3VycmVudCBzaXRlcyBpbiBhIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIFNpdGVOYW1lCgogICAgICAgIFNpdGUgZmlsdGVyIHN0cmluZywgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIHNpdGVzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEdVSUQKCiAgICAgICAgT25seSByZXR1cm4gc2l0ZSB3aXRoIHRoZSBzcGVjaWZpZWQgR1VJRCBpbiB0aGVpciBncGxpbmsgcHJvcGVydHkuCgogICAgLlBBUkFNRVRFUiBGdWxsRGF0YQoKICAgICAgICBTd2l0Y2guIFJldHVybiBmdWxsIHNpdGUgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3Qgb2JqZWN0IG5hbWVzICh0aGUgZGVmYXVsdCkuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U2l0ZSAtRG9tYWluIHRlc3RsYWIubG9jYWwgLUZ1bGxEYXRhCiAgICAgICAgCiAgICAgICAgUmV0dXJucyB0aGUgZnVsbCBkYXRhIG9iamVjdHMgZm9yIGFsbCBzaXRlcyBpbiB0ZXN0bGFiLmxvY2FsCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTaXRlTmFtZSA9ICIqIiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHVUlELAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgYmVnaW4gewogICAgICAgICRTaXRlU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLUFEU3BhdGggJEFEU3BhdGggLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwcmVmaXggIkNOPVNpdGVzLENOPUNvbmZpZ3VyYXRpb24iIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KICAgIHByb2Nlc3MgewogICAgICAgIGlmKCRTaXRlU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmICgkR1VJRCkgewogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBmaWx0ZXJpbmcgZm9yIGEgR1VJRCBpbiAuZ3BsaW5rCiAgICAgICAgICAgICAgICAkU2l0ZVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9c2l0ZSkobmFtZT0kU2l0ZU5hbWUpKGdwbGluaz0qJEdVSUQqKSkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkU2l0ZVNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9c2l0ZSkobmFtZT0kU2l0ZU5hbWUpKSIKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRTaXRlU2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIGp1c3QgcmV0dXJuIHRoZSBzaXRlIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJF8ucHJvcGVydGllcy5uYW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgJF8KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRTdWJuZXQgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEdldHMgYSBsaXN0IG9mIGFsbCBjdXJyZW50IHN1Ym5ldHMgaW4gYSBkb21haW4uCgogICAgLlBBUkFNRVRFUiBTaXRlTmFtZQoKICAgICAgICBPbmx5IHJldHVybiBzdWJuZXRzIGZyb20gdGhlIHNwZWNpZmllZCBTaXRlTmFtZS4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBzdWJuZXRzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgc3VibmV0IG9iamVjdHMgaW5zdGVhZCBvZiBqdXN0IG9iamVjdCBuYW1lcyAodGhlIGRlZmF1bHQpLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFN1Ym5ldAogICAgICAgIAogICAgICAgIFJldHVybnMgYWxsIHN1Ym5ldCBuYW1lcyBpbiB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U3VibmV0IC1Eb21haW4gdGVzdGxhYi5sb2NhbCAtRnVsbERhdGEKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSBmdWxsIGRhdGEgb2JqZWN0cyBmb3IgYWxsIHN1Ym5ldHMgaW4gdGVzdGxhYi5sb2NhbAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2l0ZU5hbWUgPSAiKiIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRnVsbERhdGEsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICAkU3VibmV0U2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1BRFNwcmVmaXggIkNOPVN1Ym5ldHMsQ049U2l0ZXMsQ049Q29uZmlndXJhdGlvbiIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQoKICAgIHByb2Nlc3MgewogICAgICAgIGlmKCRTdWJuZXRTZWFyY2hlcikgewoKICAgICAgICAgICAgJFN1Ym5ldFNlYXJjaGVyLmZpbHRlcj0iKCYob2JqZWN0Q2F0ZWdvcnk9c3VibmV0KSkiCgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJFN1Ym5ldFNlYXJjaGVyLkZpbmRBbGwoKSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmICgkRnVsbERhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBjb252ZXJ0L3Byb2Nlc3MgdGhlIExEQVAgZmllbGRzIGZvciBlYWNoIHJlc3VsdAogICAgICAgICAgICAgICAgICAgICAgICBDb252ZXJ0LUxEQVBQcm9wZXJ0eSAtUHJvcGVydGllcyAkXy5Qcm9wZXJ0aWVzIHwgV2hlcmUtT2JqZWN0IHsgJF8uc2l0ZW9iamVjdCAtbWF0Y2ggIkNOPSRTaXRlTmFtZSIgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2UganVzdCByZXR1cm4gdGhlIHN1Ym5ldCBuYW1lIGFuZCBzaXRlIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAoJFNpdGVOYW1lIC1hbmQgKCRfLnByb3BlcnRpZXMuc2l0ZW9iamVjdCAtbWF0Y2ggIkNOPSRTaXRlTmFtZSwiKSkgLW9yICgkU2l0ZU5hbWUgLWVxICcqJykpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU3VibmV0UHJvcGVydGllcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1N1Ym5ldCcgPSAkXy5wcm9wZXJ0aWVzLm5hbWVbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN1Ym5ldFByb3BlcnRpZXNbJ1NpdGUnXSA9ICgkXy5wcm9wZXJ0aWVzLnNpdGVvYmplY3RbMF0pLnNwbGl0KCIsIilbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU3VibmV0UHJvcGVydGllc1snU2l0ZSddID0gJ0Vycm9yJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkU3VibmV0UHJvcGVydGllcyAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAkXwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LURvbWFpblNJRCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyB0aGUgU0lEIGZvciB0aGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBDOlw+IEdldC1Eb21haW5TSUQgLURvbWFpbiBURVNUCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBTSUQgZm9yIHRoZSBkb21haW4gJ1RFU1QnCiM+CgogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluCiAgICApCgogICAgJEZvdW5kRG9tYWluID0gR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4KICAgIAogICAgaWYoJEZvdW5kRG9tYWluKSB7CiAgICAgICAgIyBxdWVyeSBmb3IgdGhlIHByaW1hcnkgZG9tYWluIGNvbnRyb2xsZXIgc28gd2UgY2FuIGV4dHJhY3QgdGhlIGRvbWFpbiBTSUQgZm9yIGZpbHRlcmluZwogICAgICAgICRQcmltYXJ5REMgPSAkRm91bmREb21haW4uUGRjUm9sZU93bmVyCiAgICAgICAgJFByaW1hcnlEQ1NJRCA9IChHZXQtTmV0Q29tcHV0ZXIgLURvbWFpbiAkRG9tYWluIC1Db21wdXRlck5hbWUgJFByaW1hcnlEQyAtRnVsbERhdGEpLm9iamVjdHNpZAogICAgICAgICRQYXJ0cyA9ICRQcmltYXJ5RENTSUQuc3BsaXQoIi0iKQogICAgICAgICRQYXJ0c1swLi4oJFBhcnRzLmxlbmd0aCAtMildIC1qb2luICItIgogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldEdyb3VwIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBHZXRzIGEgbGlzdCBvZiBhbGwgY3VycmVudCBncm91cHMgaW4gYSBkb21haW4sIG9yIGFsbAogICAgICAgIHRoZSBncm91cHMgYSBnaXZlbiB1c2VyL2dyb3VwIG9iamVjdCBiZWxvbmdzIHRvLgoKICAgIC5QQVJBTUVURVIgR3JvdXBOYW1lCgogICAgICAgIFRoZSBncm91cCBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgU0lECgogICAgICAgIFRoZSBncm91cCBTSUQgdG8gcXVlcnkgZm9yLgoKICAgIC5QQVJBTUVURVIgVXNlck5hbWUKCiAgICAgICAgVGhlIHVzZXIgbmFtZSAob3IgZ3JvdXAgbmFtZSkgdG8gcXVlcnkgZm9yIGFsbCBlZmZlY3RpdmUKICAgICAgICBncm91cHMgb2YuCgogICAgLlBBUkFNRVRFUiBGaWx0ZXIKCiAgICAgICAgQSBjdXN0b21pemVkIGxkYXAgZmlsdGVyIHN0cmluZyB0byB1c2UsIGUuZy4gIihkZXNjcmlwdGlvbj0qYWRtaW4qKSIKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBncm91cHMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgQWRtaW5Db3VudAoKICAgICAgICBTd2l0Y2guIFJldHVybiBncm91cCB3aXRoIGFkbWluQ291bnQ9MS4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIGZ1bGwgZ3JvdXAgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3Qgb2JqZWN0IG5hbWVzICh0aGUgZGVmYXVsdCkuCgogICAgLlBBUkFNRVRFUiBSYXdTaWRzCgogICAgICAgIFN3aXRjaC4gUmV0dXJuIHJhdyBTSURzIHdoZW4gdXNpbmcgIkdldC1OZXRHcm91cCAtVXNlck5hbWUgWCIKCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRHcm91cAogICAgICAgIAogICAgICAgIFJldHVybnMgdGhlIGN1cnJlbnQgZ3JvdXBzIGluIHRoZSBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0R3JvdXAgLUdyb3VwTmFtZSAqYWRtaW4qCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgZ3JvdXBzIHdpdGggImFkbWluIiBpbiB0aGVpciBncm91cCBuYW1lLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEdyb3VwIC1Eb21haW4gdGVzdGluZyAtRnVsbERhdGEKICAgICAgICAKICAgICAgICBSZXR1cm5zIGZ1bGwgZ3JvdXAgZGF0YSBvYmplY3RzIGluIHRoZSAndGVzdGluZycgZG9tYWluCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU0lELAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCiAgICAgICAgCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRBZG1pbkNvdW50LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmF3U2lkcywKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgYmVnaW4gewogICAgICAgICRHcm91cFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYoJEdyb3VwU2VhcmNoZXIpIHsKCiAgICAgICAgICAgIGlmKCRBZG1pbkNvdW50KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyBmb3IgYWRtaW5Db3VudD0xIgogICAgICAgICAgICAgICAgJEZpbHRlciArPSAiKGFkbWluY291bnQ9MSkiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkVXNlck5hbWUpIHsKICAgICAgICAgICAgICAgICMgZ2V0IHRoZSByYXcgdXNlciBvYmplY3QKICAgICAgICAgICAgICAgICRVc2VyID0gR2V0LUFET2JqZWN0IC1TYW1BY2NvdW50TmFtZSAkVXNlck5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1SZXR1cm5SYXcgLVBhZ2VTaXplICRQYWdlU2l6ZQoKICAgICAgICAgICAgICAgICMgY29udmVydCB0aGUgdXNlciB0byBhIGRpcmVjdG9yeSBlbnRyeQogICAgICAgICAgICAgICAgJFVzZXJEaXJlY3RvcnlFbnRyeSA9ICRVc2VyLkdldERpcmVjdG9yeUVudHJ5KCkKCiAgICAgICAgICAgICAgICAjIGNhdXNlIHRoZSBjYWNoZSB0byBjYWxjdWxhdGUgdGhlIHRva2VuIGdyb3VwcyBmb3IgdGhlIHVzZXIKICAgICAgICAgICAgICAgICRVc2VyRGlyZWN0b3J5RW50cnkuUmVmcmVzaENhY2hlKCJ0b2tlbkdyb3VwcyIpCgogICAgICAgICAgICAgICAgJFVzZXJEaXJlY3RvcnlFbnRyeS5Ub2tlbkdyb3VwcyB8IEZvcmVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQgdGhlIHRva2VuIGdyb3VwIHNpZAogICAgICAgICAgICAgICAgICAgICRHcm91cFNpZCA9IChOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyKCRfLDApKS5WYWx1ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgaWdub3JlIHRoZSBidWlsdCBpbiB1c2VycyBhbmQgZGVmYXVsdCBkb21haW4gdXNlciBncm91cAogICAgICAgICAgICAgICAgICAgIGlmKCEoJEdyb3VwU2lkIC1tYXRjaCAnXlMtMS01LTMyLTU0NXwtNTEzJCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2V0LUFET2JqZWN0IC1TSUQgJEdyb3VwU2lkIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRSYXdTaWRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb252ZXJ0LVNpZFRvTmFtZSAkR3JvdXBTaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICgkU0lEKSB7CiAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdENhdGVnb3J5PWdyb3VwKShvYmplY3RTSUQ9JFNJRCkkRmlsdGVyKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDYXRlZ29yeT1ncm91cCkobmFtZT0kR3JvdXBOYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLkZpbmRBbGwoKSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICMgaWYgd2UncmUgcmV0dXJuaW5nIGZ1bGwgZGF0YSBvYmplY3RzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRGdWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTERBUFByb3BlcnR5IC1Qcm9wZXJ0aWVzICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIHdlJ3JlIGp1c3QgcmV0dXJuaW5nIHRoZSBncm91cCBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRfLnByb3BlcnRpZXMuc2FtYWNjb3VudG5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0R3JvdXBNZW1iZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gdXNlcnMgW0FEU0ldIGFuZCBMREFQIHRvIHF1ZXJ5IHRoZSBjdXJyZW50IEFEIGNvbnRleHQKICAgICAgICBvciB0cnVzdGVkIGRvbWFpbiBmb3IgdXNlcnMgaW4gYSBzcGVjaWZpZWQgZ3JvdXAuIElmIG5vIEdyb3VwTmFtZSBpcwogICAgICAgIHNwZWNpZmllZCwgaXQgZGVmYXVsdHMgdG8gcXVlcnlpbmcgdGhlICJEb21haW4gQWRtaW5zIiBncm91cC4KICAgICAgICBUaGlzIGlzIGEgcmVwbGFjZW1lbnQgZm9yICJuZXQgZ3JvdXAgJ25hbWUnIC9kb21haW4iCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgVGhlIGdyb3VwIG5hbWUgdG8gcXVlcnkgZm9yIHVzZXJzLgoKICAgIC5QQVJBTUVURVIgU0lECgogICAgICAgIFRoZSBHcm91cCBTSUQgdG8gcXVlcnkgZm9yIHVzZXJzLiBJZiBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvIDUxMiAiRG9tYWluIEFkbWlucyIKCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gdG8gcXVlcnkgZm9yIGdyb3VwIHVzZXJzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCwgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEZ1bGxEYXRhCgogICAgICAgIFN3aXRjaC4gUmV0dXJucyBmdWxsIGRhdGEgb2JqZWN0cyBpbnN0ZWFkIG9mIGp1c3QgZ3JvdXAvdXNlcnMuCgogICAgLlBBUkFNRVRFUiBSZWN1cnNlCgogICAgICAgIFN3aXRjaC4gSWYgdGhlIGdyb3VwIG1lbWJlciBpcyBhIGdyb3VwLCByZWN1cnNpdmVseSB0cnkgdG8gcXVlcnkgaXRzIG1lbWJlcnMgYXMgd2VsbC4KCiAgICAuUEFSQU1FVEVSIFVzZU1hdGNoaW5nUnVsZQoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQX01BVENISU5HX1JVTEVfSU5fQ0hBSU4gaW4gdGhlIExEQVAgc2VhcmNoIHF1ZXJ5IHdoZW4gLVJlY3Vyc2UgaXMgc3BlY2lmaWVkLgogICAgICAgIE11Y2ggZmFzdGVyIHRoYW4gbWFudWFsIHJlY3Vyc2lvbiwgYnV0IGRvZXNuJ3QgcmV2ZWFsIGNyb3NzLWRvbWFpbiBncm91cHMuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0R3JvdXBNZW1iZXIKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSB1c2VybmFtZXMgdGhhdCBvZiBtZW1iZXJzIG9mIHRoZSAiRG9tYWluIEFkbWlucyIgZG9tYWluIGdyb3VwLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEdyb3VwTWVtYmVyIC1Eb21haW4gdGVzdGluZyAtR3JvdXBOYW1lICJQb3dlciBVc2VycyIKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSB1c2VybmFtZXMgdGhhdCBvZiBtZW1iZXJzIG9mIHRoZSAiUG93ZXIgVXNlcnMiIGdyb3VwIGluIHRoZSAndGVzdGluZycgZG9tYWluLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly93d3cucG93ZXJzaGVsbG1hZ2F6aW5lLmNvbS8yMDEzLzA1LzIzL3BzdGlwLXJldHJpZXZlLWdyb3VwLW1lbWJlcnNoaXAtb2YtYW4tYWN0aXZlLWRpcmVjdG9yeS1ncm91cC1yZWN1cnNpdmVseS8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRTSUQsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiA9IChHZXQtTmV0RG9tYWluKS5OYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGdWxsRGF0YSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlTWF0Y2hpbmdSdWxlLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgIyBzbyB0aGlzIGlzbid0IHJlcGVhdGVkIGlmIHVzZXJzIGFyZSBwYXNzZWQgb24gdGhlIHBpcGVsaW5lCiAgICAgICAgJEdyb3VwU2VhcmNoZXIgPSBHZXQtRG9tYWluU2VhcmNoZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgaWYoISREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgICREb21haW5Db250cm9sbGVyID0gKChHZXQtTmV0RG9tYWluKS5QZGNSb2xlT3duZXIpLk5hbWUKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmICgkR3JvdXBTZWFyY2hlcikgewoKICAgICAgICAgICAgaWYgKCRSZWN1cnNlIC1hbmQgJFVzZU1hdGNoaW5nUnVsZSkgewogICAgICAgICAgICAgICAgIyByZXNvbHZlIHRoZSBncm91cCB0byBhIGRpc3Rpbmd1aXNoZWRuYW1lCiAgICAgICAgICAgICAgICBpZiAoJEdyb3VwTmFtZSkgewogICAgICAgICAgICAgICAgICAgICRHcm91cCA9IEdldC1OZXRHcm91cCAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRG9tYWluIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCRTSUQpIHsKICAgICAgICAgICAgICAgICAgICAkR3JvdXAgPSBHZXQtTmV0R3JvdXAgLVNJRCAkU0lEIC1Eb21haW4gJERvbWFpbiAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgIyBkZWZhdWx0IHRvIGRvbWFpbiBhZG1pbnMKICAgICAgICAgICAgICAgICAgICAkU0lEID0gKEdldC1Eb21haW5TSUQgLURvbWFpbiAkRG9tYWluKSArICItNTEyIgogICAgICAgICAgICAgICAgICAgICRHcm91cCA9IEdldC1OZXRHcm91cCAtU0lEICRTSUQgLURvbWFpbiAkRG9tYWluIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkR3JvdXBETiA9ICRHcm91cC5kaXN0aW5ndWlzaGVkbmFtZQogICAgICAgICAgICAgICAgJEdyb3VwRm91bmROYW1lID0gJEdyb3VwLm5hbWUKCiAgICAgICAgICAgICAgICBpZiAoJEdyb3VwRE4pIHsKICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5maWx0ZXIgPSAiKCYoc2FtQWNjb3VudFR5cGU9ODA1MzA2MzY4KShtZW1iZXJvZjoxLjIuODQwLjExMzU1Ni4xLjQuMTk0MTo9JEdyb3VwRE4pJEZpbHRlcikiCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuUHJvcGVydGllc1RvTG9hZC5BZGRSYW5nZSgoJ2Rpc3Rpbmd1aXNoZWROYW1lJywnc2FtYWNjb3VudHR5cGUnLCdsYXN0bG9nb24nLCdsYXN0bG9nb250aW1lc3RhbXAnLCdkc2NvcmVwcm9wYWdhdGlvbmRhdGEnLCdvYmplY3RzaWQnLCd3aGVuY3JlYXRlZCcsJ2JhZHBhc3N3b3JkdGltZScsJ2FjY291bnRleHBpcmVzJywnaXNjcml0aWNhbHN5c3RlbW9iamVjdCcsJ25hbWUnLCd1c25jaGFuZ2VkJywnb2JqZWN0Y2F0ZWdvcnknLCdkZXNjcmlwdGlvbicsJ2NvZGVwYWdlJywnaW5zdGFuY2V0eXBlJywnY291bnRyeWNvZGUnLCdkaXN0aW5ndWlzaGVkbmFtZScsJ2NuJywnYWRtaW5jb3VudCcsJ2xvZ29uaG91cnMnLCdvYmplY3RjbGFzcycsJ2xvZ29uY291bnQnLCd1c25jcmVhdGVkJywndXNlcmFjY291bnRjb250cm9sJywnb2JqZWN0Z3VpZCcsJ3ByaW1hcnlncm91cGlkJywnbGFzdGxvZ29mZicsJ3NhbWFjY291bnRuYW1lJywnYmFkcHdkY291bnQnLCd3aGVuY2hhbmdlZCcsJ21lbWJlcm9mJywncHdkbGFzdHNldCcsJ2Fkc3BhdGgnKSkKCiAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgPSAkR3JvdXBTZWFyY2hlci5GaW5kQWxsKCkKICAgICAgICAgICAgICAgICAgICAkR3JvdXBGb3VuZE5hbWUgPSAkR3JvdXBOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiVW5hYmxlIHRvIGZpbmQgR3JvdXAiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoJEdyb3VwTmFtZSkgewogICAgICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLmZpbHRlciA9ICIoJihvYmplY3RDYXRlZ29yeT1ncm91cCkobmFtZT0kR3JvdXBOYW1lKSRGaWx0ZXIpIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZWlmICgkU0lEKSB7CiAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdENhdGVnb3J5PWdyb3VwKShvYmplY3RTSUQ9JFNJRCkkRmlsdGVyKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICMgZGVmYXVsdCB0byBkb21haW4gYWRtaW5zCiAgICAgICAgICAgICAgICAgICAgJFNJRCA9IChHZXQtRG9tYWluU0lEIC1Eb21haW4gJERvbWFpbikgKyAiLTUxMiIKICAgICAgICAgICAgICAgICAgICAkR3JvdXBTZWFyY2hlci5maWx0ZXIgPSAiKCYob2JqZWN0Q2F0ZWdvcnk9Z3JvdXApKG9iamVjdFNJRD0kU0lEKSRGaWx0ZXIpIgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRHcm91cFNlYXJjaGVyLkZpbmRBbGwoKSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoISgkXykgLW9yICEoJF8ucHJvcGVydGllcykgLW9yICEoJF8ucHJvcGVydGllcy5uYW1lKSkgeyBjb250aW51ZSB9CgogICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXBGb3VuZE5hbWUgPSAkXy5wcm9wZXJ0aWVzLm5hbWVbMF0KICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgPSBAKCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkXy5wcm9wZXJ0aWVzLm1lbWJlci5Db3VudCAtZXEgMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZpbmlzaGVkID0gJEZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQm90dG9tID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFRvcCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKCEkRmluaXNoZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVG9wID0gJEJvdHRvbSArIDE0OTkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyUmFuZ2U9Im1lbWJlcjtyYW5nZT0kQm90dG9tLSRUb3AiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEJvdHRvbSArPSAxNTAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwU2VhcmNoZXIuUHJvcGVydGllc1RvTG9hZC5DbGVhcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3ZvaWRdJEdyb3VwU2VhcmNoZXIuUHJvcGVydGllc1RvTG9hZC5BZGQoIiRNZW1iZXJSYW5nZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9ICRHcm91cFNlYXJjaGVyLkZpbmRPbmUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJFJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFJhbmdlZFByb3BlcnR5ID0gJF8uUHJvcGVydGllcy5Qcm9wZXJ0eU5hbWVzIC1saWtlICJtZW1iZXI7cmFuZ2U9KiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHRzID0gJF8uUHJvcGVydGllcy5pdGVtKCRSYW5nZWRQcm9wZXJ0eSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkUmVzdWx0cy5jb3VudCAtZXEgMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGaW5pc2hlZCA9ICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0cyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgKz0gJF8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRmluaXNoZWQgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5NZXRob2RJbnZvY2F0aW9uRXhjZXB0aW9uXSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGaW5pc2hlZCA9ICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJzID0gJF8ucHJvcGVydGllcy5tZW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICRfCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkTWVtYmVycyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBkb2luZyB0aGUgTERBUF9NQVRDSElOR19SVUxFX0lOX0NIQUlOIHJlY3Vyc2lvbgogICAgICAgICAgICAgICAgaWYgKCRSZWN1cnNlIC1hbmQgJFVzZU1hdGNoaW5nUnVsZSkgewogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0aWVzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHQgPSBbYWRzaV0iTERBUDovLyREb21haW5Db250cm9sbGVyLyRfIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9IFthZHNpXSJMREFQOi8vJF8iCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCRSZXN1bHQpewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvcGVydGllcyA9ICRSZXN1bHQuUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkUHJvcGVydGllcykgewoKICAgICAgICAgICAgICAgICAgICBpZigkUHJvcGVydGllcy5zYW1hY2NvdW50dHlwZSAtbm90bWF0Y2ggJzgwNTMwNjM2OCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJElzR3JvdXAgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJElzR3JvdXAgPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgkRnVsbERhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwTWVtYmVyID0gQ29udmVydC1MREFQUHJvcGVydHkgLVByb3BlcnRpZXMgJFByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cERvbWFpbicgJERvbWFpbgogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cE5hbWUnICRHcm91cEZvdW5kTmFtZQoKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRE4gPSAkUHJvcGVydGllcy5kaXN0aW5ndWlzaGVkbmFtZVswXQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgIyBleHRyYWN0IHRoZSBGUUROIGZyb20gdGhlIERpc3Rpbmd1aXNoZWQgTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRG9tYWluID0gJE1lbWJlckROLnN1YlN0cmluZygkTWVtYmVyRE4uSW5kZXhPZigiREM9IikpIC1yZXBsYWNlICdEQz0nLCcnIC1yZXBsYWNlICcsJywnLicKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRE4gPSAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRG9tYWluID0gJE51bGwKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgkUHJvcGVydGllcy5zYW1hY2NvdW50bmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGZvcmVzdCB1c2VycyBoYXZlIHRoZSBzYW1BY2NvdW50TmFtZSBzZXQKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSAkUHJvcGVydGllcy5zYW1hY2NvdW50bmFtZVswXQogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgZXh0ZXJuYWwgdHJ1c3QgdXNlcnMgaGF2ZSBhIFNJRCwgc28gY29udmVydCBpdAogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSBDb252ZXJ0LVNpZFRvTmFtZSAkUHJvcGVydGllcy5jblswXQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgaWYgdGhlcmUncyBhIHByb2JsZW0gY29udGFjdGluZyB0aGUgZG9tYWluIHRvIHJlc29sdmUgdGhlIFNJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSAkUHJvcGVydGllcy5jbgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmKCRQcm9wZXJ0aWVzLm9iamVjdFNpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyU2lkID0gKChOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyICRQcm9wZXJ0aWVzLm9iamVjdFNpZFswXSwwKS5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJTaWQgPSAkTnVsbAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJEdyb3VwTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlckRvbWFpbicgJE1lbWJlckRvbWFpbgogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAkTWVtYmVyTmFtZQogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJTaWQnICRNZW1iZXJTaWQKICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJElzR3JvdXAKICAgICAgICAgICAgICAgICAgICAkR3JvdXBNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyRE4nICRNZW1iZXJETgogICAgICAgICAgICAgICAgICAgICRHcm91cE1lbWJlcgoKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGRvaW5nIG1hbnVhbCByZWN1cnNpb24KICAgICAgICAgICAgICAgICAgICBpZiAoJFJlY3Vyc2UgLWFuZCAhJFVzZU1hdGNoaW5nUnVsZSAtYW5kICRJc0dyb3VwIC1hbmQgJE1lbWJlck5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgR2V0LU5ldEdyb3VwTWVtYmVyIC1GdWxsRGF0YSAtRG9tYWluICRNZW1iZXJEb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUdyb3VwTmFtZSAkTWVtYmVyTmFtZSAtUmVjdXJzZSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRGaWxlU2VydmVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgZmlsZSBzZXJ2ZXJzIGV4dHJhY3RlZCBmcm9tIHVzZXIgCiAgICAgICAgaG9tZWRpcmVjdG9yeSwgc2NyaXB0cGF0aCwgYW5kIHByb2ZpbGVwYXRoIGZpZWxkcy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VyIGZpbGUgc2VydmVycywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0VXNlcnMKCiAgICAgICAgQW4gYXJyYXkgb2YgdXNlcnMgdG8gcXVlcnkgZm9yIGZpbGUgc2VydmVycy4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRGaWxlU2VydmVyCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhY3RpdmUgZmlsZSBzZXJ2ZXJzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZpbGVTZXJ2ZXIgLURvbWFpbiB0ZXN0aW5nCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhY3RpdmUgZmlsZSBzZXJ2ZXJzIGZvciB0aGUgJ3Rlc3RpbmcnIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJFRhcmdldFVzZXJzLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBmdW5jdGlvbiBTcGxpdFBhdGggewogICAgICAgICMgc2hvcnQgaW50ZXJuYWwgaGVscGVyIHRvIHNwbGl0IFVOQyBzZXJ2ZXIgcGF0aHMKICAgICAgICBwYXJhbShbU3RyaW5nXSRQYXRoKQoKICAgICAgICBpZiAoJFBhdGggLWFuZCAoJFBhdGguc3BsaXQoIlxcIikuQ291bnQgLWdlIDMpKSB7CiAgICAgICAgICAgICRUZW1wID0gJFBhdGguc3BsaXQoIlxcIilbMl0KICAgICAgICAgICAgaWYoJFRlbXAgLWFuZCAoJFRlbXAgLW5lICcnKSkgewogICAgICAgICAgICAgICAgJFRlbXAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7JF99IHwgV2hlcmUtT2JqZWN0IHsKICAgICAgICAgICAgIyBmaWx0ZXIgZm9yIGFueSB0YXJnZXQgdXNlcnMKICAgICAgICAgICAgaWYoJFRhcmdldFVzZXJzKSB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgLU1hdGNoICRfLnNhbUFjY291bnROYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7ICRUcnVlIH0gCiAgICAgICAgfSB8IEZvcmVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgIyBzcGxpdCBvdXQgZXZlcnkgcG90ZW50aWFsIGZpbGUgc2VydmVyIHBhdGgKICAgICAgICAgICAgaWYoJF8uaG9tZWRpcmVjdG9yeSkgewogICAgICAgICAgICAgICAgU3BsaXRQYXRoKCRfLmhvbWVkaXJlY3RvcnkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJF8uc2NyaXB0cGF0aCkgewogICAgICAgICAgICAgICAgU3BsaXRQYXRoKCRfLnNjcmlwdHBhdGgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJF8ucHJvZmlsZXBhdGgpIHsKICAgICAgICAgICAgICAgIFNwbGl0UGF0aCgkXy5wcm9maWxlcGF0aCkKICAgICAgICAgICAgfQoKICAgICAgICB9IHwgV2hlcmUtT2JqZWN0IHskX30gfCBTb3J0LU9iamVjdCAtVW5pcXVlCn0KCgpmdW5jdGlvbiBHZXQtREZTc2hhcmUgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybnMgYSBsaXN0IG9mIGFsbCBmYXVsdC10b2xlcmFudCBkaXN0cmlidXRlZCBmaWxlCiAgICAgICAgc3lzdGVtcyBmb3IgYSBnaXZlbiBkb21haW4uCgogICAgLlBBUkFNRVRFUiBWZXJzaW9uCgogICAgICAgIFRoZSB2ZXJzaW9uIG9mIERGUyB0byBxdWVyeSBmb3Igc2VydmVycy4KICAgICAgICAxL3YxLCAyL3YyLCBvciBhbGwKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciB1c2VyIERGUyBzaGFyZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LURGU3NoYXJlCiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgZGlzdHJpYnV0ZWQgZmlsZSBzeXN0ZW0gc2hhcmVzIGZvciB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtREZTc2hhcmUgLURvbWFpbiB0ZXN0CiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbGwgZGlzdHJpYnV0ZWQgZmlsZSBzeXN0ZW0gc2hhcmVzIGZvciB0aGUgJ3Rlc3QnIGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIkFsbCIsIlYxIiwiMSIsIlYyIiwiMiIpXQogICAgICAgICRWZXJzaW9uID0gIkFsbCIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgZnVuY3Rpb24gR2V0LURGU3NoYXJlVjEgewogICAgICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICAgICAgcGFyYW0oCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW4sCgogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRBRFNwYXRoLAoKICAgICAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgICAgICBbSW50XQogICAgICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICAgICApCgogICAgICAgICRERlNzZWFyY2hlciA9IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJEFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQoKICAgICAgICBpZigkREZTc2VhcmNoZXIpIHsKICAgICAgICAgICAgJERGU3NoYXJlcyA9IEAoKQogICAgICAgICAgICAkREZTc2VhcmNoZXIuZmlsdGVyID0gIigmKG9iamVjdENsYXNzPWZURGZzKSkiCgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJERGU1NlYXJjaGVyLkZpbmRBbGwoKSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0aWVzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICRSZW1vdGVOYW1lcyA9ICRQcm9wZXJ0aWVzLnJlbW90ZXNlcnZlcm5hbWUKCiAgICAgICAgICAgICAgICAgICAgJERGU3NoYXJlcyArPSAkUmVtb3RlTmFtZXMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICRfLkNvbnRhaW5zKCdcJykgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5IEB7J05hbWUnPSRQcm9wZXJ0aWVzLm5hbWVbMF07J1JlbW90ZVNlcnZlck5hbWUnPSRfLnNwbGl0KCJcIilbMl19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGluIHBhcnNpbmcgREZTIHNoYXJlIDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiR2V0LURGU3NoYXJlVjIgZXJyb3IgOiAkXyIKICAgICAgICAgICAgfQogICAgICAgICAgICAkREZTc2hhcmVzIHwgU29ydC1PYmplY3QgLVByb3BlcnR5ICJSZW1vdGVTZXJ2ZXJOYW1lIgogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBHZXQtREZTc2hhcmVWMiB7CiAgICAgICAgW0NtZGxldEJpbmRpbmcoKV0KICAgICAgICBwYXJhbSgKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbiwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJEFEU3BhdGgsCgogICAgICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgICAgIFtJbnRdCiAgICAgICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgICAgICkKCiAgICAgICAgJERGU3NlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgIGlmKCRERlNzZWFyY2hlcikgewogICAgICAgICAgICAkREZTc2hhcmVzID0gQCgpCiAgICAgICAgICAgICRERlNzZWFyY2hlci5maWx0ZXIgPSAiKCYob2JqZWN0Q2xhc3M9bXNERlMtTGlua3YyKSkiCiAgICAgICAgICAgICRERlNTZWFyY2hlci5Qcm9wZXJ0aWVzVG9Mb2FkLkFkZFJhbmdlKCgnbXNkZnMtbGlua3BhdGh2MicsJ21zREZTLVRhcmdldExpc3R2MicpKQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRERlNTZWFyY2hlci5GaW5kQWxsKCkgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAkUHJvcGVydGllcyA9ICRfLlByb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0X2xpc3QgPSAkUHJvcGVydGllcy4nbXNkZnMtdGFyZ2V0bGlzdHYyJ1swXQogICAgICAgICAgICAgICAgICAgICR4bWwgPSBbeG1sXVtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKCR0YXJnZXRfbGlzdFsyLi4oJHRhcmdldF9saXN0Lkxlbmd0aC0xKV0pCiAgICAgICAgICAgICAgICAgICAgJERGU3NoYXJlcyArPSAkeG1sLnRhcmdldHMuQ2hpbGROb2RlcyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRUYXJnZXQgPSAkXy5Jbm5lclRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJFRhcmdldC5Db250YWlucygnXCcpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRERlNyb290ID0gJFRhcmdldC5zcGxpdCgiXCIpWzNdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNoYXJlTmFtZSA9ICRQcm9wZXJ0aWVzLidtc2Rmcy1saW5rcGF0aHYyJ1swXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSBAeydOYW1lJz0iJERGU3Jvb3QkU2hhcmVOYW1lIjsnUmVtb3RlU2VydmVyTmFtZSc9JFRhcmdldC5zcGxpdCgiXCIpWzJdfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBpbiBwYXJzaW5nIHRhcmdldCA6ICRfIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkdldC1ERlNzaGFyZVYyIGVycm9yIDogJF8iCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJERGU3NoYXJlcyB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgLVByb3BlcnR5ICJSZW1vdGVTZXJ2ZXJOYW1lIgogICAgICAgIH0KICAgIH0KCiAgICAkREZTc2hhcmVzID0gQCgpCiAgICAKICAgIGlmICggKCRWZXJzaW9uIC1lcSAiYWxsIikgLW9yICgkVmVyc2lvbi5lbmRzV2l0aCgiMSIpKSApIHsKICAgICAgICAkREZTc2hhcmVzICs9IEdldC1ERlNzaGFyZVYxIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9CiAgICBpZiAoICgkVmVyc2lvbiAtZXEgImFsbCIpIC1vciAoJFZlcnNpb24uZW5kc1dpdGgoIjIiKSkgKSB7CiAgICAgICAgJERGU3NoYXJlcyArPSBHZXQtREZTc2hhcmVWMiAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJEFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQoKICAgICRERlNzaGFyZXMgfCBTb3J0LU9iamVjdCAtUHJvcGVydHkgIlJlbW90ZVNlcnZlck5hbWUiCn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgR1BPIHJlbGF0ZWQgZnVuY3Rpb25zLgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtR3B0VG1wbCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgSGVscGVyIHRvIHBhcnNlIGEgR3B0VG1wbC5pbmYgcG9saWN5IGZpbGUgcGF0aCBpbnRvIGEgY3VzdG9tIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIEdwdFRtcGxQYXRoCgogICAgICAgIFRoZSBHcHRUbXBsLmluZiBmaWxlIHBhdGggbmFtZSB0byBwYXJzZS4gCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgdGhlIHRhcmdldCBHcHRUbXBsIGZvbGRlciBwYXRoIGFzIGEgdGVtcG9yYXJ5IFBTRHJpdmUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtR3B0VG1wbCAtR3B0VG1wbFBhdGggIlxcZGV2LnRlc3RsYWIubG9jYWxcc3lzdm9sXGRldi50ZXN0bGFiLmxvY2FsXFBvbGljaWVzXHszMUIyRjM0MC0wMTZELTExRDItOTQ1Ri0wMEMwNEZCOTg0Rjl9XE1BQ0hJTkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcU2VjRWRpdFxHcHRUbXBsLmluZiIKCiAgICAgICAgUGFyc2UgdGhlIGRlZmF1bHQgZG9tYWluIHBvbGljeSAuaW5mIGZvciBkZXYudGVzdGxhYi5sb2NhbAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcHRUbXBsUGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZQogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZigkVXNlUFNEcml2ZSkgewogICAgICAgICAgICAjIGlmIHdlJ3JlIFBTRHJpdmVzLCBjcmVhdGUgYSB0ZW1wb3JhcnkgbW91bnQgcG9pbnQKICAgICAgICAgICAgJFBhcnRzID0gJEdwdFRtcGxQYXRoLnNwbGl0KCdcJykKICAgICAgICAgICAgJEZvbGRlclBhdGggPSAkUGFydHNbMC4uKCRQYXJ0cy5sZW5ndGgtMildIC1qb2luICdcJwogICAgICAgICAgICAkRmlsZVBhdGggPSAkUGFydHNbLTFdCiAgICAgICAgICAgICRSYW5kRHJpdmUgPSAoImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Ii5Ub0NoYXJBcnJheSgpIHwgR2V0LVJhbmRvbSAtQ291bnQgNykgLWpvaW4gJycKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIk1vdW50aW5nIHBhdGggJEdwdFRtcGxQYXRoIHVzaW5nIGEgdGVtcCBQU0RyaXZlIGF0ICRSYW5kRHJpdmUiCgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJE51bGwgPSBOZXctUFNEcml2ZSAtTmFtZSAkUmFuZERyaXZlIC1QU1Byb3ZpZGVyIEZpbGVTeXN0ZW0gLVJvb3QgJEZvbGRlclBhdGggIC1FcnJvckFjdGlvbiBTdG9wCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIG1vdW50aW5nIHBhdGggJEdwdFRtcGxQYXRoIDogJF8iCiAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBzbyB3ZSBjYW4gY2QvZGlyIHRoZSBuZXcgZHJpdmUKICAgICAgICAgICAgJEdwdFRtcGxQYXRoID0gJFJhbmREcml2ZSArICI6XCIgKyAkRmlsZVBhdGgKICAgICAgICB9IAogICAgfQoKICAgIHByb2Nlc3MgewogICAgICAgICRTZWN0aW9uTmFtZSA9ICcnCiAgICAgICAgJFNlY3Rpb25zVGVtcCA9IEB7fQogICAgICAgICRTZWN0aW9uc0ZpbmFsID0gQHt9CgogICAgICAgIHRyeSB7CgogICAgICAgICAgICBpZihUZXN0LVBhdGggJEdwdFRtcGxQYXRoKSB7CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUGFyc2luZyAkR3B0VG1wbFBhdGgiCgogICAgICAgICAgICAgICAgR2V0LUNvbnRlbnQgJEdwdFRtcGxQYXRoIC1FcnJvckFjdGlvbiBTdG9wIHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgIGlmICgkXyAtbWF0Y2ggJ1xbJykgewogICAgICAgICAgICAgICAgICAgICAgICAjIHRoaXMgc2lnbmlmaWVzIHRoYXQgd2UncmUgc3RhcnRpbmcgYSBuZXcgc2VjdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAkU2VjdGlvbk5hbWUgPSAkXy50cmltKCdbXScpIC1yZXBsYWNlICcgJywnJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlaWYoJF8gLW1hdGNoICc9JykgewogICAgICAgICAgICAgICAgICAgICAgICAkUGFydHMgPSAkXy5zcGxpdCgnPScpCiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0eU5hbWUgPSAkUGFydHNbMF0udHJpbSgpCiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9wZXJ0eVZhbHVlcyA9ICRQYXJ0c1sxXS50cmltKCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRQcm9wZXJ0eVZhbHVlcyAtbWF0Y2ggJywnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvcGVydHlWYWx1ZXMgPSAkUHJvcGVydHlWYWx1ZXMuc3BsaXQoJywnKQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZighJFNlY3Rpb25zVGVtcFskU2VjdGlvbk5hbWVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2VjdGlvbnNUZW1wLkFkZCgkU2VjdGlvbk5hbWUsIEB7fSkKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBhZGQgdGhlIHBhcnNlZCBwcm9wZXJ0eSBpbnRvIHRoZSByZWxldmFudCBTZWN0aW9uIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFNlY3Rpb25zVGVtcFskU2VjdGlvbk5hbWVdLkFkZCggJFByb3BlcnR5TmFtZSwgJFByb3BlcnR5VmFsdWVzICkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgRm9yRWFjaCAoJFNlY3Rpb24gaW4gJFNlY3Rpb25zVGVtcC5rZXlzKSB7CiAgICAgICAgICAgICAgICAgICAgIyB0cmFuc2Zvcm0gZWFjaCBuZXN0ZWQgaGFzaCB0YWJsZSBpbnRvIGEgY3VzdG9tIG9iamVjdAogICAgICAgICAgICAgICAgICAgICRTZWN0aW9uc0ZpbmFsWyRTZWN0aW9uXSA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5ICRTZWN0aW9uc1RlbXBbJFNlY3Rpb25dCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyB0cmFuc2Zvcm0gdGhlIHBhcmVudCBoYXNoIHRhYmxlIGludG8gYSBjdXN0b20gb2JqZWN0CiAgICAgICAgICAgICAgICBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSAkU2VjdGlvbnNGaW5hbAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIHBhcnNpbmcgJEdwdFRtcGxQYXRoIDogJF8iCiAgICAgICAgfQogICAgfQoKICAgIGVuZCB7CiAgICAgICAgaWYoJFVzZVBTRHJpdmUgLWFuZCAkUmFuZERyaXZlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlbW92aW5nIHRlbXAgUFNEcml2ZSAkUmFuZERyaXZlIgogICAgICAgICAgICBHZXQtUFNEcml2ZSAtTmFtZSAkUmFuZERyaXZlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgUmVtb3ZlLVBTRHJpdmUKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtR3JvdXBzWE1MIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBIZWxwZXIgdG8gcGFyc2UgYSBncm91cHMueG1sIGZpbGUgcGF0aCBpbnRvIGEgY3VzdG9tIG9iamVjdC4KCiAgICAuUEFSQU1FVEVSIEdyb3Vwc1hNTHBhdGgKCiAgICAgICAgVGhlIGdyb3Vwcy54bWwgZmlsZSBwYXRoIG5hbWUgdG8gcGFyc2UuIAoKICAgIC5QQVJBTUVURVIgUmVzb2x2ZVNpZHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIFNpZHMgZnJvbSBhIERDIHBvbGljeSB0byBvYmplY3QgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgdGhlIHRhcmdldCBncm91cHMueG1sIGZvbGRlciBwYXRoIGFzIGEgdGVtcG9yYXJ5IFBTRHJpdmUuCgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JFRydWUsIFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cHNYTUxQYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXNvbHZlU2lkcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZQogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZigkVXNlUFNEcml2ZSkgewogICAgICAgICAgICAjIGlmIHdlJ3JlIFBTRHJpdmVzLCBjcmVhdGUgYSB0ZW1wb3JhcnkgbW91bnQgcG9pbnQKICAgICAgICAgICAgJFBhcnRzID0gJEdyb3Vwc1hNTFBhdGguc3BsaXQoJ1wnKQogICAgICAgICAgICAkRm9sZGVyUGF0aCA9ICRQYXJ0c1swLi4oJFBhcnRzLmxlbmd0aC0yKV0gLWpvaW4gJ1wnCiAgICAgICAgICAgICRGaWxlUGF0aCA9ICRQYXJ0c1stMV0KICAgICAgICAgICAgJFJhbmREcml2ZSA9ICgiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoiLlRvQ2hhckFycmF5KCkgfCBHZXQtUmFuZG9tIC1Db3VudCA3KSAtam9pbiAnJwogICAgICAgICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTW91bnRpbmcgcGF0aCAkR3JvdXBzWE1MUGF0aCB1c2luZyBhIHRlbXAgUFNEcml2ZSBhdCAkUmFuZERyaXZlIgoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICROdWxsID0gTmV3LVBTRHJpdmUgLU5hbWUgJFJhbmREcml2ZSAtUFNQcm92aWRlciBGaWxlU3lzdGVtIC1Sb290ICRGb2xkZXJQYXRoICAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBtb3VudGluZyBwYXRoICRHcm91cHNYTUxQYXRoIDogJF8iCiAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBzbyB3ZSBjYW4gY2QvZGlyIHRoZSBuZXcgZHJpdmUKICAgICAgICAgICAgJEdyb3Vwc1hNTFBhdGggPSAkUmFuZERyaXZlICsgIjpcIiArICRGaWxlUGF0aAogICAgICAgIH0gCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgICMgcGFyc2UgdGhlIEdyb3Vwcy54bWwgZmlsZSBpZiBpdCBleGlzdHMgCiAgICAgICAgaWYoVGVzdC1QYXRoICRHcm91cHNYTUxQYXRoKSB7CgogICAgICAgICAgICBbeG1sXSAkR3JvdXBzWE1MY29udGVudCA9IEdldC1Db250ZW50ICRHcm91cHNYTUxQYXRoCgogICAgICAgICAgICAjIHByb2Nlc3MgYWxsIGdyb3VwIHByb3BlcnRpZXMgaW4gdGhlIFhNTAogICAgICAgICAgICAkR3JvdXBzWE1MY29udGVudCB8IFNlbGVjdC1YbWwgIi8vR3JvdXAiIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgbm9kZSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAkTWVtYmVycyA9IEAoKQogICAgICAgICAgICAgICAgJE1lbWJlck9mID0gQCgpCgogICAgICAgICAgICAgICAgIyBleHRyYWN0IHRoZSBsb2NhbGdyb3VwIHNpZCBmb3IgbWVtYmVyb2YKICAgICAgICAgICAgICAgICRMb2NhbFNpZCA9ICRfLlByb3BlcnRpZXMuR3JvdXBTaWQKICAgICAgICAgICAgICAgIGlmKCEkTG9jYWxTaWQpIHsKICAgICAgICAgICAgICAgICAgICBpZigkXy5Qcm9wZXJ0aWVzLmdyb3VwTmFtZSAtbWF0Y2ggJ0FkbWluaXN0cmF0b3JzJykgewogICAgICAgICAgICAgICAgICAgICAgICAkTG9jYWxTaWQgPSAnUy0xLTUtMzItNTQ0JwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlaWYoJF8uUHJvcGVydGllcy5ncm91cE5hbWUgLW1hdGNoICdSZW1vdGUgRGVza3RvcCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsU2lkID0gJ1MtMS01LTMyLTU1NScKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRMb2NhbFNpZCA9ICRfLlByb3BlcnRpZXMuZ3JvdXBOYW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJE1lbWJlck9mID0gQCgkTG9jYWxTaWQpCgogICAgICAgICAgICAgICAgJF8uUHJvcGVydGllcy5tZW1iZXJzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICMgcHJvY2VzcyBlYWNoIG1lbWJlciBvZiB0aGUgYWJvdmUgbG9jYWwgZ3JvdXAKICAgICAgICAgICAgICAgICAgICAkXyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IE1lbWJlciB8IFdoZXJlLU9iamVjdCB7ICRfLmFjdGlvbiAtbWF0Y2ggJ0FERCcgfSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRfLnNpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgKz0gJF8uc2lkCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGp1c3QgYSBzdHJhaWdodCBsb2NhbCBhY2NvdW50IG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJzICs9ICRfLm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJE1lbWJlcnMgLW9yICRNZW1iZXJvZikgewogICAgICAgICAgICAgICAgICAgICMgZXh0cmFjdCBvdXQgYW55L2FsbCBmaWx0ZXJzLi4uSSBoYXRlIHlvdSBHUFAKICAgICAgICAgICAgICAgICAgICAkRmlsdGVycyA9ICRfLmZpbHRlcnMgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgRmlsdGVyKiB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSBAeydUeXBlJyA9ICRfLkxvY2FsTmFtZTsnVmFsdWUnID0gJF8ubmFtZX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYoJFJlc29sdmVTaWRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJvZiA9ICRNZW1iZXJvZiB8IEZvckVhY2gtT2JqZWN0IHtDb252ZXJ0LVNpZFRvTmFtZSAkX30KICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcnMgPSAkTWVtYmVycyB8IEZvckVhY2gtT2JqZWN0IHtDb252ZXJ0LVNpZFRvTmFtZSAkX30KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCRNZW1iZXJvZiAtaXNub3QgW3N5c3RlbS5hcnJheV0pIHskTWVtYmVyb2YgPSBAKCRNZW1iZXJvZil9CiAgICAgICAgICAgICAgICAgICAgaWYoJE1lbWJlcnMgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7JE1lbWJlcnMgPSBAKCRNZW1iZXJzKX0KCiAgICAgICAgICAgICAgICAgICAgJEdQT1Byb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICAnR1BPRGlzcGxheU5hbWUnID0gJEdQT0Rpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICdHUE9OYW1lJyA9ICRHUE9OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICdHUE9QYXRoJyA9ICRHcm91cHNYTUxQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICdGaWx0ZXJzJyA9ICRGaWx0ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgICdNZW1iZXJPZicgPSAkTWVtYmVyb2YKICAgICAgICAgICAgICAgICAgICAgICAgJ01lbWJlcnMnID0gJE1lbWJlcnMKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgLVR5cGVOYW1lIFBTT2JqZWN0IC1Qcm9wZXJ0eSAkR1BPUHJvcGVydGllcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGVuZCB7CiAgICAgICAgaWYoJFVzZVBTRHJpdmUgLWFuZCAkUmFuZERyaXZlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlbW92aW5nIHRlbXAgUFNEcml2ZSAkUmFuZERyaXZlIgogICAgICAgICAgICBHZXQtUFNEcml2ZSAtTmFtZSAkUmFuZERyaXZlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgUmVtb3ZlLVBTRHJpdmUKICAgICAgICB9CiAgICB9Cn0KCgoKZnVuY3Rpb24gR2V0LU5ldEdQTyB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgR2V0cyBhIGxpc3Qgb2YgYWxsIGN1cnJlbnQgR1BPcyBpbiBhIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIEdQT25hbWUKCiAgICAgICAgVGhlIEdQTyBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLiAgIAoKICAgIC5QQVJBTUVURVIgRGlzcGxheU5hbWUKCiAgICAgICAgVGhlIEdQTyBkaXNwbGF5IG5hbWUgdG8gcXVlcnkgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuICAgCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgR1BPcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2gKICAgICAgICBlLmcuICJMREFQOi8vY249ezhGRjU5RDI4LTE1RDctNDIyQS1CQ0I3LTJBRTQ1NzI0MTI1QX0sY249cG9saWNpZXMsY249c3lzdGVtLERDPWRldixEQz10ZXN0bGFiLERDPWxvY2FsIgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEdQTyAtRG9tYWluIHRlc3RsYWIubG9jYWwKICAgICAgICAKICAgICAgICBSZXR1cm5zIHRoZSBHUE9zIGluIHRoZSAndGVzdGxhYi5sb2NhbCcgZG9tYWluLiAKIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR1BPbmFtZSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRGlzcGxheU5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKCiAgICApCgogICAgYmVnaW4gewogICAgICAgICRHUE9TZWFyY2hlciA9IEdldC1Eb21haW5TZWFyY2hlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJEFEU3BhdGggLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgfQoKICAgIHByb2Nlc3MgewogICAgICAgIGlmICgkR1BPU2VhcmNoZXIpIHsKICAgICAgICAgICAgaWYoJERpc3BsYXlOYW1lKSB7CiAgICAgICAgICAgICAgICAkR1BPU2VhcmNoZXIuZmlsdGVyPSIoJihvYmplY3RDYXRlZ29yeT1ncm91cFBvbGljeUNvbnRhaW5lcikoZGlzcGxheW5hbWU9JERpc3BsYXlOYW1lKSkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkR1BPU2VhcmNoZXIuZmlsdGVyPSIoJihvYmplY3RDYXRlZ29yeT1ncm91cFBvbGljeUNvbnRhaW5lcikobmFtZT0kR1BPbmFtZSkpIgogICAgICAgICAgICB9CgogICAgICAgICAgICAkR1BPU2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAjIGNvbnZlcnQvcHJvY2VzcyB0aGUgTERBUCBmaWVsZHMgZm9yIGVhY2ggcmVzdWx0CiAgICAgICAgICAgICAgICBDb252ZXJ0LUxEQVBQcm9wZXJ0eSAtUHJvcGVydGllcyAkXy5Qcm9wZXJ0aWVzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0R1BPR3JvdXAgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybnMgYWxsIEdQT3MgaW4gYSBkb21haW4gdGhhdCBzZXQgIlJlc3RyaWN0ZWQgR3JvdXBzIgogICAgICAgIG9yIHVzZSBncm91cHMueG1sIG9uIG9uIHRhcmdldCBtYWNoaW5lcy4KCiAgICAuUEFSQU1FVEVSIEdQT25hbWUKCiAgICAgICAgVGhlIEdQTyBuYW1lIHRvIHF1ZXJ5IGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLiAgIAoKICAgIC5QQVJBTUVURVIgRGlzcGxheU5hbWUKCiAgICAgICAgVGhlIEdQTyBkaXNwbGF5IG5hbWUgdG8gcXVlcnkgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuICAgCgogICAgLlBBUkFNRVRFUiBSZXNvbHZlU2lkcwoKICAgICAgICBTd2l0Y2guIFJlc29sdmUgU2lkcyBmcm9tIGEgREMgcG9saWN5IHRvIG9iamVjdCBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBHUE9zLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaAogICAgICAgIGUuZy4gIkxEQVA6Ly9jbj17OEZGNTlEMjgtMTVENy00MjJBLUJDQjctMkFFNDU3MjQxMjVBfSxjbj1wb2xpY2llcyxjbj1zeXN0ZW0sREM9ZGV2LERDPXRlc3RsYWIsREM9bG9jYWwiCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgYW55IGZvdW5kIHBvbGljeSBmaWxlcyB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRHUE9Hcm91cAoKICAgICAgICBHZXQgYWxsIEdQT3MgdGhhdCBzZXQgbG9jYWwgZ3JvdXBzIG9uIHRoZSBjdXJyZW50IGRvbWFpbi4KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdQT25hbWUgPSAnKicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERpc3BsYXlOYW1lLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZXNvbHZlU2lkcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICAjIGdldCBldmVyeSBHUE8gZnJvbSB0aGUgc3BlY2lmaWVkIGRvbWFpbiB3aXRoIHJlc3RyaWN0ZWQgZ3JvdXBzIHNldAogICAgR2V0LU5ldEdQTyAtR1BPTmFtZSAkR1BPbmFtZSAtRGlzcGxheU5hbWUgJEdQT25hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1BRFNwYXRoICRBRFNwYXRoIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JlYWNoLU9iamVjdCB7CgogICAgICAgICRNZW1iZXJvZiA9ICROdWxsCiAgICAgICAgJE1lbWJlcnMgPSAkTnVsbAogICAgICAgICRHUE9kaXNwbGF5TmFtZSA9ICRfLmRpc3BsYXluYW1lCiAgICAgICAgJEdQT25hbWUgPSAkXy5uYW1lCiAgICAgICAgJEdQT1BhdGggPSAkXy5ncGNmaWxlc3lzcGF0aAoKICAgICAgICAkUGFyc2VBcmdzID0gIEB7CiAgICAgICAgICAgICdHcHRUbXBsUGF0aCcgPSAiJEdQT1BhdGhcTUFDSElORVxNaWNyb3NvZnRcV2luZG93cyBOVFxTZWNFZGl0XEdwdFRtcGwuaW5mIgogICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgIH0KCiAgICAgICAgIyBwYXJzZSB0aGUgR3B0VG1wbC5pbmYgJ1Jlc3RyaWN0ZWQgR3JvdXBzJyBmaWxlIGlmIGl0IGV4aXN0cwogICAgICAgICRJbmYgPSBHZXQtR3B0VG1wbCBAUGFyc2VBcmdzCgogICAgICAgIGlmKCRJbmYuR3JvdXBNZW1iZXJzaGlwKSB7CgogICAgICAgICAgICAkTWVtYmVyb2YgPSAkSW5mLkdyb3VwTWVtYmVyc2hpcCB8IEdldC1NZW1iZXIgKk1lbWJlcm9mIHwgRm9yRWFjaC1PYmplY3QgeyAkSW5mLkdyb3VwTWVtYmVyc2hpcC4oJF8ubmFtZSkgfSB8IEZvckVhY2gtT2JqZWN0IHsgJF8udHJpbSgnKicpIH0KICAgICAgICAgICAgJE1lbWJlcnMgPSAkSW5mLkdyb3VwTWVtYmVyc2hpcCB8IEdldC1NZW1iZXIgKk1lbWJlcnMgfCBGb3JFYWNoLU9iamVjdCB7ICRJbmYuR3JvdXBNZW1iZXJzaGlwLigkXy5uYW1lKSB9IHwgRm9yRWFjaC1PYmplY3QgeyAkXy50cmltKCcqJykgfQoKICAgICAgICAgICAgIyBvbmx5IHJldHVybiBhbiBvYmplY3QgaWYgTWVtYmVycyBhcmUgZm91bmQKICAgICAgICAgICAgaWYgKCRNZW1iZXJzIC1vciAkTWVtYmVyb2YpIHsKCiAgICAgICAgICAgICAgICAjIGlmIHRoZXJlIGlzIG5vIE1lbWJlcm9mIGRlZmluZWQsIGFzc3VtZSBsb2NhbCBhZG1pbnMKICAgICAgICAgICAgICAgIGlmKCEkTWVtYmVyb2YpIHsKICAgICAgICAgICAgICAgICAgICAkTWVtYmVyb2YgPSAnUy0xLTUtMzItNTQ0JwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCRSZXNvbHZlU2lkcykgewogICAgICAgICAgICAgICAgICAgICRNZW1iZXJvZiA9ICRNZW1iZXJvZiB8IEZvckVhY2gtT2JqZWN0IHtDb252ZXJ0LVNpZFRvTmFtZSAkX30KICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9ICRNZW1iZXJzIHwgRm9yRWFjaC1PYmplY3Qge0NvbnZlcnQtU2lkVG9OYW1lICRffQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCRNZW1iZXJvZiAtaXNub3QgW3N5c3RlbS5hcnJheV0pIHskTWVtYmVyb2YgPSBAKCRNZW1iZXJvZil9CiAgICAgICAgICAgICAgICBpZigkTWVtYmVycyAtaXNub3QgW3N5c3RlbS5hcnJheV0pIHskTWVtYmVycyA9IEAoJE1lbWJlcnMpfQoKICAgICAgICAgICAgICAgICRHUE9Qcm9wZXJ0aWVzID0gQHsKICAgICAgICAgICAgICAgICAgICAnR1BPRGlzcGxheU5hbWUnID0gJEdQT0Rpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgJ0dQT05hbWUnID0gJEdQT05hbWUKICAgICAgICAgICAgICAgICAgICAnR1BPUGF0aCcgPSAkR1BPUGF0aAogICAgICAgICAgICAgICAgICAgICdGaWx0ZXJzJyA9ICROdWxsCiAgICAgICAgICAgICAgICAgICAgJ01lbWJlck9mJyA9ICRNZW1iZXJvZgogICAgICAgICAgICAgICAgICAgICdNZW1iZXJzJyA9ICRNZW1iZXJzCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5ICRHUE9Qcm9wZXJ0aWVzCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRQYXJzZUFyZ3MgPSAgQHsKICAgICAgICAgICAgJ0dyb3Vwc1hNTHBhdGgnID0gIiRHUE9QYXRoXE1BQ0hJTkVcUHJlZmVyZW5jZXNcR3JvdXBzXEdyb3Vwcy54bWwiCiAgICAgICAgICAgICdSZXNvbHZlU2lkcycgPSAkUmVzb2x2ZVNpZHMKICAgICAgICAgICAgJ1VzZVBTRHJpdmUnID0gJFVzZVBTRHJpdmUKICAgICAgICB9CgogICAgICAgIEdldC1Hcm91cHNYTUwgQFBhcnNlQXJncwogICAgfQp9CgoKZnVuY3Rpb24gRmluZC1HUE9Mb2NhdGlvbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGFrZXMgYSB1c2VyL2dyb3VwIG5hbWUgYW5kIG9wdGlvbmFsIGRvbWFpbiwgYW5kIGRldGVybWluZXMgCiAgICAgICAgdGhlIGNvbXB1dGVycyBpbiB0aGUgZG9tYWluIHRoZSB1c2VyL2dyb3VwIGhhcyBsb2NhbCBhZG1pbiAKICAgICAgICAob3IgUkRQKSByaWdodHMgdG8uCgogICAgICAgIEl0IGRvZXMgdGhpcyBieToKICAgICAgICAgICAgMS4gIHJlc29sdmluZyB0aGUgdXNlci9ncm91cCB0byBpdHMgcHJvcGVyIHNpZAogICAgICAgICAgICAyLiAgZW51bWVyYXRpbmcgYWxsIGdyb3VwcyB0aGUgdXNlci9ncm91cCBpcyBhIGN1cnJlbnQgcGFydCBvZiAKICAgICAgICAgICAgICAgIGFuZCBleHRyYWN0aW5nIGFsbCB0YXJnZXQgU0lEcyB0byBidWlsZCBhIHRhcmdldCBTSUQgbGlzdAogICAgICAgICAgICAzLiAgcHVsbGluZyBhbGwgR1BPcyB0aGF0IHNldCAnUmVzdHJpY3RlZCBHcm91cHMnIGJ5IGNhbGxpbmcKICAgICAgICAgICAgICAgIEdldC1OZXRHUE9Hcm91cAogICAgICAgICAgICA0LiAgbWF0Y2hpbmcgdGhlIHRhcmdldCBzaWQgbGlzdCB0byB0aGUgcXVlcmllZCBHUE8gU0lEIGxpc3QKICAgICAgICAgICAgICAgIHRvIGVudW1lcmF0ZSBhbGwgR1BPIHRoZSB1c2VyIGlzIGVmZmVjdGl2ZWx5IGFwcGxpZWQgd2l0aAogICAgICAgICAgICA1LiAgZW51bWVyYXRpbmcgYWxsIE9VcyBhbmQgc2l0ZXMgYW5kIGFwcGxpY2FibGUgR1BPIEdVSXMgYXJlCiAgICAgICAgICAgICAgICBhcHBsaWVkIHRvIHRocm91Z2ggZ3BsaW5rIGVudW1lcmF0aW5nCiAgICAgICAgICAgIDYuICBxdWVyeWluZyBmb3IgYWxsIGNvbXB1dGVycyB1bmRlciB0aGUgZ2l2ZW4gT1VzIG9yIHNpdGVzCgogICAgLlBBUkFNRVRFUiBVc2VyTmFtZQoKICAgICAgICBBIChzaW5nbGUpIHVzZXIgbmFtZSBuYW1lIHRvIHF1ZXJ5IGZvciBhY2Nlc3MuCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgQSAoc2luZ2xlKSBncm91cCBuYW1lIG5hbWUgdG8gcXVlcnkgZm9yIGFjY2Vzcy4gCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgT3B0aW9uYWwgZG9tYWluIHRoZSB1c2VyIGV4aXN0cyBpbiBmb3IgcXVlcnlpbmcsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIExvY2FsR3JvdXAKCiAgICAgICAgVGhlIGxvY2FsIGdyb3VwIHRvIGNoZWNrIGFjY2VzcyBhZ2FpbnN0LgogICAgICAgIENhbiBiZSAiQWRtaW5pc3RyYXRvcnMiIChTLTEtNS0zMi01NDQpLCAiUkRQL1JlbW90ZSBEZXNrdG9wIFVzZXJzIiAoUy0xLTUtMzItNTU1KSwKICAgICAgICBvciBhIGN1c3RvbSBsb2NhbCBTSUQuIERlZmF1bHRzIHRvIGxvY2FsICdBZG1pbmlzdHJhdG9ycycuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgYW55IGZvdW5kIHBvbGljeSBmaWxlcyB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtR1BPTG9jYXRpb24gLVVzZXJOYW1lIGRmbQogICAgICAgIAogICAgICAgIEZpbmQgYWxsIGNvbXB1dGVycyB0aGF0IGRmbSB1c2VyIGhhcyBsb2NhbCBhZG1pbmlzdHJhdG9yIHJpZ2h0cyB0byBpbiAKICAgICAgICB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUdQT0xvY2F0aW9uIC1Vc2VyTmFtZSBkZm0gLURvbWFpbiBkZXYudGVzdGxhYi5sb2NhbAogICAgICAgIAogICAgICAgIEZpbmQgYWxsIGNvbXB1dGVycyB0aGF0IGRmbSB1c2VyIGhhcyBsb2NhbCBhZG1pbmlzdHJhdG9yIHJpZ2h0cyB0byBpbiAKICAgICAgICB0aGUgZGV2LnRlc3RsYWIubG9jYWwgZG9tYWluLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1HUE9Mb2NhdGlvbiAtVXNlck5hbWUgamFzb24gLUxvY2FsR3JvdXAgUkRQCiAgICAgICAgCiAgICAgICAgRmluZCBhbGwgY29tcHV0ZXJzIHRoYXQgamFzb24gaGFzIGxvY2FsIFJEUCBhY2Nlc3MgcmlnaHRzIHRvIGluIHRoZSBkb21haW4uCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExvY2FsR3JvdXAgPSAnQWRtaW5pc3RyYXRvcnMnLAogICAgICAgIAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFVzZVBTRHJpdmUsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGlmKCRVc2VyTmFtZSkgewoKICAgICAgICAkVXNlciA9IEdldC1OZXRVc2VyIC1Vc2VyTmFtZSAkVXNlck5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAkVXNlclNpZCA9ICRVc2VyLm9iamVjdHNpZAoKICAgICAgICBpZighJFVzZXJTaWQpIHsgICAgCiAgICAgICAgICAgIFRocm93ICJVc2VyICckVXNlck5hbWUnIG5vdCBmb3VuZCEiCiAgICAgICAgfQoKICAgICAgICAkVGFyZ2V0U2lkID0gJFVzZXJTaWQKICAgICAgICAkT2JqZWN0U2FtQWNjb3VudE5hbWUgPSAkVXNlci5zYW1hY2NvdW50bmFtZQogICAgICAgICRPYmplY3REaXN0TmFtZSA9ICRVc2VyLmRpc3Rpbmd1aXNoZWRuYW1lCiAgICB9CiAgICBlbHNlaWYoJEdyb3VwTmFtZSkgewoKICAgICAgICAkR3JvdXAgPSBHZXQtTmV0R3JvdXAgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgICRHcm91cFNpZCA9ICRHcm91cC5vYmplY3RzaWQKCiAgICAgICAgaWYoISRHcm91cFNpZCkgeyAgICAKICAgICAgICAgICAgVGhyb3cgIkdyb3VwICckR3JvdXBOYW1lJyBub3QgZm91bmQhIgogICAgICAgIH0KCiAgICAgICAgJFRhcmdldFNpZCA9ICRHcm91cFNpZAogICAgICAgICRPYmplY3RTYW1BY2NvdW50TmFtZSA9ICRHcm91cC5zYW1hY2NvdW50bmFtZQogICAgICAgICRPYmplY3REaXN0TmFtZSA9ICRHcm91cC5kaXN0aW5ndWlzaGVkbmFtZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgdGhyb3cgIi1Vc2VyTmFtZSBvciAtR3JvdXBOYW1lIG11c3QgYmUgc3BlY2lmaWVkISIKICAgIH0KCiAgICBpZigkTG9jYWxHcm91cCAtbGlrZSAiKkFkbWluKiIpIHsKICAgICAgICAkTG9jYWxTSUQgPSAiUy0xLTUtMzItNTQ0IgogICAgfQogICAgZWxzZWlmICggKCRMb2NhbEdyb3VwIC1saWtlICIqUkRQKiIpIC1vciAoJExvY2FsR3JvdXAgLWxpa2UgIipSZW1vdGUqIikgKSB7CiAgICAgICAgJExvY2FsU0lEID0gIlMtMS01LTMyLTU1NSIKICAgIH0KICAgIGVsc2VpZiAoJExvY2FsR3JvdXAgLWxpa2UgIlMtMS01KiIpIHsKICAgICAgICAkTG9jYWxTSUQgPSAkTG9jYWxHcm91cAogICAgfQogICAgZWxzZSB7CiAgICAgICAgdGhyb3cgIkxvY2FsR3JvdXAgbXVzdCBiZSAnQWRtaW5pc3RyYXRvcnMnLCAnUkRQJywgb3IgYSAnUy0xLTUtWCcgdHlwZSBzaWQuIgogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgIkxvY2FsU2lkOiAkTG9jYWxTSUQiCiAgICBXcml0ZS1WZXJib3NlICJUYXJnZXRTaWQ6ICRUYXJnZXRTaWQiCiAgICBXcml0ZS1WZXJib3NlICJUYXJnZXRPYmplY3REaXN0TmFtZTogJE9iamVjdERpc3ROYW1lIgoKICAgIGlmKCRUYXJnZXRTaWQgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7ICRUYXJnZXRTaWQgPSBAKCRUYXJnZXRTaWQpIH0KCiAgICAjIHVzZSB0aGUgdG9rZW5Hcm91cHMgYXBwcm9hY2ggZnJvbSBHZXQtTmV0R3JvdXAgdG8gZ2V0IGFsbCBlZmZlY3RpdmUKICAgICMgICBzZWN1cml0eSBTSURzIHRoaXMgb2JqZWN0IGlzIGEgcGFydCBvZgogICAgJFRhcmdldFNpZCArPSBHZXQtTmV0R3JvdXAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUgLVVzZXJOYW1lICRPYmplY3RTYW1BY2NvdW50TmFtZSAtUmF3U2lkcwoKICAgIGlmKCRUYXJnZXRTaWQgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7ICRUYXJnZXRTaWQgPSBAKCRUYXJnZXRTaWQpIH0KCiAgICBXcml0ZS1WZXJib3NlICJFZmZlY3RpdmUgdGFyZ2V0IHNpZHM6ICRUYXJnZXRTaWQiCgogICAgJEdQT0dyb3VwQXJncyA9ICBAewogICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICdEb21haW5Db250cm9sbGVyJyA9ICREb21haW5Db250cm9sbGVyCiAgICAgICAgJ1VzZVBTRHJpdmUnID0gJFVzZVBTRHJpdmUKICAgICAgICAnUGFnZVNpemUnID0gJFBhZ2VTaXplCiAgICB9CgogICAgIyBnZXQgYWxsIEdQTyBncm91cHMsIGFuZCBmaWx0ZXIgb24gb25lcyB0aGF0IG1hdGNoIG91ciB0YXJnZXQgU0lEIGxpc3QKICAgICMgICBhbmQgbWF0Y2ggdGhlIHRhcmdldCBsb2NhbCBzaWQgbWVtYmVyb2YgbGlzdAogICAgJEdQT2dyb3VwcyA9IEdldC1OZXRHUE9Hcm91cCBAR1BPR3JvdXBBcmdzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgIAogICAgICAgIGlmICgkXy5tZW1iZXJzKSB7CiAgICAgICAgICAgICRfLm1lbWJlcnMgPSAkXy5tZW1iZXJzIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICBpZigkXyAtbWF0Y2ggIlMtMS01IikgewogICAgICAgICAgICAgICAgICAgICRfCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZXJlIGFyZSBhbnkgcGxhaW4gZ3JvdXAgbmFtZXMsIHRyeSB0byByZXNvbHZlIHRoZW0gdG8gc2lkcwogICAgICAgICAgICAgICAgICAgIENvbnZlcnQtTmFtZVRvU2lkIC1PYmplY3ROYW1lICRfIC1Eb21haW4gJERvbWFpbgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHN0b3AgUG93ZXJTaGVsbCAyLjAncyBzdHJpbmcgc3R1cGlkIHVuYm94aW5nCiAgICAgICAgICAgIGlmKCRfLm1lbWJlcnMgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7ICRfLm1lbWJlcnMgPSBAKCRfLm1lbWJlcnMpIH0KICAgICAgICAgICAgaWYoJF8ubWVtYmVyb2YgLWlzbm90IFtzeXN0ZW0uYXJyYXldKSB7ICRfLm1lbWJlcm9mID0gQCgkXy5tZW1iZXJvZikgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYoJF8ubWVtYmVycykgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAjIG9ubHkgcmV0dXJuIGdyb3VwcyB0aGF0IGNvbnRhaW4gYSB0YXJnZXQgc2lkCgogICAgICAgICAgICAgICAgICAgICMgVE9ETzogZml4IHN0dXBpZCB3ZWlyZCAiLURpZmZlcmVuY2VPYmplY3QiIGlzIG51bGwgZXJyb3IKICAgICAgICAgICAgICAgICAgICBpZiggKENvbXBhcmUtT2JqZWN0IC1SZWZlcmVuY2VPYmplY3QgJF8ubWVtYmVycyAtRGlmZmVyZW5jZU9iamVjdCAkVGFyZ2V0U2lkIC1JbmNsdWRlRXF1YWwgLUV4Y2x1ZGVEaWZmZXJlbnQpICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF8ubWVtYmVyb2YgLWNvbnRhaW5zICRMb2NhbFNpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGNvbXBhcmluZyBtZW1iZXJzIGFuZCAkVGFyZ2V0U2lkIDogJF8iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgV3JpdGUtVmVyYm9zZSAiR1BPZ3JvdXBzOiAkR1BPZ3JvdXBzIgogICAgJFByb2Nlc3NlZEdVSURzID0gQHt9CgogICAgIyBwcm9jZXNzIHRoZSBtYXRjaGVzIGFuZCBidWlsZCB0aGUgcmVzdWx0IG9iamVjdHMKICAgICRHUE9ncm91cHMgfCBXaGVyZS1PYmplY3QgeyRffSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgJEdQT2d1aWQgPSAkXy5HUE9OYW1lCgogICAgICAgIGlmKCAtbm90ICRQcm9jZXNzZWRHVUlEc1skR1BPZ3VpZF0gKSB7CiAgICAgICAgICAgICRHUE9uYW1lID0gJF8uR1BPRGlzcGxheU5hbWUKICAgICAgICAgICAgJEZpbHRlcnMgPSAkXy5GaWx0ZXJzCgogICAgICAgICAgICAjIGZpbmQgYW55IE9VcyB0aGF0IGhhdmUgdGhpcyBHVUlEIGFwcGxpZWQKICAgICAgICAgICAgR2V0LU5ldE9VIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtR1VJRCAkR1BPZ3VpZCAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICBpZigkRmlsdGVycykgewogICAgICAgICAgICAgICAgICAgICMgZmlsdGVyIGZvciBjb21wdXRlciBuYW1lL29yZyB1bml0IGlmIGEgZmlsdGVyIGlzIHNwZWNpZmllZAogICAgICAgICAgICAgICAgICAgICMgICBUT0RPOiBoYW5kbGUgb3RoZXIgZmlsdGVycz8KICAgICAgICAgICAgICAgICAgICAkT1VDb21wdXRlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLUFEU3BhdGggJF8uQURTcGF0aCAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLmFkc3BhdGggLW1hdGNoICgkRmlsdGVycy5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9IHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkT1VDb21wdXRlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLUFEU3BhdGggJF8uQURTcGF0aCAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJEdQT0xvY2F0aW9uID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgJEdQT0xvY2F0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdE5hbWUnICRPYmplY3REaXN0TmFtZQogICAgICAgICAgICAgICAgJEdQT0xvY2F0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dQT25hbWUnICRHUE9uYW1lCiAgICAgICAgICAgICAgICAkR1BPTG9jYXRpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPZ3VpZCcgJEdQT2d1aWQKICAgICAgICAgICAgICAgICRHUE9Mb2NhdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb250YWluZXJOYW1lJyAkXy5kaXN0aW5ndWlzaGVkbmFtZQogICAgICAgICAgICAgICAgJEdQT0xvY2F0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVycycgJE9VQ29tcHV0ZXJzCiAgICAgICAgICAgICAgICAkR1BPTG9jYXRpb24KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBmaW5kIGFueSBzaXRlcyB0aGF0IGhhdmUgdGhpcyBHVUlEIGFwcGxpZWQKICAgICAgICAgICAgIyBUT0RPOiBmaXgsIHRoaXMgaXNuJ3QgdGhlIGNvcnJlY3Qgd2F5IHRvIHF1ZXJ5IGNvbXB1dGVycyBmcm9tIGEgc2l0ZS4uLgogICAgICAgICAgICAjIEdldC1OZXRTaXRlIC1HVUlEICRHUE9ndWlkIC1GdWxsRGF0YSB8IEZvcmVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgIyAgICAgaWYoJEZpbHRlcnMpIHsKICAgICAgICAgICAgIyAgICAgICAgICMgZmlsdGVyIGZvciBjb21wdXRlciBuYW1lL29yZyB1bml0IGlmIGEgZmlsdGVyIGlzIHNwZWNpZmllZAogICAgICAgICAgICAjICAgICAgICAgIyAgIFRPRE86IGhhbmRsZSBvdGhlciBmaWx0ZXJzPwogICAgICAgICAgICAjICAgICAgICAgJFNpdGVDb21wdHVlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLUFEU3BhdGggJF8uQURTcGF0aCAtRnVsbERhdGEgfCA/IHsKICAgICAgICAgICAgIyAgICAgICAgICAgICAkXy5hZHNwYXRoIC1tYXRjaCAoJEZpbHRlcnMuVmFsdWUpCiAgICAgICAgICAgICMgICAgICAgICB9IHwgRm9yZWFjaC1PYmplY3QgeyRfLmRuc2hvc3RuYW1lfQogICAgICAgICAgICAjICAgICB9CiAgICAgICAgICAgICMgICAgIGVsc2UgewogICAgICAgICAgICAjICAgICAgICAgJFNpdGVDb21wdHVlcnMgPSBHZXQtTmV0Q29tcHV0ZXIgLUFEU3BhdGggJF8uQURTcGF0aAogICAgICAgICAgICAjICAgICB9CgogICAgICAgICAgICAjICAgICAkU2l0ZUNvbXB0dWVycyA9IEdldC1OZXRDb21wdXRlciAtQURTcGF0aCAkXy5BRFNwYXRoCiAgICAgICAgICAgICMgICAgICRvdXQgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICMgICAgICRvdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0JyAkT2JqZWN0RGlzdE5hbWUKICAgICAgICAgICAgIyAgICAgJG91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHUE9uYW1lJyAkR1BPbmFtZQogICAgICAgICAgICAjICAgICAkb3V0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dQT2d1aWQnICRHUE9ndWlkCiAgICAgICAgICAgICMgICAgICRvdXQgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29udGFpbmVyTmFtZScgJF8uZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgIyAgICAgJG91dCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlcnMnICRPVUNvbXB1dGVycwogICAgICAgICAgICAjICAgICAkb3V0CiAgICAgICAgICAgICMgfQoKICAgICAgICAgICAgIyBtYXJrIG9mZiB0aGlzIEdQTyBHVUlEIHNvIHdlIGRvbid0IHByb2Nlc3MgaXQgYWdhaW4gaWYgdGhlcmUgYXJlIGR1cGVzCiAgICAgICAgICAgICRQcm9jZXNzZWRHVUlEc1skR1BPZ3VpZF0gPSAkVHJ1ZQogICAgICAgIH0KICAgIH0KCn0KCgpmdW5jdGlvbiBGaW5kLUdQT0NvbXB1dGVyQWRtaW4gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRha2VzIGEgY29tcHV0ZXIgKG9yIEdQTykgb2JqZWN0IGFuZCBkZXRlcm1pbmVzIHdoYXQgdXNlcnMvZ3JvdXBzIGhhdmUgCiAgICAgICAgYWRtaW5pc3RyYXRpdmUgYWNjZXNzIG92ZXIgaXQuCgogICAgICAgIEludmVyc2Ugb2YgRmluZC1HUE9Mb2NhdGlvbi4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgY29tcHV0ZXIgdG8gZGV0ZXJtaW5lIGxvY2FsIGFkbWluaXN0cmF0aXZlIGFjY2VzcyB0by4KCiAgICAuUEFSQU1FVEVSIE9VTmFtZQoKICAgICAgICBPVSBuYW1lIHRvIGRldGVybWluZSB3aG8gaGFzIGxvY2FsIGFkbWluaXNydGF0aXZlIGFjZXNzIHRvIGNvbXB1dGVycwogICAgICAgIHdpdGhpbiBpdC4gCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgT3B0aW9uYWwgZG9tYWluIHRoZSBjb21wdXRlci9PVSBleGlzdHMgaW4sIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFJlY3Vyc2UKCiAgICAgICAgU3dpdGNoLiBJZiBhIHJldHVybmVkIG1lbWJlciBpcyBhIGdyb3VwLCByZWN1cnNlIGFuZCBnZXQgYWxsIG1lbWJlcnMuCgogICAgLlBBUkFNRVRFUiBMb2NhbEdyb3VwCgogICAgICAgIFRoZSBsb2NhbCBncm91cCB0byBjaGVjayBhY2Nlc3MgYWdhaW5zdC4KICAgICAgICBDYW4gYmUgIkFkbWluaXN0cmF0b3JzIiAoUy0xLTUtMzItNTQ0KSwgIlJEUC9SZW1vdGUgRGVza3RvcCBVc2VycyIgKFMtMS01LTMyLTU1NSksCiAgICAgICAgb3IgYSBjdXN0b20gbG9jYWwgU0lELgogICAgICAgIERlZmF1bHRzIHRvIGxvY2FsICdBZG1pbmlzdHJhdG9ycycuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgYW55IGZvdW5kIHBvbGljeSBmaWxlcyB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtR1BPQ29tcHV0ZXJBZG1pbiAtQ29tcHV0ZXJOYW1lIFdJTkRPV1MzLmRldi50ZXN0bGFiLmxvY2FsCiAgICAgICAgCiAgICAgICAgRmluZHMgdXNlcnMgd2hvIGhhdmUgbG9jYWwgYWRtaW4gcmlnaHRzIG92ZXIgV0lORE9XUzMgdGhyb3VnaCBHUE8gY29ycmVsYXRpb24uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBGaW5kLUdQT0NvbXB1dGVyQWRtaW4gLUNvbXB1dGVyTmFtZSBXSU5ET1dTMy5kZXYudGVzdGxhYi5sb2NhbCAtTG9jYWxHcm91cCBSRFAKICAgICAgICAKICAgICAgICBGaW5kcyB1c2VycyB3aG8gaGF2ZSBSRFAgcmlnaHRzIG92ZXIgV0lORE9XUzMgdGhyb3VnaCBHUE8gY29ycmVsYXRpb24uCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE9VTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRSZWN1cnNlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRMb2NhbEdyb3VwID0gJ0FkbWluaXN0cmF0b3JzJywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZSwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAKICAgICAgICBpZighJENvbXB1dGVyTmFtZSAtYW5kICEkT1VOYW1lKSB7CiAgICAgICAgICAgIFRocm93ICItQ29tcHV0ZXJOYW1lIG9yIC1PVU5hbWUgbXVzdCBiZSBwcm92aWRlZCIKICAgICAgICB9CgogICAgICAgIGlmKCRDb21wdXRlck5hbWUpIHsKICAgICAgICAgICAgJENvbXB1dGVycyA9IEdldC1OZXRDb21wdXRlciAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1GdWxsRGF0YSAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgICAgICBpZighJENvbXB1dGVycykgewogICAgICAgICAgICAgICAgdGhyb3cgIkNvbXB1dGVyICRDb21wdXRlciBpbiBkb21haW4gJyREb21haW4nIG5vdCBmb3VuZCEiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEZvckVhY2goJENvbXB1dGVyIGluICRDb21wdXRlcnMpIHsKICAgICAgICAgICAgICAgICMgZXh0cmFjdCBhbGwgT1VzIGEgY29tcHV0ZXIgaXMgYSBwYXJ0IG9mCiAgICAgICAgICAgICAgICAkRE4gPSAkQ29tcHV0ZXIuZGlzdGluZ3Vpc2hlZG5hbWUKCiAgICAgICAgICAgICAgICAkVGFyZ2V0T1VzID0gJEROLnNwbGl0KCIsIikgfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYoJF8uc3RhcnRzd2l0aCgiT1U9IikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEROLnN1YnN0cmluZygkRE4uaW5kZXhvZigkXykpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkVGFyZ2V0T1VzID0gQCgkT1VOYW1lKQogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVGFyZ2V0IE9VczogJFRhcmdldE9VcyIKCiAgICAgICAgJFRhcmdldE9VcyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yZWFjaC1PYmplY3QgewoKICAgICAgICAgICAgJE9VID0gJF8KCiAgICAgICAgICAgICMgZm9yIGVhY2ggT1UgdGhlIGNvbXB1dGVyIGlzIGEgcGFydCBvZiwgZ2V0IHRoZSBmdWxsIE9VIG9iamVjdAogICAgICAgICAgICAkR1BPZ3JvdXBzID0gR2V0LU5ldE9VIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkXyAtRnVsbERhdGEgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IEZvcmVhY2gtT2JqZWN0IHsgCiAgICAgICAgICAgICAgICAjIGFuZCB0aGVuIGdldCBhbnkgR1BPIGxpbmtzCiAgICAgICAgICAgICAgICAkXy5ncGxpbmsuc3BsaXQoIl1bIikgfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRfLnN0YXJ0c3dpdGgoIkxEQVAiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkXy5zcGxpdCgiOyIpWzBdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgJEdQT0dyb3VwQXJncyA9ICBAewogICAgICAgICAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAgICAgICAgICdEb21haW5Db250cm9sbGVyJyA9ICREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgICAgICAgICAgJ0FEU3BhdGgnID0gJF8KICAgICAgICAgICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgICAgICAgICAgICAgICdQYWdlU2l6ZScgPSAkUGFnZVNpemUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjIGZvciBlYWNoIEdQTyBsaW5rLCBnZXQgYW55IGxvY2FsbHkgc2V0IHVzZXIvZ3JvdXAgU0lEcwogICAgICAgICAgICAgICAgR2V0LU5ldEdQT0dyb3VwIEBHUE9Hcm91cEFyZ3MKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBmb3IgZWFjaCBmb3VuZCBHUE8gZ3JvdXAsIHJlc29sdmUgdGhlIFNJRHMgb2YgdGhlIG1lbWJlcnMKICAgICAgICAgICAgJEdQT2dyb3VwcyB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgJEdQTyA9ICRfCiAgICAgICAgICAgICAgICAkR1BPLm1lbWJlcnMgfCBGb3JlYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICMgcmVzb2x2ZXRoaXMgU0lEIHRvIGEgZG9tYWluIG9iamVjdAogICAgICAgICAgICAgICAgICAgICRPYmplY3QgPSBHZXQtQURPYmplY3QgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyICRfIC1QYWdlU2l6ZSAkUGFnZVNpemUKCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT1UnICRPVQogICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dQT0Rpc3BsYXlOYW1lJyAkR1BPLkdQT0Rpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR1BPUGF0aCcgJEdQTy5HUE9QYXRoCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0TmFtZScgJE9iamVjdC5uYW1lCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnT2JqZWN0RE4nICRPYmplY3QuZGlzdGluZ3Vpc2hlZG5hbWUKICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3RTSUQnICRfCiAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJCgkT2JqZWN0LnNhbWFjY291bnR0eXBlIC1ub3RtYXRjaCAnODA1MzA2MzY4JykKICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiAKCiAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSByZWN1cnNpbmcgYW5kIHRoZSBjdXJyZW50IHJlc3VsdCBvYmplY3QgaXMgYSBncm91cAogICAgICAgICAgICAgICAgICAgIGlmKCRSZWN1cnNlIC1hbmQgJEdQT0NvbXB1dGVyQWRtaW4uaXNHcm91cCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgR2V0LU5ldEdyb3VwTWVtYmVyIC1TSUQgJF8gLUZ1bGxEYXRhIC1SZWN1cnNlIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBGb3JlYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckROID0gJF8uZGlzdGluZ3Vpc2hlZE5hbWUKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGV4dHJhY3QgdGhlIEZRRE4gZnJvbSB0aGUgRGlzdGluZ3Vpc2hlZCBOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyRG9tYWluID0gJE1lbWJlckROLnN1YlN0cmluZygkTWVtYmVyRE4uSW5kZXhPZigiREM9IikpIC1yZXBsYWNlICdEQz0nLCcnIC1yZXBsYWNlICcsJywnLicKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF8uc2FtQWNjb3VudFR5cGUgLW5lICI4MDUzMDYzNjgiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcklzR3JvdXAgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcklzR3JvdXAgPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF8uc2FtQWNjb3VudE5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGZvcmVzdCB1c2VycyBoYXZlIHRoZSBzYW1BY2NvdW50TmFtZSBzZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyTmFtZSA9ICRfLnNhbUFjY291bnROYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGV4dGVybmFsIHRydXN0IHVzZXJzIGhhdmUgYSBTSUQsIHNvIGNvbnZlcnQgaXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyTmFtZSA9IENvbnZlcnQtU2lkVG9OYW1lICRfLmNuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB0aGVyZSdzIGEgcHJvYmxlbSBjb250YWN0aW5nIHRoZSBkb21haW4gdG8gcmVzb2x2ZSB0aGUgU0lECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXJOYW1lID0gJF8uY24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09VJyAkT1UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dQT0Rpc3BsYXlOYW1lJyAkR1BPLkdQT0Rpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHUE9QYXRoJyAkR1BPLkdQT1BhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdE5hbWUnICRNZW1iZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3RETicgJE1lbWJlckROCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkR1BPQ29tcHV0ZXJBZG1pbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdPYmplY3RTSUQnICRfLm9iamVjdHNpZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdQT0NvbXB1dGVyQWRtaW4gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJE1lbWJlcklzR3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRHUE9Db21wdXRlckFkbWluIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LURvbWFpblBvbGljeSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJucyB0aGUgZGVmYXVsdCBkb21haW4gb3IgREMgcG9saWN5IGZvciBhIGdpdmVuCiAgICAgICAgZG9tYWluIG9yIGRvbWFpbiBjb250cm9sbGVyLgoKICAgICAgICBUaGFua3MgU2VhbiBNZXRhY2FsZiAoQHB5cm90ZWszKSBmb3IgdGhlIGlkZWEgYW5kIGd1aWRhbmNlLgoKICAgIC5QQVJBTUVURVIgU291cmNlCgogICAgICAgIEV4dHJhY3QgRG9tYWluIG9yIERDIChkb21haW4gY29udHJvbGxlcikgcG9saWNpZXMuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgVGhlIGRvbWFpbiB0byBxdWVyeSBmb3IgZGVmYXVsdCBwb2xpY2llcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUmVzb2x2ZVNpZHMKCiAgICAgICAgU3dpdGNoLiBSZXNvbHZlIFNpZHMgZnJvbSBhIERDIHBvbGljeSB0byBvYmplY3QgbmFtZXMuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgYW55IGZvdW5kIHBvbGljeSBmaWxlcyB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRHUE8KCiAgICAgICAgUmV0dXJucyB0aGUgR1BPcyBpbiB0aGUgY3VycmVudCBkb21haW4uIAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbSAoCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIkRvbWFpbiIsIkRDIildCiAgICAgICAgJFNvdXJjZSA9IkRvbWFpbiIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVzb2x2ZVNpZHMsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFVzZVBTRHJpdmUKICAgICkKCiAgICBpZigkU291cmNlIC1lcSAiRG9tYWluIikgewogICAgICAgICMgcXVlcnkgdGhlIGdpdmVuIGRvbWFpbiBmb3IgdGhlIGRlZmF1bHQgZG9tYWluIHBvbGljeSBvYmplY3QKICAgICAgICAkR1BPID0gR2V0LU5ldEdQTyAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUdQT25hbWUgInszMUIyRjM0MC0wMTZELTExRDItOTQ1Ri0wMEMwNEZCOTg0Rjl9IgogICAgICAgIAogICAgICAgIGlmKCRHUE8pIHsKICAgICAgICAgICAgIyBncmFiIHRoZSBHcHRUbXBsLmluZiBmaWxlIGFuZCBwYXJzZSBpdAogICAgICAgICAgICAkR3B0VG1wbFBhdGggPSAkR1BPLmdwY2ZpbGVzeXNwYXRoICsgIlxNQUNISU5FXE1pY3Jvc29mdFxXaW5kb3dzIE5UXFNlY0VkaXRcR3B0VG1wbC5pbmYiCgogICAgICAgICAgICAkUGFyc2VBcmdzID0gIEB7CiAgICAgICAgICAgICAgICAnR3B0VG1wbFBhdGgnID0gJEdwdFRtcGxQYXRoCiAgICAgICAgICAgICAgICAnVXNlUFNEcml2ZScgPSAkVXNlUFNEcml2ZQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHBhcnNlIHRoZSBHcHRUbXBsLmluZgogICAgICAgICAgICBHZXQtR3B0VG1wbCBAUGFyc2VBcmdzCiAgICAgICAgfQoKICAgIH0KICAgIGVsc2VpZigkU291cmNlIC1lcSAiREMiKSB7CiAgICAgICAgIyBxdWVyeSB0aGUgZ2l2ZW4gZG9tYWluL2RjIGZvciB0aGUgZGVmYXVsdCBkb21haW4gY29udHJvbGxlciBwb2xpY3kgb2JqZWN0CiAgICAgICAgJEdQTyA9IEdldC1OZXRHUE8gLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1HUE9uYW1lICJ7NkFDMTc4NkMtMDE2Ri0xMUQyLTk0NUYtMDBDMDRGQjk4NEY5fSIKCiAgICAgICAgaWYoJEdQTykgewogICAgICAgICAgICAjIGdyYWIgdGhlIEdwdFRtcGwuaW5mIGZpbGUgYW5kIHBhcnNlIGl0CiAgICAgICAgICAgICRHcHRUbXBsUGF0aCA9ICRHUE8uZ3BjZmlsZXN5c3BhdGggKyAiXE1BQ0hJTkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcU2VjRWRpdFxHcHRUbXBsLmluZiIKCiAgICAgICAgICAgICRQYXJzZUFyZ3MgPSAgQHsKICAgICAgICAgICAgICAgICdHcHRUbXBsUGF0aCcgPSAkR3B0VG1wbFBhdGgKICAgICAgICAgICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgcGFyc2UgdGhlIEdwdFRtcGwuaW5mCiAgICAgICAgICAgIEdldC1HcHRUbXBsIEBQYXJzZUFyZ3MgfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICBpZigkUmVzb2x2ZVNpZHMpIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIHJlc29sdmluZyBzaWRzIGluIFByaXZpbGVnZVJpZ2h0cyB0byBuYW1lcwogICAgICAgICAgICAgICAgICAgICRQb2xpY3kgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgJF8ucHNvYmplY3QucHJvcGVydGllcyB8IEZvcmVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRfLk5hbWUgLWVxICdQcml2aWxlZ2VSaWdodHMnKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFByaXZpbGVnZVJpZ2h0cyA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgZm9yIGV2ZXJ5IG5lc3RlZCBTSUQgbWVtYmVyIG9mIFByaXZpbGVnZVJpZ2h0cywgdHJ5IHRvIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAgIHVucGFjayBldmVyeXRoaW5nIGFuZCByZXNvbHZlIHRoZSBTSURzIGFzIGFwcHJvcHJpYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5WYWx1ZS5wc29iamVjdC5wcm9wZXJ0aWVzIHwgRm9yZWFjaC1PYmplY3QgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2lkcyA9ICRfLlZhbHVlIHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJF8gLWlzbm90IFtTeXN0ZW0uQXJyYXldKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnZlcnQtU2lkVG9OYW1lICRfIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8gfCBGb3JlYWNoLU9iamVjdCB7IENvbnZlcnQtU2lkVG9OYW1lICRfIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgcmVzb2x2aW5nIFNJRCA6ICRfIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJpdmlsZWdlUmlnaHRzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJF8uTmFtZSAkU2lkcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRQb2xpY3kgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnUHJpdmlsZWdlUmlnaHRzJyAkUHJpdmlsZWdlUmlnaHRzCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUG9saWN5IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJF8uTmFtZSAkXy5WYWx1ZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRQb2xpY3kKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgeyAkXyB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIEZ1bmN0aW9ucyB0aGF0IGVudW1lcmF0ZSBhIHNpbmdsZSBob3N0LCBlaXRoZXIgdGhyb3VnaAojIFdpbk5ULCBXTUksIHJlbW90ZSByZWdpc3RyeSwgb3IgQVBJIGNhbGxzIAojICh3aXRoIFBTUmVmbGVjdCkuCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZ1bmN0aW9uIEdldC1OZXRMb2NhbEdyb3VwIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBHZXRzIGEgbGlzdCBvZiBhbGwgY3VycmVudCB1c2VycyBpbiBhIHNwZWNpZmllZCBsb2NhbCBncm91cCwKICAgICAgICBvciByZXR1cm5zIHRoZSBuYW1lcyBvZiBhbGwgbG9jYWwgZ3JvdXBzIHdpdGggLUxpc3RHcm91cHMuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGhvc3RuYW1lIG9yIElQIHRvIHF1ZXJ5IGZvciBsb2NhbCBncm91cCB1c2Vycy4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gcXVlcnkgZm9yIGxvY2FsIGdyb3VwIHVzZXJzLgoKICAgIC5QQVJBTUVURVIgR3JvdXBOYW1lCgogICAgICAgIFRoZSBsb2NhbCBncm91cCBuYW1lIHRvIHF1ZXJ5IGZvciB1c2Vycy4gSWYgbm90IGdpdmVuLCBpdCBkZWZhdWx0cyB0byAiQWRtaW5pc3RyYXRvcnMiCgogICAgLlBBUkFNRVRFUiBMaXN0R3JvdXBzCgogICAgICAgIFN3aXRjaC4gTGlzdCBhbGwgdGhlIGxvY2FsIGdyb3VwcyBpbnN0ZWFkIG9mIHRoZWlyIG1lbWJlcnMuCiAgICAgICAgT2xkIEdldC1OZXRMb2NhbEdyb3VwcyBmdW5jdGlvbmFsaXR5LgoKICAgIC5QQVJBTUVURVIgUmVjdXJzZQoKICAgICAgICBTd2l0Y2guIElmIHRoZSBsb2NhbCBtZW1iZXIgbWVtYmVyIGlzIGEgZG9tYWluIGdyb3VwLCByZWN1cnNpdmVseSB0cnkgdG8gcmVzb2x2ZSBpdHMgbWVtYmVycyB0byBnZXQgYSBsaXN0IG9mIGRvbWFpbiB1c2VycyB3aG8gY2FuIGFjY2VzcyB0aGlzIG1hY2hpbmUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9jYWxHcm91cAoKICAgICAgICBSZXR1cm5zIHRoZSB1c2VybmFtZXMgdGhhdCBvZiBtZW1iZXJzIG9mIGxvY2FsZ3JvdXAgIkFkbWluaXN0cmF0b3JzIiBvbiB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRMb2NhbEdyb3VwIC1Db21wdXRlck5hbWUgV0lORE9XU1hQCgogICAgICAgIFJldHVybnMgYWxsIHRoZSBsb2NhbCBhZG1pbmlzdHJhdG9yIGFjY291bnRzIGZvciBXSU5ET1dTWFAKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRMb2NhbEdyb3VwIC1Db21wdXRlck5hbWUgV0lORE9XUzcgLVJlc3Vyc2UgCgogICAgICAgIFJldHVybnMgYWxsIGVmZmVjdGl2ZSBsb2NhbC9kb21haW4gdXNlcnMvZ3JvdXBzIHRoYXQgY2FuIGFjY2VzcyBXSU5ET1dTNyB3aXRoCiAgICAgICAgbG9jYWwgYWRtaW5pc3RyYXRpdmUgcHJpdmlsZWdlcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRMb2NhbEdyb3VwIC1Db21wdXRlck5hbWUgV0lORE9XUzcgLUxpc3RHcm91cHMKCiAgICAgICAgUmV0dXJucyBhbGwgbG9jYWwgZ3JvdXBzIG9uIHRoZSBXSU5ET1dTNyBob3N0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjEyODgyMjAvZ2V0LWFsbC1sb2NhbC1tZW1iZXJzLWFuZC1ncm91cHMtZGlzcGxheWVkLXRvZ2V0aGVyCiAgICAgICAgaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2FhNzcyMjExKFZTLjg1KS5hc3B4CiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdE5hbWUnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUgPSAnbG9jYWxob3N0JywKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJ0FkbWluaXN0cmF0b3JzJywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTGlzdEdyb3VwcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVjdXJzZQogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZiAoKC1ub3QgJExpc3RHcm91cHMpIC1hbmQgKC1ub3QgJEdyb3VwTmFtZSkpIHsKICAgICAgICAgICAgIyByZXNvbHZlIHRoZSBTSUQgZm9yIHRoZSBsb2NhbCBhZG1pbiBncm91cCAtIHRoaXMgc2hvdWxkIHVzdWFsbHkgZGVmYXVsdCB0byAiQWRtaW5pc3RyYXRvcnMiCiAgICAgICAgICAgICRPYmpTSUQgPSBOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyKCdTLTEtNS0zMi01NDQnKQogICAgICAgICAgICAkT2JqZ3JvdXAgPSAkT2JqU0lELlRyYW5zbGF0ZSggW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuTlRBY2NvdW50XSkKICAgICAgICAgICAgJEdyb3VwTmFtZSA9ICgkT2JqZ3JvdXAuVmFsdWUpLlNwbGl0KCdcJylbMV0KICAgICAgICB9CiAgICB9CiAgICBwcm9jZXNzIHsKCiAgICAgICAgJFNlcnZlcnMgPSBAKCkKCiAgICAgICAgIyBpZiB3ZSBoYXZlIGEgaG9zdCBsaXN0IHBhc3NlZCwgZ3JhYiBpdAogICAgICAgIGlmKCRDb21wdXRlckZpbGUpIHsKICAgICAgICAgICAgJFNlcnZlcnMgPSBHZXQtQ29udGVudCAtUGF0aCAkQ29tcHV0ZXJGaWxlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIG90aGVyd2lzZSBhc3N1bWUgYSBzaW5nbGUgaG9zdCBuYW1lCiAgICAgICAgICAgICRTZXJ2ZXJzICs9IEdldC1OYW1lRmllbGQgLU9iamVjdCAkQ29tcHV0ZXJOYW1lCiAgICAgICAgfQoKICAgICAgICAjIHF1ZXJ5IHRoZSBzcGVjaWZpZWQgZ3JvdXAgdXNpbmcgdGhlIFdJTk5UIHByb3ZpZGVyLCBhbmQKICAgICAgICAjIGV4dHJhY3QgZmllbGRzIGFzIGFwcHJvcHJpYXRlIGZyb20gdGhlIHJlc3VsdHMKICAgICAgICBGb3JFYWNoKCRTZXJ2ZXIgaW4gJFNlcnZlcnMpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmKCRMaXN0R3JvdXBzKSB7CiAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBsaXN0aW5nIHRoZSBncm91cCBuYW1lcyBvbiBhIHJlbW90ZSBzZXJ2ZXIKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXIgPSBbQURTSV0iV2luTlQ6Ly8kU2VydmVyLGNvbXB1dGVyIgoKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXIucHNiYXNlLmNoaWxkcmVuIHwgV2hlcmUtT2JqZWN0IHsgJF8ucHNiYXNlLnNjaGVtYUNsYXNzTmFtZSAtZXEgJ2dyb3VwJyB9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXAgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTZXJ2ZXInICRTZXJ2ZXIKICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0dyb3VwJyAoJF8ubmFtZVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NJRCcgKChOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyICRfLm9iamVjdHNpZFswXSwwKS5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0Rlc2NyaXB0aW9uJyAoJF8uRGVzY3JpcHRpb25bMF0pCiAgICAgICAgICAgICAgICAgICAgICAgICRHcm91cAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIHdlJ3JlIGxpc3RpbmcgdGhlIGdyb3VwIG1lbWJlcnMKICAgICAgICAgICAgICAgICAgICAkTWVtYmVycyA9IEAoJChbQURTSV0iV2luTlQ6Ly8kU2VydmVyLyRHcm91cE5hbWUiKS5wc2Jhc2UuSW52b2tlKCdNZW1iZXJzJykpCgogICAgICAgICAgICAgICAgICAgICRNZW1iZXJzIHwgRm9yRWFjaC1PYmplY3QgewoKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTZXJ2ZXInICRTZXJ2ZXIKCiAgICAgICAgICAgICAgICAgICAgICAgICRBZHNQYXRoID0gKCRfLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoJ0Fkc3BhdGgnLCAnR2V0UHJvcGVydHknLCAkTnVsbCwgJF8sICROdWxsKSkuUmVwbGFjZSgnV2luTlQ6Ly8nLCAnJykKCiAgICAgICAgICAgICAgICAgICAgICAgICMgdHJ5IHRvIHRyYW5zbGF0ZSB0aGUgTlQ0IGRvbWFpbiB0byBhIEZRRE4gaWYgcG9zc2libGUKICAgICAgICAgICAgICAgICAgICAgICAgJE5hbWUgPSBDb252ZXJ0LU5UNHRvQ2Fub25pY2FsIC1PYmplY3ROYW1lICRBZHNQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRlFETiA9ICROYW1lLnNwbGl0KCIvIilbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPYmpOYW1lID0gJEFkc1BhdGguc3BsaXQoIi8iKVstMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICROYW1lID0gIiRGUUROLyRPYmpOYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJElzRG9tYWluID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICROYW1lID0gJEFkc1BhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRJc0RvbWFpbiA9ICRGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0FjY291bnROYW1lJyAkTmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgIyB0cmFuc2xhdGUgdGhlIGJpbmFyeSBzaWQgdG8gYSBzdHJpbmcKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTSUQnICgoTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcigkXy5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCdPYmplY3RTSUQnLCAnR2V0UHJvcGVydHknLCAkTnVsbCwgJF8sICROdWxsKSwwKSkuVmFsdWUpCgogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZSBhY2NvdW50IGlzIGxvY2FsLCBjaGVjayBpZiBpdCdzIGRpc2FibGVkLCBpZiBpdCdzIGRvbWFpbiwgYWx3YXlzIHByaW50ICRGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAjICAgVE9ETzogZml4IHRoaXMgb2NjYXNpbmFsIGVycm9yPwogICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0Rpc2FibGVkJyAkKCBpZigtbm90ICRJc0RvbWFpbikgeyB0cnkgeyAkXy5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCdBY2NvdW50RGlzYWJsZWQnLCAnR2V0UHJvcGVydHknLCAkTnVsbCwgJF8sICROdWxsKSB9IGNhdGNoIHsgJ0VSUk9SJyB9IH0gZWxzZSB7ICRGYWxzZSB9ICkKCiAgICAgICAgICAgICAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIG1lbWJlciBpcyBhIGdyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICRJc0dyb3VwID0gKCRfLkdldFR5cGUoKS5JbnZva2VNZW1iZXIoJ0NsYXNzJywgJ0dldFByb3BlcnR5JywgJE51bGwsICRfLCAkTnVsbCkgLWVxICdncm91cCcpCiAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSXNHcm91cCcgJElzR3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0RvbWFpbicgJElzRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRJc0dyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0xhc3RMb2dpbicgIiIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdMYXN0TG9naW4nICggJF8uR2V0VHlwZSgpLkludm9rZU1lbWJlcignTGFzdExvZ2luJywgJ0dldFByb3BlcnR5JywgJE51bGwsICRfLCAkTnVsbCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdMYXN0TG9naW4nICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcgoKICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB0aGUgcmVzdWx0IGlzIGEgZ3JvdXAgZG9tYWluIG9iamVjdCBhbmQgd2UncmUgcmVjdXJzaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAjIHRyeSB0byByZXNvbHZlIGFsbCB0aGUgZ3JvdXAgbWVtYmVyIHJlc3VsdHMKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJFJlY3Vyc2UgLWFuZCAkSXNEb21haW4gLWFuZCAkSXNHcm91cCkgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGUUROID0gJE5hbWUuc3BsaXQoIi8iKVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEdyb3VwTmFtZSA9ICROYW1lLnNwbGl0KCIvIilbMV0udHJpbSgpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2V0LU5ldEdyb3VwTWVtYmVyIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICRGUUROIC1GdWxsRGF0YSAtUmVjdXJzZSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NlcnZlcicgIiRGUUROLyQoJF8uR3JvdXBOYW1lKSIKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckROID0gJF8uZGlzdGluZ3Vpc2hlZE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGV4dHJhY3QgdGhlIEZRRE4gZnJvbSB0aGUgRGlzdGluZ3Vpc2hlZCBOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlckRvbWFpbiA9ICRNZW1iZXJETi5zdWJTdHJpbmcoJE1lbWJlckROLkluZGV4T2YoIkRDPSIpKSAtcmVwbGFjZSAnREM9JywnJyAtcmVwbGFjZSAnLCcsJy4nCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkXy5zYW1BY2NvdW50VHlwZSAtbmUgIjgwNTMwNjM2OCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcklzR3JvdXAgPSAkVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlcklzR3JvdXAgPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkXy5zYW1BY2NvdW50TmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGZvcmVzdCB1c2VycyBoYXZlIHRoZSBzYW1BY2NvdW50TmFtZSBzZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSAkXy5zYW1BY2NvdW50TmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgZXh0ZXJuYWwgdHJ1c3QgdXNlcnMgaGF2ZSBhIFNJRCwgc28gY29udmVydCBpdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyTmFtZSA9IENvbnZlcnQtU2lkVG9OYW1lICRfLmNuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB0aGVyZSdzIGEgcHJvYmxlbSBjb250YWN0aW5nIHRoZSBkb21haW4gdG8gcmVzb2x2ZSB0aGUgU0lECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlck5hbWUgPSAkXy5jbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciByZXNvbHZpbmcgU0lEIDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQWNjb3VudE5hbWUnICIkTWVtYmVyRG9tYWluLyRNZW1iZXJOYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNZW1iZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU0lEJyAkXy5vYmplY3RzaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0Rpc2FibGVkJyAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lzR3JvdXAnICRNZW1iZXJJc0dyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1lbWJlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdJc0RvbWFpbicgJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0xhc3RMb2dpbicgJycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTWVtYmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiWyFdIEVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRTaGFyZSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUgdGhlIE5ldFNoYXJlRW51bSBXaW4zMkFQSSBjYWxsIHRvIHF1ZXJ5CiAgICAgICAgYSBnaXZlbiBob3N0IGZvciBvcGVuIHNoYXJlcy4gVGhpcyBpcyBhIHJlcGxhY2VtZW50IGZvcgogICAgICAgICJuZXQgc2hhcmUgXFxob3N0bmFtZSIKCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgZm9yIHNoYXJlcy4gQWxzbyBhY2NlcHRzIElQIGFkZHJlc3Nlcy4KCiAgICAuT1VUUFVUUwoKICAgICAgICBTSEFSRV9JTkZPXzEgc3RydWN0dXJlLiBBIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBTSEFSRV9JTkZPXzEKICAgICAgICByZXN1bHQgc3RydWN0dXJlIHdoaWNoIGluY2x1ZGVzIHRoZSBuYW1lIGFuZCBub3RlIGZvciBlYWNoIHNoYXJlLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFNoYXJlCgogICAgICAgIFJldHVybnMgYWN0aXZlIHNoYXJlcyBvbiB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRTaGFyZSAtQ29tcHV0ZXJOYW1lIHNxbHNlcnZlcgoKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBzaGFyZXMgb24gdGhlICdzcWxzZXJ2ZXInIGhvc3QKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICdsb2NhbGhvc3QnCiAgICApCgogICAgYmVnaW4gewogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgICMgcHJvY2VzcyBtdWx0aXBsZSBob3N0IG9iamVjdCB0eXBlcyBmcm9tIHRoZSBwaXBlbGluZQogICAgICAgICRDb21wdXRlck5hbWUgPSBHZXQtTmFtZUZpZWxkIC1PYmplY3QgJENvbXB1dGVyTmFtZQoKICAgICAgICAjIGFyZ3VtZW50cyBmb3IgTmV0U2hhcmVFbnVtCiAgICAgICAgJFF1ZXJ5TGV2ZWwgPSAxCiAgICAgICAgJFB0ckluZm8gPSBbSW50UHRyXTo6WmVybwogICAgICAgICRFbnRyaWVzUmVhZCA9IDAKICAgICAgICAkVG90YWxSZWFkID0gMAogICAgICAgICRSZXN1bWVIYW5kbGUgPSAwCgogICAgICAgICMgZ2V0IHRoZSBzaGFyZSBpbmZvcm1hdGlvbgogICAgICAgICRSZXN1bHQgPSAkTmV0YXBpMzI6Ok5ldFNoYXJlRW51bSgkQ29tcHV0ZXJOYW1lLCAkUXVlcnlMZXZlbCwgW3JlZl0kUHRySW5mbywgLTEsIFtyZWZdJEVudHJpZXNSZWFkLCBbcmVmXSRUb3RhbFJlYWQsIFtyZWZdJFJlc3VtZUhhbmRsZSkKCiAgICAgICAgIyBMb2NhdGUgdGhlIG9mZnNldCBvZiB0aGUgaW5pdGlhbCBpbnRQdHIKICAgICAgICAkT2Zmc2V0ID0gJFB0ckluZm8uVG9JbnQ2NCgpCgogICAgICAgIFdyaXRlLURlYnVnICJHZXQtTmV0U2hhcmUgcmVzdWx0OiAkUmVzdWx0IgoKICAgICAgICAjIDAgPSBzdWNjZXNzCiAgICAgICAgaWYgKCgkUmVzdWx0IC1lcSAwKSAtYW5kICgkT2Zmc2V0IC1ndCAwKSkgewoKICAgICAgICAgICAgIyBXb3JrIG91dCBob3cgbXV0Y2ggdG8gaW5jcmVtZW50IHRoZSBwb2ludGVyIGJ5IGZpbmRpbmcgb3V0IHRoZSBzaXplIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgJEluY3JlbWVudCA9ICRTSEFSRV9JTkZPXzE6OkdldFNpemUoKQoKICAgICAgICAgICAgIyBwYXJzZSBhbGwgdGhlIHJlc3VsdCBzdHJ1Y3R1cmVzCiAgICAgICAgICAgIGZvciAoJGkgPSAwOyAoJGkgLWx0ICRFbnRyaWVzUmVhZCk7ICRpKyspIHsKICAgICAgICAgICAgICAgICMgY3JlYXRlIGEgbmV3IGludCBwdHIgYXQgdGhlIGdpdmVuIG9mZnNldCBhbmQgY2FzdAogICAgICAgICAgICAgICAgIyAgIHRoZSBwb2ludGVyIGFzIG91ciByZXN1bHQgc3RydWN0dXJlCiAgICAgICAgICAgICAgICAkTmV3SW50UHRyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldAogICAgICAgICAgICAgICAgJEluZm8gPSAkTmV3SW50UHRyIC1hcyAkU0hBUkVfSU5GT18xCiAgICAgICAgICAgICAgICAjIHJldHVybiBhbGwgdGhlIHNlY3Rpb25zIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICRJbmZvIHwgU2VsZWN0LU9iamVjdCAqCiAgICAgICAgICAgICAgICAkT2Zmc2V0ID0gJE5ld0ludFB0ci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICRPZmZzZXQgKz0gJEluY3JlbWVudAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGZyZWUgdXAgdGhlIHJlc3VsdCBidWZmZXIKICAgICAgICAgICAgJE51bGwgPSAkTmV0YXBpMzI6Ok5ldEFwaUJ1ZmZlckZyZWUoJFB0ckluZm8pCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHN3aXRjaCAoJFJlc3VsdCkgewogICAgICAgICAgICAgICAgKDUpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB1c2VyIGRvZXMgbm90IGhhdmUgYWNjZXNzIHRvIHRoZSByZXF1ZXN0ZWQgaW5mb3JtYXRpb24uJ30KICAgICAgICAgICAgICAgICgxMjQpICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgdmFsdWUgc3BlY2lmaWVkIGZvciB0aGUgbGV2ZWwgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDg3KSAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDIzNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ01vcmUgZW50cmllcyBhcmUgYXZhaWxhYmxlLiBTcGVjaWZ5IGEgbGFyZ2UgZW5vdWdoIGJ1ZmZlciB0byByZWNlaXZlIGFsbCBlbnRyaWVzLid9CiAgICAgICAgICAgICAgICAoOCkgICAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnSW5zdWZmaWNpZW50IG1lbW9yeSBpcyBhdmFpbGFibGUuJ30KICAgICAgICAgICAgICAgICgyMzEyKSAgICAgICAge1dyaXRlLURlYnVnICdBIHNlc3Npb24gZG9lcyBub3QgZXhpc3Qgd2l0aCB0aGUgY29tcHV0ZXIgbmFtZS4nfQogICAgICAgICAgICAgICAgKDIzNTEpICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBjb21wdXRlciBuYW1lIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDIyMjEpICAgICAgICB7V3JpdGUtRGVidWcgJ1VzZXJuYW1lIG5vdCBmb3VuZC4nfQogICAgICAgICAgICAgICAgKDUzKSAgICAgICAgICB7V3JpdGUtRGVidWcgJ0hvc3RuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZCd9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0TG9nZ2Vkb24gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCBleGVjdXRlIHRoZSBOZXRXa3N0YVVzZXJFbnVtIFdpbjMyQVBJIGNhbGwgdG8gcXVlcnkKICAgICAgICBhIGdpdmVuIGhvc3QgZm9yIGFjdGl2ZWx5IGxvZ2dlZCBvbiB1c2Vycy4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgZm9yIGxvZ2dlZCBvbiB1c2Vycy4KCiAgICAuT1VUUFVUUwoKICAgICAgICBXS1NUQV9VU0VSX0lORk9fMSBzdHJ1Y3R1cmUuIEEgcmVwcmVzZW50YXRpb24gb2YgdGhlIFdLU1RBX1VTRVJfSU5GT18xCiAgICAgICAgcmVzdWx0IHN0cnVjdHVyZSB3aGljaCBpbmNsdWRlcyB0aGUgdXNlcm5hbWUgYW5kIGRvbWFpbiBvZiBsb2dnZWQgb24gdXNlcnMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0TG9nZ2Vkb24KCiAgICAgICAgUmV0dXJucyB1c2VycyBhY3RpdmVseSBsb2dnZWQgb250byB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRMb2dnZWRvbiAtQ29tcHV0ZXJOYW1lIHNxbHNlcnZlcgoKICAgICAgICBSZXR1cm5zIHVzZXJzIGFjdGl2ZWx5IGxvZ2dlZCBvbnRvIHRoZSAnc3Fsc2VydmVyJyBob3N0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly93d3cucG93ZXJzaGVsbG1hZ2F6aW5lLmNvbS8yMDE0LzA5LzI1L2Vhc2lseS1kZWZpbmluZy1lbnVtcy1zdHJ1Y3RzLWFuZC13aW4zMi1mdW5jdGlvbnMtaW4tbWVtb3J5LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJ2xvY2FsaG9zdCcKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgIyBwcm9jZXNzIG11bHRpcGxlIGhvc3Qgb2JqZWN0IHR5cGVzIGZyb20gdGhlIHBpcGVsaW5lCiAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1OYW1lRmllbGQgLU9iamVjdCAkQ29tcHV0ZXJOYW1lCgogICAgICAgICMgRGVjbGFyZSB0aGUgcmVmZXJlbmNlIHZhcmlhYmxlcwogICAgICAgICRRdWVyeUxldmVsID0gMQogICAgICAgICRQdHJJbmZvID0gW0ludFB0cl06Olplcm8KICAgICAgICAkRW50cmllc1JlYWQgPSAwCiAgICAgICAgJFRvdGFsUmVhZCA9IDAKICAgICAgICAkUmVzdW1lSGFuZGxlID0gMAoKICAgICAgICAjIGdldCBsb2dnZWQgb24gdXNlciBpbmZvcm1hdGlvbgogICAgICAgICRSZXN1bHQgPSAkTmV0YXBpMzI6Ok5ldFdrc3RhVXNlckVudW0oJENvbXB1dGVyTmFtZSwgJFF1ZXJ5TGV2ZWwsIFtyZWZdJFB0ckluZm8sIC0xLCBbcmVmXSRFbnRyaWVzUmVhZCwgW3JlZl0kVG90YWxSZWFkLCBbcmVmXSRSZXN1bWVIYW5kbGUpCgogICAgICAgICMgTG9jYXRlIHRoZSBvZmZzZXQgb2YgdGhlIGluaXRpYWwgaW50UHRyCiAgICAgICAgJE9mZnNldCA9ICRQdHJJbmZvLlRvSW50NjQoKQoKICAgICAgICBXcml0ZS1EZWJ1ZyAiR2V0LU5ldExvZ2dlZG9uIHJlc3VsdDogJFJlc3VsdCIKCiAgICAgICAgIyAwID0gc3VjY2VzcwogICAgICAgIGlmICgoJFJlc3VsdCAtZXEgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgICAgICMgV29yayBvdXQgaG93IG11dGNoIHRvIGluY3JlbWVudCB0aGUgcG9pbnRlciBieSBmaW5kaW5nIG91dCB0aGUgc2l6ZSBvZiB0aGUgc3RydWN0dXJlCiAgICAgICAgICAgICRJbmNyZW1lbnQgPSAkV0tTVEFfVVNFUl9JTkZPXzE6OkdldFNpemUoKQoKICAgICAgICAgICAgIyBwYXJzZSBhbGwgdGhlIHJlc3VsdCBzdHJ1Y3R1cmVzCiAgICAgICAgICAgIGZvciAoJGkgPSAwOyAoJGkgLWx0ICRFbnRyaWVzUmVhZCk7ICRpKyspIHsKICAgICAgICAgICAgICAgICMgY3JlYXRlIGEgbmV3IGludCBwdHIgYXQgdGhlIGdpdmVuIG9mZnNldCBhbmQgY2FzdAogICAgICAgICAgICAgICAgIyAgIHRoZSBwb2ludGVyIGFzIG91ciByZXN1bHQgc3RydWN0dXJlCiAgICAgICAgICAgICAgICAkTmV3SW50UHRyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldAogICAgICAgICAgICAgICAgJEluZm8gPSAkTmV3SW50UHRyIC1hcyAkV0tTVEFfVVNFUl9JTkZPXzEKCiAgICAgICAgICAgICAgICAjIHJldHVybiBhbGwgdGhlIHNlY3Rpb25zIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICRJbmZvIHwgU2VsZWN0LU9iamVjdCAqCiAgICAgICAgICAgICAgICAkT2Zmc2V0ID0gJE5ld0ludFB0ci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICRPZmZzZXQgKz0gJEluY3JlbWVudAoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBmcmVlIHVwIHRoZSByZXN1bHQgYnVmZmVyCiAgICAgICAgICAgICROdWxsID0gJE5ldGFwaTMyOjpOZXRBcGlCdWZmZXJGcmVlKCRQdHJJbmZvKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBzd2l0Y2ggKCRSZXN1bHQpIHsKICAgICAgICAgICAgICAgICg1KSAgICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgdXNlciBkb2VzIG5vdCBoYXZlIGFjY2VzcyB0byB0aGUgcmVxdWVzdGVkIGluZm9ybWF0aW9uLid9CiAgICAgICAgICAgICAgICAoMTI0KSAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnVGhlIHZhbHVlIHNwZWNpZmllZCBmb3IgdGhlIGxldmVsIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgICAgICg4NykgICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgc3BlY2lmaWVkIHBhcmFtZXRlciBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgICAgICgyMzQpICAgICAgICAge1dyaXRlLURlYnVnICdNb3JlIGVudHJpZXMgYXJlIGF2YWlsYWJsZS4gU3BlY2lmeSBhIGxhcmdlIGVub3VnaCBidWZmZXIgdG8gcmVjZWl2ZSBhbGwgZW50cmllcy4nfQogICAgICAgICAgICAgICAgKDgpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ0luc3VmZmljaWVudCBtZW1vcnkgaXMgYXZhaWxhYmxlLid9CiAgICAgICAgICAgICAgICAoMjMxMikgICAgICAgIHtXcml0ZS1EZWJ1ZyAnQSBzZXNzaW9uIGRvZXMgbm90IGV4aXN0IHdpdGggdGhlIGNvbXB1dGVyIG5hbWUuJ30KICAgICAgICAgICAgICAgICgyMzUxKSAgICAgICAge1dyaXRlLURlYnVnICdUaGUgY29tcHV0ZXIgbmFtZSBpcyBub3QgdmFsaWQuJ30KICAgICAgICAgICAgICAgICgyMjIxKSAgICAgICAge1dyaXRlLURlYnVnICdVc2VybmFtZSBub3QgZm91bmQuJ30KICAgICAgICAgICAgICAgICg1MykgICAgICAgICAge1dyaXRlLURlYnVnICdIb3N0bmFtZSBjb3VsZCBub3QgYmUgZm91bmQnfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldFNlc3Npb24gewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCBleGVjdXRlIHRoZSBOZXRTZXNzaW9uRW51bSBXaW4zMkFQSSBjYWxsIHRvIHF1ZXJ5CiAgICAgICAgYSBnaXZlbiBob3N0IGZvciBhY3RpdmUgc2Vzc2lvbnMgb24gdGhlIGhvc3QuCiAgICAgICAgSGVhdmlseSBhZGFwdGVkIGZyb20gZHVuZWRpbml0ZSdzIHBvc3Qgb24gc3RhY2tvdmVyZmxvdyAoc2VlIExJTksgYmVsb3cpCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIENvbXB1dGVyTmFtZSB0byBxdWVyeSBmb3IgYWN0aXZlIHNlc3Npb25zLgoKICAgIC5QQVJBTUVURVIgVXNlck5hbWUKCiAgICAgICAgVGhlIHVzZXIgbmFtZSB0byBmaWx0ZXIgZm9yIGFjdGl2ZSBzZXNzaW9ucy4KCiAgICAuT1VUUFVUUwoKICAgICAgICBTRVNTSU9OX0lORk9fMTAgc3RydWN0dXJlLiBBIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBTRVNTSU9OX0lORk9fMTAKICAgICAgICByZXN1bHQgc3RydWN0dXJlIHdoaWNoIGluY2x1ZGVzIHRoZSBob3N0IGFuZCB1c2VybmFtZSBhc3NvY2lhdGVkCiAgICAgICAgd2l0aCBhY3RpdmUgc2Vzc2lvbnMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0U2Vzc2lvbgoKICAgICAgICBSZXR1cm5zIGFjdGl2ZSBzZXNzaW9ucyBvbiB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRTZXNzaW9uIC1Db21wdXRlck5hbWUgc3Fsc2VydmVyCgogICAgICAgIFJldHVybnMgYWN0aXZlIHNlc3Npb25zIG9uIHRoZSAnc3Fsc2VydmVyJyBob3N0LgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly93d3cucG93ZXJzaGVsbG1hZ2F6aW5lLmNvbS8yMDE0LzA5LzI1L2Vhc2lseS1kZWZpbmluZy1lbnVtcy1zdHJ1Y3RzLWFuZC13aW4zMi1mdW5jdGlvbnMtaW4tbWVtb3J5LwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJ2xvY2FsaG9zdCcsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lID0gJycKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgIyBwcm9jZXNzIG11bHRpcGxlIGhvc3Qgb2JqZWN0IHR5cGVzIGZyb20gdGhlIHBpcGVsaW5lCiAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1OYW1lRmllbGQgLU9iamVjdCAkQ29tcHV0ZXJOYW1lCgogICAgICAgICMgYXJndW1lbnRzIGZvciBOZXRTZXNzaW9uRW51bQogICAgICAgICRRdWVyeUxldmVsID0gMTAKICAgICAgICAkUHRySW5mbyA9IFtJbnRQdHJdOjpaZXJvCiAgICAgICAgJEVudHJpZXNSZWFkID0gMAogICAgICAgICRUb3RhbFJlYWQgPSAwCiAgICAgICAgJFJlc3VtZUhhbmRsZSA9IDAKCiAgICAgICAgIyBnZXQgc2Vzc2lvbiBpbmZvcm1hdGlvbgogICAgICAgICRSZXN1bHQgPSAkTmV0YXBpMzI6Ok5ldFNlc3Npb25FbnVtKCRDb21wdXRlck5hbWUsICcnLCAkVXNlck5hbWUsICRRdWVyeUxldmVsLCBbcmVmXSRQdHJJbmZvLCAtMSwgW3JlZl0kRW50cmllc1JlYWQsIFtyZWZdJFRvdGFsUmVhZCwgW3JlZl0kUmVzdW1lSGFuZGxlKQoKICAgICAgICAjIExvY2F0ZSB0aGUgb2Zmc2V0IG9mIHRoZSBpbml0aWFsIGludFB0cgogICAgICAgICRPZmZzZXQgPSAkUHRySW5mby5Ub0ludDY0KCkKCiAgICAgICAgV3JpdGUtRGVidWcgIkdldC1OZXRTZXNzaW9uIHJlc3VsdDogJFJlc3VsdCIKCiAgICAgICAgIyAwID0gc3VjY2VzcwogICAgICAgIGlmICgoJFJlc3VsdCAtZXEgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgICAgICMgV29yayBvdXQgaG93IG11dGNoIHRvIGluY3JlbWVudCB0aGUgcG9pbnRlciBieSBmaW5kaW5nIG91dCB0aGUgc2l6ZSBvZiB0aGUgc3RydWN0dXJlCiAgICAgICAgICAgICRJbmNyZW1lbnQgPSAkU0VTU0lPTl9JTkZPXzEwOjpHZXRTaXplKCkKCiAgICAgICAgICAgICMgcGFyc2UgYWxsIHRoZSByZXN1bHQgc3RydWN0dXJlcwogICAgICAgICAgICBmb3IgKCRpID0gMDsgKCRpIC1sdCAkRW50cmllc1JlYWQpOyAkaSsrKSB7CiAgICAgICAgICAgICAgICAjIGNyZWF0ZSBhIG5ldyBpbnQgcHRyIGF0IHRoZSBnaXZlbiBvZmZzZXQgYW5kIGNhc3QKICAgICAgICAgICAgICAgICMgdGhlIHBvaW50ZXIgYXMgb3VyIHJlc3VsdCBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICROZXdJbnRQdHIgPSBOZXctT2JqZWN0IFN5c3RlbS5JbnRwdHIgLUFyZ3VtZW50TGlzdCAkT2Zmc2V0CiAgICAgICAgICAgICAgICAkSW5mbyA9ICROZXdJbnRQdHIgLWFzICRTRVNTSU9OX0lORk9fMTAKCiAgICAgICAgICAgICAgICAjIHJldHVybiBhbGwgdGhlIHNlY3Rpb25zIG9mIHRoZSBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICRJbmZvIHwgU2VsZWN0LU9iamVjdCAqCiAgICAgICAgICAgICAgICAkT2Zmc2V0ID0gJE5ld0ludFB0ci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICRPZmZzZXQgKz0gJEluY3JlbWVudAoKICAgICAgICAgICAgfQogICAgICAgICAgICAjIGZyZWUgdXAgdGhlIHJlc3VsdCBidWZmZXIKICAgICAgICAgICAgJE51bGwgPSAkTmV0YXBpMzI6Ok5ldEFwaUJ1ZmZlckZyZWUoJFB0ckluZm8pCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHN3aXRjaCAoJFJlc3VsdCkgewogICAgICAgICAgICAgICAgKDUpICAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSB1c2VyIGRvZXMgbm90IGhhdmUgYWNjZXNzIHRvIHRoZSByZXF1ZXN0ZWQgaW5mb3JtYXRpb24uJ30KICAgICAgICAgICAgICAgICgxMjQpICAgICAgICAge1dyaXRlLURlYnVnICdUaGUgdmFsdWUgc3BlY2lmaWVkIGZvciB0aGUgbGV2ZWwgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDg3KSAgICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDIzNCkgICAgICAgICB7V3JpdGUtRGVidWcgJ01vcmUgZW50cmllcyBhcmUgYXZhaWxhYmxlLiBTcGVjaWZ5IGEgbGFyZ2UgZW5vdWdoIGJ1ZmZlciB0byByZWNlaXZlIGFsbCBlbnRyaWVzLid9CiAgICAgICAgICAgICAgICAoOCkgICAgICAgICAgIHtXcml0ZS1EZWJ1ZyAnSW5zdWZmaWNpZW50IG1lbW9yeSBpcyBhdmFpbGFibGUuJ30KICAgICAgICAgICAgICAgICgyMzEyKSAgICAgICAge1dyaXRlLURlYnVnICdBIHNlc3Npb24gZG9lcyBub3QgZXhpc3Qgd2l0aCB0aGUgY29tcHV0ZXIgbmFtZS4nfQogICAgICAgICAgICAgICAgKDIzNTEpICAgICAgICB7V3JpdGUtRGVidWcgJ1RoZSBjb21wdXRlciBuYW1lIGlzIG5vdCB2YWxpZC4nfQogICAgICAgICAgICAgICAgKDIyMjEpICAgICAgICB7V3JpdGUtRGVidWcgJ1VzZXJuYW1lIG5vdCBmb3VuZC4nfQogICAgICAgICAgICAgICAgKDUzKSAgICAgICAgICB7V3JpdGUtRGVidWcgJ0hvc3RuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZCd9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtTmV0UkRQU2Vzc2lvbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUgdGhlIFdUU0VudW1lcmF0ZVNlc3Npb25zRXggYW5kIAogICAgICAgIFdUU1F1ZXJ5U2Vzc2lvbkluZm9ybWF0aW9uIFdpbjMyQVBJIGNhbGxzIHRvIHF1ZXJ5IGEgZ2l2ZW4KICAgICAgICBSRFAgcmVtb3RlIHNlcnZpY2UgZm9yIGFjdGl2ZSBzZXNzaW9ucyBhbmQgb3JpZ2luYXRpbmcgSVBzLgogICAgICAgIFRoaXMgaXMgYSByZXBsYWNlbWVudCBmb3IgcXdpbnN0YS4KCiAgICAgICAgTm90ZTogb25seSBtZW1iZXJzIG9mIHRoZSBBZG1pbmlzdHJhdG9ycyBvciBBY2NvdW50IE9wZXJhdG9ycyBsb2NhbCBncm91cAogICAgICAgIGNhbiBzdWNjZXNzZnVsbHkgZXhlY3V0ZSB0aGlzIGZ1bmN0aW9uYWxpdHkgb24gYSByZW1vdGUgdGFyZ2V0LgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBob3N0bmFtZSB0byBxdWVyeSBmb3IgYWN0aXZlIFJEUCBzZXNzaW9ucy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRSRFBTZXNzaW9uCgogICAgICAgIFJldHVybnMgYWN0aXZlIFJEUC90ZXJtaW5hbCBzZXNzaW9ucyBvbiB0aGUgbG9jYWwgaG9zdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRSRFBTZXNzaW9uIC1Db21wdXRlck5hbWUgInNxbHNlcnZlciIKCiAgICAgICAgUmV0dXJucyBhY3RpdmUgUkRQL3Rlcm1pbmFsIHNlc3Npb25zIG9uIHRoZSAnc3Fsc2VydmVyJyBob3N0LgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJ2xvY2FsaG9zdCcKICAgICkKICAgIAogICAgYmVnaW4gewogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgICMgcHJvY2VzcyBtdWx0aXBsZSBob3N0IG9iamVjdCB0eXBlcyBmcm9tIHRoZSBwaXBlbGluZQogICAgICAgICRDb21wdXRlck5hbWUgPSBHZXQtTmFtZUZpZWxkIC1PYmplY3QgJENvbXB1dGVyTmFtZQoKICAgICAgICAjIG9wZW4gdXAgYSBoYW5kbGUgdG8gdGhlIFJlbW90ZSBEZXNrdG9wIFNlc3Npb24gaG9zdAogICAgICAgICRIYW5kbGUgPSAkV3RzYXBpMzI6OldUU09wZW5TZXJ2ZXJFeCgkQ29tcHV0ZXJOYW1lKQoKICAgICAgICAjIGlmIHdlIGdldCBhIG5vbi16ZXJvIGhhbmRsZSBiYWNrLCBldmVyeXRoaW5nIHdhcyBzdWNjZXNzZnVsCiAgICAgICAgaWYgKCRIYW5kbGUgLW5lIDApIHsKCiAgICAgICAgICAgIFdyaXRlLURlYnVnICJXVFNPcGVuU2VydmVyRXggaGFuZGxlOiAkSGFuZGxlIgoKICAgICAgICAgICAgIyBhcmd1bWVudHMgZm9yIFdUU0VudW1lcmF0ZVNlc3Npb25zRXgKICAgICAgICAgICAgJHBwU2Vzc2lvbkluZm8gPSBbSW50UHRyXTo6WmVybwogICAgICAgICAgICAkcENvdW50ID0gMAogICAgICAgICAgICAKICAgICAgICAgICAgIyBnZXQgaW5mb3JtYXRpb24gb24gYWxsIGN1cnJlbnQgc2Vzc2lvbnMKICAgICAgICAgICAgJFJlc3VsdCA9ICRXdHNhcGkzMjo6V1RTRW51bWVyYXRlU2Vzc2lvbnNFeCgkSGFuZGxlLCBbcmVmXTEsIDAsIFtyZWZdJHBwU2Vzc2lvbkluZm8sIFtyZWZdJHBDb3VudCkKCiAgICAgICAgICAgICMgTG9jYXRlIHRoZSBvZmZzZXQgb2YgdGhlIGluaXRpYWwgaW50UHRyCiAgICAgICAgICAgICRPZmZzZXQgPSAkcHBTZXNzaW9uSW5mby5Ub0ludDY0KCkKCiAgICAgICAgICAgIFdyaXRlLURlYnVnICJXVFNFbnVtZXJhdGVTZXNzaW9uc0V4IHJlc3VsdDogJFJlc3VsdCIKICAgICAgICAgICAgV3JpdGUtRGVidWcgInBDb3VudDogJHBDb3VudCIKCiAgICAgICAgICAgIGlmICgoJFJlc3VsdCAtbmUgMCkgLWFuZCAoJE9mZnNldCAtZ3QgMCkpIHsKCiAgICAgICAgICAgICAgICAjIFdvcmsgb3V0IGhvdyBtdXRjaCB0byBpbmNyZW1lbnQgdGhlIHBvaW50ZXIgYnkgZmluZGluZyBvdXQgdGhlIHNpemUgb2YgdGhlIHN0cnVjdHVyZQogICAgICAgICAgICAgICAgJEluY3JlbWVudCA9ICRXVFNfU0VTU0lPTl9JTkZPXzE6OkdldFNpemUoKQoKICAgICAgICAgICAgICAgICMgcGFyc2UgYWxsIHRoZSByZXN1bHQgc3RydWN0dXJlcwogICAgICAgICAgICAgICAgZm9yICgkaSA9IDA7ICgkaSAtbHQgJHBDb3VudCk7ICRpKyspIHsKICAgICAKICAgICAgICAgICAgICAgICAgICAjIGNyZWF0ZSBhIG5ldyBpbnQgcHRyIGF0IHRoZSBnaXZlbiBvZmZzZXQgYW5kIGNhc3QKICAgICAgICAgICAgICAgICAgICAjICAgdGhlIHBvaW50ZXIgYXMgb3VyIHJlc3VsdCBzdHJ1Y3R1cmUKICAgICAgICAgICAgICAgICAgICAkTmV3SW50UHRyID0gTmV3LU9iamVjdCBTeXN0ZW0uSW50cHRyIC1Bcmd1bWVudExpc3QgJE9mZnNldAogICAgICAgICAgICAgICAgICAgICRJbmZvID0gJE5ld0ludFB0ciAtYXMgJFdUU19TRVNTSU9OX0lORk9fMQoKICAgICAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiA9IE5ldy1PYmplY3QgUFNPYmplY3QKCiAgICAgICAgICAgICAgICAgICAgaWYgKCRJbmZvLnBIb3N0TmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRJbmZvLnBIb3N0TmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiBubyBob3N0bmFtZSByZXR1cm5lZCwgdXNlIHRoZSBzcGVjaWZpZWQgaG9zdG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFJEUFNlc3Npb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTZXNzaW9uTmFtZScgJEluZm8ucFNlc3Npb25OYW1lCgogICAgICAgICAgICAgICAgICAgIGlmICgkKC1ub3QgJEluZm8ucERvbWFpbk5hbWUpIC1vciAoJEluZm8ucERvbWFpbk5hbWUgLWVxICcnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIGEgZG9tYWluIGlzbid0IHJldHVybmVkIGp1c3QgdXNlIHRoZSB1c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkUkRQU2Vzc2lvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgIiQoJEluZm8ucFVzZXJOYW1lKSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAiJCgkSW5mby5wRG9tYWluTmFtZSlcJCgkSW5mby5wVXNlck5hbWUpIgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJFJEUFNlc3Npb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSUQnICRJbmZvLlNlc3Npb25JRAogICAgICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1N0YXRlJyAkSW5mby5TdGF0ZQoKICAgICAgICAgICAgICAgICAgICAkcHBCdWZmZXIgPSBbSW50UHRyXTo6WmVybwogICAgICAgICAgICAgICAgICAgICRwQnl0ZXNSZXR1cm5lZCA9IDAKCiAgICAgICAgICAgICAgICAgICAgIyBxdWVyeSBmb3IgdGhlIHNvdXJjZSBjbGllbnQgSVAgd2l0aCBXVFNRdWVyeVNlc3Npb25JbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgICAgICMgICBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2FhMzgzODYxKHY9dnMuODUpLmFzcHgKICAgICAgICAgICAgICAgICAgICAkUmVzdWx0MiA9ICRXdHNhcGkzMjo6V1RTUXVlcnlTZXNzaW9uSW5mb3JtYXRpb24oJEhhbmRsZSwgJEluZm8uU2Vzc2lvbklELCAxNCwgW3JlZl0kcHBCdWZmZXIsIFtyZWZdJHBCeXRlc1JldHVybmVkKQoKICAgICAgICAgICAgICAgICAgICAkT2Zmc2V0MiA9ICRwcEJ1ZmZlci5Ub0ludDY0KCkKICAgICAgICAgICAgICAgICAgICAkTmV3SW50UHRyMiA9IE5ldy1PYmplY3QgU3lzdGVtLkludHB0ciAtQXJndW1lbnRMaXN0ICRPZmZzZXQyCiAgICAgICAgICAgICAgICAgICAgJEluZm8yID0gJE5ld0ludFB0cjIgLWFzICRXVFNfQ0xJRU5UX0FERFJFU1MKCiAgICAgICAgICAgICAgICAgICAgJFNvdXJjZUlQID0gJEluZm8yLkFkZHJlc3MgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYoJFNvdXJjZUlQWzJdIC1uZSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTb3VyY2VJUCA9IFtTdHJpbmddJFNvdXJjZUlQWzJdKyIuIitbU3RyaW5nXSRTb3VyY2VJUFszXSsiLiIrW1N0cmluZ10kU291cmNlSVBbNF0rIi4iK1tTdHJpbmddJFNvdXJjZUlQWzVdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkU291cmNlSVAgPSAkTnVsbAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJFJEUFNlc3Npb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnU291cmNlSVAnICRTb3VyY2VJUAogICAgICAgICAgICAgICAgICAgICRSRFBTZXNzaW9uCgogICAgICAgICAgICAgICAgICAgICMgZnJlZSB1cCB0aGUgbWVtb3J5IGJ1ZmZlcgogICAgICAgICAgICAgICAgICAgICROdWxsID0gJFd0c2FwaTMyOjpXVFNGcmVlTWVtb3J5KCRwcEJ1ZmZlcikKCiAgICAgICAgICAgICAgICAgICAgJE9mZnNldCArPSAkSW5jcmVtZW50CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjIGZyZWUgdXAgdGhlIG1lbW9yeSByZXN1bHQgYnVmZmVyCiAgICAgICAgICAgICAgICAkTnVsbCA9ICRXdHNhcGkzMjo6V1RTRnJlZU1lbW9yeUV4KDIsICRwcFNlc3Npb25JbmZvLCAkcENvdW50KQogICAgICAgICAgICB9CiAgICAgICAgICAgICMgQ2xvc2Ugb2ZmIHRoZSBzZXJ2aWNlIGhhbmRsZQogICAgICAgICAgICAkTnVsbCA9ICRXdHNhcGkzMjo6V1RTQ2xvc2VTZXJ2ZXIoJEhhbmRsZSkKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgb3RoZXJ3aXNlIGl0IGZhaWxlZCAtIGdldCB0aGUgbGFzdCBlcnJvcgogICAgICAgICAgICAjICAgZXJyb3IgY29kZXMgLSBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjgxMzgyKHY9dnMuODUpLmFzcHgKICAgICAgICAgICAgJEVyciA9ICRLZXJuZWwzMjo6R2V0TGFzdEVycm9yKCkKICAgICAgICAgICAgV3JpdGUtVmVyYnVzZSAiTGFzdEVycm9yOiAkRXJyIgogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3Mgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCB1c2UgdGhlIE9wZW5TQ01hbmFnZXJXIFdpbjMyQVBJIGNhbGwgdG8gdG8gZXN0YWJsaXNoCiAgICAgICAgYSBoYW5kbGUgdG8gdGhlIHJlbW90ZSBob3N0LiBJZiB0aGlzIHN1Y2NlZWRzLCB0aGUgY3VycmVudCB1c2VyIGNvbnRleHQKICAgICAgICBoYXMgbG9jYWwgYWRtaW5pc3RyYXRvciBhY2VzcyB0byB0aGUgdGFyZ2V0LgoKICAgICAgICBJZGVhIHN0b2xlbiBmcm9tIHRoZSBsb2NhbF9hZG1pbl9zZWFyY2hfZW51bSBwb3N0IG1vZHVsZSBpbiBNZXRhc3Bsb2l0IHdyaXR0ZW4gYnk6CiAgICAgICAgICAgICdCcmFuZG9uIE1jQ2FubiAiemVrbm94IiA8Ym1jY2FublthdF1hY2N1dmFudC5jb20+JwogICAgICAgICAgICAnVGhvbWFzIE1jQ2FydGh5ICJzbWlsaW5ncmFjY29vbiIgPHNtaWxpbmdyYWNjb29uW2F0XWdtYWlsLmNvbT4nCiAgICAgICAgICAgICdSb3ljZSBEYXZpcyAicjNkeSIgPHJkYXZpc1thdF1hY2N1dmFudC5jb20+JwoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIFRoZSBob3N0bmFtZSB0byBxdWVyeSBmb3IgYWN0aXZlIHNlc3Npb25zLgoKICAgIC5PVVRQVVRTCgogICAgICAgICRUcnVlIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byB0aGUgaG9zdG5hbWUsICRGYWxzZSBvdGhlcndpc2UKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3MgLUNvbXB1dGVyTmFtZSBzcWxzZXJ2ZXIKCiAgICAgICAgUmV0dXJucyBhY3RpdmUgc2Vzc2lvbnMgb24gdGhlIGxvY2FsIGhvc3QuCgogICAgLkxJTksKCiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yay9ibG9iL21hc3Rlci9tb2R1bGVzL3Bvc3Qvd2luZG93cy9nYXRoZXIvbG9jYWxfYWRtaW5fc2VhcmNoX2VudW0ucmIKICAgICAgICBodHRwOi8vd3d3LnBvd2Vyc2hlbGxtYWdhemluZS5jb20vMjAxNC8wOS8yNS9lYXNpbHktZGVmaW5pbmctZW51bXMtc3RydWN0cy1hbmQtd2luMzItZnVuY3Rpb25zLWluLW1lbW9yeS8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICdsb2NhbGhvc3QnCiAgICApCgogICAgYmVnaW4gewogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgICMgcHJvY2VzcyBtdWx0aXBsZSBob3N0IG9iamVjdCB0eXBlcyBmcm9tIHRoZSBwaXBlbGluZQogICAgICAgICRDb21wdXRlck5hbWUgPSBHZXQtTmFtZUZpZWxkIC1PYmplY3QgJENvbXB1dGVyTmFtZQoKICAgICAgICAjIDB4RjAwM0YgLSBTQ19NQU5BR0VSX0FMTF9BQ0NFU1MKICAgICAgICAjICAgaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4NTk4MSh2PXZzLjg1KS5hc3B4CiAgICAgICAgJEhhbmRsZSA9ICRBZHZhcGkzMjo6T3BlblNDTWFuYWdlclcoIlxcJENvbXB1dGVyTmFtZSIsICdTZXJ2aWNlc0FjdGl2ZScsIDB4RjAwM0YpCgogICAgICAgIFdyaXRlLURlYnVnICJJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIGhhbmRsZTogJEhhbmRsZSIKCiAgICAgICAgIyBpZiB3ZSBnZXQgYSBub24temVybyBoYW5kbGUgYmFjaywgZXZlcnl0aGluZyB3YXMgc3VjY2Vzc2Z1bAogICAgICAgIGlmICgkSGFuZGxlIC1uZSAwKSB7CiAgICAgICAgICAgICMgQ2xvc2Ugb2ZmIHRoZSBzZXJ2aWNlIGhhbmRsZQogICAgICAgICAgICAkTnVsbCA9ICRBZHZhcGkzMjo6Q2xvc2VTZXJ2aWNlSGFuZGxlKCRIYW5kbGUpCiAgICAgICAgICAgICRUcnVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIG90aGVyd2lzZSBpdCBmYWlsZWQgLSBnZXQgdGhlIGxhc3QgZXJyb3IKICAgICAgICAgICAgIyAgIGVycm9yIGNvZGVzIC0gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4Mih2PXZzLjg1KS5hc3B4CiAgICAgICAgICAgICRFcnIgPSAkS2VybmVsMzI6OkdldExhc3RFcnJvcigpCiAgICAgICAgICAgIFdyaXRlLURlYnVnICJJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIExhc3RFcnJvcjogJEVyciIKICAgICAgICAgICAgJEZhbHNlCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LUxhc3RMb2dnZWRPbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiB1c2VzIHJlbW90ZSByZWdpc3RyeSBmdW5jdGlvbmFsaXR5IHRvIHJldHVybgogICAgICAgIHRoZSBsYXN0IHVzZXIgbG9nZ2VkIG9udG8gYSB0YXJnZXQgbWFjaGluZS4KCiAgICAgICAgTm90ZTogVGhpcyBmdW5jdGlvbiByZXF1aXJlcyBhZG1pbmlzdHJhdGl2ZSByaWdodHMgb24gdGhlCiAgICAgICAgbWFjaGluZSB5b3UncmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGhvc3RuYW1lIHRvIHF1ZXJ5IGZvciB0aGUgbGFzdCBsb2dnZWQgb24gdXNlci4KICAgICAgICBEZWZhdWx0cyB0byB0aGUgbG9jYWxob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUxhc3RMb2dnZWRPbgoKICAgICAgICBSZXR1cm5zIHRoZSBsYXN0IHVzZXIgbG9nZ2VkIG9udG8gdGhlIGxvY2FsIG1hY2hpbmUuCgogICAgLkVYQU1QTEUKICAgICAgICAKICAgICAgICBQUyBDOlw+IEdldC1MYXN0TG9nZ2VkT24gLUNvbXB1dGVyTmFtZSBXSU5ET1dTMQoKICAgICAgICBSZXR1cm5zIHRoZSBsYXN0IHVzZXIgbG9nZ2VkIG9udG8gV0lORE9XUzEKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbQWxpYXMoJ0hvc3ROYW1lJyldICAgICAgICAKICAgICAgICAkQ29tcHV0ZXJOYW1lID0gIi4iCiAgICApCgogICAgcHJvY2VzcyB7CgogICAgICAgICMgcHJvY2VzcyBtdWx0aXBsZSBob3N0IG9iamVjdCB0eXBlcyBmcm9tIHRoZSBwaXBlbGluZQogICAgICAgICRDb21wdXRlck5hbWUgPSBHZXQtTmFtZUZpZWxkIC1PYmplY3QgJENvbXB1dGVyTmFtZQoKICAgICAgICAjIHRyeSB0byBvcGVuIHVwIHRoZSByZW1vdGUgcmVnaXN0cnkga2V5IHRvIGdyYWIgdGhlIGxhc3QgbG9nZ2VkIG9uIHVzZXIKICAgICAgICB0cnkgewogICAgICAgICAgICAkUmVnID0gW1dNSUNsYXNzXSJcXCRDb21wdXRlck5hbWVccm9vdFxkZWZhdWx0OnN0ZFJlZ1Byb3YiCiAgICAgICAgICAgICRIS0xNID0gMjE0NzQ4MzY1MAogICAgICAgICAgICAkS2V5ID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEF1dGhlbnRpY2F0aW9uXExvZ29uVUkiCiAgICAgICAgICAgICRWYWx1ZSA9ICJMYXN0TG9nZ2VkT25Vc2VyIgogICAgICAgICAgICAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS0xNLCAkS2V5LCAkVmFsdWUpLnNWYWx1ZQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIlshXSBFcnJvciBvcGVuaW5nIHJlbW90ZSByZWdpc3RyeSBvbiAkQ29tcHV0ZXJOYW1lLiBSZW1vdGUgcmVnaXN0cnkgbGlrZWx5IG5vdCBlbmFibGVkLiIKICAgICAgICAgICAgJE51bGwKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtQ2FjaGVkUkRQQ29ubmVjdGlvbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVXNlcyByZW1vdGUgcmVnaXN0cnkgZnVuY3Rpb25hbGl0eSB0byBxdWVyeSBhbGwgZW50cmllcyBmb3IgdGhlCiAgICAgICAgIldpbmRvd3MgUmVtb3RlIERlc2t0b3AgQ29ubmVjdGlvbiBDbGllbnQiIG9uIGEgbWFjaGluZSwgc2VwYXJhdGVkIGJ5CiAgICAgICAgdXNlciBhbmQgdGFyZ2V0IHNlcnZlci4KCiAgICAgICAgTm90ZTogVGhpcyBmdW5jdGlvbiByZXF1aXJlcyBhZG1pbmlzdHJhdGl2ZSByaWdodHMgb24gdGhlCiAgICAgICAgbWFjaGluZSB5b3UncmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgVGhlIGhvc3RuYW1lIHRvIHF1ZXJ5IGZvciBSRFAgY2xpZW50IGluZm9ybWF0aW9uLgogICAgICAgIERlZmF1bHRzIHRvIGxvY2FsaG9zdC4KCiAgICAuUEFSQU1FVEVSIFJlbW90ZVVzZXJOYW1lCgogICAgICAgIFRoZSAiZG9tYWluXHVzZXJuYW1lIiB0byB1c2UgZm9yIHRoZSBXTUkgY2FsbCBvbiB0aGUgcmVtb3RlIHN5c3RlbS4KICAgICAgICBJZiBzdXBwbGllZCwgJ1JlbW90ZVBhc3N3b3JkJyBtdXN0IGJlIHN1cHBsaWVkIGFzIHdlbGwuCgogICAgLlBBUkFNRVRFUiBSZW1vdGVQYXNzd29yZAoKICAgICAgICBUaGUgcGFzc3dvcmQgdG8gdXNlIGZvciB0aGUgV01JIGNhbGwgb24gYSByZW1vdGUgc3lzdGVtLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUNhY2hlZFJEUENvbm5lY3Rpb24KCiAgICAgICAgUmV0dXJucyB0aGUgUkRQIGNvbm5lY3Rpb24gY2xpZW50IGluZm9ybWF0aW9uIGZvciB0aGUgbG9jYWwgbWFjaGluZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1DYWNoZWRSRFBDb25uZWN0aW9uIC1Db21wdXRlck5hbWUgV0lORE9XUzIudGVzdGxhYi5sb2NhbAoKICAgICAgICBSZXR1cm5zIHRoZSBSRFAgY29ubmVjdGlvbiBjbGllbnQgaW5mb3JtYXRpb24gZm9yIHRoZSBXSU5ET1dTMi50ZXN0bGFiLmxvY2FsIG1hY2hpbmUKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1DYWNoZWRSRFBDb25uZWN0aW9uIC1Db21wdXRlck5hbWUgV0lORE9XUzIudGVzdGxhYi5sb2NhbCAtUmVtb3RlVXNlck5hbWUgRE9NQUlOXHVzZXIgLVJlbW90ZVBhc3N3b3JkIFBhc3N3b3JkMTIzIQoKICAgICAgICBSZXR1cm5zIHRoZSBSRFAgY29ubmVjdGlvbiBjbGllbnQgaW5mb3JtYXRpb24gZm9yIHRoZSBXSU5ET1dTMi50ZXN0bGFiLmxvY2FsIG1hY2hpbmUgdXNpbmcgYWx0ZXJuYXRlIGNyZWRlbnRpYWxzLgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlck5hbWUgPSAibG9jYWxob3N0IiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUmVtb3RlVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFJlbW90ZVBhc3N3b3JkCiAgICApCgogICAgYmVnaW4gewogICAgICAgIGlmICgkUmVtb3RlVXNlck5hbWUgLWFuZCAkUmVtb3RlUGFzc3dvcmQpIHsKICAgICAgICAgICAgJFBhc3N3b3JkID0gJFJlbW90ZVBhc3N3b3JkIHwgQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgLUZvcmNlCiAgICAgICAgICAgICRDcmVkZW50aWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCgkUmVtb3RlVXNlck5hbWUsJFBhc3N3b3JkKQogICAgICAgIH0KCiAgICAgICAgIyBIS0VZX1VTRVJTCiAgICAgICAgJEhLVSA9IDIxNDc0ODM2NTEKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgICAgICRSZWcgPSBHZXQtV21pb2JqZWN0IC1MaXN0ICdTdGRSZWdQcm92JyAtTmFtZXNwYWNlIHJvb3RcZGVmYXVsdCAtQ29tcHV0ZXJuYW1lICRDb21wdXRlck5hbWUgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRSZWcgPSBHZXQtV21pb2JqZWN0IC1MaXN0ICdTdGRSZWdQcm92JyAtTmFtZXNwYWNlIHJvb3RcZGVmYXVsdCAtQ29tcHV0ZXJuYW1lICRDb21wdXRlck5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIGFjY2Vzc2luZyAkQ29tcHV0ZXJOYW1lLCBsaWtlbHkgaW5zdWZmaWNpZW50IHBlcm1pc3Npb25zIG9yIGZpcmV3YWxsIHJ1bGVzIG9uIGhvc3QiCiAgICAgICAgfQoKICAgICAgICBpZighJFJlZykgewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJFcnJvciBhY2Nlc3NpbmcgJENvbXB1dGVyTmFtZSwgbGlrZWx5IGluc3VmZmljaWVudCBwZXJtaXNzaW9ucyBvciBmaXJld2FsbCBydWxlcyBvbiBob3N0IgogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgIyBleHRyYWN0IG91dCB0aGUgU0lEcyBvZiBkb21haW4gdXNlcnMgaW4gdGhpcyBoaXZlCiAgICAgICAgICAgICRVc2VyU0lEcyA9ICgkUmVnLkVudW1LZXkoJEhLVSwgIiIpKS5zTmFtZXMgfCA/IHsgJF8gLW1hdGNoICdTLTEtNS0yMS1bMC05XSstWzAtOV0rLVswLTldKy1bMC05XSskJyB9CgogICAgICAgICAgICBmb3JlYWNoICgkVXNlclNJRCBpbiAkVXNlclNJRHMpIHsKCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICRVc2VyTmFtZSA9IENvbnZlcnQtU2lkVG9OYW1lICRVc2VyU0lECgogICAgICAgICAgICAgICAgICAgICMgcHVsbCBvdXQgYWxsIHRoZSBjYWNoZWQgUkRQIGNvbm5lY3Rpb25zCiAgICAgICAgICAgICAgICAgICAgJENvbm5lY3Rpb25LZXlzID0gJFJlZy5FbnVtVmFsdWVzKCRIS1UsIiRVc2VyU0lEXFNvZnR3YXJlXE1pY3Jvc29mdFxUZXJtaW5hbCBTZXJ2ZXIgQ2xpZW50XERlZmF1bHQiKS5zTmFtZXMKCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJENvbm5lY3Rpb24gaW4gJENvbm5lY3Rpb25LZXlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgbWFrZSBzdXJlIHRoaXMga2V5IGlzIGEgY2FjaGVkIGNvbm5lY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgaWYoJENvbm5lY3Rpb24gLW1hdGNoICdNUlUuKicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRUYXJnZXRTZXJ2ZXIgPSAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS1UsICIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxEZWZhdWx0IiwgJENvbm5lY3Rpb24pLnNWYWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZENvbm5lY3Rpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlck5hbWUnICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyU0lEJyAkVXNlclNJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdUYXJnZXRTZXJ2ZXInICRUYXJnZXRTZXJ2ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZENvbm5lY3Rpb24gfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlcm5hbWVIaW50JyAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAjIHB1bGwgb3V0IGFsbCB0aGUgY2FjaGVkIHNlcnZlciBpbmZvIHdpdGggdXNlcm5hbWUgaGludHMKICAgICAgICAgICAgICAgICAgICAkU2VydmVyS2V5cyA9ICRSZWcuRW51bUtleSgkSEtVLCIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxTZXJ2ZXJzIikuc05hbWVzCgogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRTZXJ2ZXIgaW4gJFNlcnZlcktleXMpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICRVc2VybmFtZUhpbnQgPSAkUmVnLkdldFN0cmluZ1ZhbHVlKCRIS1UsICIkVXNlclNJRFxTb2Z0d2FyZVxNaWNyb3NvZnRcVGVybWluYWwgU2VydmVyIENsaWVudFxTZXJ2ZXJzXCRTZXJ2ZXIiLCAnVXNlcm5hbWVIaW50Jykuc1ZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAkVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kQ29ubmVjdGlvbiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyU0lEJyAkVXNlclNJRAogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RhcmdldFNlcnZlcicgJFNlcnZlcgogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJuYW1lSGludCcgJFVzZXJuYW1lSGludAogICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRDb25uZWN0aW9uICAgCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3I6ICRfIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gR2V0LU5ldFByb2Nlc3Mgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEdldHMgYSBsaXN0IG9mIHByb2Nlc3Nlcy9vd25lcnMgb24gYSByZW1vdGUgbWFjaGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBUaGUgaG9zdG5hbWUgdG8gcXVlcnkgcHJvY2Vzc2VzLiBEZWZhdWx0cyB0byB0aGUgbG9jYWwgaG9zdCBuYW1lLgoKICAgIC5QQVJBTUVURVIgUmVtb3RlVXNlck5hbWUKCiAgICAgICAgVGhlICJkb21haW5cdXNlcm5hbWUiIHRvIHVzZSBmb3IgdGhlIFdNSSBjYWxsIG9uIGEgcmVtb3RlIHN5c3RlbS4KICAgICAgICBJZiBzdXBwbGllZCwgJ1JlbW90ZVBhc3N3b3JkJyBtdXN0IGJlIHN1cHBsaWVkIGFzIHdlbGwuCgogICAgLlBBUkFNRVRFUiBSZW1vdGVQYXNzd29yZAoKICAgICAgICBUaGUgcGFzc3dvcmQgdG8gdXNlIGZvciB0aGUgV01JIGNhbGwgb24gYSByZW1vdGUgc3lzdGVtLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldFByb2Nlc3MgLUNvbXB1dGVyTmFtZSBXSU5ET1dTMQogICAgCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBwcm9jZXNzZXMgZm9yIFdJTkRPV1MxCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUmVtb3RlVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFJlbW90ZVBhc3N3b3JkCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgCiAgICAgICAgaWYoJENvbXB1dGVyTmFtZSkgewogICAgICAgICAgICAjIHByb2Nlc3MgbXVsdGlwbGUgaG9zdCBvYmplY3QgdHlwZXMgZnJvbSB0aGUgcGlwZWxpbmUKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1OYW1lRmllbGQgLU9iamVjdCAkQ29tcHV0ZXJOYW1lICAgICAgICAgIAogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgIyBkZWZhdWx0IHRvIHRoZSBsb2NhbCBob3N0bmFtZQogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdE5hbWUoKQogICAgICAgIH0KCiAgICAgICAgJENyZWRlbnRpYWwgPSAkTnVsbAoKICAgICAgICBpZigkUmVtb3RlVXNlck5hbWUpIHsKICAgICAgICAgICAgaWYoJFJlbW90ZVBhc3N3b3JkKSB7CiAgICAgICAgICAgICAgICAkUGFzc3dvcmQgPSAkUmVtb3RlUGFzc3dvcmQgfCBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1Bc1BsYWluVGV4dCAtRm9yY2UKICAgICAgICAgICAgICAgICRDcmVkZW50aWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCgkUmVtb3RlVXNlck5hbWUsJFBhc3N3b3JkKQoKICAgICAgICAgICAgICAgICMgdHJ5IHRvIGVudW1lcmF0ZSB0aGUgcHJvY2Vzc2VzIG9uIHRoZSByZW1vdGUgbWFjaGluZSB1c2luZyB0aGUgc3VwcGxpZWQgY3JlZGVudGlhbAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBHZXQtV01Jb2JqZWN0IC1DbGFzcyBXaW4zMl9wcm9jZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgJE93bmVyID0gJF8uZ2V0b3duZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3MgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcyB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdQcm9jZXNzTmFtZScgJF8uUHJvY2Vzc05hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnUHJvY2Vzc0lEJyAkXy5Qcm9jZXNzSUQKICAgICAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRG9tYWluJyAkT3duZXIuRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXInICRPd25lci5Vc2VyCiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZXNzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlshXSBFcnJvciBlbnVtZXJhdGluZyByZW1vdGUgcHJvY2Vzc2VzLCBhY2Nlc3MgbGlrZWx5IGRlbmllZDogJF8iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJbIV0gUmVtb3RlUGFzc3dvcmQgbXVzdCBhbHNvIGJlIHN1cHBsaWVkISIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgIyB0cnkgdG8gZW51bWVyYXRlIHRoZSBwcm9jZXNzZXMgb24gdGhlIHJlbW90ZSBtYWNoaW5lCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBHZXQtV01Jb2JqZWN0IC1DbGFzcyBXaW4zMl9wcm9jZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAkT3duZXIgPSAkXy5nZXRvd25lcigpOwogICAgICAgICAgICAgICAgICAgICRQcm9jZXNzID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0NvbXB1dGVyTmFtZScgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1Byb2Nlc3NOYW1lJyAkXy5Qcm9jZXNzTmFtZQogICAgICAgICAgICAgICAgICAgICRQcm9jZXNzIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1Byb2Nlc3NJRCcgJF8uUHJvY2Vzc0lECiAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnRG9tYWluJyAkT3duZXIuRG9tYWluCiAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3MgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlcicgJE93bmVyLlVzZXIKICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlshXSBFcnJvciBlbnVtZXJhdGluZyByZW1vdGUgcHJvY2Vzc2VzLCBhY2Nlc3MgbGlrZWx5IGRlbmllZDogJF8iCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBGaW5kLUludGVyZXN0aW5nRmlsZSB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiByZWN1cnNpdmVseSBzZWFyY2hlcyBhIGdpdmVuIFVOQyBwYXRoIGZvciBmaWxlcyB3aXRoCiAgICAgICAgc3BlY2lmaWMga2V5d29yZHMgaW4gdGhlIG5hbWUgKGRlZmF1bHQgb2YgcGFzcywgc2Vuc2l0aXZlLCBzZWNyZXQsIGFkbWluLAogICAgICAgIGxvZ2luIGFuZCB1bmF0dGVuZCoueG1sKS4gVGhlIG91dHB1dCBjYW4gYmUgcGlwZWQgb3V0IHRvIGEgY3N2IHdpdGggdGhlCiAgICAgICAgLU91dEZpbGUgZmxhZy4gQnkgZGVmYXVsdCwgaGlkZGVuIGZpbGVzL2ZvbGRlcnMgYXJlIGluY2x1ZGVkIGluIHNlYXJjaCByZXN1bHRzLgoKICAgIC5QQVJBTUVURVIgUGF0aAoKICAgICAgICBVTkMvbG9jYWwgcGF0aCB0byByZWN1cnNpdmVseSBzZWFyY2guCgogICAgLlBBUkFNRVRFUiBUZXJtcwoKICAgICAgICBUZXJtcyB0byBzZWFyY2ggZm9yLgoKICAgIC5QQVJBTUVURVIgT2ZmaWNlRG9jcwoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBmb3Igb2ZmaWNlIGRvY3VtZW50cyAoKi5kb2MqLCAqLnhscyosICoucHB0KikKCiAgICAuUEFSQU1FVEVSIEZyZXNoRVhFcwoKICAgICAgICBTd2l0Y2guIEZpbmQgLkVYRXMgYWNjZXNzZWQgd2l0aGluIHRoZSBsYXN0IHdlZWsuCgogICAgLlBBUkFNRVRFUiBMYXN0QWNjZXNzVGltZQoKICAgICAgICBPbmx5IHJldHVybiBmaWxlcyB3aXRoIGEgTGFzdEFjY2Vzc1RpbWUgZ3JlYXRlciB0aGFuIHRoaXMgZGF0ZSB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIExhc3RXcml0ZVRpbWUKCiAgICAgICAgT25seSByZXR1cm4gZmlsZXMgd2l0aCBhIExhc3RXcml0ZVRpbWUgZ3JlYXRlciB0aGFuIHRoaXMgZGF0ZSB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIENyZWF0aW9uVGltZQoKICAgICAgICBPbmx5IHJldHVybiBmaWxlcyB3aXRoIGEgQ3JlYXRpb25UaW1lIGdyZWF0ZXIgdGhhbiB0aGlzIGRhdGUgdmFsdWUuCgogICAgLlBBUkFNRVRFUiBFeGNsdWRlRm9sZGVycwoKICAgICAgICBTd2l0Y2guIEV4Y2x1ZGUgZm9sZGVycyBmcm9tIHRoZSBzZWFyY2ggcmVzdWx0cy4KCiAgICAuUEFSQU1FVEVSIEV4Y2x1ZGVIaWRkZW4KCiAgICAgICAgU3dpdGNoLiBFeGNsdWRlIGhpZGRlbiBmaWxlcyBhbmQgZm9sZGVycyBmcm9tIHRoZSBzZWFyY2ggcmVzdWx0cy4KCiAgICAuUEFSQU1FVEVSIENoZWNrV3JpdGVBY2Nlc3MKCiAgICAgICAgU3dpdGNoLiBPbmx5IHJldHVybnMgZmlsZXMgdGhlIGN1cnJlbnQgdXNlciBoYXMgd3JpdGUgYWNjZXNzIHRvLgoKICAgIC5QQVJBTUVURVIgT3V0RmlsZQoKICAgICAgICBPdXRwdXQgcmVzdWx0cyB0byBhIHNwZWNpZmllZCBjc3Ygb3V0cHV0IGZpbGUuCgogICAgLlBBUkFNRVRFUiBVc2VQU0RyaXZlCgogICAgICAgIFN3aXRjaC4gTW91bnQgdGFyZ2V0IHJlbW90ZSBwYXRoIHdpdGggdGVtcG9yYXJ5IFBTRHJpdmVzLgoKICAgIC5QQVJBTUVURVIgQ3JlZGVudGlhbAoKICAgICAgICBDcmVkZW50aWFsIHRvIHVzZSB0byBtb3VudCB0aGUgUFNEcml2ZSBmb3Igc2VhcmNoaW5nLgoKICAgIC5PVVRQVVRTCgogICAgICAgIFRoZSBmdWxsIHBhdGgsIG93bmVyLCBsYXN0YWNjZXNzIHRpbWUsIGxhc3R3cml0ZSB0aW1lLCBhbmQgc2l6ZSBmb3IgZWFjaCBmb3VuZCBmaWxlLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1JbnRlcmVzdGluZ0ZpbGUgLVBhdGggQzpcQmFja3VwXAogICAgICAgIAogICAgICAgIFJldHVybnMgYW55IGZpbGVzIG9uIHRoZSBsb2NhbCBwYXRoIEM6XEJhY2t1cFwgdGhhdCBoYXZlIHRoZSBkZWZhdWx0CiAgICAgICAgc2VhcmNoIHRlcm0gc2V0IGluIHRoZSB0aXRsZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtSW50ZXJlc3RpbmdGaWxlIC1QYXRoIFxcV0lORE9XUzdcVXNlcnNcIC1UZXJtcyBzYWxhcmllcyxlbWFpbCAtT3V0RmlsZSBvdXQuY3N2CiAgICAgICAgCiAgICAgICAgUmV0dXJucyBhbnkgZmlsZXMgb24gdGhlIHJlbW90ZSBwYXRoIFxcV0lORE9XUzdcVXNlcnNcIHRoYXQgaGF2ZSAnc2FsYXJpZXMnCiAgICAgICAgb3IgJ2VtYWlsJyBpbiB0aGUgdGl0bGUsIGFuZCB3cml0ZXMgdGhlIHJlc3VsdHMgb3V0IHRvIGEgY3N2IGZpbGUKICAgICAgICBuYW1lZCAnb3V0LmNzdicKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtSW50ZXJlc3RpbmdGaWxlIC1QYXRoIFxcV0lORE9XUzdcVXNlcnNcIC1MYXN0QWNjZXNzVGltZSAoR2V0LURhdGUpLkFkZERheXMoLTcpCgogICAgICAgIFJldHVybnMgYW55IGZpbGVzIG9uIHRoZSByZW1vdGUgcGF0aCBcXFdJTkRPV1M3XFVzZXJzXCB0aGF0IGhhdmUgdGhlIGRlZmF1bHQKICAgICAgICBzZWFyY2ggdGVybSBzZXQgaW4gdGhlIHRpdGxlIGFuZCB3ZXJlIGFjY2Vzc2VkIHdpdGhpbiB0aGUgbGFzdCB3ZWVrLgoKICAgIC5MSU5LCiAgICAgICAgCiAgICAgICAgaHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL3JlZHRlYW1pbmcvZmlsZS1zZXJ2ZXItdHJpYWdlLW9uLXJlZC10ZWFtLWVuZ2FnZW1lbnRzLwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQYXRoID0gJy5cJywKCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRUZXJtcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkT2ZmaWNlRG9jcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRnJlc2hFWEVzLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRMYXN0QWNjZXNzVGltZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTGFzdFdyaXRlVGltZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ3JlYXRpb25UaW1lLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlRm9sZGVycywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRXhjbHVkZUhpZGRlbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tXcml0ZUFjY2VzcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkT3V0RmlsZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVXNlUFNEcml2ZSwKCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXTo6RW1wdHkKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgIyBkZWZhdWx0IHNlYXJjaCB0ZXJtcwogICAgICAgICRTZWFyY2hUZXJtcyA9IEAoJ3Bhc3MnLCAnc2Vuc2l0aXZlJywgJ2FkbWluJywgJ2xvZ2luJywgJ3NlY3JldCcsICd1bmF0dGVuZCoueG1sJywgJy52bWRrJywgJ2NyZWRzJywgJ2NyZWRlbnRpYWwnLCAnLmNvbmZpZycpCgogICAgICAgIGlmKCEkUGF0aC5FbmRzV2l0aCgnXCcpKSB7CiAgICAgICAgICAgICRQYXRoID0gJFBhdGggKyAnXCcKICAgICAgICB9CiAgICAgICAgaWYoJENyZWRlbnRpYWwgLW5lIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF06OkVtcHR5KSB7ICRVc2VQU0RyaXZlID0gJFRydWUgfQoKICAgICAgICAjIGNoZWNrIGlmIGN1c3RvbSBzZWFyY2ggdGVybXMgd2VyZSBwYXNzZWQKICAgICAgICBpZiAoJFRlcm1zKSB7CiAgICAgICAgICAgIGlmKCRUZXJtcyAtaXNub3QgW3N5c3RlbS5hcnJheV0pIHsKICAgICAgICAgICAgICAgICRUZXJtcyA9IEAoJFRlcm1zKQogICAgICAgICAgICB9CiAgICAgICAgICAgICRTZWFyY2hUZXJtcyA9ICRUZXJtcwogICAgICAgIH0KCiAgICAgICAgaWYoLW5vdCAkU2VhcmNoVGVybXNbMF0uc3RhcnRzd2l0aCgiKiIpKSB7CiAgICAgICAgICAgICMgYXBwZW5kIHdpbGRjYXJkcyB0byB0aGUgZnJvbnQgYW5kIGJhY2sgb2YgYWxsIHNlYXJjaCB0ZXJtcwogICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgLWx0ICRTZWFyY2hUZXJtcy5Db3VudDsgJGkrKykgewogICAgICAgICAgICAgICAgJFNlYXJjaFRlcm1zWyRpXSA9ICIqJCgkU2VhcmNoVGVybXNbJGldKSoiCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgc2VhcmNoIGp1c3QgZm9yIG9mZmljZSBkb2N1bWVudHMgaWYgc3BlY2lmaWVkCiAgICAgICAgaWYgKCRPZmZpY2VEb2NzKSB7CiAgICAgICAgICAgICRTZWFyY2hUZXJtcyA9IEAoJyouZG9jJywgJyouZG9jeCcsICcqLnhscycsICcqLnhsc3gnLCAnKi5wcHQnLCAnKi5wcHR4JykKICAgICAgICB9CgogICAgICAgICMgZmluZCAuZXhlJ3MgYWNjZXNzZWQgd2l0aGluIHRoZSBsYXN0IDcgZGF5cwogICAgICAgIGlmKCRGcmVzaEVYRXMpIHsKICAgICAgICAgICAgIyBnZXQgYW4gYWNjZXNzIHRpbWUgbGltaXQgb2YgNyBkYXlzIGFnbwogICAgICAgICAgICAkTGFzdEFjY2Vzc1RpbWUgPSAoZ2V0LWRhdGUpLkFkZERheXMoLTcpLlRvU3RyaW5nKCdNTS9kZC95eXl5JykKICAgICAgICAgICAgJFNlYXJjaFRlcm1zID0gJyouZXhlJwogICAgICAgIH0KCiAgICAgICAgaWYoJFVzZVBTRHJpdmUpIHsKICAgICAgICAgICAgIyBpZiB3ZSdyZSBQU0RyaXZlcywgY3JlYXRlIGEgdGVtcG9yYXJ5IG1vdW50IHBvaW50CiAgICAgICAgICAgICRQYXJ0cyA9ICRQYXRoLnNwbGl0KCdcJykKICAgICAgICAgICAgJEZvbGRlclBhdGggPSAkUGFydHNbMC4uKCRQYXJ0cy5sZW5ndGgtMildIC1qb2luICdcJwogICAgICAgICAgICAkRmlsZVBhdGggPSAkUGFydHNbLTFdCiAgICAgICAgICAgICRSYW5kRHJpdmUgPSAoImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Ii5Ub0NoYXJBcnJheSgpIHwgR2V0LVJhbmRvbSAtQ291bnQgNykgLWpvaW4gJycKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIk1vdW50aW5nIHBhdGggJFBhdGggdXNpbmcgYSB0ZW1wIFBTRHJpdmUgYXQgJFJhbmREcml2ZSIKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkTnVsbCA9IE5ldy1QU0RyaXZlIC1OYW1lICRSYW5kRHJpdmUgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLVBTUHJvdmlkZXIgRmlsZVN5c3RlbSAtUm9vdCAkRm9sZGVyUGF0aCAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJFcnJvciBtb3VudGluZyBwYXRoICRQYXRoIDogJF8iCiAgICAgICAgICAgICAgICByZXR1cm4gJE51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBzbyB3ZSBjYW4gY2QvZGlyIHRoZSBuZXcgZHJpdmUKICAgICAgICAgICAgJFBhdGggPSAkUmFuZERyaXZlICsgIjpcIiArICRGaWxlUGF0aAogICAgICAgIH0KICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFNlYXJjaCBwYXRoICRQYXRoIgoKICAgICAgICBmdW5jdGlvbiBJbnZva2UtQ2hlY2tXcml0ZSB7CiAgICAgICAgICAgICMgc2hvcnQgaGVscGVyIHRvIGNoZWNrIGlzIHRoZSBjdXJyZW50IHVzZXIgY2FuIHdyaXRlIHRvIGEgZmlsZQogICAgICAgICAgICBbQ21kbGV0QmluZGluZygpXXBhcmFtKFtTdHJpbmddJFBhdGgpCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkRmlsZXRlc3QgPSBbSU8uRklMRV06Ok9wZW5Xcml0ZSgkUGF0aCkKICAgICAgICAgICAgICAgICRGaWxldGVzdC5DbG9zZSgpCiAgICAgICAgICAgICAgICAkVHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgJEVycm9yWzBdCiAgICAgICAgICAgICAgICAkRmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJFNlYXJjaEFyZ3MgPSAgQHsKICAgICAgICAgICAgJ1BhdGgnID0gJFBhdGgKICAgICAgICAgICAgJ1JlY3Vyc2UnID0gJFRydWUKICAgICAgICAgICAgJ0ZvcmNlJyA9ICQoLW5vdCAkRXhjbHVkZUhpZGRlbikKICAgICAgICAgICAgJ0luY2x1ZGUnID0gJFNlYXJjaFRlcm1zCiAgICAgICAgICAgICdFcnJvckFjdGlvbicgPSAnU2lsZW50bHlDb250aW51ZScKICAgICAgICB9CgogICAgICAgIEdldC1DaGlsZEl0ZW0gQFNlYXJjaEFyZ3MgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJF8KICAgICAgICAgICAgIyBjaGVjayBpZiB3ZSdyZSBleGNsdWRpbmcgZm9sZGVycwogICAgICAgICAgICBpZighJEV4Y2x1ZGVGb2xkZXJzIC1vciAhJF8uUFNJc0NvbnRhaW5lcikgeyRffQogICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIGlmKCRMYXN0QWNjZXNzVGltZSAtb3IgJExhc3RXcml0ZVRpbWUgLW9yICRDcmVhdGlvblRpbWUpIHsKICAgICAgICAgICAgICAgIGlmKCRMYXN0QWNjZXNzVGltZSAtYW5kICgkXy5MYXN0QWNjZXNzVGltZSAtZ3QgJExhc3RBY2Nlc3NUaW1lKSkgeyRffQogICAgICAgICAgICAgICAgZWxzZWlmKCRMYXN0V3JpdGVUaW1lIC1hbmQgKCRfLkxhc3RXcml0ZVRpbWUgLWd0ICRMYXN0V3JpdGVUaW1lKSkgeyRffQogICAgICAgICAgICAgICAgZWxzZWlmKCRDcmVhdGlvblRpbWUgLWFuZCAoJF8uQ3JlYXRpb25UaW1lIC1ndCAkQ3JlYXRpb25UaW1lKSkgeyRffQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgeyRffQogICAgICAgIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICMgZmlsdGVyIGZvciB3cml0ZSBhY2Nlc3MgKGlmIGFwcGxpY2FibGUpCiAgICAgICAgICAgIGlmKCgtbm90ICRDaGVja1dyaXRlQWNjZXNzKSAtb3IgKEludm9rZS1DaGVja1dyaXRlIC1QYXRoICRfLkZ1bGxOYW1lKSkgeyRffQogICAgICAgIH0gfCBTZWxlY3QtT2JqZWN0IEZ1bGxOYW1lLEB7TmFtZT0nT3duZXInO0V4cHJlc3Npb249eyhHZXQtQWNsICRfLkZ1bGxOYW1lKS5Pd25lcn19LExhc3RBY2Nlc3NUaW1lLExhc3RXcml0ZVRpbWUsQ3JlYXRpb25UaW1lLExlbmd0aCB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgIyBjaGVjayBpZiB3ZSdyZSBvdXRwdXR0aW5nIHRvIHRoZSBwaXBlbGluZSBvciBhbiBvdXRwdXQgZmlsZQogICAgICAgICAgICBpZigkT3V0RmlsZSkge0V4cG9ydC1Qb3dlclZpZXdDU1YgLUlucHV0T2JqZWN0ICRfIC1PdXRGaWxlICRPdXRGaWxlfQogICAgICAgICAgICBlbHNlIHskX30KICAgICAgICB9CiAgICB9CgogICAgZW5kIHsKICAgICAgICBpZigkVXNlUFNEcml2ZSAtYW5kICRSYW5kRHJpdmUpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUmVtb3ZpbmcgdGVtcCBQU0RyaXZlICRSYW5kRHJpdmUiCiAgICAgICAgICAgIEdldC1QU0RyaXZlIC1OYW1lICRSYW5kRHJpdmUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBSZW1vdmUtUFNEcml2ZQogICAgICAgIH0KICAgIH0KfQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyAnTWV0YSctZnVuY3Rpb25zIHN0YXJ0IGJlbG93CiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZ1bmN0aW9uIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIHsKICAgICMgSGVscGVyIHVzZWQgYnkgYW55IHRocmVhZGVkIGhvc3QgZW51bWVyYXRpb24gZnVuY3Rpb25zCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0kVHJ1ZSldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MSxNYW5kYXRvcnk9JFRydWUpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlNjcmlwdEJsb2NrXQogICAgICAgICRTY3JpcHRCbG9jaywKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0yKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRTY3JpcHRQYXJhbWV0ZXJzLAoKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzID0gMjAsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vSW1wb3J0cwogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKCiAgICAgICAgIyBBZGFwdGVkIGZyb206CiAgICAgICAgIyAgIGh0dHA6Ly9wb3dlcnNoZWxsLm9yZy93cC9mb3J1bXMvdG9waWMvaW52cGtlLXBhcmFsbGVsLW5lZWQtaGVscC10by1jbG9uZS10aGUtY3VycmVudC1ydW5zcGFjZS8KICAgICAgICAkU2Vzc2lvblN0YXRlID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUnVuc3BhY2VzLkluaXRpYWxTZXNzaW9uU3RhdGVdOjpDcmVhdGVEZWZhdWx0KCkKICAgICAgICAkU2Vzc2lvblN0YXRlLkFwYXJ0bWVudFN0YXRlID0gW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6Q3VycmVudFRocmVhZC5HZXRBcGFydG1lbnRTdGF0ZSgpCgogICAgICAgICMgaW1wb3J0IHRoZSBjdXJyZW50IHNlc3Npb24gc3RhdGUncyB2YXJpYWJsZXMgYW5kIGZ1bmN0aW9ucyBzbyB0aGUgY2hhaW5lZCBQb3dlclZpZXcKICAgICAgICAjICAgZnVuY3Rpb25hbGl0eSBjYW4gYmUgdXNlZCBieSB0aGUgdGhyZWFkZWQgYmxvY2tzCiAgICAgICAgaWYoISROb0ltcG9ydHMpIHsKCiAgICAgICAgICAgICMgZ3JhYiBhbGwgdGhlIGN1cnJlbnQgdmFyaWFibGVzIGZvciB0aGlzIHJ1bnNwYWNlCiAgICAgICAgICAgICRNeVZhcnMgPSBHZXQtVmFyaWFibGUgLVNjb3BlIDIKCiAgICAgICAgICAgICMgdGhlc2UgVmFyaWFibGVzIGFyZSBhZGRlZCBieSBSdW5zcGFjZS5PcGVuKCkgTWV0aG9kIGFuZCBwcm9kdWNlIFN0b3AgZXJyb3JzIGlmIHlvdSBhZGQgdGhlbSB0d2ljZQogICAgICAgICAgICAkVm9yYmlkZGVuVmFycyA9IEAoIj8iLCJhcmdzIiwiQ29uc29sZUZpbGVOYW1lIiwiRXJyb3IiLCJFeGVjdXRpb25Db250ZXh0IiwiZmFsc2UiLCJIT01FIiwiSG9zdCIsImlucHV0IiwiSW5wdXRPYmplY3QiLCJNYXhpbXVtQWxpYXNDb3VudCIsIk1heGltdW1Ecml2ZUNvdW50IiwiTWF4aW11bUVycm9yQ291bnQiLCJNYXhpbXVtRnVuY3Rpb25Db3VudCIsIk1heGltdW1IaXN0b3J5Q291bnQiLCJNYXhpbXVtVmFyaWFibGVDb3VudCIsIk15SW52b2NhdGlvbiIsIm51bGwiLCJQSUQiLCJQU0JvdW5kUGFyYW1ldGVycyIsIlBTQ29tbWFuZFBhdGgiLCJQU0N1bHR1cmUiLCJQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXMiLCJQU0hPTUUiLCJQU1NjcmlwdFJvb3QiLCJQU1VJQ3VsdHVyZSIsIlBTVmVyc2lvblRhYmxlIiwiUFdEIiwiU2hlbGxJZCIsIlN5bmNocm9uaXplZEhhc2giLCJ0cnVlIikKCiAgICAgICAgICAgICMgQWRkIFZhcmlhYmxlcyBmcm9tIFBhcmVudCBTY29wZSAoY3VycmVudCBydW5zcGFjZSkgaW50byB0aGUgSW5pdGlhbFNlc3Npb25TdGF0ZQogICAgICAgICAgICBGb3JFYWNoKCRWYXIgaW4gJE15VmFycykgewogICAgICAgICAgICAgICAgaWYoJFZvcmJpZGRlblZhcnMgLU5vdENvbnRhaW5zICRWYXIuTmFtZSkgewogICAgICAgICAgICAgICAgJFNlc3Npb25TdGF0ZS5WYXJpYWJsZXMuQWRkKChOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlJ1bnNwYWNlcy5TZXNzaW9uU3RhdGVWYXJpYWJsZUVudHJ5IC1Bcmd1bWVudExpc3QgJFZhci5uYW1lLCRWYXIuVmFsdWUsJFZhci5kZXNjcmlwdGlvbiwkVmFyLm9wdGlvbnMsJFZhci5hdHRyaWJ1dGVzKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBBZGQgRnVuY3Rpb25zIGZyb20gY3VycmVudCBydW5zcGFjZSB0byB0aGUgSW5pdGlhbFNlc3Npb25TdGF0ZQogICAgICAgICAgICBGb3JFYWNoKCRGdW5jdGlvbiBpbiAoR2V0LUNoaWxkSXRlbSBGdW5jdGlvbjopKSB7CiAgICAgICAgICAgICAgICAkU2Vzc2lvblN0YXRlLkNvbW1hbmRzLkFkZCgoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SdW5zcGFjZXMuU2Vzc2lvblN0YXRlRnVuY3Rpb25FbnRyeSAtQXJndW1lbnRMaXN0ICRGdW5jdGlvbi5OYW1lLCAkRnVuY3Rpb24uRGVmaW5pdGlvbikpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgdGhyZWFkaW5nIGFkYXB0ZWQgZnJvbQogICAgICAgICMgaHR0cHM6Ly9naXRodWIuY29tL2RhcmtvcGVyYXRvci9Qb3NoLVNlY01vZC9ibG9iL21hc3Rlci9EaXNjb3ZlcnkvRGlzY292ZXJ5LnBzbTEjTDQwNwogICAgICAgICMgICBUaGFua3MgQ2FybG9zIQoKICAgICAgICAjIGNyZWF0ZSBhIHBvb2wgb2YgbWF4VGhyZWFkIHJ1bnNwYWNlcwogICAgICAgICRQb29sID0gW3J1bnNwYWNlZmFjdG9yeV06OkNyZWF0ZVJ1bnNwYWNlUG9vbCgxLCAkVGhyZWFkcywgJFNlc3Npb25TdGF0ZSwgJEhvc3QpCiAgICAgICAgJFBvb2wuT3BlbigpCgogICAgICAgICRKb2JzID0gQCgpCiAgICAgICAgJFBTID0gQCgpCiAgICAgICAgJFdhaXQgPSBAKCkKCiAgICAgICAgJENvdW50ZXIgPSAwCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIEZvckVhY2ggKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJOYW1lKSB7CgogICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZSBnZXQgYSBzZXJ2ZXIgbmFtZQogICAgICAgICAgICBpZiAoJENvbXB1dGVyIC1uZSAnJykgewogICAgICAgICAgICAgICAgIyBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJCgkQ291bnRlcisxKSBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKCiAgICAgICAgICAgICAgICBXaGlsZSAoJCgkUG9vbC5HZXRBdmFpbGFibGVSdW5zcGFjZXMoKSkgLWxlIDApIHsKICAgICAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlTZWNvbmRzIDUwMAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICMgY3JlYXRlIGEgInBvd2Vyc2hlbGwgcGlwZWxpbmUgcnVubmVyIgogICAgICAgICAgICAgICAgJFBTICs9IFtwb3dlcnNoZWxsXTo6Y3JlYXRlKCkKCiAgICAgICAgICAgICAgICAkUFNbJENvdW50ZXJdLnJ1bnNwYWNlcG9vbCA9ICRQb29sCgogICAgICAgICAgICAgICAgIyBhZGQgdGhlIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cwogICAgICAgICAgICAgICAgJE51bGwgPSAkUFNbJENvdW50ZXJdLkFkZFNjcmlwdCgkU2NyaXB0QmxvY2spLkFkZFBhcmFtZXRlcignQ29tcHV0ZXJOYW1lJywgJENvbXB1dGVyKQogICAgICAgICAgICAgICAgaWYoJFNjcmlwdFBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkUGFyYW0gaW4gJFNjcmlwdFBhcmFtZXRlcnMuR2V0RW51bWVyYXRvcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICROdWxsID0gJFBTWyRDb3VudGVyXS5BZGRQYXJhbWV0ZXIoJFBhcmFtLk5hbWUsICRQYXJhbS5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyBzdGFydCBqb2IKICAgICAgICAgICAgICAgICRKb2JzICs9ICRQU1skQ291bnRlcl0uQmVnaW5JbnZva2UoKTsKCiAgICAgICAgICAgICAgICAjIHN0b3JlIHdhaXQgaGFuZGxlcyBmb3IgV2FpdEZvckFsbCBjYWxsCiAgICAgICAgICAgICAgICAkV2FpdCArPSAkSm9ic1skQ291bnRlcl0uQXN5bmNXYWl0SGFuZGxlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKICAgICAgICB9CiAgICB9CgogICAgZW5kIHsKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV2FpdGluZyBmb3Igc2Nhbm5pbmcgdGhyZWFkcyB0byBmaW5pc2guLi4iCgogICAgICAgICRXYWl0VGltZW91dCA9IEdldC1EYXRlCgogICAgICAgICMgc2V0IGEgNjAgc2Vjb25kIHRpbWVvdXQgZm9yIHRoZSBzY2FubmluZyB0aHJlYWRzCiAgICAgICAgd2hpbGUgKCQoJEpvYnMgfCBXaGVyZS1PYmplY3QgeyRfLklzQ29tcGxldGVkIC1lcSAkRmFsc2V9KS5jb3VudCAtZ3QgMCAtb3IgJCgkKCQoR2V0LURhdGUpIC0gJFdhaXRUaW1lb3V0KS50b3RhbFNlY29uZHMpIC1ndCA2MCkgewogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpU2Vjb25kcyA1MDAKICAgICAgICAgICAgfQoKICAgICAgICAjIGVuZCBhc3luYyBjYWxsCiAgICAgICAgZm9yICgkeSA9IDA7ICR5IC1sdCAkQ291bnRlcjsgJHkrKykgewoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICMgY29tcGxldGUgYXN5bmMgam9iCiAgICAgICAgICAgICAgICAkUFNbJHldLkVuZEludm9rZSgkSm9ic1skeV0pCgogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgImVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICRQU1skeV0uRGlzcG9zZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgJFBvb2wuRGlzcG9zZSgpCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWxsIHRocmVhZHMgY29tcGxldGVkISIKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1Vc2VySHVudGVyIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBGaW5kcyB3aGljaCBtYWNoaW5lcyB1c2VycyBvZiBhIHNwZWNpZmllZCBncm91cCBhcmUgbG9nZ2VkIGludG8uCgogICAgICAgIEF1dGhvcjogQGhhcm1qMHkKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKCiAgICAuREVTQ1JJUFRJT04KCiAgICAgICAgVGhpcyBmdW5jdGlvbiBmaW5kcyB0aGUgbG9jYWwgZG9tYWluIG5hbWUgZm9yIGEgaG9zdCB1c2luZyBHZXQtTmV0RG9tYWluLAogICAgICAgIHF1ZXJpZXMgdGhlIGRvbWFpbiBmb3IgdXNlcnMgb2YgYSBzcGVjaWZpZWQgZ3JvdXAgKGRlZmF1bHQgImRvbWFpbiBhZG1pbnMiKQogICAgICAgIHdpdGggR2V0LU5ldEdyb3VwTWVtYmVyIG9yIHJlYWRzIGluIGEgdGFyZ2V0IHVzZXIgbGlzdCwgcXVlcmllcyB0aGUgZG9tYWluIGZvciBhbGwKICAgICAgICBhY3RpdmUgbWFjaGluZXMgd2l0aCBHZXQtTmV0Q29tcHV0ZXIgb3IgcmVhZHMgaW4gYSBwcmUtcG9wdWxhdGVkIGhvc3QgbGlzdCwKICAgICAgICByYW5kb21seSBzaHVmZmxlcyB0aGUgdGFyZ2V0IGxpc3QsIHRoZW4gZm9yIGVhY2ggc2VydmVyIGl0IGdldHMgYSBsaXN0IG9mCiAgICAgICAgYWN0aXZlIHVzZXJzIHdpdGggR2V0LU5ldFNlc3Npb24vR2V0LU5ldExvZ2dlZG9uLiBUaGUgZm91bmQgdXNlciBsaXN0IGlzIGNvbXBhcmVkCiAgICAgICAgYWdhaW5zdCB0aGUgdGFyZ2V0IGxpc3QsIGFuZCBhIHN0YXR1cyBtZXNzYWdlIGlzIGRpc3BsYXllZCBmb3IgYW55IGhpdHMuCiAgICAgICAgVGhlIGZsYWcgLUNoZWNrQWNjZXNzIHdpbGwgY2hlY2sgZWFjaCBwb3NpdGl2ZSBob3N0IHRvIHNlZSBpZiB0aGUgY3VycmVudAogICAgICAgIHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byB0aGUgbWFjaGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyTmFtZQoKICAgICAgICBIb3N0IGFycmF5IHRvIGVudW1lcmF0ZSwgcGFzc2FibGUgb24gdGhlIHBpcGVsaW5lLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWxlCgogICAgICAgIEZpbGUgb2YgaG9zdG5hbWVzL0lQcyB0byBzZWFyY2guCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbHRlcgoKICAgICAgICBIb3N0IGZpbHRlciBuYW1lIHRvIHF1ZXJ5IEFEIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJBRFNwYXRoCgogICAgICAgIFRoZSBMREFQIHNvdXJjZSB0byBzZWFyY2ggdGhyb3VnaCBmb3IgaG9zdHMsIGUuZy4gIkxEQVA6Ly9PVT1zZWNyZXQsREM9dGVzdGxhYixEQz1sb2NhbCIKICAgICAgICBVc2VmdWwgZm9yIE9VIHF1ZXJpZXMuCgogICAgLlBBUkFNRVRFUiBVbmNvbnN0cmFpbmVkCgogICAgICAgIFN3aXRjaC4gT25seSBlbnVtZXJhdGUgY29tcHV0ZXJzIHRoYXQgaGF2ZSB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24uCgogICAgLlBBUkFNRVRFUiBHcm91cE5hbWUKCiAgICAgICAgR3JvdXAgbmFtZSB0byBxdWVyeSBmb3IgdGFyZ2V0IHVzZXJzLgoKICAgIC5QQVJBTUVURVIgVGFyZ2V0U2VydmVyCgogICAgICAgIEh1bnQgZm9yIHVzZXJzIHdobyBhcmUgZWZmZWN0aXZlIGxvY2FsIGFkbWlucyBvbiBhIHRhcmdldCBzZXJ2ZXIuCgogICAgLlBBUkFNRVRFUiBVc2VyTmFtZQoKICAgICAgICBTcGVjaWZpYyB1c2VybmFtZSB0byBzZWFyY2ggZm9yLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSBmb3IgdXNlciBlbnVtZXJhdGlvbiwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgVXNlckFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoIGZvciB1c2VycywgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIFVzZXJGaWxlCgogICAgICAgIEZpbGUgb2YgdXNlcm5hbWVzIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBBZG1pbkNvdW50CgogICAgICAgIFN3aXRjaC4gSHVudCBmb3IgdXNlcnMgd2l0aCBhZG1pbkNvdW50PTEuCgogICAgLlBBUkFNRVRFUiBBbGxvd0RlbGVnYXRpb24KCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gdXNlciBhY2NvdW50cyB0aGF0IGFyZSBub3QgbWFya2VkIGFzICdzZW5zaXRpdmUgYW5kIG5vdCBhbGxvd2VkIGZvciBkZWxlZ2F0aW9uJwoKICAgIC5QQVJBTUVURVIgU3RvcE9uU3VjY2VzcwoKICAgICAgICBTd2l0Y2guIFN0b3AgaHVudGluZyBhZnRlciBmaW5kaW5nIGFmdGVyIGZpbmRpbmcgYSB0YXJnZXQgdXNlci4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBDaGVja0FjY2VzcwoKICAgICAgICBTd2l0Y2guIENoZWNrIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byBmb3VuZCBtYWNoaW5lcy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNob3dBbGwKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gYWxsIHVzZXIgbG9jYXRpb24gcmVzdWx0cywgaS5lLiBJbnZva2UtVXNlclZpZXcgZnVuY3Rpb25hbGl0eS4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgU3RlYWx0aAoKICAgICAgICBTd2l0Y2guIE9ubHkgZW51bWVyYXRlIHNlc3Npb25zIGZyb20gY29ubm9ubHkgdXNlZCB0YXJnZXQgc2VydmVycy4KCiAgICAuUEFSQU1FVEVSIFN0ZWFsdGhTb3VyY2UKCiAgICAgICAgVGhlIHNvdXJjZSBvZiB0YXJnZXQgc2VydmVycyB0byB1c2UsICdERlMnIChkaXN0cmlidXRlZCBmaWxlIHNlcnZlcnMpLAogICAgICAgICdEQycgKGRvbWFpbiBjb250cm9sbGVycyksICdGaWxlJyAoZmlsZSBzZXJ2ZXJzKSwgb3IgJ0FsbCcKCiAgICAuUEFSQU1FVEVSIEZvcmVpZ25Vc2VycwoKICAgICAgICBTd2l0Y2guIE9ubHkgcmV0dXJuIHJlc3VsdHMgdGhhdCBhcmUgbm90IHBhcnQgb2Ygc2VhcmNoZWQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1DaGVja0FjY2VzcwoKICAgICAgICBGaW5kcyBtYWNoaW5lcyBvbiB0aGUgbG9jYWwgZG9tYWluIHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbnRvCiAgICAgICAgYW5kIGNoZWNrcyBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbCBhZG1pbmlzdHJhdG9yIGFjY2Vzcy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1Eb21haW4gJ3Rlc3RpbmcnCgogICAgICAgIEZpbmRzIG1hY2hpbmVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbnRvLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVRocmVhZHMgMjAKCiAgICAgICAgTXVsdGktdGhyZWFkZWQgdXNlciBodW50aW5nLCByZXBsYWNlcyBJbnZva2UtVXNlckh1bnRlclRocmVhZGVkLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVVzZXJGaWxlIHVzZXJzLnR4dCAtQ29tcHV0ZXJGaWxlIGhvc3RzLnR4dAoKICAgICAgICBGaW5kcyBtYWNoaW5lcyBpbiBob3N0cy50eHQgd2hlcmUgYW55IG1lbWJlcnMgb2YgdXNlcnMudHh0IGFyZSBsb2dnZWQgaW4KICAgICAgICBvciBoYXZlIHNlc3Npb25zLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLUdyb3VwTmFtZSAiUG93ZXIgVXNlcnMiIC1EZWxheSA2MAoKICAgICAgICBGaW5kIG1hY2hpbmVzIG9uIHRoZSBkb21haW4gd2hlcmUgbWVtYmVycyBvZiB0aGUgIlBvd2VyIFVzZXJzIiBncm91cHMgYXJlCiAgICAgICAgbG9nZ2VkIGludG8gd2l0aCBhIDYwIHNlY29uZCAoKy8tICouMykgcmFuZG9taXplZCBkZWxheSBiZXR3ZWVuCiAgICAgICAgdG91Y2hpbmcgZWFjaCBob3N0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLVVzZXJIdW50ZXIgLVRhcmdldFNlcnZlciBGSUxFU0VSVkVSCgogICAgICAgIFF1ZXJ5IEZJTEVTRVJWRVIgZm9yIHVzZXJlcyB3aG8gYXJlIGVmZmVjdGl2ZSBsb2NhbCBhZG1pbmlzdHJhdG9ycyB1c2luZwogICAgICAgIEdldC1OZXRMb2NhbEdyb3VwIC1SZWN1cnNlLCBhbmQgaHVudCBmb3IgdGhhdCB1c2VyIHNldCBvbiB0aGUgbmV0d29yay4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1TZWFyY2hGb3Jlc3QKCiAgICAgICAgRmluZCBhbGwgbWFjaGluZXMgaW4gdGhlIGN1cnJlbnQgZm9yZXN0IHdoZXJlIGRvbWFpbiBhZG1pbnMgYXJlIGxvZ2dlZCBpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Vc2VySHVudGVyIC1TdGVhbHRoCgogICAgICAgIEV4ZWN1dGVzIG9sZCBJbnZva2UtU3RlYWx0aFVzZXJIdW50ZXIgZnVuY3Rpb25hbGl0eSwgZW51bWVyYXRpbmcgY29tbW9ubHkKICAgICAgICB1c2VkIHNlcnZlcnMgYW5kIGNoZWNraW5nIGp1c3Qgc2Vzc2lvbnMgZm9yIGVhY2guCgogICAgLkxJTksKICAgICAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVW5jb25zdHJhaW5lZCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJ0RvbWFpbiBBZG1pbnMnLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRUYXJnZXRTZXJ2ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbGUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFkbWluQ291bnQsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFsbG93RGVsZWdhdGlvbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tBY2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0b3BPblN1Y2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vUGluZywKCiAgICAgICAgW1VJbnQzMl0KICAgICAgICAkRGVsYXkgPSAwLAoKICAgICAgICBbRG91YmxlXQogICAgICAgICRKaXR0ZXIgPSAuMywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTaG93QWxsLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0ZWFsdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJERlMiLCJEQyIsIkZpbGUiLCJBbGwiKV0KICAgICAgICAkU3RlYWx0aFNvdXJjZSA9IkFsbCIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZvcmVpZ25Vc2VycywKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzCiAgICApCgogICAgYmVnaW4gewoKICAgICAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydEZWJ1ZyddKSB7CiAgICAgICAgICAgICREZWJ1Z1ByZWZlcmVuY2UgPSAnQ29udGludWUnCiAgICAgICAgfQoKICAgICAgICAjIHJhbmRvbSBvYmplY3QgZm9yIGRlbGF5CiAgICAgICAgJFJhbmRObyA9IE5ldy1PYmplY3QgU3lzdGVtLlJhbmRvbQoKICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUnVubmluZyBJbnZva2UtVXNlckh1bnRlciB3aXRoIGRlbGF5IG9mICREZWxheSIKCiAgICAgICAgaWYoJERvbWFpbikgewogICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoJERvbWFpbikKICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRTZWFyY2hGb3Jlc3QpIHsKICAgICAgICAgICAgIyBnZXQgQUxMIHRoZSBkb21haW5zIGluIHRoZSBmb3Jlc3QgdG8gc2VhcmNoCiAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gR2V0LU5ldEZvcmVzdERvbWFpbiB8IEZvckVhY2gtT2JqZWN0IHsgJF8uTmFtZSB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAjIHVzZSB0aGUgbG9jYWwgZG9tYWluCiAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCggKEdldC1OZXREb21haW4pLm5hbWUgKQogICAgICAgIH0KCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAjCiAgICAgICAgIyBGaXJzdCB3ZSBidWlsZCB0aGUgaG9zdCB0YXJnZXQgc2V0CiAgICAgICAgIwogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7IAogICAgICAgICAgICBbQXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyBhIGhvc3QgbGlzdCwgcmVhZCB0aGUgdGFyZ2V0cyBpbiBhbmQgYWRkIHRoZW0gdG8gdGhlIHRhcmdldCBsaXN0CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU3RlYWx0aCkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU3RlYWx0aCBtb2RlISBFbnVtZXJhdGluZyBjb21tb25seSB1c2VkIHNlcnZlcnMiCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTdGVhbHRoIHNvdXJjZTogJFN0ZWFsdGhTb3VyY2UiCgogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIGlmICgoJFN0ZWFsdGhTb3VyY2UgLWVxICJGaWxlIikgLW9yICgkU3RlYWx0aFNvdXJjZSAtZXEgIkFsbCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgRmlsZSBTZXJ2ZXJzLi4uIgogICAgICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRGaWxlU2VydmVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoKCRTdGVhbHRoU291cmNlIC1lcSAiREZTIikgLW9yICgkU3RlYWx0aFNvdXJjZSAtZXEgIkFsbCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgREZTIFNlcnZlcnMuLi4iCiAgICAgICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LURGU3NoYXJlIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciB8IEZvckVhY2gtT2JqZWN0IHskXy5SZW1vdGVTZXJ2ZXJOYW1lfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoKCRTdGVhbHRoU291cmNlIC1lcSAiREMiKSAtb3IgKCRTdGVhbHRoU291cmNlIC1lcSAiQWxsIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBEb21haW4gQ29udHJvbGxlcnMuLi4iCiAgICAgICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgLUxEQVAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKCiAgICAgICAgICAgICAgICAgICAgJEFyZ3VtZW50cyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAnRG9tYWluQ29udHJvbGxlcicgPSAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgICAgICAnQURTcGF0aCcgPSAkQURTcGF0aAogICAgICAgICAgICAgICAgICAgICAgICAnRmlsdGVyJyA9ICRDb21wdXRlckZpbHRlcgogICAgICAgICAgICAgICAgICAgICAgICAnVW5jb25zdHJhaW5lZCcgPSAkVW5jb25zdHJhaW5lZAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgQEFyZ3VtZW50cwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuQ291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIE5vdyB3ZSBidWlsZCB0aGUgdXNlciB0YXJnZXQgc2V0CiAgICAgICAgIwogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgICAgICMgdXNlcnMgd2UncmUgZ29pbmcgdG8gYmUgc2VhcmNoaW5nIGZvcgogICAgICAgICRUYXJnZXRVc2VycyA9IEAoKQoKICAgICAgICAjIGdldCB0aGUgY3VycmVudCB1c2VyIHNvIHdlIGNhbiBpZ25vcmUgaXQgaW4gdGhlIHJlc3VsdHMKICAgICAgICAkQ3VycmVudFVzZXIgPSAoW0Vudmlyb25tZW50XTo6VXNlck5hbWUpLnRvTG93ZXIoKQoKICAgICAgICAjIGlmIHdlJ3JlIHNob3dpbmcgYWxsIHJlc3VsdHMsIHNraXAgdXNlcm5hbWUgZW51bWVyYXRpb24KICAgICAgICBpZigkU2hvd0FsbCAtb3IgJEZvcmVpZ25Vc2VycykgewogICAgICAgICAgICAkVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgJFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTWVtYmVyRG9tYWluJyAkTnVsbAogICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAnKicKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gQCgkVXNlcikKCiAgICAgICAgICAgIGlmKCRGb3JlaWduVXNlcnMpIHsKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgc2VhcmNoaW5nIGZvciB1c2VyIHJlc3VsdHMgbm90IGluIHRoZSBwcmltYXJ5IGRvbWFpbgogICAgICAgICAgICAgICAgJGtyYnRndE5hbWUgPSBDb252ZXJ0LUNhbm9uaWNhbHRvTlQ0IC1PYmplY3ROYW1lICJrcmJ0Z3RAJCgkRG9tYWluKSIKICAgICAgICAgICAgICAgICREb21haW5TaG9ydE5hbWUgPSAka3JidGd0TmFtZS5zcGxpdCgiXCIpWzBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgIyBpZiB3ZSB3YW50IHRvIGh1bnQgZm9yIHRoZSBlZmZlY3RpdmUgZG9tYWluIHVzZXJzIHdobyBjYW4gYWNjZXNzIGEgdGFyZ2V0IHNlcnZlcgogICAgICAgIGVsc2VpZigkVGFyZ2V0U2VydmVyKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlF1ZXJ5aW5nIHRhcmdldCBzZXJ2ZXIgJyRUYXJnZXRTZXJ2ZXInIGZvciBsb2NhbCB1c2VycyIKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LU5ldExvY2FsR3JvdXAgJFRhcmdldFNlcnZlciAtUmVjdXJzZSB8IFdoZXJlLU9iamVjdCB7KC1ub3QgJF8uSXNHcm91cCkgLWFuZCAkXy5Jc0RvbWFpbiB9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgJFVzZXIgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICgkXy5BY2NvdW50TmFtZSkuc3BsaXQoIi8iKVswXS50b0xvd2VyKCkgCiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAoJF8uQWNjb3VudE5hbWUpLnNwbGl0KCIvIilbMV0udG9Mb3dlcigpIAogICAgICAgICAgICAgICAgJFVzZXIKICAgICAgICAgICAgfSAgfCBXaGVyZS1PYmplY3QgeyRffQogICAgICAgIH0KICAgICAgICAjIGlmIHdlIGdldCBhIHNwZWNpZmljIHVzZXJuYW1lLCBvbmx5IHVzZSB0aGF0CiAgICAgICAgZWxzZWlmKCRVc2VyTmFtZSkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVXNpbmcgdGFyZ2V0IHVzZXIgJyRVc2VyTmFtZScuLi4iCiAgICAgICAgICAgICRVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICRUYXJnZXREb21haW5zWzBdCiAgICAgICAgICAgICRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlck5hbWUnICRVc2VyTmFtZS5Ub0xvd2VyKCkKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gQCgkVXNlcikKICAgICAgICB9CiAgICAgICAgIyByZWFkIGluIGEgdGFyZ2V0IHVzZXIgbGlzdCBpZiB3ZSBoYXZlIG9uZQogICAgICAgIGVsc2VpZigkVXNlckZpbGUpIHsKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LUNvbnRlbnQgLVBhdGggJFVzZXJGaWxlIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgJFVzZXIgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJEb21haW4nICRUYXJnZXREb21haW5zWzBdCiAgICAgICAgICAgICAgICAkVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdNZW1iZXJOYW1lJyAkXwogICAgICAgICAgICAgICAgJFVzZXIKICAgICAgICAgICAgfSAgfCBXaGVyZS1PYmplY3QgeyRffQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJFVzZXJBRFNwYXRoIC1vciAkVXNlckZpbHRlciAtb3IgJEFkbWluQ291bnQpIHsKICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewoKICAgICAgICAgICAgICAgICRBcmd1bWVudHMgPSBAewogICAgICAgICAgICAgICAgICAgICdEb21haW4nID0gJERvbWFpbgogICAgICAgICAgICAgICAgICAgICdEb21haW5Db250cm9sbGVyJyA9ICREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgICAgICAgICAgJ0FEU3BhdGgnID0gJFVzZXJBRFNwYXRoCiAgICAgICAgICAgICAgICAgICAgJ0ZpbHRlcicgPSAkVXNlckZpbHRlcgogICAgICAgICAgICAgICAgICAgICdBZG1pbkNvdW50JyA9ICRBZG1pbkNvdW50CiAgICAgICAgICAgICAgICAgICAgJ0FsbG93RGVsZWdhdGlvbicgPSAkQWxsb3dEZWxlZ2F0aW9uCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0VXNlciBAQXJndW1lbnRzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICRVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlckRvbWFpbicgJERvbWFpbgogICAgICAgICAgICAgICAgICAgICRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ01lbWJlck5hbWUnICRfLnNhbWFjY291bnRuYW1lCiAgICAgICAgICAgICAgICAgICAgJFVzZXIKICAgICAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KCiAgICAgICAgICAgIH0gICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgdXNlcnMgb2YgZ3JvdXAgJyRHcm91cE5hbWUnIgogICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzICs9IEdldC1OZXRHcm91cE1lbWJlciAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgoICgtbm90ICRTaG93QWxsKSAtYW5kICgtbm90ICRGb3JlaWduVXNlcnMpICkgLWFuZCAoKCEkVGFyZ2V0VXNlcnMpIC1vciAoJFRhcmdldFVzZXJzLkNvdW50IC1lcSAwKSkpIHsKICAgICAgICAgICAgdGhyb3cgIlshXSBObyB1c2VycyBmb3VuZCB0byBzZWFyY2ggZm9yISIKICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBhIHNlcnZlcgogICAgICAgICRIb3N0RW51bUJsb2NrID0gewogICAgICAgICAgICBwYXJhbSgkQ29tcHV0ZXJOYW1lLCAkUGluZywgJFRhcmdldFVzZXJzLCAkQ3VycmVudFVzZXIsICRTdGVhbHRoLCAkRG9tYWluU2hvcnROYW1lKQoKICAgICAgICAgICAgIyBvcHRpb25hbGx5IGNoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgdXAgZmlyc3QKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICBpZighJERvbWFpblNob3J0TmFtZSkgewogICAgICAgICAgICAgICAgICAgICMgaWYgd2UncmUgbm90IHNlYXJjaGluZyBmb3IgZm9yZWlnbiB1c2VycywgY2hlY2sgc2Vzc2lvbiBpbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgICAgICRTZXNzaW9ucyA9IEdldC1OZXRTZXNzaW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgIEZvckVhY2ggKCRTZXNzaW9uIGluICRTZXNzaW9ucykgewogICAgICAgICAgICAgICAgICAgICAgICAkVXNlck5hbWUgPSAkU2Vzc2lvbi5zZXNpMTBfdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJENOYW1lID0gJFNlc3Npb24uc2VzaTEwX2NuYW1lCgogICAgICAgICAgICAgICAgICAgICAgICBpZigkQ05hbWUgLWFuZCAkQ05hbWUuU3RhcnRzV2l0aCgiXFwiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJENOYW1lID0gJENOYW1lLlRyaW1TdGFydCgiXCIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICMgbWFrZSBzdXJlIHdlIGhhdmUgYSByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCgkVXNlck5hbWUpIC1hbmQgKCRVc2VyTmFtZS50cmltKCkgLW5lICcnKSAtYW5kICghKCRVc2VyTmFtZSAtbWF0Y2ggJEN1cnJlbnRVc2VyKSkpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgfCBXaGVyZS1PYmplY3QgeyRVc2VyTmFtZSAtbGlrZSAkXy5NZW1iZXJOYW1lfSB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJElQID0gR2V0LUlQQWRkcmVzcyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckRvbWFpbicgJF8uTWVtYmVyRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgJFVzZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdDb21wdXRlck5hbWUnICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0lQJyAkSVAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1Nlc3Npb25Gcm9tJyAkQ05hbWUKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzZWUgaWYgd2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIHdlIGhhdmUgbG9jYWwgYWRtaW4gYWNjZXNzIG9uIHRoaXMgbWFjaGluZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkQ2hlY2tBY2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEFkbWluID0gSW52b2tlLUNoZWNrTG9jYWxBZG1pbkFjY2VzcyAtQ29tcHV0ZXJOYW1lICRDTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ0xvY2FsQWRtaW4nICRBZG1pbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdMb2NhbEFkbWluJyAkTnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZighJFN0ZWFsdGgpIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIG5vdCAnc3RlYWx0aHknLCBlbnVtZXJhdGUgbG9nZ2Vkb24gdXNlcnMgYXMgd2VsbAogICAgICAgICAgICAgICAgICAgICRMb2dnZWRPbiA9IEdldC1OZXRMb2dnZWRvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkVXNlciBpbiAkTG9nZ2VkT24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJOYW1lID0gJFVzZXIud2t1aTFfdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgIyBUT0RPOiB0cmFuc2xhdGUgZG9tYWluIHRvIGF1dGhvcmF0YXRpdmUgbmFtZQogICAgICAgICAgICAgICAgICAgICAgICAjICAgdGhlbiBtYXRjaCBkb21haW4gbmFtZSA/CiAgICAgICAgICAgICAgICAgICAgICAgICRVc2VyRG9tYWluID0gJFVzZXIud2t1aTFfbG9nb25fZG9tYWluCgogICAgICAgICAgICAgICAgICAgICAgICAjIG1ha2Ugc3VyZSB3ZXQgaGF2ZSBhIHJlc3VsdAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCRVc2VyTmFtZSkgLWFuZCAoJFVzZXJOYW1lLnRyaW0oKSAtbmUgJycpKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzIHwgV2hlcmUtT2JqZWN0IHskVXNlck5hbWUgLWxpa2UgJF8uTWVtYmVyTmFtZX0gfCBGb3JFYWNoLU9iamVjdCB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRQcm9jZWVkID0gJFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkRG9tYWluU2hvcnROYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkRG9tYWluU2hvcnROYW1lLlRvTG93ZXIoKSAtbmUgJFVzZXJEb21haW4uVG9Mb3dlcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VlZCA9ICRUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VlZCA9ICRGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRQcm9jZWVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRJUCA9IEdldC1JUEFkZHJlc3MgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckRvbWFpbicgJFVzZXJEb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdVc2VyTmFtZScgJFVzZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnQ29tcHV0ZXJOYW1lJyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnSVAnICRJUAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1Nlc3Npb25Gcm9tJyAkTnVsbAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzZWUgaWYgd2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIHdlIGhhdmUgbG9jYWwgYWRtaW4gYWNjZXNzIG9uIHRoaXMgbWFjaGluZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJENoZWNrQWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWRtaW4gPSBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEZvdW5kVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdMb2NhbEFkbWluJyAkQWRtaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRGb3VuZFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnTG9jYWxBZG1pbicgJE51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRm91bmRVc2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYoJFRocmVhZHMpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgdGhyZWFkaW5nIHdpdGggdGhyZWFkcyA9ICRUaHJlYWRzIgoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyB0aHJlYWRpbmcsIGtpY2sgb2ZmIHRoZSBzY3JpcHQgYmxvY2sgd2l0aCBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbgogICAgICAgICAgICAkU2NyaXB0UGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICdQaW5nJyA9ICQoLW5vdCAkTm9QaW5nKQogICAgICAgICAgICAgICAgJ1RhcmdldFVzZXJzJyA9ICRUYXJnZXRVc2VycwogICAgICAgICAgICAgICAgJ0N1cnJlbnRVc2VyJyA9ICRDdXJyZW50VXNlcgogICAgICAgICAgICAgICAgJ1N0ZWFsdGgnID0gJFN0ZWFsdGgKICAgICAgICAgICAgICAgICdEb21haW5TaG9ydE5hbWUnID0gJERvbWFpblNob3J0TmFtZQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMgCiAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcwogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1uZSAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgRm9yRWFjaCAoJENvbXB1dGVyIGluICRDb21wdXRlck5hbWUpIHsKCiAgICAgICAgICAgICAgICAkQ291bnRlciA9ICRDb3VudGVyICsgMQoKICAgICAgICAgICAgICAgICMgc2xlZXAgZm9yIG91ciBzZW1pLXJhbmRvbWl6ZWQgaW50ZXJ2YWwKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSYW5kTm8uTmV4dCgoMS0kSml0dGVyKSokRGVsYXksICgxKyRKaXR0ZXIpKiREZWxheSkKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCiAgICAgICAgICAgICAgICAkUmVzdWx0ID0gSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJENvbXB1dGVyLCAkRmFsc2UsICRUYXJnZXRVc2VycywgJEN1cnJlbnRVc2VyLCAkU3RlYWx0aCwgJERvbWFpblNob3J0TmFtZQogICAgICAgICAgICAgICAgJFJlc3VsdAoKICAgICAgICAgICAgICAgIGlmKCRSZXN1bHQgLWFuZCAkU3RvcE9uU3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBUYXJnZXQgdXNlciBmb3VuZCwgcmV0dXJuaW5nIGVhcmx5IgogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1TdGVhbHRoVXNlckh1bnRlciB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSA9ICdEb21haW4gQWRtaW5zJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVGFyZ2V0U2VydmVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlckFEU3BhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJGaWxlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRDaGVja0FjY2VzcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU3RvcE9uU3VjY2VzcywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTm9QaW5nLAoKICAgICAgICBbVUludDMyXQogICAgICAgICREZWxheSA9IDAsCgogICAgICAgIFtEb3VibGVdCiAgICAgICAgJEppdHRlciA9IC4zLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNob3dBbGwsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIkRGUyIsIkRDIiwiRmlsZSIsIkFsbCIpXQogICAgICAgICRTdGVhbHRoU291cmNlID0iQWxsIgogICAgKQogICAgIyBraWNrIG9mZiBJbnZva2UtVXNlckh1bnRlciB3aXRoIHN0ZWFsdGggb3B0aW9ucwogICAgSW52b2tlLVVzZXJIdW50ZXIgLVN0ZWFsdGggQFBTQm91bmRQYXJhbWV0ZXJzCn0KCgpmdW5jdGlvbiBJbnZva2UtUHJvY2Vzc0h1bnRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcnkgdGhlIHByb2Nlc3MgbGlzdHMgb2YgcmVtb3RlIG1hY2hpbmVzLCBzZWFyY2hpbmcgZm9yCiAgICAgICAgcHJvY2Vzc2VzIHdpdGggYSBzcGVjaWZpYyBuYW1lIG9yIG93bmVkIGJ5IGEgc3BlY2lmaWMgdXNlci4KICAgICAgICBUaGFua3MgdG8gQHBhdWxicmFuZGF1IGZvciB0aGUgYXBwcm9hY2ggaWRlYS4KICAgICAgICAKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgUHJvY2Vzc05hbWUKCiAgICAgICAgVGhlIG5hbWUgb2YgdGhlIHByb2Nlc3MgdG8gaHVudCwgb3IgYSBjb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBuYW1lcy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBHcm91cCBuYW1lIHRvIHF1ZXJ5IGZvciB0YXJnZXQgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBUYXJnZXRTZXJ2ZXIKCiAgICAgICAgSHVudCBmb3IgdXNlcnMgd2hvIGFyZSBlZmZlY3RpdmUgbG9jYWwgYWRtaW5zIG9uIGEgdGFyZ2V0IHNlcnZlci4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFNwZWNpZmljIHVzZXJuYW1lIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBVc2VyRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlIGZvciB1c2VyIGVudW1lcmF0aW9uLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBVc2VyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIHVzZXJzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbGUKCiAgICAgICAgRmlsZSBvZiB1c2VybmFtZXMgdG8gc2VhcmNoIGZvci4KCiAgICAuUEFSQU1FVEVSIFJlbW90ZVVzZXJOYW1lCgogICAgICAgIFRoZSAiZG9tYWluXHVzZXJuYW1lIiB0byB1c2UgZm9yIHRoZSBXTUkgY2FsbCBvbiBhIHJlbW90ZSBzeXN0ZW0uCiAgICAgICAgSWYgc3VwcGxpZWQsICdSZW1vdGVQYXNzd29yZCcgbXVzdCBiZSBzdXBwbGllZCBhcyB3ZWxsLgoKICAgIC5QQVJBTUVURVIgUmVtb3RlUGFzc3dvcmQKCiAgICAgICAgVGhlIHBhc3N3b3JkIHRvIHVzZSBmb3IgdGhlIFdNSSBjYWxsIG9uIGEgcmVtb3RlIHN5c3RlbS4KCiAgICAuUEFSQU1FVEVSIFN0b3BPblN1Y2Nlc3MKCiAgICAgICAgU3dpdGNoLiBTdG9wIGh1bnRpbmcgYWZ0ZXIgZmluZGluZyBhZnRlciBmaW5kaW5nIGEgdGFyZ2V0IHVzZXIvcHJvY2Vzcy4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBTd2l0Y2guIERvbid0IHBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNob3dBbGwKCiAgICAgICAgU3dpdGNoLiBSZXR1cm4gYWxsIHVzZXIgbG9jYXRpb24gcmVzdWx0cy4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1Qcm9jZXNzSHVudGVyIC1Eb21haW4gJ3Rlc3RpbmcnCiAgICAgICAgCiAgICAgICAgRmluZHMgbWFjaGluZXMgb24gdGhlICd0ZXN0aW5nJyBkb21haW4gd2hlcmUgZG9tYWluIGFkbWlucyBoYXZlIGEKICAgICAgICBydW5uaW5nIHByb2Nlc3MuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtUHJvY2Vzc0h1bnRlciAtVGhyZWFkcyAyMAoKICAgICAgICBNdWx0aS10aHJlYWRlZCBwcm9jZXNzIGh1bnRpbmcsIHJlcGxhY2VzIEludm9rZS1Qcm9jZXNzSHVudGVyVGhyZWFkZWQuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtUHJvY2Vzc0h1bnRlciAtVXNlckZpbGUgdXNlcnMudHh0IC1Db21wdXRlckZpbGUgaG9zdHMudHh0CiAgICAgICAgCiAgICAgICAgRmluZHMgbWFjaGluZXMgaW4gaG9zdHMudHh0IHdoZXJlIGFueSBtZW1iZXJzIG9mIHVzZXJzLnR4dCBoYXZlIHJ1bm5pbmcKICAgICAgICBwcm9jZXNzZXMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtUHJvY2Vzc0h1bnRlciAtR3JvdXBOYW1lICJQb3dlciBVc2VycyIgLURlbGF5IDYwCiAgICAgICAgCiAgICAgICAgRmluZCBtYWNoaW5lcyBvbiB0aGUgZG9tYWluIHdoZXJlIG1lbWJlcnMgb2YgdGhlICJQb3dlciBVc2VycyIgZ3JvdXBzIGhhdmUKICAgICAgICBydW5uaW5nIHByb2Nlc3NlcyB3aXRoIGEgNjAgc2Vjb25kICgrLy0gKi4zKSByYW5kb21pemVkIGRlbGF5IGJldHdlZW4KICAgICAgICB0b3VjaGluZyBlYWNoIGhvc3QuCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL2Jsb2cuaGFybWoweS5uZXQKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFByb2Nlc3NOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUgPSAnRG9tYWluIEFkbWlucycsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFNlcnZlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJBRFNwYXRoLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUmVtb3RlVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFJlbW90ZVBhc3N3b3JkLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTdG9wT25TdWNjZXNzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb1BpbmcsCgogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMCwKCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2hvd0FsbCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2VhcmNoRm9yZXN0LAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFRocmVhZHMKICAgICkKCiAgICBiZWdpbiB7CgogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CgogICAgICAgICMgcmFuZG9tIG9iamVjdCBmb3IgZGVsYXkKICAgICAgICAkUmFuZE5vID0gTmV3LU9iamVjdCBTeXN0ZW0uUmFuZG9tCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBSdW5uaW5nIEludm9rZS1Qcm9jZXNzSHVudGVyIHdpdGggZGVsYXkgb2YgJERlbGF5IgoKICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCgkRG9tYWluKQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAjIGdldCBBTEwgdGhlIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCB0byBzZWFyY2gKICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbikubmFtZSApCiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIEZpcnN0IHdlIGJ1aWxkIHRoZSBob3N0IHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgaWYoISRDb21wdXRlck5hbWUpIHsgCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgICAgICBpZigkQ29tcHV0ZXJGaWxlKSB7CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgW2FycmF5XSRDb21wdXRlck5hbWUgPSBAKCkKICAgICAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldENvbXB1dGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtRmlsdGVyICRDb21wdXRlckZpbHRlciAtQURTcGF0aCAkQ29tcHV0ZXJBRFNwYXRoCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgcmVtb3ZlIGFueSBudWxsIHRhcmdldCBob3N0cywgdW5pcXVpZnkgdGhlIGxpc3QgYW5kIHNodWZmbGUgaXQKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRDb21wdXRlck5hbWUgfCBXaGVyZS1PYmplY3QgeyAkXyB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZSB8IFNvcnQtT2JqZWN0IHsgR2V0LVJhbmRvbSB9CiAgICAgICAgICAgIGlmKCQoJENvbXB1dGVyTmFtZS5Db3VudCkgLWVxIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJObyBob3N0cyBmb3VuZCEiCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAgICAgIwogICAgICAgICMgTm93IHdlIGJ1aWxkIHRoZSB1c2VyIHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgaWYoISRQcm9jZXNzTmFtZSkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJObyBwcm9jZXNzIG5hbWUgc3BlY2lmaWVkLCBidWlsZGluZyBhIHRhcmdldCB1c2VyIHNldCIKCiAgICAgICAgICAgICMgdXNlcnMgd2UncmUgZ29pbmcgdG8gYmUgc2VhcmNoaW5nIGZvcgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCkKCiAgICAgICAgICAgICMgaWYgd2Ugd2FudCB0byBodW50IGZvciB0aGUgZWZmZWN0aXZlIGRvbWFpbiB1c2VycyB3aG8gY2FuIGFjY2VzcyBhIHRhcmdldCBzZXJ2ZXIKICAgICAgICAgICAgaWYoJFRhcmdldFNlcnZlcikgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUXVlcnlpbmcgdGFyZ2V0IHNlcnZlciAnJFRhcmdldFNlcnZlcicgZm9yIGxvY2FsIHVzZXJzIgogICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LU5ldExvY2FsR3JvdXAgJFRhcmdldFNlcnZlciAtUmVjdXJzZSB8IFdoZXJlLU9iamVjdCB7KC1ub3QgJF8uSXNHcm91cCkgLWFuZCAkXy5Jc0RvbWFpbiB9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICgkXy5BY2NvdW50TmFtZSkuc3BsaXQoIi8iKVsxXS50b0xvd2VyKCkKICAgICAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICAgICAgfQogICAgICAgICAgICAjIGlmIHdlIGdldCBhIHNwZWNpZmljIHVzZXJuYW1lLCBvbmx5IHVzZSB0aGF0CiAgICAgICAgICAgIGVsc2VpZigkVXNlck5hbWUpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBVc2luZyB0YXJnZXQgdXNlciAnJFVzZXJOYW1lJy4uLiIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyA9IEAoICRVc2VyTmFtZS5Ub0xvd2VyKCkgKQogICAgICAgICAgICB9CiAgICAgICAgICAgICMgcmVhZCBpbiBhIHRhcmdldCB1c2VyIGxpc3QgaWYgd2UgaGF2ZSBvbmUKICAgICAgICAgICAgZWxzZWlmKCRVc2VyRmlsZSkgewogICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LUNvbnRlbnQgLVBhdGggJFVzZXJGaWxlIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYoJFVzZXJBRFNwYXRoIC1vciAkVXNlckZpbHRlcikgewogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgdXNlcnMiCiAgICAgICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzICs9IEdldC1OZXRVc2VyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtQURTcGF0aCAkVXNlckFEU3BhdGggLUZpbHRlciAkVXNlckZpbHRlciB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgJF8uc2FtYWNjb3VudG5hbWUKICAgICAgICAgICAgICAgICAgICB9ICB8IFdoZXJlLU9iamVjdCB7JF99CiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyBvZiBncm91cCAnJEdyb3VwTmFtZSciCiAgICAgICAgICAgICAgICAgICAgJFRhcmdldFVzZXJzICs9IEdldC1OZXRHcm91cE1lbWJlciAtR3JvdXBOYW1lICRHcm91cE5hbWUgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLk1lbWJlck5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoLW5vdCAkU2hvd0FsbCkgLWFuZCAoKCEkVGFyZ2V0VXNlcnMpIC1vciAoJFRhcmdldFVzZXJzLkNvdW50IC1lcSAwKSkpIHsKICAgICAgICAgICAgICAgIHRocm93ICJbIV0gTm8gdXNlcnMgZm91bmQgdG8gc2VhcmNoIGZvciEiCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBhIHNlcnZlcgogICAgICAgICRIb3N0RW51bUJsb2NrID0gewogICAgICAgICAgICBwYXJhbSgkQ29tcHV0ZXJOYW1lLCAkUGluZywgJFByb2Nlc3NOYW1lLCAkVGFyZ2V0VXNlcnMsICRSZW1vdGVVc2VyTmFtZSwgJFJlbW90ZVBhc3N3b3JkKQoKICAgICAgICAgICAgIyBvcHRpb25hbGx5IGNoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgdXAgZmlyc3QKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAjIHRyeSB0byBlbnVtZXJhdGUgYWxsIGFjdGl2ZSBwcm9jZXNzZXMgb24gdGhlIHJlbW90ZSBob3N0CiAgICAgICAgICAgICAgICAjIGFuZCBzZWFyY2ggZm9yIGEgc3BlY2lmaWMgcHJvY2VzcyBuYW1lCiAgICAgICAgICAgICAgICBpZigkUmVtb3RlVXNlck5hbWUgLWFuZCAkUmVtb3RlUGFzc3dvcmQpIHsKICAgICAgICAgICAgICAgICAgICAkUHJvY2Vzc2VzID0gR2V0LU5ldFByb2Nlc3MgLVJlbW90ZVVzZXJOYW1lICRSZW1vdGVVc2VyTmFtZSAtUmVtb3RlUGFzc3dvcmQgJFJlbW90ZVBhc3N3b3JkIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFByb2Nlc3NlcyA9IEdldC1OZXRQcm9jZXNzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRQcm9jZXNzIGluICRQcm9jZXNzZXMpIHsKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGh1bnRpbmcgZm9yIGEgcHJvY2VzcyBuYW1lIG9yIGNvbW1hLXNlcGFyYXRlZCBuYW1lcwogICAgICAgICAgICAgICAgICAgIGlmKCRQcm9jZXNzTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2Vzc05hbWUuc3BsaXQoIiwiKSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkUHJvY2Vzcy5Qcm9jZXNzTmFtZSAtbWF0Y2ggJF8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICMgaWYgdGhlIHNlc3Npb24gdXNlciBpcyBpbiB0aGUgdGFyZ2V0IGxpc3QsIGRpc3BsYXkgc29tZSBvdXRwdXQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRUYXJnZXRVc2VycyAtY29udGFpbnMgJFByb2Nlc3MuVXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdQcm9jZXNzTmFtZScgPSAkUHJvY2Vzc05hbWUKICAgICAgICAgICAgICAgICdUYXJnZXRVc2VycycgPSAkVGFyZ2V0VXNlcnMKICAgICAgICAgICAgICAgICdSZW1vdGVVc2VyTmFtZScgPSAkUmVtb3RlVXNlck5hbWUKICAgICAgICAgICAgICAgICdSZW1vdGVQYXNzd29yZCcgPSAkUmVtb3RlUGFzc3dvcmQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBraWNrIG9mZiB0aGUgdGhyZWFkZWQgc2NyaXB0IGJsb2NrICsgYXJndW1lbnRzIAogICAgICAgICAgICBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1TY3JpcHRQYXJhbWV0ZXJzICRTY3JpcHRQYXJhbXMKICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigtbm90ICROb1BpbmcgLWFuZCAoJENvbXB1dGVyTmFtZS5jb3VudCAtbmUgMSkpIHsKICAgICAgICAgICAgICAgICMgcGluZyBhbGwgaG9zdHMgaW4gcGFyYWxsZWwKICAgICAgICAgICAgICAgICRQaW5nID0ge3BhcmFtKCRDb21wdXRlck5hbWUpIGlmKFRlc3QtQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUNvdW50IDEgLVF1aWV0IC1FcnJvckFjdGlvbiBTdG9wKXskQ29tcHV0ZXJOYW1lfX0KICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtTm9JbXBvcnRzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJFBpbmcgLVRocmVhZHMgMTAwCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBUb3RhbCBudW1iZXIgb2YgYWN0aXZlIGhvc3RzOiAkKCRDb21wdXRlck5hbWUuY291bnQpIgogICAgICAgICAgICAkQ291bnRlciA9IDAKCiAgICAgICAgICAgIEZvckVhY2ggKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJOYW1lKSB7CgogICAgICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKCiAgICAgICAgICAgICAgICAjIHNsZWVwIGZvciBvdXIgc2VtaS1yYW5kb21pemVkIGludGVydmFsCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkQ29tcHV0ZXIgKCRDb3VudGVyIG9mICQoJENvbXB1dGVyTmFtZS5jb3VudCkpIgogICAgICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtQXJndW1lbnRMaXN0ICRDb21wdXRlciwgJEZhbHNlLCAkUHJvY2Vzc05hbWUsICRUYXJnZXRVc2VycywgJFJlbW90ZVVzZXJOYW1lLCAkUmVtb3RlUGFzc3dvcmQKICAgICAgICAgICAgICAgICRSZXN1bHQKCiAgICAgICAgICAgICAgICBpZigkUmVzdWx0IC1hbmQgJFN0b3BPblN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVGFyZ2V0IHVzZXIvcHJvY2VzcyBmb3VuZCwgcmV0dXJuaW5nIGVhcmx5IgogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1FdmVudEh1bnRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUXVlcmllcyBhbGwgZG9tYWluIGNvbnRyb2xsZXJzIG9uIHRoZSBuZXR3b3JrIGZvciBhY2NvdW50CiAgICAgICAgbG9nb24gZXZlbnRzIChJRCA0NjI0KSBhbmQgVEdUIHJlcXVlc3QgZXZlbnRzIChJRCA0NzY4KSwKICAgICAgICBzZWFyY2hpbmcgZm9yIHRhcmdldCB1c2Vycy4KCiAgICAgICAgTm90ZTogRG9tYWluIEFkbWluIChvciBlcXVpdikgcmlnaHRzIGFyZSBuZWVkZWQgdG8gcXVlcnkKICAgICAgICB0aGlzIGluZm9ybWF0aW9uIGZyb20gdGhlIERDcy4KCiAgICAgICAgQXV0aG9yOiBAc2l4ZHViLCBAaGFybWoweQogICAgICAgIExpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIEhvc3QgYXJyYXkgdG8gZW51bWVyYXRlLCBwYXNzYWJsZSBvbiB0aGUgcGlwZWxpbmUuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbGUKCiAgICAgICAgRmlsZSBvZiBob3N0bmFtZXMvSVBzIHRvIHNlYXJjaC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsdGVyCgogICAgICAgIEhvc3QgZmlsdGVyIG5hbWUgdG8gcXVlcnkgQUQgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoIGZvciBob3N0cywgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEdyb3VwTmFtZQoKICAgICAgICBHcm91cCBuYW1lIHRvIHF1ZXJ5IGZvciB0YXJnZXQgdXNlcnMuCgogICAgLlBBUkFNRVRFUiBUYXJnZXRTZXJ2ZXIKCiAgICAgICAgSHVudCBmb3IgdXNlcnMgd2hvIGFyZSBlZmZlY3RpdmUgbG9jYWwgYWRtaW5zIG9uIGEgdGFyZ2V0IHNlcnZlci4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFNwZWNpZmljIHVzZXJuYW1lIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBVc2VyRmlsdGVyCgogICAgICAgIEEgY3VzdG9taXplZCBsZGFwIGZpbHRlciBzdHJpbmcgdG8gdXNlIGZvciB1c2VyIGVudW1lcmF0aW9uLCBlLmcuICIoZGVzY3JpcHRpb249KmFkbWluKikiCgogICAgLlBBUkFNRVRFUiBVc2VyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIHVzZXJzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVXNlckZpbGUKCiAgICAgICAgRmlsZSBvZiB1c2VybmFtZXMgdG8gc2VhcmNoIGZvci4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBEb24ndCBwaW5nIGVhY2ggaG9zdCB0byBlbnN1cmUgaXQncyB1cCBiZWZvcmUgZW51bWVyYXRpbmcuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIGZvciBxdWVyeSBmb3IgbWFjaGluZXMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaERheXMKCiAgICAgICAgTnVtYmVyIG9mIGRheXMgYmFjayB0byBzZWFyY2ggbG9ncyBmb3IuIERlZmF1bHQgMy4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1FdmVudEh1bnRlcgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9nLmhhcm1qMHkubmV0CiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0cycpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbQWxpYXMoJ0hvc3RMaXN0JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWxlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJBRFNwYXRoLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUgPSAnRG9tYWluIEFkbWlucycsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFNlcnZlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJBRFNwYXRoLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbSW50MzJdCiAgICAgICAgJFNlYXJjaERheXMgPSAzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkVGhyZWFkcwogICAgKQoKICAgIGJlZ2luIHsKCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLUV2ZW50SHVudGVyIgoKICAgICAgICBpZigkRG9tYWluKSB7CiAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCgkRG9tYWluKQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJFNlYXJjaEZvcmVzdCkgewogICAgICAgICAgICAjIGdldCBBTEwgdGhlIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCB0byBzZWFyY2gKICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCAoR2V0LU5ldERvbWFpbikubmFtZSApCiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICMKICAgICAgICAjIEZpcnN0IHdlIGJ1aWxkIHRoZSBob3N0IHRhcmdldCBzZXQKICAgICAgICAjCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgaWYoISRDb21wdXRlck5hbWUpIHsgCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgICAgICBpZigkQ29tcHV0ZXJGaWxlKSB7CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkQ29tcHV0ZXJGaWx0ZXIgLW9yICRDb21wdXRlckFEU3BhdGgpIHsKICAgICAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUZpbHRlciAkQ29tcHV0ZXJGaWx0ZXIgLUFEU3BhdGggJENvbXB1dGVyQURTcGF0aAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgIyBpZiBhIGNvbXB1dGVyIHNwZWNpZmllciBpc24ndCBnaXZlbiwgdHJ5IHRvIGVudW1lcmF0ZSBhbGwgZG9tYWluIGNvbnRyb2xsZXJzCiAgICAgICAgICAgICAgICBbYXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgZG9tYWluIGNvbnRyb2xsZXJzIgogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIgLUxEQVAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5kbnNob3N0bmFtZX0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyByZW1vdmUgYW55IG51bGwgdGFyZ2V0IGhvc3RzLCB1bmlxdWlmeSB0aGUgbGlzdCBhbmQgc2h1ZmZsZSBpdAogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7ICRfIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlIHwgU29ydC1PYmplY3QgeyBHZXQtUmFuZG9tIH0KICAgICAgICAgICAgaWYoJCgkQ29tcHV0ZXJOYW1lLkNvdW50KSAtZXEgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIk5vIGhvc3RzIGZvdW5kISIKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAjCiAgICAgICAgIyBOb3cgd2UgYnVpbGQgdGhlIHVzZXIgdGFyZ2V0IHNldAogICAgICAgICMKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICAgICAjIHVzZXJzIHdlJ3JlIGdvaW5nIHRvIGJlIHNlYXJjaGluZyBmb3IKICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCkKCiAgICAgICAgIyBpZiB3ZSB3YW50IHRvIGh1bnQgZm9yIHRoZSBlZmZlY3RpdmUgZG9tYWluIHVzZXJzIHdobyBjYW4gYWNjZXNzIGEgdGFyZ2V0IHNlcnZlcgogICAgICAgIGlmKCRUYXJnZXRTZXJ2ZXIpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUXVlcnlpbmcgdGFyZ2V0IHNlcnZlciAnJFRhcmdldFNlcnZlcicgZm9yIGxvY2FsIHVzZXJzIgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBHZXQtTmV0TG9jYWxHcm91cCAkVGFyZ2V0U2VydmVyIC1SZWN1cnNlIHwgV2hlcmUtT2JqZWN0IHsoLW5vdCAkXy5Jc0dyb3VwKSAtYW5kICRfLklzRG9tYWluIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAoJF8uQWNjb3VudE5hbWUpLnNwbGl0KCIvIilbMV0udG9Mb3dlcigpCiAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICB9CiAgICAgICAgIyBpZiB3ZSBnZXQgYSBzcGVjaWZpYyB1c2VybmFtZSwgb25seSB1c2UgdGhhdAogICAgICAgIGVsc2VpZigkVXNlck5hbWUpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFVzaW5nIHRhcmdldCB1c2VyICckVXNlck5hbWUnLi4uIgogICAgICAgICAgICAkVGFyZ2V0VXNlcnMgPSBAKCAkVXNlck5hbWUuVG9Mb3dlcigpICkKICAgICAgICB9CiAgICAgICAgIyByZWFkIGluIGEgdGFyZ2V0IHVzZXIgbGlzdCBpZiB3ZSBoYXZlIG9uZQogICAgICAgIGVsc2VpZigkVXNlckZpbGUpIHsKICAgICAgICAgICAgJFRhcmdldFVzZXJzID0gR2V0LUNvbnRlbnQgLVBhdGggJFVzZXJGaWxlIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCRVc2VyQURTcGF0aCAtb3IgJFVzZXJGaWx0ZXIpIHsKICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyIKICAgICAgICAgICAgICAgICRUYXJnZXRVc2VycyArPSBHZXQtTmV0VXNlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUFEU3BhdGggJFVzZXJBRFNwYXRoIC1GaWx0ZXIgJFVzZXJGaWx0ZXIgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJF8uc2FtYWNjb3VudG5hbWUKICAgICAgICAgICAgICAgIH0gIHwgV2hlcmUtT2JqZWN0IHskX30KICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciB1c2VycyBvZiBncm91cCAnJEdyb3VwTmFtZSciCiAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgKz0gR2V0LU5ldEdyb3VwTWVtYmVyIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgfCBGb3JlYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJF8uTWVtYmVyTmFtZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoKCghJFRhcmdldFVzZXJzKSAtb3IgKCRUYXJnZXRVc2Vycy5Db3VudCAtZXEgMCkpKSB7CiAgICAgICAgICAgIHRocm93ICJbIV0gTm8gdXNlcnMgZm91bmQgdG8gc2VhcmNoIGZvciEiCiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRUYXJnZXRVc2VycywgJFNlYXJjaERheXMpCgogICAgICAgICAgICAjIG9wdGlvbmFsbHkgY2hlY2sgaWYgdGhlIHNlcnZlciBpcyB1cCBmaXJzdAogICAgICAgICAgICAkVXAgPSAkVHJ1ZQogICAgICAgICAgICBpZigkUGluZykgewogICAgICAgICAgICAgICAgJFVwID0gVGVzdC1Db25uZWN0aW9uIC1Db3VudCAxIC1RdWlldCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkVXApIHsKICAgICAgICAgICAgICAgICMgdHJ5IHRvIGVudW1lcmF0ZSAKICAgICAgICAgICAgICAgIEdldC1Vc2VyRXZlbnQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1FdmVudFR5cGUgJ2FsbCcgLURhdGVTdGFydCAoW0RhdGVUaW1lXTo6VG9kYXkuQWRkRGF5cygtJFNlYXJjaERheXMpKSB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgIyBmaWx0ZXIgZm9yIHRoZSB0YXJnZXQgdXNlciBzZXQKICAgICAgICAgICAgICAgICAgICAkVGFyZ2V0VXNlcnMgLWNvbnRhaW5zICRfLlVzZXJOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIHByb2Nlc3MgewoKICAgICAgICBpZigkVGhyZWFkcykgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJVc2luZyB0aHJlYWRpbmcgd2l0aCB0aHJlYWRzID0gJFRocmVhZHMiCgogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIHRocmVhZGluZywga2ljayBvZmYgdGhlIHNjcmlwdCBibG9jayB3aXRoIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uCiAgICAgICAgICAgICRTY3JpcHRQYXJhbXMgPSBAewogICAgICAgICAgICAgICAgJ1BpbmcnID0gJCgtbm90ICROb1BpbmcpCiAgICAgICAgICAgICAgICAnVGFyZ2V0VXNlcnMnID0gJFRhcmdldFVzZXJzCiAgICAgICAgICAgICAgICAnU2VhcmNoRGF5cycgPSAkU2VhcmNoRGF5cwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMgCiAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcwogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1uZSAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgRm9yRWFjaCAoJENvbXB1dGVyIGluICRDb21wdXRlck5hbWUpIHsKCiAgICAgICAgICAgICAgICAkQ291bnRlciA9ICRDb3VudGVyICsgMQoKICAgICAgICAgICAgICAgICMgc2xlZXAgZm9yIG91ciBzZW1pLXJhbmRvbWl6ZWQgaW50ZXJ2YWwKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSYW5kTm8uTmV4dCgoMS0kSml0dGVyKSokRGVsYXksICgxKyRKaXR0ZXIpKiREZWxheSkKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCiAgICAgICAgICAgICAgICBJbnZva2UtQ29tbWFuZCAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLUFyZ3VtZW50TGlzdCAkQ29tcHV0ZXIsICQoLW5vdCAkTm9QaW5nKSwgJFRhcmdldFVzZXJzLCAkU2VhcmNoRGF5cwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KfQoKCmZ1bmN0aW9uIEludm9rZS1TaGFyZUZpbmRlciB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiBmaW5kcyB0aGUgbG9jYWwgZG9tYWluIG5hbWUgZm9yIGEgaG9zdCB1c2luZyBHZXQtTmV0RG9tYWluLAogICAgICAgIHF1ZXJpZXMgdGhlIGRvbWFpbiBmb3IgYWxsIGFjdGl2ZSBtYWNoaW5lcyB3aXRoIEdldC1OZXRDb21wdXRlciwgdGhlbiBmb3IKICAgICAgICBlYWNoIHNlcnZlciBpdCBsaXN0cyBvZiBhY3RpdmUgc2hhcmVzIHdpdGggR2V0LU5ldFNoYXJlLiBOb24tc3RhbmRhcmQgc2hhcmVzCiAgICAgICAgY2FuIGJlIGZpbHRlcmVkIG91dCB3aXRoIC1FeGNsdWRlKiBmbGFncy4KCiAgICAgICAgQXV0aG9yOiBAaGFybWoweQogICAgICAgIExpY2Vuc2U6IEJTRCAzLUNsYXVzZQoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJOYW1lCgogICAgICAgIEhvc3QgYXJyYXkgdG8gZW51bWVyYXRlLCBwYXNzYWJsZSBvbiB0aGUgcGlwZWxpbmUuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckZpbGUKCiAgICAgICAgRmlsZSBvZiBob3N0bmFtZXMvSVBzIHRvIHNlYXJjaC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsdGVyCgogICAgICAgIEhvc3QgZmlsdGVyIG5hbWUgdG8gcXVlcnkgQUQgZm9yLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlckFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoIGZvciBob3N0cywgZS5nLiAiTERBUDovL09VPXNlY3JldCxEQz10ZXN0bGFiLERDPWxvY2FsIgogICAgICAgIFVzZWZ1bCBmb3IgT1UgcXVlcmllcy4KCiAgICAuUEFSQU1FVEVSIEV4Y2x1ZGVTdGFuZGFyZAoKICAgICAgICBTd2l0Y2guIEV4Y2x1ZGUgc3RhbmRhcmQgc2hhcmVzIGZyb20gZGlzcGxheSAoQyQsIElQQyQsIHByaW50JCBldGMuKQoKICAgIC5QQVJBTUVURVIgRXhjbHVkZVByaW50CgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSB0aGUgcHJpbnQkIHNoYXJlLgoKICAgIC5QQVJBTUVURVIgRXhjbHVkZUlQQwoKICAgICAgICBTd2l0Y2guIEV4Y2x1ZGUgdGhlIElQQyQgc2hhcmUuCgogICAgLlBBUkFNRVRFUiBDaGVja1NoYXJlQWNjZXNzCgogICAgICAgIFN3aXRjaC4gT25seSBkaXNwbGF5IGZvdW5kIHNoYXJlcyB0aGF0IHRoZSBsb2NhbCB1c2VyIGhhcyBhY2Nlc3MgdG8uCgogICAgLlBBUkFNRVRFUiBDaGVja0FkbWluCgogICAgICAgIFN3aXRjaC4gT25seSBkaXNwbGF5IEFETUlOJCBzaGFyZXMgdGhlIGxvY2FsIHVzZXIgaGFzIGFjY2VzcyB0by4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBTd2l0Y2guIERvbid0IHBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAuCgogICAgLlBBUkFNRVRFUiBKaXR0ZXIKCiAgICAgICAgSml0dGVyIGZvciB0aGUgaG9zdCBkZWxheSwgZGVmYXVsdHMgdG8gKy8tIDAuMy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBEb21haW4gdG8gcXVlcnkgZm9yIG1hY2hpbmVzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBEb21haW5Db250cm9sbGVyCgogICAgICAgIERvbWFpbiBjb250cm9sbGVyIHRvIHJlZmxlY3QgTERBUCBxdWVyaWVzIHRocm91Z2guCgogICAgLlBBUkFNRVRFUiBTZWFyY2hGb3Jlc3QKCiAgICAgICAgU3dpdGNoLiBTZWFyY2ggYWxsIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCBmb3IgdGFyZ2V0IHVzZXJzIGluc3RlYWQgb2YganVzdAogICAgICAgIGEgc2luZ2xlIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIFRocmVhZHMKCiAgICAgICAgVGhlIG1heGltdW0gY29uY3VycmVudCB0aHJlYWRzIHRvIGV4ZWN1dGUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtU2hhcmVGaW5kZXIgLUV4Y2x1ZGVTdGFuZGFyZAoKICAgICAgICBGaW5kIG5vbi1zdGFuZGFyZCBzaGFyZXMgb24gdGhlIGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1TaGFyZUZpbmRlciAtVGhyZWFkcyAyMAoKICAgICAgICBNdWx0aS10aHJlYWRlZCBzaGFyZSBmaW5kaW5nLCByZXBsYWNlcyBJbnZva2UtU2hhcmVGaW5kZXJUaHJlYWRlZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1TaGFyZUZpbmRlciAtRGVsYXkgNjAKCiAgICAgICAgRmluZCBzaGFyZXMgb24gdGhlIGRvbWFpbiB3aXRoIGEgNjAgc2Vjb25kICgrLy0gKi4zKQogICAgICAgIHJhbmRvbWl6ZWQgZGVsYXkgYmV0d2VlbiB0b3VjaGluZyBlYWNoIGhvc3QuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtU2hhcmVGaW5kZXIgLUNvbXB1dGVyRmlsZSBob3N0cy50eHQKCiAgICAgICAgRmluZCBzaGFyZXMgZm9yIG1hY2hpbmVzIGluIHRoZSBzcGVjaWZpZWQgaG9zdHMgZmlsZS4KCiAgICAuTElOSwogICAgaHR0cDovL2Jsb2cuaGFybWoweS5uZXQKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSRUcnVlKV0KICAgICAgICBbQWxpYXMoJ0hvc3RzJyldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgICRDb21wdXRlck5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtBbGlhcygnSG9zdExpc3QnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbGUsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsdGVyLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckFEU3BhdGgsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEV4Y2x1ZGVTdGFuZGFyZCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRXhjbHVkZVByaW50LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlSVBDLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb1BpbmcsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJENoZWNrU2hhcmVBY2Nlc3MsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJENoZWNrQWRtaW4sCgogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMCwKCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKIAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaEZvcmVzdCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzCiAgICApCgogICAgYmVnaW4gewogICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnNbJ0RlYnVnJ10pIHsKICAgICAgICAgICAgJERlYnVnUHJlZmVyZW5jZSA9ICdDb250aW51ZScKICAgICAgICB9CgogICAgICAgICMgcmFuZG9tIG9iamVjdCBmb3IgZGVsYXkKICAgICAgICAkUmFuZE5vID0gTmV3LU9iamVjdCBTeXN0ZW0uUmFuZG9tCgogICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBSdW5uaW5nIEludm9rZS1TaGFyZUZpbmRlciB3aXRoIGRlbGF5IG9mICREZWxheSIKCiAgICAgICAgIyBmaWd1cmUgb3V0IHRoZSBzaGFyZXMgd2Ugd2FudCB0byBpZ25vcmUKICAgICAgICBbU3RyaW5nW11dICRFeGNsdWRlZFNoYXJlcyA9IEAoJycpCgogICAgICAgIGlmICgkRXhjbHVkZVByaW50KSB7CiAgICAgICAgICAgICRFeGNsdWRlZFNoYXJlcyA9ICRFeGNsdWRlZFNoYXJlcyArICJQUklOVCQiCiAgICAgICAgfQogICAgICAgIGlmICgkRXhjbHVkZUlQQykgewogICAgICAgICAgICAkRXhjbHVkZWRTaGFyZXMgPSAkRXhjbHVkZWRTaGFyZXMgKyAiSVBDJCIKICAgICAgICB9CiAgICAgICAgaWYgKCRFeGNsdWRlU3RhbmRhcmQpIHsKICAgICAgICAgICAgJEV4Y2x1ZGVkU2hhcmVzID0gQCgnJywgIkFETUlOJCIsICJJUEMkIiwgIkMkIiwgIlBSSU5UJCIpCiAgICAgICAgfQoKICAgICAgICBpZighJENvbXB1dGVyTmFtZSkgeyAKCiAgICAgICAgICAgIGlmKCREb21haW4pIHsKICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCgkRG9tYWluKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU2VhcmNoRm9yZXN0KSB7CiAgICAgICAgICAgICAgICAjIGdldCBBTEwgdGhlIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCB0byBzZWFyY2gKICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gR2V0LU5ldEZvcmVzdERvbWFpbiB8IEZvckVhY2gtT2JqZWN0IHsgJF8uTmFtZSB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAjIHVzZSB0aGUgbG9jYWwgZG9tYWluCiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoIChHZXQtTmV0RG9tYWluKS5uYW1lICkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyBhIGhvc3QgZmlsZSBsaXN0LCByZWFkIHRoZSB0YXJnZXRzIGluIGFuZCBhZGQgdGhlbSB0byB0aGUgdGFyZ2V0IGxpc3QKICAgICAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1Db250ZW50IC1QYXRoICRDb21wdXRlckZpbGUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUZpbHRlciAkQ29tcHV0ZXJGaWx0ZXIgLUFEU3BhdGggJENvbXB1dGVyQURTcGF0aAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuY291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIHNjcmlwdCBibG9jayB0aGF0IGVudW1lcmF0ZXMgYSBzZXJ2ZXIKICAgICAgICAkSG9zdEVudW1CbG9jayA9IHsKICAgICAgICAgICAgcGFyYW0oJENvbXB1dGVyTmFtZSwgJFBpbmcsICRDaGVja1NoYXJlQWNjZXNzLCAkRXhjbHVkZWRTaGFyZXMsICRDaGVja0FkbWluKQoKICAgICAgICAgICAgIyBvcHRpb25hbGx5IGNoZWNrIGlmIHRoZSBzZXJ2ZXIgaXMgdXAgZmlyc3QKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAjIGdldCB0aGUgc2hhcmVzIGZvciB0aGlzIGhvc3QgYW5kIGNoZWNrIHdoYXQgd2UgZmluZAogICAgICAgICAgICAgICAgJFNoYXJlcyA9IEdldC1OZXRTaGFyZSAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIEZvckVhY2ggKCRTaGFyZSBpbiAkU2hhcmVzKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIlsqXSBTZXJ2ZXIgc2hhcmU6ICRTaGFyZSIKICAgICAgICAgICAgICAgICAgICAkTmV0TmFtZSA9ICRTaGFyZS5zaGkxX25ldG5hbWUKICAgICAgICAgICAgICAgICAgICAkUmVtYXJrID0gJFNoYXJlLnNoaTFfcmVtYXJrCiAgICAgICAgICAgICAgICAgICAgJFBhdGggPSAnXFwnKyRDb21wdXRlck5hbWUrJ1wnKyROZXROYW1lCgogICAgICAgICAgICAgICAgICAgICMgbWFrZSBzdXJlIHdlIGdldCBhIHJlYWwgc2hhcmUgbmFtZSBiYWNrCiAgICAgICAgICAgICAgICAgICAgaWYgKCgkTmV0TmFtZSkgLWFuZCAoJE5ldE5hbWUudHJpbSgpIC1uZSAnJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBqdXN0IGNoZWNraW5nIGZvciBhY2Nlc3MgdG8gQURNSU4kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRDaGVja0FkbWluKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkTmV0TmFtZS5Ub1VwcGVyKCkgLWVxICJBRE1JTiQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE51bGwgPSBbSU8uRGlyZWN0b3J5XTo6R2V0RmlsZXMoJFBhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcXCRDb21wdXRlck5hbWVcJE5ldE5hbWUgYHQtICRSZW1hcmsiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIkVycm9yIGFjY2Vzc2luZyBwYXRoICRQYXRoIDogJF8iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICMgc2tpcCB0aGlzIHNoYXJlIGlmIGl0J3MgaW4gdGhlIGV4Y2x1ZGUgbGlzdAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKCRFeGNsdWRlZFNoYXJlcyAtTm90Q29udGFpbnMgJE5ldE5hbWUuVG9VcHBlcigpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHNlZSBpZiB3ZSB3YW50IHRvIGNoZWNrIGFjY2VzcyB0byB0aGlzIHNoYXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkQ2hlY2tTaGFyZUFjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIHVzZXIgaGFzIGFjY2VzcyB0byB0aGlzIHBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTnVsbCA9IFtJTy5EaXJlY3RvcnldOjpHZXRGaWxlcygkUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlxcJENvbXB1dGVyTmFtZVwkTmV0TmFtZSBgdC0gJFJlbWFyayIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiRXJyb3IgYWNjZXNzaW5nIHBhdGggJFBhdGggOiAkXyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXFwkQ29tcHV0ZXJOYW1lXCROZXROYW1lIGB0LSAkUmVtYXJrIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBwcm9jZXNzIHsKCiAgICAgICAgaWYoJFRocmVhZHMpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVXNpbmcgdGhyZWFkaW5nIHdpdGggdGhyZWFkcyA9ICRUaHJlYWRzIgoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyB0aHJlYWRpbmcsIGtpY2sgb2ZmIHRoZSBzY3JpcHQgYmxvY2sgd2l0aCBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbgogICAgICAgICAgICAkU2NyaXB0UGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICdQaW5nJyA9ICQoLW5vdCAkTm9QaW5nKQogICAgICAgICAgICAgICAgJ0NoZWNrU2hhcmVBY2Nlc3MnID0gJENoZWNrU2hhcmVBY2Nlc3MKICAgICAgICAgICAgICAgICdFeGNsdWRlZFNoYXJlcycgPSAkRXhjbHVkZWRTaGFyZXMKICAgICAgICAgICAgICAgICdDaGVja0FkbWluJyA9ICRDaGVja0FkbWluCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMga2ljayBvZmYgdGhlIHRocmVhZGVkIHNjcmlwdCBibG9jayArIGFyZ3VtZW50cyAKICAgICAgICAgICAgSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtU2NyaXB0UGFyYW1ldGVycyAkU2NyaXB0UGFyYW1zCiAgICAgICAgfQoKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoLW5vdCAkTm9QaW5nIC1hbmQgKCRDb21wdXRlck5hbWUuY291bnQgLW5lIDEpKSB7CiAgICAgICAgICAgICAgICAjIHBpbmcgYWxsIGhvc3RzIGluIHBhcmFsbGVsCiAgICAgICAgICAgICAgICAkUGluZyA9IHtwYXJhbSgkQ29tcHV0ZXJOYW1lKSBpZihUZXN0LUNvbm5lY3Rpb24gLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1Db3VudCAxIC1RdWlldCAtRXJyb3JBY3Rpb24gU3RvcCl7JENvbXB1dGVyTmFtZX19CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gSW52b2tlLVRocmVhZGVkRnVuY3Rpb24gLU5vSW1wb3J0cyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRQaW5nIC1UaHJlYWRzIDEwMAogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gVG90YWwgbnVtYmVyIG9mIGFjdGl2ZSBob3N0czogJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSIKICAgICAgICAgICAgJENvdW50ZXIgPSAwCgogICAgICAgICAgICBGb3JFYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewoKICAgICAgICAgICAgICAgICRDb3VudGVyID0gJENvdW50ZXIgKyAxCgogICAgICAgICAgICAgICAgIyBzbGVlcCBmb3Igb3VyIHNlbWktcmFuZG9taXplZCBpbnRlcnZhbAogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQoKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBFbnVtZXJhdGluZyBzZXJ2ZXIgJENvbXB1dGVyICgkQ291bnRlciBvZiAkKCRDb21wdXRlck5hbWUuY291bnQpKSIKICAgICAgICAgICAgICAgIEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkSG9zdEVudW1CbG9jayAtQXJndW1lbnRMaXN0ICRDb21wdXRlciwgJEZhbHNlLCAkQ2hlY2tTaGFyZUFjY2VzcywgJEV4Y2x1ZGVkU2hhcmVzLCAkQ2hlY2tBZG1pbgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgfQp9CgoKZnVuY3Rpb24gSW52b2tlLUZpbGVGaW5kZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEZpbmRzIHNlbnNpdGl2ZSBmaWxlcyBvbiB0aGUgZG9tYWluLgoKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLkRFU0NSSVBUSU9OCgogICAgICAgIFRoaXMgZnVuY3Rpb24gZmluZHMgdGhlIGxvY2FsIGRvbWFpbiBuYW1lIGZvciBhIGhvc3QgdXNpbmcgR2V0LU5ldERvbWFpbiwKICAgICAgICBxdWVyaWVzIHRoZSBkb21haW4gZm9yIGFsbCBhY3RpdmUgbWFjaGluZXMgd2l0aCBHZXQtTmV0Q29tcHV0ZXIsIGdyYWJzCiAgICAgICAgdGhlIHJlYWRhYmxlIHNoYXJlcyBmb3IgZWFjaCBzZXJ2ZXIsIGFuZCByZWN1cnNpdmVseSBzZWFyY2hlcyBldmVyeQogICAgICAgIHNoYXJlIGZvciBmaWxlcyB3aXRoIHNwZWNpZmljIGtleXdvcmRzIGluIHRoZSBuYW1lLgogICAgICAgIElmIGEgc2hhcmUgbGlzdCBpcyBwYXNzZWQsIEVWRVJZIHNoYXJlIGlzIGVudW1lcmF0ZWQgcmVnYXJkbGVzcyBvZgogICAgICAgIG90aGVyIG9wdGlvbnMuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgU2hhcmVMaXN0CgogICAgICAgIExpc3QgaWYgXFxIT1NUXHNoYXJlcyB0byBzZWFyY2ggdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFRlcm1zCgogICAgICAgIFRlcm1zIHRvIHNlYXJjaCBmb3IuCgogICAgLlBBUkFNRVRFUiBPZmZpY2VEb2NzCgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGZvciBvZmZpY2UgZG9jdW1lbnRzICgqLmRvYyosICoueGxzKiwgKi5wcHQqKQoKICAgIC5QQVJBTUVURVIgRnJlc2hFWEVzCgogICAgICAgIFN3aXRjaC4gRmluZCAuRVhFcyBhY2Nlc3NlZCB3aXRoaW4gdGhlIGxhc3Qgd2Vlay4KCiAgICAuUEFSQU1FVEVSIExhc3RBY2Nlc3NUaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBMYXN0QWNjZXNzVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgTGFzdFdyaXRlVGltZQoKICAgICAgICBPbmx5IHJldHVybiBmaWxlcyB3aXRoIGEgTGFzdFdyaXRlVGltZSBncmVhdGVyIHRoYW4gdGhpcyBkYXRlIHZhbHVlLgoKICAgIC5QQVJBTUVURVIgQ3JlYXRpb25UaW1lCgogICAgICAgIE9ubHkgcmV0dXJuIGZpbGVzIHdpdGggYSBDcmVhdGlvbkRhdGUgZ3JlYXRlciB0aGFuIHRoaXMgZGF0ZSB2YWx1ZS4KCiAgICAuUEFSQU1FVEVSIEluY2x1ZGVDCgogICAgICAgIFN3aXRjaC4gSW5jbHVkZSBhbnkgQyQgc2hhcmVzIGluIHJlY3Vyc2l2ZSBzZWFyY2hpbmcgKGRlZmF1bHQgaWdub3JlKS4KCiAgICAuUEFSQU1FVEVSIEluY2x1ZGVBZG1pbgoKICAgICAgICBTd2l0Y2guIEluY2x1ZGUgYW55IEFETUlOJCBzaGFyZXMgaW4gcmVjdXJzaXZlIHNlYXJjaGluZyAoZGVmYXVsdCBpZ25vcmUpLgoKICAgIC5QQVJBTUVURVIgRXhjbHVkZUZvbGRlcnMKCiAgICAgICAgU3dpdGNoLiBFeGNsdWRlIGZvbGRlcnMgZnJvbSB0aGUgc2VhcmNoIHJlc3VsdHMuCgogICAgLlBBUkFNRVRFUiBFeGNsdWRlSGlkZGVuCgogICAgICAgIFN3aXRjaC4gRXhjbHVkZSBoaWRkZW4gZmlsZXMgYW5kIGZvbGRlcnMgZnJvbSB0aGUgc2VhcmNoIHJlc3VsdHMuCgogICAgLlBBUkFNRVRFUiBDaGVja1dyaXRlQWNjZXNzCgogICAgICAgIFN3aXRjaC4gT25seSByZXR1cm5zIGZpbGVzIHRoZSBjdXJyZW50IHVzZXIgaGFzIHdyaXRlIGFjY2VzcyB0by4KCiAgICAuUEFSQU1FVEVSIE91dEZpbGUKCiAgICAgICAgT3V0cHV0IHJlc3VsdHMgdG8gYSBzcGVjaWZpZWQgY3N2IG91dHB1dCBmaWxlLgoKICAgIC5QQVJBTUVURVIgTm9DbG9iYmVyCgogICAgICAgIFN3aXRjaC4gRG9uJ3Qgb3ZlcndyaXRlIGFueSBleGlzdGluZyBvdXRwdXQgZmlsZS4KCiAgICAuUEFSQU1FVEVSIE5vUGluZwoKICAgICAgICBTd2l0Y2guIERvbid0IHBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERlbGF5CgogICAgICAgIERlbGF5IGJldHdlZW4gZW51bWVyYXRpbmcgaG9zdHMsIGRlZmF1bHRzIHRvIDAKCiAgICAuUEFSQU1FVEVSIEppdHRlcgoKICAgICAgICBKaXR0ZXIgZm9yIHRoZSBob3N0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHF1ZXJ5IGZvciBtYWNoaW5lcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoRm9yZXN0CgogICAgICAgIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoU1lTVk9MCgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGZvciBsb2dpbiBzY3JpcHRzIG9uIHRoZSBTWVNWT0wgb2YgdGhlIHByaW1hcnkgRENzIGZvciBlYWNoIHNwZWNpZmllZCBkb21haW4uCgogICAgLlBBUkFNRVRFUiBUaHJlYWRzCgogICAgICAgIFRoZSBtYXhpbXVtIGNvbmN1cnJlbnQgdGhyZWFkcyB0byBleGVjdXRlLgoKICAgIC5QQVJBTUVURVIgVXNlUFNEcml2ZQoKICAgICAgICBTd2l0Y2guIE1vdW50IHRhcmdldCByZW1vdGUgcGF0aCB3aXRoIHRlbXBvcmFyeSBQU0RyaXZlcy4KCiAgICAuUEFSQU1FVEVSIENyZWRlbnRpYWwKCiAgICAgICAgQ3JlZGVudGlhbCB0byB1c2UgdG8gbW91bnQgdGhlIFBTRHJpdmUgZm9yIHNlYXJjaGluZy4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1GaWxlRmluZGVyCgogICAgICAgIEZpbmQgcmVhZGFibGUgZmlsZXMgb24gdGhlIGRvbWFpbiB3aXRoICdwYXNzJywgJ3NlbnNpdGl2ZScsCiAgICAgICAgJ3NlY3JldCcsICdhZG1pbicsICdsb2dpbicsIG9yICd1bmF0dGVuZCoueG1sJyBpbiB0aGUgbmFtZSwKCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1GaWxlRmluZGVyIC1Eb21haW4gdGVzdGluZwoKICAgICAgICBGaW5kIHJlYWRhYmxlIGZpbGVzIG9uIHRoZSAndGVzdGluZycgZG9tYWluIHdpdGggJ3Bhc3MnLCAnc2Vuc2l0aXZlJywKICAgICAgICAnc2VjcmV0JywgJ2FkbWluJywgJ2xvZ2luJywgb3IgJ3VuYXR0ZW5kKi54bWwnIGluIHRoZSBuYW1lLAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLUZpbGVGaW5kZXIgLUluY2x1ZGVDCgogICAgICAgIEZpbmQgcmVhZGFibGUgZmlsZXMgb24gdGhlIGRvbWFpbiB3aXRoICdwYXNzJywgJ3NlbnNpdGl2ZScsCiAgICAgICAgJ3NlY3JldCcsICdhZG1pbicsICdsb2dpbicgb3IgJ3VuYXR0ZW5kKi54bWwnIGluIHRoZSBuYW1lLAogICAgICAgIGluY2x1ZGluZyBDJCBzaGFyZXMuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBJbnZva2UtRmlsZUZpbmRlciAtU2hhcmVMaXN0IHNoYXJlcy50eHQgLVRlcm1zIGFjY291bnRzLHNzbiAtT3V0RmlsZSBvdXQuY3N2CgogICAgICAgIEVudW1lcmF0ZSBhIHNwZWNpZmllZCBzaGFyZSBsaXN0IGZvciBmaWxlcyB3aXRoICdhY2NvdW50cycgb3IKICAgICAgICAnc3NuJyBpbiB0aGUgbmFtZSwgYW5kIHdyaXRlIGV2ZXJ5dGhpbmcgdG8gIm91dC5jc3YiCgogICAgLkxJTksKICAgICAgICBodHRwOi8vd3d3Lmhhcm1qMHkubmV0L2Jsb2cvcmVkdGVhbWluZy9maWxlLXNlcnZlci10cmlhZ2Utb24tcmVkLXRlYW0tZW5nYWdlbWVudHMvCgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtBbGlhcygnSG9zdHMnKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgJENvbXB1dGVyTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW0FsaWFzKCdIb3N0TGlzdCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyRmlsZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWx0ZXIsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyQURTcGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2hhcmVMaXN0LAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRPZmZpY2VEb2NzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRGcmVzaEVYRXMsCgogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkVGVybXMsCgogICAgICAgIFtWYWxpZGF0ZVNjcmlwdCh7VGVzdC1QYXRoIC1QYXRoICRfIH0pXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRlcm1MaXN0LAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRMYXN0QWNjZXNzVGltZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTGFzdFdyaXRlVGltZSwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ3JlYXRpb25UaW1lLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRJbmNsdWRlQywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkSW5jbHVkZUFkbWluLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGNsdWRlRm9sZGVycywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRXhjbHVkZUhpZGRlbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ2hlY2tXcml0ZUFjY2VzcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkT3V0RmlsZSwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkTm9DbG9iYmVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb1BpbmcsCgogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMCwKCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKICAgICAgICAKICAgICAgICBbU3dpdGNoXQogICAgICAgICRTZWFyY2hGb3Jlc3QsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNlYXJjaFNZU1ZPTCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRUaHJlYWRzLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VQU0RyaXZlLAoKICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdOjpFbXB0eQogICAgKQoKICAgIGJlZ2luIHsKICAgICAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzWydEZWJ1ZyddKSB7CiAgICAgICAgICAgICREZWJ1Z1ByZWZlcmVuY2UgPSAnQ29udGludWUnCiAgICAgICAgfQoKICAgICAgICAjIHJhbmRvbSBvYmplY3QgZm9yIGRlbGF5CiAgICAgICAgJFJhbmRObyA9IE5ldy1PYmplY3QgU3lzdGVtLlJhbmRvbQoKICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUnVubmluZyBJbnZva2UtRmlsZUZpbmRlciB3aXRoIGRlbGF5IG9mICREZWxheSIKCiAgICAgICAgJFNoYXJlcyA9IEAoKQoKICAgICAgICAjIGZpZ3VyZSBvdXQgdGhlIHNoYXJlcyB3ZSB3YW50IHRvIGlnbm9yZQogICAgICAgIFtTdHJpbmdbXV0gJEV4Y2x1ZGVkU2hhcmVzID0gQCgiQyQiLCAiQURNSU4kIikKCiAgICAgICAgIyBzZWUgaWYgd2UncmUgc3BlY2lmaWNhbGx5IGluY2x1ZGluZyBhbnkgb2YgdGhlIG5vcm1hbGx5IGV4Y2x1ZGVkIHNldHMKICAgICAgICBpZiAoJEluY2x1ZGVDKSB7CiAgICAgICAgICAgIGlmICgkSW5jbHVkZUFkbWluKSB7CiAgICAgICAgICAgICAgICAkRXhjbHVkZWRTaGFyZXMgPSBAKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRFeGNsdWRlZFNoYXJlcyA9IEAoIkFETUlOJCIpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgkSW5jbHVkZUFkbWluKSB7CiAgICAgICAgICAgIGlmICgkSW5jbHVkZUMpIHsKICAgICAgICAgICAgICAgICRFeGNsdWRlZFNoYXJlcyA9IEAoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJEV4Y2x1ZGVkU2hhcmVzID0gQCgiQyQiKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGRlbGV0ZSBhbnkgZXhpc3Rpbmcgb3V0cHV0IGZpbGUgaWYgaXQgYWxyZWFkeSBleGlzdHMKICAgICAgICBpZighJE5vQ2xvYmJlcikgewogICAgICAgICAgICBpZiAoJE91dEZpbGUgLWFuZCAoVGVzdC1QYXRoIC1QYXRoICRPdXRGaWxlKSkgeyBSZW1vdmUtSXRlbSAtUGF0aCAkT3V0RmlsZSB9CiAgICAgICAgfQoKICAgICAgICAjIGlmIHRoZXJlJ3MgYSBzZXQgb2YgdGVybXMgc3BlY2lmaWVkIHRvIHNlYXJjaCBmb3IKICAgICAgICBpZiAoJFRlcm1MaXN0KSB7CiAgICAgICAgICAgIEZvckVhY2ggKCRUZXJtIGluIEdldC1Db250ZW50IC1QYXRoICRUZXJtTGlzdCkgewogICAgICAgICAgICAgICAgaWYgKCgkVGVybSAtbmUgJE51bGwpIC1hbmQgKCRUZXJtLnRyaW0oKSAtbmUgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgJFRlcm1zICs9ICRUZXJtCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmKCREb21haW4pIHsKICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCREb21haW4pCiAgICAgICAgfQogICAgICAgIGVsc2VpZigkU2VhcmNoRm9yZXN0KSB7CiAgICAgICAgICAgICMgZ2V0IEFMTCB0aGUgZG9tYWlucyBpbiB0aGUgZm9yZXN0IHRvIHNlYXJjaAogICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEdldC1OZXRGb3Jlc3REb21haW4gfCBGb3JFYWNoLU9iamVjdCB7ICRfLk5hbWUgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgIyB1c2UgdGhlIGxvY2FsIGRvbWFpbgogICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoIChHZXQtTmV0RG9tYWluKS5uYW1lICkKICAgICAgICB9CgogICAgICAgICMgaWYgd2UncmUgaGFyZC1wYXNzZWQgYSBzZXQgb2Ygc2hhcmVzCiAgICAgICAgaWYoJFNoYXJlTGlzdCkgewogICAgICAgICAgICBGb3JFYWNoICgkSXRlbSBpbiBHZXQtQ29udGVudCAtUGF0aCAkU2hhcmVMaXN0KSB7CiAgICAgICAgICAgICAgICBpZiAoKCRJdGVtIC1uZSAkTnVsbCkgLWFuZCAoJEl0ZW0udHJpbSgpIC1uZSAnJykpIHsKICAgICAgICAgICAgICAgICAgICAjIGV4Y2x1ZGUgYW55ICJbdGFiXS0gY29tbWFudHMiLCBpLmUuIHRoZSBvdXRwdXQgZnJvbSBJbnZva2UtU2hhcmVGaW5kZXIKICAgICAgICAgICAgICAgICAgICAkU2hhcmUgPSAkSXRlbS5TcGxpdCgiYHQiKVswXQogICAgICAgICAgICAgICAgICAgICRTaGFyZXMgKz0gJFNoYXJlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYoJFNlYXJjaFNZU1ZPTCkgewogICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAkRENTZWFyY2hQYXRoID0gIlxcJERvbWFpblxTWVNWT0xcIgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEFkZGluZyBzaGFyZSBzZWFyY2ggcGF0aCAkRENTZWFyY2hQYXRoIgogICAgICAgICAgICAgICAgJFNoYXJlcyArPSAkRENTZWFyY2hQYXRoCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoISRUZXJtcykgewogICAgICAgICAgICAgICAgIyBzZWFyY2ggZm9yIGludGVyZXN0aW5nIHNjcmlwdHMgb24gU1lTVk9MCiAgICAgICAgICAgICAgICAkVGVybXMgPSBAKCcudmJzJywgJy5iYXQnLCAnLnBzMScpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgYSBob3N0IGxpc3QsIHJlYWQgdGhlIHRhcmdldHMgaW4gYW5kIGFkZCB0aGVtIHRvIHRoZSB0YXJnZXQgbGlzdAogICAgICAgICAgICBpZigkQ29tcHV0ZXJGaWxlKSB7CiAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gR2V0LUNvbnRlbnQgLVBhdGggJENvbXB1dGVyRmlsZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgW2FycmF5XSRDb21wdXRlck5hbWUgPSBAKCkKICAgICAgICAgICAgICAgIEZvckVhY2ggKCREb21haW4gaW4gJFRhcmdldERvbWFpbnMpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gUXVlcnlpbmcgZG9tYWluICREb21haW4gZm9yIGhvc3RzIgogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgKz0gR2V0LU5ldENvbXB1dGVyIC1GaWx0ZXIgJENvbXB1dGVyRmlsdGVyIC1BRFNwYXRoICRDb21wdXRlckFEU3BhdGggLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgcmVtb3ZlIGFueSBudWxsIHRhcmdldCBob3N0cywgdW5pcXVpZnkgdGhlIGxpc3QgYW5kIHNodWZmbGUgaXQKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9ICRDb21wdXRlck5hbWUgfCBXaGVyZS1PYmplY3QgeyAkXyB9IHwgU29ydC1PYmplY3QgLVVuaXF1ZSB8IFNvcnQtT2JqZWN0IHsgR2V0LVJhbmRvbSB9CiAgICAgICAgICAgIGlmKCQoJENvbXB1dGVyTmFtZS5Db3VudCkgLWVxIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJObyBob3N0cyBmb3VuZCEiCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBzaGFyZXMgYW5kIGZpbGVzIG9uIGEgc2VydmVyCiAgICAgICAgJEhvc3RFbnVtQmxvY2sgPSB7CiAgICAgICAgICAgIHBhcmFtKCRDb21wdXRlck5hbWUsICRQaW5nLCAkRXhjbHVkZWRTaGFyZXMsICRUZXJtcywgJEV4Y2x1ZGVGb2xkZXJzLCAkT2ZmaWNlRG9jcywgJEV4Y2x1ZGVIaWRkZW4sICRGcmVzaEVYRXMsICRDaGVja1dyaXRlQWNjZXNzLCAkT3V0RmlsZSwgJFVzZVBTRHJpdmUsICRDcmVkZW50aWFsKQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29tcHV0ZXJOYW1lOiAkQ29tcHV0ZXJOYW1lIgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFeGNsdWRlZFNoYXJlczogJEV4Y2x1ZGVkU2hhcmVzIgogICAgICAgICAgICAkU2VhcmNoU2hhcmVzID0gQCgpCgogICAgICAgICAgICBpZigkQ29tcHV0ZXJOYW1lLlN0YXJ0c1dpdGgoIlxcIikpIHsKICAgICAgICAgICAgICAgICMgaWYgYSBzaGFyZSBpcyBwYXNzZWQgYXMgdGhlIHNlcnZlcgogICAgICAgICAgICAgICAgJFNlYXJjaFNoYXJlcyArPSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGVudW1lcmF0aW5nIHRoZSBzaGFyZXMgb24gdGhlIHRhcmdldCBzZXJ2ZXIgZmlyc3QKICAgICAgICAgICAgICAgICRVcCA9ICRUcnVlCiAgICAgICAgICAgICAgICBpZigkUGluZykgewogICAgICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZigkVXApIHsKICAgICAgICAgICAgICAgICAgICAjIGdldCB0aGUgc2hhcmVzIGZvciB0aGlzIGhvc3QgYW5kIGRpc3BsYXkgd2hhdCB3ZSBmaW5kCiAgICAgICAgICAgICAgICAgICAgJFNoYXJlcyA9IEdldC1OZXRTaGFyZSAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkU2hhcmUgaW4gJFNoYXJlcykgewoKICAgICAgICAgICAgICAgICAgICAgICAgJE5ldE5hbWUgPSAkU2hhcmUuc2hpMV9uZXRuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRQYXRoID0gJ1xcJyskQ29tcHV0ZXJOYW1lKydcJyskTmV0TmFtZQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBtYWtlIHN1cmUgd2UgZ2V0IGEgcmVhbCBzaGFyZSBuYW1lIGJhY2sKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCgkTmV0TmFtZSkgLWFuZCAoJE5ldE5hbWUudHJpbSgpIC1uZSAnJykpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHNraXAgdGhpcyBzaGFyZSBpZiBpdCdzIGluIHRoZSBleGNsdWRlIGxpc3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkRXhjbHVkZWRTaGFyZXMgLU5vdENvbnRhaW5zICROZXROYW1lLlRvVXBwZXIoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY2hlY2sgaWYgdGhlIHVzZXIgaGFzIGFjY2VzcyB0byB0aGlzIHBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTnVsbCA9IFtJTy5EaXJlY3RvcnldOjpHZXRGaWxlcygkUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNlYXJjaFNoYXJlcyArPSAkUGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLURlYnVnICJbIV0gTm8gYWNjZXNzIHRvICRQYXRoIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgRm9yRWFjaCgkU2hhcmUgaW4gJFNlYXJjaFNoYXJlcykgewogICAgICAgICAgICAgICAgJFNlYXJjaEFyZ3MgPSAgQHsKICAgICAgICAgICAgICAgICAgICAnUGF0aCcgPSAkU2hhcmUKICAgICAgICAgICAgICAgICAgICAnVGVybXMnID0gJFRlcm1zCiAgICAgICAgICAgICAgICAgICAgJ09mZmljZURvY3MnID0gJE9mZmljZURvY3MKICAgICAgICAgICAgICAgICAgICAnRnJlc2hFWEVzJyA9ICRGcmVzaEVYRXMKICAgICAgICAgICAgICAgICAgICAnTGFzdEFjY2Vzc1RpbWUnID0gJExhc3RBY2Nlc3NUaW1lCiAgICAgICAgICAgICAgICAgICAgJ0xhc3RXcml0ZVRpbWUnID0gJExhc3RXcml0ZVRpbWUKICAgICAgICAgICAgICAgICAgICAnQ3JlYXRpb25UaW1lJyA9ICRDcmVhdGlvblRpbWUKICAgICAgICAgICAgICAgICAgICAnRXhjbHVkZUZvbGRlcnMnID0gJEV4Y2x1ZGVGb2xkZXJzCiAgICAgICAgICAgICAgICAgICAgJ0V4Y2x1ZGVIaWRkZW4nID0gJEV4Y2x1ZGVIaWRkZW4KICAgICAgICAgICAgICAgICAgICAnQ2hlY2tXcml0ZUFjY2VzcycgPSAkQ2hlY2tXcml0ZUFjY2VzcwogICAgICAgICAgICAgICAgICAgICdPdXRGaWxlJyA9ICRPdXRGaWxlCiAgICAgICAgICAgICAgICAgICAgJ1VzZVBTRHJpdmUnID0gJFVzZVBTRHJpdmUKICAgICAgICAgICAgICAgICAgICAnQ3JlZGVudGlhbCcgPSAkQ3JlZGVudGlhbAogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEZpbmQtSW50ZXJlc3RpbmdGaWxlIEBTZWFyY2hBcmdzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdFeGNsdWRlZFNoYXJlcycgPSAkRXhjbHVkZWRTaGFyZXMKICAgICAgICAgICAgICAgICdUZXJtcycgPSAkVGVybXMKICAgICAgICAgICAgICAgICdFeGNsdWRlRm9sZGVycycgPSAkRXhjbHVkZUZvbGRlcnMKICAgICAgICAgICAgICAgICdPZmZpY2VEb2NzJyA9ICRPZmZpY2VEb2NzCiAgICAgICAgICAgICAgICAnRXhjbHVkZUhpZGRlbicgPSAkRXhjbHVkZUhpZGRlbgogICAgICAgICAgICAgICAgJ0ZyZXNoRVhFcycgPSAkRnJlc2hFWEVzCiAgICAgICAgICAgICAgICAnQ2hlY2tXcml0ZUFjY2VzcycgPSAkQ2hlY2tXcml0ZUFjY2VzcwogICAgICAgICAgICAgICAgJ091dEZpbGUnID0gJE91dEZpbGUKICAgICAgICAgICAgICAgICdVc2VQU0RyaXZlJyA9ICRVc2VQU0RyaXZlCiAgICAgICAgICAgICAgICAnQ3JlZGVudGlhbCcgPSAkQ3JlZGVudGlhbAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMgCiAgICAgICAgICAgIGlmKCRTaGFyZXMpIHsKICAgICAgICAgICAgICAgICMgcGFzcyB0aGUgc2hhcmVzIGFzIHRoZSBob3N0cyBzbyB0aGUgdGhyZWFkZWQgZnVuY3Rpb24gY29kZSBkb2Vzbid0IGhhdmUgdG8gYmUgaGFja2VkIHVwCiAgICAgICAgICAgICAgICBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtQ29tcHV0ZXJOYW1lICRTaGFyZXMgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1TY3JpcHRQYXJhbWV0ZXJzICRTY3JpcHRQYXJhbXMKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcwogICAgICAgICAgICB9ICAgICAgICAKICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigkU2hhcmVzKXsKICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkU2hhcmVzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1ndCAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7JF99IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29tcHV0ZXI6ICRfIgogICAgICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKCiAgICAgICAgICAgICAgICAjIHNsZWVwIGZvciBvdXIgc2VtaS1yYW5kb21pemVkIGludGVydmFsCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkXyAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCgogICAgICAgICAgICAgICAgSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJF8sICRGYWxzZSwgJEV4Y2x1ZGVkU2hhcmVzLCAkVGVybXMsICRFeGNsdWRlRm9sZGVycywgJE9mZmljZURvY3MsICRFeGNsdWRlSGlkZGVuLCAkRnJlc2hFWEVzLCAkQ2hlY2tXcml0ZUFjY2VzcywgJE91dEZpbGUsICRVc2VQU0RyaXZlLCAkQ3JlZGVudGlhbCAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtTG9jYWxBZG1pbkFjY2VzcyB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgRmluZHMgbWFjaGluZXMgb24gdGhlIGxvY2FsIGRvbWFpbiB3aGVyZSB0aGUgY3VycmVudCB1c2VyIGhhcwogICAgICAgIGxvY2FsIGFkbWluaXN0cmF0b3IgYWNjZXNzLiBVc2VzIG11bHRpdGhyZWFkaW5nIHRvCiAgICAgICAgc3BlZWQgdXAgZW51bWVyYXRpb24uCgogICAgICAgIEF1dGhvcjogQGhhcm1qMHkKICAgICAgICBMaWNlbnNlOiBCU0QgMy1DbGF1c2UKCiAgICAuREVTQ1JJUFRJT04KCiAgICAgICAgVGhpcyBmdW5jdGlvbiBmaW5kcyB0aGUgbG9jYWwgZG9tYWluIG5hbWUgZm9yIGEgaG9zdCB1c2luZyBHZXQtTmV0RG9tYWluLAogICAgICAgIHF1ZXJpZXMgdGhlIGRvbWFpbiBmb3IgYWxsIGFjdGl2ZSBtYWNoaW5lcyB3aXRoIEdldC1OZXRDb21wdXRlciwgdGhlbiBmb3IKICAgICAgICBlYWNoIHNlcnZlciBpdCBjaGVja3MgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgbG9jYWwgYWRtaW5pc3RyYXRvcgogICAgICAgIGFjY2VzcyB1c2luZyBJbnZva2UtQ2hlY2tMb2NhbEFkbWluQWNjZXNzLgoKICAgICAgICBJZGVhIHN0b2xlbiBmcm9tIHRoZSBsb2NhbF9hZG1pbl9zZWFyY2hfZW51bSBwb3N0IG1vZHVsZSBpbgogICAgICAgIE1ldGFzcGxvaXQgd3JpdHRlbiBieToKICAgICAgICAgICAgJ0JyYW5kb24gTWNDYW5uICJ6ZWtub3giIDxibWNjYW5uW2F0XWFjY3V2YW50LmNvbT4nCiAgICAgICAgICAgICdUaG9tYXMgTWNDYXJ0aHkgInNtaWxpbmdyYWNjb29uIiA8c21pbGluZ3JhY2Nvb25bYXRdZ21haWwuY29tPicKICAgICAgICAgICAgJ1JveWNlIERhdmlzICJyM2R5IiA8cmRhdmlzW2F0XWFjY3V2YW50LmNvbT4nCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgTm9QaW5nCgogICAgICAgIFN3aXRjaC4gRG9uJ3QgcGluZyBlYWNoIGhvc3QgdG8gZW5zdXJlIGl0J3MgdXAgYmVmb3JlIGVudW1lcmF0aW5nLgoKICAgIC5QQVJBTUVURVIgRGVsYXkKCiAgICAgICAgRGVsYXkgYmV0d2VlbiBlbnVtZXJhdGluZyBob3N0cywgZGVmYXVsdHMgdG8gMAoKICAgIC5QQVJBTUVURVIgSml0dGVyCgogICAgICAgIEppdHRlciBmb3IgdGhlIGhvc3QgZGVsYXksIGRlZmF1bHRzIHRvICsvLSAwLjMKCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBEb21haW4gdG8gcXVlcnkgZm9yIG1hY2hpbmVzLCBkZWZhdWx0cyB0byB0aGUgY3VycmVudCBkb21haW4uCiAgICAKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgU2VhcmNoRm9yZXN0CgogICAgICAgIFN3aXRjaC4gU2VhcmNoIGFsbCBkb21haW5zIGluIHRoZSBmb3Jlc3QgZm9yIHRhcmdldCB1c2VycyBpbnN0ZWFkIG9mIGp1c3QKICAgICAgICBhIHNpbmdsZSBkb21haW4uCgogICAgLlBBUkFNRVRFUiBUaHJlYWRzCgogICAgICAgIFRoZSBtYXhpbXVtIGNvbmN1cnJlbnQgdGhyZWFkcyB0byBleGVjdXRlLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1Mb2NhbEFkbWluQWNjZXNzCgogICAgICAgIEZpbmQgbWFjaGluZXMgb24gdGhlIGxvY2FsIGRvbWFpbiB3aGVyZSB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbAogICAgICAgIGFkbWluaXN0cmF0b3IgYWNjZXNzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1Mb2NhbEFkbWluQWNjZXNzIC1UaHJlYWRzIDEwCgogICAgICAgIE11bHRpLXRocmVhZGVkIGFjY2VzcyBodW50aW5nLCByZXBsYWNlcyBGaW5kLUxvY2FsQWRtaW5BY2Nlc3NUaHJlYWRlZC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEZpbmQtTG9jYWxBZG1pbkFjY2VzcyAtRG9tYWluIHRlc3RpbmcKCiAgICAgICAgRmluZCBtYWNoaW5lcyBvbiB0aGUgJ3Rlc3RpbmcnIGRvbWFpbiB3aGVyZSB0aGUgY3VycmVudCB1c2VyIGhhcwogICAgICAgIGxvY2FsIGFkbWluaXN0cmF0b3IgYWNjZXNzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gRmluZC1Mb2NhbEFkbWluQWNjZXNzIC1Db21wdXRlckZpbGUgaG9zdHMudHh0CgogICAgICAgIEZpbmQgd2hpY2ggbWFjaGluZXMgaW4gdGhlIGhvc3QgbGlzdCB0aGUgY3VycmVudCB1c2VyIGhhcyBsb2NhbAogICAgICAgIGFkbWluaXN0cmF0b3IgYWNjZXNzLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvbW9kdWxlcy9wb3N0L3dpbmRvd3MvZ2F0aGVyL2xvY2FsX2FkbWluX3NlYXJjaF9lbnVtLnJiCiAgICAgICAgaHR0cDovL3d3dy5oYXJtajB5Lm5ldC9ibG9nL3BlbmV0ZXN0aW5nL2ZpbmRpbmctbG9jYWwtYWRtaW4td2l0aC10aGUtdmVpbC1mcmFtZXdvcmsvCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0cycpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbQWxpYXMoJ0hvc3RMaXN0JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWxlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb1BpbmcsCgogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMCwKCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2VhcmNoRm9yZXN0LAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFRocmVhZHMKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgRmluZC1Mb2NhbEFkbWluQWNjZXNzIHdpdGggZGVsYXkgb2YgJERlbGF5IgogICAgICAgIAogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7CiAgICAgICAgICAgIGlmKCREb21haW4pIHsKICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCgkRG9tYWluKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZigkU2VhcmNoRm9yZXN0KSB7CiAgICAgICAgICAgICAgICAjIGdldCBBTEwgdGhlIGRvbWFpbnMgaW4gdGhlIGZvcmVzdCB0byBzZWFyY2gKICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gR2V0LU5ldEZvcmVzdERvbWFpbiB8IEZvckVhY2gtT2JqZWN0IHsgJF8uTmFtZSB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAjIHVzZSB0aGUgbG9jYWwgZG9tYWluCiAgICAgICAgICAgICAgICAkVGFyZ2V0RG9tYWlucyA9IEAoIChHZXQtTmV0RG9tYWluKS5uYW1lICkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBpZiB3ZSdyZSB1c2luZyBhIGhvc3QgbGlzdCwgcmVhZCB0aGUgdGFyZ2V0cyBpbiBhbmQgYWRkIHRoZW0gdG8gdGhlIHRhcmdldCBsaXN0CiAgICAgICAgICAgIGlmKCRDb21wdXRlckZpbGUpIHsKICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSBHZXQtQ29udGVudCAtUGF0aCAkQ29tcHV0ZXJGaWxlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBbYXJyYXldJENvbXB1dGVyTmFtZSA9IEAoKQogICAgICAgICAgICAgICAgRm9yRWFjaCAoJERvbWFpbiBpbiAkVGFyZ2V0RG9tYWlucykgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBRdWVyeWluZyBkb21haW4gJERvbWFpbiBmb3IgaG9zdHMiCiAgICAgICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSArPSBHZXQtTmV0Q29tcHV0ZXIgLUZpbHRlciAkQ29tcHV0ZXJGaWx0ZXIgLUFEU3BhdGggJENvbXB1dGVyQURTcGF0aCAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyByZW1vdmUgYW55IG51bGwgdGFyZ2V0IGhvc3RzLCB1bmlxdWlmeSB0aGUgbGlzdCBhbmQgc2h1ZmZsZSBpdAogICAgICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyTmFtZSB8IFdoZXJlLU9iamVjdCB7ICRfIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlIHwgU29ydC1PYmplY3QgeyBHZXQtUmFuZG9tIH0KICAgICAgICAgICAgaWYoJCgkQ29tcHV0ZXJOYW1lLkNvdW50KSAtZXEgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIk5vIGhvc3RzIGZvdW5kISIKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBzY3JpcHQgYmxvY2sgdGhhdCBlbnVtZXJhdGVzIGEgc2VydmVyCiAgICAgICAgJEhvc3RFbnVtQmxvY2sgPSB7CiAgICAgICAgICAgIHBhcmFtKCRDb21wdXRlck5hbWUsICRQaW5nKQoKICAgICAgICAgICAgJFVwID0gJFRydWUKICAgICAgICAgICAgaWYoJFBpbmcpIHsKICAgICAgICAgICAgICAgICRVcCA9IFRlc3QtQ29ubmVjdGlvbiAtQ291bnQgMSAtUXVpZXQgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJFVwKSB7CiAgICAgICAgICAgICAgICAjIGNoZWNrIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGxvY2FsIGFkbWluIGFjY2VzcyB0byB0aGlzIHNlcnZlcgogICAgICAgICAgICAgICAgJEFjY2VzcyA9IEludm9rZS1DaGVja0xvY2FsQWRtaW5BY2Nlc3MgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgICAgICBpZiAoJEFjY2VzcykgewogICAgICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBraWNrIG9mZiB0aGUgdGhyZWFkZWQgc2NyaXB0IGJsb2NrICsgYXJndW1lbnRzIAogICAgICAgICAgICBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1TY3JpcHRQYXJhbWV0ZXJzICRTY3JpcHRQYXJhbXMKICAgICAgICB9CgogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZigtbm90ICROb1BpbmcgLWFuZCAoJENvbXB1dGVyTmFtZS5jb3VudCAtbmUgMSkpIHsKICAgICAgICAgICAgICAgICMgcGluZyBhbGwgaG9zdHMgaW4gcGFyYWxsZWwKICAgICAgICAgICAgICAgICRQaW5nID0ge3BhcmFtKCRDb21wdXRlck5hbWUpIGlmKFRlc3QtQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUNvdW50IDEgLVF1aWV0IC1FcnJvckFjdGlvbiBTdG9wKXskQ29tcHV0ZXJOYW1lfX0KICAgICAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSBJbnZva2UtVGhyZWFkZWRGdW5jdGlvbiAtTm9JbXBvcnRzIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJFBpbmcgLVRocmVhZHMgMTAwCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBUb3RhbCBudW1iZXIgb2YgYWN0aXZlIGhvc3RzOiAkKCRDb21wdXRlck5hbWUuY291bnQpIgogICAgICAgICAgICAkQ291bnRlciA9IDAKCiAgICAgICAgICAgIEZvckVhY2ggKCRDb21wdXRlciBpbiAkQ29tcHV0ZXJOYW1lKSB7CgogICAgICAgICAgICAgICAgJENvdW50ZXIgPSAkQ291bnRlciArIDEKCiAgICAgICAgICAgICAgICAjIHNsZWVwIGZvciBvdXIgc2VtaS1yYW5kb21pemVkIGludGVydmFsCiAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIEVudW1lcmF0aW5nIHNlcnZlciAkQ29tcHV0ZXIgKCRDb3VudGVyIG9mICQoJENvbXB1dGVyTmFtZS5jb3VudCkpIgogICAgICAgICAgICAgICAgSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRIb3N0RW51bUJsb2NrIC1Bcmd1bWVudExpc3QgJENvbXB1dGVyLCAkRmFsc2UsICRPdXRGaWxlLCAkRG9tYWluU0lELCAkVHJ1c3RHcm91cHNTSURzCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBHZXQtRXhwbG9pdGFibGVTeXN0ZW0gewo8IwogICAgLlN5bm9wc2lzCgogICAgICAgIFRoaXMgbW9kdWxlIHdpbGwgcXVlcnkgQWN0aXZlIERpcmVjdG9yeSBmb3IgdGhlIGhvc3RuYW1lLCBPUyB2ZXJzaW9uLCBhbmQgc2VydmljZSBwYWNrIGxldmVsICAKICAgICAgICBmb3IgZWFjaCBjb21wdXRlciBhY2NvdW50LiAgVGhhdCBpbmZvcm1hdGlvbiBpcyB0aGVuIGNyb3NzLXJlZmVyZW5jZWQgYWdhaW5zdCBhIGxpc3Qgb2YgY29tbW9uCiAgICAgICAgTWV0YXNwbG9pdCBleHBsb2l0cyB0aGF0IGNhbiBiZSB1c2VkIGR1cmluZyBwZW5ldHJhdGlvbiB0ZXN0aW5nLgoKICAgIC5ERVNDUklQVElPTgoKICAgICAgICBUaGlzIG1vZHVsZSB3aWxsIHF1ZXJ5IEFjdGl2ZSBEaXJlY3RvcnkgZm9yIHRoZSBob3N0bmFtZSwgT1MgdmVyc2lvbiwgYW5kIHNlcnZpY2UgcGFjayBsZXZlbCAgCiAgICAgICAgZm9yIGVhY2ggY29tcHV0ZXIgYWNjb3VudC4gIFRoYXQgaW5mb3JtYXRpb24gaXMgdGhlbiBjcm9zcy1yZWZlcmVuY2VkIGFnYWluc3QgYSBsaXN0IG9mIGNvbW1vbgogICAgICAgIE1ldGFzcGxvaXQgZXhwbG9pdHMgdGhhdCBjYW4gYmUgdXNlZCBkdXJpbmcgcGVuZXRyYXRpb24gdGVzdGluZy4gIFRoZSBzY3JpcHQgZmlsdGVycyBvdXQgZGlzYWJsZWQKICAgICAgICBkb21haW4gY29tcHV0ZXJzIGFuZCBwcm92aWRlcyB0aGUgY29tcHV0ZXIncyBsYXN0IGxvZ29uIHRpbWUgdG8gaGVscCBkZXRlcm1pbmUgaWYgaXQncyBiZWVuIAogICAgICAgIGRlY29tbWlzc2lvbmVkLiAgQWxzbywgc2luY2UgdGhlIHNjcmlwdCB1c2VzIGRhdGEgdGFibGVzIHRvIG91dHB1dCBhZmZlY3RlZCBzeXN0ZW1zIHRoZSByZXN1bHRzCiAgICAgICAgY2FuIGJlIGVhc2lseSBwaXBlZCB0byBvdGhlciBjb21tYW5kcyBzdWNoIGFzIHRlc3QtY29ubmVjdGlvbiBvciBhIEV4cG9ydC1Dc3YuCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgUmV0dXJuIGNvbXB1dGVycyB3aXRoIGEgc3BlY2lmaWMgbmFtZSwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgU1BOCgogICAgICAgIFJldHVybiBjb21wdXRlcnMgd2l0aCBhIHNwZWNpZmljIHNlcnZpY2UgcHJpbmNpcGFsIG5hbWUsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIE9wZXJhdGluZ1N5c3RlbQoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBvcGVyYXRpbmcgc3lzdGVtLCB3aWxkY2FyZHMgYWNjZXB0ZWQuCgogICAgLlBBUkFNRVRFUiBTZXJ2aWNlUGFjawoKICAgICAgICBSZXR1cm4gY29tcHV0ZXJzIHdpdGggYSBzcGVjaWZpYyBzZXJ2aWNlIHBhY2ssIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIEZpbHRlcgoKICAgICAgICBBIGN1c3RvbWl6ZWQgbGRhcCBmaWx0ZXIgc3RyaW5nIHRvIHVzZSwgZS5nLiAiKGRlc2NyaXB0aW9uPSphZG1pbiopIgoKICAgIC5QQVJBTUVURVIgUGluZwoKICAgICAgICBTd2l0Y2guIFBpbmcgZWFjaCBob3N0IHRvIGVuc3VyZSBpdCdzIHVwIGJlZm9yZSBlbnVtZXJhdGluZy4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBUaGUgZG9tYWluIHRvIHF1ZXJ5IGZvciBjb21wdXRlcnMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIEFEU3BhdGgKCiAgICAgICAgVGhlIExEQVAgc291cmNlIHRvIHNlYXJjaCB0aHJvdWdoLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgVW5jb25zdHJhaW5lZAoKICAgICAgICBTd2l0Y2guIFJldHVybiBjb21wdXRlciBvYmplY3RzIHRoYXQgaGF2ZSB1bmNvbnN0cmFpbmVkIGRlbGVnYXRpb24uCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkVYQU1QTEUKICAgICAgIAogICAgICAgIFRoZSBleGFtcGxlIGJlbG93IHNob3dzIHRoZSBzdGFuZGFyZCBjb21tYW5kIHVzYWdlLiAgRGlzYWJsZWQgc3lzdGVtIGFyZSBleGNsdWRlZCBieSBkZWZhdWx0LCBidXQKICAgICAgICB0aGUgIkxhc3RMZ29uIiBjb2x1bW4gY2FuIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoaWNoIHN5c3RlbXMgYXJlIGxpdmUuICBVc3VhbGx5LCBpZiBhIHN5c3RlbSBoYXNuJ3QgCiAgICAgICAgbG9nZ2VkIG9uIGZvciB0d28gb3IgbW9yZSB3ZWVrcyBpdCdzIGJlZW4gZGVjb21taXNzaW9uZWQuICAgICAgCiAgICAgICAgUFMgQzpcPiBHZXQtRXhwbG9pdGFibGVTeXN0ZW0gLURvbWFpbkNvbnRyb2xsZXIgMTkyLjE2OC4xLjEgLUNyZWRlbnRpYWwgZGVtby5jb21cdXNlciB8IEZvcm1hdC1UYWJsZSAtQXV0b1NpemUKICAgICAgICBbKl0gR3JhYmJpbmcgY29tcHV0ZXIgYWNjb3VudHMgZnJvbSBBY3RpdmUgRGlyZWN0b3J5Li4uCiAgICAgICAgWypdIExvYWRpbmcgZXhwbG9pdCBsaXN0IGZvciBjcml0aWNhbCBtaXNzaW5nIHBhdGNoZXMuLi4KICAgICAgICBbKl0gQ2hlY2tpbmcgY29tcHV0ZXJzIGZvciB2dWxuZXJhYmxlIE9TIGFuZCBTUCBsZXZlbHMuLi4KICAgICAgICBbK10gRm91bmQgNSBwb3RlbnRpYWxseSB2dWxuZXJhYmxlIHN5c3RlbXMhCiAgICAgICAgQ29tcHV0ZXJOYW1lICAgICAgICAgIE9wZXJhdGluZ1N5c3RlbSAgICAgICAgIFNlcnZpY2VQYWNrICAgIExhc3RMb2dvbiAgICAgICAgICAgIE1zZk1vZHVsZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1ZFICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIC0tLS0tLS0tLS0tLSAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0gICAgICAgICAtLS0tLS0tLS0tLSAgICAtLS0tLS0tLS0gICAgICAgICAgICAtLS0tLS0tLS0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tLSAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBBRFMuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgNC84LzIwMTUgNTo0Njo1MiBQTSAgZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczA3XzAyOV9tc2Ruc196b25lbmFtZSBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgQURTLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDQvOC8yMDE1IDU6NDY6NTIgUE0gIGV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpICAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIEFEUy5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiA0LzgvMjAxNSA1OjQ2OjUyIFBNICBleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MgICAgICAgICAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBMVkEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgNC84LzIwMTUgMTo0NDo0NiBQTSAgZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczA3XzAyOV9tc2Ruc196b25lbmFtZSBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgTFZBLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDQvOC8yMDE1IDE6NDQ6NDYgUE0gIGV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpICAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIExWQS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiA0LzgvMjAxNSAxOjQ0OjQ2IFBNICBleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MgICAgICAgICAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBhc3Nlc3MteHBwcm8uZGVtby5jb20gV2luZG93cyBYUCBQcm9mZXNzaW9uYWwgU2VydmljZSBQYWNrIDMgNC8xLzIwMTQgMTE6MTE6NTQgQU0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkgICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgYXNzZXNzLXhwcHJvLmRlbW8uY29tIFdpbmRvd3MgWFAgUHJvZmVzc2lvbmFsIFNlcnZpY2UgUGFjayAzIDQvMS8yMDE0IDExOjExOjU0IEFNIGV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIEhWQS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiAxMS81LzIwMTMgOToxNjozMSBQTSBleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDdfMDI5X21zZG5zX3pvbmVuYW1lIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBIVkEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgMTEvNS8yMDEzIDk6MTY6MzEgUE0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkgICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgSFZBLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDExLzUvMjAxMyA5OjE2OjMxIFBNIGV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLgogICAgICAgIERCMS5kZW1vLmNvbSAgICAgICAgICBXaW5kb3dzIFNlcnZlciAyMDAzICAgICBTZXJ2aWNlIFBhY2sgMiAzLzIyLzIwMTIgNTowNTozNCBQTSBleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDdfMDI5X21zZG5zX3pvbmVuYW1lIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy4uLi4KICAgICAgICBEQjEuZGVtby5jb20gICAgICAgICAgV2luZG93cyBTZXJ2ZXIgMjAwMyAgICAgU2VydmljZSBQYWNrIDIgMy8yMi8yMDEyIDU6MDU6MzQgUE0gZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkgICAgICAgICAgICBodHRwOi8vd3d3LmN2ZWRldGFpbHMuLi4uCiAgICAgICAgREIxLmRlbW8uY29tICAgICAgICAgIFdpbmRvd3MgU2VydmVyIDIwMDMgICAgIFNlcnZpY2UgUGFjayAyIDMvMjIvMjAxMiA1OjA1OjM0IFBNIGV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyAgICAgICAgICAgaHR0cDovL3d3dy5jdmVkZXRhaWxzLi4uLiAgICAgICAgICAgICAgICAgICAgIAoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LUV4cGxvaXRhYmxlU3lzdGVtIHwgRXhwb3J0LUNzdiBjOlx0ZW1wXG91dHB1dC5jc3YgLU5vVHlwZUluZm9ybWF0aW9uCgogICAgICAgIEhvdyB0byB3cml0ZSB0aGUgb3V0cHV0IHRvIGEgY3N2IGZpbGUuCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtRXhwbG9pdGFibGVTeXN0ZW0gLURvbWFpbiB0ZXN0bGFiLmxvY2FsIC1QaW5nCgogICAgICAgIFJldHVybiBhIHNldCBvZiBsaXZlIGhvc3RzIGZyb20gdGhlIHRlc3RsYWIubG9jYWwgZG9tYWluCgogICAgIC5MSU5LCiAgICAgICAKICAgICAgIGh0dHA6Ly93d3cubmV0c3BpLmNvbQogICAgICAgaHR0cHM6Ly9naXRodWIuY29tL251bGxiaW5kL1Bvd2Vyc2hlbGxlcnkvYmxvYi9tYXN0ZXIvU3RhYmxlLWlzaC9BRFMvR2V0LUV4cGxvaXRhYmxlU3lzdGVtcy5wc20xCiAgICAgICAKICAgICAuTk9URVMKICAgICAgIAogICAgICAgQXV0aG9yOiAgU2NvdHQgU3V0aGVybGFuZCAtIDIwMTUsIE5ldFNQSQogICAgICAgICAgICAgICAgTW9kaWZpY2F0aW9ucyB0byBpbnRlZ3JhdGUgaW50byBQb3dlclZpZXcgYnkgQGhhcm1qMHkKICAgICAgIFZlcnNpb246IEdldC1FeHBsb2l0YWJsZVN5c3RlbS5wc20xIHYxLjEKICAgICAgIENvbW1lbnRzOiBUaGUgdGVjaG5pcXVlIHVzZWQgdG8gcXVlcnkgTERBUCB3YXMgYmFzZWQgb24gdGhlICJHZXQtQXVkaXREU0NvbXB1dGVyQWNjb3VudCIgCiAgICAgICBmdW5jdGlvbiBmb3VuZCBpbiBDYXJvbHMgUGVyZXoncyBQb3NoU2VjLU1vZCBwcm9qZWN0LiAgVGhlIGdlbmVyYWwgaWRlYSBpcyBiYXNlZCBvZmYgb2YgIAogICAgICAgV2lsbCBTY2hyb2VkZXIncyAiSW52b2tlLUZpbmRWdWxuU3lzdGVtcyIgZnVuY3Rpb24gZnJvbSB0aGUgUG93ZXJWaWV3IHRvb2xraXQuCiM+CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0TmFtZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbXB1dGVyTmFtZSA9ICcqJywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU1BOLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRPcGVyYXRpbmdTeXN0ZW0gPSAnKicsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFNlcnZpY2VQYWNrID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRGaWx0ZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFBpbmcsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQURTcGF0aCwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVW5jb25zdHJhaW5lZCwKCiAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAiWypdIEdyYWJiaW5nIGNvbXB1dGVyIGFjY291bnRzIGZyb20gQWN0aXZlIERpcmVjdG9yeS4uLiIKCiAgICAjIENyZWF0ZSBkYXRhIHRhYmxlIGZvciBob3N0bmFtZXMsIG9zLCBhbmQgc2VydmljZSBwYWNrcyBmcm9tIExEQVAKICAgICRUYWJsZUFkc0NvbXB1dGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVBZHNDb21wdXRlcnMuQ29sdW1ucy5BZGQoJ0hvc3RuYW1lJykgICAgICAgCiAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Db2x1bW5zLkFkZCgnT3BlcmF0aW5nU3lzdGVtJykKICAgICROdWxsID0gJFRhYmxlQWRzQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Db2x1bW5zLkFkZCgnTGFzdExvZ29uJykKCiAgICBHZXQtTmV0Q29tcHV0ZXIgLUZ1bGxEYXRhIEBQU0JvdW5kUGFyYW1ldGVycyB8IEZvckVhY2gtT2JqZWN0IHsKCiAgICAgICAgJEN1cnJlbnRIb3N0ID0gJF8uZG5zaG9zdG5hbWUKICAgICAgICAkQ3VycmVudE9zID0gJF8ub3BlcmF0aW5nc3lzdGVtCiAgICAgICAgJEN1cnJlbnRTcCA9ICRfLm9wZXJhdGluZ3N5c3RlbXNlcnZpY2VwYWNrCiAgICAgICAgJEN1cnJlbnRMYXN0ID0gJF8ubGFzdGxvZ29uCiAgICAgICAgJEN1cnJlbnRVYWMgPSAkXy51c2VyYWNjb3VudGNvbnRyb2wKCiAgICAgICAgJEN1cnJlbnRVYWNCaW4gPSBbY29udmVydF06OlRvU3RyaW5nKCRfLnVzZXJhY2NvdW50Y29udHJvbCwyKQoKICAgICAgICAjIENoZWNrIHRoZSAybmQgdG8gbGFzdCB2YWx1ZSB0byBkZXRlcm1pbmUgaWYgaXRzIGRpc2FibGVkCiAgICAgICAgJERpc2FibGVPZmZzZXQgPSAkQ3VycmVudFVhY0Jpbi5MZW5ndGggLSAyCiAgICAgICAgJEN1cnJlbnREaXNhYmxlZCA9ICRDdXJyZW50VWFjQmluLlN1YnN0cmluZygkRGlzYWJsZU9mZnNldCwxKQoKICAgICAgICAjIEFkZCBjb21wdXRlciB0byBsaXN0IGlmIGl0J3MgZW5hYmxlZAogICAgICAgIGlmICgkQ3VycmVudERpc2FibGVkICAtZXEgMCkgewogICAgICAgICAgICAjIEFkZCBkb21haW4gY29tcHV0ZXIgdG8gZGF0YSB0YWJsZQogICAgICAgICAgICAkTnVsbCA9ICRUYWJsZUFkc0NvbXB1dGVycy5Sb3dzLkFkZCgkQ3VycmVudEhvc3QsJEN1cnJlbnRPUywkQ3VycmVudFNQLCRDdXJyZW50TGFzdCkKICAgICAgICB9CiAgICB9CgogICAgIyBTdGF0dXMgdXNlciAgICAgICAgCiAgICBXcml0ZS1WZXJib3NlICJbKl0gTG9hZGluZyBleHBsb2l0IGxpc3QgZm9yIGNyaXRpY2FsIG1pc3NpbmcgcGF0Y2hlcy4uLiIKCiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgU2V0dXAgZGF0YSB0YWJsZSBmb3IgbGlzdCBvZiBtc2YgZXhwbG9pdHMKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgICMgQ3JlYXRlIGRhdGEgdGFibGUgZm9yIGxpc3Qgb2YgcGF0Y2hlcyBsZXZlbHMgd2l0aCBhIE1TRiBleHBsb2l0CiAgICAkVGFibGVFeHBsb2l0cyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Db2x1bW5zLkFkZCgnT3BlcmF0aW5nU3lzdGVtJykgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdNc2ZNb2R1bGUnKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLkNvbHVtbnMuQWRkKCdDVkUnKQogICAgCiAgICAjIEFkZCBleHBsb2l0cyB0byBkYXRhIHRhYmxlCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIDciLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL2lpcy9tczAzXzAwN19udGRsbF93ZWJkYXYiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAxMDkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczAzXzAyNl9kY29tIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMzUyLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9paXMvbXMwM18wMDdfbnRkbGxfd2ViZGF2IiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMTA5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDVfMDE3X21zbXEiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA1LTAwNTkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3MvaWlzL21zMDNfMDA3X250ZGxsX3dlYmRhdiIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDEwOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczAzXzAyNl9kY29tIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wMzUyLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA3LTE3NDgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDQiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDRfMDExX2xzYXNzIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwMy0wNTMzLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA2Nl9ud2FwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtNDY4OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCJTZXJ2aWNlIFBhY2sgNCIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNzBfd2tzc3ZjIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi00NjkxIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIlNlcnZpY2UgUGFjayA0IiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAwIiwiU2VydmljZSBQYWNrIDQiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMCIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3MvaWlzL21zMDNfMDA3X250ZGxsX3dlYmRhdiIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDEwOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDVfMDM5X3BucCIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMTk4MyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL2RjZXJwYy9tczA3XzAyOV9tc2Ruc196b25lbmFtZSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDctMTc0OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA0MF9uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTM0MzkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNjZfbndhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTQ2ODgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvd2lucy9tczA0XzA0NV93aW5zIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNC0xMDgwLyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwN18wMjlfbXNkbnNfem9uZW5hbWUiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA3LTE3NDgiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDMiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyIsIiIsImV4cGxvaXQvd2luZG93cy93aW5zL21zMDRfMDQ1X3dpbnMiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA0LTEwODAvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwMyBSMiIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA0MF9uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA2LTM0MzkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDAzIFIyIiwiIiwiZXhwbG9pdC93aW5kb3dzL3dpbnMvbXMwNF8wNDVfd2lucyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDQtMTA4MC8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFNlcnZlciAyMDA4IiwiIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA5XzA1MF9zbWIyX25lZ290aWF0ZV9mdW5jX2luZGV4IiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOS0zMTAzIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBTZXJ2ZXIgMjAwOCIsIiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgU2VydmVyIDIwMDggUjIiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFZpc3RhIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOF8wNjdfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwOC00MjUwIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBWaXN0YSIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFZpc3RhIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwOV8wNTBfc21iMl9uZWdvdGlhdGVfZnVuY19pbmRleCIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDktMzEwMyIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgVmlzdGEiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDlfMDUwX3NtYjJfbmVnb3RpYXRlX2Z1bmNfaW5kZXgiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA5LTMxMDMiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwM18wMjZfZGNvbSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDM1Mi8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2ZXIgUGFjayAxIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA0XzAxMV9sc2FzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDMtMDUzMy8iKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmVyIFBhY2sgMSIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNV8wMzlfcG5wIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNS0xOTgzIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZlciBQYWNrIDEiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDZfMDQwX25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtMzQzOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNDBfbmV0YXBpIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi0zNDM5IikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA2XzA2Nl9ud2FwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtNDY4OCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMiIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMwNl8wNzBfd2tzc3ZjIiwiaHR0cDovL3d3dy5jdmVkZXRhaWxzLmNvbS9jdmUvMjAwNi00NjkxIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIlNlcnZpY2UgUGFjayAyIiwiZXhwbG9pdC93aW5kb3dzL3NtYi9tczA4XzA2N19uZXRhcGkiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDA4LTQyNTAiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmljZSBQYWNrIDIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMTBfMDYxX3Nwb29sc3MiLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDEwLTI3MjkiKSAgCiAgICAkTnVsbCA9ICRUYWJsZUV4cGxvaXRzLlJvd3MuQWRkKCJXaW5kb3dzIFhQIiwiU2VydmljZSBQYWNrIDMiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCJTZXJ2aWNlIFBhY2sgMyIsImV4cGxvaXQvd2luZG93cy9zbWIvbXMxMF8wNjFfc3Bvb2xzcyIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMTAtMjcyOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3MvZGNlcnBjL21zMDNfMDI2X2Rjb20iLCJodHRwOi8vd3d3LmN2ZWRldGFpbHMuY29tL2N2ZS8yMDAzLTAzNTIvIikgIAogICAgJE51bGwgPSAkVGFibGVFeHBsb2l0cy5Sb3dzLkFkZCgiV2luZG93cyBYUCIsIiIsImV4cGxvaXQvd2luZG93cy9kY2VycGMvbXMwNV8wMTdfbXNtcSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDUtMDA1OSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDZfMDQwX25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDYtMzQzOSIpICAKICAgICROdWxsID0gJFRhYmxlRXhwbG9pdHMuUm93cy5BZGQoIldpbmRvd3MgWFAiLCIiLCJleHBsb2l0L3dpbmRvd3Mvc21iL21zMDhfMDY3X25ldGFwaSIsImh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlLzIwMDgtNDI1MCIpICAKCiAgICAjIFN0YXR1cyB1c2VyICAgICAgICAKICAgIFdyaXRlLVZlcmJvc2UgIlsqXSBDaGVja2luZyBjb21wdXRlcnMgZm9yIHZ1bG5lcmFibGUgT1MgYW5kIFNQIGxldmVscy4uLiIKCiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgU2V0dXAgZGF0YSB0YWJsZSB0byBzdG9yZSB2dWxuZXJhYmxlIHN5c3RlbXMKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgICMgQ3JlYXRlIGRhdGEgdGFibGUgdG8gaG91c2UgdnVsbmVyYWJsZSBzZXJ2ZXIgbGlzdAogICAgJFRhYmxlVnVsbkNvbXB1dGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVRhYmxlIAogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdDb21wdXRlck5hbWUnKQogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdPcGVyYXRpbmdTeXN0ZW0nKQogICAgJE51bGwgPSAkVGFibGVWdWxuQ29tcHV0ZXJzLkNvbHVtbnMuQWRkKCdTZXJ2aWNlUGFjaycpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ0xhc3RMb2dvbicpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ01zZk1vZHVsZScpCiAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuQ29sdW1ucy5BZGQoJ0NWRScpCgogICAgIyBJdGVyYXRlIHRocm91Z2ggZWFjaCBleHBsb2l0CiAgICAkVGFibGVFeHBsb2l0cyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAKICAgICAgICAkRXhwbG9pdE9TID0gJF8uT3BlcmF0aW5nU3lzdGVtCiAgICAgICAgJEV4cGxvaXRTUCA9ICRfLlNlcnZpY2VQYWNrCiAgICAgICAgJEV4cGxvaXRNc2YgPSAkXy5Nc2ZNb2R1bGUKICAgICAgICAkRXhwbG9pdENWRSA9ICRfLkNWRQoKICAgICAgICAjIEl0ZXJhdGUgdGhyb3VnaCBlYWNoIEFEUyBjb21wdXRlcgogICAgICAgICRUYWJsZUFkc0NvbXB1dGVycyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgCiAgICAgICAgICAgICRBZHNIb3N0bmFtZSA9ICRfLkhvc3RuYW1lCiAgICAgICAgICAgICRBZHNPUyA9ICRfLk9wZXJhdGluZ1N5c3RlbQogICAgICAgICAgICAkQWRzU1AgPSAkXy5TZXJ2aWNlUGFjayAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICRBZHNMYXN0ID0gJF8uTGFzdExvZ29uCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEFkZCBleHBsb2l0YWJsZSBzeXN0ZW1zIHRvIHZ1bCBjb21wdXRlcnMgZGF0YSB0YWJsZQogICAgICAgICAgICBpZiAoJEFkc09TIC1saWtlICIkRXhwbG9pdE9TKiIgLWFuZCAkQWRzU1AgLWxpa2UgIiRFeHBsb2l0U1AiICkgeyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIEFkZCBkb21haW4gY29tcHV0ZXIgdG8gZGF0YSB0YWJsZSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkTnVsbCA9ICRUYWJsZVZ1bG5Db21wdXRlcnMuUm93cy5BZGQoJEFkc0hvc3RuYW1lLCRBZHNPUywkQWRzU1AsJEFkc0xhc3QsJEV4cGxvaXRNc2YsJEV4cGxvaXRDVkUpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9ICAgICAKICAgIAogICAgIyBEaXNwbGF5IHJlc3VsdHMKICAgICRWdWxuQ29tcHV0ZXIgPSAkVGFibGVWdWxuQ29tcHV0ZXJzIHwgU2VsZWN0LU9iamVjdCBDb21wdXRlck5hbWUgLVVuaXF1ZSB8IE1lYXN1cmUtT2JqZWN0CiAgICAkVnVsbkNvbXB1dGVyQ291bnQgPSAkVnVsbkNvbXB1dGVyLkNvdW50CiAgICBpZiAoJFZ1bG5Db21wdXRlci5Db3VudCAtZ3QgMCkgewogICAgICAgICMgUmV0dXJuIHZ1bG5lcmFibGUgc2VydmVyIGxpc3Qgb3JkZXIgd2l0aCBzb21lIGhhY2sgZGF0ZSBjYXN0aW5nCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWytdIEZvdW5kICRWdWxuQ29tcHV0ZXJDb3VudCBwb3RlbnRpYWxseSB2dWxuZXJhYmxlIHN5c3RlbXMhIgogICAgICAgICRUYWJsZVZ1bG5Db21wdXRlcnMgfCBTb3J0LU9iamVjdCB7ICRfLmxhc3Rsb2dvbiAtYXMgW2RhdGV0aW1lXX0gLURlc2NlbmRpbmcKICAgIH0KICAgIGVsc2UgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlstXSBObyB2dWxuZXJhYmxlIHN5c3RlbXMgd2VyZSBmb3VuZC4iCiAgICB9Cn0KCgpmdW5jdGlvbiBJbnZva2UtRW51bWVyYXRlTG9jYWxBZG1pbiB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgVGhpcyBmdW5jdGlvbiBxdWVyaWVzIHRoZSBkb21haW4gZm9yIGFsbCBhY3RpdmUgbWFjaGluZXMgd2l0aAogICAgICAgIEdldC1OZXRDb21wdXRlciwgdGhlbiBmb3IgZWFjaCBzZXJ2ZXIgaXQgcXVlcmllcyB0aGUgbG9jYWwKICAgICAgICBBZG1pbmlzdHJhdG9ycyB3aXRoIEdldC1OZXRMb2NhbEdyb3VwLgoKICAgICAgICBBdXRob3I6IEBoYXJtajB5CiAgICAgICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCgogICAgLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKCiAgICAgICAgSG9zdCBhcnJheSB0byBlbnVtZXJhdGUsIHBhc3NhYmxlIG9uIHRoZSBwaXBlbGluZS4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyRmlsZQoKICAgICAgICBGaWxlIG9mIGhvc3RuYW1lcy9JUHMgdG8gc2VhcmNoLgoKICAgIC5QQVJBTUVURVIgQ29tcHV0ZXJGaWx0ZXIKCiAgICAgICAgSG9zdCBmaWx0ZXIgbmFtZSB0byBxdWVyeSBBRCBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIENvbXB1dGVyQURTcGF0aAoKICAgICAgICBUaGUgTERBUCBzb3VyY2UgdG8gc2VhcmNoIHRocm91Z2ggZm9yIGhvc3RzLCBlLmcuICJMREFQOi8vT1U9c2VjcmV0LERDPXRlc3RsYWIsREM9bG9jYWwiCiAgICAgICAgVXNlZnVsIGZvciBPVSBxdWVyaWVzLgoKICAgIC5QQVJBTUVURVIgTm9QaW5nCgogICAgICAgIFN3aXRjaC4gRG9uJ3QgcGluZyBlYWNoIGhvc3QgdG8gZW5zdXJlIGl0J3MgdXAgYmVmb3JlIGVudW1lcmF0aW5nLgoKICAgIC5QQVJBTUVURVIgRGVsYXkKCiAgICAgICAgRGVsYXkgYmV0d2VlbiBlbnVtZXJhdGluZyBob3N0cywgZGVmYXVsdHMgdG8gMAoKICAgIC5QQVJBTUVURVIgSml0dGVyCgogICAgICAgIEppdHRlciBmb3IgdGhlIGhvc3QgZGVsYXksIGRlZmF1bHRzIHRvICsvLSAwLjMKCiAgICAuUEFSQU1FVEVSIE91dEZpbGUKCiAgICAgICAgT3V0cHV0IHJlc3VsdHMgdG8gYSBzcGVjaWZpZWQgY3N2IG91dHB1dCBmaWxlLgoKICAgIC5QQVJBTUVURVIgTm9DbG9iYmVyCgogICAgICAgIFN3aXRjaC4gRG9uJ3Qgb3ZlcndyaXRlIGFueSBleGlzdGluZyBvdXRwdXQgZmlsZS4KCiAgICAuUEFSQU1FVEVSIFRydXN0R3JvdXBzCgogICAgICAgIFN3aXRjaC4gT25seSByZXR1cm4gcmVzdWx0cyB0aGF0IGFyZSBub3QgcGFydCBvZiB0aGUgbG9jYWwgbWFjaGluZQogICAgICAgIG9yIHRoZSBtYWNoaW5lJ3MgZG9tYWluLiBPbGQgSW52b2tlLUVudW1lcmF0ZUxvY2FsVHJ1c3RHcm91cAogICAgICAgIGZ1bmN0aW9uYWxpdHkuCgogICAgLlBBUkFNRVRFUiBEb21haW4KCiAgICAgICAgRG9tYWluIHRvIHF1ZXJ5IGZvciBtYWNoaW5lcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgogICAgCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIFNlYXJjaEZvcmVzdAoKICAgICAgICBTd2l0Y2guIFNlYXJjaCBhbGwgZG9tYWlucyBpbiB0aGUgZm9yZXN0IGZvciB0YXJnZXQgdXNlcnMgaW5zdGVhZCBvZiBqdXN0CiAgICAgICAgYSBzaW5nbGUgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgVGhyZWFkcwoKICAgICAgICBUaGUgbWF4aW11bSBjb25jdXJyZW50IHRocmVhZHMgdG8gZXhlY3V0ZS4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluCgogICAgICAgIEVudW1lcmF0ZXMgdGhlIG1lbWJlcnMgb2YgbG9jYWwgYWRtaW5pc3RyYXRvcnMgZm9yIGFsbCBtYWNoaW5lcwogICAgICAgIGluIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluIC1UaHJlYWRzIDEwCgogICAgICAgIFRocmVhZGVkIGxvY2FsIGFkbWluIGVudW1lcmF0aW9uLCByZXBsYWNlcyBJbnZva2UtRW51bWVyYXRlTG9jYWxBZG1pblRocmVhZGVkCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL2Jsb2cuaGFybWoweS5uZXQvCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kVHJ1ZSldCiAgICAgICAgW0FsaWFzKCdIb3N0cycpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAtUGF0aCAkXyB9KV0KICAgICAgICBbQWxpYXMoJ0hvc3RMaXN0JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJGaWxlLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICRDb21wdXRlckZpbHRlciwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJBRFNwYXRoLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICROb1BpbmcsCgogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMCwKCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE91dEZpbGUsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJE5vQ2xvYmJlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkVHJ1c3RHcm91cHMsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiwKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2VhcmNoRm9yZXN0LAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMCldIAogICAgICAgIFtJbnRdCiAgICAgICAgJFRocmVhZHMKICAgICkKCiAgICBiZWdpbiB7CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRGVidWcnXSkgewogICAgICAgICAgICAkRGVidWdQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgIH0KCiAgICAgICAgIyByYW5kb20gb2JqZWN0IGZvciBkZWxheQogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFJ1bm5pbmcgSW52b2tlLUVudW1lcmF0ZUxvY2FsQWRtaW4gd2l0aCBkZWxheSBvZiAkRGVsYXkiCgogICAgICAgIGlmKCEkQ29tcHV0ZXJOYW1lKSB7IAoKICAgICAgICAgICAgaWYoJERvbWFpbikgewogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBAKCREb21haW4pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRTZWFyY2hGb3Jlc3QpIHsKICAgICAgICAgICAgICAgICMgZ2V0IEFMTCB0aGUgZG9tYWlucyBpbiB0aGUgZm9yZXN0IHRvIHNlYXJjaAogICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbnMgPSBHZXQtTmV0Rm9yZXN0RG9tYWluIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5OYW1lIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgdXNlIHRoZSBsb2NhbCBkb21haW4KICAgICAgICAgICAgICAgICRUYXJnZXREb21haW5zID0gQCggKEdldC1OZXREb21haW4pLm5hbWUgKQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGlmIHdlJ3JlIHVzaW5nIGEgaG9zdCBsaXN0LCByZWFkIHRoZSB0YXJnZXRzIGluIGFuZCBhZGQgdGhlbSB0byB0aGUgdGFyZ2V0IGxpc3QKICAgICAgICAgICAgaWYoJENvbXB1dGVyRmlsZSkgewogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEdldC1Db250ZW50IC1QYXRoICRDb21wdXRlckZpbGUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFthcnJheV0kQ29tcHV0ZXJOYW1lID0gQCgpCiAgICAgICAgICAgICAgICBGb3JFYWNoICgkRG9tYWluIGluICRUYXJnZXREb21haW5zKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFF1ZXJ5aW5nIGRvbWFpbiAkRG9tYWluIGZvciBob3N0cyIKICAgICAgICAgICAgICAgICAgICAkQ29tcHV0ZXJOYW1lICs9IEdldC1OZXRDb21wdXRlciAtRmlsdGVyICRDb21wdXRlckZpbHRlciAtQURTcGF0aCAkQ29tcHV0ZXJBRFNwYXRoIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlcgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIHJlbW92ZSBhbnkgbnVsbCB0YXJnZXQgaG9zdHMsIHVuaXF1aWZ5IHRoZSBsaXN0IGFuZCBzaHVmZmxlIGl0CiAgICAgICAgICAgICRDb21wdXRlck5hbWUgPSAkQ29tcHV0ZXJOYW1lIHwgV2hlcmUtT2JqZWN0IHsgJF8gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUgfCBTb3J0LU9iamVjdCB7IEdldC1SYW5kb20gfQogICAgICAgICAgICBpZigkKCRDb21wdXRlck5hbWUuQ291bnQpIC1lcSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiTm8gaG9zdHMgZm91bmQhIgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGRlbGV0ZSBhbnkgZXhpc3Rpbmcgb3V0cHV0IGZpbGUgaWYgaXQgYWxyZWFkeSBleGlzdHMKICAgICAgICBpZighJE5vQ2xvYmJlcikgewogICAgICAgICAgICBpZiAoJE91dEZpbGUgLWFuZCAoVGVzdC1QYXRoIC1QYXRoICRPdXRGaWxlKSkgeyBSZW1vdmUtSXRlbSAtUGF0aCAkT3V0RmlsZSB9CiAgICAgICAgfQoKICAgICAgICBpZigkVHJ1c3RHcm91cHMpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkRldGVybWluaW5nIGRvbWFpbiB0cnVzdCBncm91cHMiCgogICAgICAgICAgICAjIGZpbmQgYWxsIGdyb3VwIG5hbWVzIHRoYXQgaGF2ZSBvbmUgb3IgbW9yZSB1c2VycyBpbiBhbm90aGVyIGRvbWFpbgogICAgICAgICAgICAkVHJ1c3RHcm91cE5hbWVzID0gRmluZC1Gb3JlaWduR3JvdXAgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Hcm91cE5hbWUgfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKCiAgICAgICAgICAgICRUcnVzdEdyb3Vwc1NJRHMgPSAkVHJ1c3RHcm91cE5hbWVzIHwgRm9yRWFjaC1PYmplY3QgeyAKICAgICAgICAgICAgICAgICMgaWdub3JlIHRoZSBidWlsdGluIGFkbWluaXN0cmF0b3JzIGdyb3VwIGZvciBhIERDIChTLTEtNS0zMi01NDQpCiAgICAgICAgICAgICAgICAjIFRPRE86IGlnbm9yZSBhbGwgZGVmYXVsdCBidWlsdCBpbiBzaWRzPwogICAgICAgICAgICAgICAgR2V0LU5ldEdyb3VwIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtR3JvdXBOYW1lICRfIC1GdWxsRGF0YSB8IFdoZXJlLU9iamVjdCB7ICRfLm9iamVjdHNpZCAtbm90bWF0Y2ggIlMtMS01LTMyLTU0NCIgfSB8IEZvckVhY2gtT2JqZWN0IHsgJF8ub2JqZWN0c2lkIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBxdWVyeSBmb3IgdGhlIHByaW1hcnkgZG9tYWluIGNvbnRyb2xsZXIgc28gd2UgY2FuIGV4dHJhY3QgdGhlIGRvbWFpbiBTSUQgZm9yIGZpbHRlcmluZwogICAgICAgICAgICAkRG9tYWluU0lEID0gR2V0LURvbWFpblNJRCAtRG9tYWluICREb21haW4KICAgICAgICB9CgogICAgICAgICMgc2NyaXB0IGJsb2NrIHRoYXQgZW51bWVyYXRlcyBhIHNlcnZlcgogICAgICAgICRIb3N0RW51bUJsb2NrID0gewogICAgICAgICAgICBwYXJhbSgkQ29tcHV0ZXJOYW1lLCAkUGluZywgJE91dEZpbGUsICREb21haW5TSUQsICRUcnVzdEdyb3Vwc1NJRHMpCgogICAgICAgICAgICAjIG9wdGlvbmFsbHkgY2hlY2sgaWYgdGhlIHNlcnZlciBpcyB1cCBmaXJzdAogICAgICAgICAgICAkVXAgPSAkVHJ1ZQogICAgICAgICAgICBpZigkUGluZykgewogICAgICAgICAgICAgICAgJFVwID0gVGVzdC1Db25uZWN0aW9uIC1Db3VudCAxIC1RdWlldCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkVXApIHsKICAgICAgICAgICAgICAgICMgZ3JhYiB0aGUgdXNlcnMgZm9yIHRoZSBsb2NhbCBhZG1pbnMgb24gdGhpcyBzZXJ2ZXIKICAgICAgICAgICAgICAgICRMb2NhbEFkbWlucyA9IEdldC1OZXRMb2NhbEdyb3VwIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZQoKICAgICAgICAgICAgICAgICMgaWYgd2UganVzdCB3YW50IHRvIHJldHVybiBjcm9zcy10cnVzdCB1c2VycwogICAgICAgICAgICAgICAgaWYoJERvbWFpblNJRCAtYW5kICRUcnVzdEdyb3VwU0lEUykgewogICAgICAgICAgICAgICAgICAgICMgZ2V0IHRoZSBsb2NhbCBtYWNoaW5lIFNJRAogICAgICAgICAgICAgICAgICAgICRMb2NhbFNJRCA9ICgkTG9jYWxBZG1pbnMgfCBXaGVyZS1PYmplY3QgeyAkXy5TSUQgLW1hdGNoICcuKi01MDAkJyB9KS5TSUQgLXJlcGxhY2UgIi01MDAkIgoKICAgICAgICAgICAgICAgICAgICAjIGZpbHRlciBvdXQgYWNjb3VudHMgdGhhdCBiZWdpbiB3aXRoIHRoZSBtYWNoaW5lIFNJRCBhbmQgZG9tYWluIFNJRAogICAgICAgICAgICAgICAgICAgICMgICBidXQgcHJlc2VydmUgYW55IGdyb3VwcyB0aGF0IGhhdmUgdXNlcnMgYWNyb3NzIGEgdHJ1c3QgKCRUcnVzdEdyb3VwU0lEUykKICAgICAgICAgICAgICAgICAgICAkTG9jYWxBZG1pbnMgPSAkTG9jYWxBZG1pbnMgfCBXaGVyZS1PYmplY3QgeyAoJFRydXN0R3JvdXBzU0lEcyAtY29udGFpbnMgJF8uU0lEKSAtb3IgKCgtbm90ICRfLlNJRC5zdGFydHNXaXRoKCRMb2NhbFNJRCkpIC1hbmQgKC1ub3QgJF8uU0lELnN0YXJ0c1dpdGgoJERvbWFpblNJRCkpKSB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYoJExvY2FsQWRtaW5zIC1hbmQgKCRMb2NhbEFkbWlucy5MZW5ndGggLW5lIDApKSB7CiAgICAgICAgICAgICAgICAgICAgIyBvdXRwdXQgdGhlIHJlc3VsdHMgdG8gYSBjc3YgaWYgc3BlY2lmaWVkCiAgICAgICAgICAgICAgICAgICAgaWYoJE91dEZpbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsQWRtaW5zIHwgRXhwb3J0LVBvd2VyVmlld0NTViAtT3V0RmlsZSAkT3V0RmlsZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2UgcmV0dXJuIHRoZSB1c2VyIG9iamVjdHMKICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsQWRtaW5zCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyFdIE5vIHVzZXJzIHJldHVybmVkIGZyb20gJFNlcnZlciIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9CgogICAgcHJvY2VzcyB7CgogICAgICAgIGlmKCRUaHJlYWRzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzaW5nIHRocmVhZGluZyB3aXRoIHRocmVhZHMgPSAkVGhyZWFkcyIKCiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgdGhyZWFkaW5nLCBraWNrIG9mZiB0aGUgc2NyaXB0IGJsb2NrIHdpdGggSW52b2tlLVRocmVhZGVkRnVuY3Rpb24KICAgICAgICAgICAgJFNjcmlwdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAnUGluZycgPSAkKC1ub3QgJE5vUGluZykKICAgICAgICAgICAgICAgICdPdXRGaWxlJyA9ICRPdXRGaWxlCiAgICAgICAgICAgICAgICAnRG9tYWluU0lEJyA9ICREb21haW5TSUQKICAgICAgICAgICAgICAgICdUcnVzdEdyb3Vwc1NJRHMnID0gJFRydXN0R3JvdXBzU0lEcwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGtpY2sgb2ZmIHRoZSB0aHJlYWRlZCBzY3JpcHQgYmxvY2sgKyBhcmd1bWVudHMgCiAgICAgICAgICAgIEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLVNjcmlwdFBhcmFtZXRlcnMgJFNjcmlwdFBhcmFtcwogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKC1ub3QgJE5vUGluZyAtYW5kICgkQ29tcHV0ZXJOYW1lLmNvdW50IC1uZSAxKSkgewogICAgICAgICAgICAgICAgIyBwaW5nIGFsbCBob3N0cyBpbiBwYXJhbGxlbAogICAgICAgICAgICAgICAgJFBpbmcgPSB7cGFyYW0oJENvbXB1dGVyTmFtZSkgaWYoVGVzdC1Db25uZWN0aW9uIC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtQ291bnQgMSAtUXVpZXQgLUVycm9yQWN0aW9uIFN0b3ApeyRDb21wdXRlck5hbWV9fQogICAgICAgICAgICAgICAgJENvbXB1dGVyTmFtZSA9IEludm9rZS1UaHJlYWRlZEZ1bmN0aW9uIC1Ob0ltcG9ydHMgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1TY3JpcHRCbG9jayAkUGluZyAtVGhyZWFkcyAxMDAKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWypdIFRvdGFsIG51bWJlciBvZiBhY3RpdmUgaG9zdHM6ICQoJENvbXB1dGVyTmFtZS5jb3VudCkiCiAgICAgICAgICAgICRDb3VudGVyID0gMAoKICAgICAgICAgICAgRm9yRWFjaCAoJENvbXB1dGVyIGluICRDb21wdXRlck5hbWUpIHsKCiAgICAgICAgICAgICAgICAkQ291bnRlciA9ICRDb3VudGVyICsgMQoKICAgICAgICAgICAgICAgICMgc2xlZXAgZm9yIG91ciBzZW1pLXJhbmRvbWl6ZWQgaW50ZXJ2YWwKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSYW5kTm8uTmV4dCgoMS0kSml0dGVyKSokRGVsYXksICgxKyRKaXR0ZXIpKiREZWxheSkKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbKl0gRW51bWVyYXRpbmcgc2VydmVyICRDb21wdXRlciAoJENvdW50ZXIgb2YgJCgkQ29tcHV0ZXJOYW1lLmNvdW50KSkiCiAgICAgICAgICAgICAgICBJbnZva2UtQ29tbWFuZCAtU2NyaXB0QmxvY2sgJEhvc3RFbnVtQmxvY2sgLUFyZ3VtZW50TGlzdCAkQ29tcHV0ZXIsICRGYWxzZSwgJE91dEZpbGUsICREb21haW5TSUQsICRUcnVzdEdyb3Vwc1NJRHMKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBEb21haW4gdHJ1c3QgZnVuY3Rpb25zIGJlbG93LgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtTmV0RG9tYWluVHJ1c3Qgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFJldHVybiBhbGwgZG9tYWluIHRydXN0cyBmb3IgdGhlIGN1cnJlbnQgZG9tYWluIG9yCiAgICAgICAgYSBzcGVjaWZpZWQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIFRoZSBkb21haW4gd2hvc2UgdHJ1c3RzIHRvIGVudW1lcmF0ZSwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZW51bWVyYXRlIHRoZSB0cnVzdHMgaW5zdGVhZCBvZiBkaXJlY3QgZG9tYWluIGNvbm5lY3Rpb25zLiAKICAgICAgICBNb3JlIGxpa2VseSB0byBnZXQgYXJvdW5kIG5ldHdvcmsgc2VnbWVudGF0aW9uLCBidXQgbm90IGFzIGFjY3VyYXRlLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldERvbWFpblRydXN0CgogICAgICAgIFJldHVybiBkb21haW4gdHJ1c3RzIGZvciB0aGUgY3VycmVudCBkb21haW4uCgogICAgLkVYQU1QTEUKCiAgICAgICAgUFMgQzpcPiBHZXQtTmV0RG9tYWluVHJ1c3QgLURvbWFpbiAicHJvZC50ZXN0bGFiLmxvY2FsIgoKICAgICAgICBSZXR1cm4gZG9tYWluIHRydXN0cyBmb3IgdGhlICJwcm9kLnRlc3RsYWIubG9jYWwiIGRvbWFpbi4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXREb21haW5UcnVzdCAtRG9tYWluICJwcm9kLnRlc3RsYWIubG9jYWwiIC1Eb21haW5Db250cm9sbGVyICJQUklNQVJZLnRlc3RsYWIubG9jYWwiCgogICAgICAgIFJldHVybiBkb21haW4gdHJ1c3RzIGZvciB0aGUgInByb2QudGVzdGxhYi5sb2NhbCIgZG9tYWluLCByZWZsZWN0aW5nCiAgICAgICAgcXVlcmllcyB0aHJvdWdoIHRoZSAiUHJpbWFyeS50ZXN0bGFiLmxvY2FsIiBkb21haW4gY29udHJvbGxlcgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbiA9IChHZXQtTmV0RG9tYWluKS5OYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRMREFQLAoKICAgICAgICBbVmFsaWRhdGVSYW5nZSgxLDEwMDAwKV0gCiAgICAgICAgW0ludF0KICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBpZigkTERBUCAtb3IgJERvbWFpbkNvbnRyb2xsZXIpIHsKCiAgICAgICAgICAgICRUcnVzdFNlYXJjaGVyID0gR2V0LURvbWFpblNlYXJjaGVyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplCgogICAgICAgICAgICBpZigkVHJ1c3RTZWFyY2hlcikgewoKICAgICAgICAgICAgICAgICRUcnVzdFNlYXJjaGVyLmZpbHRlciA9ICcoJihvYmplY3RDbGFzcz10cnVzdGVkRG9tYWluKSknCgogICAgICAgICAgICAgICAgJFRydXN0U2VhcmNoZXIuRmluZEFsbCgpIHwgV2hlcmUtT2JqZWN0IHskX30gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJFByb3BzID0gJF8uUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAkVHJ1c3RBdHRyaWIgPSBTd2l0Y2ggKCRQcm9wcy50cnVzdGF0dHJpYnV0ZXMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAweDAwMSB7ICJub25fdHJhbnNpdGl2ZSIgfQogICAgICAgICAgICAgICAgICAgICAgICAweDAwMiB7ICJ1cGxldmVsX29ubHkiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMHgwMDQgeyAicXVhcmFudGluZWRfZG9tYWluIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDA4IHsgImZvcmVzdF90cmFuc2l0aXZlIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDEwIHsgImNyb3NzX29yZ2FuaXphdGlvbiIgfQogICAgICAgICAgICAgICAgICAgICAgICAweDAyMCB7ICJ3aXRoaW5fZm9yZXN0IiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDQwIHsgInRyZWF0X2FzX2V4dGVybmFsIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDB4MDgwIHsgInRydXN0X3VzZXNfcmM0X2VuY3J5cHRpb24iIH0KICAgICAgICAgICAgICAgICAgICAgICAgMHgxMDAgeyAidHJ1c3RfdXNlc19hZXNfa2V5cyIgfQogICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0IHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJVbmtub3duIHRydXN0IGF0dHJpYnV0ZTogJCgkUHJvcHMudHJ1c3RhdHRyaWJ1dGVzKSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJCgkUHJvcHMudHJ1c3RhdHRyaWJ1dGVzKSI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJERpcmVjdGlvbiA9IFN3aXRjaCAoJFByb3BzLnRydXN0ZGlyZWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDAgeyAiRGlzYWJsZWQiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMSB7ICJJbmJvdW5kIiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDIgeyAiT3V0Ym91bmQiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMyB7ICJCaWRpcmVjdGlvbmFsIiB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRPYmplY3RHdWlkID0gTmV3LU9iamVjdCBHdWlkIEAoLCRQcm9wcy5vYmplY3RndWlkWzBdKQogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdTb3VyY2VOYW1lJyAkRG9tYWluCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RhcmdldE5hbWUnICRQcm9wcy5uYW1lWzBdCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ09iamVjdEd1aWQnICJ7JE9iamVjdEd1aWR9IgogICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdUcnVzdFR5cGUnICIkVHJ1c3RBdHRyaWIiCiAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RydXN0RGlyZWN0aW9uJyAiJERpcmVjdGlvbiIKICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICMgaWYgd2UncmUgdXNpbmcgZGlyZWN0IGRvbWFpbiBjb25uZWN0aW9ucwogICAgICAgICAgICAkRm91bmREb21haW4gPSBHZXQtTmV0RG9tYWluIC1Eb21haW4gJERvbWFpbgogICAgICAgICAgICAKICAgICAgICAgICAgaWYoJEZvdW5kRG9tYWluKSB7CiAgICAgICAgICAgICAgICAoR2V0LU5ldERvbWFpbiAtRG9tYWluICREb21haW4pLkdldEFsbFRydXN0UmVsYXRpb25zaGlwcygpCiAgICAgICAgICAgIH0gICAgIAogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1OZXRGb3Jlc3RUcnVzdCB7CjwjCiAgICAuU1lOT1BTSVMKCiAgICAgICAgUmV0dXJuIGFsbCB0cnVzdHMgZm9yIHRoZSBjdXJyZW50IGZvcmVzdC4KCiAgICAuUEFSQU1FVEVSIEZvcmVzdAoKICAgICAgICBSZXR1cm4gdHJ1c3RzIGZvciB0aGUgc3BlY2lmaWVkIGZvcmVzdC4KCiAgICAuRVhBTVBMRQoKICAgICAgICBQUyBDOlw+IEdldC1OZXRGb3Jlc3RUcnVzdAoKICAgICAgICBSZXR1cm4gY3VycmVudCBmb3Jlc3QgdHJ1c3RzLgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gR2V0LU5ldEZvcmVzdFRydXN0IC1Gb3Jlc3QgInRlc3QiCgogICAgICAgIFJldHVybiB0cnVzdHMgZm9yIHRoZSAidGVzdCIgZm9yZXN0LgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsVmFsdWVGcm9tUGlwZWxpbmU9JFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZvcmVzdAogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgICRGb3VuZEZvcmVzdCA9IEdldC1OZXRGb3Jlc3QgLUZvcmVzdCAkRm9yZXN0CiAgICAgICAgaWYoJEZvdW5kRm9yZXN0KSB7CiAgICAgICAgICAgICRGb3VuZEZvcmVzdC5HZXRBbGxUcnVzdFJlbGF0aW9uc2hpcHMoKQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtRm9yZWlnblVzZXIgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIEVudW1lcmF0ZXMgdXNlcnMgd2hvIGFyZSBpbiBncm91cHMgb3V0c2lkZSBvZiB0aGVpcgogICAgICAgIHByaW5jaXBhbCBkb21haW4uIFRoZSAtUmVjdXJzZSBvcHRpb24gd2lsbCB0cnkgdG8gbWFwIGFsbCAKICAgICAgICB0cmFuc2l0aXZlIGRvbWFpbiB0cnVzdCByZWxhdGlvbnNoaXBzIGFuZCBlbnVtZXJhdGUgYWxsIAogICAgICAgIHVzZXJzIHdobyBhcmUgaW4gZ3JvdXBzIG91dHNpZGUgb2YgdGhlaXIgcHJpbmNpcGFsIGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIFVzZXJOYW1lCgogICAgICAgIFVzZXJuYW1lIHRvIGZpbHRlciByZXN1bHRzIGZvciwgd2lsZGNhcmRzIGFjY2VwdGVkLgoKICAgIC5QQVJBTUVURVIgRG9tYWluCgogICAgICAgIERvbWFpbiB0byBxdWVyeSBmb3IgdXNlcnMsIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4KCiAgICAuUEFSQU1FVEVSIERvbWFpbkNvbnRyb2xsZXIKCiAgICAgICAgRG9tYWluIGNvbnRyb2xsZXIgdG8gcmVmbGVjdCBMREFQIHF1ZXJpZXMgdGhyb3VnaC4KCiAgICAuUEFSQU1FVEVSIExEQVAKCiAgICAgICAgU3dpdGNoLiBVc2UgTERBUCBxdWVyaWVzIHRvIGVudW1lcmF0ZSB0aGUgdHJ1c3RzIGluc3RlYWQgb2YgZGlyZWN0IGRvbWFpbiBjb25uZWN0aW9ucy4KICAgICAgICBNb3JlIGxpa2VseSB0byBnZXQgYXJvdW5kIG5ldHdvcmsgc2VnbWVudGF0aW9uLCBidXQgbm90IGFzIGFjY3VyYXRlLgoKICAgIC5QQVJBTUVURVIgUmVjdXJzZQoKICAgICAgICBTd2l0Y2guIEVudW1lcmF0ZSBhbGwgdXNlciB0cnVzdCBncm91cHMgZnJvbSBhbGwgcmVhY2hhYmxlIGRvbWFpbnMgcmVjdXJzaXZlbHkuCgogICAgLlBBUkFNRVRFUiBQYWdlU2l6ZQoKICAgICAgICBUaGUgUGFnZVNpemUgdG8gc2V0IGZvciB0aGUgTERBUCBzZWFyY2hlciBvYmplY3QuCgogICAgLkxJTksKCiAgICAgICAgaHR0cDovL2Jsb2cuaGFybWoweS5uZXQvCiM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJExEQVAsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlY3Vyc2UsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGZ1bmN0aW9uIEdldC1Gb3JlaWduVXNlciB7CiAgICAgICAgIyBoZWxwZXIgdXNlZCB0byBlbnVtZXJhdGUgdXNlcnMgd2hvIGFyZSBpbiBncm91cHMgb3V0c2lkZSBvZiB0aGVpciBwcmluY2lwYWwgZG9tYWluCiAgICAgICAgcGFyYW0oCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRVc2VyTmFtZSwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW4sCgogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICAgICAgW0ludF0KICAgICAgICAgICAgJFBhZ2VTaXplID0gMjAwCiAgICAgICAgKQoKICAgICAgICBpZiAoJERvbWFpbikgewogICAgICAgICAgICAjIGdldCB0aGUgZG9tYWluIG5hbWUgaW50byBkaXN0aW5ndWlzaGVkIGZvcm0KICAgICAgICAgICAgJERpc3Rpbmd1aXNoZWREb21haW5OYW1lID0gIkRDPSIgKyAkRG9tYWluIC1yZXBsYWNlICdcLicsJyxEQz0nCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkRGlzdGluZ3Vpc2hlZERvbWFpbk5hbWUgPSBbU3RyaW5nXSAoW2Fkc2ldJycpLmRpc3Rpbmd1aXNoZWRuYW1lCiAgICAgICAgICAgICREb21haW4gPSAkRGlzdGluZ3Vpc2hlZERvbWFpbk5hbWUgLXJlcGxhY2UgJ0RDPScsJycgLXJlcGxhY2UgJywnLCcuJwogICAgICAgIH0KCiAgICAgICAgR2V0LU5ldFVzZXIgLURvbWFpbiAkRG9tYWluIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1Vc2VyTmFtZSAkVXNlck5hbWUgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IFdoZXJlLU9iamVjdCB7JF8ubWVtYmVyb2Z9IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICBGb3JFYWNoICgkTWVtYmVyc2hpcCBpbiAkXy5tZW1iZXJvZikgewogICAgICAgICAgICAgICAgJEluZGV4ID0gJE1lbWJlcnNoaXAuSW5kZXhPZigiREM9IikKICAgICAgICAgICAgICAgIGlmKCRJbmRleCkgewogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICRHcm91cERvbWFpbiA9ICQoJE1lbWJlcnNoaXAuc3Vic3RyaW5nKCRJbmRleCkpIC1yZXBsYWNlICdEQz0nLCcnIC1yZXBsYWNlICcsJywnLicKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoJEdyb3VwRG9tYWluLkNvbXBhcmVUbygkRG9tYWluKSkgewogICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHRoZSBncm91cCBkb21haW4gZG9lc24ndCBtYXRjaCB0aGUgdXNlciBkb21haW4sIG91dHB1dAogICAgICAgICAgICAgICAgICAgICAgICAkR3JvdXBOYW1lID0gJE1lbWJlcnNoaXAuc3BsaXQoIiwiKVswXS5zcGxpdCgiPSIpWzFdCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Vc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJEb21haW4nICREb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Vc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAkXy5zYW1hY2NvdW50bmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnblVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBEb21haW4nICRHcm91cERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnblVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBOYW1lJyAkR3JvdXBOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduVXNlciB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdHcm91cEROJyAkTWVtYmVyc2hpcAogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnblVzZXIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgaWYgKCRSZWN1cnNlKSB7CiAgICAgICAgIyBnZXQgYWxsIHJlY2hhYmxlIGRvbWFpbnMgaW4gdGhlIHRydXN0IG1lc2ggYW5kIHVuaXF1aWZ5IHRoZW0KICAgICAgICBpZigkTERBUCAtb3IgJERvbWFpbkNvbnRyb2xsZXIpIHsKICAgICAgICAgICAgJERvbWFpblRydXN0cyA9IEludm9rZS1NYXBEb21haW5UcnVzdCAtTERBUCAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Tb3VyY2VEb21haW4gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICREb21haW5UcnVzdHMgPSBJbnZva2UtTWFwRG9tYWluVHJ1c3QgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IEZvckVhY2gtT2JqZWN0IHsgJF8uU291cmNlRG9tYWluIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlCiAgICAgICAgfQoKICAgICAgICBGb3JFYWNoKCREb21haW5UcnVzdCBpbiAkRG9tYWluVHJ1c3RzKSB7CiAgICAgICAgICAgICMgZ2V0IHRoZSB0cnVzdCBncm91cHMgZm9yIGVhY2ggZG9tYWluIGluIHRoZSB0cnVzdCBtZXNoCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkVudW1lcmF0aW5nIHRydXN0IGdyb3VwcyBpbiBkb21haW4gJERvbWFpblRydXN0IgogICAgICAgICAgICBHZXQtRm9yZWlnblVzZXIgLURvbWFpbiAkRG9tYWluVHJ1c3QgLVVzZXJOYW1lICRVc2VyTmFtZSAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgR2V0LUZvcmVpZ25Vc2VyIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtVXNlck5hbWUgJFVzZXJOYW1lIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgIH0KfQoKCmZ1bmN0aW9uIEZpbmQtRm9yZWlnbkdyb3VwIHsKPCMKICAgIC5TWU5PUFNJUwoKICAgICAgICBFbnVtZXJhdGVzIGFsbCB0aGUgbWVtYmVycyBvZiBhIGdpdmVuIGRvbWFpbidzIGdyb3VwcwogICAgICAgIGFuZCBmaW5kcyB1c2VycyB0aGF0IGFyZSBub3QgaW4gdGhlIHF1ZXJpZWQgZG9tYWluLgogICAgICAgIFRoZSAtUmVjdXJzZSBmbGFnIHdpbGwgcGVyZm9ybSB0aGlzIGVudW1lcmF0aW9uIGZvciBhbGwKICAgICAgICBlYWNoYWJsZSBkb21haW4gdHJ1c3RzLgoKICAgIC5QQVJBTUVURVIgR3JvdXBOYW1lCgogICAgICAgIEdyb3VwbmFtZSB0byBmaWx0ZXIgcmVzdWx0cyBmb3IsIHdpbGRjYXJkcyBhY2NlcHRlZC4KCiAgICAuUEFSQU1FVEVSIERvbWFpbgoKICAgICAgICBEb21haW4gdG8gcXVlcnkgZm9yIGdyb3VwcywgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZG9tYWluLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgTERBUAoKICAgICAgICBTd2l0Y2guIFVzZSBMREFQIHF1ZXJpZXMgdG8gZW51bWVyYXRlIHRoZSB0cnVzdHMgaW5zdGVhZCBvZiBkaXJlY3QgZG9tYWluIGNvbm5lY3Rpb25zLgogICAgICAgIE1vcmUgbGlrZWx5IHRvIGdldCBhcm91bmQgbmV0d29yayBzZWdtZW50YXRpb24sIGJ1dCBub3QgYXMgYWNjdXJhdGUuCgogICAgLlBBUkFNRVRFUiBSZWN1cnNlCgogICAgICAgIFN3aXRjaC4gRW51bWVyYXRlIGFsbCBncm91cCB0cnVzdCB1c2VycyBmcm9tIGFsbCByZWFjaGFibGUgZG9tYWlucyByZWN1cnNpdmVseS4KCiAgICAuUEFSQU1FVEVSIFBhZ2VTaXplCgogICAgICAgIFRoZSBQYWdlU2l6ZSB0byBzZXQgZm9yIHRoZSBMREFQIHNlYXJjaGVyIG9iamVjdC4KCiAgICAuTElOSwoKICAgICAgICBodHRwOi8vYmxvZy5oYXJtajB5Lm5ldC8KIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkR3JvdXBOYW1lID0gJyonLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW4sCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJExEQVAsCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFJlY3Vyc2UsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgIGZ1bmN0aW9uIEdldC1Gb3JlaWduR3JvdXAgewogICAgICAgIHBhcmFtKAogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkR3JvdXBOYW1lID0gJyonLAoKICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJERvbWFpbiwKCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICAgICAgW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMCldIAogICAgICAgICAgICBbSW50XQogICAgICAgICAgICAkUGFnZVNpemUgPSAyMDAKICAgICAgICApCgogICAgICAgIGlmKC1ub3QgJERvbWFpbikgewogICAgICAgICAgICAkRG9tYWluID0gKEdldC1OZXREb21haW4pLk5hbWUKICAgICAgICB9CgogICAgICAgICREb21haW5ETiA9ICJEQz0kKCREb21haW4uUmVwbGFjZSgnLicsICcsREM9JykpIgogICAgICAgIFdyaXRlLVZlcmJvc2UgIkRvbWFpbkROOiAkRG9tYWluRE4iCgogICAgICAgICMgc3RhbmRhcmQgZ3JvdXAgbmFtZXMgdG8gaWdub3JlCiAgICAgICAgJEV4Y2x1ZGVHcm91cHMgPSBAKCJVc2VycyIsICJEb21haW4gVXNlcnMiLCAiR3Vlc3RzIikKCiAgICAgICAgIyBnZXQgYWxsIHRoZSBncm91cG5hbWVzIGZvciB0aGUgZ2l2ZW4gZG9tYWluCiAgICAgICAgR2V0LU5ldEdyb3VwIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLUZ1bGxEYXRhIC1QYWdlU2l6ZSAkUGFnZVNpemUgfCBXaGVyZS1PYmplY3QgeyRfLm1lbWJlcn0gfCBXaGVyZS1PYmplY3QgewogICAgICAgICAgICAjIGV4Y2x1ZGUgY29tbW9uIGxhcmdlIGdyb3VwcwogICAgICAgICAgICAtbm90ICgkRXhjbHVkZUdyb3VwcyAtY29udGFpbnMgJF8uc2FtYWNjb3VudG5hbWUpIH0gfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICRHcm91cE5hbWUgPSAkXy5zYW1BY2NvdW50TmFtZQoKICAgICAgICAgICAgICAgICRfLm1lbWJlciB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgICAgICAgICAjIGZpbHRlciBmb3IgZm9yZWlnbiBTSURzIGluIHRoZSBjbiBmaWVsZCBmb3IgdXNlcnMgaW4gYW5vdGhlciBkb21haW4sCiAgICAgICAgICAgICAgICAgICAgIyAgIG9yIGlmIHRoZSBETiBkb2Vzbid0IGVuZCB3aXRoIHRoZSBwcm9wZXIgRE4gZm9yIHRoZSBxdWVyaWVkIGRvbWFpbiAgCiAgICAgICAgICAgICAgICAgICAgaWYgKCgkXyAtbWF0Y2ggJ0NOPVMtMS01LTIxLiotLionKSAtb3IgKCREb21haW5ETiAtbmUgKCRfLnN1YnN0cmluZygkXy5JbmRleE9mKCJEQz0iKSkpKSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJEb21haW4gPSAkXy5zdWJTdHJpbmcoJF8uSW5kZXhPZigiREM9IikpIC1yZXBsYWNlICdEQz0nLCcnIC1yZXBsYWNlICcsJywnLicKICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJOYW1lID0gJF8uc3BsaXQoIiwiKVswXS5zcGxpdCgiPSIpWzFdCgogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnbkdyb3VwVXNlciA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Hcm91cFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBEb21haW4nICREb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Hcm91cFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnR3JvdXBOYW1lJyAkR3JvdXBOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduR3JvdXBVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJEb21haW4nICRVc2VyRG9tYWluCiAgICAgICAgICAgICAgICAgICAgICAgICRGb3JlaWduR3JvdXBVc2VyIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1VzZXJOYW1lJyAkVXNlck5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJEZvcmVpZ25Hcm91cFVzZXIgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVXNlckROJyAkXwogICAgICAgICAgICAgICAgICAgICAgICAkRm9yZWlnbkdyb3VwVXNlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgaWYgKCRSZWN1cnNlKSB7CiAgICAgICAgIyBnZXQgYWxsIHJlY2hhYmxlIGRvbWFpbnMgaW4gdGhlIHRydXN0IG1lc2ggYW5kIHVuaXF1aWZ5IHRoZW0KICAgICAgICBpZigkTERBUCAtb3IgJERvbWFpbkNvbnRyb2xsZXIpIHsKICAgICAgICAgICAgJERvbWFpblRydXN0cyA9IEludm9rZS1NYXBEb21haW5UcnVzdCAtTERBUCAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Tb3VyY2VEb21haW4gfSB8IFNvcnQtT2JqZWN0IC1VbmlxdWUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICREb21haW5UcnVzdHMgPSBJbnZva2UtTWFwRG9tYWluVHJ1c3QgLVBhZ2VTaXplICRQYWdlU2l6ZSB8IEZvckVhY2gtT2JqZWN0IHsgJF8uU291cmNlRG9tYWluIH0gfCBTb3J0LU9iamVjdCAtVW5pcXVlCiAgICAgICAgfQoKICAgICAgICBGb3JFYWNoKCREb21haW5UcnVzdCBpbiAkRG9tYWluVHJ1c3RzKSB7CiAgICAgICAgICAgICMgZ2V0IHRoZSB0cnVzdCBncm91cHMgZm9yIGVhY2ggZG9tYWluIGluIHRoZSB0cnVzdCBtZXNoCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkVudW1lcmF0aW5nIHRydXN0IGdyb3VwcyBpbiBkb21haW4gJERvbWFpblRydXN0IgogICAgICAgICAgICBHZXQtRm9yZWlnbkdyb3VwIC1Hcm91cE5hbWUgJEdyb3VwTmFtZSAtRG9tYWluICREb21haW4gLURvbWFpbkNvbnRyb2xsZXIgJERvbWFpbkNvbnRyb2xsZXIgLVBhZ2VTaXplICRQYWdlU2l6ZQogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgIEdldC1Gb3JlaWduR3JvdXAgLUdyb3VwTmFtZSAkR3JvdXBOYW1lIC1Eb21haW4gJERvbWFpbiAtRG9tYWluQ29udHJvbGxlciAkRG9tYWluQ29udHJvbGxlciAtUGFnZVNpemUgJFBhZ2VTaXplCiAgICB9Cn0KCgpmdW5jdGlvbiBJbnZva2UtTWFwRG9tYWluVHJ1c3Qgewo8IwogICAgLlNZTk9QU0lTCgogICAgICAgIFRoaXMgZnVuY3Rpb24gZ2V0cyBhbGwgdHJ1c3RzIGZvciB0aGUgY3VycmVudCBkb21haW4sCiAgICAgICAgYW5kIHRyaWVzIHRvIGdldCBhbGwgdHJ1c3RzIGZvciBlYWNoIGRvbWFpbiBpdCBmaW5kcy4KCiAgICAuUEFSQU1FVEVSIExEQVAKCiAgICAgICAgU3dpdGNoLiBVc2UgTERBUCBxdWVyaWVzIHRvIGVudW1lcmF0ZSB0aGUgdHJ1c3RzIGluc3RlYWQgb2YgZGlyZWN0IGRvbWFpbiBjb25uZWN0aW9ucy4KICAgICAgICBNb3JlIGxpa2VseSB0byBnZXQgYXJvdW5kIG5ldHdvcmsgc2VnbWVudGF0aW9uLCBidXQgbm90IGFzIGFjY3VyYXRlLgoKICAgIC5QQVJBTUVURVIgRG9tYWluQ29udHJvbGxlcgoKICAgICAgICBEb21haW4gY29udHJvbGxlciB0byByZWZsZWN0IExEQVAgcXVlcmllcyB0aHJvdWdoLgoKICAgIC5QQVJBTUVURVIgUGFnZVNpemUKCiAgICAgICAgVGhlIFBhZ2VTaXplIHRvIHNldCBmb3IgdGhlIExEQVAgc2VhcmNoZXIgb2JqZWN0LgoKICAgIC5FWEFNUExFCgogICAgICAgIFBTIEM6XD4gSW52b2tlLU1hcERvbWFpblRydXN0IHwgRXhwb3J0LUNTViAtTm9UeXBlSW5mb3JtYXRpb24gdHJ1c3RzLmNzdgogICAgICAgIAogICAgICAgIE1hcCBhbGwgcmVhY2hhYmxlIGRvbWFpbiB0cnVzdHMgYW5kIG91dHB1dCBldmVyeXRoaW5nIHRvIGEgLmNzdiBmaWxlLgoKICAgIC5MSU5LCgogICAgICAgIGh0dHA6Ly9ibG9nLmhhcm1qMHkubmV0LwojPgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJExEQVAsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDEsMTAwMDApXSAKICAgICAgICBbSW50XQogICAgICAgICRQYWdlU2l6ZSA9IDIwMAogICAgKQoKICAgICMga2VlcCB0cmFjayBvZiBkb21haW5zIHNlZW4gc28gd2UgZG9uJ3QgaGl0IGluZmluaXRlIHJlY3Vyc2lvbgogICAgJFNlZW5Eb21haW5zID0gQHt9CgogICAgIyBvdXIgZG9tYWluIHN0YXR1cyB0cmFja2VyCiAgICAkRG9tYWlucyA9IE5ldy1PYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlN0YWNrCgogICAgIyBnZXQgdGhlIGN1cnJlbnQgZG9tYWluIGFuZCBwdXNoIGl0IG9udG8gdGhlIHN0YWNrCiAgICAkQ3VycmVudERvbWFpbiA9IChHZXQtTmV0RG9tYWluKS5OYW1lCiAgICAkRG9tYWlucy5wdXNoKCRDdXJyZW50RG9tYWluKQoKICAgIHdoaWxlKCREb21haW5zLkNvdW50IC1uZSAwKSB7CgogICAgICAgICREb21haW4gPSAkRG9tYWlucy5Qb3AoKQoKICAgICAgICAjIGlmIHdlIGhhdmVuJ3Qgc2VlbiB0aGlzIGRvbWFpbiBiZWZvcmUKICAgICAgICBpZiAoLW5vdCAkU2VlbkRvbWFpbnMuQ29udGFpbnNLZXkoJERvbWFpbikpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkVudW1lcmF0aW5nIHRydXN0cyBmb3IgZG9tYWluICckRG9tYWluJyIKCiAgICAgICAgICAgICMgbWFyayBpdCBhcyBzZWVuIGluIG91ciBsaXN0CiAgICAgICAgICAgICROdWxsID0gJFNlZW5Eb21haW5zLmFkZCgkRG9tYWluLCAiIikKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAjIGdldCBhbGwgdGhlIHRydXN0cyBmb3IgdGhpcyBkb21haW4KICAgICAgICAgICAgICAgIGlmKCRMREFQIC1vciAkRG9tYWluQ29udHJvbGxlcikgewogICAgICAgICAgICAgICAgICAgICRUcnVzdHMgPSBHZXQtTmV0RG9tYWluVHJ1c3QgLURvbWFpbiAkRG9tYWluIC1MREFQIC1Eb21haW5Db250cm9sbGVyICREb21haW5Db250cm9sbGVyIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRUcnVzdHMgPSBHZXQtTmV0RG9tYWluVHJ1c3QgLURvbWFpbiAkRG9tYWluIC1QYWdlU2l6ZSAkUGFnZVNpemUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkVHJ1c3RzIC1pc25vdCBbc3lzdGVtLmFycmF5XSkgewogICAgICAgICAgICAgICAgICAgICRUcnVzdHMgPSBAKCRUcnVzdHMpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyBnZXQgYW55IGZvcmVzdCB0cnVzdHMsIGlmIHRoZXkgZXhpc3QKICAgICAgICAgICAgICAgICRUcnVzdHMgKz0gR2V0LU5ldEZvcmVzdFRydXN0IC1Gb3Jlc3QgJERvbWFpbgoKICAgICAgICAgICAgICAgIGlmICgkVHJ1c3RzKSB7CgogICAgICAgICAgICAgICAgICAgICMgZW51bWVyYXRlIGVhY2ggdHJ1c3QgZm91bmQKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkVHJ1c3QgaW4gJFRydXN0cykgewogICAgICAgICAgICAgICAgICAgICAgICAkU291cmNlRG9tYWluID0gJFRydXN0LlNvdXJjZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFRhcmdldERvbWFpbiA9ICRUcnVzdC5UYXJnZXROYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICRUcnVzdFR5cGUgPSAkVHJ1c3QuVHJ1c3RUeXBlCiAgICAgICAgICAgICAgICAgICAgICAgICRUcnVzdERpcmVjdGlvbiA9ICRUcnVzdC5UcnVzdERpcmVjdGlvbgoKICAgICAgICAgICAgICAgICAgICAgICAgIyBtYWtlIHN1cmUgd2UgcHJvY2VzcyB0aGUgdGFyZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICROdWxsID0gJERvbWFpbnMucHVzaCgkVGFyZ2V0RG9tYWluKQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBidWlsZCB0aGUgbmljZWx5LXBhcnNhYmxlIGN1c3RvbSBvdXRwdXQgb2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCA9IE5ldy1PYmplY3QgUFNPYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1NvdXJjZURvbWFpbicgIiRTb3VyY2VEb21haW4iCiAgICAgICAgICAgICAgICAgICAgICAgICREb21haW5UcnVzdCB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5ICdUYXJnZXREb21haW4nICIkVGFyZ2V0RG9tYWluIgogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QgfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAnVHJ1c3RUeXBlJyAiJFRydXN0VHlwZSIKICAgICAgICAgICAgICAgICAgICAgICAgJERvbWFpblRydXN0IHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgJ1RydXN0RGlyZWN0aW9uJyAiJFRydXN0RGlyZWN0aW9uIgogICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluVHJ1c3QKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiWyFdIEVycm9yOiAkXyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBFeHBvc2UgdGhlIFdpbjMyQVBJIGZ1bmN0aW9ucyBhbmQgZGF0YXN0cnVjdHVyZXMgYmVsb3cKIyB1c2luZyBQU1JlZmxlY3QuIAojIFdhcm5pbmc6IE9uY2UgdGhlc2UgYXJlIGV4ZWN1dGVkLCB0aGV5IGFyZSBiYWtlZCBpbiAKIyBhbmQgY2FuJ3QgYmUgY2hhbmdlZCB3aGlsZSB0aGUgc2NyaXB0IGlzIHJ1bm5pbmchCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiRNb2QgPSBOZXctSW5NZW1vcnlNb2R1bGUgLU1vZHVsZU5hbWUgV2luMzIKCiMgYWxsIG9mIHRoZSBXaW4zMiBBUEkgZnVuY3Rpb25zIHdlIG5lZWQKJEZ1bmN0aW9uRGVmaW5pdGlvbnMgPSBAKAogICAgKGZ1bmMgbmV0YXBpMzIgTmV0U2hhcmVFbnVtIChbSW50XSkgQChbU3RyaW5nXSwgW0ludF0sIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludF0sIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCkpKSwKICAgIChmdW5jIG5ldGFwaTMyIE5ldFdrc3RhVXNlckVudW0gKFtJbnRdKSBAKFtTdHJpbmddLCBbSW50XSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50XSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkpLAogICAgKGZ1bmMgbmV0YXBpMzIgTmV0U2Vzc2lvbkVudW0gKFtJbnRdKSBAKFtTdHJpbmddLCBbU3RyaW5nXSwgW1N0cmluZ10sIFtJbnRdLCBbSW50UHRyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnRdLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludDMyXS5NYWtlQnlSZWZUeXBlKCksIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyBuZXRhcGkzMiBOZXRBcGlCdWZmZXJGcmVlIChbSW50XSkgQChbSW50UHRyXSkpLAogICAgKGZ1bmMgYWR2YXBpMzIgT3BlblNDTWFuYWdlclcgKFtJbnRQdHJdKSBAKFtTdHJpbmddLCBbU3RyaW5nXSwgW0ludF0pKSwKICAgIChmdW5jIGFkdmFwaTMyIENsb3NlU2VydmljZUhhbmRsZSAoW0ludF0pIEAoW0ludFB0cl0pKSwKICAgIChmdW5jIHd0c2FwaTMyIFdUU09wZW5TZXJ2ZXJFeCAoW0ludFB0cl0pIEAoW1N0cmluZ10pKSwKICAgIChmdW5jIHd0c2FwaTMyIFdUU0VudW1lcmF0ZVNlc3Npb25zRXggKFtJbnRdKSBAKFtJbnRQdHJdLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludF0sIFtJbnRQdHJdLk1ha2VCeVJlZlR5cGUoKSwgIFtJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpKSksCiAgICAoZnVuYyB3dHNhcGkzMiBXVFNRdWVyeVNlc3Npb25JbmZvcm1hdGlvbiAoW0ludF0pIEAoW0ludFB0cl0sIFtJbnRdLCBbSW50XSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50MzJdLk1ha2VCeVJlZlR5cGUoKSkpLAogICAgKGZ1bmMgd3RzYXBpMzIgV1RTRnJlZU1lbW9yeUV4IChbSW50XSkgQChbSW50MzJdLCBbSW50UHRyXSwgW0ludDMyXSkpLAogICAgKGZ1bmMgd3RzYXBpMzIgV1RTRnJlZU1lbW9yeSAoW0ludF0pIEAoW0ludFB0cl0pKSwKICAgIChmdW5jIHd0c2FwaTMyIFdUU0Nsb3NlU2VydmVyIChbSW50XSkgQChbSW50UHRyXSkpLAogICAgKGZ1bmMga2VybmVsMzIgR2V0TGFzdEVycm9yIChbSW50XSkgQCgpKQopCgojIGVudW0gdXNlZCBieSAkV1RTX1NFU1NJT05fSU5GT18xIGJlbG93CiRXVFNDb25uZWN0U3RhdGUgPSBwc2VudW0gJE1vZCBXVFNfQ09OTkVDVFNUQVRFX0NMQVNTIFVJbnQxNiBAewogICAgQWN0aXZlICAgICAgID0gICAgMAogICAgQ29ubmVjdGVkICAgID0gICAgMQogICAgQ29ubmVjdFF1ZXJ5ID0gICAgMgogICAgU2hhZG93ICAgICAgID0gICAgMwogICAgRGlzY29ubmVjdGVkID0gICAgNAogICAgSWRsZSAgICAgICAgID0gICAgNQogICAgTGlzdGVuICAgICAgID0gICAgNgogICAgUmVzZXQgICAgICAgID0gICAgNwogICAgRG93biAgICAgICAgID0gICAgOAogICAgSW5pdCAgICAgICAgID0gICAgOQp9CgojIHRoZSBXVFNFbnVtZXJhdGVTZXNzaW9uc0V4IHJlc3VsdCBzdHJ1Y3R1cmUKJFdUU19TRVNTSU9OX0lORk9fMSA9IHN0cnVjdCAkTW9kIFdUU19TRVNTSU9OX0lORk9fMSBAewogICAgRXhlY0VudklkID0gZmllbGQgMCBVSW50MzIKICAgIFN0YXRlID0gZmllbGQgMSAkV1RTQ29ubmVjdFN0YXRlCiAgICBTZXNzaW9uSWQgPSBmaWVsZCAyIFVJbnQzMgogICAgcFNlc3Npb25OYW1lID0gZmllbGQgMyBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgcEhvc3ROYW1lID0gZmllbGQgNCBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgcFVzZXJOYW1lID0gZmllbGQgNSBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgcERvbWFpbk5hbWUgPSBmaWVsZCA2IFN0cmluZyAtTWFyc2hhbEFzIEAoJ0xQV1N0cicpCiAgICBwRmFybU5hbWUgPSBmaWVsZCA3IFN0cmluZyAtTWFyc2hhbEFzIEAoJ0xQV1N0cicpCn0KCiMgdGhlIHBhcnRpY3VsYXIgV1RTUXVlcnlTZXNzaW9uSW5mb3JtYXRpb24gcmVzdWx0IHN0cnVjdHVyZQokV1RTX0NMSUVOVF9BRERSRVNTID0gc3RydWN0ICRtb2QgV1RTX0NMSUVOVF9BRERSRVNTIEB7CiAgICBBZGRyZXNzRmFtaWx5ID0gZmllbGQgMCBVSW50MzIKICAgIEFkZHJlc3MgPSBmaWVsZCAxIEJ5dGVbXSAtTWFyc2hhbEFzIEAoJ0J5VmFsQXJyYXknLCAyMCkKfQoKIyB0aGUgTmV0U2hhcmVFbnVtIHJlc3VsdCBzdHJ1Y3R1cmUKJFNIQVJFX0lORk9fMSA9IHN0cnVjdCAkTW9kIFNIQVJFX0lORk9fMSBAewogICAgc2hpMV9uZXRuYW1lID0gZmllbGQgMCBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgc2hpMV90eXBlID0gZmllbGQgMSBVSW50MzIKICAgIHNoaTFfcmVtYXJrID0gZmllbGQgMiBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQp9CgojIHRoZSBOZXRXa3N0YVVzZXJFbnVtIHJlc3VsdCBzdHJ1Y3R1cmUKJFdLU1RBX1VTRVJfSU5GT18xID0gc3RydWN0ICRNb2QgV0tTVEFfVVNFUl9JTkZPXzEgQHsKICAgIHdrdWkxX3VzZXJuYW1lID0gZmllbGQgMCBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgd2t1aTFfbG9nb25fZG9tYWluID0gZmllbGQgMSBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgd2t1aTFfb3RoX2RvbWFpbnMgPSBmaWVsZCAyIFN0cmluZyAtTWFyc2hhbEFzIEAoJ0xQV1N0cicpCiAgICB3a3VpMV9sb2dvbl9zZXJ2ZXIgPSBmaWVsZCAzIFN0cmluZyAtTWFyc2hhbEFzIEAoJ0xQV1N0cicpCn0KCiMgdGhlIE5ldFNlc3Npb25FbnVtIHJlc3VsdCBzdHJ1Y3R1cmUKJFNFU1NJT05fSU5GT18xMCA9IHN0cnVjdCAkTW9kIFNFU1NJT05fSU5GT18xMCBAewogICAgc2VzaTEwX2NuYW1lID0gZmllbGQgMCBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgc2VzaTEwX3VzZXJuYW1lID0gZmllbGQgMSBTdHJpbmcgLU1hcnNoYWxBcyBAKCdMUFdTdHInKQogICAgc2VzaTEwX3RpbWUgPSBmaWVsZCAyIFVJbnQzMgogICAgc2VzaTEwX2lkbGVfdGltZSA9IGZpZWxkIDMgVUludDMyCn0KCgokVHlwZXMgPSAkRnVuY3Rpb25EZWZpbml0aW9ucyB8IEFkZC1XaW4zMlR5cGUgLU1vZHVsZSAkTW9kIC1OYW1lc3BhY2UgJ1dpbjMyJwokTmV0YXBpMzIgPSAkVHlwZXNbJ25ldGFwaTMyJ10KJEFkdmFwaTMyID0gJFR5cGVzWydhZHZhcGkzMiddCiRLZXJuZWwzMiA9ICRUeXBlc1sna2VybmVsMzInXQokV3RzYXBpMzIgPSAkVHlwZXNbJ3d0c2FwaTMyJ10KCgojIGFsaWFzZXMgdG8gaGVscCB0aGUgUG93ZXJWaWV3IDIuMCB0cmFuc2l0aW9uClNldC1BbGlhcyBHZXQtTmV0Rm9yZXN0RG9tYWlucyBHZXQtTmV0Rm9yZXN0RG9tYWluClNldC1BbGlhcyBHZXQtTmV0RG9tYWluQ29udHJvbGxlcnMgR2V0LU5ldERvbWFpbkNvbnRyb2xsZXIKU2V0LUFsaWFzIEdldC1OZXRVc2VyU1BOcyBHZXQtTmV0VXNlcgpTZXQtQWxpYXMgSW52b2tlLU5ldFVzZXJBZGQgQWRkLU5ldFVzZXIKU2V0LUFsaWFzIEludm9rZS1OZXRHcm91cFVzZXJBZGQgQWRkLU5ldEdyb3VwVXNlcgpTZXQtQWxpYXMgR2V0LU5ldENvbXB1dGVycyBHZXQtTmV0Q29tcHV0ZXIKU2V0LUFsaWFzIEdldC1OZXRPVXMgR2V0LU5ldE9VClNldC1BbGlhcyBHZXQtTmV0R1VJRE9VcyBHZXQtTmV0T1UKU2V0LUFsaWFzIEdldC1OZXRGaWxlU2VydmVycyBHZXQtTmV0RmlsZVNlcnZlcgpTZXQtQWxpYXMgR2V0LU5ldFNlc3Npb25zIEdldC1OZXRTZXNzaW9uClNldC1BbGlhcyBHZXQtTmV0UkRQU2Vzc2lvbnMgR2V0LU5ldFJEUFNlc3Npb24KU2V0LUFsaWFzIEdldC1OZXRQcm9jZXNzZXMgR2V0LU5ldFByb2Nlc3MKU2V0LUFsaWFzIEdldC1Vc2VyTG9nb25FdmVudHMgR2V0LVVzZXJFdmVudApTZXQtQWxpYXMgR2V0LVVzZXJUR1RFdmVudHMgR2V0LVVzZXJFdmVudApTZXQtQWxpYXMgR2V0LVVzZXJQcm9wZXJ0aWVzIEdldC1Vc2VyUHJvcGVydHkKU2V0LUFsaWFzIEdldC1Db21wdXRlclByb3BlcnRpZXMgR2V0LUNvbXB1dGVyUHJvcGVydHkKU2V0LUFsaWFzIEludm9rZS1Vc2VySHVudGVyVGhyZWFkZWQgSW52b2tlLVVzZXJIdW50ZXIKU2V0LUFsaWFzIEludm9rZS1Qcm9jZXNzSHVudGVyVGhyZWFkZWQgSW52b2tlLVByb2Nlc3NIdW50ZXIKU2V0LUFsaWFzIEludm9rZS1TaGFyZUZpbmRlclRocmVhZGVkIEludm9rZS1TaGFyZUZpbmRlcgpTZXQtQWxpYXMgSW52b2tlLVNlYXJjaEZpbGVzIEZpbmQtSW50ZXJlc3RpbmdGaWxlClNldC1BbGlhcyBJbnZva2UtVXNlckZpZWxkU2VhcmNoIEZpbmQtVXNlckZpZWxkClNldC1BbGlhcyBJbnZva2UtQ29tcHV0ZXJGaWVsZFNlYXJjaCBGaW5kLUNvbXB1dGVyRmllbGQKU2V0LUFsaWFzIEludm9rZS1GaW5kTG9jYWxBZG1pbkFjY2VzcyBGaW5kLUxvY2FsQWRtaW5BY2Nlc3MKU2V0LUFsaWFzIEludm9rZS1GaW5kTG9jYWxBZG1pbkFjY2Vzc1RocmVhZGVkIEZpbmQtTG9jYWxBZG1pbkFjY2VzcwpTZXQtQWxpYXMgR2V0LU5ldERvbWFpblRydXN0cyBHZXQtTmV0RG9tYWluVHJ1c3QKU2V0LUFsaWFzIEdldC1OZXRGb3Jlc3RUcnVzdHMgR2V0LU5ldEZvcmVzdFRydXN0ClNldC1BbGlhcyBJbnZva2UtTWFwRG9tYWluVHJ1c3RzIEludm9rZS1NYXBEb21haW5UcnVzdApTZXQtQWxpYXMgSW52b2tlLUZpbmRVc2VyVHJ1c3RHcm91cHMgRmluZC1Gb3JlaWduVXNlcgpTZXQtQWxpYXMgSW52b2tlLUZpbmRHcm91cFRydXN0VXNlcnMgRmluZC1Gb3JlaWduR3JvdXAKU2V0LUFsaWFzIEludm9rZS1FbnVtZXJhdGVMb2NhbFRydXN0R3JvdXBzIEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluClNldC1BbGlhcyBJbnZva2UtRW51bWVyYXRlTG9jYWxBZG1pbnMgSW52b2tlLUVudW1lcmF0ZUxvY2FsQWRtaW4KU2V0LUFsaWFzIEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluc1RocmVhZGVkIEludm9rZS1FbnVtZXJhdGVMb2NhbEFkbWluClNldC1BbGlhcyBJbnZva2UtRmluZEFsbFVzZXJUcnVzdEdyb3VwcyBGaW5kLUZvcmVpZ25Vc2VyClNldC1BbGlhcyBGaW5kLVVzZXJUcnVzdEdyb3VwIEZpbmQtRm9yZWlnblVzZXIKU2V0LUFsaWFzIEludm9rZS1GaW5kQWxsR3JvdXBUcnVzdFVzZXJzIEZpbmQtRm9yZWlnbkdyb3VwCg==
