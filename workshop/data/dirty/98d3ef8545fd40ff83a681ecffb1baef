Invoke-WmiCommand.ps1,86c0b1ed5ffc624e48977c13db3cccb3,Scan result is 32768. IsMalware: 1,I1JlcXVpcmVzIC1WZXJzaW9uIDIKCmZ1bmN0aW9uIEludm9rZS1XbWlDb21tYW5kIHsKPCMKLlNZTk9QU0lTCgpFeGVjdXRlcyBhIFBvd2VyU2hlbGwgU2NyaXB0QmxvY2sgb24gYSB0YXJnZXQgY29tcHV0ZXIgdXNpbmcgV01JIGFzIGEKcHVyZSBDMiBjaGFubmVsLgoKQXV0aG9yOiBNYXR0aGV3IEdyYWViZXIKTGljZW5zZTogQlNEIDMtQ2xhdXNlClJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKCi5ERVNDUklQVElPTgoKSW52b2tlLVdtaUNvbW1hbmQgZXhlY3V0ZXMgYSBQb3dlclNoZWxsIFNjcmlwdEJsb2NrIG9uIGEgdGFyZ2V0CmNvbXB1dGVyIHVzaW5nIFdNSSBhcyBhIHB1cmUgQzIgY2hhbm5lbC4gSXQgZG9lcyB0aGlzIGJ5IHVzaW5nIHRoZQpTdGRSZWdQcm92IFdNSSByZWdpc3RyeSBwcm92aWRlciBtZXRob2RzIHRvIHN0b3JlIGEgcGF5bG9hZCBpbnRvIGEKcmVnaXN0cnkgdmFsdWUuIFRoZSBjb21tYW5kIGlzIHRoZW4gZXhlY3V0ZWQgb24gdGhlIHZpY3RpbSBzeXN0ZW0gYW5kCnRoZSBvdXRwdXQgaXMgc3RvcmVkIGluIGFub3RoZXIgcmVnaXN0cnkgdmFsdWUgdGhhdCBpcyB0aGVuIHJldHJpZXZlZApyZW1vdGVseS4KCi5QQVJBTUVURVIgUGF5bG9hZAoKU3BlY2lmaWVzIHRoZSBwYXlsb2FkIHRvIGJlIGV4ZWN1dGVkIG9uIHRoZSByZW1vdGUgc3lzdGVtLgoKLlBBUkFNRVRFUiBSZWdpc3RyeUtleVBhdGgKClNwZWNpZmllcyB0aGUgcmVnaXN0cnkga2V5IHdoZXJlIHRoZSBwYXlsb2FkIGFuZCBwYXlsb2FkIG91dHB1dCB3aWxsCmJlIHN0b3JlZC4KCi5QQVJBTUVURVIgUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lCgpTcGVjaWZpZXMgdGhlIHJlZ2lzdHJ5IHZhbHVlIG5hbWUgd2hlcmUgdGhlIHBheWxvYWQgd2lsbCBiZSBzdG9yZWQuCgouUEFSQU1FVEVSIFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lCgpTcGVjaWZpZXMgdGhlIHJlZ2lzdHJ5IHZhbHVlIG5hbWUgd2hlcmUgdGhlIHBheWxvYWQgb3V0cHV0IHdpbGwgYmUKc3RvcmVkLgoKLlBBUkFNRVRFUiBDb21wdXRlck5hbWUKClJ1bnMgdGhlIGNvbW1hbmQgb24gdGhlIHNwZWNpZmllZCBjb21wdXRlcnMuIFRoZSBkZWZhdWx0IGlzIHRoZSBsb2NhbApjb21wdXRlci4KClR5cGUgdGhlIE5ldEJJT1MgbmFtZSwgYW4gSVAgYWRkcmVzcywgb3IgYSBmdWxseSBxdWFsaWZpZWQgZG9tYWluCm5hbWUgb2Ygb25lIG9yIG1vcmUgY29tcHV0ZXJzLiBUbyBzcGVjaWZ5IHRoZSBsb2NhbCBjb21wdXRlciwgdHlwZQp0aGUgY29tcHV0ZXIgbmFtZSwgYSBkb3QgKC4pLCBvciAibG9jYWxob3N0Ii4KClRoaXMgcGFyYW1ldGVyIGRvZXMgbm90IHJlbHkgb24gV2luZG93cyBQb3dlclNoZWxsIHJlbW90aW5nLiBZb3UgY2FuCnVzZSB0aGUgQ29tcHV0ZXJOYW1lIHBhcmFtZXRlciBldmVuIGlmIHlvdXIgY29tcHV0ZXIgaXMgbm90CmNvbmZpZ3VyZWQgdG8gcnVuIHJlbW90ZSBjb21tYW5kcy4KCi5QQVJBTUVURVIgQ3JlZGVudGlhbAoKU3BlY2lmaWVzIGEgdXNlciBhY2NvdW50IHRoYXQgaGFzIHBlcm1pc3Npb24gdG8gcGVyZm9ybSB0aGlzIGFjdGlvbi4KVGhlIGRlZmF1bHQgaXMgdGhlIGN1cnJlbnQgdXNlci4gVHlwZSBhIHVzZXIgbmFtZSwgc3VjaCBhcyAiVXNlcjAxIiwKIkRvbWFpbjAxXFVzZXIwMSIsIG9yIFVzZXJAQ29udG9zby5jb20uIE9yLCBlbnRlciBhIFBTQ3JlZGVudGlhbApvYmplY3QsIHN1Y2ggYXMgYW4gb2JqZWN0IHRoYXQgaXMgcmV0dXJuZWQgYnkgdGhlIEdldC1DcmVkZW50aWFsCmNtZGxldC4gV2hlbiB5b3UgdHlwZSBhIHVzZXIgbmFtZSwgeW91IHdpbGwgYmUgcHJvbXB0ZWQgZm9yIGEKcGFzc3dvcmQuCgouUEFSQU1FVEVSIEltcGVyc29uYXRpb24KClNwZWNpZmllcyB0aGUgaW1wZXJzb25hdGlvbiBsZXZlbCB0byB1c2UuIFZhbGlkIHZhbHVlcyBhcmU6CgowOiBEZWZhdWx0IChSZWFkcyB0aGUgbG9jYWwgcmVnaXN0cnkgZm9yIHRoZSBkZWZhdWx0IGltcGVyc29uYXRpb24gbGV2ZWwsIHdoaWNoIGlzIHVzdWFsbHkgc2V0IHRvICIzOiBJbXBlcnNvbmF0ZSIuKQoKMTogQW5vbnltb3VzIChIaWRlcyB0aGUgY3JlZGVudGlhbHMgb2YgdGhlIGNhbGxlci4pCgoyOiBJZGVudGlmeSAoQWxsb3dzIG9iamVjdHMgdG8gcXVlcnkgdGhlIGNyZWRlbnRpYWxzIG9mIHRoZSBjYWxsZXIuKQoKMzogSW1wZXJzb25hdGUgKEFsbG93cyBvYmplY3RzIHRvIHVzZSB0aGUgY3JlZGVudGlhbHMgb2YgdGhlIGNhbGxlci4pCgo0OiBEZWxlZ2F0ZSAoQWxsb3dzIG9iamVjdHMgdG8gcGVybWl0IG90aGVyIG9iamVjdHMgdG8gdXNlIHRoZSBjcmVkZW50aWFscyBvZiB0aGUgY2FsbGVyLikKCi5QQVJBTUVURVIgQXV0aGVudGljYXRpb24KClNwZWNpZmllcyB0aGUgYXV0aGVudGljYXRpb24gbGV2ZWwgdG8gYmUgdXNlZCB3aXRoIHRoZSBXTUkgY29ubmVjdGlvbi4gVmFsaWQgdmFsdWVzIGFyZToKCi0xOiBVbmNoYW5nZWQKCjA6IERlZmF1bHQKCjE6IE5vbmUgKE5vIGF1dGhlbnRpY2F0aW9uIGluIHBlcmZvcm1lZC4pCgoyOiBDb25uZWN0IChBdXRoZW50aWNhdGlvbiBpcyBwZXJmb3JtZWQgb25seSB3aGVuIHRoZSBjbGllbnQgZXN0YWJsaXNoZXMgYSByZWxhdGlvbnNoaXAgd2l0aCB0aGUgYXBwbGljYXRpb24uKQoKMzogQ2FsbCAoQXV0aGVudGljYXRpb24gaXMgcGVyZm9ybWVkIG9ubHkgYXQgdGhlIGJlZ2lubmluZyBvZiBlYWNoIGNhbGwgd2hlbiB0aGUgYXBwbGljYXRpb24gcmVjZWl2ZXMgdGhlIHJlcXVlc3QuKQoKNDogUGFja2V0IChBdXRoZW50aWNhdGlvbiBpcyBwZXJmb3JtZWQgb24gYWxsIHRoZSBkYXRhIHRoYXQgaXMgcmVjZWl2ZWQgZnJvbSB0aGUgY2xpZW50LikKCjU6IFBhY2tldEludGVncml0eSAoQWxsIHRoZSBkYXRhIHRoYXQgaXMgdHJhbnNmZXJyZWQgYmV0d2VlbiB0aGUgY2xpZW50ICBhbmQgdGhlIGFwcGxpY2F0aW9uIGlzIGF1dGhlbnRpY2F0ZWQgYW5kIHZlcmlmaWVkLikKCjY6IFBhY2tldFByaXZhY3kgKFRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBvdGhlciBhdXRoZW50aWNhdGlvbiBsZXZlbHMgYXJlIHVzZWQsIGFuZCBhbGwgdGhlIGRhdGEgaXMgZW5jcnlwdGVkLikKCi5QQVJBTUVURVIgRW5hYmxlQWxsUHJpdmlsZWdlcwoKRW5hYmxlcyBhbGwgdGhlIHByaXZpbGVnZXMgb2YgdGhlIGN1cnJlbnQgdXNlciBiZWZvcmUgdGhlIGNvbW1hbmQKbWFrZXMgdGhlIFdNSSBjYWxsLgoKLlBBUkFNRVRFUiBBdXRob3JpdHkKClNwZWNpZmllcyB0aGUgYXV0aG9yaXR5IHRvIHVzZSB0byBhdXRoZW50aWNhdGUgdGhlIFdNSSBjb25uZWN0aW9uLgpZb3UgY2FuIHNwZWNpZnkgc3RhbmRhcmQgTlRMTSBvciBLZXJiZXJvcyBhdXRoZW50aWNhdGlvbi4gVG8gdXNlCk5UTE0sIHNldCB0aGUgYXV0aG9yaXR5IHNldHRpbmcgdG8gbnRsbWRvbWFpbjo8RG9tYWluTmFtZT4sIHdoZXJlCjxEb21haW5OYW1lPiBpZGVudGlmaWVzIGEgdmFsaWQgTlRMTSBkb21haW4gbmFtZS4gVG8gdXNlIEtlcmJlcm9zLApzcGVjaWZ5IGtlcmJlcm9zOjxEb21haW5OYW1lXFNlcnZlck5hbWU+LiBZb3UgY2Fubm90IGluY2x1ZGUgdGhlCmF1dGhvcml0eSBzZXR0aW5nIHdoZW4geW91IGNvbm5lY3QgdG8gdGhlIGxvY2FsIGNvbXB1dGVyLgoKLkVYQU1QTEUKClBTIEM6XD5JbnZva2UtV21pQ29tbWFuZCAtUGF5bG9hZCB7IGlmICgkVHJ1ZSkgeyAnRG8gRXZpbCcgfSB9IC1DcmVkZW50aWFsICdUYXJnZXREb21haW5cVGFyZ2V0VXNlcicgLUNvbXB1dGVyTmFtZSAnMTAuMTAuMS4xJwoKLkVYQU1QTEUKClBTIEM6XD4kSG9zdHMgPSBHZXQtQ29udGVudCBob3N0bmFtZXMudHh0ClBTIEM6XD4kUGF5bG9hZCA9IEdldC1Db250ZW50IHBheWxvYWQucHMxClBTIEM6XD4kQ3JlZGVudGlhbCA9IEdldC1DcmVkZW50aWFsICdUYXJnZXREb21haW5cVGFyZ2V0VXNlcicKUFMgQzpcPiRIb3N0cyB8IEludm9rZS1XbWlDb21tYW5kIC1QYXlsb2FkICRQYXlsb2FkIC1DcmVkZW50aWFsICRDcmVkZW50aWFsCgouRVhBTVBMRQoKUFMgQzpcPiRQYXlsb2FkID0gR2V0LUNvbnRlbnQgcGF5bG9hZC5wczEKUFMgQzpcPkludm9rZS1XbWlDb21tYW5kIC1QYXlsb2FkICRQYXlsb2FkIC1DcmVkZW50aWFsICdUYXJnZXREb21haW5cVGFyZ2V0VXNlcicgLUNvbXB1dGVyTmFtZSAnMTAuMTAuMS4xJywgJzEwLjEwLjEuMicKCi5FWEFNUExFCgpQUyBDOi8+SW52b2tlLVdtaUNvbW1hbmQgLVBheWxvYWQgeyAxKzMrMisxKzEgfSAtUmVnaXN0cnlIaXZlIEhLRVlfTE9DQUxfTUFDSElORSAtUmVnaXN0cnlLZXlQYXRoICdTT0ZUV0FSRVx0ZXN0a2V5JyAtUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lICd0ZXN0dmFsdWUnIC1SZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSAndGVzdHJlc3VsdCcgLUNvbXB1dGVyTmFtZSAnMTAuMTAuMS4xJyAtQ3JlZGVudGlhbCAnVGFyZ2V0SG9zdFxBZG1pbmlzdHJhdG9yJyAtVmVyYm9zZQoKLklOUFVUUwoKU3lzdGVtLlN0cmluZ1tdCgpBY2NlcHRzIG9uZSBvciBtb3JlIGhvc3QgbmFtZXMvSVAgYWRkcmVzc2VzIG92ZXIgdGhlIHBpcGVsaW5lLgoKLk9VVFBVVFMKClN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNPYmplY3QKCk91dHB1dHMgYSBjdXN0b20gb2JqZWN0IGNvbnNpc3Rpbmcgb2YgdGhlIHRhcmdldCBjb21wdXRlciBuYW1lIGFuZAp0aGUgb3V0cHV0IG9mIHRoZSBjb21tYW5kIGV4ZWN1dGVkLgoKLk5PVEVTCgpJbiBvcmRlciB0byByZWNlaXZlIHRoZSBvdXRwdXQgZnJvbSB5b3VyIHBheWxvYWQsIGl0IG11c3QgcmV0dXJuCmFjdHVhbCBvYmplY3RzLiBGb3IgZXhhbXBsZSwgV3JpdGUtSG9zdCBkb2Vzbid0IHJldHVybiBvYmplY3RzCnJhdGhlciwgaXQgd3JpdGVzIGRpcmVjdGx5IHRvIHRoZSBjb25zb2xlLiBJZiB5b3UncmUgdXNpbmcKV3JpdGUtSG9zdCBpbiB5b3VyIHNjcmlwdHMgdGhvdWdoLCB5b3UgcHJvYmFibHkgZG9uJ3QgZGVzZXJ2ZSB0byBnZXQKdGhlIG91dHB1dCBvZiB5b3VyIHBheWxvYWQgYmFjay4gOlAKIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgW1NjcmlwdEJsb2NrXQogICAgICAgICRQYXlsb2FkLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZVNldCggJ0hLRVlfTE9DQUxfTUFDSElORScsCiAgICAgICAgICAgICAgICAgICAgICAnSEtFWV9DVVJSRU5UX1VTRVInLAogICAgICAgICAgICAgICAgICAgICAgJ0hLRVlfQ0xBU1NFU19ST09UJywKICAgICAgICAgICAgICAgICAgICAgICdIS0VZX1VTRVJTJywKICAgICAgICAgICAgICAgICAgICAgICdIS0VZX0NVUlJFTlRfQ09ORklHJyApXQogICAgICAgICRSZWdpc3RyeUhpdmUgPSAnSEtFWV9DVVJSRU5UX1VTRVInLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJFJlZ2lzdHJ5S2V5UGF0aCA9ICdTT0ZUV0FSRVxNaWNyb3NvZnRcQ3J5cHRvZ3JhcGh5XFJORycsCgogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lID0gJ1NlZWQnLAoKICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgJFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lID0gJ1ZhbHVlJywKCiAgICAgICAgW1BhcmFtZXRlciggVmFsdWVGcm9tUGlwZWxpbmUgPSAkVHJ1ZSApXQogICAgICAgIFtBbGlhcygnQ24nKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICAkQ29tcHV0ZXJOYW1lID0gJ2xvY2FsaG9zdCcsCgogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uQ3JlZGVudGlhbEF0dHJpYnV0ZSgpXQogICAgICAgICRDcmVkZW50aWFsLAoKICAgICAgICBbTWFuYWdlbWVudC5JbXBlcnNvbmF0aW9uTGV2ZWxdCiAgICAgICAgJEltcGVyc29uYXRpb24sCgogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRoZW50aWNhdGlvbkxldmVsXQogICAgICAgICRBdXRoZW50aWNhdGlvbiwKCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkRW5hYmxlQWxsUHJpdmlsZWdlcywKCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQXV0aG9yaXR5CiAgICApCgogICAgQkVHSU4gewogICAgICAgIHN3aXRjaCAoJFJlZ2lzdHJ5SGl2ZSkgewogICAgICAgICAgICAnSEtFWV9MT0NBTF9NQUNISU5FJyB7ICRIaXZlID0gMjE0NzQ4MzY1MCB9CiAgICAgICAgICAgICdIS0VZX0NVUlJFTlRfVVNFUicgeyAkSGl2ZSA9IDIxNDc0ODM2NDkgfQogICAgICAgICAgICAnSEtFWV9DTEFTU0VTX1JPT1QnIHsgJEhpdmUgPSAyMTQ3NDgzNjQ4IH0KICAgICAgICAgICAgJ0hLRVlfVVNFUlMnIHsgJEhpdmUgPSAyMTQ3NDgzNjUxIH0KICAgICAgICAgICAgJ0hLRVlfQ1VSUkVOVF9DT05GSUcnIHsgJEhpdmUgPSAyMTQ3NDgzNjUzIH0KICAgICAgICB9CgogICAgICAgICRXbWlNZXRob2RBcmdzID0gQHt9CgogICAgICAgICMgSWYgYWRkaXRpb25hbCBXTUkgY21kbGV0IHByb3BlcnRpZXMgd2VyZSBwcm92aWRlZCwgcHJveHkgdGhlbSB0byBJbnZva2UtV21pTWV0aG9kCiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQ3JlZGVudGlhbCddKSB7ICRXbWlNZXRob2RBcmdzWydDcmVkZW50aWFsJ10gPSAkQ3JlZGVudGlhbCB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snSW1wZXJzb25hdGlvbiddKSB7ICRXbWlNZXRob2RBcmdzWydJbXBlcnNvbmF0aW9uJ10gPSAkSW1wZXJzb25hdGlvbiB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQXV0aGVudGljYXRpb24nXSkgeyAkV21pTWV0aG9kQXJnc1snQXV0aGVudGljYXRpb24nXSA9ICRBdXRoZW50aWNhdGlvbiB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snRW5hYmxlQWxsUHJpdmlsZWdlcyddKSB7ICRXbWlNZXRob2RBcmdzWydFbmFibGVBbGxQcml2aWxlZ2VzJ10gPSAkRW5hYmxlQWxsUHJpdmlsZWdlcyB9CiAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVyc1snQXV0aG9yaXR5J10pIHsgJFdtaU1ldGhvZEFyZ3NbJ0F1dGhvcml0eSddID0gJEF1dGhvcml0eSB9CgogICAgICAgICRBY2Nlc3NQZXJtaXNzaW9ucyA9IEB7CiAgICAgICAgICAgIEtFWV9RVUVSWV9WQUxVRSA9IDEKICAgICAgICAgICAgS0VZX1NFVF9WQUxVRSA9IDIKICAgICAgICAgICAgS0VZX0NSRUFURV9TVUJfS0VZID0gNAogICAgICAgICAgICBLRVlfQ1JFQVRFID0gMzIKICAgICAgICAgICAgREVMRVRFID0gNjU1MzYKICAgICAgICB9CgogICAgICAgICMgVGhlc2UgYXJlIGFsbCBvZiB0aGUgcmVnaXN0cnkgcGVybWlzc2lvbnMgd2UnbGwgcmVxdWlyZQogICAgICAgICRSZXF1aXJlZFBlcm1pc3Npb25zID0gJEFjY2Vzc1Blcm1pc3Npb25zWydLRVlfUVVFUllfVkFMVUUnXSAtYm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNjZXNzUGVybWlzc2lvbnNbJ0tFWV9TRVRfVkFMVUUnXSAtYm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQWNjZXNzUGVybWlzc2lvbnNbJ0tFWV9DUkVBVEVfU1VCX0tFWSddIC1ib3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3NQZXJtaXNzaW9uc1snS0VZX0NSRUFURSddIC1ib3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBY2Nlc3NQZXJtaXNzaW9uc1snREVMRVRFJ10KICAgIH0KCiAgICBQUk9DRVNTIHsKICAgICAgICBmb3JlYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVyTmFtZSkgewogICAgICAgICAgICAjIFBhc3MgdGhlIGluZGl2aWR1YWwgY29tcHV0ZXIgbmFtZSB0byBJbnZva2UtV21pTWV0aG9kCiAgICAgICAgICAgICRXbWlNZXRob2RBcmdzWydDb21wdXRlck5hbWUnXSA9ICRDb21wdXRlcgoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gQ3JlYXRpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSBrZXk6ICRSZWdpc3RyeUhpdmVcJFJlZ2lzdHJ5S2V5UGF0aCIKICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWVzcGFjZSAnUm9vdFxkZWZhdWx0JyAtQ2xhc3MgJ1N0ZFJlZ1Byb3YnIC1OYW1lICdDcmVhdGVLZXknIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgKCiAgICAgICAgICAgIGlmICgkUmVzdWx0LlJldHVyblZhbHVlIC1uZSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyRDb21wdXRlcl0gVW5hYmxlIHRvIGNyZWF0ZSB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IGtleTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoIgogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJbJENvbXB1dGVyXSBWYWxpZGF0aW5nIHJlYWQvd3JpdGUvZGVsZXRlIHByaXZpbGVnZXMgZm9yIHRoZSBmb2xsb3dpbmcgcmVnaXN0cnkga2V5OiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGgiCiAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnQ2hlY2tBY2Nlc3MnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZXF1aXJlZFBlcm1pc3Npb25zCgogICAgICAgICAgICBpZiAoLW5vdCAkUmVzdWx0LmJHcmFudGVkKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAiWyRDb21wdXRlcl0gWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gcGVyZm9ybSBhbGwgdGhlIHJlZ2lzdHJ5IG9wZXJhdGlvbnMgbmVjZXNzYXJ5IGZvciBJbnZva2UtV21pQ29tbWFuZC4iCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRFbmNvZGVkUGF5bG9hZCA9IFtDb252ZXJ0XTo6VG9CYXNlNjRTdHJpbmcoW1RleHQuRW5jb2RpbmddOjpVbmljb2RlLkdldEJ5dGVzKCRQYXlsb2FkKSkKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlskQ29tcHV0ZXJdIFN0b3JpbmcgdGhlIHBheWxvYWQgaW50byB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IHZhbHVlOiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGhcJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZSIKICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWVzcGFjZSAnUm9vdFxkZWZhdWx0JyAtQ2xhc3MgJ1N0ZFJlZ1Byb3YnIC1OYW1lICdTZXRTdHJpbmdWYWx1ZScgLUFyZ3VtZW50TGlzdCAkSGl2ZSwgJFJlZ2lzdHJ5S2V5UGF0aCwgJEVuY29kZWRQYXlsb2FkLCAkUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lCgogICAgICAgICAgICBpZiAoJFJlc3VsdC5SZXR1cm5WYWx1ZSAtbmUgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIlskQ29tcHV0ZXJdIFVuYWJsZSB0byBzdG9yZSB0aGUgcGF5bG9hZCBpbiB0aGUgZm9sbG93aW5nIHJlZ2lzdHJ5IHZhbHVlOiAkUmVnaXN0cnlIaXZlXCRSZWdpc3RyeUtleVBhdGhcJFJlZ2lzdHJ5UGF5bG9hZFZhbHVlTmFtZSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBQcmVwIHRoZSBzY3JpcHQgcnVubmVyIHBheWxvYWQgZnJvbSB0aGUgcmVtb3RlIHN5c3RlbQogICAgICAgICAgICAkUGF5bG9hZFJ1bm5lckFyZ3MgPSBAIgogICAgICAgICAgICAgICAgYCRIaXZlID0gJyRIaXZlJwogICAgICAgICAgICAgICAgYCRSZWdpc3RyeUtleVBhdGggPSAnJFJlZ2lzdHJ5S2V5UGF0aCcKICAgICAgICAgICAgICAgIGAkUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lID0gJyRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUnCiAgICAgICAgICAgICAgICBgJFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lID0gJyRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZScKICAgICAgICAgICAgICAgIGBuCiJACgogICAgICAgICAgICAkUmVtb3RlUGF5bG9hZFJ1bm5lciA9ICRQYXlsb2FkUnVubmVyQXJncyArIHsKICAgICAgICAgICAgICAgICRXbWlNZXRob2RBcmdzID0gQHsKICAgICAgICAgICAgICAgICAgICBOYW1lc3BhY2UgPSAnUm9vdFxkZWZhdWx0JwogICAgICAgICAgICAgICAgICAgIENsYXNzID0gJ1N0ZFJlZ1Byb3YnCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWUgJ0dldFN0cmluZ1ZhbHVlJyAtQXJndW1lbnRMaXN0ICRIaXZlLCAkUmVnaXN0cnlLZXlQYXRoLCAkUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lCgogICAgICAgICAgICAgICAgaWYgKCgkUmVzdWx0LlJldHVyblZhbHVlIC1lcSAwKSAtYW5kICgkUmVzdWx0LnNWYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAkUGF5bG9hZCA9IFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRTdHJpbmcoW0NvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCRSZXN1bHQuc1ZhbHVlKSkKCiAgICAgICAgICAgICAgICAgICAgJFNlcmlsaXplZFBheWxvYWRSZXN1bHQgPSBJbnZva2UtRXhwcmVzc2lvbiAoJFBheWxvYWQpIHwgJSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFtNYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNTZXJpYWxpemVyXTo6U2VyaWFsaXplKCRfLCA0KQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lICdTZXRTdHJpbmdWYWx1ZScgLUFyZ3VtZW50TGlzdCAkSGl2ZSwgJFJlZ2lzdHJ5S2V5UGF0aCwgJFNlcmlsaXplZFBheWxvYWRSZXN1bHQsICRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZQogICAgICAgICAgICAgICAgICAgICRudWxsID0gSW52b2tlLVdtaU1ldGhvZCBAV21pTWV0aG9kQXJncyAtTmFtZSAnRGVsZXRlVmFsdWUnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJEJhc2U2NFBheWxvYWQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtUZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkUmVtb3RlUGF5bG9hZFJ1bm5lcikpCgogICAgICAgICAgICAkQ21kbGluZSA9ICJwb3dlcnNoZWxsIC1XaW5kb3dTdHlsZSBIaWRkZW4gLU5vUHJvZmlsZSAtRW5jb2RlZENvbW1hbmQgJEJhc2U2NFBheWxvYWQiCgogICAgICAgICAgICAjIEV4ZWN1dGUgdGhlIHBheWxvYWQgcnVubmVyIG9uIHRoZSByZW1vdGUgc3lzdGVtCiAgICAgICAgICAgICRSZXN1bHQgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcY2ltdjInIC1DbGFzcyAnV2luMzJfUHJvY2VzcycgLU5hbWUgJ0NyZWF0ZScgLUFyZ3VtZW50TGlzdCAkQ21kbGluZQoKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNQoKICAgICAgICAgICAgaWYgKCRSZXN1bHQuUmV0dXJuVmFsdWUgLW5lIDApIHsKICAgICAgICAgICAgICAgIHRocm93ICJbJENvbXB1dGVyXSBVbmFibGUgZXhlY3V0ZSBwYXlsb2FkIHN0b3JlZCB3aXRoaW4gdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVBheWxvYWRWYWx1ZU5hbWUiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlskQ29tcHV0ZXJdIFBheWxvYWQgc3VjY2Vzc2Z1bGx5IGV4ZWN1dGVkIGZyb206ICRSZWdpc3RyeUhpdmVcJFJlZ2lzdHJ5S2V5UGF0aFwkUmVnaXN0cnlQYXlsb2FkVmFsdWVOYW1lIgoKICAgICAgICAgICAgJFJlc3VsdCA9IEludm9rZS1XbWlNZXRob2QgQFdtaU1ldGhvZEFyZ3MgLU5hbWVzcGFjZSAnUm9vdFxkZWZhdWx0JyAtQ2xhc3MgJ1N0ZFJlZ1Byb3YnIC1OYW1lICdHZXRTdHJpbmdWYWx1ZScgLUFyZ3VtZW50TGlzdCAkSGl2ZSwgJFJlZ2lzdHJ5S2V5UGF0aCwgJFJlZ2lzdHJ5UmVzdWx0VmFsdWVOYW1lCgogICAgICAgICAgICBpZiAoJFJlc3VsdC5SZXR1cm5WYWx1ZSAtbmUgMCkgewogICAgICAgICAgICAgICAgdGhyb3cgIlskQ29tcHV0ZXJdIFVuYWJsZSByZXRyaWV2ZSB0aGUgcGF5bG9hZCByZXN1bHRzIGZyb20gdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUGF5bG9hZCByZXN1bHRzIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgZnJvbTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSIKCiAgICAgICAgICAgICRTZXJpbGl6ZWRQYXlsb2FkUmVzdWx0ID0gJFJlc3VsdC5zVmFsdWUKICAgICAgICAgICAgJFBheWxvYWRSZXN1bHQgPSBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTU2VyaWFsaXplcl06OkRlc2VyaWFsaXplKCRTZXJpbGl6ZWRQYXlsb2FkUmVzdWx0KQoKICAgICAgICAgICAgJEZpbmFsUmVzdWx0ID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsKICAgICAgICAgICAgICAgIFBTQ29tcHV0ZXJOYW1lID0gJENvbXB1dGVyCiAgICAgICAgICAgICAgICBQYXlsb2FkT3V0cHV0ID0gJFBheWxvYWRSZXN1bHQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUmVtb3ZpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSB2YWx1ZTogJFJlZ2lzdHJ5SGl2ZVwkUmVnaXN0cnlLZXlQYXRoXCRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZSIKICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnRGVsZXRlVmFsdWUnIC1Bcmd1bWVudExpc3QgJEhpdmUsICRSZWdpc3RyeUtleVBhdGgsICRSZWdpc3RyeVJlc3VsdFZhbHVlTmFtZQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiWyRDb21wdXRlcl0gUmVtb3ZpbmcgdGhlIGZvbGxvd2luZyByZWdpc3RyeSBrZXk6ICRSZWdpc3RyeUhpdmVcJFJlZ2lzdHJ5S2V5UGF0aCIKICAgICAgICAgICAgJG51bGwgPSBJbnZva2UtV21pTWV0aG9kIEBXbWlNZXRob2RBcmdzIC1OYW1lc3BhY2UgJ1Jvb3RcZGVmYXVsdCcgLUNsYXNzICdTdGRSZWdQcm92JyAtTmFtZSAnRGVsZXRlS2V5JyAtQXJndW1lbnRMaXN0ICRIaXZlLCAkUmVnaXN0cnlLZXlQYXRoCgogICAgICAgICAgICByZXR1cm4gJEZpbmFsUmVzdWx0CiAgICAgICAgfQogICAgfQp9Cg==
