Agt.Common.psm1,6f3beaf2bc5791a204435c9ccfe7aff1,Scan result is 32768. IsMalware: 1,CjwjCi5TWU5PUFNJUwogICAgU2V0cyBhIHNob3J0Y3V0IGZvciBleGUgZmlsZS4KLlBBUkFNRVRFUiBTb3VyY2VFeGUKICAgIFRoZSBrbm93biBleGUgZmlsZSBwYXRoLgouUEFSQU1FVEVSIEFyZ3VtZW50c1RvU291cmNlRXhlCiAgICBUaGUgYXJndW1lbnRzLgouUEFSQU1FVEVSIERlc3RpbmF0aW9uUGF0aAogICAgU2hvcnRjdXQgbG9jYXRpb24uCiM+CmZ1bmN0aW9uIFNldC1TaG9yY3V0CnsKCVBhcmFtICgKICAgICAgICBbc3RyaW5nXSRTb3VyY2VFeGUsCiAgICAgICAgW3N0cmluZ10kQXJndW1lbnRzVG9Tb3VyY2VFeGUsCiAgICAgICAgW3N0cmluZ10kRGVzdGluYXRpb25QYXRoCiAgICApCgkkV3NoU2hlbGwgPSBOZXctT2JqZWN0IC1jb21PYmplY3QgV1NjcmlwdC5TaGVsbAoJJFNob3J0Y3V0ID0gJFdzaFNoZWxsLkNyZWF0ZVNob3J0Y3V0KCREZXN0aW5hdGlvblBhdGgpCgkkU2hvcnRjdXQuVGFyZ2V0UGF0aCA9ICRTb3VyY2VFeGUKCSRTaG9ydGN1dC5Bcmd1bWVudHMgPSAkQXJndW1lbnRzVG9Tb3VyY2VFeGUKCSRTaG9ydGN1dC5TYXZlKCkKfQoKZnVuY3Rpb24gU2V0LVBvd2VyTW9kZQp7CglQYXJhbQoJKAoJCVtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsUG9zaXRpb24gPSAwKV0gCgkJW1ZhbGlkYXRlU2V0KCJQb3dlciBzYXZlciIsICJCYWxhbmNlZCIsICJIaWdoIHBlcmZvcm1hbmNlIildCgkJW1N0cmluZ10kUG93ZXJNb2RlCgkpCgkkcGFjID0gZ3dtaSAtTlMgcm9vdFxjaW12Mlxwb3dlciAtQ2xhc3Mgd2luMzJfUG93ZXJQbGFuIHwgc2VsZWN0IEVsZW1lbnROYW1lLCBJc0FjdGl2ZSB8IHdoZXJlIHskXy5Jc0FjdGl2ZX0KCWlmKCRwYWMuRWxlbWVudE5hbWUgLW5lICRQb3dlck1vZGUpCgl7CgkJJHBhY2EgPSBnd21pIC1OUyByb290XGNpbXYyXHBvd2VyIC1DbGFzcyB3aW4zMl9Qb3dlclBsYW4gLUZpbHRlciAiRWxlbWVudE5hbWUgPSckUG93ZXJNb2RlJyIKCQlpZigkcGFjYSkKCQl7CgkJCSRwYWNhLkFjdGl2YXRlKCk7CgkJfQoJfQp9CgpmdW5jdGlvbiBJc01vZHVsZXNFeGlzdHMKewoJJHJlc3VsdCA9ICR0cnVlCgkkbW9kdWxlcyA9IEAoPCMiUHNjeCIsIz4gIkFndC5Qb3dlcnNoZWxsIiwgIkFndC5Db21tb24iCSkKCSMkdmFyID0gKEdldC1Nb2R1bGUgfCBtZWFzdXJlKS5Db3VudAoJZm9yZWFjaCgkdmFsdWUgaW4gJG1vZHVsZXMpCXsgaWYgKCEoR2V0LU1vZHVsZSAtTmFtZSAkdmFsdWUpKXsgJHJlc3VsdCA9ICRmYWxzZTsgYnJlYWs7IH0gfQoJJHJlc3VsdAp9CmZ1bmN0aW9uIFN0YXJ0LUZ1bgp7CiAgICAkbnVsbCA9IFJlZ2lzdGVyLU9iamVjdEV2ZW50IC1JbnB1dE9iamVjdCAoW01pY3Jvc29mdC5XaW4zMi5TeXN0ZW1FdmVudHNdKSAtRXZlbnROYW1lICJTZXNzaW9uU3dpdGNoIiAtQWN0aW9uIHsKICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLlNwZWVjaAogICAgJHN5bnRoZXNpemVyID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlNwZWVjaC5TeW50aGVzaXMuU3BlZWNoU3ludGhlc2l6ZXIKICAgIHN3aXRjaCgkZXZlbnQuU291cmNlRXZlbnRBcmdzLlJlYXNvbikgewogICAgICAgICdTZXNzaW9uTG9jaycgICAgeyAkc3ludGhlc2l6ZXIuU3BlYWsoIlNlZXlvdSBsYXRlciAkZW52OnVzZXJuYW1lISIpIH0KICAgICAgICAnU2Vzc2lvblVubG9jaycgIHsgJHN5bnRoZXNpemVyLlNwZWFrKCJIZXksd2VsY29tZSBiYWNrICRlbnY6dXNlcm5hbWUhIikgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gU3RvcC1GdW4KewogICAgJGV2ZW50cyA9IEdldC1FdmVudFN1YnNjcmliZXIgfCBXaGVyZS1PYmplY3QgeyAkXy5Tb3VyY2VPYmplY3QgLWVxIFtNaWNyb3NvZnQuV2luMzIuU3lzdGVtRXZlbnRzXSB9CiAgICAkam9icyA9ICRldmVudHMgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBBY3Rpb24KICAgICRldmVudHMgfCBVbnJlZ2lzdGVyLUV2ZW50CiAgICAkam9icyB8IFJlbW92ZS1Kb2IKfQoKZnVuY3Rpb24gU3RhcnQtUHJvZ3Jlc3MKewogIHBhcmFtCiAgKAogICAgW1NjcmlwdEJsb2NrXQogICAgJGNvZGUKICApCgogICRuZXdQb3dlclNoZWxsID0gW1Bvd2VyU2hlbGxdOjpDcmVhdGUoKS5BZGRTY3JpcHQoJGNvZGUpCiAgJGhhbmRsZSA9ICRuZXdQb3dlclNoZWxsLkJlZ2luSW52b2tlKCkgIAoKICB3aGlsZSAoJGhhbmRsZS5Jc0NvbXBsZXRlZCAtZXEgJGZhbHNlKQogIHsKICAgIFdyaXRlLUhvc3QgJy4nIC1Ob05ld2xpbmUKICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNTAwCiAgfQoKICBXcml0ZS1Ib3N0ICcnICAKCiAgJG5ld1Bvd2VyU2hlbGwuRW5kSW52b2tlKCRoYW5kbGUpICAKCiAgJG5ld1Bvd2VyU2hlbGwuUnVuc3BhY2UuQ2xvc2UoKQogICRuZXdQb3dlclNoZWxsLkRpc3Bvc2UoKQp9CgpmdW5jdGlvbiBUZXN0CnsKICAkY29kZXRleHQgPSAkQXJncyAtam9pbiAnICcKICAkY29kZXRleHQgPSAkRXhlY3V0aW9uQ29udGV4dC5JbnZva2VDb21tYW5kLkV4cGFuZFN0cmluZygkY29kZXRleHQpCiAgJGNvZGUgPSBbU2NyaXB0QmxvY2tdOjpDcmVhdGUoJGNvZGV0ZXh0KQogICR0aW1lc3BhbiA9IE1lYXN1cmUtQ29tbWFuZCAkY29kZQogICJZb3VyIGNvZGUgdG9vayB7MDowLjAwMH0gc2Vjb25kcyB0byBydW4iIC1mICR0aW1lc3Bhbi5Ub3RhbFNlY29uZHMKfSAKCmZ1bmN0aW9uIEV4cG9ydC1TY2hlZHVsZWRUYXNrCnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgICRUYXNrTmFtZSwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgJFhNTEZpbGVOYW1lCiAgICApCgogICAgc2NodGFza3MgL1FVRVJZIC9UTiAkVGFza05hbWUgL1hNTCB8IE91dC1GaWxlICRYTUxGaWxlTmFtZQp9CgpmdW5jdGlvbiBHZXQtUHJvY2Vzc0V4CnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgJE5hbWU9JyonLCAgICAgICAgICAgCiAgICAgICAgJENvbXB1dGVyTmFtZSwgICAgICAgICAgICAKICAgICAgICAkQ3JlZGVudGlhbAogICAgKQoKICAgICRudWxsID0gJFBTQm91bmRQYXJhbWV0ZXJzLlJlbW92ZSgnTmFtZScpCiAgICAkTmFtZSA9ICROYW1lLlJlcGxhY2UoJyonLCclJykgICAgICAKCiAgICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Qcm9jZXNzIEBQU0JvdW5kUGFyYW1ldGVycyAtRmlsdGVyICJOYW1lIGxpa2UgJyROYW1lJyIgfAogICAgRm9yRWFjaC1PYmplY3QKICAgIHsKICAgICAgICAkcmVzdWx0ID0gJF8gfCBTZWxlY3QtT2JqZWN0IE5hbWUsIE93bmVyLCBEZXNjcmlwdGlvbiwgSGFuZGxlCiAgICAgICAgJE93bmVyID0gJF8uR2V0T3duZXIoKQogICAgICAgIGlmICgkT3duZXIuUmV0dXJuVmFsdWUgLWVxIDIpCiAgICAgICAgewogICAgICAgICAgICAkcmVzdWx0Lk93bmVyID0gJ0FjY2Vzc0RlbmllZCcKICAgICAgICB9IGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRyZXN1bHQuT3duZXIgPSAnezB9XHsxfScgLWYgKCRPd25lci5Eb21haW4sICRPd25lci5Vc2VyKQogICAgICAgIH0KICAgICAgICAkcmVzdWx0CiAgICB9Cn0KCmZ1bmN0aW9uIEdldC1PU1ZlcnNpb24KewoKICRzaWduYXR1cmUgPSBAIgoKIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQoKIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIHVpbnQgR2V0VmVyc2lvbigpOwoKIkAKQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJHNpZ25hdHVyZSAtTmFtZSAiV2luMzJPU1ZlcnNpb24iIC1OYW1lc3BhY2UgV2luMzJGdW5jdGlvbnMgLVBhc3NUaHJ1Cn0KCiMkb3MgPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtT1NWZXJzaW9uKTo6R2V0VmVyc2lvbigpKQojJG1ham9yVmVyc2lvbiA9ICRvc1swXQoKIyRtaW5vclZlcnNpb24gPSAkb3NbMV0KIyRidWlsZCA9IFtieXRlXSRvc1syXSxbYnl0ZV0kb3NbM10KCiMkYnVpbGROdW1iZXIgPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OlRvSW50MTYoJGJ1aWxkLDApCiMiVmVyc2lvbiBpcyB7MH0uezF9IGJ1aWxkIHsyfSIgLUYgJG1ham9yVmVyc2lvbiwkbWlub3JWZXJzaW9uLCRidWlsZE51bWJlcgoKPCMKVGhlIHNhbXBsZSBzY3JpcHRzIGFyZSBub3Qgc3VwcG9ydGVkIHVuZGVyIGFueSBNaWNyb3NvZnQgc3RhbmRhcmQgc3VwcG9ydCAKcHJvZ3JhbSBvciBzZXJ2aWNlLiBUaGUgc2FtcGxlIHNjcmlwdHMgYXJlIHByb3ZpZGVkIEFTIElTIHdpdGhvdXQgd2FycmFudHkgIApvZiBhbnkga2luZC4gTWljcm9zb2Z0IGZ1cnRoZXIgZGlzY2xhaW1zIGFsbCBpbXBsaWVkIHdhcnJhbnRpZXMgaW5jbHVkaW5nLCAgCndpdGhvdXQgbGltaXRhdGlvbiwgYW55IGltcGxpZWQgd2FycmFudGllcyBvZiBtZXJjaGFudGFiaWxpdHkgb3Igb2YgZml0bmVzcyBmb3IgCmEgcGFydGljdWxhciBwdXJwb3NlLiBUaGUgZW50aXJlIHJpc2sgYXJpc2luZyBvdXQgb2YgdGhlIHVzZSBvciBwZXJmb3JtYW5jZSBvZiAgCnRoZSBzYW1wbGUgc2NyaXB0cyBhbmQgZG9jdW1lbnRhdGlvbiByZW1haW5zIHdpdGggeW91LiBJbiBubyBldmVudCBzaGFsbCAKTWljcm9zb2Z0LCBpdHMgYXV0aG9ycywgb3IgYW55b25lIGVsc2UgaW52b2x2ZWQgaW4gdGhlIGNyZWF0aW9uLCBwcm9kdWN0aW9uLCBvciAKZGVsaXZlcnkgb2YgdGhlIHNjcmlwdHMgYmUgbGlhYmxlIGZvciBhbnkgZGFtYWdlcyB3aGF0c29ldmVyIChpbmNsdWRpbmcsIAp3aXRob3V0IGxpbWl0YXRpb24sIGRhbWFnZXMgZm9yIGxvc3Mgb2YgYnVzaW5lc3MgcHJvZml0cywgYnVzaW5lc3MgaW50ZXJydXB0aW9uLCAKbG9zcyBvZiBidXNpbmVzcyBpbmZvcm1hdGlvbiwgb3Igb3RoZXIgcGVjdW5pYXJ5IGxvc3MpIGFyaXNpbmcgb3V0IG9mIHRoZSB1c2UgCm9mIG9yIGluYWJpbGl0eSB0byB1c2UgdGhlIHNhbXBsZSBzY3JpcHRzIG9yIGRvY3VtZW50YXRpb24sIGV2ZW4gaWYgTWljcm9zb2Z0IApoYXMgYmVlbiBhZHZpc2VkIG9mIHRoZSBwb3NzaWJpbGl0eSBvZiBzdWNoIGRhbWFnZXMuCiM+IAoKRnVuY3Rpb24gU2V0LU9TQ1Bvd2VyQnV0dG9uQWN0aW9uCnsKCVBhcmFtCgkoCgkJW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSxQb3NpdGlvbiA9IDApXSAKCQlbVmFsaWRhdGVTZXQoIkxvZ09mZiIsICJTd2l0Y2hVc2VyIiwgIkxvY2siLCJSZXN0YXJ0IiwiU2xlZXAiLCJIaWJlcm5hdGUiLCJTaHV0RG93biIpXQoJCVtTdHJpbmddJEFjdGlvbgoJKQoJU3dpdGNoKCRBY3Rpb24pCgl7CgkJIlN3aXRjaFVzZXIiICAJewlDaGFuZ2VidXR0b25BY3Rpb24gMHgwMDAwMDEwMCAJfQoJCSJMb2dPZmYiICAgIAl7CUNoYW5nZWJ1dHRvbkFjdGlvbiAweDAwMDAwMDAxCX0KCQkiTG9jayIgCQkJewlDaGFuZ2VidXR0b25BY3Rpb24gMHgwMDAwMDIwMAl9CgkJIlJlc3RhcnQiIAkJewlDaGFuZ2VidXR0b25BY3Rpb24gMHgwMDAwMDAwNAl9CgkJIlNsZWVwIiAJCXsJQ2hhbmdlYnV0dG9uQWN0aW9uIDB4MDAwMDAwMTAJfQoJCSJIaWJlcm5hdGUiIAl7CUNoYW5nZWJ1dHRvbkFjdGlvbiAweDAwMDAwMDQwCX0gCgkJIlNodXRkb3duIiAJCXsJQ2hhbmdlYnV0dG9uQWN0aW9uIDB4MDAwMDAwMDIgCX0KCX0KCSNHZXRDaG9pY2UKfQoKCmZ1bmN0aW9uIENoYW5nZWJ1dHRvbkFjdGlvbigkdmFsdWUpCnsKCSRSZWdwYXRoID0gIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEV4cGxvcmVyXEFkdmFuY2VkIgoJJEtldEV4aXN0ID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcQWR2YW5jZWQiIC1OYW1lICJTdGFydF9Qb3dlckJ1dHRvbkFjdGlvbiIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCUlmKCRLZXRFeGlzdCkKCXsKCQoJCVNldC1JdGVtUHJvcGVydHkgLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEV4cGxvcmVyXEFkdmFuY2VkIiAgLU5hbWUgIlN0YXJ0X1Bvd2VyQnV0dG9uQWN0aW9uIiAgLVZhbHVlICR2YWx1ZSAKCX0KCUVsc2UgCgl7CgkJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcQWR2YW5jZWQiICAtTmFtZSAiU3RhcnRfUG93ZXJCdXR0b25BY3Rpb24iICAtVmFsdWUgJHZhbHVlICAtUHJvcGVydHlUeXBlIER3b3JkCgl9Cn0KCmZ1bmN0aW9uIFByb21wdEdldENob2ljZQp7CiAgICAjUHJvbXB0IG1lc3NhZ2UKICAgICRDYXB0aW9uID0gIlJlc3RhcnQgdGhlIGNvbXB1dGVyLiIKICAgICRNZXNzYWdlID0gIkl0IHdpbGwgdGFrZSBlZmZlY3QgYWZ0ZXIgcmVzdGFydCwgZG8geW91IHdhbnQgdG8gcmVzdGFydCByaWdodCBub3c/IgogICAgJENob2ljZXMgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uW11dYAogICAgQCgiJlllcyIsIiZObyIpCiAgICBbSW50XSREZWZhdWx0Q2hvaWNlID0gMAogICAgJENob2ljZVJUTiA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkQ2FwdGlvbiwgJE1lc3NhZ2UsICRDaG9pY2VzLCAkRGVmYXVsdENob2ljZSkKICAgIFN3aXRjaCAoJENob2ljZVJUTikKICAgIHsKICAgICAgICAwIAl7c2h1dGRvd24gLXQgMCAtciB9CiAgICAgICAgMSAgCXticmVha30KICAgIH0KfQoKZnVuY3Rpb24gUHJvbXB0SW5mbwp7CglwYXJhbSggIFtzdHJpbmddJG1lc3NhZ2UJKQoJJENhcHRpb24gPSAiQXR0ZW50aW9uIgoJaWYoISgkbWVzc2FnZSkpewkJJG1lc3NhZ2UgPSAiSW5mbyIgfQoJIyRDaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSBAKCImWWVzIiwiJk5vIikKCSRDaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSBAKCImT2siKQoJW0ludF0kRGVmYXVsdENob2ljZSA9IDAKCSRDaG9pY2VSVE4gPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJENhcHRpb24sICRNZXNzYWdlLCAkQ2hvaWNlcywgJERlZmF1bHRDaG9pY2UpCn0KCiNyZXF1aXJlcyAtVmVyc2lvbiAyIApmdW5jdGlvbiBTaG93LUlucHV0Qm94CnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXQogICAgICAgICRQcm9tcHQsCiAgICAgICAgCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JGZhbHNlKV0KICAgICAgICBbc3RyaW5nXQogICAgICAgICREZWZhdWx0VmFsdWU9JycsCiAgICAgICAgCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JGZhbHNlKV0KICAgICAgICBbc3RyaW5nXQogICAgICAgICRUaXRsZSA9ICdXaW5kb3dzIFBvd2VyU2hlbGwnCiAgICApCiAgICAKICAgIAogICAgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBNaWNyb3NvZnQuVmlzdWFsQmFzaWMKICAgIFtNaWNyb3NvZnQuVmlzdWFsQmFzaWMuSW50ZXJhY3Rpb25dOjpJbnB1dEJveCgkUHJvbXB0LCRUaXRsZSwgJERlZmF1bHRWYWx1ZSkKfQogCiNTaG93LUlucHV0Qm94IC1Qcm9tcHQgJ0VudGVyIHlvdXIgbmFtZScKCmZ1bmN0aW9uIFN0YXJ0LUtleUxvZ2dlcigkUGF0aD0iJGVudjp0ZW1wXGtleWxvZ2dlci50eHQiKSAKewogICMgU2lnbmF0dXJlcyBmb3IgQVBJIENhbGxzCiAgJHNpZ25hdHVyZXMgPSBAJwpbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8sIEV4YWN0U3BlbGxpbmc9dHJ1ZSldIApwdWJsaWMgc3RhdGljIGV4dGVybiBzaG9ydCBHZXRBc3luY0tleVN0YXRlKGludCB2aXJ0dWFsS2V5Q29kZSk7IApbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8pXQpwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgR2V0S2V5Ym9hcmRTdGF0ZShieXRlW10ga2V5c3RhdGUpOwpbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8pXQpwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgTWFwVmlydHVhbEtleSh1aW50IHVDb2RlLCBpbnQgdU1hcFR5cGUpOwpbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8pXQpwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgVG9Vbmljb2RlKHVpbnQgd1ZpcnRLZXksIHVpbnQgd1NjYW5Db2RlLCBieXRlW10gbHBrZXlzdGF0ZSwgU3lzdGVtLlRleHQuU3RyaW5nQnVpbGRlciBwd3N6QnVmZiwgaW50IGNjaEJ1ZmYsIHVpbnQgd0ZsYWdzKTsKJ0AgCiAKICAjIGxvYWQgc2lnbmF0dXJlcyBhbmQgbWFrZSBtZW1iZXJzIGF2YWlsYWJsZQogICRBUEkgPSBBZGQtVHlwZSAtTWVtYmVyRGVmaW5pdGlvbiAkc2lnbmF0dXJlcyAtTmFtZSAnV2luMzInIC1OYW1lc3BhY2UgQVBJIC1QYXNzVGhydQogICAgCiAgIyBjcmVhdGUgb3V0cHV0IGZpbGUKICAkbnVsbCA9IE5ldy1JdGVtIC1QYXRoICRQYXRoIC1JdGVtVHlwZSBGaWxlIC1Gb3JjZQogCiAgdHJ5CiAgewogICAgV3JpdGUtSG9zdCAnUmVjb3JkaW5nIGtleSBwcmVzc2VzLiBQcmVzcyBDVFJMK0MgdG8gc2VlIHJlc3VsdHMuJyAtRm9yZWdyb3VuZENvbG9yIFJlZAogCiAgICAjIGNyZWF0ZSBlbmRsZXNzIGxvb3AuIFdoZW4gdXNlciBwcmVzc2VzIENUUkwrQywgZmluYWxseS1ibG9jawogICAgIyBleGVjdXRlcyBhbmQgc2hvd3MgdGhlIGNvbGxlY3RlZCBrZXkgcHJlc3NlcwogICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNDAKICAgICAgCiAgICAgICMgc2NhbiBhbGwgQVNDSUkgY29kZXMgYWJvdmUgOAogICAgICBmb3IgKCRhc2NpaSA9IDk7ICRhc2NpaSAtbGUgMjU0OyAkYXNjaWkrKykgewogICAgICAgICMgZ2V0IGN1cnJlbnQga2V5IHN0YXRlCiAgICAgICAgJHN0YXRlID0gJEFQSTo6R2V0QXN5bmNLZXlTdGF0ZSgkYXNjaWkpCiAKICAgICAgICAjIGlzIGtleSBwcmVzc2VkPwogICAgICAgIGlmICgkc3RhdGUgLWVxIC0zMjc2NykgewogICAgICAgICAgJG51bGwgPSBbY29uc29sZV06OkNhcHNMb2NrCiAKICAgICAgICAgICMgdHJhbnNsYXRlIHNjYW4gY29kZSB0byByZWFsIGNvZGUKICAgICAgICAgICR2aXJ0dWFsS2V5ID0gJEFQSTo6TWFwVmlydHVhbEtleSgkYXNjaWksIDMpCiAKICAgICAgICAgICMgZ2V0IGtleWJvYXJkIHN0YXRlIGZvciB2aXJ0dWFsIGtleXMKICAgICAgICAgICRrYnN0YXRlID0gTmV3LU9iamVjdCBCeXRlW10gMjU2CiAgICAgICAgICAkY2hlY2trYnN0YXRlID0gJEFQSTo6R2V0S2V5Ym9hcmRTdGF0ZSgka2JzdGF0ZSkKIAogICAgICAgICAgIyBwcmVwYXJlIGEgU3RyaW5nQnVpbGRlciB0byByZWNlaXZlIGlucHV0IGtleQogICAgICAgICAgJG15Y2hhciA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXIKIAogICAgICAgICAgIyB0cmFuc2xhdGUgdmlydHVhbCBrZXkKICAgICAgICAgICRzdWNjZXNzID0gJEFQSTo6VG9Vbmljb2RlKCRhc2NpaSwgJHZpcnR1YWxLZXksICRrYnN0YXRlLCAkbXljaGFyLCAkbXljaGFyLkNhcGFjaXR5LCAwKQogCiAgICAgICAgICBpZiAoJHN1Y2Nlc3MpIAogICAgICAgICAgewogICAgICAgICAgICAjIGFkZCBrZXkgdG8gbG9nZ2VyIGZpbGUKICAgICAgICAgICAgW1N5c3RlbS5JTy5GaWxlXTo6QXBwZW5kQWxsVGV4dCgkUGF0aCwgJG15Y2hhciwgW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZSkgCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGZpbmFsbHkKICB7CiAgICAjIG9wZW4gbG9nZ2VyIGZpbGUgaW4gTm90ZXBhZAogICAgbm90ZXBhZCAkUGF0aAogIH0KfQogCiMgcmVjb3JkcyBhbGwga2V5IHByZXNzZXMgdW50aWwgc2NyaXB0IGlzIGFib3J0ZWQgYnkgcHJlc3NpbmcgQ1RSTCtDIAojIHdpbGwgdGhlbiBvcGVuIHRoZSBmaWxlIHdpdGggY29sbGVjdGVkIGtleSBjb2RlcyAKI1N0YXJ0LUtleUxvZ2dlciAKCmZ1bmN0aW9uIENsZWFyLU11c2ljRm9sZGVyRnJvbVBsYXlMaXN0cwp7CglbQ21kbGV0QmluZGluZygpXQogIFBhcmFtCiAgKAogICAgW1BhcmFtZXRlcihtYW5kYXRvcnk9JHRydWUsVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXQogICAgW1ZhbGlkYXRlU2V0KCdEOlxcbXVzaWMnKV0KICAgIFtzdHJpbmddJE11c2ljRm9sZGVyUGF0aAogICkKICBQcm9jZXNzIAogIHsKICAgICRwbGF5bGlzdHNmb2xkZXIgPSBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRNdXNpY0ZvbGRlclBhdGgsICJcXFBsYXlsaXN0cyIpCiAgICAkdGVtcGxpc3RzID0gR2V0LUNoaWxkSXRlbSAtUmVjdXJzZSAtUGF0aCAkTXVzaWNGb2xkZXJQYXRoIHwgV2hlcmUtT2JqZWN0IHsgKCRfLkV4dGVuc2lvbiAtZXEgIi5tM3UiKSAtYW5kICgkXy5GdWxsTmFtZSAgLW5vdG1hdGNoICRwbGF5bGlzdHNmb2xkZXIpfQoJZm9yZWFjaCAoJHJvdyBpbiAkdGVtcGxpc3RzKQoJewoJICAgICMkcm93LkZ1bGxOYW1lCgkJUmVtb3ZlLUl0ZW0gIC1MaXRlcmFsUGF0aCAkcm93LkZ1bGxOYW1lIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSAtVmVyYm9zZQoJfQogIH0KfQ==
