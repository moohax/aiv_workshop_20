MSFT_xADUser.psm1,b63c0cddc36a55a13d3df79456736a59,Scan result is 1. IsMalware: 0,w6/Cu8K/IwojIHhBRFVzZXI6IERTQyByZXNvdXJjZSB0byBjcmVhdGUgYSBuZXcgQWN0aXZlIERpcmVjdG9yeSB1c2VyLgojCgpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJERvbWFpbk5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbc3RyaW5nXSRVc2VyTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtQU0NyZWRlbnRpYWxdJERvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsLAogICAgICAgIAogICAgICAgIFtQU0NyZWRlbnRpYWxdJFBhc3N3b3JkLAoKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbc3RyaW5nXSRFbnN1cmUgPSAiUHJlc2VudCIKICAgICkKCiAgICB0cnkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJDaGVja2luZyBpZiB0aGUgdXNlciAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJyBpcyBwcmVzZW50IC4uLiIKICAgICAgICAkdXNlciA9IEdldC1BZFVzZXIgLUlkZW50aXR5ICRVc2VyTmFtZSAtQ3JlZGVudGlhbCAkRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJGb3VuZCAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJy4iCiAgICAgICAgJEVuc3VyZSA9ICJQcmVzZW50IgogICAgfQogICAgY2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiVXNlciAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJyBpcyBOT1QgcHJlc2VudC4iCiAgICAgICAgJEVuc3VyZSA9ICJBYnNlbnQiCiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFcnJvciBsb29raW5nIHVwIHVzZXIgJyQoJFVzZXJOYW1lKScgaW4gZG9tYWluICckKCREb21haW5OYW1lKScuIgogICAgICAgIHRocm93ICRfCiAgICB9CgogICAgQHsKICAgICAgICBEb21haW5OYW1lID0gJERvbWFpbk5hbWUKICAgICAgICBVc2VyTmFtZSA9ICRVc2VyTmFtZQogICAgICAgIEVuc3VyZSA9ICRFbnN1cmUKICAgIH0KfQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJERvbWFpbk5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbc3RyaW5nXSRVc2VyTmFtZSwKICAgICAgICAKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1BTQ3JlZGVudGlhbF0kRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwsCgogICAgICAgIFtQU0NyZWRlbnRpYWxdJFBhc3N3b3JkLAoKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbc3RyaW5nXSRFbnN1cmUgPSAiUHJlc2VudCIKICAgICkKICAgIHRyeQogICAgewogICAgICAgIFZhbGlkYXRlUHJvcGVydGllcyBAUFNCb3VuZFBhcmFtZXRlcnMgLUFwcGx5CiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFcnJvciBjb25maWd1cmluZyB1c2VyICckKCRVc2VyTmFtZSknIGluIGRvbWFpbiAnJCgkRG9tYWluTmFtZSknLiIKICAgICAgICB0aHJvdyAkXwogICAgfQp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKCVtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kRG9tYWluTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJFVzZXJOYW1lLAogICAgICAgIAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbUFNDcmVkZW50aWFsXSREb21haW5BZG1pbmlzdHJhdG9yQ3JlZGVudGlhbCwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0kUGFzc3dvcmQsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXQogICAgICAgIFtzdHJpbmddJEVuc3VyZSA9ICJQcmVzZW50IgogICAgKQoKICAgIHRyeQogICAgewogICAgICAgICRwYXJhbWV0ZXJzID0gJFBTQm91bmRQYXJhbWV0ZXJzLlJlbW92ZSgiRGVidWciKTsKICAgICAgICBWYWxpZGF0ZVByb3BlcnRpZXMgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFcnJvciB0ZXN0aW5nIHVzZXIgJyQoJFVzZXJOYW1lKScgaW4gZG9tYWluICckKCREb21haW5OYW1lKScuIgogICAgICAgIHRocm93ICRfCiAgICB9Cn0KCmZ1bmN0aW9uIFZhbGlkYXRlUHJvcGVydGllcwp7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbc3RyaW5nXSREb21haW5OYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kVXNlck5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbUFNDcmVkZW50aWFsXSREb21haW5BZG1pbmlzdHJhdG9yQ3JlZGVudGlhbCwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0kUGFzc3dvcmQsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXQogICAgICAgIFtzdHJpbmddJEVuc3VyZSA9ICJQcmVzZW50IiwKCiAgICAgICAgW1N3aXRjaF0kQXBwbHkKICAgICkKCiAgICAkcmVzdWx0ID0gJHRydWUKICAgIHRyeQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNoZWNraW5nIGlmIHRoZSB1c2VyICckKCRVc2VyTmFtZSknIGluIGRvbWFpbiAnJCgkRG9tYWluTmFtZSknIGlzIHByZXNlbnQgLi4uIgogICAgICAgICR1c2VyID0gR2V0LUFkVXNlciAtSWRlbnRpdHkgJFVzZXJOYW1lIC1DcmVkZW50aWFsICREb21haW5BZG1pbmlzdHJhdG9yQ3JlZGVudGlhbAogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkZvdW5kICckKCRVc2VyTmFtZSknIGluIGRvbWFpbiAnJCgkRG9tYWluTmFtZSknLiIKICAgICAgICAKICAgICAgICBpZiAoJEVuc3VyZSAtZXEgIkFic2VudCIpCiAgICAgICAgewogICAgICAgICAgICBpZiAoJEFwcGx5KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBSZW1vdmUtQURVc2VyIC1JZGVudGl0eSAkVXNlck5hbWUgLUNyZWRlbnRpYWwgJERvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsIC1Db25maXJtOiRmYWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCRBcHBseSkKICAgICAgICB7CiAgICAgICAgICAgICMgV2UgbmVlZCB0byBlbmFibGUgdGhlIGFjY291bnQgZm9yIHBhc3N3b3JkIHZhbGlkYXRpb24uCiAgICAgICAgICAgIGlmICghKCR1c2VyLkVuYWJsZWQpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBTZXQtQWRVc2VyIC1JZGVudGl0eSAkVXNlck5hbWUgLUVuYWJsZWQgJHRydWUgLUNyZWRlbnRpYWwgJERvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJFbmFibGVkIHVzZXIgYWNjb3VudCAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJy4iCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCRQYXNzd29yZCkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNoZWNraW5nIGlmIHRoZSBwYXNzd29yZCBzcGVjaWZpZWQgZm9yIHVzZXIgJyQoJFVzZXJOYW1lKScgaXMgdmFsaWQgLi4uIgogICAgICAgICAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lICJTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQiCiAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJDcmVhdGluZyBjb25uZWN0aW9uIHRvIHRoZSBkb21haW4gJyQoJERvbWFpbk5hbWUpJyAuLi4iCiAgICAgICAgICAgICRwcm5Db250ZXh0ID0gbmV3LW9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQuUHJpbmNpcGFsQ29udGV4dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJEb21haW4iLCAkRG9tYWluTmFtZSwgJERvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsLlVzZXJOYW1lLCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZCkKCiAgICAgICAgICAgICRyZXN1bHQgPSAkcHJuQ29udGV4dC5WYWxpZGF0ZUNyZWRlbnRpYWxzKCRVc2VyTmFtZSwgJFBhc3N3b3JkLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuUGFzc3dvcmQpCiAgICAgICAgICAgIGlmKCRyZXN1bHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlRoZSBwYXNzd29yZCBmb3IgdXNlciAnJCgkVXNlck5hbWUpJyBpcyB2YWxpZC4iCiAgICAgICAgICAgICAgICByZXR1cm4gJHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlRoZSBwYXNzd29yZCBmb3IgdXNlciAnJCgkVXNlck5hbWUpJyBpcyBOT1QgdmFsaWQuIgogICAgICAgICAgICAgICAgaWYgKCRBcHBseSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBTZXQtQWRBY2NvdW50UGFzc3dvcmQgLVJlc2V0IC1JZGVudGl0eSAkVXNlck5hbWUgLU5ld1Bhc3N3b3JkICRQYXNzd29yZC5QYXNzd29yZCAtQ3JlZGVudGlhbCAkRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTdWNjZXNzZnVsbHkgcmVzZXQgcGFzc3dvcmQgZm9yIHVzZXIgJyQoJFVzZXJOYW1lKScuIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJGb3VuZCB1c2VyICckKCRVc2VyTmFtZSknIGluIGRvbWFpbiAnJCgkRG9tYWluTmFtZSknLiIKICAgICAgICAgICAgcmV0dXJuICR0cnVlCiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiVXNlciAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJyBpcyBOT1QgcHJlc2VudC4iCiAgICAgICAgaWYgKCRBcHBseSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkRW5zdXJlIC1uZSAiQWJzZW50IikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgTmFtZSA9ICRVc2VyTmFtZQogICAgICAgICAgICAgICAgICAgIENyZWRlbnRpYWwgPSAkRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwKICAgICAgICAgICAgICAgICAgICBFbmFibGVkID0gJHRydWUKICAgICAgICAgICAgICAgICAgICBVc2VyUHJpbmNpcGFsTmFtZSA9ICIkVXNlck5hbWVAJERvbWFpbk5hbWUiCiAgICAgICAgICAgICAgICAgICAgUGFzc3dvcmROZXZlckV4cGlyZXMgPSAkdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCRQYXNzd29yZCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkcGFyYW1zLkFkZCggIkFjY291bnRQYXNzd29yZCIsICRQYXNzd29yZC5QYXNzd29yZCApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBOZXctQWRVc2VyIEBwYXJhbXMKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlN1Y2Nlc3NmdWxseSBjcmVhdGVkIHVzZXIgYWNjb3VudCAnJCgkVXNlck5hbWUpJyBpbiBkb21haW4gJyQoJERvbWFpbk5hbWUpJy4iCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuICgkRW5zdXJlIC1lcSAiQWJzZW50IikKICAgICAgICB9CiAgICB9Cn0KCgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
