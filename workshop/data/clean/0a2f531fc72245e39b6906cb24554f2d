win_xiislogging.ps1,b2d4f0ef8c85a8264fa839312f8e347b,Scan result is 1. IsMalware: 0,IyFwb3dlcnNoZWxsCiMgPENPUFlSSUdIVD4KIyA8Q09ERUdFTk1FVEE+CiMKIyBUaGlzIGZpbGUgaXMgcGFydCBvZiBBbnNpYmxlCiMKIyBBbnNpYmxlIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiMgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KIwojIEFuc2libGUgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKIyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgojCiMgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKIyBhbG9uZyB3aXRoIEFuc2libGUuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgojIFdBTlRfSlNPTgojIFBPV0VSU0hFTExfQ09NTU9OClNldC1TdHJpY3RNb2RlIC1PZmYKJHBhcmFtcyA9IFBhcnNlLUFyZ3MgJGFyZ3MgLXN1cHBvcnRzX2NoZWNrX21vZGUgJHRydWUKJHJlc3VsdCA9IE5ldy1PYmplY3QgcHNvYmplY3QKU2V0LUF0dHIgJHJlc3VsdCAiY2hhbmdlZCIgJGZhbHNlCgoKCiNBVFRSSUJVVEU6TG9nUGF0aDtNQU5EQVRPUlk6VHJ1ZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOgokTG9nUGF0aCA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBMb2dQYXRoIC1mYWlsaWZlbXB0eSAkVHJ1ZSAtcmVzdWx0b2JqICRyZXN1bHQKI0FUVFJJQlVURTpMb2dGbGFncztNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzpCeXRlc1JlY3YsQnl0ZXNTZW50LENsaWVudElQLENvbXB1dGVyTmFtZSxDb29raWUsRGF0ZSxIb3N0LEh0dHBTdGF0dXMsSHR0cFN1YlN0YXR1cyxNZXRob2QsUHJvdG9jb2xWZXJzaW9uLFJlZmVyZXIsU2VydmVySVAsU2VydmVyUG9ydCxTaXRlTmFtZSxUaW1lLFRpbWVUYWtlbixVcmlRdWVyeSxVcmlTdGVtLFVzZXJBZ2VudCxVc2VyTmFtZSxXaW4zMlN0YXR1cwokTG9nRmxhZ3MgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgTG9nRmxhZ3MgLWZhaWxpZmVtcHR5ICRGYWxzZSAtcmVzdWx0b2JqICRyZXN1bHQKI0FUVFJJQlVURTpMb2dGb3JtYXQ7TUFOREFUT1JZOkZhbHNlO0RFRkFVTFRWQUxVRTo7REVTQ1JJUFRJT046O0NIT0lDRVM6SUlTLE5DU0EsVzNDCiRMb2dGb3JtYXQgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgTG9nRm9ybWF0IC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6TG9nbG9jYWxUaW1lUm9sbG92ZXI7TUFOREFUT1JZOkZhbHNlO0RFRkFVTFRWQUxVRTo7REVTQ1JJUFRJT046O0NIT0lDRVM6CiRMb2dsb2NhbFRpbWVSb2xsb3ZlciA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBMb2dsb2NhbFRpbWVSb2xsb3ZlciAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOkxvZ1BlcmlvZDtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzpEYWlseSxIb3VybHksTWF4U2l6ZSxNb250aGx5LFdlZWtseQokTG9nUGVyaW9kID0gR2V0LUF0dHIgLW9iaiAkcGFyYW1zIC1uYW1lIExvZ1BlcmlvZCAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOkxvZ1RydW5jYXRlU2l6ZTtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzoKJExvZ1RydW5jYXRlU2l6ZSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBMb2dUcnVuY2F0ZVNpemUgLWZhaWxpZmVtcHR5ICRGYWxzZSAtcmVzdWx0b2JqICRyZXN1bHQKI0FUVFJJQlVURTpQc0RzY1J1bkFzQ3JlZGVudGlhbF91c2VybmFtZTtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzoKJFBzRHNjUnVuQXNDcmVkZW50aWFsX3VzZXJuYW1lID0gR2V0LUF0dHIgLW9iaiAkcGFyYW1zIC1uYW1lIFBzRHNjUnVuQXNDcmVkZW50aWFsX3VzZXJuYW1lIC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6UHNEc2NSdW5Bc0NyZWRlbnRpYWxfcGFzc3dvcmQ7TUFOREFUT1JZOkZhbHNlO0RFRkFVTFRWQUxVRTo7REVTQ1JJUFRJT046O0NIT0lDRVM6CiRQc0RzY1J1bkFzQ3JlZGVudGlhbF9wYXNzd29yZCA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBQc0RzY1J1bkFzQ3JlZGVudGlhbF9wYXNzd29yZCAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOkF1dG9JbnN0YWxsTW9kdWxlO01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6ZmFsc2U7REVTQ1JJUFRJT046SWYgdHJ1ZSwgdGhlIHJlcXVpcmVkIGRzYyByZXNvdXJjZS9tb2R1bGUgd2lsbCBiZSBhdXRvLWluc3RhbGxlZCB1c2luZyB0aGUgUG93ZXJzaGVsbCBwYWNrYWdlIG1hbmFnZXI7Q0hPSUNFUzp0cnVlLGZhbHNlCiRBdXRvSW5zdGFsbE1vZHVsZSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBBdXRvSW5zdGFsbE1vZHVsZSAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdCAtZGVmYXVsdCBmYWxzZQojQVRUUklCVVRFOkF1dG9Db25maWd1cmVMY207TUFOREFUT1JZOkZhbHNlO0RFRkFVTFRWQUxVRTpmYWxzZTtERVNDUklQVElPTjpJZiB0cnVlLCBMQ00gd2lsbCBiZSBhdXRvLWNvbmZpZ3VyZWQgZm9yIGRpcmVjdGx5IGludm9raW5nIERTQyByZXNvdXJjZXMgKHdoaWNoIGlzIGEgb25lLXRpbWUgcmVxdWlyZW1lbnQgZm9yIEFuc2libGUgRFNDIG1vZHVsZXMpO0NIT0lDRVM6dHJ1ZSxmYWxzZQokQXV0b0NvbmZpZ3VyZUxjbSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBBdXRvQ29uZmlndXJlTGNtIC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0IC1kZWZhdWx0IGZhbHNlCklmICgkTG9nRmxhZ3MpCnsKICAgIElmICgoJ0J5dGVzUmVjdicsJ0J5dGVzU2VudCcsJ0NsaWVudElQJywnQ29tcHV0ZXJOYW1lJywnQ29va2llJywnRGF0ZScsJ0hvc3QnLCdIdHRwU3RhdHVzJywnSHR0cFN1YlN0YXR1cycsJ01ldGhvZCcsJ1Byb3RvY29sVmVyc2lvbicsJ1JlZmVyZXInLCdTZXJ2ZXJJUCcsJ1NlcnZlclBvcnQnLCdTaXRlTmFtZScsJ1RpbWUnLCdUaW1lVGFrZW4nLCdVcmlRdWVyeScsJ1VyaVN0ZW0nLCdVc2VyQWdlbnQnLCdVc2VyTmFtZScsJ1dpbjMyU3RhdHVzJykgLWNvbnRhaW5zICRMb2dGbGFncyApIHsKICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICBGYWlsLUpzb24gJHJlc3VsdCAiT3B0aW9uIExvZ0ZsYWdzIGhhcyBpbnZhbGlkIHZhbHVlICRMb2dGbGFncy4gVmFsaWQgdmFsdWVzIGFyZSAnQnl0ZXNSZWN2JywnQnl0ZXNTZW50JywnQ2xpZW50SVAnLCdDb21wdXRlck5hbWUnLCdDb29raWUnLCdEYXRlJywnSG9zdCcsJ0h0dHBTdGF0dXMnLCdIdHRwU3ViU3RhdHVzJywnTWV0aG9kJywnUHJvdG9jb2xWZXJzaW9uJywnUmVmZXJlcicsJ1NlcnZlcklQJywnU2VydmVyUG9ydCcsJ1NpdGVOYW1lJywnVGltZScsJ1RpbWVUYWtlbicsJ1VyaVF1ZXJ5JywnVXJpU3RlbScsJ1VzZXJBZ2VudCcsJ1VzZXJOYW1lJywnV2luMzJTdGF0dXMnIgogICAgfQp9CgoKSWYgKCRMb2dGb3JtYXQpCnsKICAgIElmICgoJ0lJUycsJ05DU0EnLCdXM0MnKSAtY29udGFpbnMgJExvZ0Zvcm1hdCApIHsKICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICBGYWlsLUpzb24gJHJlc3VsdCAiT3B0aW9uIExvZ0Zvcm1hdCBoYXMgaW52YWxpZCB2YWx1ZSAkTG9nRm9ybWF0LiBWYWxpZCB2YWx1ZXMgYXJlICdJSVMnLCdOQ1NBJywnVzNDJyIKICAgIH0KfQoKCklmICgkTG9nUGVyaW9kKQp7CiAgICBJZiAoKCdEYWlseScsJ0hvdXJseScsJ01heFNpemUnLCdNb250aGx5JywnV2Vla2x5JykgLWNvbnRhaW5zICRMb2dQZXJpb2QgKSB7CiAgICB9CiAgICBFbHNlCiAgICB7CiAgICAgICAgRmFpbC1Kc29uICRyZXN1bHQgIk9wdGlvbiBMb2dQZXJpb2QgaGFzIGludmFsaWQgdmFsdWUgJExvZ1BlcmlvZC4gVmFsaWQgdmFsdWVzIGFyZSAnRGFpbHknLCdIb3VybHknLCdNYXhTaXplJywnTW9udGhseScsJ1dlZWtseSciCiAgICB9Cn0KCgpJZiAoJEF1dG9JbnN0YWxsTW9kdWxlKQp7CiAgICBJZiAoKCd0cnVlJywnZmFsc2UnKSAtY29udGFpbnMgJEF1dG9JbnN0YWxsTW9kdWxlICkgewogICAgfQogICAgRWxzZQogICAgewogICAgICAgIEZhaWwtSnNvbiAkcmVzdWx0ICJPcHRpb24gQXV0b0luc3RhbGxNb2R1bGUgaGFzIGludmFsaWQgdmFsdWUgJEF1dG9JbnN0YWxsTW9kdWxlLiBWYWxpZCB2YWx1ZXMgYXJlICd0cnVlJywnZmFsc2UnIgogICAgfQp9CgoKSWYgKCRBdXRvQ29uZmlndXJlTGNtKQp7CiAgICBJZiAoKCd0cnVlJywnZmFsc2UnKSAtY29udGFpbnMgJEF1dG9Db25maWd1cmVMY20gKSB7CiAgICB9CiAgICBFbHNlCiAgICB7CiAgICAgICAgRmFpbC1Kc29uICRyZXN1bHQgIk9wdGlvbiBBdXRvQ29uZmlndXJlTGNtIGhhcyBpbnZhbGlkIHZhbHVlICRBdXRvQ29uZmlndXJlTGNtLiBWYWxpZCB2YWx1ZXMgYXJlICd0cnVlJywnZmFsc2UnIgogICAgfQp9CgoKaWYgKCRQc0RzY1J1bkFzQ3JlZGVudGlhbF91c2VybmFtZSkKewokUHNEc2NSdW5Bc0NyZWRlbnRpYWxfc2VjdXJlcGFzc3dvcmQgPSAkUHNEc2NSdW5Bc0NyZWRlbnRpYWxfcGFzc3dvcmQgfCBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1hc1BsYWluVGV4dCAtRm9yY2UKJFBzRHNjUnVuQXNDcmVkZW50aWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCgkUHNEc2NSdW5Bc0NyZWRlbnRpYWxfdXNlcm5hbWUsJFBzRHNjUnVuQXNDcmVkZW50aWFsX3NlY3VyZXBhc3N3b3JkKQp9CgokRHNjUmVzb3VyY2VOYW1lID0gInhJaXNMb2dnaW5nIgoKJERzY01vZHVsZU5hbWUgPSAieHdlYmFkbWluaXN0cmF0aW9uIgoKI1RoaXMgY29kZSBjb21lcyBmcm9tIHBvd2Vyc2hlbGwyX2RzY3Jlc291cmNldmVyaWZ5LnBzMSBpbiB0aGUgRFNDLS0+QW5zaWJsZSBjb2RlZ2VuIHRvb2wKCiNWZXJpZnkgcG93ZXJzaGVsbCB2ZXJzaW9uCmlmICgoJHBzdmVyc2lvbnRhYmxlLnBzdmVyc2lvbi5tYWpvciAtZ2UgNSkgLWFuZCAoJHBzdmVyc2lvbnRhYmxlLnBzdmVyc2lvbi5idWlsZCAtZ2UgMTAwMTgpKQp7CgkjRG8gbm90aGluZwp9CkVsc2UKewoJRmFpbC1Kc29uICRyZXN1bHQgIkxvY2FsIHBvd2Vyc2hlbGwgdmVyc2lvbiBpcyBub3QgYXQgdGhlIHJldWlyZWQgdmVyc2lvbiAoZm91bmQgdmVyc2lvbiAkKCRQc3ZlcnNpb250YWJsZS5wc3ZlcnNpb24udG9zdHJpbmcoKSkgKSIKfQoKaWYgKCRBdXRvSW5zdGFsbE1vZHVsZSkKewogICAgJEF1dG9JbnN0YWxsTW9kdWxlID0gJEF1dG9JbnN0YWxsTW9kdWxlIHwgY29udmVydHRvLWJvb2wKfQoKCiRSZXNvdXJjZUV4aXN0cyA9IEdldC1Ec2NSZXNvdXJjZSAkZHNjcmVzb3VyY2VuYW1lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgppZiAoISRSZXNvdXJjZUV4aXN0cykKewogICAgI0Rvd25sb2FkIHRoZSBtb2R1bGUgY29udGFpbmluZyB0aGUgcmVzb3VyY2UgaWYgdGhhdCdzIGFsbG93ZWQKICAgIGlmICgkQXV0b0luc3RhbGxNb2R1bGUgfCBjb252ZXJ0dG8tYm9vbCkKICAgIHsKICAgICAgICAjVVNlIGZpbmQtcGFja2FnZSB0byBhdXRvLWluc3RhbGwgdGhlIG51Z2V0IGJpbmFyaWVzCiAgICAgICAgRmluZC1QYWNrYWdlIHNvbWV0aGluZyAtRm9yY2VCb290c3RyYXAgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBvdXQtbnVsbAogICAgICAgICRyZXMgPSBGaW5kLWRzY3Jlc291cmNlICRkc2NyZXNvdXJjZW5hbWUKICAgICAgICBpbnN0YWxsLW1vZHVsZSAkcmVzLm1vZHVsZW5hbWUgLWZvcmNlCiAgICAgICAgU2V0LUF0dHIgJHJlc3VsdCAiQXV0b0luc3RhbGxlZE1vZHVsZSIgJHJlcy5tb2R1bGVuYW1lCiAgICB9CiAgICAKICAgICRSZXNvdXJjZUV4aXN0cyA9IEdldC1Ec2NSZXNvdXJjZSAkZHNjcmVzb3VyY2VuYW1lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCn0KCmlmICghJFJlc291cmNlRXhpc3RzKQp7CiAgICBGYWlsLUpzb24gJHJlc3VsdCAiVW5hYmxlIHRvIGxvY2F0ZSBEU0MgbW9kdWxlICRkc2Ntb2R1bGVuYW1lIGFuZC9vciBEU0MgcmVzb3VyY2UgJGRzY3Jlc291cmNlbmFtZSIKfQoKI0NoZWNrIHRoYXQgTENNIGlzIGluIHRoZSByaWdodCBzdGF0dXMKJExjbSA9IEdldC1Ec2NMb2NhbENvbmZpZ3VyYXRpb25NYW5hZ2VyCmlmICgoJGxjbS5SZWZyZXNoTW9kZSkgLWVxICJEaXNhYmxlZCIpCnsKICAgICNBbGwgZ29vZAp9CkVsc2UKewogICAgaWYgKCgkYXV0b2NvbmZpZ3VyZUxjbSB8IGNvbnZlcnR0by1ib29sKSAtZXEgJHRydWUpCiAgICB7CiAgICAgICAgJHJlZnJlc2htb2RlID0gIkRpc2FibGVkIgogICAgICAgICNSZWNvbmZpZ3VyZSBMQ00KICAgICAgICBbRHNjTG9jYWxDb25maWd1cmF0aW9uTWFuYWdlcigpXQogICAgICAgIENvbmZpZ3VyYXRpb24gTWV0YSB7CiAgICAgICAgICAgICAgIFNldHRpbmdzIHsKICAgICAgICAgICAgICAgICAgIFJlZnJlc2hNb2RlID0gJFJlZnJlc2hNb2RlCiAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICAmIG1ldGEKICAgICAgICAgICAgU2V0LURzY0xvY2FsQ29uZmlndXJhdGlvbk1hbmFnZXIgLVBhdGggLlxNZXRhICAtRXJyb3JBY3Rpb24gU3RvcCAtRXJyb3JWYXJpYWJsZSBsY21lcnJvcgogICAgCiAgICAgICAgfQogICAgICAgIENhdGNoCiAgICAgICAgewogICAgICAgICAgICBGYWlsLWpzb24gJHJlc3VsdCAiRXJyb3IgcmVjb25maWd1cmluZyBMQ00iIAogICAgICAgIH0KICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICBGYWlsLWpzb24gJHJlc3VsdCAiRFNDIExvY2FsIENvbmZpZ3VyYXRpb24gTWFuYWdlciBpcyBub3Qgc2V0IHRvIGRpc2FibGVkLiBTZXQgdGhlIG1vZHVsZSBvcHRpb24gQXV0b0NvbmZpZ3VyZUxjbSB0byBUcnVlIGluIG9yZGVyIHRvIGF1dG8tY29uZmlndXJlIExDTSIgCiAgICB9Cgp9CgokQXR0cmlidXRlcyA9ICRwYXJhbXMgfCBnZXQtbWVtYmVyIHwgd2hlcmUgeyRfLk1lbWJlclRZcGUgLWVxICJub3RlcHJvcGVydHkifSAgfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IE5hbWUKJEF0dHJpYnV0ZXMgPSAkYXR0cmlidXRlcyB8IHdoZXJlIHskXyAtbmUgImF1dG9pbnN0YWxsbW9kdWxlIn0KJEF0dHJpYnV0ZXMgPSAkYXR0cmlidXRlcyB8IHdoZXJlIHskXyAtbmUgIkF1dG9Db25maWd1cmVMY20ifQokQXR0cmlidXRlcyA9ICRhdHRyaWJ1dGVzIHwgd2hlcmUgeyRfIC1ub3RsaWtlICJfYW5zaWJsZSoifQoKCmlmICghKCRBdHRyaWJ1dGVzKSkKewogICAgRmFpbC1Kc29uIC1vYmogJHJlc3VsdCAtbWVzc2FnZSAiTm8gYXR0cmlidXRlcyBzcGVjaWZpZWQiCn0KCiNBbHdheXMgcmV0dXJuIHRoZSBuYW1lCnNldC1hdHRyIC1vYmogJHJlc3VsdCAtbmFtZSAicmVzb3VyY2VfbmFtZSIgLXZhbHVlICRkc2NyZXNvdXJjZW5hbWUKc2V0LWF0dHIgLW9iaiAkcmVzdWx0IC1uYW1lICJBdHRyaWJ1dGVzIiAtdmFsdWUgJEF0dHJpYnV0ZXMKCiRBdHRyaWIgPSBAe30KCjwjCiRwYXJhbXMuS2V5cyB8IGZvcmVhY2gtb2JqZWN0IHsKICAgICRBdHRyaWIuQWRkKCRfLCRwYXJhbXMuSXRlbSgkXykpCiAgICBzZXQtYXR0ciAtb2JqICRyZXN1bHQgLW5hbWUgJF8gLXZhbHVlICRwYXJhbXMuSXRlbSgkXykKICAgIH0KIz4KCiRDaGVja01vZGUgPSAkRmFsc2UKJENoZWNrRmxhZyA9ICRwYXJhbXMucHNvYmplY3QuUHJvcGVydGllcyB8IHdoZXJlIHskXy5OYW1lIC1lcSAiX2Fuc2libGVfY2hlY2tfbW9kZSJ9CmlmICgkQ2hlY2tGbGFnKQp7CiAgICBpZiAoKCRDaGVja0ZsYWcuVmFsdWUpIC1lcSAkVHJ1ZSkKICAgIHsKICAgICAgICAkQ2hlY2tNb2RlID0gJFRydWUgICAgCiAgICB9CiAgICAKfQoKJEtleXMgPSAkcGFyYW1zLnBzb2JqZWN0LlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTWVtYmVyVFlwZSAtZXEgIk5vdGVwcm9wZXJ0eSJ9IHwgd2hlcmUgeyRfLk5hbWUgLW5lICJyZXNvdXJjZV9uYW1lIn0gfHdoZXJlIHskXy5OYW1lIC1uZSAiYXV0b2luc3RhbGxtb2R1bGUifSB8d2hlcmUgeyRfLk5hbWUgLW5lICJhdXRvY29uZmlndXJlbGNtIn0gfCB3aGVyZSB7JF8uTmFtZSAtbm90bGlrZSAiX2Fuc2libGUqIn0gfCAgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCmZvcmVhY2ggKCRrZXkgaW4gJGtleXMpCnsKICAgICRBdHRyaWIuYWRkKCRrZXksICgkcGFyYW1zLiRrZXkpKQogICAgc2V0LWF0dHIgLW9iaiAkcmVzdWx0IC1uYW1lICRrZXkgLXZhbHVlICgkcGFyYW1zLiRrZXkpCn0KCiRDb25maWcgPSBAewogICBOYW1lID0gKCRkc2NyZXNvdXJjZW5hbWUpCiAgIFByb3BlcnR5ID0gQHsKICAgICAgICB9CiAgICB9CgoKJFJlc291cmNlID0gR2V0LURzY1Jlc291cmNlIC1OYW1lICRkc2NyZXNvdXJjZW5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKaWYgKCEkUmVzb3VyY2UpCnsKICAgIEZhaWwtSnNvbiAtb2JqICRyZXN1bHQgLW1lc3NhZ2UgIlJlc291cmNlICRkc2NyZXNvdXJjZW5hbWUgbm90IGZvdW5kIgp9CgojQ29udmVydCBwYXJhbXMgdG8gY29ycmVjdCBkYXRhdHlwZSBhbmQgaW5qZWN0CiNDb252ZXJ0IHBhcmFtcyB0byBjb3JyZWN0IGRhdGF0eXBlIGFuZCBpbmplY3QKJGF0dHJpYi5LZXlzIHwgZm9yZWFjaC1vYmplY3QgewogICAgJEtleSA9ICRfLnJlcGxhY2UoIml0ZW1fbmFtZSIsICJuYW1lIikKICAgICRwcm9wID0gJHJlc291cmNlLlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTmFtZSAtZXEgJGtleX0KICAgIGlmICghJHByb3ApCiAgICB7CiAgICAgICAgI0lmIGl0cyBhIGNyZWRlbnRpYWwgc3BlY2lmaWVkIGFzICJjcmVkZW50aWFsIiwgQW5zaWJsZSB3aWxsIHN1cHBvcnQgY3JlZGVudGlhbF91c2VybmFtZSBhbmQgY3JlZGVudGlhbF9wYXNzd29yZC4gTmVlZCB0byBjaGVjayBmb3IgdGhhdAogICAgICAgICRwcm9wID0gJHJlc291cmNlLlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTmFtZSAtZXEgJGtleS5SZXBsYWNlKCJfdXNlcm5hbWUiLCIiKX0KICAgICAgICBpZiAoJHByb3ApCiAgICAgICAgewogICAgICAgICAgICAjV2UgbmVlZCB0byBjb25zdHJ1Y3QgYSBjcmVkIG9iamVjdC4gQXQgdGhpcyBwb2ludCBrZXl2YWx1ZSBpcyB0aGUgdXNlcm5hbWUsIHNvIGdyYWIgdGhlIHBhc3N3b3JkCiAgICAgICAgICAgICRQcm9wVXNlck5hbWVWYWx1ZSA9ICRhdHRyaWIuSXRlbSgkXykKICAgICAgICAgICAgJFByb3BQYXNzd29yZCA9ICRrZXkuUmVwbGFjZSgiX3VzZXJuYW1lIiwiX3Bhc3N3b3JkIikKICAgICAgICAgICAgJFByb3BQYXNzd29yZFZhbHVlID0gJGF0dHJpYi4kUHJvcFBhc3N3b3JkCgogICAgICAgICAgICAkY3JlZCA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWwgKCRQcm9wVXNlck5hbWVWYWx1ZSwgKCRQcm9wUGFzc3dvcmRWYWx1ZSB8IENvbnZlcnRUby1TZWN1cmVTdHJpbmcgLUFzUGxhaW5UZXh0IC1Gb3JjZSkpCiAgICAgICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0kS2V5VmFsdWUgPSAkY3JlZAogICAgICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LlJlcGxhY2UoIl91c2VybmFtZSIsIiIpLCRLZXlWYWx1ZSkKICAgICAgICB9CiAgICAgICAgRWxzZUlmICgka2V5LkNvbnRhaW5zKCJfcGFzc3dvcmQiKSkKICAgICAgICB7CiAgICAgICAgICAgICNEbyBub3RoaW5nLiBXZSBzdWNrIGluIHRoZSBwYXNzd29yZCBpbiB0aGUgaGFuZGxlciBmb3IgX3VzZXJuYW1lLCBzbyB3ZSBjYW4ganVzdCBza2lwIGl0LgogICAgICAgIH0KICAgICAgICBFbHNlCiAgICAgICAgewogICAgICAgICAgICBGYWlsLUpzb24gLW9iaiAkcmVzdWx0IC1tZXNzYWdlICJQcm9wZXJ0eSAka2V5IGluIHJlc291cmNlICRkc2NyZXNvdXJjZW5hbWUgaXMgbm90IGEgdmFsaWQgcHJvcGVydHkiCiAgICAgICAgfQogICAgICAgIAogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbc3RyaW5nXSIpCiAgICB7CiAgICAgICAgW1N0cmluZ10kS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICAgJGNvbmZpZy5Qcm9wZXJ0eS5BZGQoJGtleSwkS2V5VmFsdWUpCiAgICB9CiAgICBFbHNlSWYgKCRwcm9wLlByb3BlcnR5VHlwZSAtZXEgIltzdHJpbmdbXV0iKQogICAgewogICAgICAgICNLZXlWYWx1ZSBpcyBhbiBhcnJheSBvZiBzdHJpbmdzCiAgICAgICAgW1N0cmluZ10kVGVtcEtleVZhbHVlID0gJGF0dHJpYi5JdGVtKCRfKQogICAgICAgIFtTdHJpbmdbXV0kS2V5VmFsdWUgPSAkVGVtcEtleVZhbHVlLlNwbGl0KCIsIikuVHJpbSgpCgogICAgICAgICRjb25maWcuUHJvcGVydHkuQWRkKCRrZXksJEtleVZhbHVlKQogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbVUludDMyW11dIikKICAgIHsKICAgICAgICAjS2V5VmFsdWUgaXMgYW4gYXJyYXkgb2YgaW50ZWdlcnMKICAgICAgICBbU3RyaW5nXSRUZW1wS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICAgW1VJbnQzMltdXSRLZXlWYWx1ZSA9ICRhdHRyaWIuSXRlbSgkXy5zcGxpdCgiLCIpLlRyaW0oKSkKICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LCRLZXlWYWx1ZSkKICAgIH0KICAgIEVsc2VJZiAoJHByb3AuUHJvcGVydHlUeXBlIC1lcSAiW2Jvb2xdIikKICAgIHsKICAgICAgICBpZiAoJGF0dHJpYi5JdGVtKCRfKSAtbGlrZSAidHJ1ZSIpCiAgICAgICAgewogICAgICAgICAgICBbYm9vbF0kS2V5VmFsdWUgPSAkdHJ1ZQogICAgICAgIH0KICAgICAgICBFbHNlSWYgKCRhdHRyaWIuSXRlbSgkXykgLWxpa2UgImZhbHNlIikKICAgICAgICB7CiAgICAgICAgICAgIFtib29sXSRLZXlWYWx1ZSA9ICRmYWxzZQogICAgICAgIH0KICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LCRLZXlWYWx1ZSkKICAgIH0KICAgIEVsc2VJZiAoJHByb3AuUHJvcGVydHlUeXBlIC1lcSAiW2ludF0iKQogICAgewogICAgICAgIFtpbnRdJEtleVZhbHVlID0gJGF0dHJpYi5JdGVtKCRfKQogICAgICAgICRjb25maWcuUHJvcGVydHkuQWRkKCRrZXksJEtleVZhbHVlKQogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbQ2ltSW5zdGFuY2VbXV0iKQogICAgewogICAgICAjS2V5VmFsdWUgaXMgYW4gYXJyYXkgb2YgQ2ltSW5zdGFuY2UKICAgICAgW0NpbUluc3RhbmNlW11dJEtleVZhbCA9IEAoKQogICAgICBbU3RyaW5nXSRUZW1wS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICNOZWVkIHRvIHNwbGl0IG9uIHRoZSBzdHJpbmcgfSwgYmVjYXVzZSBzb21lIHByb3BlcnR5IHZhbHVlcyBoYXZlIGNvbW1hcyBpbiB0aGVtCiAgICAgIFtTdHJpbmdbXV0kS2V5VmFsdWVTdHIgPSAkVGVtcEtleVZhbHVlIC1zcGxpdCgifSwiKQogICAgICAjR28gdGhyb3VnaCBlYWNoIHN0cmluZyBvZiBwcm9wZXJ0aWVzIGFuZCBjcmVhdGUgYSBoYXNoIG9mIHRoZW0KICAgICAgZm9yZWFjaCgkc3RyIGluICRLZXlWYWx1ZVN0cikKICAgICAgewogICAgICAgIFtzdHJpbmdbXV0kcHJvcGVydGllcyA9ICRzdHIuU3BsaXQoInsiKVsxXS5SZXBsYWNlKCJ9IiwiIikuVHJpbSgpLlNwbGl0KFtlbnZpcm9ubWVudF06Ok5ld0xpbmUpLlRyaW0oKQogICAgICAgICRwcnBoID0gQHt9CiAgICAgICAgZm9yZWFjaCgkcCBpbiAkcHJvcGVydGllcykKICAgICAgICB7CiAgICAgICAgICAkcEFyciA9ICRwIC1zcGxpdCAiPSIKICAgICAgICAgICNpZiB0aGUgdmFsdWUgY2FuIGJlIGFuIGludCB3ZSBtdXN0IGNvbnZlcnQgaXQgdG8gYW4gaW50CiAgICAgICAgICBpZihbYm9vbF0oJHBBcnJbMV0gLWFzIFtpbnRdIC1pcyBbaW50XSkpCiAgICAgICAgICB7CiAgICAgICAgICAgICAgJHBycGguQWRkKCRwQXJyWzBdLlRyaW0oKSwkcEFyclsxXS5UcmltKCkgLWFzIFtpbnRdKQogICAgICAgICAgfQogICAgICAgICAgZWxzZQogICAgICAgICAgewogICAgICAgICAgICAgICRwcnBoLkFkZCgkcEFyclswXS5UcmltKCksJHBBcnJbMV0uVHJpbSgpKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjY3JlYXRlIHRoZSBuZXcgQ2ltSW5zdGFuY2UKICAgICAgICAkY2ltID0gTmV3LUNpbUluc3RhbmNlIC1DbGFzc05hbWUgJHN0ci5TcGxpdCgieyIpWzBdLlRyaW0oKSAtUHJvcGVydHkgJHBycGggLUNsaWVudE9ubHkKICAgICAgICAjYWRkIHRoZSBuZXcgQ2ltSW5zdGFuY2UgdG8gdGhlIGFycmF5CiAgICAgICAgJEtleVZhbCArPSAkY2ltCiAgICAgIH0KICAgICAgJGNvbmZpZy5Qcm9wZXJ0eS5BZGQoJGtleSwkS2V5VmFsKQogICAgfQogIH0KCnRyeQp7CiAgICAjSW52b2tlIFdNRjUgcHJvZHVjdGlvbiBwcmV2aWV3IGRpZmZlcmVudGx5IHRoYW4gZmViIHByZXZpZXcKICAgICRUYXJnZXRWZXJzaW9uID0gW3ZlcnNpb25dOjpuZXcoIjUuMC4xMDUxNC42IikKICAgIGlmICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLkNvbXBhcmVUbygkVGFyZ2V0VmVyc2lvbikgLWdlIDApCiAgICB7CiAgICAgICAgI0N1cnJlbnQgaG9zdHMgdmVyc2lvbiBpcyBwcm9kdWN0aW9uIHByZXZvZXcgb3IgaGlnaGVyLiBVc2UgbW9kdWxlbmFtZSB3aGVuIGludm9raW5nLgogICAgICAgIGlmICgkcmVzb3VyY2UuTW9kdWxlTmFtZSAtbmUgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICAkUGFyYW1zID0gQHsiTW9kdWxlbmFtZSI9JHJlc291cmNlLk1vZHVsZW5hbWV9ICAgIAogICAgICAgIH0KICAgICAgICBlbHNlIAogICAgICAgIHsKICAgICAgICAgICAgJFBhcmFtcyA9IEB7Ik1vZHVsZW5hbWUiPSJQU0Rlc2lyZWRTdGF0ZUNvbmZpZ3VyYXRpb24ifSAgICAKICAgICAgICB9CiAgICAgICAgCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJFBhcmFtcyA9IEB7fQogICAgfQoKICAgICRUZXN0UmVzdWx0ID0gSW52b2tlLURzY1Jlc291cmNlIEBDb25maWcgLU1ldGhvZCBUZXN0IEBwYXJhbXMgLUVycm9yVmFyaWFibGUgVGVzdEVycm9yIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICBpZiAoJFRlc3RFcnJvcikKICAgIHsKICAgICAgIHRocm93ICgkVGVzdEVycm9yWzBdLkV4Y2VwdGlvbi5NZXNzYWdlKQogICAgfQogICAgRWxzZUlmICgoJHRlc3RSZXN1bHQuSW5EZXNpcmVkU3RhdGUpIC1uZSAkdHJ1ZSkgCiAgICB7CiAgICAgICAgaWYgKCRDaGVja01vZGUgLWVxICRGYWxzZSkKICAgICAgICB7CiAgICAgICAgICAgICRTZXQgPSBJbnZva2UtRHNjUmVzb3VyY2UgLU1ldGhvZCBTZXQgQENvbmZpZyAgQHBhcmFtcyAtRXJyb3JWYXJpYWJsZSBTZXRFcnJvciAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgIH0KICAgICAgICAKICAgICAgICBTZXQtQXR0ciAkcmVzdWx0ICJjaGFuZ2VkIiAkdHJ1ZQogICAgICAgIGlmICgoZ2V0LXZhcmlhYmxlIHwgd2hlcmUgeyRfLk5hbWUgLWVxICJzZXRlcnJvciJ9KSAtYW5kICgkU2V0RXJyb3IuQ291bnQgLWd0IDApKQogICAgICAgIHsKICAgICAgICAgICB0aHJvdyAoJFNldEVycm9yWzBdLkV4Y2VwdGlvbi5NZXNzYWdlKQogICAgICAgIH0KICAgIH0KCn0KQ2F0Y2gKewogICAgRmFpbC1Kc29uIC1vYmogJHJlc3VsdCAtbWVzc2FnZSAkX1swXS5FeGNlcHRpb24uTWVzc2FnZQp9CgoKI3NldC1hdHRyIC1vYmogJHJlc3VsdCAtbmFtZSAicHJvcGVydHkiIC12YWx1ZSAkcHJvcGVydHkKRXhpdC1Kc29uIC1vYmogJHJlc3VsdAoKCgoK
