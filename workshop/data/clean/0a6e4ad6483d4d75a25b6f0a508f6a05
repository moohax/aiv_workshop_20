PesterState.ps1,a4c18e8ef60290261b99993a13efbdca,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gTmV3LVBlc3RlclN0YXRlCnsKICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N0cmluZ10kUGF0aCwKICAgICAgICBbU3RyaW5nW11dJFRhZ0ZpbHRlciwKICAgICAgICBbU3RyaW5nW11dJFRlc3ROYW1lRmlsdGVyLAogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlNlc3Npb25TdGF0ZV0kU2Vzc2lvblN0YXRlCiAgICApCgogICAgaWYgKCRudWxsIC1lcSAkU2Vzc2lvblN0YXRlKSB7ICRTZXNzaW9uU3RhdGUgPSAkRXhlY3V0aW9uQ29udGV4dC5TZXNzaW9uU3RhdGUgfQoKICAgIE5ldy1Nb2R1bGUgLU5hbWUgUGVzdGVyIC1Bc0N1c3RvbU9iamVjdCAtU2NyaXB0QmxvY2sgewogICAgICAgIHBhcmFtICgKICAgICAgICAgICAgW1N0cmluZ10kX3BhdGgsCiAgICAgICAgICAgIFtTdHJpbmdbXV0kX3RhZ0ZpbHRlciwKICAgICAgICAgICAgW1N0cmluZ1tdXSRfdGVzdE5hbWVGaWx0ZXIsCiAgICAgICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlNlc3Npb25TdGF0ZV0kX3Nlc3Npb25TdGF0ZQogICAgICAgICkKCiAgICAgICAgI3B1YmxpYyByZWFkLW9ubHkKICAgICAgICAkUGF0aCA9ICRfcGF0aAogICAgICAgICRUYWdGaWx0ZXIgPSAkX3RhZ0ZpbHRlcgogICAgICAgICRUZXN0TmFtZUZpbHRlciA9ICRfdGVzdE5hbWVGaWx0ZXIKCiAgICAgICAgJHNjcmlwdDpTZXNzaW9uU3RhdGUgPSAkX3Nlc3Npb25TdGF0ZQogICAgICAgICRzY3JpcHQ6Q3VycmVudENvbnRleHQgPSAiIgogICAgICAgICRzY3JpcHQ6Q3VycmVudERlc2NyaWJlID0gIiIKICAgICAgICAkc2NyaXB0OkN1cnJlbnRUZXN0ID0gIiIKICAgICAgICAkc2NyaXB0OlN0b3B3YXRjaCA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuU3RvcHdhdGNoXTo6U3RhcnROZXcoKQogICAgICAgICRzY3JpcHQ6TW9zdFJlY2VudFRpbWVzdGFtcCA9IDAKICAgICAgICAkc2NyaXB0OkNvbW1hbmRDb3ZlcmFnZSA9IEAoKQogICAgICAgICRzY3JpcHQ6QmVmb3JlRWFjaCA9IEAoKQogICAgICAgICRzY3JpcHQ6QWZ0ZXJFYWNoID0gQCgpCgogICAgICAgICRzY3JpcHQ6VGVzdFJlc3VsdCA9IEAoKQoKICAgICAgICBmdW5jdGlvbiBFbnRlckRlc2NyaWJlICgkTmFtZSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkQ3VycmVudERlc2NyaWJlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aHJvdyBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XE5ldy1PYmplY3QgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbiAiWW91IGFscmVhZHkgYXJlIGluIERlc2NyaWJlLCB5b3UgY2Fubm90IGVudGVyIERlc2NyaWJlIHR3aWNlIgogICAgICAgICAgICB9CiAgICAgICAgICAgICRzY3JpcHQ6Q3VycmVudERlc2NyaWJlID0gJE5hbWUKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIExlYXZlRGVzY3JpYmUKICAgICAgICB7CiAgICAgICAgICAgIGlmICggJEN1cnJlbnRDb250ZXh0ICkgewogICAgICAgICAgICAgICAgdGhyb3cgTWljcm9zb2Z0LlBvd2VyU2hlbGwuVXRpbGl0eVxOZXctT2JqZWN0IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gIkNhbm5vdCBsZWF2ZSBEZXNjcmliZSBiZWZvcmUgbGVhdmluZyBDb250ZXh0IgogICAgICAgICAgICB9CgogICAgICAgICAgICAkc2NyaXB0OkN1cnJlbnREZXNjcmliZSA9ICRudWxsCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBFbnRlckNvbnRleHQgKCROYW1lKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCAtbm90ICRDdXJyZW50RGVzY3JpYmUgKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aHJvdyBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XE5ldy1PYmplY3QgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbiAiQ2Fubm90IGVudGVyIENvbnRleHQgYmVmb3JlIGVudGVyaW5nIERlc2NyaWJlIgogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRDdXJyZW50Q29udGV4dCApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IE1pY3Jvc29mdC5Qb3dlclNoZWxsLlV0aWxpdHlcTmV3LU9iamVjdCBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uICJZb3UgYWxyZWFkeSBhcmUgaW4gQ29udGV4dCwgeW91IGNhbm5vdCBlbnRlciBDb250ZXh0IHR3aWNlIgogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJEN1cnJlbnRUZXN0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aHJvdyBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XE5ldy1PYmplY3QgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbiAiWW91IGFscmVhZHkgYXJlIGluIEl0LCB5b3UgY2Fubm90IGVudGVyIENvbnRleHQgaW5zaWRlIEl0IgogICAgICAgICAgICB9CgogICAgICAgICAgICAkc2NyaXB0OkN1cnJlbnRDb250ZXh0ID0gJE5hbWUKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIExlYXZlQ29udGV4dAogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRDdXJyZW50VGVzdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgTWljcm9zb2Z0LlBvd2VyU2hlbGwuVXRpbGl0eVxOZXctT2JqZWN0IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gIkNhbm5vdCBsZWF2ZSBDb250ZXh0IGJlZm9yZSBsZWF2aW5nIEl0IgogICAgICAgICAgICB9CgogICAgICAgICAgICAkc2NyaXB0OkN1cnJlbnRDb250ZXh0ID0gJG51bGwKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEVudGVyVGVzdChbc3RyaW5nXSROYW1lKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKC1ub3QgJHNjcmlwdDpDdXJyZW50RGVzY3JpYmUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IE1pY3Jvc29mdC5Qb3dlclNoZWxsLlV0aWxpdHlcTmV3LU9iamVjdCBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uICJDYW5ub3QgZW50ZXIgQ29udGV4dCBiZWZvcmUgZW50ZXJpbmcgRGVzY3JpYmUiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICggJEN1cnJlbnRUZXN0ICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgTWljcm9zb2Z0LlBvd2VyU2hlbGwuVXRpbGl0eVxOZXctT2JqZWN0IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gIllvdSBhbHJlYWR5IGFyZSBpbiBJdCwgeW91IGNhbm5vdCBlbnRlciBJdCB0d2ljZSIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHNjcmlwdDpDdXJyZW50VGVzdCA9ICROYW1lCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBMZWF2ZVRlc3QKICAgICAgICB7CiAgICAgICAgICAgICRzY3JpcHQ6Q3VycmVudFRlc3QgPSAkbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQWRkVGVzdFJlc3VsdCAoIFtzdHJpbmddJE5hbWUsIFtib29sXSRQYXNzZWQsIFtOdWxsYWJsZVtUaW1lU3Bhbl1dJFRpbWUsIFtzdHJpbmddJEZhaWx1cmVNZXNzYWdlLCBbU3RyaW5nXSRTdGFja1RyYWNlICkKICAgICAgICB7CiAgICAgICAgICAgICRwcmV2aW91c1RpbWUgPSAkc2NyaXB0Ok1vc3RSZWNlbnRUaW1lc3RhbXAKICAgICAgICAgICAgJHNjcmlwdDpNb3N0UmVjZW50VGltZXN0YW1wID0gJHNjcmlwdDpTdG9wd2F0Y2guRWxhcHNlZAoKICAgICAgICAgICAgaWYgKCRudWxsIC1lcSAkVGltZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFRpbWUgPSAkc2NyaXB0Ok1vc3RSZWNlbnRUaW1lc3RhbXAgLSAkcHJldmlvdXNUaW1lCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRTY3JpcHQ6VGVzdFJlc3VsdCArPSBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XE5ldy1PYmplY3QgLVR5cGVOYW1lIFBzT2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgICAgICAgICAgRGVzY3JpYmUgICAgICAgPSAkQ3VycmVudERlc2NyaWJlCiAgICAgICAgICAgICAgICBDb250ZXh0ICAgICAgICA9ICRDdXJyZW50Q29udGV4dAogICAgICAgICAgICAgICAgTmFtZSAgICAgICAgICAgPSAkTmFtZQogICAgICAgICAgICAgICAgUGFzc2VkICAgICAgICAgPSAkUGFzc2VkCiAgICAgICAgICAgICAgICBUaW1lICAgICAgICAgICA9ICRUaW1lCiAgICAgICAgICAgICAgICBGYWlsdXJlTWVzc2FnZSA9ICRGYWlsdXJlTWVzc2FnZQogICAgICAgICAgICAgICAgU3RhY2tUcmFjZSAgICAgPSAkU3RhY2tUcmFjZQogICAgICAgICAgICB9IHwgTWljcm9zb2Z0LlBvd2VyU2hlbGwuVXRpbGl0eVxTZWxlY3QtT2JqZWN0IERlc2NyaWJlLCBDb250ZXh0LCBOYW1lLCBQYXNzZWQsIFRpbWUsIEZhaWx1cmVNZXNzYWdlLCBTdGFja1RyYWNlCiAgICAgICAgfQoKICAgICAgICAkRXhwb3J0ZWRWYXJpYWJsZXMgPSAiUGF0aCIsCiAgICAgICAgIlRhZ0ZpbHRlciIsCiAgICAgICAgIlRlc3ROYW1lRmlsdGVyIiwKICAgICAgICAiVGVzdFJlc3VsdCIsCiAgICAgICAgIkN1cnJlbnRDb250ZXh0IiwKICAgICAgICAiQ3VycmVudERlc2NyaWJlIiwKICAgICAgICAiQ3VycmVudFRlc3QiLAogICAgICAgICJTZXNzaW9uU3RhdGUiLAogICAgICAgICJDb21tYW5kQ292ZXJhZ2UiLAogICAgICAgICJCZWZvcmVFYWNoIiwKICAgICAgICAiQWZ0ZXJFYWNoIgoKICAgICAgICAkRXhwb3J0ZWRGdW5jdGlvbnMgPSAiRW50ZXJDb250ZXh0IiwKICAgICAgICAiTGVhdmVDb250ZXh0IiwKICAgICAgICAiRW50ZXJEZXNjcmliZSIsCiAgICAgICAgIkxlYXZlRGVzY3JpYmUiLAogICAgICAgICJFbnRlclRlc3QiLAogICAgICAgICJMZWF2ZVRlc3QiLAogICAgICAgICJBZGRUZXN0UmVzdWx0IgoKICAgICAgICBFeHBvcnQtTW9kdWxlTWVtYmVyIC1WYXJpYWJsZSAkRXhwb3J0ZWRWYXJpYWJsZXMgLWZ1bmN0aW9uICRFeHBvcnRlZEZ1bmN0aW9ucwogICAgfSAtQXJndW1lbnRMaXN0ICRQYXRoLCAkVGFnRmlsdGVyLCAkVGVzdE5hbWVGaWx0ZXIsICRTZXNzaW9uU3RhdGUgfAogICAgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBTY3JpcHRQcm9wZXJ0eSAtTmFtZSBUb3RhbENvdW50IC1WYWx1ZSB7CiAgICAgICAgQCggJHRoaXMuVGVzdFJlc3VsdCApLkNvdW50CiAgICB9IC1QYXNzVGhydSB8CiAgICBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIFNjcmlwdFByb3BlcnR5IC1OYW1lIFBhc3NlZENvdW50IC1WYWx1ZSB7CiAgICAgICAgQCggJHRoaXMuVGVzdFJlc3VsdCB8IHdoZXJlIHsgJF8uUGFzc2VkIH0gKS5jb3VudAogICAgfSAtUGFzc1RocnUgfAogICAgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBTY3JpcHRQcm9wZXJ0eSAtTmFtZSBGYWlsZWRDb3VudCAtVmFsdWUgewogICAgICAgIEAoICR0aGlzLlRlc3RSZXN1bHQgfCB3aGVyZSB7IC1ub3QgJF8uUGFzc2VkIH0gKS5jb3VudAogICAgfSAtUGFzc1RocnUgfAogICAgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBTY3JpcHRQcm9wZXJ0eSAtTmFtZSBUaW1lIC1WYWx1ZSB7CiAgICAgICAgJHRoaXMuVGVzdFJlc3VsdCB8IGZvcmVhY2ggeyBbdGltZXNwYW5dJHRvdGFsPTAgfSB7ICR0b3RhbCA9ICR0b3RhbCArICggJF8udGltZSApIH0geyBbdGltZXNwYW5dJHRvdGFsIH0KICAgIH0gLVBhc3NUaHJ1IHwKICAgIEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgU2NyaXB0UHJvcGVydHkgLU5hbWUgU2NvcGUgLVZhbHVlIHsKICAgICAgICBpZiAoJHRoaXMuQ3VycmVudFRlc3QpIHsgJ0l0JyB9CiAgICAgICAgZWxzZWlmICgkdGhpcy5DdXJyZW50Q29udGV4dCkgIHsgJ0NvbnRleHQnIH0KICAgICAgICBlbHNlaWYgKCR0aGlzLkN1cnJlbnREZXNjcmliZSkgeyAnRGVzY3JpYmUnIH0KICAgICAgICBlbHNlIHsgJG51bGwgfQogICAgfSAtUGFzc3RocnUgfAogICAgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBTY3JpcHRQcm9wZXJ0eSAtTmFtZSBQYXJlbnRTY29wZSAtVmFsdWUgewogICAgICAgICRwYXJlbnRTY29wZSA9ICRudWxsCiAgICAgICAgJHNjb3BlID0gJHRoaXMuU2NvcGUKCiAgICAgICAgaWYgKCRzY29wZSAtZXEgJ0l0JyAtYW5kICR0aGlzLkN1cnJlbnRDb250ZXh0KQogICAgICAgIHsKICAgICAgICAgICAgJHBhcmVudFNjb3BlID0gJ0NvbnRleHQnCiAgICAgICAgfQoKICAgICAgICBpZiAoJG51bGwgLWVxICRwYXJlbnRTY29wZSAtYW5kICRzY29wZSAtbmUgJ0Rlc2NyaWJlJyAtYW5kICR0aGlzLkN1cnJlbnREZXNjcmliZSkKICAgICAgICB7CiAgICAgICAgICAgICRwYXJlbnRTY29wZSA9ICdEZXNjcmliZScKICAgICAgICB9CgogICAgICAgIHJldHVybiAkcGFyZW50U2NvcGUKICAgIH0gLVBhc3NUaHJ1Cn0KCmZ1bmN0aW9uIFdyaXRlLURlc2NyaWJlCnsKICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKG1hbmRhdG9yeT0kdHJ1ZSwgdmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXSROYW1lCiAgICApCiAgICBwcm9jZXNzIHsKICAgICAgICBXcml0ZS1Ib3N0IERlc2NyaWJpbmcgJE5hbWUgLUZvcmVncm91bmRDb2xvciBNYWdlbnRhCiAgICB9Cn0KCmZ1bmN0aW9uIFdyaXRlLUNvbnRleHQKewogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIobWFuZGF0b3J5PSR0cnVlLCB2YWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldJE5hbWUKICAgICkKICAgIHByb2Nlc3MgewogICAgICAgICRtYXJnaW4gPSAiICAgIgogICAgICAgIE1pY3Jvc29mdC5Qb3dlclNoZWxsLlV0aWxpdHlcV3JpdGUtSG9zdCAke21hcmdpbn1Db250ZXh0ICROYW1lIC1Gb3JlZ3JvdW5kQ29sb3IgTWFnZW50YQogICAgfQp9CgpmdW5jdGlvbiBXcml0ZS1QZXN0ZXJSZXN1bHQKewogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIobWFuZGF0b3J5PSR0cnVlLCB2YWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldCiAgICAgICAgJFRlc3RSZXN1bHQKICAgICkKICAgIHByb2Nlc3MgewogICAgICAgICR0ZXN0RGVwdGggPSBpZiAoICRUZXN0UmVzdWx0LkNvbnRleHQgKSB7IDQgfSBlbHNlaWYgKCAkVGVzdFJlc3VsdC5EZXNjcmliZSApIHsgMSB9IGVsc2UgeyAwIH0KCiAgICAgICAgJG1hcmdpbiA9ICIgIiAqICRUZXN0RGVwdGgKICAgICAgICAkZXJyb3JfbWFyZ2luID0gJG1hcmdpbiArICIgICIKICAgICAgICAkb3V0cHV0ID0gJFRlc3RSZXN1bHQubmFtZQogICAgICAgICRodW1hblRpbWUgPSBHZXQtSHVtYW5UaW1lICRUZXN0UmVzdWx0LlRpbWUuVG90YWxTZWNvbmRzCgogICAgICAgIGlmKCRUZXN0UmVzdWx0LlBhc3NlZCkKICAgICAgICB7CiAgICAgICAgICAgICIkbWFyZ2luWytdICRvdXRwdXQgJGh1bWFuVGltZSIgfCBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvciBEYXJrR3JlZW4KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICIkbWFyZ2luWy1dICRvdXRwdXQgJGh1bWFuVGltZSIgfCBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvciByZWQKICAgICAgICAgICAgTWljcm9zb2Z0LlBvd2VyU2hlbGwuVXRpbGl0eVxXcml0ZS1Ib3N0IC1Gb3JlZ3JvdW5kQ29sb3IgcmVkICQoJFRlc3RSZXN1bHQuZmFpbHVyZU1lc3NhZ2UgLXJlcGxhY2UgJyg/bSleJywkZXJyb3JfbWFyZ2luKQogICAgICAgICAgICBNaWNyb3NvZnQuUG93ZXJTaGVsbC5VdGlsaXR5XFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvciByZWQgJCgkVGVzdFJlc3VsdC5zdGFja1RyYWNlIC1yZXBsYWNlICcoP20pXicsJGVycm9yX21hcmdpbikKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIFdyaXRlLVBlc3RlclJlcG9ydAp7CiAgICBwYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihtYW5kYXRvcnk9JHRydWUsIHZhbHVlRnJvbVBpcGVsaW5lPSR0cnVlKV0KICAgICAgICAkUGVzdGVyU3RhdGUKICAgICkKCiAgICBXcml0ZS1Ib3N0ICJUZXN0cyBjb21wbGV0ZWQgaW4gJChHZXQtSHVtYW5UaW1lICRQZXN0ZXJTdGF0ZS5UaW1lLlRvdGFsU2Vjb25kcykiCiAgICBXcml0ZS1Ib3N0ICJQYXNzZWQ6ICQoJFBlc3RlclN0YXRlLlBhc3NlZENvdW50KSBGYWlsZWQ6ICQoJFBlc3RlclN0YXRlLkZhaWxlZENvdW50KSIKfQo=
