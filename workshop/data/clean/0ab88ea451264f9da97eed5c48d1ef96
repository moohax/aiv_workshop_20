setupFunctions.ps1,605833e1821f7ad4db2b81b23a13a2af,Scan result is 1. IsMalware: 0,RnVuY3Rpb24gZ2VuZXJhdGVCYXNlRGlyKCkKewoJc3dpdGNoICgkcGFyYW1zLlNRTFZFUlNJT04pIHsKCQkiMjAwOCIgeyAkZkJhc2VEaXIgPSAiTVNTUUwxMC4iICsgJHBhcmFtcy5JTlNUQU5DRU5BTUUgfQoJCSIyMDEyIiB7ICRmQmFzZURpciA9ICJNU1NRTDExLiIgKyAkcGFyYW1zLklOU1RBTkNFTkFNRSB9CgkJIjIwMTQiIHsgJGZCYXNlRGlyID0gIk1TU1FMMTIuIiArICRwYXJhbXMuSU5TVEFOQ0VOQU1FIH0KCQkiMjAxNiIgeyAkZkJhc2VEaXIgPSAiTVNTUUwxMy4iICsgJHBhcmFtcy5JTlNUQU5DRU5BTUUgfQoJfQoJcmV0dXJuICRmQmFzZURpcgoKfQoKRnVuY3Rpb24gY3JlYXRlQ21kSW5zdGFsbCgpCnsKCglbU3RyaW5nXSAkaW5zdGFsbENNRD0iIgoKCSRpbnN0YWxsQ01EID0gJGluc3RhbGxhdGlvblBhdGggKyAiXFNldHVwLmV4ZSAvcSIKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvQUNUSU9OPSIgKyAkcGFyYW1zLkFDVElPTgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9GRUFUVVJFUz0iICsgJHBhcmFtcy5GRUFUVVJFUwoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9JTlNUQU5DRU5BTUU9IiArICRwYXJhbXMuSU5TVEFOQ0VOQU1FCgkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NBUFdEPSciICsgJHBTQVBXRCArICInIgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9TUUxTWVNBRE1JTkFDQ09VTlRTPSIgKyAkcGFyYW1zLlNRTFNZU0FETUlOQUNDT1VOVFMKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMU1ZDQUNDT1VOVD0iICsgJHBhcmFtcy5TUUxTVkNBQ0NPVU5UCgkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTFNWQ1BBU1NXT1JEPSciICsgJHBTUUxTVkNQQVNTV09SRCArICInIgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9BR1RTVkNBQ0NPVU5UPSIgKyAkcGFyYW1zLkFHVFNWQ0FDQ09VTlQKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvQUdUU1ZDUEFTU1dPUkQ9JyIgKyAkcEFHVFNWQ1BBU1NXT1JEICsgIiciCgkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTENPTExBVElPTj0iICsgJHBhcmFtcy5TUUxDT0xMQVRJT04KCgkjIERpcmVjdG9yaWVzCgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9JTlNUQUxMU1FMREFUQURJUj0nIiArICRwYXJhbXMuSU5TVEFMTFNRTERBVEFESVIgICsgIlwnIgoKCWlmICgtTm90ICgkcGFyYW1zLlNRTFZFUlNJT04gLWVxICIyMDA4IiAtb3IgJHBhcmFtcy5TUUxWRVJTSU9OIC1lcSAiMjAwOFIyIiApKSB7CgkJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9JQUNDRVBUU1FMU0VSVkVSTElDRU5TRVRFUk1TPSIgKyAkcGFyYW1zLklBQ0NFUFRTUUxTRVJWRVJMSUNFTlNFVEVSTVMKCX0KCglpZiAoICRwYXJhbXMuUENVU09VUkNFLkxlbmd0aCAtZ3QgMCApIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1BDVVNPVVJDRT0iICsgJHBhcmFtcy5QQ1VTT1VSQ0UKCX0KCglpZiAoICRwYXJhbXMuQ1VTT1VSQ0UuTGVuZ3RoIC1ndCAwICkgewoJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvQ1VTT1VSQ0U9IiArICRwYXJhbXMuQ1VTT1VSQ0UKCX0KCglpZiAoICRwYXJhbXMuU1FMVVNFUkRCRElSLkxlbmd0aCAtZXEgMiApIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTFVTRVJEQkRJUj0nIiArICRwYXJhbXMuU1FMVVNFUkRCRElSICsgIlwiICsgJHNCYXNlRGlyICsgIlxNU1NRTFxEYXRhJyIKCX0gZWxzZWlmICggJHBhcmFtcy5TUUxVU0VSREJESVIuTGVuZ3RoIC1ndCAyICkgewoJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMVVNFUkRCRElSPSciICsgJHBhcmFtcy5TUUxVU0VSREJESVIgKyAiXE1TU1FMXERhdGEnIgoJfQoKCWlmICggJHBhcmFtcy5TUUxVU0VSREJMT0dESVIuTGVuZ3RoIC1lcSAyICkgewoJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMVVNFUkRCTE9HRElSPSciICsgJHBhcmFtcy5TUUxVU0VSREJMT0dESVIgKyAiXCIgKyAkc0Jhc2VEaXIgKyAiXE1TU1FMXERhdGEnIgoJfSBlbHNlaWYgKCAkcGFyYW1zLlNRTFVTRVJEQkxPR0RJUi5MZW5ndGggLWd0IDIgKSB7CgkJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9TUUxVU0VSREJMT0dESVI9JyIgKyAkcGFyYW1zLlNRTFVTRVJEQkxPR0RJUiArICJcTVNTUUxcRGF0YSciCgl9CgoJaWYgKCAkcGFyYW1zLlNRTFRFTVBEQkRJUi5MZW5ndGggLWVxIDIgKSB7CgkJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9TUUxURU1QREJESVI9JyIgKyAkcGFyYW1zLlNRTFRFTVBEQkRJUiArICJcIiArICRzQmFzZURpciArICJcTVNTUUxcRGF0YSciCgl9IGVsc2VpZiAoICRwYXJhbXMuU1FMVEVNUERCRElSLkxlbmd0aCAtZ3QgMiApIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTFRFTVBEQkRJUj0nIiArICRwYXJhbXMuU1FMVEVNUERCRElSICsgIlxNU1NRTFxEYXRhJyIKCX0KCglpZiAoICRwYXJhbXMuU1FMVEVNUERCTE9HRElSLkxlbmd0aCAtZXEgMiApIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTFRFTVBEQkxPR0RJUj0nIiArICRwYXJhbXMuU1FMVEVNUERCTE9HRElSICsgIlwiICsgJHNCYXNlRGlyICsgIlxNU1NRTFxEYXRhJyIKCX0gZWxzZWlmICggJHBhcmFtcy5TUUxURU1QREJMT0dESVIuTGVuZ3RoIC1ndCAyICkgewoJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMVEVNUERCTE9HRElSPSciICsgJHBhcmFtcy5TUUxURU1QREJMT0dESVIgKyAiXE1TU1FMXERhdGEnIgoJfQoKCWlmICggJHBhcmFtcy5TUUxCQUNLVVBESVIuTGVuZ3RoIC1lcSAyICkgewoJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMQkFDS1VQRElSPSciICsgJHBhcmFtcy5TUUxCQUNLVVBESVIgKyAiXCIgKyAkc0Jhc2VEaXIgKyAiXE1TU1FMXEJhY2t1cCciCgl9IGVsc2VpZiAoICRwYXJhbXMuU1FMQkFDS1VQRElSLkxlbmd0aCAtZ3QgMiApIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTEJBQ0tVUERJUj0nIiArICRwYXJhbXMuU1FMQkFDS1VQRElSICsgIlxNU1NRTFxCYWNrdXAnIgoJfQoKCWlmICgkcGFyYW1zLkFDVElPTiAtbmUgIkluc3RhbGwiKSB7CgoJIyBDbHVzdGVyIHNwZWNpZmljIHBhcmFtZXRlcnMKCgkJaWYgKCggJHBhcmFtcy5GQUlMT1ZFUkNMVVNURVJORVRXT1JLTkFNRS5MZW5ndGggLWd0IDAgKSAtYW5kICggJHBhcmFtcy5GQUlMT1ZFUkNMVVNURVJHUk9VUC5MZW5ndGggLWd0IDAgKSAtYW5kICggJHBhcmFtcy5GQUlMT1ZFUkNMVVNURVJJUEFERFJFU1NFUy5MZW5ndGggLWd0IDAgKSkKCQkJewoJCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL0ZBSUxPVkVSQ0xVU1RFUk5FVFdPUktOQU1FPSIgKyAkcGFyYW1zLkZBSUxPVkVSQ0xVU1RFUk5FVFdPUktOQU1FCgkJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvRkFJTE9WRVJDTFVTVEVSR1JPVVA9IiArICRwYXJhbXMuRkFJTE9WRVJDTFVTVEVSR1JPVVAKCQkJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9GQUlMT1ZFUkNMVVNURVJJUEFERFJFU1NFUz0iICsgJHBhcmFtcy5GQUlMT1ZFUkNMVVNURVJJUEFERFJFU1NFUwoJCQlpZiAoICRwYXJhbXMuRkFJTE9WRVJDTFVTVEVSRElTS1MuTGVuZ3RoIC1ndCAwICkKCQkJCXsKCQkJCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvRkFJTE9WRVJDTFVTVEVSRElTS1M9IiArICRwYXJhbXMuRkFJTE9WRVJDTFVTVEVSRElTS1MKCQkJCX0KCQkJfQoJCWVsc2UKCQkJewoJCQlXcml0ZS1Mb2cgLWxvZ2ZpbGUgJHNldHVwTG9nIC1sZXZlbCAiRXJyb3IiIC1tZXNzYWdlICJTUUwgU2VydmVyIEluc3RhbGwgZmFpbGVkIC0gb25lIG9yIG1vcmUgY2x1c3RlciBwYXJhbWV0ZXJzIG1pc3NpbmciCgkJCSRlcnJvclN0b3AgPSAkdHJ1ZQoJCQl9Cgl9CgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiYG4iCglyZXR1cm4gJGluc3RhbGxDTUQKfQoKRnVuY3Rpb24gY3JlYXRlQ21kQWRkTm9kZSgpCnsKCgkkaW5zdGFsbENNRD0iIgoJJGluc3RhbGxDTUQgPSAkaW5zdGFsbGF0aW9uUGF0aCArICJcU2V0dXAuZXhlIC9xIC9BQ1RJT049QWRkTm9kZSAiCgkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL0lOU1RBTkNFTkFNRT0iICsgJHBhcmFtcy5JTlNUQU5DRU5BTUUKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvU1FMU1ZDQUNDT1VOVD0iICsgJHBhcmFtcy5TUUxTVkNBQ0NPVU5UCgkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL1NRTFNWQ1BBU1NXT1JEPSciICsgJHBTUUxTVkNQQVNTV09SRCArICInIgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9BR1RTVkNBQ0NPVU5UPSIgKyAkcGFyYW1zLkFHVFNWQ0FDQ09VTlQKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvQUdUU1ZDUEFTU1dPUkQ9JyIgKyAkcEFHVFNWQ1BBU1NXT1JEICsgIiciCgoJaWYgKC1Ob3QgKCRwYXJhbXMuU1FMVkVSU0lPTiAtZXEgIjIwMDgiIC1vciAkcGFyYW1zLlNRTFZFUlNJT04gLWVxICIyMDA4UjIiICkpIHsKCQkkaW5zdGFsbENNRD0kaW5zdGFsbENNRCArICIgL0lBQ0NFUFRTUUxTRVJWRVJMSUNFTlNFVEVSTVM9IiArICRwYXJhbXMuSUFDQ0VQVFNRTFNFUlZFUkxJQ0VOU0VURVJNUwoJfQoKICAgIGlmICggJHBhcmFtcy5QQ1VTT1VSQ0UuTGVuZ3RoIC1ndCAwICkgewogICAgICAgICRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgIiAvUENVU09VUkNFPSIgKyAkcGFyYW1zLlBDVVNPVVJDRQogICAgfQoKICAgIGlmICggJHBhcmFtcy5DVVNPVVJDRS5MZW5ndGggLWd0IDAgKSB7CiAgICAgICAgJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9DVVNPVVJDRT0iICsgJHBhcmFtcy5DVVNPVVJDRQogICAgfQoKCSRpbnN0YWxsQ01EPSRpbnN0YWxsQ01EICsgImBuIgoJcmV0dXJuICRpbnN0YWxsQ01ECn0KCkZ1bmN0aW9uIGNyZWF0ZUNtZFJlbW92ZU5vZGUoKQp7CgoJJGluc3RhbGxDTUQ9IiIKCSRpbnN0YWxsQ01EID0gJGluc3RhbGxhdGlvblBhdGggKyAiXFNldHVwLmV4ZSAvcSAvQUNUSU9OPVJlbW92ZU5vZGUgIgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiIC9JTlNUQU5DRU5BTUU9IiArICRwYXJhbXMuSU5TVEFOQ0VOQU1FCgoJJGluc3RhbGxDTUQ9JGluc3RhbGxDTUQgKyAiYG4iCglyZXR1cm4gJGluc3RhbGxDTUQKfQoKRnVuY3Rpb24gSW52b2tlLVBvd2Vyc2hlbGwKewoJcGFyYW0KCSgKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTAsIE1hbmRhdG9yeT0kdHJ1ZSldIFtzdHJpbmddICRwc1NjcmlwdCwKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTEsIE1hbmRhdG9yeT0kdHJ1ZSldICRjb25maWdQYXJhbXMKCSkKCglyZXR1cm4gSW52b2tlLUV4cHJlc3Npb24gLUNvbW1hbmQgIiRwc1NjcmlwdCBgJGNvbmZpZ1BhcmFtcyIKfQoKRnVuY3Rpb24gSW52b2tlLVNxbFNjcmlwdAp7CglwYXJhbQoJKAoJCVtQYXJhbWV0ZXIoUG9zaXRpb249MCwgTWFuZGF0b3J5PSR0cnVlKV0gW3N0cmluZ10gJHNxbFNjcmlwdCwKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTEsIE1hbmRhdG9yeT0kdHJ1ZSldIFtBbGxvd0VtcHR5U3RyaW5nKCldIFtzdHJpbmddICRzcWxTZXJ2ZXJOYW1lLAogICAgICAgCVtQYXJhbWV0ZXIoUG9zaXRpb249MywgTWFuZGF0b3J5PSRmYWxzZSldIFtzdHJpbmddICREYm5hbWUgPSAibWFzdGVyIgoJKQoKICAgIHRyeQoJewoJCUludm9rZS1TcWxjbWQgLUlucHV0RmlsZSAkc3FsU2NyaXB0IC1TZXJ2ZXJJbnN0YW5jZSAkc3FsU2VydmVyTmFtZSAtRGF0YWJhc2UgJERibmFtZQoJCSRleGl0Q29kZSA9ICJDb21tYW5kKHMpIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuIgoJfQoJY2F0Y2ggW1N5c3RlbS5FeGNlcHRpb25dCgl7CgkJJGV4aXRDb2RlID0gJF8uRXhjZXB0aW9uCgl9CgoJcmV0dXJuICRleGl0Q29kZQp9CgpGdW5jdGlvbiBJbnZva2UtU3FsUXVlcnkKewoJcGFyYW0KCSgKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTAsIE1hbmRhdG9yeT0kdHJ1ZSldIFtzdHJpbmddICRzcWxRdWVyeSwKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTEsIE1hbmRhdG9yeT0kdHJ1ZSldIFtBbGxvd0VtcHR5U3RyaW5nKCldIFtzdHJpbmddICRzcWxTZXJ2ZXJOYW1lLAogICAgICAgCVtQYXJhbWV0ZXIoUG9zaXRpb249MywgTWFuZGF0b3J5PSRmYWxzZSldIFtzdHJpbmddICREYm5hbWUgPSAibWFzdGVyIgoJKQoKICAgIHRyeQoJewoJCSRyZXRWYWwgPSAoSW52b2tlLVNxbGNtZCAtUXVlcnkgJHNxbFF1ZXJ5IC1TZXJ2ZXJJbnN0YW5jZSAkc3FsU2VydmVyTmFtZSAtRGF0YWJhc2UgJERibmFtZSlbMF0KCQkkZXhpdENvZGUgPSAiQ29tbWFuZChzKSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIKCX0KCWNhdGNoIFtTeXN0ZW0uRXhjZXB0aW9uXQoJewoJCSRleGl0Q29kZSA9ICRfLkV4Y2VwdGlvbgoJfQoKCXJldHVybiAkcmV0VmFsCn0KCkZ1bmN0aW9uIEludm9rZS1TY3JpcHRzCnsKCXBhcmFtCgkoCgkJW1BhcmFtZXRlcihQb3NpdGlvbj0wLCBNYW5kYXRvcnk9JHRydWUpXVtoYXNodGFibGVdICRQYXJhbSwKCQlbUGFyYW1ldGVyKFBvc2l0aW9uPTEsIE1hbmRhdG9yeT0kdHJ1ZSldICRGb2xkZXIKCSkKCgkkU3FsU2VydmVyTmFtZSA9ICRQYXJhbVsiU1FMU0VSVkVSTkFNRSJdCglbc3RyaW5nXSAkZlNxbFZlcnNpb24gPSAkUGFyYW1bIlNRTFZFUlNJT04iXQoKCWlmICgkRm9sZGVyLkNvbnRhaW5zKCJQcmUiKSkKCXsKCQlXcml0ZS1Mb2cgLWxvZ2ZpbGUgJHNldHVwTG9nIC1sZXZlbCAiSW5mbyIgLW1lc3NhZ2UgKCJQcmVTY3JpcHRzOiAiICsgJEZvbGRlcikKCQlbYXJyYXldICRzY3JpcHRzID0gZ2V0LWNoaWxkaXRlbSAtcGF0aCAkRm9sZGVyIC1FeGNsdWRlIF8qIHwgV2hlcmUtT2JqZWN0ICB7ICRfLkV4dGVuc2lvbiAtZXEgIi5wczEiIC1vciAkXy5FeHRlbnNpb24gLWVxICIuc3FsIiB9CiAgICAgICAgJGNvdW50ID0gJHNjcmlwdHMuQ291bnQKCQkkbWVzc2FnZSA9ICJBcHBseWluZyAkY291bnQgUHJlIFNjcmlwdHMiCgl9CglpZiAoJEZvbGRlci5Db250YWlucygiUG9zdCIpKQoJewoJCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJJbmZvIiAtbWVzc2FnZSAoIlBvc3RTY3JpcHRzOiAiICsgJEZvbGRlcikKCQlbYXJyYXldICRzY3JpcHRzID0gZ2V0LWNoaWxkaXRlbSAtcGF0aCAkRm9sZGVyIC1FeGNsdWRlIF8qIHwgV2hlcmUtT2JqZWN0ICB7ICRfLkV4dGVuc2lvbiAtZXEgIi5wczEiIC1vciAkXy5FeHRlbnNpb24gLWVxICIuc3FsIiB9CgkJJGNvdW50ID0gJHNjcmlwdHMuQ291bnQKICAgICAgICAkbWVzc2FnZSA9ICJBcHBseWluZyAkY291bnQgUG9zdCBTY3JpcHRzIgoJfQoKICAgIGlmICgkRm9sZGVyLkNvbnRhaW5zKCJWYWwiKSkKCXsKCQlXcml0ZS1Mb2cgLWxvZ2ZpbGUgJHNldHVwTG9nIC1sZXZlbCAiSW5mbyIgLW1lc3NhZ2UgKCJWYWxTY3JpcHRzOiAiICsgJEZvbGRlcikKCQlbYXJyYXldICRzY3JpcHRzID0gZ2V0LWNoaWxkaXRlbSAtcGF0aCAkRm9sZGVyIC1FeGNsdWRlIF8qIHwgV2hlcmUtT2JqZWN0ICB7ICRfLkV4dGVuc2lvbiAtZXEgIi5wczEiIC1vciAkXy5FeHRlbnNpb24gLWVxICIuc3FsIiB9CgkJJGNvdW50ID0gJHNjcmlwdHMuQ291bnQKICAgICAgICAkbWVzc2FnZSA9ICJBcHBseWluZyAkY291bnQgVmFsIFNjcmlwdHMiCgl9CgoJJHNjcmlwdHMgPSAkc2NyaXB0cyB8IFNvcnQtT2JqZWN0CgoJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIlNlY3Rpb24iIC1tZXNzYWdlICRtZXNzYWdlCgoJIyBFeGVjdXRpbmcgc2NyaXB0cyBpbiBsb29wCgoJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIkluZm8iIC1tZXNzYWdlICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT4iCgoJZm9yZWFjaCAoJHNjcmlwdCBpbiAkc2NyaXB0cykKCXsKCQkjIENoZWNraW5nIGZpcnN0IGxpbmUgZm9yIHN1cHBvcnRlZCBTUUwgVmVyc2lvbiAoIyAyMDA4LDIwMDhSMiwyMDEyLDIwMTQpIG9yICgtLSAyMDA4LDIwMDhSMiwyMDEyLDIwMTQpCgkJW3N0cmluZ10gJHN1cFJhd1ZlcnNpb24gPSBHZXQtQ29udGVudCAtUGF0aCAkc2NyaXB0LkZ1bGxOYW1lIC1Ub3RhbENvdW50IDEKCgkJIyBDbGVhbmluZyBvZmYgdGhlICMgYW5kIC0tIGZyb20gdmFyaWFibGUsIGFuZCBzcGxpdHRpbmcKCQlbYXJyYXldICRzdXBWZXJzaW9uID0gJHN1cFJhd1ZlcnNpb24uUmVwbGFjZSgnIycsICcnKS5SZXBsYWNlKCctJywnJykuVHJpbSgpLlNwbGl0KCcsJykKCgkJaWYgKCRzdXBWZXJzaW9uIC1jb250YWlucyAkZlNxbFZlcnNpb24gLW9yICRzdXBWZXJzaW9uIC1jb250YWlucyAiQWxsIikgIyBTdXBwb3J0ZWQgYnkgU1FMIFZlcnNpb24gPwoJCQl7CgkJCQlpZiAoJHNjcmlwdC5FeHRlbnNpb24gLWVxICIuc3FsIikKCQkJCXsKCQkJCQkjIFdyaXRlIHRoZSBzY3JpcHQgbmFtZSBhbmQgcmVzdWx0cyB0byB0aGUgbG9nCgkJCQkJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIkluZm8iIC1tZXNzYWdlICJTdGFydGluZyBTUUwgU2NyaXB0OiAkc2NyaXB0IgoJCQkJCSRleGl0Q29kZSA9IEludm9rZS1TUUxTY3JpcHQgLXNxbFNjcmlwdCAkc2NyaXB0LkZ1bGxOYW1lIC1zcWxTZXJ2ZXJOYW1lICRTcWxTZXJ2ZXJOYW1lCgoJCQkJCWlmICgkZXhpdENvZGUgLWVxICJDb21tYW5kKHMpIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuIikKCQkJCQl7CgkJCQkJCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJJbmZvIiAtbWVzc2FnZSAiU2NyaXB0ICRzY3JpcHQgZmluaXNoZWQgd2l0aCAkZXhpdENvZGUiCgkJCQkJfQoJCQkJCWVsc2VpZiAoJGV4aXRDb2RlIC1saWtlICcqQSB0cmFuc3BvcnQtbGV2ZWwgZXJyb3IgaGFzIG9jY3VycmVkIHdoZW4gc2VuZGluZyB0aGUgcmVxdWVzdCB0byB0aGUgc2VydmVyKicpCgkJCQkJewoJCQkJCQkkZXhpdENvZGUgPSBJbnZva2UtU1FMU2NyaXB0IC1zcWxTY3JpcHQgJHNjcmlwdC5GdWxsTmFtZSAtc3FsU2VydmVyTmFtZSAkU3FsU2VydmVyTmFtZQoKCQkJCQkJaWYgKCRleGl0Q29kZSAtZXEgIkNvbW1hbmQocykgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4iKQoJCQkJCQl7CgkJCQkJCQlXcml0ZS1Mb2cgLWxvZ2ZpbGUgJHNldHVwTG9nIC1sZXZlbCAiSW5mbyIgLW1lc3NhZ2UgIlNjcmlwdCAkc2NyaXB0IFN1Y2NlZWRlZCB3aXRoICRleGl0Q29kZSIKCQkJCQkJfQoJCQkJCQllbHNlCgkJCQkJCXsKCQkJCQkJCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJXYXJuaW5nIiAtbWVzc2FnZSAiU2NyaXB0ICRzY3JpcHQgRmFpbGVkIHdpdGggJGV4aXRDb2RlIgoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQl7CgkJCQkJCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJXYXJuaW5nIiAtbWVzc2FnZSAiU2NyaXB0ICRzY3JpcHQgRmFpbGVkIHdpdGggJGV4aXRDb2RlIgoJCQkJCX0KCQkJCX0KCQkJCWlmICgkc2NyaXB0LkV4dGVuc2lvbiAtZXEgIi5wczEiKQoJCQkJewoJCQkJCSMgV3JpdGUgdGhlIHNjcmlwdCBuYW1lIGFuZCByZXN1bHRzIHRvIHRoZSBsb2cKCQkJCQlXcml0ZS1Mb2cgLWxvZ2ZpbGUgJHNldHVwTG9nIC1sZXZlbCAiSW5mbyIgLW1lc3NhZ2UgIlN0YXJ0aW5nIFBvd2VyU2hlbGwgU2NyaXB0OiAkc2NyaXB0IgoKCQkJCQl0cnkKCQkJCQl7CgkJCQkJCSRleGl0Q29kZSA9IEludm9rZS1Qb3dlcnNoZWxsIC1wc1NjcmlwdCAkc2NyaXB0LkZ1bGxOYW1lIC1jb25maWdQYXJhbXMgJFBhcmFtCgoJCQkJCQlpZiAoJGV4aXRDb2RlIC1lcSAiIiAtb3IgJGV4aXRDb2RlIC1lcSAkbnVsbCAtb3IgJGV4aXRDb2RlWy0xXSAtZXEgMCkKCQkJCQkJewoJCQkJCQkJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIkluZm8iIC1tZXNzYWdlICJTY3JpcHQgJHNjcmlwdCBTdWNjZWVkZWQgd2l0aCBlbXB0eSBleGl0IGNvZGUuIgoJCQkJCQl9CgkJCQkJCWVsc2UKCQkJCQkJewoJCQkJCQkJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIkVycm9yIiAtbWVzc2FnZSAiU2NyaXB0ICRzY3JpcHQgZmluaXNoZWQgd2l0aCBFeGl0IENvZGU6ICRleGl0Q29kZSIKCQkJCQkJfQoJCQkJCX0KCQkJCQljYXRjaAoJCQkJCXsKCQkJCQkJJGV4aXRDb2RlID0gJF8KCQkJCQkJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIldhcm5pbmciIC1tZXNzYWdlICJTY3JpcHQgJHNjcmlwdCBGYWlsZWQgd2l0aCAkZXhpdENvZGUiCgkJCQkJfQoJCQkJfQoJCQkJV3JpdGUtTG9nIC1sb2dmaWxlICRzZXR1cExvZyAtbGV2ZWwgIkluZm8iIC1tZXNzYWdlICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT4iCgkJCX0KCQllbHNlCgkJCXsKCQkJCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJBdHRlbnRpb24iIC1tZXNzYWdlICgiU2tpcHBpbmcgU2NyaXB0ICIgKyAkc2NyaXB0ICsgIjogU1FMIFZlcnNpb24gbm90IHN1cHBvcnRlZCIpCgkJCX0KCX0KCVdyaXRlLUxvZyAtbG9nZmlsZSAkc2V0dXBMb2cgLWxldmVsICJJbmZvIiAtbWVzc2FnZSAiU3RhbmRhcmQgU2NyaXB0cyBDb21wbGV0ZSIKfQo=
