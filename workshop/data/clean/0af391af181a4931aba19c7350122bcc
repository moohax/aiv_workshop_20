ShellOut.psm1,1c42c7c83040f5a9ed1041df2c30eb6b,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0QXBwbGljYXRpb24gewoJcGFyYW0oCgkJW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUsIEhlbHBNZXNzYWdlPSJUaGUgbmFtZSBvZiB0aGUgYXBwbGljYXRpb24uIildCgkJW3N0cmluZ10kTmFtZSwKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeT0kZmFsc2UsIEhlbHBNZXNzYWdlPSJUaGUgdHlwZSBvZiBpbmZvcm1hdGlvbiB0byByZXR1cm4uIildCgkJW1ZhbGlkYXRlU2V0KCJPYmplY3QiLCAiUGF0aCIpXQoJCVtzdHJpbmddJFJlc3VsdFR5cGU9Ik9iamVjdCIKCSkKCgkjIEdldCBjb21tYW5kIGluZm9ybWF0aW9uIGZvciB0aGUgZ2l2ZW4gZXhlY3V0YWJsZSBwcm9ncmFtLgoJJGluZm8gPSBHZXQtQ29tbWFuZCAtQ29tbWFuZFR5cGUgQXBwbGljYXRpb24gLU5hbWUgJE5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCglpZiAoJGluZm8gLWlzIFtBcnJheV0pIHsKCQkjIEFsbG93IGdjbSBvdXRwdXQgdG8gZ28gdG8gc3RhbmRhcmQgb3V0IGJlZm9yZSByYWlzaW5nIGFuIGVycm9yLgoJCWdjbSAtY29tbWFuZFR5cGUgQXBwbGljYXRpb24gLW5hbWUgJE5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCAlewoJCQlHZXQtSXRlbSAkXy5EZWZpbml0aW9uCgkJfQoJCXdyaXRlLW91dHB1dCAiIgoJCXRocm93ICInJE5hbWUnIGlzIGFtYmlndW91cy4gJCgkaW5mby5MZW5ndGgpIG1hdGNoZXM6ICRpbmZvIgoJfQoKCWlmICghJGluZm8pIHsKCQl0aHJvdyAiQ291bGQgbm90IGxvY2F0ZSAiIiROYW1lIiIgLSBwbGVhc2UgdmVyaWZ5IHRoYXQgeW91ciB1c2VyIG9yIHN5c3RlbSBwYXRoIGluY2x1ZGVzIGl0LiIKCX0KCglpZiAoJFJlc3VsdFR5cGUgLWVxICJQYXRoIikgewoJCXJldHVybiAkaW5mby5EZWZpbml0aW9uCgl9CgllbHNlIHsKCQlyZXR1cm4gJGluZm8KCX0KfQoKZnVuY3Rpb24gRXNjYXBlQXJndW1lbnRJZk5lZWRlZAp7CglwYXJhbSgKCQlbUGFyYW1ldGVyKEhlbHBNZXNzYWdlPSJUaGUgYXJndW1lbnQgdmFsdWUuIildCgkJW3N0cmluZ10kVmFsdWUKCSkKCgkkaXNFc2NhcGVkID0gJGZhbHNlCglmb3IgKCRpID0gMDsgJGkgLWx0ICRWYWx1ZS5MZW5ndGg7ICRpICs9IDEpIHsKCQkkYyA9ICRWYWx1ZVskaV0KCQlpZiAoJGMgLWVxICIiIiIpIHsKCQkJJGlzRXNjYXBlZCA9ICEkaXNFc2NhcGVkCgkJfQoJCWVsc2VpZiAoJGMgLWVxICIgIiAtb3IgJGMgLWVxICJgdCIpIHsKCQkJaWYgKCEkaXNFc2NhcGVkKSB7CgkJCQlXcml0ZS1WZXJib3NlICJFc2NhcGluZyBhcmd1bWVudCAkVmFsdWUiCgkJCQlXcml0ZS1PdXRwdXQgIiIiJFZhbHVlIiIiCgkJCQlyZXR1cm4KCQkJfQoJCX0KCX0KCQoJV3JpdGUtT3V0cHV0ICRWYWx1ZQp9CgojaWZkZWYgVEVTVAo8IwoKZnVuY3Rpb24gVGVzdEVzY2FwZQp7CglwYXJhbSgKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSwgSGVscE1lc3NhZ2U9IlRoZSBhcmd1bWVudCB2YWx1ZS4iKV0KCQlbc3RyaW5nXSRWYWx1ZSwKCQlbYm9vbGVhbl0kc2hvdWxkRXNjYXBlCgkpCgoJI1dyaXRlLUhvc3QgIklucHV0OiAkVmFsdWUiCgkkZXNjYXBlZCA9IEVzY2FwZUFyZ3VtZW50SWZOZWVkZWQgLVZhbHVlICRWYWx1ZQoJI1dyaXRlLUhvc3QgIlJlc3VsdDogJGVzY2FwZWQiCglpZiAoJHNob3VsZEVzY2FwZSAtYW5kICRWYWx1ZSAtZXEgJGVzY2FwZWQpIHsKCQlXcml0ZS1Ib3N0ICJTaG91bGQgaGF2ZSBiZWVuIGVzY2FwZWQ6ICRWYWx1ZSIKCX0KCWlmICghJHNob3VsZEVzY2FwZSAtYW5kICRWYWx1ZSAtbmUgJGVzY2FwZWQpIHsKCQlXcml0ZS1Ib3N0ICJTaG91bGQgTk9UIGhhdmUgYmVlbiBlc2NhcGVkOiAkVmFsdWUiCgl9Cn0KClRlc3RFc2NhcGUgLVZhbHVlICJGb28gQmFyIiAtc2hvdWxkRXNjYXBlICR0cnVlClRlc3RFc2NhcGUgLVZhbHVlICJGb28JQmFyIiAtc2hvdWxkRXNjYXBlICR0cnVlClRlc3RFc2NhcGUgLVZhbHVlICIiIkZvbyBCYXIiIiIgLXNob3VsZEVzY2FwZSAkZmFsc2UKVGVzdEVzY2FwZSAtVmFsdWUgIkZvb0JhciIgLXNob3VsZEVzY2FwZSAkZmFsc2UKVGVzdEVzY2FwZSAtVmFsdWUgInZhbHVlPSIiRm9vIEJhciIiIiAtc2hvdWxkRXNjYXBlICRmYWxzZQoKIz4KI2VuZGlmCgojIFRha2VuIGZyb20gQ2hvY29sYXRleQpmdW5jdGlvbiBSdW5Qcm9jZXNzQXNBZG1pbiB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10gJHN0YXRlbWVudHMsCiAgICAgICAgW3N0cmluZ10gJGV4ZVRvUnVuID0gJ3Bvd2Vyc2hlbGwnLAogICAgICAgIFtWYWxpZGF0ZVNldCgneDg2JywgJ3g2NCcpXQogICAgICAgIFtzdHJpbmddICRwb3dlcnNoZWxsVmVyc2lvbiA9ICd4NjQnLAogICAgICAgIFtib29sZWFuXSAkbWluaW1pemVkID0gJHRydWUsCiAgICAgICAgW3N3aXRjaF0gJG5vU2xlZXAsCiAgICAgICAgJHZhbGlkRXhpdENvZGVzID0gQCgwKSwKICAgICAgICBbYm9vbGVhbl0kRW5zdXJlU3VjY2Vzcz0kdHJ1ZSwKICAgICAgICBbVmFsaWRhdGVTZXQoIk5vbmUiLCAiRXhpdENvZGUiKV0KICAgICAgICBbc3RyaW5nXSRSZXR1cm5UeXBlPSJOb25lIgogICAgKQoKICAgICR3cmFwcGVkU3RhdGVtZW50cyA9ICRzdGF0ZW1lbnRzOwogICAgaWYgKCRleGVUb1J1biAtZXEgJ3Bvd2Vyc2hlbGwnKSB7CiAgICAgICAgJGV4ZVRvUnVuID0gIiQoJGVudjp3aW5kaXIpXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiCgogICAgICAgIGlmICgkcG93ZXJzaGVsbFZlcnNpb24gLWVxICd4ODYnKSB7CiAgICAgICAgICAgICRleGVUb1J1biA9ICIkKCRlbnY6d2luZGlyKVxzeXN3b3c2NFxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIgogICAgICAgIH0KCiAgICAgICAgaWYgKCEkc3RhdGVtZW50cy5FbmRzV2l0aCgnOycpKXskc3RhdGVtZW50cyA9ICRzdGF0ZW1lbnRzICsgJzsnfQoKICAgICAgICAkd3JhcHBlZFN0YXRlbWVudHMgPSAiLU5vUHJvZmlsZSAtRXhlY3V0aW9uUG9saWN5IHVucmVzdHJpY3RlZCAtQ29tbWFuZCBgInRyeXskc3RhdGVtZW50cyBzdGFydC1zbGVlcCA2O31jYXRjaHt3cml0ZS1lcnJvciBgJ1RoYXQgd2FzIG5vdCBzdWNlc3NmdWxgJztgJF8uRXhjZXB0aW9uLk1lc3NhZ2UgfCBvdXQtZmlsZSBgJyRwcm9jZXNzRGlyXGVycm9yLmxvZ2AnO3N0YXJ0LXNsZWVwIDg7dGhyb3c7fWAiIgogICAgICAgIGlmICgkbm9TbGVlcCkgewogICAgICAgICAgICAkd3JhcHBlZFN0YXRlbWVudHMgPSAiLU5vUHJvZmlsZSAtRXhlY3V0aW9uUG9saWN5IHVucmVzdHJpY3RlZCAtQ29tbWFuZCBgInRyeXskc3RhdGVtZW50c31jYXRjaHt3cml0ZS1lcnJvciBgJ1RoYXQgd2FzIG5vdCBzdWNlc3NmdWxgJztgJF8uRXhjZXB0aW9uLk1lc3NhZ2UgfCBvdXQtZmlsZSBgJyRwcm9jZXNzRGlyXGVycm9yLmxvZ2AnO3Rocm93O31gIiIKICAgICAgICB9CiAgICB9CgogICAgJHBzaSA9IG5ldy1vYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm87CiAgICAkcHNpLkZpbGVOYW1lID0gJGV4ZVRvUnVuOwogICAgaWYgKCR3cmFwcGVkU3RhdGVtZW50cyAtbmUgJycpIHsKICAgICAgICAkcHNpLkFyZ3VtZW50cyA9ICIkd3JhcHBlZFN0YXRlbWVudHMiOwogICAgfQoKICAgIGlmIChbRW52aXJvbm1lbnRdOjpPU1ZlcnNpb24uVmVyc2lvbiAtZ2UgKG5ldy1vYmplY3QgJ1ZlcnNpb24nIDYsMCkpewogICAgICAgICRwc2kuVmVyYiA9ICJydW5hcyI7CiAgICB9CgogICAgJHBzaS5Xb3JraW5nRGlyZWN0b3J5ID0gZ2V0LWxvY2F0aW9uOwoKICAgIGlmICgkbWluaW1pemVkKSB7CiAgICAgICAgJHBzaS5XaW5kb3dTdHlsZSA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1dpbmRvd1N0eWxlXTo6TWluaW1pemVkOwogICAgfQoKICAgICRzID0gW1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzXTo6U3RhcnQoJHBzaSk7CiAgICAkcy5XYWl0Rm9yRXhpdCgpOwoKICAgIGlmICgkRW5zdXJlU3VjY2VzcykgewogICAgICAgIGlmICgkdmFsaWRFeGl0Q29kZXMgLW5vdGNvbnRhaW5zICRzLkV4aXRDb2RlKSB7CiAgICAgICAgICAgICRlcnJvck1lc3NhZ2UgPSAiW0VSUk9SXSBSdW5uaW5nICRleGVUb1J1biB3aXRoICRzdGF0ZW1lbnRzIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gRXhpdCBjb2RlIHdhcyBgJyQoJHMuRXhpdENvZGUpYCcuIgogICAgICAgICAgICBXcml0ZS1FcnJvciAkZXJyb3JNZXNzYWdlCiAgICAgICAgICAgIHRocm93ICRlcnJvck1lc3NhZ2UKICAgICAgICB9CiAgICB9CgogICAgaWYgKCRSZXR1cm5UeXBlIC1lcSAiRXhpdENvZGUiKSB7CiAgICAgICAgcmV0dXJuICRzLkV4aXRDb2RlCiAgICB9Cn0KCgpmdW5jdGlvbiBJbnZva2UtQXBwbGljYXRpb25Gcm9tQXJnc0FuZFJldHVybk91dHB1dCB7Cgk8IwoJICAgIC5TeW5vcHNpcwoJICAgIEludm9rZXMgdGhlIGdpdmVuIGV4ZWN1dGFibGUgYW5kIGFyZ3VtZW50cyBhbmQgcmV0dXJucyB0aGUgb3V0cHV0LgoJICAgIC5FeGFtcGxlCgkgICAgSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRSZXR1cm5PdXRwdXQgbm90ZXBhZCBDOlxOZXdGaWxlLnR4dAoJICAgIGV4ZW91dHB1dCBub3RlcGFkIEM6XE5ld0ZpbGUudHh0CgkgICAgTkFNRTogSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRSZXR1cm5PdXRwdXQKCSAgICBBVVRIT1I6IEJyeWFuIE1hdHRoZXdzCgkgICAgS0VZV09SRFM6CgkjPgoJCgkjIFRPRE86IFNob3VsZCBFbnN1cmVTdWNjZXNzIGJlIHRydWU/CglJbnZva2UtQXBwbGljYXRpb25XaXRoT3B0aW9ucyAtQXJnc0FycmF5ICRhcmdzIC1FbnN1cmVTdWNjZXNzICRmYWxzZSAtUmV0dXJuVHlwZSBPdXRwdXQKfQoKZnVuY3Rpb24gSW52b2tlLUFwcGxpY2F0aW9uV2l0aE9wdGlvbnMgewoJcGFyYW0gKAoJCVtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KCQlbU3lzdGVtLk9iamVjdFtdXSRBcmdzQXJyYXksCgkKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCgkJW2Jvb2xlYW5dJEVuc3VyZVN1Y2Nlc3MsCgkKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCgkJW1ZhbGlkYXRlU2V0KCdOb25lJywgJ0V4aXRDb2RlJywgJ091dHB1dCcpXQoJCVtzdHJpbmddJFJldHVyblR5cGUsCgkKCQlbVmFsaWRhdGVTZXQoJ1ZlcmJvc2UnLCAnT24nLCAnT2ZmJyldCgkJW3N0cmluZ10kTG9nZ2luZz0nVmVyYm9zZScsCgkKCQlbc3dpdGNoXSRSdW5Bc0FkbWluCgkpCgkKCQoJaWYgKCRBcmdzQXJyYXkuTGVuZ3RoIC1sdCAxKSB7CgkgICAgdGhyb3cgIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgdGhlIG5hbWUgb2YgYW4gZXhlY3V0YWJsZSIKCX0KCQoJJG5hbWUgPSAkQXJnc0FycmF5WzBdCgkkYXBwSW5mbyA9IEdldEFwcGxpY2F0aW9uICRuYW1lCgkKCWlmICgkQXJnc0FycmF5Lkxlbmd0aCAtZ3QgMSkgewoJICAgICRhcmd1bWVudHMgPSAoKCRBcmdzQXJyYXlbMS4uJEFyZ3NBcnJheS5MZW5ndGhdIHwgV2hlcmUtT2JqZWN0IHsgJF8uTGVuZ3RoIC1ndCAwIH0gfCBGb3JFYWNoLU9iamVjdCB7IEVzY2FwZUFyZ3VtZW50SWZOZWVkZWQgJF8gfSkgLWpvaW4gIiAiKQoJfQoJZWxzZSB7CgkgICAgJGFyZ3VtZW50cyA9ICIgIgoJfQoJCglJbnZva2UtQXBwbGljYXRpb24gLUZpbGVQYXRoICRhcHBJbmZvLkRlZmluaXRpb24gLUFyZ3VtZW50cyAkYXJndW1lbnRzIC1FbnN1cmVTdWNjZXNzICRFbnN1cmVTdWNjZXNzIC1SZXR1cm5UeXBlICRSZXR1cm5UeXBlIC1Mb2dnaW5nICRMb2dnaW5nIC1SdW5Bc0FkbWluOiRSdW5Bc0FkbWluCn0KCmZ1bmN0aW9uIEludm9rZS1BcHBsaWNhdGlvbiB7CglwYXJhbSgKCSAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCgkgICAgW3N0cmluZ10kRmlsZVBhdGgsCgkKCSAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCgkgICAgW3N0cmluZ10kQXJndW1lbnRzLAoJCgkgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQoJICAgIFtib29sZWFuXSRFbnN1cmVTdWNjZXNzLAoJCgkgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQoJICAgIFtWYWxpZGF0ZVNldCgnTm9uZScsICdFeGl0Q29kZScsICdPdXRwdXQnKV0KCSAgICBbc3RyaW5nXSRSZXR1cm5UeXBlLAoJCgkgICAgW1ZhbGlkYXRlU2V0KCdWZXJib3NlJywgJ09uJywgJ09mZicpXQoJICAgIFtzdHJpbmddJExvZ2dpbmc9J1ZlcmJvc2UnLAoJCgkgICAgW3N3aXRjaF0kU3VwcHJlc3NJbmNvbnNpc3RlbnRFcnJvckxvZ2dpbmcsCgkKCSAgICBbc3dpdGNoXSRSdW5Bc0FkbWluCgkpCgkKCWlmICghJEZpbGVQYXRoKSB7CgkgICAgdGhyb3cgIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgdGhlIG5hbWUgb2YgYW4gZXhlY3V0YWJsZSEiCgl9CgkKCWlmICghKFRlc3QtUGF0aCAkRmlsZVBhdGgpKSB7CgkgICAgdGhyb3cgIkV4ZWN1dGFibGUgcGF0aCAiIiRGaWxlUGF0aCIiIGRvZXMgbm90IGV4aXN0ISIKCX0KCQoJaWYgKCRMb2dnaW5nIC1lcSAnT24nKSB7CgkgICAgV3JpdGUtSG9zdCAiPj4gJEZpbGVQYXRoICRBcmd1bWVudHMiCgl9CgllbHNlaWYgKCRMb2dnaW5nIC1lcSAnVmVyYm9zZScpIHsKCSAgICBXcml0ZS1WZXJib3NlICI+PiAkRmlsZVBhdGggJEFyZ3VtZW50cyIKCX0KCWVsc2VpZiAoJExvZ2dpbmcgLW5lICdPZmYnKSB7CgkgICAgdGhyb3cgIlVua25vd24gbG9nZ2luZyBtb2RlICckKCRMb2dnaW5nKScuIgoJfQoJCglpZiAoJFJldHVyblR5cGUgLWVxICJPdXRwdXQiKSB7CgkgICAgaWYgKCRSdW5Bc0FkbWluLklzUHJlc2VudCAtYW5kICgtTk9UIChbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWxdIFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV0gIkFkbWluaXN0cmF0b3IiKSkpIHsKCSAgICAgICAgdGhyb3cgIkNhbm5vdCBlbGV2YXRlIHBlcm1pc3Npb25zIGFuZCBjYXB0dXJlIG91dHB1dC4iCgkgICAgfQoJCgkgICAgJHByb2Nlc3MgPSBOZXctT2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzCgkKCSAgICAkcHJvY2Vzcy5TdGFydEluZm8uRmlsZU5hbWUgPSAkRmlsZVBhdGgKCSAgICAkcHJvY2Vzcy5TdGFydEluZm8uV29ya2luZ0RpcmVjdG9yeSA9IChHZXQtTG9jYXRpb24pLlBhdGgKCSAgICAkcHJvY2Vzcy5TdGFydEluZm8uQXJndW1lbnRzID0gJEFyZ3VtZW50cwoJICAgICRwcm9jZXNzLlN0YXJ0SW5mby5Vc2VTaGVsbEV4ZWN1dGUgPSAkZmFsc2UKCSAgICAkcHJvY2Vzcy5TdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZE91dHB1dCA9ICR0cnVlCgkgICAgJHByb2Nlc3MuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9ICR0cnVlCgkKCSAgICAjIHN0YXJ0IHRoZSBwcm9jZXNzIGFuZCBiZWdpbiByZWFkaW5nIHN0ZG91dCBhbmQgc3RkZXJyCgkgICAgW3ZvaWRdJHByb2Nlc3MuU3RhcnQoKQoJCgkgICAgJG91dFN0cmVhbSA9ICRwcm9jZXNzLlN0YW5kYXJkT3V0cHV0CgkgICAgJG91dCA9ICRvdXRTdHJlYW0uUmVhZFRvRW5kKCkKCQoJICAgICRlcnJTdHJlYW0gPSAkcHJvY2Vzcy5TdGFuZGFyZEVycm9yCgkgICAgJGVyciA9ICRlcnJTdHJlYW0uUmVhZFRvRW5kKCkKCQoJICAgICMgU2h1dGRvd24gYXN5bmMgcmVhZCBldmVudHMKCSAgICAkZXhpdENvZGUgPSAkcHJvY2Vzcy5FeGl0Q29kZQoJICAgICRwcm9jZXNzLkNsb3NlKCkKCQoJICAgIGlmICgkZXJyLkxlbmd0aCAtbmUgMCAtYW5kICgkZXhpdENvZGUgLW5lIDAgLW9yICEkU3VwcHJlc3NJbmNvbnNpc3RlbnRFcnJvckxvZ2dpbmcpKSB7CgkgICAgICAgIFdyaXRlLUhvc3QgJGVyci5Ub1N0cmluZygpIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkCgkgICAgfQoJCgkgICAgaWYgKCRFbnN1cmVTdWNjZXNzIC1lcSAkdHJ1ZSkgewoJICAgICAgICBpZigkZXhpdENvZGUgLW5lIDApIHsKCSAgICAgICAgICAgIHRocm93ICIkRmlsZVBhdGggJEFyZ3VtZW50cyAtLT4gZmFpbGVkIHdpdGggZXhpdCBjb2RlICRleGl0Q29kZSIKCSAgICAgICAgfQoJICAgIH0KCQoJICAgIHJldHVybiAkb3V0Cgl9CgllbHNlaWYgKCRSdW5Bc0FkbWluLklzUHJlc2VudCAtYW5kICgtTk9UIChbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NQcmluY2lwYWxdIFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV0gIkFkbWluaXN0cmF0b3IiKSkpIHsKCSAgICBSdW5Qcm9jZXNzQXNBZG1pbiAtc3RhdGVtZW50cyAkQXJndW1lbnRzIC1leGVUb1J1biAkRmlsZVBhdGggLUVuc3VyZVN1Y2Nlc3MgJEVuc3VyZVN1Y2Nlc3MgLVJldHVyblR5cGUgJFJldHVyblR5cGUKCX0KCWVsc2UgewoJICAgICRwcm9jZXNzID0gU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIiRGaWxlUGF0aCIgLUFyZ3VtZW50TGlzdCAkQXJndW1lbnRzIC1Ob05ld1dpbmRvdyAtV2FpdCAtUGFzc1RocnUKCQoJICAgIGlmICgkRW5zdXJlU3VjY2VzcyAtZXEgJHRydWUpIHsKCSAgICAgICAgaWYoJHByb2Nlc3MuRXhpdENvZGUgLW5lIDApIHsKCSAgICAgICAgICAgIHRocm93ICIkRmlsZVBhdGggJEFyZ3VtZW50cyAtLT4gZmFpbGVkIHdpdGggZXhpdCBjb2RlICQoJHByb2Nlc3MuRXhpdENvZGUpIgoJICAgICAgICB9CgkgICAgfQoJCgkgICAgaWYgKCRSZXR1cm5UeXBlIC1lcSAiRXhpdENvZGUiKSB7CgkgICAgICAgIHJldHVybiAkcHJvY2Vzcy5FeGl0Q29kZQoJICAgIH0KCX0KfQoKZnVuY3Rpb24gSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRQYXNzVGhyb3VnaCB7Cgk8IwoJCS5TeW5vcHNpcwoJCUludm9rZXMgdGhlIGdpdmVuIGV4ZWN1dGFibGUgYW5kIGFyZ3VtZW50cyBhbmQgcGFzc2VzIGFsb25nIHRoZSBvdXRwdXQuCgkJLkV4YW1wbGUKCQlJbnZva2UtQXBwbGljYXRpb25Gcm9tQXJnc0FuZFBhc3NUaHJvdWdoIG5vdGVwYWQgQzpcTmV3RmlsZS50eHQKCSAgICBleGUgbm90ZXBhZCBDOlxOZXdGaWxlLnR4dAoJCU5BTUU6IEludm9rZS1BcHBsaWNhdGlvbkZyb21BcmdzQW5kUGFzc1Rocm91Z2gKCQlBVVRIT1I6IEJyeWFuIE1hdHRoZXdzCgkJS0VZV09SRFM6CgkjPgoJCglJbnZva2UtQXBwbGljYXRpb25XaXRoT3B0aW9ucyAtQXJnc0FycmF5ICRhcmdzIC1FbnN1cmVTdWNjZXNzICR0cnVlIC1SZXR1cm5UeXBlIE5vbmUKfQoKZnVuY3Rpb24gSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRSZXR1cm5FeGl0Q29kZSB7Cgk8IwoJCS5TeW5vcHNpcwoJCUludm9rZXMgdGhlIGdpdmVuIGV4ZWN1dGFibGUgYW5kIGFyZ3VtZW50cyBhbmQgcmV0dXJucyB0aGUgZXhpdCBjb2RlLgoJCS5FeGFtcGxlCgkJSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRSZXR1cm5FeGl0Q29kZSBub3RlcGFkIEM6XE5ld0ZpbGUudHh0CgkgICAgZXhlZXhpdGNvZGUgbm90ZXBhZCBDOlxOZXdGaWxlLnR4dAoJCU5BTUU6IEludm9rZS1BcHBsaWNhdGlvbkZyb21BcmdzQW5kUmV0dXJuRXhpdENvZGUKCQlBVVRIT1I6IEJyeWFuIE1hdHRoZXdzCgkJS0VZV09SRFM6CgkjPgoJCglJbnZva2UtQXBwbGljYXRpb25XaXRoT3B0aW9ucyAtQXJnc0FycmF5ICRhcmdzIC1FbnN1cmVTdWNjZXNzICRmYWxzZSAtUmV0dXJuVHlwZSBFeGl0Q29kZQp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiBJbnZva2UtQXBwbGljYXRpb24KRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gSW52b2tlLUFwcGxpY2F0aW9uRnJvbUFyZ3NBbmRQYXNzVGhyb3VnaApFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiBJbnZva2UtQXBwbGljYXRpb25Gcm9tQXJnc0FuZFJldHVybkV4aXRDb2RlCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uIEludm9rZS1BcHBsaWNhdGlvbkZyb21BcmdzQW5kUmV0dXJuT3V0cHV0CkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uIEludm9rZS1BcHBsaWNhdGlvbldpdGhPcHRpb25zCg==
