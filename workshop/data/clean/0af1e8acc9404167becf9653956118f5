LoggingCommandFunctions.ps1,4f2cc11fa131c1b50b4adf0fb6fe751d,Scan result is 1. IsMalware: 0,JHNjcmlwdDpsb2dnaW5nQ29tbWFuZFByZWZpeCA9ICcjI3Zzb1snCiRzY3JpcHQ6bG9nZ2luZ0NvbW1hbmRFc2NhcGVNYXBwaW5ncyA9IEAoICMgVE9ETzogV0hBVCBBQk9VVCAiPSI/IFdIQVQgQUJPVVQgIiUiPwogICAgTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgQHsgVG9rZW4gPSAnOycgOyBSZXBsYWNlbWVudCA9ICclM0InIH0KICAgIE5ldy1PYmplY3QgcHNvYmplY3QgLVByb3BlcnR5IEB7IFRva2VuID0gImByIiA7IFJlcGxhY2VtZW50ID0gJyUwRCcgfQogICAgTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgQHsgVG9rZW4gPSAiYG4iIDsgUmVwbGFjZW1lbnQgPSAnJTBBJyB9CikKIyBUT0RPOiBCVUc6IEVzY2FwZSBdCiMgVE9ETzogQlVHOiBFc2NhcGUgJSA/Pz8KIyBUT0RPOiBBZGQgdGVzdCB0byB2ZXJpZnkgZG9uJ3QgbmVlZCB0byBlc2NhcGUgIj0iLgoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1BZGRBdHRhY2htZW50IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRUeXBlLAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJE5hbWUsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kUGF0aCwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAndGFzaycgLUV2ZW50ICdhZGRhdHRhY2htZW50JyAtRGF0YSAkUGF0aCAtUHJvcGVydGllcyBAewogICAgICAgICAgICAndHlwZScgPSAkVHlwZQogICAgICAgICAgICAnbmFtZScgPSAkTmFtZQogICAgICAgIH0gLUFzT3V0cHV0OiRBc091dHB1dAp9Cgo8IwouU1lOT1BTSVMKU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvdnN0cy10YXNrcy9ibG9iL21hc3Rlci9kb2NzL2F1dGhvcmluZy9jb21tYW5kcy5tZAoKLlBBUkFNRVRFUiBBc091dHB1dApJbmRpY2F0ZXMgd2hldGhlciB0byB3cml0ZSB0aGUgbG9nZ2luZyBjb21tYW5kIGRpcmVjdGx5IHRvIHRoZSBob3N0IG9yIHRvIHRoZSBvdXRwdXQgcGlwZWxpbmUuCiM+CmZ1bmN0aW9uIFdyaXRlLUFkZEJ1aWxkVGFnIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRWYWx1ZSwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAnYnVpbGQnIC1FdmVudCAnYWRkYnVpbGR0YWcnIC1EYXRhICRWYWx1ZSAtQXNPdXRwdXQ6JEFzT3V0cHV0Cn0KCjwjCi5TWU5PUFNJUwpTZWUgaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC92c3RzLXRhc2tzL2Jsb2IvbWFzdGVyL2RvY3MvYXV0aG9yaW5nL2NvbW1hbmRzLm1kCgouUEFSQU1FVEVSIEFzT3V0cHV0CkluZGljYXRlcyB3aGV0aGVyIHRvIHdyaXRlIHRoZSBsb2dnaW5nIGNvbW1hbmQgZGlyZWN0bHkgdG8gdGhlIGhvc3Qgb3IgdG8gdGhlIG91dHB1dCBwaXBlbGluZS4KIz4KZnVuY3Rpb24gV3JpdGUtQXNzb2NpYXRlQXJ0aWZhY3QgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJE5hbWUsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kUGF0aCwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRUeXBlLAogICAgICAgIFtoYXNodGFibGVdJFByb3BlcnRpZXMsCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQpCgogICAgJHAgPSBAeyB9CiAgICBpZiAoJFByb3BlcnRpZXMpIHsKICAgICAgICBmb3JlYWNoICgka2V5IGluICRQcm9wZXJ0aWVzLktleXMpIHsKICAgICAgICAgICAgJHBbJGtleV0gPSAkUHJvcGVydGllc1ska2V5XQogICAgICAgIH0KICAgIH0KCiAgICAkcFsnYXJ0aWZhY3RuYW1lJ10gPSAkTmFtZQogICAgJHBbJ2FydGlmYWN0dHlwZSddID0gJFR5cGUKICAgIFdyaXRlLUxvZ2dpbmdDb21tYW5kIC1BcmVhICdhcnRpZmFjdCcgLUV2ZW50ICdhc3NvY2lhdGUnIC1EYXRhICRQYXRoIC1Qcm9wZXJ0aWVzICRwIC1Bc091dHB1dDokQXNPdXRwdXQKfQoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1Mb2dEZXRhaWwgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtndWlkXSRJZCwKICAgICAgICAkUGFyZW50SWQsCiAgICAgICAgW3N0cmluZ10kVHlwZSwKICAgICAgICBbc3RyaW5nXSROYW1lLAogICAgICAgICRPcmRlciwKICAgICAgICAkU3RhcnRUaW1lLAogICAgICAgICRGaW5pc2hUaW1lLAogICAgICAgICRQcm9ncmVzcywKICAgICAgICBbVmFsaWRhdGVTZXQoJ1Vua25vd24nLCAnSW5pdGlhbGl6ZWQnLCAnSW5Qcm9ncmVzcycsICdDb21wbGV0ZWQnKV0KICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgJFN0YXRlLAogICAgICAgIFtWYWxpZGF0ZVNldCgnU3VjY2VlZGVkJywgJ1N1Y2NlZWRlZFdpdGhJc3N1ZXMnLCAnRmFpbGVkJywgJ0NhbmNlbGxlZCcsICdTa2lwcGVkJyldCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgICRSZXN1bHQsCiAgICAgICAgW3N0cmluZ10kTWVzc2FnZSwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAndGFzaycgLUV2ZW50ICdsb2dkZXRhaWwnIC1EYXRhICRNZXNzYWdlIC1Qcm9wZXJ0aWVzIEB7CiAgICAgICAgICAgICdpZCcgPSAkSWQKICAgICAgICAgICAgJ3BhcmVudGlkJyA9ICRQYXJlbnRJZAogICAgICAgICAgICAndHlwZScgPSAkVHlwZQogICAgICAgICAgICAnbmFtZScgPSAkTmFtZQogICAgICAgICAgICAnb3JkZXInID0gJE9yZGVyCiAgICAgICAgICAgICdzdGFydHRpbWUnID0gJFN0YXJ0VGltZQogICAgICAgICAgICAnZmluaXNodGltZScgPSAkRmluaXNoVGltZQogICAgICAgICAgICAncHJvZ3Jlc3MnID0gJFByb2dyZXNzCiAgICAgICAgICAgICdzdGF0ZScgPSAkU3RhdGUKICAgICAgICAgICAgJ3Jlc3VsdCcgPSAkUmVzdWx0CiAgICAgICAgfSAtQXNPdXRwdXQ6JEFzT3V0cHV0Cn0KCjwjCi5TWU5PUFNJUwpTZWUgaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC92c3RzLXRhc2tzL2Jsb2IvbWFzdGVyL2RvY3MvYXV0aG9yaW5nL2NvbW1hbmRzLm1kCgouUEFSQU1FVEVSIEFzT3V0cHV0CkluZGljYXRlcyB3aGV0aGVyIHRvIHdyaXRlIHRoZSBsb2dnaW5nIGNvbW1hbmQgZGlyZWN0bHkgdG8gdGhlIGhvc3Qgb3IgdG8gdGhlIG91dHB1dCBwaXBlbGluZS4KIz4KZnVuY3Rpb24gV3JpdGUtU2V0UHJvZ3Jlc3MgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtWYWxpZGF0ZVJhbmdlKDAsIDEwMCldCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW2ludF0kUGVyY2VudCwKICAgICAgICBbc3RyaW5nXSRDdXJyZW50T3BlcmF0aW9uLAogICAgICAgIFtzd2l0Y2hdJEFzT3V0cHV0KQoKICAgIFdyaXRlLUxvZ2dpbmdDb21tYW5kIC1BcmVhICd0YXNrJyAtRXZlbnQgJ3NldHByb2dyZXNzJyAtRGF0YSAkQ3VycmVudE9wZXJhdGlvbiAtUHJvcGVydGllcyBAewogICAgICAgICAgICAndmFsdWUnID0gJFBlcmNlbnQKICAgICAgICB9IC1Bc091dHB1dDokQXNPdXRwdXQKfQoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1TZXRSZXN1bHQgewogICAgW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWUgPSAnQXNPdXRwdXQnKV0KICAgIHBhcmFtKAogICAgICAgIFtWYWxpZGF0ZVNldCgiU3VjY2VlZGVkIiwgIlN1Y2NlZWRlZFdpdGhJc3N1ZXMiLCAiRmFpbGVkIiwgIkNhbmNlbGxlZCIsICJTa2lwcGVkIildCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kUmVzdWx0LAogICAgICAgIFtzdHJpbmddJE1lc3NhZ2UsCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0FzT3V0cHV0JyldCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQsCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gJ0RvTm90VGhyb3cnKV0KICAgICAgICBbc3dpdGNoXSREb05vdFRocm93KQoKICAgIFdyaXRlLUxvZ2dpbmdDb21tYW5kIC1BcmVhICd0YXNrJyAtRXZlbnQgJ2NvbXBsZXRlJyAtRGF0YSAkTWVzc2FnZSAtUHJvcGVydGllcyBAewogICAgICAgICAgICAncmVzdWx0JyA9ICRSZXN1bHQKICAgICAgICB9IC1Bc091dHB1dDokQXNPdXRwdXQKICAgIGlmICgkUmVzdWx0IC1lcSAnRmFpbGVkJyAtYW5kICEkQXNPdXRwdXQgLWFuZCAhJERvTm90VGhyb3cpIHsKICAgICAgICAjIFNwZWNpYWwgaW50ZXJuYWwgZXhjZXB0aW9uIHR5cGUgdG8gY29udHJvbCB0aGUgZmxvdy4gTm90IGN1cnJlbnRseSBpbnRlbmRlZAogICAgICAgICMgZm9yIHB1YmxpYyB1c2FnZSBhbmQgc3ViamVjdCB0byBjaGFuZ2UuCiAgICAgICAgdGhyb3cgKE5ldy1PYmplY3QgVnN0c1Rhc2tTZGsuVGVybWluYXRpb25FeGNlcHRpb24oJE1lc3NhZ2UpKQogICAgfQp9Cgo8IwouU1lOT1BTSVMKU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvdnN0cy10YXNrcy9ibG9iL21hc3Rlci9kb2NzL2F1dGhvcmluZy9jb21tYW5kcy5tZAoKLlBBUkFNRVRFUiBBc091dHB1dApJbmRpY2F0ZXMgd2hldGhlciB0byB3cml0ZSB0aGUgbG9nZ2luZyBjb21tYW5kIGRpcmVjdGx5IHRvIHRoZSBob3N0IG9yIHRvIHRoZSBvdXRwdXQgcGlwZWxpbmUuCiM+CmZ1bmN0aW9uIFdyaXRlLVNldFNlY3JldCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVmFsdWUsCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQpCgogICAgV3JpdGUtTG9nZ2luZ0NvbW1hbmQgLUFyZWEgJ3Rhc2snIC1FdmVudCAnc2V0c2VjcmV0JyAtRGF0YSAkVmFsdWUgLUFzT3V0cHV0OiRBc091dHB1dAp9Cgo8IwouU1lOT1BTSVMKU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvdnN0cy10YXNrcy9ibG9iL21hc3Rlci9kb2NzL2F1dGhvcmluZy9jb21tYW5kcy5tZAoKLlBBUkFNRVRFUiBBc091dHB1dApJbmRpY2F0ZXMgd2hldGhlciB0byB3cml0ZSB0aGUgbG9nZ2luZyBjb21tYW5kIGRpcmVjdGx5IHRvIHRoZSBob3N0IG9yIHRvIHRoZSBvdXRwdXQgcGlwZWxpbmUuCiM+CmZ1bmN0aW9uIFdyaXRlLVNldFZhcmlhYmxlIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSROYW1lLAogICAgICAgIFtzdHJpbmddJFZhbHVlLAogICAgICAgIFtzd2l0Y2hdJFNlY3JldCwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAndGFzaycgLUV2ZW50ICdzZXR2YXJpYWJsZScgLURhdGEgJFZhbHVlIC1Qcm9wZXJ0aWVzIEB7CiAgICAgICAgICAgICd2YXJpYWJsZScgPSAkTmFtZQogICAgICAgICAgICAnaXNzZWNyZXQnID0gJFNlY3JldAogICAgICAgIH0gLUFzT3V0cHV0OiRBc091dHB1dAp9Cgo8IwouU1lOT1BTSVMKU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvdnN0cy10YXNrcy9ibG9iL21hc3Rlci9kb2NzL2F1dGhvcmluZy9jb21tYW5kcy5tZAoKLlBBUkFNRVRFUiBBc091dHB1dApJbmRpY2F0ZXMgd2hldGhlciB0byB3cml0ZSB0aGUgbG9nZ2luZyBjb21tYW5kIGRpcmVjdGx5IHRvIHRoZSBob3N0IG9yIHRvIHRoZSBvdXRwdXQgcGlwZWxpbmUuCiM+CmZ1bmN0aW9uIFdyaXRlLVRhc2tEZWJ1ZyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10kTWVzc2FnZSwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1UYXNrRGVidWdfSW50ZXJuYWwgQFBTQm91bmRQYXJhbWV0ZXJzCn0KCjwjCi5TWU5PUFNJUwpTZWUgaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC92c3RzLXRhc2tzL2Jsb2IvbWFzdGVyL2RvY3MvYXV0aG9yaW5nL2NvbW1hbmRzLm1kCgouUEFSQU1FVEVSIEFzT3V0cHV0CkluZGljYXRlcyB3aGV0aGVyIHRvIHdyaXRlIHRoZSBsb2dnaW5nIGNvbW1hbmQgZGlyZWN0bHkgdG8gdGhlIGhvc3Qgb3IgdG8gdGhlIG91dHB1dCBwaXBlbGluZS4KIz4KZnVuY3Rpb24gV3JpdGUtVGFza0Vycm9yIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbc3RyaW5nXSRNZXNzYWdlLAogICAgICAgIFtzdHJpbmddJEVyckNvZGUsCiAgICAgICAgW3N0cmluZ10kU291cmNlUGF0aCwKICAgICAgICBbc3RyaW5nXSRMaW5lTnVtYmVyLAogICAgICAgIFtzdHJpbmddJENvbHVtbk51bWJlciwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1Mb2dJc3N1ZSAtVHlwZSBlcnJvciBAUFNCb3VuZFBhcmFtZXRlcnMKfQoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1UYXNrVmVyYm9zZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10kTWVzc2FnZSwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBXcml0ZS1UYXNrRGVidWdfSW50ZXJuYWwgQFBTQm91bmRQYXJhbWV0ZXJzIC1Bc1ZlcmJvc2UKfQoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1UYXNrV2FybmluZyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10kTWVzc2FnZSwKICAgICAgICBbc3RyaW5nXSRFcnJDb2RlLAogICAgICAgIFtzdHJpbmddJFNvdXJjZVBhdGgsCiAgICAgICAgW3N0cmluZ10kTGluZU51bWJlciwKICAgICAgICBbc3RyaW5nXSRDb2x1bW5OdW1iZXIsCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQpCgogICAgV3JpdGUtTG9nSXNzdWUgLVR5cGUgd2FybmluZyBAUFNCb3VuZFBhcmFtZXRlcnMKfQoKPCMKLlNZTk9QU0lTClNlZSBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L3ZzdHMtdGFza3MvYmxvYi9tYXN0ZXIvZG9jcy9hdXRob3JpbmcvY29tbWFuZHMubWQKCi5QQVJBTUVURVIgQXNPdXRwdXQKSW5kaWNhdGVzIHdoZXRoZXIgdG8gd3JpdGUgdGhlIGxvZ2dpbmcgY29tbWFuZCBkaXJlY3RseSB0byB0aGUgaG9zdCBvciB0byB0aGUgb3V0cHV0IHBpcGVsaW5lLgojPgpmdW5jdGlvbiBXcml0ZS1VcGRhdGVCdWlsZE51bWJlciB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVmFsdWUsCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQpCgogICAgV3JpdGUtTG9nZ2luZ0NvbW1hbmQgLUFyZWEgJ2J1aWxkJyAtRXZlbnQgJ3VwZGF0ZWJ1aWxkbnVtYmVyJyAtRGF0YSAkVmFsdWUgLUFzT3V0cHV0OiRBc091dHB1dAp9Cgo8IwouU1lOT1BTSVMKU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvdnN0cy10YXNrcy9ibG9iL21hc3Rlci9kb2NzL2F1dGhvcmluZy9jb21tYW5kcy5tZAoKLlBBUkFNRVRFUiBBc091dHB1dApJbmRpY2F0ZXMgd2hldGhlciB0byB3cml0ZSB0aGUgbG9nZ2luZyBjb21tYW5kIGRpcmVjdGx5IHRvIHRoZSBob3N0IG9yIHRvIHRoZSBvdXRwdXQgcGlwZWxpbmUuCiM+CmZ1bmN0aW9uIFdyaXRlLVVwbG9hZEFydGlmYWN0IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRDb250YWluZXJGb2xkZXIsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kTmFtZSwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRQYXRoLAogICAgICAgIFtzd2l0Y2hdJEFzT3V0cHV0KQoKICAgIFdyaXRlLUxvZ2dpbmdDb21tYW5kIC1BcmVhICdhcnRpZmFjdCcgLUV2ZW50ICd1cGxvYWQnIC1EYXRhICRQYXRoIC1Qcm9wZXJ0aWVzIEB7CiAgICAgICAgICAgICdjb250YWluZXJmb2xkZXInID0gJENvbnRhaW5lckZvbGRlcgogICAgICAgICAgICAnYXJ0aWZhY3RuYW1lJyA9ICROYW1lCiAgICAgICAgfSAtQXNPdXRwdXQ6JEFzT3V0cHV0Cn0KCjwjCi5TWU5PUFNJUwpTZWUgaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC92c3RzLXRhc2tzL2Jsb2IvbWFzdGVyL2RvY3MvYXV0aG9yaW5nL2NvbW1hbmRzLm1kCgouUEFSQU1FVEVSIEFzT3V0cHV0CkluZGljYXRlcyB3aGV0aGVyIHRvIHdyaXRlIHRoZSBsb2dnaW5nIGNvbW1hbmQgZGlyZWN0bHkgdG8gdGhlIGhvc3Qgb3IgdG8gdGhlIG91dHB1dCBwaXBlbGluZS4KIz4KZnVuY3Rpb24gV3JpdGUtVXBsb2FkQnVpbGRMb2cgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJFBhdGgsCiAgICAgICAgW3N3aXRjaF0kQXNPdXRwdXQpCgogICAgV3JpdGUtTG9nZ2luZ0NvbW1hbmQgLUFyZWEgJ2J1aWxkJyAtRXZlbnQgJ3VwbG9hZGxvZycgLURhdGEgJFBhdGggLUFzT3V0cHV0OiRBc091dHB1dAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgUHJpdmF0ZSBmdW5jdGlvbnMuCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZnVuY3Rpb24gRm9ybWF0LUxvZ2dpbmdDb21tYW5kRGF0YSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oW3N0cmluZ10kVmFsdWUsIFtzd2l0Y2hdJFJldmVyc2UpCgogICAgaWYgKCEkVmFsdWUpIHsKICAgICAgICByZXR1cm4gJycKICAgIH0KCiAgICBpZiAoISRSZXZlcnNlKSB7CiAgICAgICAgZm9yZWFjaCAoJG1hcHBpbmcgaW4gJHNjcmlwdDpsb2dnaW5nQ29tbWFuZEVzY2FwZU1hcHBpbmdzKSB7CiAgICAgICAgICAgICRWYWx1ZSA9ICRWYWx1ZS5SZXBsYWNlKCRtYXBwaW5nLlRva2VuLCAkbWFwcGluZy5SZXBsYWNlbWVudCkKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGZvciAoJGkgPSAkc2NyaXB0OmxvZ2dpbmdDb21tYW5kRXNjYXBlTWFwcGluZ3MuTGVuZ3RoIC0gMSA7ICRpIC1nZSAwIDsgJGktLSkgewogICAgICAgICAgICAkbWFwcGluZyA9ICRzY3JpcHQ6bG9nZ2luZ0NvbW1hbmRFc2NhcGVNYXBwaW5nc1skaV0KICAgICAgICAgICAgJFZhbHVlID0gJFZhbHVlLlJlcGxhY2UoJG1hcHBpbmcuUmVwbGFjZW1lbnQsICRtYXBwaW5nLlRva2VuKQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJFZhbHVlCn0KCmZ1bmN0aW9uIEZvcm1hdC1Mb2dnaW5nQ29tbWFuZCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kQXJlYSwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRFdmVudCwKICAgICAgICBbc3RyaW5nXSREYXRhLAogICAgICAgIFtoYXNodGFibGVdJFByb3BlcnRpZXMpCgogICAgIyBBcHBlbmQgdGhlIHByZWFtYmxlLgogICAgW1N5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXJdJHNiID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlRleHQuU3RyaW5nQnVpbGRlcgogICAgJG51bGwgPSAkc2IuQXBwZW5kKCRzY3JpcHQ6bG9nZ2luZ0NvbW1hbmRQcmVmaXgpLkFwcGVuZCgkQXJlYSkuQXBwZW5kKCcuJykuQXBwZW5kKCRFdmVudCkKCiAgICAjIEFwcGVuZCB0aGUgcHJvcGVydGllcy4KICAgIGlmICgkUHJvcGVydGllcykgewogICAgICAgICRmaXJzdCA9ICR0cnVlCiAgICAgICAgZm9yZWFjaCAoJGtleSBpbiAkUHJvcGVydGllcy5LZXlzKSB7CiAgICAgICAgICAgIFtzdHJpbmddJHZhbHVlID0gRm9ybWF0LUxvZ2dpbmdDb21tYW5kRGF0YSAkUHJvcGVydGllc1ska2V5XQogICAgICAgICAgICBpZiAoJHZhbHVlKSB7CiAgICAgICAgICAgICAgICBpZiAoJGZpcnN0KSB7CiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSAkc2IuQXBwZW5kKCcgJykKICAgICAgICAgICAgICAgICAgICAkZmlyc3QgPSAkZmFsc2UKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSAkc2IuQXBwZW5kKCc7JykKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkbnVsbCA9ICRzYi5BcHBlbmQoIiRrZXk9JHZhbHVlIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAjIEFwcGVuZCB0aGUgdGFpbCBhbmQgb3V0cHV0IHRoZSB2YWx1ZS4KICAgICREYXRhID0gRm9ybWF0LUxvZ2dpbmdDb21tYW5kRGF0YSAkRGF0YQogICAgJHNiLkFwcGVuZCgnXScpLkFwcGVuZCgkRGF0YSkuVG9TdHJpbmcoKQp9CgpmdW5jdGlvbiBXcml0ZS1Mb2dnaW5nQ29tbWFuZCB7CiAgICBbQ21kbGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZSA9ICdQYXJhbWV0ZXJzJyldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lID0gJ1BhcmFtZXRlcnMnKV0KICAgICAgICBbc3RyaW5nXSRBcmVhLAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBhcmFtZXRlclNldE5hbWUgPSAnUGFyYW1ldGVycycpXQogICAgICAgIFtzdHJpbmddJEV2ZW50LAogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICdQYXJhbWV0ZXJzJyldCiAgICAgICAgW3N0cmluZ10kRGF0YSwKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAnUGFyYW1ldGVycycpXQogICAgICAgIFtoYXNodGFibGVdJFByb3BlcnRpZXMsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZSA9ICdPYmplY3QnKV0KICAgICAgICAkQ29tbWFuZCwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICBpZiAoJFBTQ21kbGV0LlBhcmFtZXRlclNldE5hbWUgLWVxICdPYmplY3QnKSB7CiAgICAgICAgV3JpdGUtTG9nZ2luZ0NvbW1hbmQgLUFyZWEgJENvbW1hbmQuQXJlYSAtRXZlbnQgJENvbW1hbmQuRXZlbnQgLURhdGEgJENvbW1hbmQuRGF0YSAtUHJvcGVydGllcyAkQ29tbWFuZC5Qcm9wZXJ0aWVzIC1Bc091dHB1dDokQXNPdXRwdXQKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAkY29tbWFuZCA9IEZvcm1hdC1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAkQXJlYSAtRXZlbnQgJEV2ZW50IC1EYXRhICREYXRhIC1Qcm9wZXJ0aWVzICRQcm9wZXJ0aWVzCiAgICBpZiAoJEFzT3V0cHV0KSB7CiAgICAgICAgJGNvbW1hbmQKICAgIH0gZWxzZSB7CiAgICAgICAgV3JpdGUtSG9zdCAkY29tbWFuZAogICAgfQp9CgpmdW5jdGlvbiBXcml0ZS1Mb2dJc3N1ZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1ZhbGlkYXRlU2V0KCd3YXJuaW5nJywgJ2Vycm9yJyldCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVHlwZSwKICAgICAgICBbc3RyaW5nXSRNZXNzYWdlLAogICAgICAgIFtzdHJpbmddJEVyckNvZGUsCiAgICAgICAgW3N0cmluZ10kU291cmNlUGF0aCwKICAgICAgICBbc3RyaW5nXSRMaW5lTnVtYmVyLAogICAgICAgIFtzdHJpbmddJENvbHVtbk51bWJlciwKICAgICAgICBbc3dpdGNoXSRBc091dHB1dCkKCiAgICAkY29tbWFuZCA9IEZvcm1hdC1Mb2dnaW5nQ29tbWFuZCAtQXJlYSAndGFzaycgLUV2ZW50ICdsb2dpc3N1ZScgLURhdGEgJE1lc3NhZ2UgLVByb3BlcnRpZXMgQHsKICAgICAgICAgICAgJ3R5cGUnID0gJFR5cGUKICAgICAgICAgICAgJ2NvZGUnID0gJEVyckNvZGUKICAgICAgICAgICAgJ3NvdXJjZXBhdGgnID0gJFNvdXJjZVBhdGgKICAgICAgICAgICAgJ2xpbmVudW1iZXInID0gJExpbmVOdW1iZXIKICAgICAgICAgICAgJ2NvbHVtbm51bWJlcicgPSAkQ29sdW1uTnVtYmVyCiAgICAgICAgfQogICAgaWYgKCRBc091dHB1dCkgewogICAgICAgIHJldHVybiAkY29tbWFuZAogICAgfQoKICAgIGlmICgkVHlwZSAtZXEgJ2Vycm9yJykgewogICAgICAgICRmb3JlZ3JvdW5kQ29sb3IgPSAkaG9zdC5Qcml2YXRlRGF0YS5FcnJvckZvcmVncm91bmRDb2xvcgogICAgICAgICRiYWNrZ3JvdW5kQ29sb3IgPSAkaG9zdC5Qcml2YXRlRGF0YS5FcnJvckJhY2tncm91bmRDb2xvcgogICAgICAgIGlmICgkZm9yZWdyb3VuZENvbG9yIC1pc25vdCBbU3lzdGVtLkNvbnNvbGVDb2xvcl0gLW9yICRiYWNrZ3JvdW5kQ29sb3IgLWlzbm90IFtTeXN0ZW0uQ29uc29sZUNvbG9yXSkgewogICAgICAgICAgICAkZm9yZWdyb3VuZENvbG9yID0gW1N5c3RlbS5Db25zb2xlQ29sb3JdOjpSZWQKICAgICAgICAgICAgJGJhY2tncm91bmRDb2xvciA9IFtTeXN0ZW0uQ29uc29sZUNvbG9yXTo6QmxhY2sKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgICRmb3JlZ3JvdW5kQ29sb3IgPSAkaG9zdC5Qcml2YXRlRGF0YS5XYXJuaW5nRm9yZWdyb3VuZENvbG9yCiAgICAgICAgJGJhY2tncm91bmRDb2xvciA9ICRob3N0LlByaXZhdGVEYXRhLldhcm5pbmdCYWNrZ3JvdW5kQ29sb3IKICAgICAgICBpZiAoJGZvcmVncm91bmRDb2xvciAtaXNub3QgW1N5c3RlbS5Db25zb2xlQ29sb3JdIC1vciAkYmFja2dyb3VuZENvbG9yIC1pc25vdCBbU3lzdGVtLkNvbnNvbGVDb2xvcl0pIHsKICAgICAgICAgICAgJGZvcmVncm91bmRDb2xvciA9IFtTeXN0ZW0uQ29uc29sZUNvbG9yXTo6WWVsbG93CiAgICAgICAgICAgICRiYWNrZ3JvdW5kQ29sb3IgPSBbU3lzdGVtLkNvbnNvbGVDb2xvcl06OkJsYWNrCiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLUhvc3QgJGNvbW1hbmQgLUZvcmVncm91bmRDb2xvciAkZm9yZWdyb3VuZENvbG9yIC1CYWNrZ3JvdW5kQ29sb3IgJGJhY2tncm91bmRDb2xvcgp9CgpmdW5jdGlvbiBXcml0ZS1UYXNrRGVidWdfSW50ZXJuYWwgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtzdHJpbmddJE1lc3NhZ2UsCiAgICAgICAgW3N3aXRjaF0kQXNWZXJib3NlLAogICAgICAgIFtzd2l0Y2hdJEFzT3V0cHV0KQoKICAgICRjb21tYW5kID0gRm9ybWF0LUxvZ2dpbmdDb21tYW5kIC1BcmVhICd0YXNrJyAtRXZlbnQgJ2RlYnVnJyAtRGF0YSAkTWVzc2FnZQogICAgaWYgKCRBc091dHB1dCkgewogICAgICAgIHJldHVybiAkY29tbWFuZAogICAgfQoKICAgIGlmICgkQXNWZXJib3NlKSB7CiAgICAgICAgJGZvcmVncm91bmRDb2xvciA9ICRob3N0LlByaXZhdGVEYXRhLlZlcmJvc2VGb3JlZ3JvdW5kQ29sb3IKICAgICAgICAkYmFja2dyb3VuZENvbG9yID0gJGhvc3QuUHJpdmF0ZURhdGEuVmVyYm9zZUJhY2tncm91bmRDb2xvcgogICAgICAgIGlmICgkZm9yZWdyb3VuZENvbG9yIC1pc25vdCBbU3lzdGVtLkNvbnNvbGVDb2xvcl0gLW9yICRiYWNrZ3JvdW5kQ29sb3IgLWlzbm90IFtTeXN0ZW0uQ29uc29sZUNvbG9yXSkgewogICAgICAgICAgICAkZm9yZWdyb3VuZENvbG9yID0gW1N5c3RlbS5Db25zb2xlQ29sb3JdOjpDeWFuCiAgICAgICAgICAgICRiYWNrZ3JvdW5kQ29sb3IgPSBbU3lzdGVtLkNvbnNvbGVDb2xvcl06OkJsYWNrCiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICAkZm9yZWdyb3VuZENvbG9yID0gJGhvc3QuUHJpdmF0ZURhdGEuRGVidWdGb3JlZ3JvdW5kQ29sb3IKICAgICAgICAkYmFja2dyb3VuZENvbG9yID0gJGhvc3QuUHJpdmF0ZURhdGEuRGVidWdCYWNrZ3JvdW5kQ29sb3IKICAgICAgICBpZiAoJGZvcmVncm91bmRDb2xvciAtaXNub3QgW1N5c3RlbS5Db25zb2xlQ29sb3JdIC1vciAkYmFja2dyb3VuZENvbG9yIC1pc25vdCBbU3lzdGVtLkNvbnNvbGVDb2xvcl0pIHsKICAgICAgICAgICAgJGZvcmVncm91bmRDb2xvciA9IFtTeXN0ZW0uQ29uc29sZUNvbG9yXTo6RGFya0dyYXkKICAgICAgICAgICAgJGJhY2tncm91bmRDb2xvciA9IFtTeXN0ZW0uQ29uc29sZUNvbG9yXTo6QmxhY2sKICAgICAgICB9CiAgICB9CgogICAgV3JpdGUtSG9zdCAtT2JqZWN0ICRjb21tYW5kIC1Gb3JlZ3JvdW5kQ29sb3IgJGZvcmVncm91bmRDb2xvciAtQmFja2dyb3VuZENvbG9yICRiYWNrZ3JvdW5kQ29sb3IKfQo=
