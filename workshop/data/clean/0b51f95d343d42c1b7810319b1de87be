twingle.psm1,c3292752f710cabaf8b70eb27f763cc2,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgCiMgVHdpbmdsZSBMaWJyYXJ5IG9mIEZ1bmN0aW9uYXRpb24KIwojIEFueSBmdW5jdGlvbiB0aGF0J3MgdXNlZCBtb3JlIHRoYW4gb25jZSBpbiB0d2luZ2xlIHNob3VsZCBnbyBoZXJlLiAKIyBVbmxlc3MgaXQncyBhd2Vzb21lIGVub3VnaCBmb3IgaXQncyBvd24gZmlsZS4KIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMgR2xvYmFsIFZhcmlhYmxlcwokaW5pR2xvYiA9IEB7fQokdHdpbmdsZURpciA9ICJDOlx0d2luZ2xlIiAjaGFyZGNvZGVkIGJlY2F1c2UuIAokZGVidWcgPSAwCiRuZXN0aW5nID0gIiIKCmZ1bmN0aW9uIHR3aW5nbGVEaXIgeyAgIAoJcmV0dXJuICR0d2luZ2xlRGlyCn0KCiMgUGF1c2UgZnVuY3Rpb24KZnVuY3Rpb24gcGF1c2UgKCRtZXNzYWdlID0iUHJlc3MgYW55IGtleSB0byBjb250aW51ZS4uLiAiKSB7IAoJd3JpdGUtaG9zdCAtbm9uZXdsaW5lICRtZXNzYWdlCgkkbnVsbCA9ICRIb3N0LnVpLnJhd3VpLnJlYWRrZXkoIm5vZWNobyxpbmNsdWRla2V5ZG93biIpCgl3cml0ZS1ob3N0ICIiCn0KCgojIFBhcnNlIHRoZSBJTkkgY29uZmlndXJhdGlvbiBmaWxlIGludG8gYSBuaWNlIHRoaW5nLgpGdW5jdGlvbiBQYXJzZV9JbmlGaWxlICAoJGZpbGUpIHsKICBpZiAoISRmaWxlKSB7ICRmaWxlID0gIiR0d2luZ2xlRGlyXHR3aW5nbGUuY2ZnIn0gCiAgJGluaSA9IEB7fQogIHN3aXRjaCAtcmVnZXggLWZpbGUgJGZpbGUgewogICAgIl5cWyguKylcXSQiIHsKICAgICAgJHNlY3Rpb24gPSAkbWF0Y2hlc1sxXS5UcmltKCkKICAgICAgJGluaVskc2VjdGlvbl0gPSBAe30KICAgIH0KICAgICJeXHMqKFteI10uKz8pXHMqPVxzKiguKikiIHsKICAgICAgJG5hbWUsJHZhbHVlID0gJG1hdGNoZXNbMS4uMl0KICAgICAgJGluaVskc2VjdGlvbl1bJG5hbWVdID0gJHZhbHVlLlRyaW0oKQogICAgfQogIH0gIAogIAogIHNldC12YXJpYWJsZSAtbmFtZSBpbmlHbG9iIC12YWx1ZSAkaW5pICAtc2NvcGUgMSAKICByZXR1cm4gJGluaQp9CgoKZnVuY3Rpb24gZ2V0Q29uZmlnICgkY29uZmlnKXsgCglpZiAoISRpbmlHbG9iKSB7IGxvZyAiTm8gZ2xvYnRhYmxlIjsgcmV0dXJuICJOTyBWQUxVRSJ9CgllbHNlIHsKCSR2YWx1ZSA9ICRpbmlHbG9iWyJjb25maWciXVskY29uZmlnXQoJaWYgKCR2YWx1ZS5sZW5ndGggLWVxIDApIHsgIkNvbmZpZyBub3QgZm91bmQ6ICRjb25maWcifQkKCXJldHVybiAkdmFsdWUKCX0KfQoKCiNQYXNzaXZlIE5hZ2lvcyBDaGVjayBzdWJtaXQKZnVuY3Rpb24gc2V0X25hZ2lvc19zdGF0dXMgKCRyZXN1bHQsICRUZXh0KSB7CiAgICAgICAjQ1VTVE9NSVNFIFRISVMgWU9VUlNFTEYhCiAgICAgICAjIFlvdSBjYW4gc2VuZCBwYXNzaXZlIGNoZWNrcyB0byBuYWdpb3MgaGVyZS4gVGhpcyBpcyBsZWZ0IGFzIGFuIGV4ZXJjaXNlIGZvciB0aGUgcmVhZGVyLgoKICAgICAgICNzYXZlIGEgY29weSB0byB0aGUgbG9nIGZpbGUKICAgICAgICRsb2dmaWxlID0gIiR0d2luZ2xlRGlyXHR3aW5nbGUubG9nIgogICAgICAgbG9nICJOYWdpb3MgUGFzc2l2ZSBDaGVjayBzdWJtaXR0ZWQ6ICRyZXN1bHQgOiAkVGV4dCIKCn0KCiMgRGVidWcgbW9kZSAtIHNldHMgdGhlIGdsb2JhbCBkZWJ1ZyB2YXJpYWJsZSB0byBlbmFibGUgbG9nZ2luZyB0byBzdGRvdXQKZnVuY3Rpb24gZGVidWdfbW9kZSB7IAoJc2V0LXZhcmlhYmxlIC1uYW1lIGRlYnVnIC12YWx1ZSAxIC1zY29wZSAxCn0KCgojIExvZyBvdHVwdXQgdG8gZmlsZSwgd2l0aCBuaWNlIGRhdGUgc3RhbXBzCmZ1bmN0aW9uIGxvZyAoJHRleHQpIHsKCSRsb2dmaWxlID0gIiR0d2luZ2xlRGlyXHR3aW5nbGUubG9nIgoJJGRhdGUgPSBHZXQtRGF0ZSAtZm9ybWF0IEcKCWlmICgkbmVzdGluZy5sZW5ndGggLW5lIDApIHsgJGJ1ZmYgPSAiICAifSAKCSRvdXRwdXQgPSAiJGRhdGUgLSAkYnVmZiRuZXN0aW5nICRUZXh0IgoJJG91dHB1dCB8IE91dC1GaWxlICRsb2dmaWxlIC1BcHBlbmQKCWlmICgkZGVidWcgLWVxIDEpIHsgJG91dHB1dCB9Cn0KCiMgQW55IGJhZCBiYWQgZXJyb3JzIGxvZ3MgdG8gZmlsZSwgbmFnaW9zIGFuZCBjbG9zZXMgcHJvZ3JhbS4KZnVuY3Rpb24gZXJyb3IgKCR0ZXh0KSB7IAogICBsb2cgIkVSUk9SOiAkdGV4dCIKICAgJG5hZ2lvc2Vycm9yID0gZ2V0Q29uZmlnIG5hZ2lvc2Vycm9yICNjb25maWcgZm9yIGVycm9yIHNldmVyaXR5CiAgIHNldF9uYWdpb3Nfc3RhdHVzICRuYWdpb3NlcnJvciAkdGV4dAogICBsb2cgJHRleHQKICAgbG9nICJFUlJPUkVEIG91dCBvbiBhYm92ZSBtZXNzYWdlIgogICBleGl0IDAKfSAKCgojIGZ1bmN0aW9uYWxpdHkgdG8gYWxsb3cgbmVzdGVkIG91dHB1dCAoY2FsbHMgdG8gbmV3IGZpbGVzIGhhdmUgIj4+IiwgYW1vdW50IGRldGVybWluZWQgYnkgZGVwdGgpCmZ1bmN0aW9uIGxvZ2dpbmcgKCRkaXJlY3Rpb24sICRmaWxlKSB7Cgkjc2V0LXZhcmlhYmxlIC1uYW1lIGV4ZWZpbGUgLXZhbHVlICAkZmlsZSAgLXNjb3BlIDEKCWlmICgkZGlyZWN0aW9uIC1lcSAic3RhcnQiKSB7CgkJJG5ldyA9ICRuZXN0aW5nICsgIj4iOyBzZXQtdmFyaWFibGUgLW5hbWUgbmVzdGluZyAtdmFsdWUgJG5ldyAgLXNjb3BlIDEgCgkJbG9nICJzdGFydCAtICRmaWxlLnBzMSIgfQoJaWYgKCRkaXJlY3Rpb24gLWVxICJlbmQiKSB7IAkKCQlsb2cgImVuZCAtICRmaWxlLnBzMSIKCQkkYyA9ICRuZXN0aW5nLmxlbmd0aDsgJG5ldyA9ICRuZXN0aW5nLnN1YnN0cmluZygwLCRjLTEpOyBzZXQtdmFyaWFibGUgLW5hbWUgbmVzdGluZyAtdmFsdWUgJG5ldyAgLXNjb3BlIDEgCgkJIH0KfQoKIyBOaWNlIHNlYXJjaGluZyBvZiBleGlzdGluZyBzY2hlZHVsZWQgdGFza3MKZnVuY3Rpb24gZ2V0X3Rhc2sgKCR0YXNrbmFtZT0iIil7CiAgICAkZmlsZW5hbWUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQogICAgaW52b2tlLWV4cHJlc3Npb24gInNjaHRhc2tzIC9xdWVyeSAvZm8gY3N2IC92ICIgfCBvdXQtZmlsZSAkZmlsZW5hbWUKICAgICRsaW5lcz1HZXQtQ29udGVudCAkZmlsZW5hbWUKIGlmICgkbGluZXMgLWlzIFtzdHJpbmddKXsKICAgIHJldHVybiAkbnVsbAogfSBlbHNlIHsKICAgICAgICBpZiAoJGxpbmVzWzBdIC1uZSAnJyl7CiAgIFNldC1Db250ZW50IC1wYXRoICRmaWxlbmFtZSAtVmFsdWUgKFtzdHJpbmddJGxpbmVzWzBdKS5SZXBsYWNlKCIgIiwiIikuUmVwbGFjZSgiOiIsIl8iKQogICAkc3RhcnQ9MQogIH0gZWxzZSB7CiAgIFNldC1Db250ZW50IC1wYXRoICRmaWxlbmFtZSAtVmFsdWUgKFtzdHJpbmddJGxpbmVzWzFdKS5SZXBsYWNlKCIgIiwiIikuUmVwbGFjZSgiOiIsIl8iKQogICAkc3RhcnQ9MgogIH0KICBpZiAoJGxpbmVzLkNvdW50IC1nZSAkc3RhcnQpewogICBBZGQtY29udGVudCAgLVBhdGggJGZpbGVuYW1lIC1WYWx1ZSAkbGluZXNbJHN0YXJ0Li4oKCRsaW5lcy5jb3VudCktMSldCiAgfQogICR0YXNrcz1JbXBvcnQtQ3N2ICRmaWxlbmFtZQogIFJlbW92ZS1JdGVtICRmaWxlbmFtZQogICRyZXR2YWw9QCgpCiAgZm9yZWFjaCAoJHRhc2sgaW4gJHRhc2tzKXsKICAgaWYgKCgkdGFza25hbWUgLWVxICcnKSAtb3IgJHRhc2suVGFza05hbWUuY29udGFpbnMoJHRhc2tuYW1lKSl7CiAgICAkdGFzay5QU09iamVjdC5UeXBlTmFtZXMuSW5zZXJ0KDAsIkRCQV9TY2hlZHVsZWRUYXNrIikKICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICR0YXNrIC1tZW1iZXJ0eXBlIHNjcmlwdG1ldGhvZCAtTmFtZSBSdW4gLVZhbHVlIHsgc2NodGFza3MuZXhlIC9SVU4gL1ROICR0aGlzLlRhc2tOYW1lIC9TICR0aGlzLkhvc3ROYW1lfQogICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHRhc2sgLW1lbWJlcnR5cGUgc2NyaXB0bWV0aG9kIC1OYW1lIERlbGV0ZSAtVmFsdWUgeyBzY2h0YXNrcy5leGUgL0RFTEVURSAvVE4gJHRoaXMuVGFza05hbWUgL1MgJHRoaXMuSG9zdE5hbWV9CiAgICAkcmV0dmFsICs9ICR0YXNrCiAgIH0KICB9CiAgcmV0dXJuICRyZXR2YWwKIH0KfQoKCiMgQmFubmVyYXRpb24hCmZ1bmN0aW9uIGJhbm5lciAoJHRleHQsICRjb2xvdXIpIHsgCglpZiAoJHRleHQgLWVxICJibGFuayIpIHskdGV4dCA9ICIifQoJJGNoYXIgPSAiICIKCWlmICgkdGV4dCAtZXEgImhhc2hiYW5uZXIiKSB7ICRjaGFyID0gIiMiOyAkdGV4dCA9ICIifQoJJHdpZHRoID0gNjAKCSRidWZmID0gKCR3aWR0aCAtICR0ZXh0Lmxlbmd0aCApLzIKCWZvciAoJGkgPSAwOyAkaSAtbGUgJGJ1ZmY7ICRpKyspIHsKCQkkYnVmZmVyICs9ICRjaGFyCgkgfSAKCSRidWZmZXIgKz0gJHRleHQKCWZvciAoJGkgPSAwOyAkaSAtbGUgJGJ1ZmY7ICRpKyspIHsKCQkkYnVmZmVyICs9ICRjaGFyCgl9IAoJaWYgKCRjb2xvdXIpIHsgCgkJd3JpdGUtaG9zdCAkYnVmZmVyIC1mb3JlZ3JvdW5kICRjb2xvdXIgCgl9IGVsc2UgeyB3cml0ZS1ob3N0ICRidWZmZXIKCX0KfQoKIyBDcmVhdGUgc2NoZWR1bGVkIHRhc2sgLSBtaW5pbWFsIGZ1bmN0aW9uYWxpdHkgY29tcGFyZWQgdG8gc2NodGFza3MgcHJvcGVyLCBidXQgYWRkZWQgT1MgbG9naWMuCmZ1bmN0aW9uIHNjaGVkdWxlX3Rhc2sgKCRuYW1lLCAkdHlwZSwgJGRheSwgJHRpbWUsICRhY3Rpb24gKSB7IAoJI1lhcnIKCWxvZyAiZ2V0dGluZyBzY2h0YXNrIGNvbmZpZyIKCSRub3NjaHRhc2sgPSBnZXRjb25maWcgbm9zY2h0YXNrCglpZiAoJG5vc2NodGFzayAtZXEgMCkgeyAKCQkkT1NWZXJzaW9uID0gaW52b2tlLWV4cHJlc3Npb24gIndtaWMgb3MgZ2V0IENhcHRpb24gL3ZhbHVlIgoJCWlmICgkT1NWZXJzaW9uIC1tYXRjaCAiMjAwOCIpIHsgJGNvbW1hbmRzID0gICIgL05QIC9STCBISUdIRVNUIiB9CgkJaWYgKCRPU1ZlcnNpb24gLW1hdGNoICIyMDAzIikgeyAkY29tbWFuZHMgPSAiL1JVIFNZU1RFTSIgfSAKCgkJIyR0eXBlIC0gV2Vla2x5LCBPbmNlLCBPblN0YXJ0CgkJIyRuYW1lIC0gZnJlZWZvcm0gCgkJIyRkYXkvJHRpbWUgLSBpZ25vcmUgZm9yIE9uU3RhcnQKCQkKCQlpZiAoJHR5cGUgLWVxICJPTlNUQVJUIikgeyAkdGltaW5nID0gIiI7IH0KCQlpZiAoJHR5cGUgLWVxICJPTkNFIikgeyAgJHRpbWluZyA9ICIvc2QgJGRheSAvc3QgJHRpbWUiOyBpZiAoJGRheS5sZW5ndGggLWxlIDEwKSB7ICRkYXkgPSAiMCIrJGRheX19CQoJCWlmICgkdHlwZSAtZXEgIldFRUtMWSIpIHsgICR0aW1pbmcgPSAgIi9kICRkYXkgL3N0ICR0aW1lIjsgIH0KCQkKCQkkc2NoZWR0YXNrID0gInNjaHRhc2tzIC9jcmVhdGUgL3RuIGAiJG5hbWVgIiAkc2NoZWR0YXNrIC9UUiBgIiRhY3Rpb25gIiAvc2MgJHR5cGUgICR0aW1pbmcgL2YgJGNvbW1hbmRzIgoKCQlsb2cgIlNjaGVkdWxlZCBUYXNrIHRvIGludm9rZTogJHNjaGVkdGFzayIKCQkKCQkJJG91dHB1dCA9IGludm9rZS1leHByZXNzaW9uICRzY2hlZHRhc2sJCgkJaWYgKCRvdXRwdXQgLW1hdGNoICJTVUNDRVNTIikgeyAKCQkJbG9nICJUYXNrICRuYW1lIHN1Y2Nlc3NmdWxseSBjcmVhdGVkLiAiIAoJCQlpZiAoJHR5cGUgLWVxICJXRUVLTFkiKSB7IHJldHVybiAwIH0gCgkJfSBlbHNlIHsgCgkJCWVycm9yICJTY2hlZHVsZWQgdGFzayBjb3VsZCBub3QgYmUgY3JlYXRlZC4iIAoJCQlzZXRfbmFnaW9zX3N0YXR1cyBXQVJOSU5HICJTY2hlZHVsZWQgdGFzayBlcnJvcjogY291bGQgbm90IGNyZWF0ZSAkdHlwZSB0YXNrIgoJCQlpZiAoJHR5cGUgLWVxICJXRUVLTFkiKSB7IHJldHVybiAxIH0gCgkJfQoJfSBlbHNlIHsgIk5vIHNjaGVkdWxlZCB0YXNrIHRvIGJlIGNyZWF0ZWQsIGJlY2F1c2UgY29uZmlnIHNheXMgbm90IHRvIjsgcmV0dXJuIDB9Cn0KCiNSZW1vdmUgdGFzayBuYW1lZCAkVGFza05hbWUKZnVuY3Rpb24gcmVtb3ZlX3NjaHRhc2sgKCRUYXNrTmFtZSkgeyAKCgkkb3V0cHV0ID0gaW52b2tlLWV4cHJlc3Npb24gInNjaHRhc2tzIC9kZWxldGUgL3RuIGAiJFRhc2tOYW1lYCIgL2YiCglpZiAoJG91dHB1dCAtbWF0Y2ggIlNVQ0NFU1MiKSB7IAoJCWxvZyAiVGFzayAkVGFza05hbWUgZGVsZXRlZCBzdWNjZXNzZnVsbHkiIAoJfSBlbHNlIHsgCgkJbG9nICJUYXNrICRUYXNrTmFtZSBkZWxldGlvbiBmYWlsZWQiIAoJfQp9CgojIE5pY2UgZGF0ZSBmb3JtYXR0aW5nIGZ1bmN0aW9ucyAoZm9yIHNjaHRhc2tzKQpmdW5jdGlvbiBmb3JtYXRfdGltZSAoJGRhdGUpIHsgCiAgICByZXR1cm4gKGdldC1kYXRlICRkYXRlIC1mb3JtYXQgSEg6bW0pCn0gCmZ1bmN0aW9uIGZvcm1hdF9kYXRlICgkZGF0ZSkgeyAKICAgIHJldHVybiAoZ2V0LWRhdGUgJGRhdGUgLWZvcm1hdCBkZC9NTS95eXl5KQp9IAo=
