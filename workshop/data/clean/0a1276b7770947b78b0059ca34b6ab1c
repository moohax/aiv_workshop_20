MSFT_SPCreateFarm.psm1,638dfc5be194c87bf06b965239212455,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAKICAgICAgICAkRmFybUNvbmZpZ0RhdGFiYXNlTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gCiAgICAgICAgJERhdGFiYXNlU2VydmVyLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIAogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gCiAgICAgICAgJEZhcm1BY2NvdW50LAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIAogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gCiAgICAgICAgJEluc3RhbGxBY2NvdW50LAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIAogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gCiAgICAgICAgJFBhc3NwaHJhc2UsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgCiAgICAgICAgW1N5c3RlbS5TdHJpbmddIAogICAgICAgICRBZG1pbkNvbnRlbnREYXRhYmFzZU5hbWUsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gCiAgICAgICAgW1N5c3RlbS5VSW50MzJdIAogICAgICAgICRDZW50cmFsQWRtaW5pc3RyYXRpb25Qb3J0LAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAKICAgICAgICBbVmFsaWRhdGVTZXQoIk5UTE0iLCJLZXJiZXJvcyIpXQogICAgICAgICRDZW50cmFsQWRtaW5pc3RyYXRpb25BdXRoLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAKICAgICAgICBbVmFsaWRhdGVTZXQoIkFwcGxpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgIkFwcGxpY2F0aW9uV2l0aFNlYXJjaCIsCiAgICAgICAgICAgICAgICAgICAgICJDdXN0b20iLAogICAgICAgICAgICAgICAgICAgICAiRGlzdHJpYnV0ZWRDYWNoZSIsCiAgICAgICAgICAgICAgICAgICAgICJTZWFyY2giLAogICAgICAgICAgICAgICAgICAgICAiU2luZ2xlU2VydmVyIiwKICAgICAgICAgICAgICAgICAgICAgIlNpbmdsZVNlcnZlckZhcm0iLAogICAgICAgICAgICAgICAgICAgICAiV2ViRnJvbnRFbmQiLAogICAgICAgICAgICAgICAgICAgICAiV2ViRnJvbnRFbmRXaXRoRGlzdHJpYnV0ZWRDYWNoZSIpXSAKICAgICAgICAkU2VydmVyUm9sZQogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCJXQVJOSU5HISBTUENyZWF0ZUZhcm0gaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluICIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2hhcmVQb2ludERzYyB2Mi4wLiBTd2FwIHRvIHVzZSB0aGUgbmV3IFNQRmFybSByZXNvdXJjZSBhcyAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFuIGFsdGVybmF0aXZlLiBTZWUgaHR0cDovL2FrYS5tcy9TUERzYy1TUEZhcm0gZm9yIGRldGFpbHMuIikKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJHZXR0aW5nIGxvY2FsIFNQIEZhcm0gc2V0dGluZ3MiCgogICAgaWYgKCgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIlNlcnZlclJvbGUiKSAtZXEgJHRydWUpIGAKICAgICAgICAtYW5kIChHZXQtU1BEU0NJbnN0YWxsZWRQcm9kdWN0VmVyc2lvbikuRmlsZU1ham9yUGFydCAtbmUgMTYpIAogICAgewogICAgICAgIHRocm93IFtFeGNlcHRpb25dICJTZXJ2ZXIgcm9sZSBpcyBvbmx5IHN1cHBvcnRlZCBpbiBTaGFyZVBvaW50IDIwMTYuIgogICAgfQoKICAgIGlmICgoJFBTQm91bmRQYXJhbWV0ZXJzLkNvbnRhaW5zS2V5KCJTZXJ2ZXJSb2xlIikgLWVxICR0cnVlKSBgCiAgICAgICAgLWFuZCAoR2V0LVNQRFNDSW5zdGFsbGVkUHJvZHVjdFZlcnNpb24pLkZpbGVNYWpvclBhcnQgLWVxIDE2IGAKICAgICAgICAtYW5kIChHZXQtU1BEU0NJbnN0YWxsZWRQcm9kdWN0VmVyc2lvbikuRmlsZUJ1aWxkUGFydCAtbHQgNDQ1NiBgCiAgICAgICAgLWFuZCAoJFNlcnZlclJvbGUgLWVxICJBcHBsaWNhdGlvbldpdGhTZWFyY2giIGAKICAgICAgICAgICAgIC1vciAkU2VydmVyUm9sZSAtZXEgIldlYkZyb250RW5kV2l0aERpc3RyaWJ1dGVkQ2FjaGUiKSkgCiAgICB7CiAgICAgICAgdGhyb3cgW0V4Y2VwdGlvbl0gKCJTZXJ2ZXJSb2xlIHZhbHVlcyBvZiAnQXBwbGljYXRpb25XaXRoU2VhcmNoJyBvciAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAiJ1dlYkZyb250RW5kV2l0aERpc3RyaWJ1dGVkQ2FjaGUnIHJlcXVpcmUgdGhlIFNoYXJlUG9pbnQgMjAxNiAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAiRmVhdHVyZSBQYWNrIDEgdG8gYmUgaW5zdGFsbGVkLiBTZWUgIiArIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgImh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLWF1L2tiLzMxMjc5NDAiKQogICAgfQoKICAgICRyZXN1bHQgPSBJbnZva2UtU1BEU0NDb21tYW5kIC1DcmVkZW50aWFsICRJbnN0YWxsQWNjb3VudCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRzICRQU0JvdW5kUGFyYW1ldGVycyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgICAgICRwYXJhbXMgPSAkYXJnc1swXQoKICAgICAgICB0cnkgCiAgICAgICAgewogICAgICAgICAgICAkc3BGYXJtID0gR2V0LVNQRmFybQogICAgICAgIH0gCiAgICAgICAgY2F0Y2ggCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJVbmFibGUgdG8gZGV0ZWN0IGxvY2FsIGZhcm0uIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoJG51bGwgLWVxICRzcEZhcm0pIHsgcmV0dXJuICRudWxsIH0KCiAgICAgICAgJGNvbmZpZ0RiID0gR2V0LVNQRGF0YWJhc2UgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7IAogICAgICAgICAgICAkXy5OYW1lIC1lcSAkc3BGYXJtLk5hbWUgLWFuZCAkXy5UeXBlIC1lcSAiQ29uZmlndXJhdGlvbiBEYXRhYmFzZSIgCiAgICAgICAgfQogICAgICAgICRjZW50cmFsQWRtaW5TaXRlID0gR2V0LVNQV2ViQXBwbGljYXRpb24gLUluY2x1ZGVDZW50cmFsQWRtaW5pc3RyYXRpb24gYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7IAogICAgICAgICAgICAkXy5Jc0FkbWluaXN0cmF0aW9uV2ViQXBwbGljYXRpb24gLWVxICR0cnVlIAogICAgICAgIH0KCiAgICAgICAgaWYgKCRwYXJhbXMuRmFybUFjY291bnQuVXNlck5hbWUgLWVxICRzcEZhcm0uRGVmYXVsdFNlcnZpY2VBY2NvdW50Lk5hbWUpIAogICAgICAgIHsKICAgICAgICAgICAgJGZhcm1BY2NvdW50ID0gJHBhcmFtcy5GYXJtQWNjb3VudAogICAgICAgIH0gCiAgICAgICAgZWxzZSAKICAgICAgICB7CiAgICAgICAgICAgICRmYXJtQWNjb3VudCA9ICRzcEZhcm0uRGVmYXVsdFNlcnZpY2VBY2NvdW50Lk5hbWUKICAgICAgICB9CgogICAgICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgICAgIEZhcm1Db25maWdEYXRhYmFzZU5hbWUgPSAkc3BGYXJtLk5hbWUKICAgICAgICAgICAgRGF0YWJhc2VTZXJ2ZXIgPSAkY29uZmlnRGIuU2VydmVyLk5hbWUKICAgICAgICAgICAgRmFybUFjY291bnQgPSAkZmFybUFjY291bnQKICAgICAgICAgICAgSW5zdGFsbEFjY291bnQgPSAkcGFyYW1zLkluc3RhbGxBY2NvdW50CiAgICAgICAgICAgIFBhc3NwaHJhc2UgPSAkcGFyYW1zLlBhc3NwaHJhc2UucGFzc3dvcmQgCiAgICAgICAgICAgIEFkbWluQ29udGVudERhdGFiYXNlTmFtZSA9ICRjZW50cmFsQWRtaW5TaXRlLkNvbnRlbnREYXRhYmFzZXNbMF0uTmFtZQogICAgICAgICAgICBDZW50cmFsQWRtaW5pc3RyYXRpb25Qb3J0ID0gKE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5VcmkgJGNlbnRyYWxBZG1pblNpdGUuVXJsKS5Qb3J0CiAgICAgICAgICAgIENlbnRyYWxBZG1pbmlzdHJhdGlvbkF1dGggPSAkcGFyYW1zLkNlbnRyYWxBZG1pbmlzdHJhdGlvbkF1dGgKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRyZXR1cm5WYWx1ZQogICAgfQogICAgcmV0dXJuICRyZXN1bHQKfQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgCiAgICAgICAgW1N5c3RlbS5TdHJpbmddIAogICAgICAgICRGYXJtQ29uZmlnRGF0YWJhc2VOYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAKICAgICAgICAkRGF0YWJhc2VTZXJ2ZXIsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSAKICAgICAgICAkRmFybUFjY291bnQsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSAKICAgICAgICAkSW5zdGFsbEFjY291bnQsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSAKICAgICAgICAkUGFzc3BocmFzZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gCiAgICAgICAgJEFkbWluQ29udGVudERhdGFiYXNlTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAKICAgICAgICBbU3lzdGVtLlVJbnQzMl0gCiAgICAgICAgJENlbnRyYWxBZG1pbmlzdHJhdGlvblBvcnQsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gCiAgICAgICAgW1N5c3RlbS5TdHJpbmddIAogICAgICAgIFtWYWxpZGF0ZVNldCgiTlRMTSIsIktlcmJlcm9zIildCiAgICAgICAgJENlbnRyYWxBZG1pbmlzdHJhdGlvbkF1dGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gCiAgICAgICAgW1N5c3RlbS5TdHJpbmddIAogICAgICAgIFtWYWxpZGF0ZVNldCgiQXBwbGljYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAiQXBwbGljYXRpb25XaXRoU2VhcmNoIiwKICAgICAgICAgICAgICAgICAgICAgIkN1c3RvbSIsCiAgICAgICAgICAgICAgICAgICAgICJEaXN0cmlidXRlZENhY2hlIiwKICAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCIsCiAgICAgICAgICAgICAgICAgICAgICJTaW5nbGVTZXJ2ZXIiLAogICAgICAgICAgICAgICAgICAgICAiU2luZ2xlU2VydmVyRmFybSIsCiAgICAgICAgICAgICAgICAgICAgICJXZWJGcm9udEVuZCIsCiAgICAgICAgICAgICAgICAgICAgICJXZWJGcm9udEVuZFdpdGhEaXN0cmlidXRlZENhY2hlIildIAogICAgICAgICRTZXJ2ZXJSb2xlCiAgICApCiAgICAKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCJXQVJOSU5HISBTUENyZWF0ZUZhcm0gaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluICIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2hhcmVQb2ludERzYyB2Mi4wLiBTd2FwIHRvIHVzZSB0aGUgbmV3IFNQRmFybSByZXNvdXJjZSBhcyAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFuIGFsdGVybmF0aXZlLiBTZWUgaHR0cDovL2FrYS5tcy9TUERzYy1TUEZhcm0gZm9yIGRldGFpbHMuIikKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTZXR0aW5nIGxvY2FsIFNQIEZhcm0gc2V0dGluZ3MiCgogICAgaWYgKCgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIlNlcnZlclJvbGUiKSAtZXEgJHRydWUpIGAKICAgICAgICAtYW5kIChHZXQtU1BEU0NJbnN0YWxsZWRQcm9kdWN0VmVyc2lvbikuRmlsZU1ham9yUGFydCAtbmUgMTYpIAogICAgewogICAgICAgIHRocm93IFtFeGNlcHRpb25dICJTZXJ2ZXIgcm9sZSBpcyBvbmx5IHN1cHBvcnRlZCBpbiBTaGFyZVBvaW50IDIwMTYuIgogICAgfQoKICAgIGlmICgoJFBTQm91bmRQYXJhbWV0ZXJzLkNvbnRhaW5zS2V5KCJTZXJ2ZXJSb2xlIikgLWVxICR0cnVlKSBgCiAgICAgICAgLWFuZCAoR2V0LVNQRFNDSW5zdGFsbGVkUHJvZHVjdFZlcnNpb24pLkZpbGVNYWpvclBhcnQgLWVxIDE2IGAKICAgICAgICAtYW5kIChHZXQtU1BEU0NJbnN0YWxsZWRQcm9kdWN0VmVyc2lvbikuRmlsZUJ1aWxkUGFydCAtbHQgNDQ1NiBgCiAgICAgICAgLWFuZCAoJFNlcnZlclJvbGUgLWVxICJBcHBsaWNhdGlvbldpdGhTZWFyY2giIGAKICAgICAgICAgICAgIC1vciAkU2VydmVyUm9sZSAtZXEgIldlYkZyb250RW5kV2l0aERpc3RyaWJ1dGVkQ2FjaGUiKSkgCiAgICB7CiAgICAgICAgdGhyb3cgW0V4Y2VwdGlvbl0gKCJTZXJ2ZXJSb2xlIHZhbHVlcyBvZiAnQXBwbGljYXRpb25XaXRoU2VhcmNoJyBvciAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAiJ1dlYkZyb250RW5kV2l0aERpc3RyaWJ1dGVkQ2FjaGUnIHJlcXVpcmUgdGhlIFNoYXJlUG9pbnQgMjAxNiAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAiRmVhdHVyZSBQYWNrIDEgdG8gYmUgaW5zdGFsbGVkLiBTZWUgIiArIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgImh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLWF1L2tiLzMxMjc5NDAiKQogICAgfQoKICAgICRDdXJyZW50VmFsdWVzID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVycwogICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRDdXJyZW50VmFsdWVzLkZhcm1Db25maWdEYXRhYmFzZU5hbWUpIC1lcSAkZmFsc2UpIAogICAgewogICAgICAgIHRocm93ICgiVGhpcyBzZXJ2ZXIgaXMgYWxyZWFkeSBjb25uZWN0ZWQgdG8gYSBmYXJtICIgKyBgCiAgICAgICAgICAgICAgICIoJCgkQ3VycmVudFZhbHVlcy5GYXJtQ29uZmlnRGF0YWJhc2VOYW1lKSkuIFBsZWFzZSBtYW51YWxseSByZW1vdmUgaXQgIiArIGAKICAgICAgICAgICAgICAgInRvIGFwcGx5IHRoaXMgY2hhbmdlLiIpCiAgICB9CgogICAgaWYgKC1ub3QgJFBTQm91bmRQYXJhbWV0ZXJzLkNvbnRhaW5zS2V5KCJDZW50cmFsQWRtaW5pc3RyYXRpb25Qb3J0IikpIAogICAgeyAKICAgICAgICAkUFNCb3VuZFBhcmFtZXRlcnMuQWRkKCJDZW50cmFsQWRtaW5pc3RyYXRpb25Qb3J0IiwgOTk5OSkgCiAgICB9CiAgICBpZiAoLW5vdCAkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIkNlbnRyYWxBZG1pbmlzdHJhdGlvbkF1dGgiKSkgCiAgICB7IAogICAgICAgICRQU0JvdW5kUGFyYW1ldGVycy5BZGQoIkNlbnRyYWxBZG1pbmlzdHJhdGlvbkF1dGgiLCAiTlRMTSIpIAogICAgfQogICAgCiAgICBJbnZva2UtU1BEU0NDb21tYW5kIC1DcmVkZW50aWFsICRJbnN0YWxsQWNjb3VudCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRzICRQU0JvdW5kUGFyYW1ldGVycyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgICAgICRwYXJhbXMgPSAkYXJnc1swXQoKICAgICAgICAkbmV3RmFybUFyZ3MgPSBAewogICAgICAgICAgICBEYXRhYmFzZVNlcnZlciA9ICRwYXJhbXMuRGF0YWJhc2VTZXJ2ZXIKICAgICAgICAgICAgRGF0YWJhc2VOYW1lID0gJHBhcmFtcy5GYXJtQ29uZmlnRGF0YWJhc2VOYW1lCiAgICAgICAgICAgIEZhcm1DcmVkZW50aWFscyA9ICRwYXJhbXMuRmFybUFjY291bnQKICAgICAgICAgICAgQWRtaW5pc3RyYXRpb25Db250ZW50RGF0YWJhc2VOYW1lID0gJHBhcmFtcy5BZG1pbkNvbnRlbnREYXRhYmFzZU5hbWUKICAgICAgICAgICAgUGFzc3BocmFzZSA9ICgkcGFyYW1zLlBhc3NwaHJhc2UpLlBhc3N3b3JkCiAgICAgICAgICAgIFNraXBSZWdpc3RlckFzRGlzdHJpYnV0ZWRDYWNoZUhvc3QgPSAkdHJ1ZQogICAgICAgIH0KICAgICAgICAKICAgICAgICBzd2l0Y2goKEdldC1TUERTQ0luc3RhbGxlZFByb2R1Y3RWZXJzaW9uKS5GaWxlTWFqb3JQYXJ0KSAKICAgICAgICB7CiAgICAgICAgICAgIDE1IHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkRldGVjdGVkIFZlcnNpb246IFNoYXJlUG9pbnQgMjAxMyIKICAgICAgICAgICAgfQogICAgICAgICAgICAxNiB7CiAgICAgICAgICAgICAgICBpZiAoJHBhcmFtcy5Db250YWluc0tleSgiU2VydmVyUm9sZSIpIC1lcSAkdHJ1ZSkgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIkRldGVjdGVkIFZlcnNpb246IFNoYXJlUG9pbnQgMjAxNiAtICIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbmZpZ3VyaW5nIHNlcnZlciBhcyAkKCRwYXJhbXMuU2VydmVyUm9sZSkiKQogICAgICAgICAgICAgICAgICAgICRuZXdGYXJtQXJncy5BZGQoIkxvY2FsU2VydmVyUm9sZSIsICRwYXJhbXMuU2VydmVyUm9sZSkKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCJEZXRlY3RlZCBWZXJzaW9uOiBTaGFyZVBvaW50IDIwMTYgLSBubyAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzZXJ2ZXIgcm9sZSBwcm92aWRlZCwgY29uZmlndXJpbmcgc2VydmVyICIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpdGhvdXQgYSBzcGVjaWZpYyByb2xlIikKICAgICAgICAgICAgICAgICAgICAkbmV3RmFybUFyZ3MuQWRkKCJTZXJ2ZXJSb2xlT3B0aW9uYWwiLCAkdHJ1ZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBEZWZhdWx0IHsKICAgICAgICAgICAgICAgIHRocm93IFtFeGNlcHRpb25dICgiQW4gdW5rbm93biB2ZXJzaW9uIG9mIFNoYXJlUG9pbnQgKE1ham9yIHZlcnNpb24gJF8pIHdhcyAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXRlY3RlZC4gT25seSB2ZXJzaW9ucyAxNSAoU2hhcmVQb2ludCAyMDEzKSBvciAxNiAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIoU2hhcmVQb2ludCAyMDE2KSBhcmUgc3VwcG9ydGVkLiIpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIE5ldy1TUENvbmZpZ3VyYXRpb25EYXRhYmFzZSBAbmV3RmFybUFyZ3MKICAgICAgICBJbnN0YWxsLVNQSGVscENvbGxlY3Rpb24gLUFsbAogICAgICAgIEluaXRpYWxpemUtU1BSZXNvdXJjZVNlY3VyaXR5CiAgICAgICAgSW5zdGFsbC1TUFNlcnZpY2UKICAgICAgICBJbnN0YWxsLVNQRmVhdHVyZSAtQWxsRXhpc3RpbmdGZWF0dXJlcyAtRm9yY2UgCiAgICAgICAgTmV3LVNQQ2VudHJhbEFkbWluaXN0cmF0aW9uIC1Qb3J0ICRwYXJhbXMuQ2VudHJhbEFkbWluaXN0cmF0aW9uUG9ydCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1XaW5kb3dzQXV0aFByb3ZpZGVyICRwYXJhbXMuQ2VudHJhbEFkbWluaXN0cmF0aW9uQXV0aAogICAgICAgIEluc3RhbGwtU1BBcHBsaWNhdGlvbkNvbnRlbnQKICAgIH0gfCBPdXQtTnVsbAp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gCiAgICAgICAgJEZhcm1Db25maWdEYXRhYmFzZU5hbWUsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgCiAgICAgICAgW1N5c3RlbS5TdHJpbmddIAogICAgICAgICREYXRhYmFzZVNlcnZlciwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAKICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIAogICAgICAgICRGYXJtQWNjb3VudCwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAKICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIAogICAgICAgICRJbnN0YWxsQWNjb3VudCwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAKICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdIAogICAgICAgICRQYXNzcGhyYXNlLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAKICAgICAgICAkQWRtaW5Db250ZW50RGF0YWJhc2VOYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIAogICAgICAgIFtTeXN0ZW0uVUludDMyXSAKICAgICAgICAkQ2VudHJhbEFkbWluaXN0cmF0aW9uUG9ydCwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJOVExNIiwiS2VyYmVyb3MiKV0KICAgICAgICAkQ2VudHJhbEFkbWluaXN0cmF0aW9uQXV0aCwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJBcHBsaWNhdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICJBcHBsaWNhdGlvbldpdGhTZWFyY2giLAogICAgICAgICAgICAgICAgICAgICAiQ3VzdG9tIiwKICAgICAgICAgICAgICAgICAgICAgIkRpc3RyaWJ1dGVkQ2FjaGUiLAogICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIiwKICAgICAgICAgICAgICAgICAgICAgIlNpbmdsZVNlcnZlciIsCiAgICAgICAgICAgICAgICAgICAgICJTaW5nbGVTZXJ2ZXJGYXJtIiwKICAgICAgICAgICAgICAgICAgICAgIldlYkZyb250RW5kIiwKICAgICAgICAgICAgICAgICAgICAgIldlYkZyb250RW5kV2l0aERpc3RyaWJ1dGVkQ2FjaGUiKV0gCiAgICAgICAgJFNlcnZlclJvbGUKICAgICkKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJUZXN0aW5nIGxvY2FsIFNQIEZhcm0gc2V0dGluZ3MiCgogICAgaWYgKCgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIlNlcnZlclJvbGUiKSAtZXEgJHRydWUpIGAKICAgICAgICAtYW5kIChHZXQtU1BEU0NJbnN0YWxsZWRQcm9kdWN0VmVyc2lvbikuRmlsZU1ham9yUGFydCAtbmUgMTYpIAogICAgewogICAgICAgIHRocm93IFtFeGNlcHRpb25dICJTZXJ2ZXIgcm9sZSBpcyBvbmx5IHN1cHBvcnRlZCBpbiBTaGFyZVBvaW50IDIwMTYuIgogICAgfQoKICAgICRDdXJyZW50VmFsdWVzID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVycwoKICAgIGlmICgkbnVsbCAtZXEgJEN1cnJlbnRWYWx1ZXMpCiAgICB7CiAgICAgICAgcmV0dXJuICRmYWxzZQogICAgfQoKICAgIHJldHVybiBUZXN0LVNQRHNjUGFyYW1ldGVyU3RhdGUgLUN1cnJlbnRWYWx1ZXMgJEN1cnJlbnRWYWx1ZXMgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRGVzaXJlZFZhbHVlcyAkUFNCb3VuZFBhcmFtZXRlcnMgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVmFsdWVzVG9DaGVjayBAKCJGYXJtQ29uZmlnRGF0YWJhc2VOYW1lIikKfQoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKi1UYXJnZXRSZXNvdXJjZQo=
