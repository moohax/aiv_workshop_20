build.psake.ps1,390d6f3a88f463ff988421ede27a209c,Scan result is 1. IsMalware: 0,I1JlcXVpcmVzIC1Nb2R1bGVzIHBzYWtlCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBETyBOT1QgTU9ESUZZIFRISVMgRklMRSEgIE1vZGlmeSBidWlsZC5zZXR0aW5ncy5wczEgaW5zdGVhZC4KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBUaGlzIGlzIHRoZSBQb3dlclNoZWxsIE1vZHVsZSBwc2FrZSBidWlsZCBzY3JpcHQuIEl0IGRlZmluZXMgdGhlIGZvbGxvd2luZyB0YXNrczoKIwojIENsZWFuLCBCdWlsZCwgU2lnbiwgQnVpbGRIZWxwLCBJbnN0YWxsLCBUZXN0IGFuZCBQdWJsaXNoLgojCiMgVGhlIGRlZmF1bHQgdGFzayBpcyBCdWlsZC4gIFRoaXMgdGFzayBjb3BpZXMgdGhlIGFwcHJvcHJpYXRlIGZpbGVzIGZyb20gdGhlCiMgJFNyY1Jvb3REaXIgdW5kZXIgdGhlICRPdXREaXIuICBMYXRlciwgb3RoZXIgdGFza3Mgc3VjaCBhcyBTaWduIGFuZCBCdWlsZEhlbHAKIyB3aWxsIGZ1cnRoZXIgbW9kaWZ5IHRoZSBjb250ZW50cyBvZiAkT3V0RGlyIGFuZCBhZGQgbmV3IGZpbGVzLgojCiMgVGhlIFNpZ24gdGFzayB3aWxsIG9ubHkgc2lnbiBzY3JpcHRzIGlmIHRoZSAkU2lnblNjcmlwdHMgdmFyaWFibGUgaXMgc2V0IHRvCiMgJHRydWUuICBBIGNvZGUtc2lnbmluZyBjZXJ0aWZpY2F0ZSBpcyByZXF1aXJlZCBmb3IgdGhpcyB0YXNrIHRvIGNvbXBsZXRlLgojCiMgVGhlIEJ1aWxkSGVscCB0YXNrIGludm9rZXMgcGxhdHlQUyB0byBnZW5lcmF0ZSBtYXJrZG93biBmaWxlcyBmcm9tCiMgY29tbWVudC1iYXNlZCBoZWxwIGZvciB5b3VyIGV4cG9ydGVkIGNvbW1hbmRzLiAgcGxhdHlQUyB0aGVuIGdlbmVyYXRlcwojIGEgaGVscCBmaWxlIGZvciB5b3VyIG1vZHVsZSBmcm9tIHRoZSBtYXJrZG93biBmaWxlcy4KIwojIFRoZSBJbnN0YWxsIHRhc2sgc2ltcGxpZXMgY29waWVzIHRoZSBtb2R1bGUgZm9sZGVyIHVuZGVyICRPdXREaXIgdG8geW91cgojIHByb2ZpbGUncyBNb2R1bGVzIGZvbGRlci4KIwojIFRoZSBUZXN0IHRhc2sgaW52b2tlcyBQZXN0ZXIgb24gdGhlICRUZXN0Um9vdERpci4KIwojIFRoZSBQdWJsaXNoIHRhc2sgdXNlcyB0aGUgUHVibGlzaC1Nb2R1bGUgY29tbWFuZCB0byBwdWJsaXNoCiMgdG8gZWl0aGVyIHRoZSBQb3dlclNoZWxsIEdhbGxlcnkgKHRoZSBkZWZhdWx0KSBvciB5b3UgY2FuIGNoYW5nZQojIHRoZSAkUHVibGlzaFJlcG9zaXRvcnkgcHJvcGVydHkgdG8gdGhlIG5hbWUgb2YgYW4gYWx0ZXJuYXRlIHJlcG9zaXRvcnkuCiMgTm90ZTogdGhlIFB1Ymxpc2ggdGFzayByZXF1aXJlcyB0aGF0IHRoZSBUZXN0IHRhc2sgZXhlY3V0ZSB3aXRob3V0IGZhaWx1cmVzLgojCiMgWW91IGNhbiBleGV1dGUgYSBzcGVjaWZpYyB0YXNrLCBzdWNoIGFzIHRoZSBUZXN0IHRhc2sgYnkgcnVubmluZyB0aGUKIyBmb2xsb3dpbmcgY29tbWFuZDoKIwojIFBTIEM6XD4gaW52b2tlLXBzYWtlIGJ1aWxkLnBzYWtlLnBzMSAtdGFza0xpc3QgVGVzdAojCiMgWW91IGNhbiBleGVjdXRlIHRoZSBQdWJsaXNoIHRhc2sgd2l0aCB0aGUgZm9sbG93aW5nIGNvbW1hbmQuCiMgVGhlIGZpcnN0IHRpbWUgeW91IGV4ZWN1dGUgdGhlIFB1Ymxpc2ggdGFzaywgeW91IHdpbGwgYmUgcHJvbXB0ZWQgdG8gZW50ZXIKIyB5b3VyIFBvd2VyU2hlbGwgR2FsbGVyeSBOdUdldEFwaUtleS4gIEFmdGVyIGVudGVyaW5nIHRoZSBrZXksIGl0IGlzIGVuY3J5cHRlZAojIGFuZCBzdG9yZWQgc28geW91IHdpbGwgbm90IGhhdmUgdG8gZW50ZXIgaXQgYWdhaW4uCiMKIyBQUyBDOlw+IGludm9rZS1wc2FrZSBidWlsZC5wc2FrZS5wczEgLXRhc2tMaXN0IFB1Ymxpc2gKIwojIFlvdSBjYW4gdmVyaWZ5IHRoZSBzdG9yZWQgYW5kIGVuY3J5cHRlZCBOdUdldEFwaUtleSBieSBydW5uaW5nIHRoZSBmb2xsb3dpbmcKIyBjb21tYW5kIHdoaWNoIHdpbGwgZGlzcGxheSBhIHBvcnRpb24gb2YgeW91ciBOdUdldEFwaUtleSBpbiBwbGFpbiB0ZXh0LgojCiMgUFMgQzpcPiBpbnZva2UtcHNha2UgYnVpbGQucHNha2UucHMxIC10YXNrTGlzdCBTaG93QXBpS2V5CiMKIyBZb3UgY2FuIHN0b3JlIGEgbmV3IE51R2V0QXBpS2V5IHdpdGggdGhpcyBjb21tYW5kLiBZb3UgY2FuIGxlYXZlIG9mZgojIHRoZSAtcHJvcGVydGllcyBwYXJhbWV0ZXIgYW5kIHlvdSdsbCBiZSBwcm9tcHRlZCBmb3IgdGhlIGtleS4KIwojIFBTIEM6XD4gaW52b2tlLXBzYWtlIGJ1aWxkLnBzYWtlLnBzMSAtdGFza0xpc3QgU3RvcmVBcGlLZXkgLXByb3BlcnRpZXMgQHtOdUdldEFwaUtleT0ndGVzdDEyMyd9CiMKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBEb3Qgc291cmNlIHRoZSB1c2VyJ3MgY3VzdG9taXplZCBwcm9wZXJ0aWVzIGFuZCBleHRlbnNpb24gdGFza3MuCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKLiAkUFNTY3JpcHRSb290XGJ1aWxkLnNldHRpbmdzLnBzMQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFByaXZhdGUgcHJvcGVydGllcy4KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpQcm9wZXJ0aWVzIHsKICAgIFtTeXN0ZW0uRGlhZ25vc3RpY3MuQ29kZUFuYWx5c2lzLlN1cHByZXNzTWVzc2FnZSgnUFNVc2VEZWNsYXJlZFZhcnNNb3JlVGhhbkFzc2lnbWVudHMnLCAnJyldCiAgICAkTW9kdWxlT3V0RGlyID0gIiRPdXREaXJcJE1vZHVsZU5hbWUiCgogICAgW1N5c3RlbS5EaWFnbm9zdGljcy5Db2RlQW5hbHlzaXMuU3VwcHJlc3NNZXNzYWdlKCdQU1VzZURlY2xhcmVkVmFyc01vcmVUaGFuQXNzaWdtZW50cycsICcnKV0KICAgICRVcGRhdGFibGVIZWxwT3V0RGlyID0gIiRPdXREaXJcVXBkYXRhYmxlSGVscCIKCiAgICBbU3lzdGVtLkRpYWdub3N0aWNzLkNvZGVBbmFseXNpcy5TdXBwcmVzc01lc3NhZ2UoJ1BTVXNlRGVjbGFyZWRWYXJzTW9yZVRoYW5Bc3NpZ21lbnRzJywgJycpXQogICAgJFNoYXJlZFByb3BlcnRpZXMgPSBAe30KCiAgICBbU3lzdGVtLkRpYWdub3N0aWNzLkNvZGVBbmFseXNpcy5TdXBwcmVzc01lc3NhZ2UoJ1BTVXNlRGVjbGFyZWRWYXJzTW9yZVRoYW5Bc3NpZ21lbnRzJywgJycpXQogICAgJExpbmVTZXAgPSAiLSIgKiA3OAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQ29yZSB0YXNrIGltcGxlbWVudGF0aW9ucy4gQXZvaWQgbW9kaWZ5aW5nIHRoZXNlIHRhc2tzLgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjClRhc2sgZGVmYXVsdCAtZGVwZW5kcyBCdWlsZAoKVGFzayBJbml0IC1yZXF1aXJlZFZhcmlhYmxlcyBPdXREaXIgewogICAgaWYgKCEoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkT3V0RGlyKSkgewogICAgICAgIE5ldy1JdGVtICRPdXREaXIgLUl0ZW1UeXBlIERpcmVjdG9yeSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UgPiAkbnVsbAogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiJCgkcHNha2UuY29udGV4dC5jdXJyZW50VGFza05hbWUpIC0gZGlyZWN0b3J5IGFscmVhZHkgZXhpc3RzICckT3V0RGlyJy4iCiAgICB9Cn0KClRhc2sgQ2xlYW4gLWRlcGVuZHMgSW5pdCAtcmVxdWlyZWRWYXJpYWJsZXMgT3V0RGlyIHsKICAgICMgTWF5YmUgYSBiaXQgcGFyYW5vaWQgYnV0IHRoaXMgdGFzayBudWtlZCBcIG9uIG15IGxhcHRvcC4gR29vZCB0aGluZyBJIHdhcyBub3QgcnVubmluZyBhcyBhZG1pbi4KICAgIGlmICgkT3V0RGlyLkxlbmd0aCAtZ3QgMykgewogICAgICAgIEdldC1DaGlsZEl0ZW0gJE91dERpciB8IFJlbW92ZS1JdGVtIC1SZWN1cnNlIC1Gb3JjZSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UKICAgIH0KICAgIGVsc2UgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJHBzYWtlLmNvbnRleHQuY3VycmVudFRhc2tOYW1lKSAtIGAkT3V0RGlyICckT3V0RGlyJyBtdXN0IGJlIGxvbmdlciB0aGFuIDMgY2hhcmFjdGVycy4iCiAgICB9Cn0KClRhc2sgU3RhZ2VGaWxlcyAtZGVwZW5kcyBJbml0LCBDbGVhbiwgQmVmb3JlU3RhZ2VGaWxlcywgQ29yZVN0YWdlRmlsZXMsIElubGluZU1vZHVsZXMsIEFmdGVyU3RhZ2VGaWxlcyB7Cn0KClRhc2sgQ29yZVN0YWdlRmlsZXMgLXJlcXVpcmVkVmFyaWFibGVzIE1vZHVsZU91dERpciwgU3JjUm9vdERpciB7CiAgICBpZiAoIShUZXN0LVBhdGggLUxpdGVyYWxQYXRoICRNb2R1bGVPdXREaXIpKSB7CiAgICAgICAgTmV3LUl0ZW0gJE1vZHVsZU91dERpciAtSXRlbVR5cGUgRGlyZWN0b3J5IC1WZXJib3NlOiRWZXJib3NlUHJlZmVyZW5jZSA+ICRudWxsCiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1WZXJib3NlICIkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgLSBkaXJlY3RvcnkgYWxyZWFkeSBleGlzdHMgJyRNb2R1bGVPdXREaXInLiIKICAgIH0KCiAgICBDb3B5LUl0ZW0gLVBhdGggJFNyY1Jvb3REaXJcKiAtRGVzdGluYXRpb24gJE1vZHVsZU91dERpciAtUmVjdXJzZSAtRXhjbHVkZSAkRXhjbHVkZSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UKfQoKVGFzayBJbmxpbmVNb2R1bGVzIC1yZXF1aXJlZFZhcmlhYmxlcyBNb2R1bGVPdXREaXIsIE1vZHVsZU5hbWUgewogICAgJHBzbTFQYXRoID0gIiRNb2R1bGVPdXREaXIvJE1vZHVsZU5hbWUucHNtMSIKICAgICRwc20xQ29udGVudCA9IEdldC1Db250ZW50ICRwc20xUGF0aAogICAgJHVzaW5nID0gQCgpCiAgICBTZWxlY3QtU3RyaW5nIC1MaXRlcmFsUGF0aCAkcHNtMVBhdGggLVBhdHRlcm4gJ3VzaW5nIG1vZHVsZSAuXFwoW1x3XC5dKyknIHwgRm9yZWFjaC1PYmplY3QgewogICAgICAgICRsaW5lID0gJF8uTGluZU51bWJlciAtIDEKICAgICAgICAkZmlsZU5hbWUgPSAkXy5NYXRjaGVzWzBdLkdyb3Vwc1sxXS5WYWx1ZQogICAgICAgICR1LCAkYyA9IChHZXQtQ29udGVudCAtTGl0ZXJhbFBhdGggJE1vZHVsZU91dERpci8kZmlsZU5hbWUpLldoZXJlKCB7JF8gLW1hdGNoICdedXNpbmcgbmFtZXNwYWNlJ30sICdTcGxpdCcpCiAgICAgICAgJHBzbTFDb250ZW50WyRsaW5lXSA9ICRjLldoZXJlKCB7LW5vdCAkXy5TdGFydHNXaXRoKCd1c2luZyBtb2R1bGUnLCBbU3RyaW5nQ29tcGFyaXNvbl06Ok9yZGluYWxJZ25vcmVDYXNlKX0pIC1qb2luIFtFbnZpcm9ubWVudF06Ok5ld0xpbmUKICAgICAgICAkdXNpbmcgKz0gJHUKICAgICAgICBSZW1vdmUtSXRlbSAkTW9kdWxlT3V0RGlyLyRmaWxlTmFtZQogICAgfQogICAgJHBzbTFDb250ZW50ID0gKCR1c2luZyB8IFNvcnQtT2JqZWN0IC1VbmlxdWUpICsgJHBzbTFDb250ZW50CiAgICBTZXQtQ29udGVudCAtTGl0ZXJhbFBhdGggJHBzbTFQYXRoIC1WYWx1ZSAkcHNtMUNvbnRlbnQKfQoKVGFzayBCdWlsZCAtZGVwZW5kcyBJbml0LCBDbGVhbiwgQmVmb3JlQnVpbGQsIFN0YWdlRmlsZXMsIEFuYWx5emUsIFNpZ24sIEFmdGVyQnVpbGQgewp9CgpUYXNrIEFuYWx5emUgLWRlcGVuZHMgU3RhZ2VGaWxlcyBgCiAgICAgICAgICAgICAtcmVxdWlyZWRWYXJpYWJsZXMgTW9kdWxlT3V0RGlyLCBTY3JpcHRBbmFseXNpc0VuYWJsZWQsIFNjcmlwdEFuYWx5c2lzRmFpbEJ1aWxkT25TZXZlcml0eUxldmVsLCBTY3JpcHRBbmFseXplclNldHRpbmdzUGF0aCB7CiAgICBpZiAoISRTY3JpcHRBbmFseXNpc0VuYWJsZWQpIHsKICAgICAgICAiU2NyaXB0IGFuYWx5c2lzIGlzIG5vdCBlbmFibGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgaWYgKCEoR2V0LU1vZHVsZSBQU1NjcmlwdEFuYWx5emVyIC1MaXN0QXZhaWxhYmxlKSkgewogICAgICAgICJQU1NjcmlwdEFuYWx5emVyIG1vZHVsZSBpcyBub3QgaW5zdGFsbGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgIlNjcmlwdEFuYWx5c2lzRmFpbEJ1aWxkT25TZXZlcml0eUxldmVsIHNldCB0bzogJFNjcmlwdEFuYWx5c2lzRmFpbEJ1aWxkT25TZXZlcml0eUxldmVsIgoKICAgICRhbmFseXNpc1Jlc3VsdCA9IEludm9rZS1TY3JpcHRBbmFseXplciAtUGF0aCAkTW9kdWxlT3V0RGlyIC1TZXR0aW5ncyAkU2NyaXB0QW5hbHl6ZXJTZXR0aW5nc1BhdGggLVJlY3Vyc2UgLVZlcmJvc2U6JFZlcmJvc2VQcmVmZXJlbmNlCiAgICAkYW5hbHlzaXNSZXN1bHQgfCBGb3JtYXQtVGFibGUKICAgIHN3aXRjaCAoJFNjcmlwdEFuYWx5c2lzRmFpbEJ1aWxkT25TZXZlcml0eUxldmVsKSB7CiAgICAgICAgJ05vbmUnIHsKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgICdFcnJvcicgewogICAgICAgICAgICBBc3NlcnQgLWNvbmRpdGlvblRvQ2hlY2sgKAogICAgICAgICAgICAgICAgKCRhbmFseXNpc1Jlc3VsdCB8IFdoZXJlLU9iamVjdCBTZXZlcml0eSAtZXEgJ0Vycm9yJykuQ291bnQgLWVxIDAKICAgICAgICAgICAgKSAtZmFpbHVyZU1lc3NhZ2UgJ09uZSBvciBtb3JlIFNjcmlwdEFuYWx5emVyIGVycm9ycyB3ZXJlIGZvdW5kLiBCdWlsZCBjYW5ub3QgY29udGludWUhJwogICAgICAgIH0KICAgICAgICAnV2FybmluZycgewogICAgICAgICAgICBBc3NlcnQgLWNvbmRpdGlvblRvQ2hlY2sgKAogICAgICAgICAgICAgICAgKCRhbmFseXNpc1Jlc3VsdCB8IFdoZXJlLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRfLlNldmVyaXR5IC1lcSAnV2FybmluZycgLW9yICRfLlNldmVyaXR5IC1lcSAnRXJyb3InCiAgICAgICAgICAgICAgICAgICAgfSkuQ291bnQgLWVxIDApIC1mYWlsdXJlTWVzc2FnZSAnT25lIG9yIG1vcmUgU2NyaXB0QW5hbHl6ZXIgd2FybmluZ3Mgd2VyZSBmb3VuZC4gQnVpbGQgY2Fubm90IGNvbnRpbnVlIScKICAgICAgICB9CiAgICAgICAgZGVmYXVsdCB7CiAgICAgICAgICAgIEFzc2VydCAtY29uZGl0aW9uVG9DaGVjayAoCiAgICAgICAgICAgICAgICAkYW5hbHlzaXNSZXN1bHQuQ291bnQgLWVxIDAKICAgICAgICAgICAgKSAtZmFpbHVyZU1lc3NhZ2UgJ09uZSBvciBtb3JlIFNjcmlwdEFuYWx5emVyIGlzc3VlcyB3ZXJlIGZvdW5kLiBCdWlsZCBjYW5ub3QgY29udGludWUhJwogICAgICAgIH0KICAgIH0KfQoKVGFzayBTaWduIC1kZXBlbmRzIFN0YWdlRmlsZXMgLXJlcXVpcmVkVmFyaWFibGVzIENlcnRQYXRoLCBTZXR0aW5nc1BhdGgsIFNjcmlwdFNpZ25pbmdFbmFibGVkIHsKICAgIGlmICghJFNjcmlwdFNpZ25pbmdFbmFibGVkKSB7CiAgICAgICAgIlNjcmlwdCBzaWduaW5nIGlzIG5vdCBlbmFibGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgJHZhbGlkQ29kZVNpZ25pbmdDZXJ0cyA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJENlcnRQYXRoIC1Db2RlU2lnbmluZ0NlcnQgLVJlY3Vyc2UgfCBXaGVyZS1PYmplY3QgTm90QWZ0ZXIgLWdlIChHZXQtRGF0ZSkKICAgIGlmICghJHZhbGlkQ29kZVNpZ25pbmdDZXJ0cykgewogICAgICAgIHRocm93ICJUaGVyZSBhcmUgbm8gbm9uLWV4cGlyZWQgY29kZS1zaWduaW5nIGNlcnRpZmljYXRlcyBpbiAkQ2VydFBhdGguIFlvdSBjYW4gZWl0aGVyIGluc3RhbGwgIiArIAogICAgICAgICJhIGNvZGUtc2lnbmluZyBjZXJ0aWZpY2F0ZSBpbnRvIHRoZSBjZXJ0aWZpY2F0ZSBzdG9yZSBvciBkaXNhYmxlIHNjcmlwdCBhbmFseXNpcyBpbiBidWlsZC5zZXR0aW5ncy5wczEuIgogICAgfQoKICAgICRjZXJ0U3ViamVjdE5hbWVLZXkgPSAiQ2VydFN1YmplY3ROYW1lIgogICAgJHN0b3JlQ2VydFN1YmplY3ROYW1lID0gJHRydWUKCiAgICAjIEdldCB0aGUgc3ViamVjdCBuYW1lIG9mIHRoZSBjb2RlLXNpZ25pbmcgY2VydGlmaWNhdGUgdG8gYmUgdXNlZCBmb3Igc2NyaXB0IHNpZ25pbmcuCiAgICBpZiAoISRDZXJ0U3ViamVjdE5hbWUgLWFuZCAoJENlcnRTdWJqZWN0TmFtZSA9IEdldFNldHRpbmcgLUtleSAkY2VydFN1YmplY3ROYW1lS2V5IC1QYXRoICRTZXR0aW5nc1BhdGgpKSB7CiAgICAgICAgJHN0b3JlQ2VydFN1YmplY3ROYW1lID0gJGZhbHNlCiAgICB9CiAgICBlbHNlaWYgKCEkQ2VydFN1YmplY3ROYW1lKSB7CiAgICAgICAgIkEgY29kZS1zaWduaW5nIGNlcnRpZmljYXRlIGhhcyBub3QgYmVlbiBzcGVjaWZpZWQuIgogICAgICAgICJUaGUgZm9sbG93aW5nIG5vbi1leHBpcmVkLCBjb2RlLXNpZ25pbmcgY2VydGlmaWNhdGVzIGFyZSBhdmFpbGFibGUgaW4geW91ciBjZXJ0aWZpY2F0ZSBzdG9yZToiCiAgICAgICAgJHZhbGlkQ29kZVNpZ25pbmdDZXJ0cyB8IEZvcm1hdC1MaXN0IFN1YmplY3QsIElzc3VlciwgVGh1bWJwcmludCwgTm90QmVmb3JlLCBOb3RBZnRlcgoKICAgICAgICAkQ2VydFN1YmplY3ROYW1lID0gUmVhZC1Ib3N0IC1Qcm9tcHQgJ0VudGVyIHRoZSBzdWJqZWN0IG5hbWUgKGNhc2Utc2Vuc2l0aXZlKSBvZiB0aGUgY2VydGlmaWNhdGUgdG8gdXNlIGZvciBzY3JpcHQgc2lnbmluZycKICAgIH0KCiAgICAjIEZpbmQgYSBjb2RlLXNpZ25pbmcgY2VydGlmaWNhdGUgdGhhdCBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgc3ViamVjdCBuYW1lLgogICAgJGNlcnRpZmljYXRlID0gJHZhbGlkQ29kZVNpZ25pbmdDZXJ0cyB8CiAgICAgICAgV2hlcmUtT2JqZWN0IHsgJF8uU3ViamVjdE5hbWUuTmFtZSAtY21hdGNoIFtyZWdleF06OkVzY2FwZSgkQ2VydFN1YmplY3ROYW1lKSB9IHwKICAgICAgICBTb3J0LU9iamVjdCBOb3RBZnRlciAtRGVzY2VuZGluZyB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDEKCiAgICBpZiAoJGNlcnRpZmljYXRlKSB7CiAgICAgICAgJFNoYXJlZFByb3BlcnRpZXMuQ29kZVNpZ25pbmdDZXJ0aWZpY2F0ZSA9ICRjZXJ0aWZpY2F0ZQoKICAgICAgICBpZiAoJHN0b3JlQ2VydFN1YmplY3ROYW1lKSB7CiAgICAgICAgICAgIFNldFNldHRpbmcgLUtleSAkY2VydFN1YmplY3ROYW1lS2V5IC1WYWx1ZSAkY2VydGlmaWNhdGUuU3ViamVjdE5hbWUuTmFtZSAtUGF0aCAkU2V0dGluZ3NQYXRoCiAgICAgICAgICAgICJUaGUgbmV3IGNlcnRpZmljYXRlIHN1YmplY3QgbmFtZSBoYXMgYmVlbiBzdG9yZWQgaW4gJHtTZXR0aW5nc1BhdGh9LiIKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICJVc2luZyBzdG9yZWQgY2VydGlmaWNhdGUgc3ViamVjdCBuYW1lICRDZXJ0U3ViamVjdE5hbWUgZnJvbSAke1NldHRpbmdzUGF0aH0uIgogICAgICAgIH0KCiAgICAgICAgJExpbmVTZXAKICAgICAgICAiVXNpbmcgY29kZS1zaWduaW5nIGNlcnRpZmljYXRlOiAkY2VydGlmaWNhdGUiCiAgICAgICAgJExpbmVTZXAKCiAgICAgICAgJGZpbGVzID0gQChHZXQtQ2hpbGRJdGVtIC1QYXRoICRNb2R1bGVPdXREaXJcKiAtUmVjdXJzZSAtSW5jbHVkZSAqLnBzMSwgKi5wc20xKQogICAgICAgIGZvcmVhY2ggKCRmaWxlIGluICRmaWxlcykgewogICAgICAgICAgICAkc2V0QXV0aFNpZ1BhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICBGaWxlUGF0aCA9ICRmaWxlLkZ1bGxOYW1lCiAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0ZSA9ICRjZXJ0aWZpY2F0ZQogICAgICAgICAgICAgICAgVmVyYm9zZSA9ICRWZXJib3NlUHJlZmVyZW5jZQogICAgICAgICAgICB9CgogICAgICAgICAgICAkcmVzdWx0ID0gTWljcm9zb2Z0LlBvd2VyU2hlbGwuU2VjdXJpdHlcU2V0LUF1dGhlbnRpY29kZVNpZ25hdHVyZSBAc2V0QXV0aFNpZ1BhcmFtcwogICAgICAgICAgICBpZiAoJHJlc3VsdC5TdGF0dXMgLW5lICdWYWxpZCcpIHsKICAgICAgICAgICAgICAgIHRocm93ICJGYWlsZWQgdG8gc2lnbiBzY3JpcHQ6ICQoJGZpbGUuRnVsbE5hbWUpLiIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIlN1Y2Nlc3NmdWxseSBzaWduZWQgc2NyaXB0OiAkKCRmaWxlLk5hbWUpIgogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgICRleHBpcmVkQ2VydCA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJENlcnRQYXRoIC1Db2RlU2lnbmluZ0NlcnQgLVJlY3Vyc2UgfAogICAgICAgICAgICBXaGVyZS1PYmplY3QgeyAoJF8uU3ViamVjdE5hbWUuTmFtZSAtY21hdGNoIFtyZWdleF06OkVzY2FwZSgkQ2VydFN1YmplY3ROYW1lKSkgLWFuZCAKICAgICAgICAgICAgKCRfLk5vdEFmdGVyIC1sdCAoR2V0LURhdGUpKSB9CiAgICAgICAgU29ydC1PYmplY3QgTm90QWZ0ZXIgLURlc2NlbmRpbmcgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxCgogICAgICAgIGlmICgkZXhwaXJlZENlcnQpIHsKICAgICAgICAgICAgdGhyb3cgIlRoZSBjb2RlLXNpZ25pbmcgY2VydGlmaWNhdGUgYCIkKCRleHBpcmVkQ2VydC5TdWJqZWN0TmFtZS5OYW1lKWAiIEVYUElSRUQgb24gJCgkZXhwaXJlZENlcnQuTm90QWZ0ZXIpLiIKICAgICAgICB9CgogICAgICAgIHRocm93ICdObyB2YWxpZCBjZXJ0aWZpY2F0ZSBzdWJqZWN0IG5hbWUgc3VwcGxpZWQgb3Igc3RvcmVkLicKICAgIH0KfQoKVGFzayBCdWlsZEhlbHAgLWRlcGVuZHMgQnVpbGQsIEJlZm9yZUJ1aWxkSGVscCwgR2VuZXJhdGVNYXJrZG93biwgR2VuZXJhdGVIZWxwRmlsZXMsIEFmdGVyQnVpbGRIZWxwIHsKfQoKVGFzayBHZW5lcmF0ZU1hcmtkb3duIC1yZXF1aXJlZFZhcmlhYmxlcyBEZWZhdWx0TG9jYWxlLCBEb2NzUm9vdERpciwgTW9kdWxlTmFtZSwgTW9kdWxlT3V0RGlyIHsKICAgIGlmICghKEdldC1Nb2R1bGUgcGxhdHlQUyAtTGlzdEF2YWlsYWJsZSkpIHsKICAgICAgICAicGxhdHlQUyBtb2R1bGUgaXMgbm90IGluc3RhbGxlZC4gU2tpcHBpbmcgJCgkcHNha2UuY29udGV4dC5jdXJyZW50VGFza05hbWUpIHRhc2suIgogICAgICAgIHJldHVybgogICAgfQoKICAgICRtb2R1bGVJbmZvID0gSW1wb3J0LU1vZHVsZSAkTW9kdWxlT3V0RGlyXCRNb2R1bGVOYW1lLnBzZDEgLUdsb2JhbCAtRm9yY2UgLVBhc3NUaHJ1CgogICAgdHJ5IHsKICAgICAgICBpZiAoJG1vZHVsZUluZm8uRXhwb3J0ZWRDb21tYW5kcy5Db3VudCAtZXEgMCkgewogICAgICAgICAgICAiTm8gY29tbWFuZHMgaGF2ZSBiZWVuIGV4cG9ydGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgaWYgKCEoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkRG9jc1Jvb3REaXIpKSB7CiAgICAgICAgICAgIE5ldy1JdGVtICREb2NzUm9vdERpciAtSXRlbVR5cGUgRGlyZWN0b3J5ID4gJG51bGwKICAgICAgICB9CgogICAgICAgIGlmIChHZXQtQ2hpbGRJdGVtIC1MaXRlcmFsUGF0aCAkRG9jc1Jvb3REaXIgLUZpbHRlciAqLm1kIC1SZWN1cnNlKSB7CiAgICAgICAgICAgIEdldC1DaGlsZEl0ZW0gLUxpdGVyYWxQYXRoICREb2NzUm9vdERpciAtRGlyZWN0b3J5IHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgVXBkYXRlLU1hcmtkb3duSGVscCAtUGF0aCAkXy5GdWxsTmFtZSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UgPiAkbnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIEVycm9yQWN0aW9uIHNldCB0byBTaWxlbnRseUNvbnRpbnVlIHNvIHRoaXMgY29tbWFuZCB3aWxsIG5vdCBvdmVyd3JpdGUgYW4gZXhpc3RpbmcgTUQgZmlsZS4KICAgICAgICBOZXctTWFya2Rvd25IZWxwIC1Nb2R1bGUgJE1vZHVsZU5hbWUgLUxvY2FsZSAkRGVmYXVsdExvY2FsZSAtT3V0cHV0Rm9sZGVyICREb2NzUm9vdERpclwkRGVmYXVsdExvY2FsZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtV2l0aE1vZHVsZVBhZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgLVZlcmJvc2U6JFZlcmJvc2VQcmVmZXJlbmNlID4gJG51bGwKICAgIH0KICAgIGZpbmFsbHkgewogICAgICAgIFJlbW92ZS1Nb2R1bGUgJE1vZHVsZU5hbWUKICAgIH0KfQoKVGFzayBHZW5lcmF0ZUhlbHBGaWxlcyAtcmVxdWlyZWRWYXJpYWJsZXMgRG9jc1Jvb3REaXIsIE1vZHVsZU5hbWUsIE1vZHVsZU91dERpciwgT3V0RGlyIHsKICAgIGlmICghKEdldC1Nb2R1bGUgcGxhdHlQUyAtTGlzdEF2YWlsYWJsZSkpIHsKICAgICAgICAicGxhdHlQUyBtb2R1bGUgaXMgbm90IGluc3RhbGxlZC4gU2tpcHBpbmcgJCgkcHNha2UuY29udGV4dC5jdXJyZW50VGFza05hbWUpIHRhc2suIgogICAgICAgIHJldHVybgogICAgfQoKICAgIGlmICghKEdldC1DaGlsZEl0ZW0gLUxpdGVyYWxQYXRoICREb2NzUm9vdERpciAtRmlsdGVyICoubWQgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpKSB7CiAgICAgICAgIk5vIG1hcmtkb3duIGhlbHAgZmlsZXMgdG8gcHJvY2Vzcy4gU2tpcHBpbmcgJCgkcHNha2UuY29udGV4dC5jdXJyZW50VGFza05hbWUpIHRhc2suIgogICAgICAgIHJldHVybgogICAgfQoKICAgICRoZWxwTG9jYWxlcyA9IChHZXQtQ2hpbGRJdGVtIC1QYXRoICREb2NzUm9vdERpciAtRGlyZWN0b3J5KS5OYW1lCgogICAgIyBHZW5lcmF0ZSB0aGUgbW9kdWxlJ3MgcHJpbWFyeSBNQU1MIGhlbHAgZmlsZS4KICAgIGZvcmVhY2ggKCRsb2NhbGUgaW4gJGhlbHBMb2NhbGVzKSB7CiAgICAgICAgTmV3LUV4dGVybmFsSGVscCAtUGF0aCAkRG9jc1Jvb3REaXJcJGxvY2FsZSAtT3V0cHV0UGF0aCAkTW9kdWxlT3V0RGlyXCRsb2NhbGUgLUZvcmNlIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIC1WZXJib3NlOiRWZXJib3NlUHJlZmVyZW5jZSA+ICRudWxsCiAgICB9Cn0KClRhc2sgQnVpbGRVcGRhdGFibGVIZWxwIC1kZXBlbmRzIEJ1aWxkSGVscCwgQmVmb3JlQnVpbGRVcGRhdGFibGVIZWxwLCBDb3JlQnVpbGRVcGRhdGFibGVIZWxwLCBBZnRlckJ1aWxkVXBkYXRhYmxlSGVscCB7Cn0KClRhc2sgQ29yZUJ1aWxkVXBkYXRhYmxlSGVscCAtcmVxdWlyZWRWYXJpYWJsZXMgRG9jc1Jvb3REaXIsIE1vZHVsZU5hbWUsIFVwZGF0YWJsZUhlbHBPdXREaXIgewogICAgaWYgKCEoR2V0LU1vZHVsZSBwbGF0eVBTIC1MaXN0QXZhaWxhYmxlKSkgewogICAgICAgICJwbGF0eVBTIG1vZHVsZSBpcyBub3QgaW5zdGFsbGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgJGhlbHBMb2NhbGVzID0gKEdldC1DaGlsZEl0ZW0gLVBhdGggJERvY3NSb290RGlyIC1EaXJlY3RvcnkpLk5hbWUKCiAgICAjIENyZWF0ZSB1cGRhdGFibGUgaGVscCBvdXRwdXQgZGlyZWN0b3J5LgogICAgaWYgKCEoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkVXBkYXRhYmxlSGVscE91dERpcikpIHsKICAgICAgICBOZXctSXRlbSAkVXBkYXRhYmxlSGVscE91dERpciAtSXRlbVR5cGUgRGlyZWN0b3J5IC1WZXJib3NlOiRWZXJib3NlUHJlZmVyZW5jZSA+ICRudWxsCiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1WZXJib3NlICIkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgLSBkaXJlY3RvcnkgYWxyZWFkeSBleGlzdHMgJyRVcGRhdGFibGVIZWxwT3V0RGlyJy4iCiAgICAgICAgR2V0LUNoaWxkSXRlbSAkVXBkYXRhYmxlSGVscE91dERpciB8IFJlbW92ZS1JdGVtIC1SZWN1cnNlIC1Gb3JjZSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UKICAgIH0KCiAgICAjIEdlbmVyYXRlIHVwZGF0YWJsZSBoZWxwIGZpbGVzLiAgTm90ZTogdGhpcyB3aWxsIGN1cnJlbnRseSB1cGRhdGUgdGhlIHZlcnNpb24gbnVtYmVyIGluIHRoZSBtb2R1bGUncyBNRAogICAgIyBmaWxlIGluIHRoZSBtZXRhZGF0YS4KICAgIGZvcmVhY2ggKCRsb2NhbGUgaW4gJGhlbHBMb2NhbGVzKSB7CiAgICAgICAgTmV3LUV4dGVybmFsSGVscENhYiAtQ2FiRmlsZXNGb2xkZXIgJE1vZHVsZU91dERpclwkbG9jYWxlIC1MYW5kaW5nUGFnZVBhdGggJERvY3NSb290RGlyXCRsb2NhbGVcJE1vZHVsZU5hbWUubWQgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLU91dHB1dEZvbGRlciAkVXBkYXRhYmxlSGVscE91dERpciAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UgPiAkbnVsbAogICAgfQp9CgpUYXNrIEdlbmVyYXRlRmlsZUNhdGFsb2cgLWRlcGVuZHMgQnVpbGQsIEJ1aWxkSGVscCwgQmVmb3JlR2VuZXJhdGVGaWxlQ2F0YWxvZywgQ29yZUdlbmVyYXRlRmlsZUNhdGFsb2csIEFmdGVyR2VuZXJhdGVGaWxlQ2F0YWxvZyB7Cn0KClRhc2sgQ29yZUdlbmVyYXRlRmlsZUNhdGFsb2cgLXJlcXVpcmVkVmFyaWFibGVzIENhdGFsb2dHZW5lcmF0aW9uRW5hYmxlZCwgQ2F0YWxvZ1ZlcnNpb24sIE1vZHVsZU5hbWUsIE1vZHVsZU91dERpciwgT3V0RGlyIHsKICAgIGlmICghJENhdGFsb2dHZW5lcmF0aW9uRW5hYmxlZCkgewogICAgICAgICJGaWxlQ2F0YWxvZyBnZW5lcmF0aW9uIGlzIG5vdCBlbmFibGVkLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgaWYgKCEoR2V0LUNvbW1hbmQgTWljcm9zb2Z0LlBvd2VyU2hlbGwuU2VjdXJpdHlcTmV3LUZpbGVDYXRhbG9nIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKSkgewogICAgICAgICJGaWxlQ2F0YWxvZyBjb21tYW5kcyBub3QgYXZhaWxhYmxlIG9uIHRoaXMgdmVyc2lvbiBvZiBQb3dlclNoZWxsLiBTa2lwcGluZyAkKCRwc2FrZS5jb250ZXh0LmN1cnJlbnRUYXNrTmFtZSkgdGFzay4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgJGNhdGFsb2dGaWxlUGF0aCA9ICIkT3V0RGlyXCRNb2R1bGVOYW1lLmNhdCIKCiAgICAkbmV3RmlsZUNhdGFsb2dQYXJhbXMgPSBAewogICAgICAgIFBhdGggPSAkTW9kdWxlT3V0RGlyCiAgICAgICAgQ2F0YWxvZ0ZpbGVQYXRoID0gJGNhdGFsb2dGaWxlUGF0aAogICAgICAgIENhdGFsb2dWZXJzaW9uID0gJENhdGFsb2dWZXJzaW9uCiAgICAgICAgVmVyYm9zZSA9ICRWZXJib3NlUHJlZmVyZW5jZQogICAgfQoKICAgIE1pY3Jvc29mdC5Qb3dlclNoZWxsLlNlY3VyaXR5XE5ldy1GaWxlQ2F0YWxvZyBAbmV3RmlsZUNhdGFsb2dQYXJhbXMgPiAkbnVsbAoKICAgIGlmICgkU2NyaXB0U2lnbmluZ0VuYWJsZWQpIHsKICAgICAgICBpZiAoJFNoYXJlZFByb3BlcnRpZXMuQ29kZVNpZ25pbmdDZXJ0aWZpY2F0ZSkgewogICAgICAgICAgICAkc2V0QXV0aFNpZ1BhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICBGaWxlUGF0aCA9ICRjYXRhbG9nRmlsZVBhdGgKICAgICAgICAgICAgICAgIENlcnRpZmljYXRlID0gJFNoYXJlZFByb3BlcnRpZXMuQ29kZVNpZ25pbmdDZXJ0aWZpY2F0ZQogICAgICAgICAgICAgICAgVmVyYm9zZSA9ICRWZXJib3NlUHJlZmVyZW5jZQogICAgICAgICAgICB9CgogICAgICAgICAgICAkcmVzdWx0ID0gTWljcm9zb2Z0LlBvd2VyU2hlbGwuU2VjdXJpdHlcU2V0LUF1dGhlbnRpY29kZVNpZ25hdHVyZSBAc2V0QXV0aFNpZ1BhcmFtcwogICAgICAgICAgICBpZiAoJHJlc3VsdC5TdGF0dXMgLW5lICdWYWxpZCcpIHsKICAgICAgICAgICAgICAgIHRocm93ICJGYWlsZWQgdG8gc2lnbiBmaWxlIGNhdGFsb2c6ICQoJGNhdGFsb2dGaWxlUGF0aCkuIgogICAgICAgICAgICB9CgogICAgICAgICAgICAiU3VjY2Vzc2Z1bGx5IHNpZ25lZCBmaWxlIGNhdGFsb2c6ICQoJGNhdGFsb2dGaWxlUGF0aCkiCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAiTm8gY29kZS1zaWduaW5nIGNlcnRpZmljYXRlIHdhcyBmb3VuZCB0byBzaWduIHRoZSBmaWxlIGNhdGFsb2cuIgogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgICJTY3JpcHQgc2lnbmluZyBpcyBub3QgZW5hYmxlZC4gU2tpcHBpbmcgc2lnbmluZyBvZiBmaWxlIGNhdGFsb2cuIgogICAgfQoKICAgIE1vdmUtSXRlbSAtTGl0ZXJhbFBhdGggJG5ld0ZpbGVDYXRhbG9nUGFyYW1zLkNhdGFsb2dGaWxlUGF0aCAtRGVzdGluYXRpb24gJE1vZHVsZU91dERpcgp9CgpUYXNrIEluc3RhbGwgLWRlcGVuZHMgQnVpbGQsIEJ1aWxkSGVscCwgR2VuZXJhdGVGaWxlQ2F0YWxvZywgQmVmb3JlSW5zdGFsbCwgQ29yZUluc3RhbGwsIEFmdGVySW5zdGFsbCB7Cn0KClRhc2sgQ29yZUluc3RhbGwgLXJlcXVpcmVkVmFyaWFibGVzIE1vZHVsZU91dERpciB7CiAgICBpZiAoIShUZXN0LVBhdGggLUxpdGVyYWxQYXRoICRJbnN0YWxsUGF0aCkpIHsKICAgICAgICBXcml0ZS1WZXJib3NlICdDcmVhdGluZyBpbnN0YWxsIGRpcmVjdG9yeScKICAgICAgICBOZXctSXRlbSAtUGF0aCAkSW5zdGFsbFBhdGggLUl0ZW1UeXBlIERpcmVjdG9yeSAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UgPiAkbnVsbAogICAgfQoKICAgIENvcHktSXRlbSAtUGF0aCAkTW9kdWxlT3V0RGlyXCogLURlc3RpbmF0aW9uICRJbnN0YWxsUGF0aCAtVmVyYm9zZTokVmVyYm9zZVByZWZlcmVuY2UgLVJlY3Vyc2UgLUZvcmNlCiAgICAiTW9kdWxlIGluc3RhbGxlZCBpbnRvICRJbnN0YWxsUGF0aCIKfQoKVGFzayBUZXN0IC1kZXBlbmRzIEJ1aWxkIC1yZXF1aXJlZFZhcmlhYmxlcyBUZXN0Um9vdERpciwgTW9kdWxlTmFtZSwgQ29kZUNvdmVyYWdlRW5hYmxlZCwgQ29kZUNvdmVyYWdlRmlsZXMgewogICAgaWYgKCEoR2V0LU1vZHVsZSBQZXN0ZXIgLUxpc3RBdmFpbGFibGUpKSB7CiAgICAgICAgIlBlc3RlciBtb2R1bGUgaXMgbm90IGluc3RhbGxlZC4gU2tpcHBpbmcgJCgkcHNha2UuY29udGV4dC5jdXJyZW50VGFza05hbWUpIHRhc2suIgogICAgICAgIHJldHVybgogICAgfQoKICAgIEltcG9ydC1Nb2R1bGUgUGVzdGVyCgogICAgdHJ5IHsKICAgICAgICBNaWNyb3NvZnQuUG93ZXJTaGVsbC5NYW5hZ2VtZW50XFB1c2gtTG9jYXRpb24gLUxpdGVyYWxQYXRoICRUZXN0Um9vdERpcgoKICAgICAgICBpZiAoJFRlc3RPdXRwdXRGaWxlKSB7CiAgICAgICAgICAgICR0ZXN0aW5nID0gQHsKICAgICAgICAgICAgICAgIE91dHB1dEZpbGUgPSAkVGVzdE91dHB1dEZpbGUKICAgICAgICAgICAgICAgIE91dHB1dEZvcm1hdCA9ICRUZXN0T3V0cHV0Rm9ybWF0CiAgICAgICAgICAgICAgICBQYXNzVGhydSA9ICR0cnVlCiAgICAgICAgICAgICAgICBWZXJib3NlID0gJFZlcmJvc2VQcmVmZXJlbmNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR0ZXN0aW5nID0gQHsKICAgICAgICAgICAgICAgIFBhc3NUaHJ1ID0gJHRydWUKICAgICAgICAgICAgICAgIFZlcmJvc2UgPSAkVmVyYm9zZVByZWZlcmVuY2UKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBUbyBjb250cm9sIHRoZSBQZXN0ZXIgY29kZSBjb3ZlcmFnZSwgYSBib29sZWFuICRDb2RlQ292ZXJhZ2VFbmFibGVkIGlzIHVzZWQuCiAgICAgICAgaWYgKCRDb2RlQ292ZXJhZ2VFbmFibGVkKSB7CiAgICAgICAgICAgICR0ZXN0aW5nLkNvZGVDb3ZlcmFnZSA9ICRDb2RlQ292ZXJhZ2VGaWxlcwogICAgICAgIH0KCiAgICAgICAgJHRlc3RSZXN1bHQgPSBJbnZva2UtUGVzdGVyIEB0ZXN0aW5nCgogICAgICAgIEFzc2VydCAtY29uZGl0aW9uVG9DaGVjayAoCiAgICAgICAgICAgICR0ZXN0UmVzdWx0LkZhaWxlZENvdW50IC1lcSAwCiAgICAgICAgKSAtZmFpbHVyZU1lc3NhZ2UgIk9uZSBvciBtb3JlIFBlc3RlciB0ZXN0cyBmYWlsZWQsIGJ1aWxkIGNhbm5vdCBjb250aW51ZS4iCgogICAgICAgIGlmICgkQ29kZUNvdmVyYWdlRW5hYmxlZCkgewogICAgICAgICAgICAkdGVzdENvdmVyYWdlID0gW2ludF0oJHRlc3RSZXN1bHQuQ29kZUNvdmVyYWdlLk51bWJlck9mQ29tbWFuZHNFeGVjdXRlZCAvIAogICAgICAgICAgICAgICAgJHRlc3RSZXN1bHQuQ29kZUNvdmVyYWdlLk51bWJlck9mQ29tbWFuZHNBbmFseXplZCAqIDEwMCkKICAgICAgICAgICAgIlBlc3RlciBjb2RlIGNvdmVyYWdlIG9uIHNwZWNpZmllZCBmaWxlczogJHt0ZXN0Q292ZXJhZ2V9JSIKICAgICAgICB9CiAgICB9CiAgICBmaW5hbGx5IHsKICAgICAgICBNaWNyb3NvZnQuUG93ZXJTaGVsbC5NYW5hZ2VtZW50XFBvcC1Mb2NhdGlvbgogICAgICAgIFJlbW92ZS1Nb2R1bGUgJE1vZHVsZU5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgIH0KfQoKVGFzayBQdWJsaXNoIC1kZXBlbmRzIEJ1aWxkLCBUZXN0LCBCdWlsZEhlbHAsIEdlbmVyYXRlRmlsZUNhdGFsb2csIEJlZm9yZVB1Ymxpc2gsIENvcmVQdWJsaXNoLCBBZnRlclB1Ymxpc2ggewp9CgpUYXNrIENvcmVQdWJsaXNoIC1yZXF1aXJlZFZhcmlhYmxlcyBTZXR0aW5nc1BhdGgsIE1vZHVsZU91dERpciB7CiAgICAkcHVibGlzaFBhcmFtcyA9IEB7CiAgICAgICAgUGF0aCA9ICRNb2R1bGVPdXREaXIKICAgICAgICBOdUdldEFwaUtleSA9ICROdUdldEFwaUtleQogICAgfQoKICAgICMgUHVibGlzaGluZyB0byB0aGUgUFNHYWxsZXJ5IHJlcXVpcmVzIGFuIEFQSSBrZXksIHNvIGdldCBpdC4KICAgIGlmICgkTnVHZXRBcGlLZXkpIHsKICAgICAgICAiVXNpbmcgc2NyaXB0IGVtYmVkZGVkIE51R2V0QXBpS2V5IgogICAgfQogICAgZWxzZWlmICgkTnVHZXRBcGlLZXkgPSBHZXRTZXR0aW5nIC1QYXRoICRTZXR0aW5nc1BhdGggLUtleSBOdUdldEFwaUtleSkgewogICAgICAgICJVc2luZyBzdG9yZWQgTnVHZXRBcGlLZXkiCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkcHJvbXB0Rm9yS2V5Q3JlZFBhcmFtcyA9IEB7CiAgICAgICAgICAgIERlc3RpbmF0aW9uUGF0aCA9ICRTZXR0aW5nc1BhdGgKICAgICAgICAgICAgTWVzc2FnZSA9ICdFbnRlciB5b3VyIE51R2V0IEFQSSBrZXkgaW4gdGhlIHBhc3N3b3JkIGZpZWxkJwogICAgICAgICAgICBLZXkgPSAnTnVHZXRBcGlLZXknCiAgICAgICAgfQoKICAgICAgICAkY3JlZCA9IFByb21wdFVzZXJGb3JDcmVkZW50aWFsQW5kU3RvcmVQYXNzd29yZCBAcHJvbXB0Rm9yS2V5Q3JlZFBhcmFtcwogICAgICAgICROdUdldEFwaUtleSA9ICRjcmVkLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuUGFzc3dvcmQKICAgICAgICAiVGhlIE51R2V0QXBpS2V5IGhhcyBiZWVuIHN0b3JlZCBpbiAkU2V0dGluZ3NQYXRoIgogICAgfQoKICAgICRwdWJsaXNoUGFyYW1zID0gQHsKICAgICAgICBQYXRoID0gJE1vZHVsZU91dERpcgogICAgICAgIE51R2V0QXBpS2V5ID0gJE51R2V0QXBpS2V5CiAgICB9CgogICAgIyBJZiBhbiBhbHRlcm5hdGUgcmVwb3NpdG9yeSBpcyBzcGVjaWZpZWQsIHNldCB0aGUgYXBwcm9wcmlhdGUgcGFyYW1ldGVyLgogICAgaWYgKCRQdWJsaXNoUmVwb3NpdG9yeSkgewogICAgICAgICRwdWJsaXNoUGFyYW1zWydSZXBvc2l0b3J5J10gPSAkUHVibGlzaFJlcG9zaXRvcnkKICAgIH0KCiAgICAjIENvbnNpZGVyIG5vdCB1c2luZyAtUmVsZWFzZU5vdGVzIHBhcmFtZXRlciB3aGVuIFVwZGF0ZS1Nb2R1bGVNYW5pZmVzdCBoYXMgYmVlbiBmaXhlZC4KICAgIGlmICgkUmVsZWFzZU5vdGVzUGF0aCkgewogICAgICAgICRwdWJsaXNoUGFyYW1zWydSZWxlYXNlTm90ZXMnXSA9IEAoR2V0LUNvbnRlbnQgJFJlbGVhc2VOb3Rlc1BhdGgpCiAgICB9CgogICAgIkNhbGxpbmcgUHVibGlzaC1Nb2R1bGUuLi4iCiAgICBQdWJsaXNoLU1vZHVsZSBAcHVibGlzaFBhcmFtcwp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgU2Vjb25kYXJ5L3V0aWxpdHkgdGFza3MgLSB0eXBpY2FsbHkgdXNlZCB0byBtYW5hZ2Ugc3RvcmVkIGJ1aWxkIHNldHRpbmdzLgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpUYXNrID8gLWRlc2NyaXB0aW9uICdMaXN0cyB0aGUgYXZhaWxhYmxlIHRhc2tzJyB7CiAgICAiQXZhaWxhYmxlIHRhc2tzOiIKICAgICRwc2FrZS5jb250ZXh0LlBlZWsoKS5UYXNrcy5LZXlzIHwgU29ydC1PYmplY3QKfQoKVGFzayBSZW1vdmVBcGlLZXkgLXJlcXVpcmVkVmFyaWFibGVzIFNldHRpbmdzUGF0aCB7CiAgICBpZiAoR2V0U2V0dGluZyAtUGF0aCAkU2V0dGluZ3NQYXRoIC1LZXkgTnVHZXRBcGlLZXkpIHsKICAgICAgICBSZW1vdmVTZXR0aW5nIC1QYXRoICRTZXR0aW5nc1BhdGggLUtleSBOdUdldEFwaUtleQogICAgfQp9CgpUYXNrIFN0b3JlQXBpS2V5IC1yZXF1aXJlZFZhcmlhYmxlcyBTZXR0aW5nc1BhdGggewogICAgJHByb21wdEZvcktleUNyZWRQYXJhbXMgPSBAewogICAgICAgIERlc3RpbmF0aW9uUGF0aCA9ICRTZXR0aW5nc1BhdGgKICAgICAgICBNZXNzYWdlID0gJ0VudGVyIHlvdXIgTnVHZXQgQVBJIGtleSBpbiB0aGUgcGFzc3dvcmQgZmllbGQnCiAgICAgICAgS2V5ID0gJ051R2V0QXBpS2V5JwogICAgfQoKICAgIFByb21wdFVzZXJGb3JDcmVkZW50aWFsQW5kU3RvcmVQYXNzd29yZCBAcHJvbXB0Rm9yS2V5Q3JlZFBhcmFtcwogICAgIlRoZSBOdUdldEFwaUtleSBoYXMgYmVlbiBzdG9yZWQgaW4gJFNldHRpbmdzUGF0aCIKfQoKVGFzayBTaG93QXBpS2V5IC1yZXF1aXJlZFZhcmlhYmxlcyBTZXR0aW5nc1BhdGggewogICAgJE9GUyA9ICIiCiAgICBpZiAoJE51R2V0QXBpS2V5KSB7CiAgICAgICAgIlRoZSBlbWJlZGRlZCAocGFydGlhbCkgTnVHZXRBcGlLZXkgaXM6ICQoJE51R2V0QXBpS2V5WzAuLjddKSIKICAgIH0KICAgIGVsc2VpZiAoJE51R2V0QXBpS2V5ID0gR2V0U2V0dGluZyAtUGF0aCAkU2V0dGluZ3NQYXRoIC1LZXkgTnVHZXRBcGlLZXkpIHsKICAgICAgICAiVGhlIHN0b3JlZCAocGFydGlhbCkgTnVHZXRBcGlLZXkgaXM6ICQoJE51R2V0QXBpS2V5WzAuLjddKSIKICAgIH0KICAgIGVsc2UgewogICAgICAgICJUaGUgTnVHZXRBcGlLZXkgaGFzIG5vdCBiZWVuIHByb3ZpZGVkIG9yIHN0b3JlZC4iCiAgICAgICAgcmV0dXJuCiAgICB9CgogICAgIlRvIHNlZSB0aGUgZnVsbCBrZXksIHVzZSB0aGUgdGFzayAnU2hvd0Z1bGxBcGlLZXknIgp9CgpUYXNrIFNob3dGdWxsQXBpS2V5IC1yZXF1aXJlZFZhcmlhYmxlcyBTZXR0aW5nc1BhdGggewogICAgaWYgKCROdUdldEFwaUtleSkgewogICAgICAgICJUaGUgZW1iZWRkZWQgTnVHZXRBcGlLZXkgaXM6ICROdUdldEFwaUtleSIKICAgIH0KICAgIGVsc2VpZiAoJE51R2V0QXBpS2V5ID0gR2V0U2V0dGluZyAtUGF0aCAkU2V0dGluZ3NQYXRoIC1LZXkgTnVHZXRBcGlLZXkpIHsKICAgICAgICAiVGhlIHN0b3JlZCBOdUdldEFwaUtleSBpczogJE51R2V0QXBpS2V5IgogICAgfQogICAgZWxzZSB7CiAgICAgICAgIlRoZSBOdUdldEFwaUtleSBoYXMgbm90IGJlZW4gcHJvdmlkZWQgb3Igc3RvcmVkLiIKICAgIH0KfQoKVGFzayBSZW1vdmVDZXJ0U3ViamVjdE5hbWUgLXJlcXVpcmVkVmFyaWFibGVzIFNldHRpbmdzUGF0aCB7CiAgICBpZiAoR2V0U2V0dGluZyAtUGF0aCAkU2V0dGluZ3NQYXRoIC1LZXkgQ2VydFN1YmplY3ROYW1lKSB7CiAgICAgICAgUmVtb3ZlU2V0dGluZyAtUGF0aCAkU2V0dGluZ3NQYXRoIC1LZXkgQ2VydFN1YmplY3ROYW1lCiAgICB9Cn0KClRhc2sgU3RvcmVDZXJ0U3ViamVjdE5hbWUgLXJlcXVpcmVkVmFyaWFibGVzIFNldHRpbmdzUGF0aCB7CiAgICAkY2VydFN1YmplY3ROYW1lID0gJ0NOPScKICAgICRjZXJ0U3ViamVjdE5hbWUgKz0gUmVhZC1Ib3N0IC1Qcm9tcHQgJ0VudGVyIHRoZSBjZXJ0aWZpY2F0ZSBzdWJqZWN0IG5hbWUgZm9yIHNjcmlwdCBzaWduaW5nLiBVc2UgZXhhY3QgY2FzaW5nLCBDTj0gcHJlZml4IHdpbGwgYmUgYWRkZWQnCiAgICBTZXRTZXR0aW5nIC1LZXkgQ2VydFN1YmplY3ROYW1lIC1WYWx1ZSAkY2VydFN1YmplY3ROYW1lIC1QYXRoICRTZXR0aW5nc1BhdGgKICAgICJUaGUgbmV3IGNlcnRpZmljYXRlIHN1YmplY3QgbmFtZSAnJGNlcnRTdWJqZWN0TmFtZScgaGFzIGJlZW4gc3RvcmVkIGluICR7U2V0dGluZ3NQYXRofS4iCn0KClRhc2sgU2hvd0NlcnRTdWJqZWN0TmFtZSAtcmVxdWlyZWRWYXJpYWJsZXMgU2V0dGluZ3NQYXRoIHsKICAgICRDZXJ0U3ViamVjdE5hbWUgPSBHZXRTZXR0aW5nIC1QYXRoICRTZXR0aW5nc1BhdGggLUtleSBDZXJ0U3ViamVjdE5hbWUKICAgICJUaGUgc3RvcmVkIGNlcnRpZmljYXRlIGlzOiAkQ2VydFN1YmplY3ROYW1lIgoKICAgICRjZXJ0ID0gR2V0LUNoaWxkSXRlbSAtUGF0aCBDZXJ0OlxDdXJyZW50VXNlclxNeSAtQ29kZVNpZ25pbmdDZXJ0IHwKICAgICAgICBXaGVyZS1PYmplY3QgeyAkXy5TdWJqZWN0IC1lcSAkQ2VydFN1YmplY3ROYW1lIC1hbmQgJF8uTm90QWZ0ZXIgLWd0IChHZXQtRGF0ZSkgfSB8CiAgICAgICAgU29ydC1PYmplY3QgLVByb3BlcnR5IE5vdEFmdGVyIC1EZXNjZW5kaW5nIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMQoKICAgIGlmICgkY2VydCkgewogICAgICAgICJBIHZhbGlkIGNlcnRpZmljYXRlIGZvciB0aGUgc3ViamVjdCAkQ2VydFN1YmplY3ROYW1lIGhhcyBiZWVuIGZvdW5kIgogICAgfQogICAgZWxzZSB7CiAgICAgICAgJ0EgdmFsaWQgY2VydGlmaWNhdGUgaGFzIG5vdCBiZWVuIGZvdW5kJwogICAgfQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgSGVscGVyIGZ1bmN0aW9ucwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBQcm9tcHRVc2VyRm9yQ3JlZGVudGlhbEFuZFN0b3JlUGFzc3dvcmQgewogICAgW0RpYWdub3N0aWNzLkNvZGVBbmFseXNpcy5TdXBwcmVzc01lc3NhZ2UoIlBTUHJvdmlkZURlZmF1bHRQYXJhbWV0ZXJWYWx1ZSIsICcnKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddCiAgICAgICAgJERlc3RpbmF0aW9uUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddCiAgICAgICAgJE1lc3NhZ2UsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5LCBQYXJhbWV0ZXJTZXROYW1lID0gJ1NhdmVTZXR0aW5nJyldCiAgICAgICAgW3N0cmluZ10KICAgICAgICAkS2V5CiAgICApCgogICAgJGNyZWQgPSBHZXQtQ3JlZGVudGlhbCAtTWVzc2FnZSAkTWVzc2FnZSAtVXNlck5hbWUgImlnbm9yZWQiCiAgICBpZiAoJERlc3RpbmF0aW9uUGF0aCkgewogICAgICAgIFNldFNldHRpbmcgLUtleSAkS2V5IC1WYWx1ZSAkY3JlZC5QYXNzd29yZCAtUGF0aCAkRGVzdGluYXRpb25QYXRoCiAgICB9CgogICAgJGNyZWQKfQoKZnVuY3Rpb24gQWRkU2V0dGluZyB7CiAgICBbU3lzdGVtLkRpYWdub3N0aWNzLkNvZGVBbmFseXNpcy5TdXBwcmVzc01lc3NhZ2UoJ1BTU2hvdWxkUHJvY2VzcycsICcnLCBTY29wZSA9ICdGdW5jdGlvbicpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJEtleSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJFBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW29iamVjdF0kVmFsdWUKICAgICkKCiAgICBzd2l0Y2ggKCR0eXBlID0gJFZhbHVlLkdldFR5cGUoKS5OYW1lKSB7CiAgICAgICAgJ3NlY3VyZXN0cmluZycgeyAkc2V0dGluZyA9ICRWYWx1ZSB8IENvbnZlcnRGcm9tLVNlY3VyZVN0cmluZyB9CiAgICAgICAgZGVmYXVsdCB7ICRzZXR0aW5nID0gJFZhbHVlIH0KICAgIH0KCiAgICBpZiAoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkUGF0aCkgewogICAgICAgICRzdG9yZWRTZXR0aW5ncyA9IEltcG9ydC1DbGl4bWwgLVBhdGggJFBhdGgKICAgICAgICAkc3RvcmVkU2V0dGluZ3MuQWRkKCRLZXksIEAoJHR5cGUsICRzZXR0aW5nKSkKICAgICAgICAkc3RvcmVkU2V0dGluZ3MgfCBFeHBvcnQtQ2xpeG1sIC1QYXRoICRQYXRoCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkcGFyZW50RGlyID0gU3BsaXQtUGF0aCAtUGF0aCAkUGF0aCAtUGFyZW50CiAgICAgICAgaWYgKCEoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkcGFyZW50RGlyKSkgewogICAgICAgICAgICBOZXctSXRlbSAkcGFyZW50RGlyIC1JdGVtVHlwZSBEaXJlY3RvcnkgPiAkbnVsbAogICAgICAgIH0KCiAgICAgICAgQHskS2V5ID0gQCgkdHlwZSwgJHNldHRpbmcpfSB8IEV4cG9ydC1DbGl4bWwgLVBhdGggJFBhdGgKICAgIH0KfQoKZnVuY3Rpb24gR2V0U2V0dGluZyB7CiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kS2V5LAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kUGF0aAogICAgKQoKICAgIGlmIChUZXN0LVBhdGggLUxpdGVyYWxQYXRoICRQYXRoKSB7CiAgICAgICAgJHNlY3VyZWRTZXR0aW5ncyA9IEltcG9ydC1DbGl4bWwgLVBhdGggJFBhdGgKICAgICAgICBpZiAoJHNlY3VyZWRTZXR0aW5ncy4kS2V5KSB7CiAgICAgICAgICAgIHN3aXRjaCAoJHNlY3VyZWRTZXR0aW5ncy4kS2V5WzBdKSB7CiAgICAgICAgICAgICAgICAnc2VjdXJlc3RyaW5nJyB7CiAgICAgICAgICAgICAgICAgICAgJHZhbHVlID0gJHNlY3VyZWRTZXR0aW5ncy4kS2V5WzFdIHwgQ29udmVydFRvLVNlY3VyZVN0cmluZwogICAgICAgICAgICAgICAgICAgICRjcmVkID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNDcmVkZW50aWFsIC1Bcmd1bWVudExpc3QgJ2pwZ3InLCAkdmFsdWUKICAgICAgICAgICAgICAgICAgICAkY3JlZC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlBhc3N3b3JkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgICAgICAgICAkc2VjdXJlZFNldHRpbmdzLiRLZXlbMV0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gU2V0U2V0dGluZyB7CiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kS2V5LAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3N0cmluZ10kUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbb2JqZWN0XSRWYWx1ZQogICAgKQoKICAgIGlmIChHZXRTZXR0aW5nIC1LZXkgJEtleSAtUGF0aCAkUGF0aCkgewogICAgICAgIFJlbW92ZVNldHRpbmcgLUtleSAkS2V5IC1QYXRoICRQYXRoCiAgICB9CgogICAgQWRkU2V0dGluZyAtS2V5ICRLZXkgLVZhbHVlICRWYWx1ZSAtUGF0aCAkUGF0aAp9CgpmdW5jdGlvbiBSZW1vdmVTZXR0aW5nIHsKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbc3RyaW5nXSRLZXksCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbc3RyaW5nXSRQYXRoCiAgICApCgogICAgaWYgKFRlc3QtUGF0aCAtTGl0ZXJhbFBhdGggJFBhdGgpIHsKICAgICAgICAkc3RvcmVkU2V0dGluZ3MgPSBJbXBvcnQtQ2xpeG1sIC1QYXRoICRQYXRoCiAgICAgICAgJHN0b3JlZFNldHRpbmdzLlJlbW92ZSgkS2V5KQogICAgICAgIGlmICgkc3RvcmVkU2V0dGluZ3MuQ291bnQgLWVxIDApIHsKICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gLVBhdGggJFBhdGgKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRzdG9yZWRTZXR0aW5ncyB8IEV4cG9ydC1DbGl4bWwgLVBhdGggJFBhdGgKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1XYXJuaW5nICJUaGUgYnVpbGQgc2V0dGluZyBmaWxlICckUGF0aCcgaGFzIG5vdCBiZWVuIGNyZWF0ZWQgeWV0LiIKICAgIH0KfQo=
