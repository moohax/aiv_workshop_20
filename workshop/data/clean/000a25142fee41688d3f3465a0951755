tsql.psm1,09f4f72cedfb5d70231696b0dc70f7ef,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gQ29ubmVjdFNRTCB7CiAgICBQYXJhbSAoJHNlcnZlciwgJHF1ZXJ5LCAkZGF0YWJhc2UpCiAgICBXcml0ZS1kZWJ1ZyAiU2VydmVyOiAkc2VydmVyLCBEYXRhYmFzZTogJGRhdGFiYXNlLCBRdWVyeTogJHF1ZXJ5IgogICAgJGNvbm4gPSBuZXctb2JqZWN0ICgnU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbENvbm5lY3Rpb24nKQogICAgJGNvbm5TdHJpbmcgPSAiU2VydmVyPSRzZXJ2ZXI7SW50ZWdyYXRlZCBTZWN1cml0eT1TU1BJO0RhdGFiYXNlPSRkYXRhYmFzZSIKICAgICRjb25uLkNvbm5lY3Rpb25TdHJpbmcgPSAkY29ublN0cmluZwogICAgJGNvbm4uT3BlbigpCiAgICAkc3FsQ21kID0gTmV3LU9iamVjdCBTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsQ29tbWFuZAogICAgJHNxbENtZC5Db21tYW5kVGV4dCA9ICRxdWVyeQogICAgJHNxbENtZC5Db25uZWN0aW9uID0gJGNvbm4KICAgICRSc2V0ID0gJHNxbENtZC5FeGVjdXRlUmVhZGVyKCkKICAgICwkUnNldCAjIyBUaGUgY29tbWEgaXMgdXNlZCB0byBjcmVhdGUgYW4gb3V0ZXIgYXJyYXksIHdoaWNoIFBTIHN0cmlwcyBvZmYgYXV0b21hdGljYWxseSB3aGVuIHJldHVybmluZyB0aGUgJFJzZXQKfQoKZnVuY3Rpb24gUmVhZC1TcWxRdWVyeSB7CiAgICBQYXJhbSAoJHNlcnZlciwgJHF1ZXJ5LCAkZGF0YWJhc2UgPSAibWFzdGVyIikKICAgICRkYXRhID0gQ29ubmVjdFNRTCAkc2VydmVyICRxdWVyeSAkZGF0YWJhc2UKICAgIHdoaWxlICgkZGF0YS5yZWFkKCkgLWVxICR0cnVlKSB7CiAgICAgICAgJG1heCA9ICRkYXRhLkZpZWxkQ291bnQgLTEKICAgICAgICAkb2JqID0gTmV3LU9iamVjdCBPYmplY3QKICAgICAgICBGb3IgKCRpID0gMDsgJGkgLWxlICRtYXg7ICRpKyspIHsKICAgICAgICAgICAgJG5hbWUgPSAkZGF0YS5HZXROYW1lKCRpKQoJICAgICAgICBpZiAoJG5hbWUpIHsKICAgICAgICAgICAgICAgICRvYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAkbmFtZSAtdmFsdWUgJGRhdGEuR2V0VmFsdWUoJGkpCgkgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkb2JqID0gJGRhdGEuR2V0VmFsdWUoJGkpCgkgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJG9iagogICAgfQp9CgpmdW5jdGlvbiBXcml0ZS1TcWxOb25RdWVyeSB7CiAgICBQYXJhbSAoJHNlcnZlciwgJHN0bXQsICRkYXRhYmFzZSA9ICJtYXN0ZXIiKQogICAgJGNvbm4gPSBuZXctb2JqZWN0ICgnU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbENvbm5lY3Rpb24nKQogICAgJGNvbm5TdHJpbmcgPSAiU2VydmVyPSRzZXJ2ZXI7SW50ZWdyYXRlZCBTZWN1cml0eT1TU1BJO0RhdGFiYXNlPSRkYXRhYmFzZSIKICAgICRjb25uLkNvbm5lY3Rpb25TdHJpbmcgPSAkY29ublN0cmluZwogICAgJGNvbm4uT3BlbigpCiAgICAkc3FsQ21kID0gTmV3LU9iamVjdCBTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsQ29tbWFuZAogICAgJHNxbENtZC5Db21tYW5kVGV4dCA9ICRzdG10CiAgICAkc3FsQ21kLkNvbm5lY3Rpb24gPSAkY29ubgogICAgJHNxbENtZC5FeGVjdXRlTm9uUXVlcnkoKQp9CgpmdW5jdGlvbiBBZGQtc3FsZGIgewogICAgUEFSQU0gKAogICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgJGRibmFtZSwKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgIFtWYWxpZGF0ZVNjcmlwdCh7IC1ub3QodGVzdC1QYXRoICRfKX0pXQogICAgJGRicGF0aCwKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICRzZXJ2ZXIKICAgICkKCiAgICBpZiAoLW5vdChSZWFkLVNxbFF1ZXJ5ICRzZXJ2ZXIgIlNFTEVDVCAqIGZyb20gc3lzZGF0YWJhc2VzIiB8IFdoZXJlLU9iamVjdCB7ICRfLm5hbWUgLWVxICRkYm5hbWUgfSkpIHsKICAgICAgICBXcml0ZS1Ib3N0ICJDcmVhdGluZyAkZGJuYW1lIgogICAgICAgICRjcmVhdGVTdG10ID0gQCIKICAgICAgICBDUkVBVEUgREFUQUJBU0UKICAgICAgICAgICAgWyRkYm5hbWVdCiAgICAgICAgT04gUFJJTUFSWSAoCiAgICAgICAgICAgTkFNRT1UZXN0X2RhdGEsCiAgICAgICAgICAgRklMRU5BTUUgPSAnJCgkZGJwYXRoKS5tZGYnCiAgICAgICAgKQogICAgICAgIExPRyBPTiAoCiAgICAgICAgICAgIE5BTUU9VGVzdF9sb2csCiAgICAgICAgICAgIEZJTEVOQU1FID0gJyQoJGRicGF0aCkubGRmJwogICAgICAgICkKIkAKICAgICAgICBXcml0ZS1EZWJ1ZyAkY3JlYXRlU3RtdAogICAgICAgIFdyaXRlLVNxbE5vblF1ZXJ5ICRzZXJ2ZXIgJGNyZWF0ZVN0bXQKICAgIH0KfQoKZnVuY3Rpb24gQWRkLXNxbGxvZ2luKCRzZXJ2ZXIsICRsb2dpbj0nSUlTIEFQUFBPT0xcRGVmYXVsdEFwcFBvb2wnKSB7CiAgICBpZiAoLW5vdChSZWFkLVNxbFF1ZXJ5ICRzZXJ2ZXIgIlNFTEVDVCAqIGZyb20gc3lzLnN5c2xvZ2lucyB3aGVyZSBsb2dpbm5hbWUgPSAnJGxvZ2luJyIpKSB7CiAgICAgICAgJGNyZWF0ZVN0bXQgPSBAIgogICAgICAgICAgICBDUkVBVEUgTE9HSU4gWyRsb2dpbl0gRlJPTSBXSU5ET1dTIFdJVEggREVGQVVMVF9EQVRBQkFTRT1bbWFzdGVyXSwgREVGQVVMVF9MQU5HVUFHRT1bdXNfZW5nbGlzaF0KIkAKICAgICAgICBXcml0ZS1kZWJ1ZyAkY3JlYXRlU3RtdAogICAgICAgIFdyaXRlLVNxbE5vblF1ZXJ5ICRzZXJ2ZXIgJGNyZWF0ZVN0bXQgfCBvdXQtbnVsbAogICAgfQp9CgpmdW5jdGlvbiBBZGQtc3FsdXNlcigkc2VydmVyLCAkZGJuYW1lLCAkdXNlcj0nSUlTIEFQUFBPT0xcRGVmYXVsdEFwcFBvb2wnKSB7CiAgICAkcXJ5ID0gIlNFTEVDVCAqIEZST00gc3lzLnN5c3VzZXJzIiMgd2hlcmUgbmFtZSA9ICckdXNlciciCiAgICAkcmVzID0gUmVhZC1TcWxRdWVyeSAkc2VydmVyICRxcnkgJGRibmFtZQogICAgaWYgKC1ub3QoJHJlcyB8IHdoZXJlLW9iamVjdCB7ICRfLm5hbWUgLWVxICR1c2VyIH0pKQogICAgeyAKICAgICAgICAkY3JlYXRlU3RtdCA9IEAiCiAgICAgICAgICAgIENSRUFURSBVU0VSIFskdXNlcl0gRk9SIExPR0lOIFskdXNlcl0gV0lUSCBERUZBVUxUX1NDSEVNQT1bZGJvXQoiQAogICAgICAgIFdyaXRlLWRlYnVnICRjcmVhdGVTdG10CiAgICAgICAgV3JpdGUtU3FsTm9uUXVlcnkgJHNlcnZlciAkY3JlYXRlU3RtdCAkZGJuYW1lIHwgb3V0LW51bGwKICAgIH0KfQoKRXhwb3J0LW1vZHVsZW1lbWJlciAtZnVuY3Rpb24gQWRkLXNxbHVzZXIsQWRkLXNxbGxvZ2luLEFkZC1zcWxkYixSZWFkLVNxbFF1ZXJ5LFdyaXRlLVNxbE5vblF1ZXJ5Cg==
