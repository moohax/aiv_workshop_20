MSFT_xSqlServerInstall.psm1,f4e14cfa852e35d3c80b2de321f52cfe,Scan result is 1. IsMalware: 0,IwojIHhTUUxTZXJ2ZXJJbnN0YWxsOiBEU0MgcmVzb3VyY2UgdG8gaW5zdGFsbCBTcWwgU2VydmVyIEVudGVycHJpc2UgdmVyc2lvbi4KIwoKCiMKIyBUaGUgR2V0LVRhcmdldFJlc291cmNlIGNtZGxldC4KIwpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgcGFyYW0KICAgICggICAKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtzdHJpbmddICRJbnN0YW5jZU5hbWUgPSAiTVNTUUxTRVJWRVIiLAogICAgICAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0gCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSAkU291cmNlUGF0aCwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNvdXJjZVBhdGhDcmVkZW50aWFsLAoKICAgICAgICBbc3RyaW5nXSAkRmVhdHVyZXM9IlNRTEVuZ2luZSxTU01TIiwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsLAogICAgICAgIAogICAgICAgIFtib29sXSAkVXBkYXRlRW5hYmxlZCA9ICRmYWxzZSwKICAgICAgICBbc3RyaW5nXSAkU3ZjQWNjb3VudCA9ICROVUxMLAogICAgICAgIFtzdHJpbmddICRTeXNBZG1pbkFjY291bnRzID0gJE5VTEwsCiAgICAgICAgW3N0cmluZ10gJEFnZW50U3ZjQWNjb3VudCA9ICROVUxMCiAgICApCgogICAgJGxpc3QgPSBHZXQtU2VydmljZSAtTmFtZSBNU1NRTCoKICAgICRyZXRJbnN0YW5jZU5hbWUgPSAkbnVsbAoKICAgIGlmICgkSW5zdGFuY2VOYW1lIC1lcSAiTVNTUUxTRVJWRVIiKQogICAgewogICAgICAgIGlmICgkbGlzdC5OYW1lIC1jb250YWlucyAiTVNTUUxTRVJWRVIiKQogICAgICAgIHsKICAgICAgICAgICAgJHJldEluc3RhbmNlTmFtZSA9ICRJbnN0YW5jZU5hbWUKICAgICAgICB9CiAgICB9CiAgICBlbHNlaWYgKCRsaXN0Lk5hbWUgLWNvbnRhaW5zICQoIk1TU1FMJCIgKyAkSW5zdGFuY2VOYW1lKSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTUUwgSW5zdGFuY2UgJEluc3RhbmNlTmFtZSBpcyBwcmVzZW50IgogICAgICAgICRyZXRJbnN0YW5jZU5hbWUgPSAkSW5zdGFuY2VOYW1lCiAgICB9CgoKICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgSW5zdGFuY2VOYW1lID0gJHJldEluc3RhbmNlTmFtZQogICAgfQoKICAgIHJldHVybiAkcmV0dXJuVmFsdWUKfQoKCiMKIyBUaGUgU2V0LVRhcmdldFJlc291cmNlIGNtZGxldC4KIwpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgcGFyYW0KICAgICggICAKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtzdHJpbmddICRJbnN0YW5jZU5hbWUgPSAiTVNTUUxTRVJWRVIiLAogICAgICAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0gCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSAkU291cmNlUGF0aCwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNvdXJjZVBhdGhDcmVkZW50aWFsLAoKICAgICAgICBbc3RyaW5nXSAkRmVhdHVyZXM9IlNRTEVuZ2luZSxTU01TIiwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsLAogICAgICAgIAogICAgICAgIFtib29sXSAkVXBkYXRlRW5hYmxlZCA9ICRmYWxzZSwKICAgICAgICBbc3RyaW5nXSAkU3ZjQWNjb3VudCA9ICROVUxMLAogICAgICAgIFtzdHJpbmddICRTeXNBZG1pbkFjY291bnRzID0gJE5VTEwsCiAgICAgICAgW3N0cmluZ10gJEFnZW50U3ZjQWNjb3VudCA9ICROVUxMCiAgICApCiAgICAkTG9nUGF0aCA9IEpvaW4tUGF0aCAkZW52OlN5c3RlbURyaXZlIC1DaGlsZFBhdGggIkxvZ3MiCgogICAgaWYgKCEoVGVzdC1QYXRoICRMb2dQYXRoKSkKICAgIHsKICAgICAgICBOZXctSXRlbSAkTG9nUGF0aCAtSXRlbVR5cGUgRGlyZWN0b3J5CiAgICB9CiAgICAjIFNRTCBsb2cgZnJvbSBzZXR1cCBjbWRsaW5lIHJ1biBvdXRwdXQKICAgICRsb2dGaWxlID0gSm9pbi1QYXRoICRMb2dQYXRoIC1DaGlsZFBhdGggInNxbEluc3RhbGwtbG9nLnR4dCIKICAgIAogICAgIyBTUUwgaW5zdGFsbGVyIHBhdGggICAgICAgCiAgICAkY21kID0gSm9pbi1QYXRoICRTb3VyY2VQYXRoIC1DaGlsZFBhdGggIlNldHVwLmV4ZSIKCiAgICAjIFRDUEVOQUJMRUQtIFNwZWNpZmllcyB0aGUgc3RhdGUgb2YgdGhlIFRDUCBwcm90b2NvbCBmb3IgdGhlIFNRTCBTZXJ2ZXIgc2VydmljZS4gCiAgICAjIE5QRU5BQkxFRC0gU3BlY2lmaWVzIHRoZSBzdGF0ZSBvZiB0aGUgTmFtZWQgUGlwZXMgcHJvdG9jb2wgZm9yIHRoZSBTUUwgU2VydmVyIHNlcnZpY2UKICAgICMgdGNwL2lwIGFuZCBuYW1lZCBwaXBlcyBwcm90b2NvbCBuZWVkcyB0byBiZSBlbmFibGVkIGZvciB3ZWIgYXBwcyB0byBhY2Nlc3MgZGIgaW5zdGFuY2VzLiBTbyB0aGVzZSBhcmUgYmVpbmcgZW5hYmxlZCBhcyBhIHBhcnQgb2YgZGVmYXVsdCBzcWwgc2VydmVyIGluc3RhbGxhdGlvbgogICAgJGNtZCArPSAiIC9RIC9BQ1RJT049SW5zdGFsbCAvSUFDQ0VQVFNRTFNFUlZFUkxJQ0VOU0VURVJNUyAvSW5kaWNhdGVQcm9ncmVzcyAiCiAgICAkY21kICs9ICIgL0ZFQVRVUkVTPSRGZWF0dXJlcyAvSU5TVEFOQ0VOQU1FPSRJbnN0YW5jZU5hbWUgIgogICAgCiAgICBpZiAoJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsKQogICAgewogICAgICAgICRzYVB3ZCA9ICRTcWxBZG1pbmlzdHJhdG9yQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlBhc3N3b3JkCiAgICAgICAgJGNtZCArPSAiIC9UQ1BFTkFCTEVEPTEgL05QRU5BQkxFRD0xIC9TRUNVUklUWU1PREU9U1FMIC9TQVBXRD0kc2FQd2QgIgogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRjbWQgKz0gIiAvVENQRU5BQkxFRD0xIC9OUEVOQUJMRUQ9MSAiCiAgICB9CiAgICAKICAgIGlmICgkVXBkYXRlRW5hYmxlZCkKICAgIHsKICAgICAgICAkY21kICs9ICIgL3VwZGF0ZUVuYWJsZWQ9dHJ1ZSAiCiAgICB9CiAgICBlbHNlIAogICAgewogICAgICAgICRjbWQgKz0gIiAvdXBkYXRlRW5hYmxlZD1mYWxzZSAiCiAgICB9CiAgICAKICAgIGlmICgkU3lzQWRtaW5BY2NvdW50cykKICAgIHsKICAgICAgICAkY21kICs9ICIgL1NRTFNZU0FETUlOQUNDT1VOVFM9JFN5c0FkbWluQWNjb3VudHMgIgogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRjbWQgKz0gIiAvU1FMU1lTQURNSU5BQ0NPVU5UUz0nYnVpbHRpblxhZG1pbmlzdHJhdG9ycycgIgogICAgfQogICAgCiAgICBpZiAoJFN2Y0FjY291bnQpCiAgICB7CiAgICAgICAgJGNtZCArPSAiIC9TUUxTVkNBQ0NPVU5UPSRTdmNBY2NvdW50ICIKICAgIH0KICAgIAogICAgaWYgKCRBZ2VudFN2Y0FjY291bnQpCiAgICB7ICAgIAogICAgICAgICRjbWQgKz0gIiAvQUdUU1ZDQUNDT1VOVD0kQWdlbnRTdmNBY2NvdW50ICIKICAgIH0KICAgIAogICAgJGNtZCArPSAiID4gJGxvZ0ZpbGUgMj4mMSAiCgogICAgTmV0VXNlIC1TaGFyZVBhdGggJFNvdXJjZVBhdGggLVNoYXJlUGF0aENyZWRlbnRpYWwgJFNvdXJjZVBhdGhDcmVkZW50aWFsIC1FbnN1cmUgIlByZXNlbnQiCiAgICB0cnkKICAgIHsKICAgICAgICBJbnZva2UtRXhwcmVzc2lvbiAkY21kCiAgICB9CiAgICBmaW5hbGx5CiAgICB7CiAgICAgICAgTmV0VXNlIC1TaGFyZVBhdGggJFNvdXJjZVBhdGggLVNoYXJlUGF0aENyZWRlbnRpYWwgJFNvdXJjZVBhdGhDcmVkZW50aWFsIC1FbnN1cmUgIkFic2VudCIKICAgIH0KICAgICMgQ2hlY2sgdGhlIFNRTCBsb2dzIGZvciBpbnN0YWxsYXRpb24gc3RhdHVzLgogICAgJGluc3RhbGxTdGF0dXMgPSAkZmFsc2UKICAgIHRyeQogICAgeyAgICAgICAgCiAgICAgICAgIyBTUUwgU2VydmVyIGxvZyBmb2xkZXIKICAgICAgICAkTG9nUGF0aCA9IEpvaW4tUGF0aCAkZW52OlByb2dyYW1GaWxlcyAiTWljcm9zb2Z0IFNRTCBTZXJ2ZXJcMTEwXFNldHVwIEJvb3RzdHJhcFxMb2ciICAgICAgICAKICAgICAgICAkc3FsTG9nID0gR2V0LUNvbnRlbnQgIiRMb2dQYXRoXHN1bW1hcnkudHh0IgogICAgICAgIGlmKCRzcWxMb2cgLW5lICRudWxsKQogICAgICAgIHsKICAgICAgICAgICAgJG1lc3NhZ2UgPSAkc3FsTG9nIHwgZmwKICAgICAgICAgICAgaWYoJG1lc3NhZ2UgLW5lICRudWxsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjIHNhbXBsZSByZXBvcnQgd2hlbiB0aGUgaW5zdGFsbCBpcyBzdWNjZXNmdWwKICAgICAgICAgICAgICAgICMgICAgT3ZlcmFsbCBzdW1tYXJ5OgogICAgICAgICAgICAgICAgIyAgICBGaW5hbCByZXN1bHQ6ICAgICAgICAgICAgICAgICAgUGFzc2VkCiAgICAgICAgICAgICAgICAjICAgIEV4aXQgY29kZSAoRGVjaW1hbCk6ICAgICAgICAgICAwCiAgICAgICAgICAgICAgICAkZmluYWxSZXN1bHQgPSAkbWVzc2FnZVsxXSB8IE91dC1TdHJpbmcgICAgIAogICAgICAgICAgICAgICAgJGV4aXRDb2RlID0gJG1lc3NhZ2VbMl0gfCBPdXQtU3RyaW5nICAgIAoKICAgICAgICAgICAgICAgIGlmKCgkZmluYWxSZXN1bHQuQ29udGFpbnMoIlBhc3NlZCIpIC1lcSAkVHJ1ZSkgLWFuZCAoJGV4aXRDb2RlLkNvbnRhaW5zKCIwIikgLWVxICRUcnVlKSkKICAgICAgICAgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAkaW5zdGFsbFN0YXR1cyA9ICR0cnVlCiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGNhdGNoCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU1FMIEluc3RhbGxhdGlvbiBkaWQgbm90IHN1Y2NlZWQuIgogICAgfQogICAgaWYoJGluc3RhbGxTdGF0dXMgLWVxICR0cnVlKQogICAgewogICAgICAgICMgVGVsbCB0aGUgRFNDIEVuZ2luZSB0byByZXN0YXJ0IHRoZSBtYWNoaW5lCiAgICAgICAgJGdsb2JhbDpEU0NNYWNoaW5lU3RhdHVzID0gMQogICAgfQogICAgZWxzZSAgICAKICAgIHsgICAgICAgIAogICAgICAgICMgVGhyb3cgYW4gZXJyb3IgbWVzc2FnZSBpbmRpY2F0aW5nIGZhaWx1cmUgdG8gaW5zdGFsbCBTUUwgU2VydmVyIGluc3RhbGwgCiAgICAgICAgJGVycm9ySWQgPSAiSW5WYWxpZFNRTFNlcnZlckluc3RhbGwiOwogICAgICAgICRleGNlcHRpb25TdHIgPSAiU1FMIFNlcnZlciBpbnN0YWxsYXRpb24gZGlkIG5vdCBzdWNjZWVkLiBGb3IgbW9yZSBkZXRhaWxzIHBsZWFzZSByZWZlciB0byB0aGUgbG9ncyB1bmRlciAkTG9nUGF0aCBmb2xkZXIuIgogICAgICAgICRlcnJvckNhdGVnb3J5ID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JDYXRlZ29yeV06OkludmFsaWRSZXN1bHQ7CiAgICAgICAgJGV4Y2VwdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gJGV4Y2VwdGlvblN0cjsgCiAgICAgICAgJGVycm9yUmVjb3JkID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkVycm9yUmVjb3JkICRleGNlcHRpb24sICRlcnJvcklkLCAkZXJyb3JDYXRlZ29yeSwgJG51bGwKCiAgICAgICAgJFBTQ21kbGV0LlRocm93VGVybWluYXRpbmdFcnJvcigkZXJyb3JSZWNvcmQpOwogICAgIH0KfQojCiMgVGhlIFRlc3QtVGFyZ2V0UmVzb3VyY2UgY21kbGV0LgojCmZ1bmN0aW9uIFRlc3QtVGFyZ2V0UmVzb3VyY2UKewogICAgcGFyYW0KICAgICggICAKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtzdHJpbmddICRJbnN0YW5jZU5hbWUgPSAiTVNTUUxTRVJWRVIiLAogICAgICAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0gCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSAkU291cmNlUGF0aCwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNvdXJjZVBhdGhDcmVkZW50aWFsLAoKICAgICAgICBbc3RyaW5nXSAkRmVhdHVyZXM9IlNRTEVuZ2luZSxTU01TIiwKCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsLAoKICAgICAgICBbYm9vbF0gJFVwZGF0ZUVuYWJsZWQgPSAkZmFsc2UsCiAgICAgICAgW3N0cmluZ10gJFN2Y0FjY291bnQgPSAkTlVMTCwKICAgICAgICBbc3RyaW5nXSAkU3lzQWRtaW5BY2NvdW50cyA9ICROVUxMLAogICAgICAgIFtzdHJpbmddICRBZ2VudFN2Y0FjY291bnQgPSAkTlVMTAogICAgKQoKICAgICRpbmZvID0gR2V0LVRhcmdldFJlc291cmNlIC1JbnN0YW5jZU5hbWUgJEluc3RhbmNlTmFtZSAtU291cmNlUGF0aCAkU291cmNlUGF0aCAtU3FsQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwgJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsCiAgICAKICAgIHJldHVybiAoJGluZm8uSW5zdGFuY2VOYW1lIC1lcSAkSW5zdGFuY2VOYW1lKQp9CgoKCmZ1bmN0aW9uIE5ldFVzZQp7CiAgICBwYXJhbQogICAgKCAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0gCiAgICAgICAgW3N0cmluZ10gJFNoYXJlUGF0aCwKICAgICAgICAKICAgICAgICBbUFNDcmVkZW50aWFsXSRTaGFyZVBhdGhDcmVkZW50aWFsLAogICAgICAgIAogICAgICAgIFtzdHJpbmddICRFbnN1cmUgPSAiUHJlc2VudCIKICAgICkKCiAgICBpZiAoJG51bGwgLWVxICRTaGFyZVBhdGhDcmVkZW50aWFsKQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJOZXRVc2Ugc2V0IHNoYXJlICRTaGFyZVBhdGggLi4uIgoKICAgIGlmICgkRW5zdXJlIC1lcSAiQWJzZW50IikKICAgIHsKICAgICAgICAkY21kID0gIm5ldCB1c2UgJFNoYXJlUGF0aCAvREVMRVRFIgogICAgfQogICAgZWxzZSAKICAgIHsKICAgICAgICAkY3JlZCA9ICRTaGFyZVBhdGhDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkKICAgICAgICAkcHdkID0gJGNyZWQuUGFzc3dvcmQgCiAgICAgICAgJHVzZXIgPSAkY3JlZC5Eb21haW4gKyAiXCIgKyAkY3JlZC5Vc2VyTmFtZQogICAgICAgICRjbWQgPSAibmV0IHVzZSAkU2hhcmVQYXRoICRwd2QgL3VzZXI6JHVzZXIiCiAgICB9CgogICAgSW52b2tlLUV4cHJlc3Npb24gJGNtZAp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
