AzureWebAppPublishModule.psm1,b88465a72f5ec4abb1c3f6cee7706e13,Scan result is 1. IsMalware: 0,w6/Cu8K/IyAgQXp1cmVXZWJBcHBQdWJsaXNoTW9kdWxlLnBzbTEgaXMgYSBXaW5kb3dzIFBvd2VyU2hlbGwgc2NyaXB0IG1vZHVsZS4gVGhpcyBtb2R1bGUgZXhwb3J0cyBXaW5kb3dzIFBvd2VyU2hlbGwgZnVuY3Rpb25zIHRoYXQgYXV0b21hdGUgbGlmZSBjeWNsZSBtYW5hZ2VtZW50IGZvciB3ZWIgYXBwbGljYXRpb25zLiBZb3UgY2FuIHVzZSB0aGUgZnVuY3Rpb25zIGFzIGlzIG9yIGN1c3RvbWl6ZSB0aGVtIGZvciB5b3VyIGFwcGxpY2F0aW9uIGFuZCBwdWJsaXNoaW5nIGVudmlyb25tZW50LgoKCgoKClNldC1TdHJpY3RNb2RlIC1WZXJzaW9uIDMKCiMgQSB2YXJpYWJsZSB0byBzYXZlIG9yaWdpbmFsIHN1YnNjcmlwdGlvbi4KJFNjcmlwdDpvcmlnaW5hbEN1cnJlbnRTdWJzY3JpcHRpb24gPSAkbnVsbAoKIyBBIHZhcmlhYmxlIHRvIHNhdmUgb3JpZ2luYWwgc3RvcmFnZSBhY2NvdW50LgokU2NyaXB0Om9yaWdpbmFsQ3VycmVudFN0b3JhZ2VBY2NvdW50ID0gJG51bGwKCiMgQSB2YXJpYWJsZSB0byBzYXZlIHN0b3JhZ2UgYWNjb3VudCBvZiB1c2VyIHNwZWNpZmllZCBzdWJzY3JpcHRpb24uCiRTY3JpcHQ6b3JpZ2luYWxTdG9yYWdlQWNjb3VudE9mVXNlclNwZWNpZmllZFN1YnNjcmlwdGlvbiA9ICRudWxsCgojIEEgdmFyaWFibGUgdG8gc2F2ZSBzdWJzY3JpcHRpb24gbmFtZS4KJFNjcmlwdDp1c2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uID0gJG51bGwKCiMgV2ViIGRlcGxveSBwb3J0IG51bWJlcgpOZXctVmFyaWFibGUgLU5hbWUgV2ViRGVwbG95UG9ydCAtVmFsdWUgODE3MiAtT3B0aW9uIENvbnN0YW50Cgo8IwouU1lOT1BTSVMKUHJlcGVuZHMgdGhlIGRhdGUgYW5kIHRpbWUgdG8gYSBtZXNzYWdlLgoKLkRFU0NSSVBUSU9OClByZXBlbmRzIHRoZSBkYXRlIGFuZCB0aW1lIHRvIGEgbWVzc2FnZS4gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCBmb3IgbWVzc2FnZXMgd3JpdHRlbiB0byB0aGUgRXJyb3IgYW5kIFZlcmJvc2Ugc3RyZWFtcy4KCi5QQVJBTUVURVIgIE1lc3NhZ2UKU3BlY2lmaWVzIHRoZSBtZXNzYWdlcyB3aXRob3V0IHRoZSBkYXRlLgoKLklOUFVUUwpTeXN0ZW0uU3RyaW5nCgouT1VUUFVUUwpTeXN0ZW0uU3RyaW5nCgouRVhBTVBMRQpQUyBDOlw+IEZvcm1hdC1EZXZUZXN0TWVzc2FnZVdpdGhUaW1lIC1NZXNzYWdlICJBZGRpbmcgZmlsZSAkZmlsZW5hbWUgdG8gdGhlIGRpcmVjdG9yeSIKMi81LzIwMTQgMTowMzowOCBQTSAtIEFkZGluZyBmaWxlICRmaWxlbmFtZSB0byB0aGUgZGlyZWN0b3J5CgouTElOSwpXcml0ZS1WZXJib3NlV2l0aFRpbWUKCi5MSU5LCldyaXRlLUVycm9yV2l0aFRpbWUKIz4KZnVuY3Rpb24gRm9ybWF0LURldlRlc3RNZXNzYWdlV2l0aFRpbWUKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmUgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTWVzc2FnZQogICAgKQoKICAgIHJldHVybiAoKEdldC1EYXRlIC1Gb3JtYXQgRykgICsgJyAtICcgKyAkTWVzc2FnZSkKfQoKCjwjCgouU1lOT1BTSVMKV3JpdGVzIGFuIGVycm9yIG1lc3NhZ2UgcHJlZml4ZWQgd2l0aCB0aGUgY3VycmVudCB0aW1lLgoKLkRFU0NSSVBUSU9OCldyaXRlcyBhbiBlcnJvciBtZXNzYWdlIHByZWZpeGVkIHdpdGggdGhlIGN1cnJlbnQgdGltZS4gVGhpcyBmdW5jdGlvbiBjYWxscyB0aGUgRm9ybWF0LURldlRlc3RNZXNzYWdlV2l0aFRpbWUgZnVuY3Rpb24gdG8gcHJlcGVuZCB0aGUgdGltZSBiZWZvcmUgd3JpdGluZyB0aGUgbWVzc2FnZSB0byB0aGUgRXJyb3Igc3RyZWFtLgoKLlBBUkFNRVRFUiAgTWVzc2FnZQpTcGVjaWZpZXMgdGhlIG1lc3NhZ2UgaW4gdGhlIGVycm9yIG1lc3NhZ2UgY2FsbC4gWW91IGNhbiBwaXBlIHRoZSBtZXNzYWdlIHN0cmluZyB0byB0aGUgZnVuY3Rpb24uCgouSU5QVVRTClN5c3RlbS5TdHJpbmcKCi5PVVRQVVRTCk5vbmUuIFRoZSBmdW5jdGlvbiB3cml0ZXMgdG8gdGhlIEVycm9yIHN0cmVhbS4KCi5FWEFNUExFClBTIEM6PiBXcml0ZS1FcnJvcldpdGhUaW1lIC1NZXNzYWdlICJGYWlsZWQuIENhbm5vdCBmaW5kIHRoZSBmaWxlLiIKCldyaXRlLUVycm9yOiAyLzYvMjAxNCA4OjM3OjI5IEFNIC0gRmFpbGVkLiBDYW5ub3QgZmluZCB0aGUgZmlsZS4KICsgQ2F0ZWdvcnlJbmZvICAgICA6IE5vdFNwZWNpZmllZDogKDopIFtXcml0ZS1FcnJvcl0sIFdyaXRlRXJyb3JFeGNlcHRpb24KICsgRnVsbHlRdWFsaWZpZWRFcnJvcklkIDogTWljcm9zb2Z0LlBvd2VyU2hlbGwuQ29tbWFuZHMuV3JpdGVFcnJvckV4Y2VwdGlvbgoKLkxJTksKV3JpdGUtRXJyb3IKCiM+CmZ1bmN0aW9uIFdyaXRlLUVycm9yV2l0aFRpbWUKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmUgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTWVzc2FnZQogICAgKQoKICAgICRNZXNzYWdlIHwgRm9ybWF0LURldlRlc3RNZXNzYWdlV2l0aFRpbWUgfCBXcml0ZS1FcnJvcgp9CgoKPCMKLlNZTk9QU0lTCldyaXRlcyBhIHZlcmJvc2UgbWVzc2FnZSBwcmVmaXhlZCB3aXRoIHRoZSBjdXJyZW50IHRpbWUuCgouREVTQ1JJUFRJT04KV3JpdGVzIGEgdmVyYm9zZSBtZXNzYWdlIHByZWZpeGVkIHdpdGggdGhlIGN1cnJlbnQgdGltZS4gQmVjYXVzZSBpdCBjYWxscyBXcml0ZS1WZXJib3NlLCB0aGUgbWVzc2FnZSBkaXNwbGF5cyBvbmx5IHdoZW4gdGhlIHNjcmlwdCBydW5zIHdpdGggdGhlIFZlcmJvc2UgcGFyYW1ldGVyIG9yIHdoZW4gdGhlIFZlcmJvc2VQcmVmZXJlbmNlIHByZWZlcmVuY2UgaXMgc2V0IHRvIENvbnRpbnVlLgoKLlBBUkFNRVRFUiAgTWVzc2FnZQpTcGVjaWZpZXMgdGhlIG1lc3NhZ2UgaW4gdGhlIHZlcmJvc2UgbWVzc2FnZSBjYWxsLiBZb3UgY2FuIHBpcGUgdGhlIG1lc3NhZ2Ugc3RyaW5nIHRvIHRoZSBmdW5jdGlvbi4KCi5JTlBVVFMKU3lzdGVtLlN0cmluZwoKLk9VVFBVVFMKTm9uZS4gVGhlIGZ1bmN0aW9uIHdyaXRlcyB0byB0aGUgVmVyYm9zZSBzdHJlYW0uCgouRVhBTVBMRQpQUyBDOj4gV3JpdGUtVmVyYm9zZVdpdGhUaW1lIC1NZXNzYWdlICJUaGUgb3BlcmF0aW9uIHN1Y2NlZWRlZC4iClBTIEM6PgpQUyBDOlw+IFdyaXRlLVZlcmJvc2VXaXRoVGltZSAtTWVzc2FnZSAiVGhlIG9wZXJhdGlvbiBzdWNjZWVkZWQuIiAtVmVyYm9zZQpWRVJCT1NFOiAxLzI3LzIwMTQgMTE6MDI6MzcgQU0gLSBUaGUgb3BlcmF0aW9uIHN1Y2NlZWRlZC4KCi5FWEFNUExFClBTIEM6XHBzLXRlc3Q+ICJUaGUgb3BlcmF0aW9uIHN1Y2NlZWRlZC4iIHwgV3JpdGUtVmVyYm9zZVdpdGhUaW1lIC1WZXJib3NlClZFUkJPU0U6IDEvMjcvMjAxNCAxMTowMTozOCBBTSAtIFRoZSBvcGVyYXRpb24gc3VjY2VlZGVkLgoKLkxJTksKV3JpdGUtVmVyYm9zZQojPgpmdW5jdGlvbiBXcml0ZS1WZXJib3NlV2l0aFRpbWUKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmUgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTWVzc2FnZQogICAgKQoKICAgICRNZXNzYWdlIHwgRm9ybWF0LURldlRlc3RNZXNzYWdlV2l0aFRpbWUgfCBXcml0ZS1WZXJib3NlCn0KCgo8IwouU1lOT1BTSVMKV3JpdGVzIGEgaG9zdCBtZXNzYWdlIHByZWZpeGVkIHdpdGggdGhlIGN1cnJlbnQgdGltZS4KCi5ERVNDUklQVElPTgpUaGlzIGZ1bmN0aW9uIHdyaXRlcyBhIG1lc3NhZ2UgdG8gdGhlIGhvc3QgcHJvZ3JhbSAoV3JpdGUtSG9zdCkgcHJlZml4ZWQgd2l0aCB0aGUgY3VycmVudCB0aW1lLiBUaGUgZWZmZWN0IG9mIHdyaXRpbmcgdG8gdGhlIGhvc3QgcHJvZ3JhbSB2YXJpZXMuIE1vc3QgcHJvZ3JhbXMgdGhhdCBob3N0IFdpbmRvd3MgUG93ZXJTaGVsbCB3cml0ZSB0aGVzZSBtZXNzYWdlcyB0byBzdGFuZGFyZCBvdXRwdXQuCgouUEFSQU1FVEVSICBNZXNzYWdlClNwZWNpZmllcyB0aGUgYmFzZSBtZXNzYWdlIHdpdGhvdXQgdGhlIGRhdGUuIFlvdSBjYW4gcGlwZSB0aGUgbWVzc2FnZSBzdHJpbmcgdG8gdGhlIGZ1bmN0aW9uLgoKLklOUFVUUwpTeXN0ZW0uU3RyaW5nCgouT1VUUFVUUwpOb25lLiBUaGUgZnVuY3Rpb24gd3JpdGVzIHRoZSBtZXNzYWdlIHRvIHRoZSBob3N0IHByb2dyYW0uCgouRVhBTVBMRQpQUyBDOj4gV3JpdGUtSG9zdFdpdGhUaW1lIC1NZXNzYWdlICJUaGUgb3BlcmF0aW9uIHN1Y2NlZWRlZC4iCjEvMjcvMjAxNCAxMTowMjozNyBBTSAtIFRoZSBvcGVyYXRpb24gc3VjY2VlZGVkLgoKLkxJTksKV3JpdGUtSG9zdAojPgpmdW5jdGlvbiBXcml0ZS1Ib3N0V2l0aFRpbWUKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmUgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTWVzc2FnZQogICAgKQogICAgCiAgICBpZiAoKEdldC1WYXJpYWJsZSBTZW5kSG9zdE1lc3NhZ2VzVG9PdXRwdXQgLVNjb3BlIEdsb2JhbCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkgLWFuZCAkR2xvYmFsOlNlbmRIb3N0TWVzc2FnZXNUb091dHB1dCkKICAgIHsKICAgICAgICBpZiAoIShHZXQtVmFyaWFibGUgLVNjb3BlIEdsb2JhbCBBenVyZVdlYkFwcFB1Ymxpc2hPdXRwdXQgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpIC1vciAhJEdsb2JhbDpBenVyZVdlYkFwcFB1Ymxpc2hPdXRwdXQpCiAgICAgICAgewogICAgICAgICAgICBOZXctVmFyaWFibGUgLU5hbWUgQXp1cmVXZWJBcHBQdWJsaXNoT3V0cHV0IC1WYWx1ZSBAKCkgLVNjb3BlIEdsb2JhbCAtRm9yY2UKICAgICAgICB9CgogICAgICAgICRHbG9iYWw6QXp1cmVXZWJBcHBQdWJsaXNoT3V0cHV0ICs9ICRNZXNzYWdlIHwgRm9ybWF0LURldlRlc3RNZXNzYWdlV2l0aFRpbWUKICAgIH0KICAgIGVsc2UgCiAgICB7CiAgICAgICAgJE1lc3NhZ2UgfCBGb3JtYXQtRGV2VGVzdE1lc3NhZ2VXaXRoVGltZSB8IFdyaXRlLUhvc3QKICAgIH0KfQoKCjwjCi5TWU5PUFNJUwpSZXR1cm5zICR0cnVlIGlmIGEgcHJvcGVydHkgb3IgbWV0aG9kIGlzIGEgbWVtYmVyIG9mIHRoZSBvYmplY3QuIE90aGVyd2lzZSwgJGZhbHNlLgoKLkRFU0NSSVBUSU9OClJldHVybnMgJHRydWUgaWYgdGhlIHByb3BlcnR5IG9yIG1ldGhvZCBpcyBhIG1lbWJlciBvZiB0aGUgb2JqZWN0LiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgJGZhbHNlIGZvciBzdGF0aWMgbWV0aG9kcyBvZiB0aGUgY2xhc3MgYW5kIGZvciB2aWV3cywgc3VjaCBhcyBQU0Jhc2UgYW5kIFBTT2JqZWN0LgoKLlBBUkFNRVRFUiAgT2JqZWN0ClNwZWNpZmllcyB0aGUgb2JqZWN0IGluIHRoZSB0ZXN0LiBFbnRlciBhIHZhcmlhYmxlIHRoYXQgY29udGFpbnMgYW4gb2JqZWN0IG9yIGFuIGV4cHJlc3Npb24gdGhhdCByZXR1cm5zIGFuIG9iamVjdC4gWW91IGNhbm5vdCBzcGVjaWZ5IHR5cGVzLCBzdWNoIGFzIFtEYXRlVGltZV0gb3IgcGlwZSBvYmplY3RzIHRvIHRoaXMgZnVuY3Rpb24uCgouUEFSQU1FVEVSICBNZW1iZXIKU3BlY2lmaWVzIHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBvciBtZXRob2QgaW4gdGhlIHRlc3QuIFdoZW4gc3BlY2lmeWluZyBhIG1ldGhvZCwgb21pdCBwYXJlbnRoZXNlcyB0aGF0IGZvbGxvdyB0aGUgbWV0aG9kIG5hbWUuCgouSU5QVVRTCk5vbmUuIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgdGFrZSBpbnB1dCBmcm9tIHRoZSBwaXBlbGluZS4KCi5PVVRQVVRTClN5c3RlbS5Cb29sZWFuCgouRVhBTVBMRQpQUyBDOlw+IFRlc3QtTWVtYmVyIC1PYmplY3QgKEdldC1EYXRlKSAtTWVtYmVyIERheU9mV2VlawpUcnVlCgouRVhBTVBMRQpQUyBDOlw+ICRkYXRlID0gR2V0LURhdGUKUFMgQzpcPiBUZXN0LU1lbWJlciAtT2JqZWN0ICRkYXRlIC1NZW1iZXIgQWRkRGF5cwpUcnVlCgouRVhBTVBMRQpQUyBDOlw+IFtEYXRlVGltZV06OklzTGVhcFllYXIoKEdldC1EYXRlKS5ZZWFyKQpUcnVlClBTIEM6XD4gVGVzdC1NZW1iZXIgLU9iamVjdCAoR2V0LURhdGUpIC1NZW1iZXIgSXNMZWFwWWVhcgpGYWxzZQoKLkxJTksKR2V0LU1lbWJlcgojPgpmdW5jdGlvbiBUZXN0LU1lbWJlcgp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbT2JqZWN0XQogICAgICAgICRPYmplY3QsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE1lbWJlcgogICAgKQoKICAgIHJldHVybiAkbnVsbCAtbmUgKCRPYmplY3QgfCBHZXQtTWVtYmVyIC1OYW1lICRNZW1iZXIpCn0KCgo8IwouU1lOT1BTSVMKUmV0dXJucyAkdHJ1ZSBpZiB0aGUgdmVyc2lvbiBvZiB0aGUgQXp1cmUgbW9kdWxlIGlzIDAuNy40IG9yIGxhdGVyLiBFbHNlLCAkZmFsc2UuCgouREVTQ1JJUFRJT04KVGVzdC1BenVyZU1vZHVsZVZlcnNpb24gcmV0dXJucyAkdHJ1ZSBpZiB0aGUgdmVyc2lvbiBvZiB0aGUgQXp1cmUgbW9kdWxlIGlzIDAuNy40IG9yIGxhdGVyLiBJdCByZXR1cm5zICRmYWxzZSBpZiB0aGUgbW9kdWxlIGlzbid0IGluc3RhbGxlZCBvciBpcyBhbiBlYXJsaWVyIHZlcnNpb24uIFRoaXMgZnVuY3Rpb24gaGFzIG5vIHBhcmFtZXRlcnMuCgouSU5QVVRTCk5vbmUKCi5PVVRQVVRTClN5c3RlbS5Cb29sZWFuCgouRVhBTVBMRQpQUyBDOlw+IEdldC1Nb2R1bGUgQXp1cmUgLUxpc3RBdmFpbGFibGUKUFMgQzpcPiAjTm8gbW9kdWxlClBTIEM6XD4gVGVzdC1BenVyZU1vZHVsZVZlcnNpb24KRmFsc2UKCi5FWEFNUExFClBTIEM6XD4gKEdldC1Nb2R1bGUgQXp1cmUgLUxpc3RBdmFpbGFibGUpLlZlcnNpb24KCk1ham9yICBNaW5vciAgQnVpbGQgIFJldmlzaW9uCi0tLS0tICAtLS0tLSAgLS0tLS0gIC0tLS0tLS0tCjAgICAgICA3ICAgICAgNCAgICAgIC0xCgpQUyBDOlw+IFRlc3QtQXp1cmVNb2R1bGVWZXJzaW9uClRydWUKCi5MSU5LCkdldC1Nb2R1bGUKCi5MSU5LClBTTW9kdWxlSW5mbyBvYmplY3QgKGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9zeXN0ZW0ubWFuYWdlbWVudC5hdXRvbWF0aW9uLnBzbW9kdWxlaW5mbyh2PXZzLjg1KS5hc3B4KQojPgpmdW5jdGlvbiBUZXN0LUF6dXJlTW9kdWxlVmVyc2lvbgp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5WZXJzaW9uXQogICAgICAgICRWZXJzaW9uCiAgICApCgogICAgcmV0dXJuICgkVmVyc2lvbi5NYWpvciAtZ3QgMCkgLW9yICgkVmVyc2lvbi5NaW5vciAtZ3QgNykgLW9yICgkVmVyc2lvbi5NaW5vciAtZXEgNyAtYW5kICRWZXJzaW9uLkJ1aWxkIC1nZSA0KQp9CgoKPCMKLlNZTk9QU0lTClJldHVybnMgJHRydWUgaWYgdGhlIGluc3RhbGxlZCBBenVyZSBtb2R1bGUgdmVyc2lvbiBpcyAwLjcuNCBvciBsYXRlci4KCi5ERVNDUklQVElPTgpUZXN0LUF6dXJlTW9kdWxlIHJldHVybnMgJHRydWUgaWYgdGhlIGluc3RhbGxlZCBBenVyZSBtb2R1bGUgdmVyc2lvbiBpcyAwLjcuNCBvciBsYXRlci4gUmV0dXJucyAkZmFsc2UgaWYgdGhlIG1vZHVsZSBpc24ndCBpbnN0YWxsZWQgb3IgaXMgYW4gZWFybGllciB2ZXJzaW9uLiBUaGlzIGZ1bmN0aW9uIGhhcyBubyBwYXJhbWV0ZXJzLgoKLklOUFVUUwpOb25lCgouT1VUUFVUUwpTeXN0ZW0uQm9vbGVhbgoKLkVYQU1QTEUKUFMgQzpcPiBHZXQtTW9kdWxlIEF6dXJlIC1MaXN0QXZhaWxhYmxlClBTIEM6XD4gI05vIG1vZHVsZQpQUyBDOlw+IFRlc3QtQXp1cmVNb2R1bGUKRmFsc2UKCi5FWEFNUExFClBTIEM6XD4gKEdldC1Nb2R1bGUgQXp1cmUgLUxpc3RBdmFpbGFibGUpLlZlcnNpb24KCk1ham9yICBNaW5vciAgQnVpbGQgIFJldmlzaW9uCi0tLS0tICAtLS0tLSAgLS0tLS0gIC0tLS0tLS0tCiAgICAwICAgICAgNyAgICAgIDQgICAgICAtMQoKUFMgQzpcPiBUZXN0LUF6dXJlTW9kdWxlClRydWUKCi5MSU5LCkdldC1Nb2R1bGUKCi5MSU5LClBTTW9kdWxlSW5mbyBvYmplY3QgKGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9zeXN0ZW0ubWFuYWdlbWVudC5hdXRvbWF0aW9uLnBzbW9kdWxlaW5mbyh2PXZzLjg1KS5hc3B4KQojPgpmdW5jdGlvbiBUZXN0LUF6dXJlTW9kdWxlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCgogICAgJG1vZHVsZSA9IEdldC1Nb2R1bGUgLU5hbWUgQXp1cmUKCiAgICBpZiAoISRtb2R1bGUpCiAgICB7CiAgICAgICAgJG1vZHVsZSA9IEdldC1Nb2R1bGUgLU5hbWUgQXp1cmUgLUxpc3RBdmFpbGFibGUKCiAgICAgICAgaWYgKCEkbW9kdWxlIC1vciAhKFRlc3QtQXp1cmVNb2R1bGVWZXJzaW9uICRtb2R1bGUuVmVyc2lvbikpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJGZhbHNlOwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ0NvbnRpbnVlJwogICAgICAgICAgICBJbXBvcnQtTW9kdWxlIC1OYW1lIEF6dXJlIC1HbG9iYWwgLVZlcmJvc2U6JGZhbHNlCiAgICAgICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU3RvcCcKCiAgICAgICAgICAgIHJldHVybiAkdHJ1ZQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICByZXR1cm4gKFRlc3QtQXp1cmVNb2R1bGVWZXJzaW9uICRtb2R1bGUuVmVyc2lvbikKICAgIH0KfQoKCjwjCi5TWU5PUFNJUwpTYXZlcyB0aGUgY3VycmVudCBXaW5kb3dzIEF6dXJlIHN1YnNjcmlwdGlvbiBpbiB0aGUgJFNjcmlwdDpvcmlnaW5hbFN1YnNjcmlwdGlvbiB2YXJpYWJsZSBpbiBzY3JpcHQgc2NvcGUuCgouREVTQ1JJUFRJT04KVGhlIEJhY2t1cC1TdWJzY3JpcHRpb24gZnVuY3Rpb24gc2F2ZXMgdGhlIGN1cnJlbnQgV2luZG93cyBBenVyZSBzdWJzY3JpcHRpb24gKEdldC1BenVyZVN1YnNjcmlwdGlvbiAtQ3VycmVudCkgYW5kIGl0cyBzdG9yYWdlIGFjY291bnQsIGFuZCB0aGUgc3Vic2NyaXB0aW9uIHRoYXQgaXMgY2hhbmdlZCBieSB0aGlzIHNjcmlwdCAoJFVzZXJTcGVjaWZpZWRTdWJzY3JpcHRpb24pIGFuZCBpdHMgc3RvcmFnZSBhY2NvdW50LCBpbiBzY3JpcHQgc2NvcGUuIEJ5IHNhdmluZyB0aGUgdmFsdWVzLCB5b3UgY2FuIHVzZSBhIGZ1bmN0aW9uLCBzdWNoIGFzIFJlc3RvcmUtU3Vic2NyaXB0aW9uLCB0byByZXN0b3JlIHRoZSBvcmlnaW5hbCBjdXJyZW50IHN1YnNjcmlwdGlvbiBhbmQgc3RvcmFnZSBhY2NvdW50IHRvIGN1cnJlbnQgc3RhdHVzIGlmIHRoZSBjdXJyZW50IHN0YXR1cyBoYXMgY2hhbmdlZC4KCi5QQVJBTUVURVIgVXNlclNwZWNpZmllZFN1YnNjcmlwdGlvbgpTcGVjaWZpZXMgdGhlIG5hbWUgb2YgdGhlIHN1YnNjcmlwdGlvbiBpbiB3aGljaCB0aGUgbmV3IHJlc291cmNlcyB3aWxsIGJlIGNyZWF0ZWQgYW5kIHB1Ymxpc2hlZC4gVGhlIGZ1bmN0aW9uIHNhdmVzIHRoZSBuYW1lcyBvZiB0aGUgc3Vic2NyaXB0aW9uIGFuZCBpdHMgc3RvcmFnZSBhY2NvdW50cyBpbiBzY3JpcHQgc2NvcGUuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLklOUFVUUwpOb25lCgouT1VUUFVUUwpOb25lCgouRVhBTVBMRQpQUyBDOlw+IEJhY2t1cC1TdWJzY3JpcHRpb24gLVVzZXJTcGVjaWZpZWRTdWJzY3JpcHRpb24gQ29udG9zbwpQUyBDOlw+CgouRVhBTVBMRQpQUyBDOlw+IEJhY2t1cC1TdWJzY3JpcHRpb24gLVVzZXJTcGVjaWZpZWRTdWJzY3JpcHRpb24gQ29udG9zbyAtVmVyYm9zZQpWRVJCT1NFOiBCYWNrdXAtU3Vic2NyaXB0aW9uOiBTdGFydApWRVJCT1NFOiBCYWNrdXAtU3Vic2NyaXB0aW9uOiBPcmlnaW5hbCBzdWJzY3JpcHRpb24gaXMgV2luZG93cyBBenVyZSBNU0ROIC0gVmlzdWFsIFN0dWRpbyBVbHRpbWF0ZQpWRVJCT1NFOiBCYWNrdXAtU3Vic2NyaXB0aW9uOiBFbmQKIz4KZnVuY3Rpb24gQmFja3VwLVN1YnNjcmlwdGlvbgp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbQWxsb3dFbXB0eVN0cmluZygpXQogICAgICAgIFtzdHJpbmddCiAgICAgICAgJFVzZXJTcGVjaWZpZWRTdWJzY3JpcHRpb24KICAgICkKCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ0JhY2t1cC1TdWJzY3JpcHRpb246IFN0YXJ0JwoKICAgICRTY3JpcHQ6b3JpZ2luYWxDdXJyZW50U3Vic2NyaXB0aW9uID0gR2V0LUF6dXJlU3Vic2NyaXB0aW9uIC1DdXJyZW50IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICBpZiAoJFNjcmlwdDpvcmlnaW5hbEN1cnJlbnRTdWJzY3JpcHRpb24pCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICgnQmFja3VwLVN1YnNjcmlwdGlvbjogT3JpZ2luYWwgc3Vic2NyaXB0aW9uIGlzICcgKyAkU2NyaXB0Om9yaWdpbmFsQ3VycmVudFN1YnNjcmlwdGlvbi5TdWJzY3JpcHRpb25OYW1lKQogICAgICAgICRTY3JpcHQ6b3JpZ2luYWxDdXJyZW50U3RvcmFnZUFjY291bnQgPSAkU2NyaXB0Om9yaWdpbmFsQ3VycmVudFN1YnNjcmlwdGlvbi5DdXJyZW50U3RvcmFnZUFjY291bnROYW1lCiAgICB9CiAgICAKICAgICRTY3JpcHQ6dXNlclNwZWNpZmllZFN1YnNjcmlwdGlvbiA9ICRVc2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uCiAgICBpZiAoJFNjcmlwdDp1c2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uKQogICAgeyAgICAgICAgCiAgICAgICAgJHVzZXJTdWJzY3JpcHRpb24gPSBHZXQtQXp1cmVTdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbk5hbWUgJFNjcmlwdDp1c2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgaWYgKCR1c2VyU3Vic2NyaXB0aW9uKQogICAgICAgIHsKICAgICAgICAgICAgJFNjcmlwdDpvcmlnaW5hbFN0b3JhZ2VBY2NvdW50T2ZVc2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uID0gJHVzZXJTdWJzY3JpcHRpb24uQ3VycmVudFN0b3JhZ2VBY2NvdW50TmFtZQogICAgICAgIH0gICAgICAgIAogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQmFja3VwLVN1YnNjcmlwdGlvbjogRW5kJwp9CgoKPCMKLlNZTk9QU0lTClJlc3RvcmVzIHRvICJjdXJyZW50IiBzdGF0dXMgdGhlIFdpbmRvd3MgQXp1cmUgc3Vic2NyaXB0aW9uIHRoYXQgaXMgc2F2ZWQgaW4gdGhlICRTY3JpcHQ6b3JpZ2luYWxTdWJzY3JpcHRpb24gdmFyaWFibGUgaW4gc2NyaXB0IHNjb3BlLgoKLkRFU0NSSVBUSU9OClRoZSBSZXN0b3JlLVN1YnNjcmlwdGlvbiBmdW5jdGlvbiBtYWtlcyB0aGUgc3Vic2NyaXB0aW9uIHRoYXQgaXMgc2F2ZWQgaW4gdGhlICRTY3JpcHQ6b3JpZ2luYWxTdWJzY3JpcHRpb24gdmFyaWFibGUgdGhlIGN1cnJlbnQgc3Vic2NyaXB0aW9uIChhZ2FpbikuIElmIHRoZSBvcmlnaW5hbCBzdWJzY3JpcHRpb24gaGFzIGEgc3RvcmFnZSBhY2NvdW50LCB0aGlzIGZ1bmN0aW9uIG1ha2VzIHRoYXQgc3RvcmFnZSBhY2NvdW50IGN1cnJlbnQgZm9yIHRoZSBjdXJyZW50IHN1YnNjcmlwdGlvbi4gIFRoZSBmdW5jdGlvbiByZXN0b3JlcyB0aGUgc3Vic2NyaXB0aW9uIG9ubHkgaWYgdGhlcmUgaXMgYSBub24tbnVsbCAkU3Vic2NyaXB0aW9uTmFtZSB2YXJpYWJsZSBpbiB0aGUgZW52aXJvbm1lbnQuIE90aGVyd2lzZSwgaXQgZXhpdHMuICBJZiB0aGUgJFN1YnNjcmlwdGlvbk5hbWUgaXMgcG9wdWxhdGVkLCBidXQgJFNjcmlwdDpvcmlnaW5hbFN1YnNjcmlwdGlvbiBpcyAkbnVsbCwgUmVzdG9yZS1TdWJzY3JpcHRpb24gdXNlcyB0aGUgU2VsZWN0LUF6dXJlU3Vic2NyaXB0aW9uIGNtZGxldCB0byBjbGVhciB0aGUgQ3VycmVudCBhbmQgRGVmYXVsdCBzZXR0aW5ncyBmb3Igc3Vic2NyaXB0aW9ucyBpbiBXaW5kb3dzIEF6dXJlIFBvd2VyU2hlbGwuICBUaGlzIGZ1bmN0aW9uIGRvZXNuJ3QgaGF2ZSBwYXJhbWV0ZXJzLCBpdCB0YWtlcyBubyBpbnB1dCwgYW5kIGl0IHJldHVybnMgbm90aGluZyAodm9pZCkuIFlvdSBjYW4gdXNlIC1WZXJib3NlIHRvIHdyaXRlIG1lc3NhZ2VzIHRvIHRoZSBWZXJib3NlIHN0cmVhbS4KCi5JTlBVVFMKTm9uZQoKLk9VVFBVVFMKTm9uZQoKLkVYQU1QTEUKUFMgQzpcPiBSZXN0b3JlLVN1YnNjcmlwdGlvbgpQUyBDOlw+CgouRVhBTVBMRQpQUyBDOlw+IFJlc3RvcmUtU3Vic2NyaXB0aW9uIC1WZXJib3NlClZFUkJPU0U6IFJlc3RvcmUtU3Vic2NyaXB0aW9uOiBTdGFydApWRVJCT1NFOiBSZXN0b3JlLVN1YnNjcmlwdGlvbjogRW5kCiM+CmZ1bmN0aW9uIFJlc3RvcmUtU3Vic2NyaXB0aW9uCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgpCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdSZXN0b3JlLVN1YnNjcmlwdGlvbjogU3RhcnQnCgogICAgaWYgKCRTY3JpcHQ6b3JpZ2luYWxDdXJyZW50U3Vic2NyaXB0aW9uKQogICAgewogICAgICAgIGlmICgkU2NyaXB0Om9yaWdpbmFsQ3VycmVudFN0b3JhZ2VBY2NvdW50KQogICAgICAgIHsKICAgICAgICAgICAgU2V0LUF6dXJlU3Vic2NyaXB0aW9uIGAKICAgICAgICAgICAgICAgIC1TdWJzY3JpcHRpb25OYW1lICRTY3JpcHQ6b3JpZ2luYWxDdXJyZW50U3Vic2NyaXB0aW9uLlN1YnNjcmlwdGlvbk5hbWUgYAogICAgICAgICAgICAgICAgLUN1cnJlbnRTdG9yYWdlQWNjb3VudE5hbWUgJFNjcmlwdDpvcmlnaW5hbEN1cnJlbnRTdG9yYWdlQWNjb3VudAogICAgICAgIH0KCiAgICAgICAgU2VsZWN0LUF6dXJlU3Vic2NyaXB0aW9uIC1TdWJzY3JpcHRpb25OYW1lICRTY3JpcHQ6b3JpZ2luYWxDdXJyZW50U3Vic2NyaXB0aW9uLlN1YnNjcmlwdGlvbk5hbWUKICAgIH0KICAgIGVsc2UgCiAgICB7CiAgICAgICAgU2VsZWN0LUF6dXJlU3Vic2NyaXB0aW9uIC1Ob0N1cnJlbnQKICAgICAgICBTZWxlY3QtQXp1cmVTdWJzY3JpcHRpb24gLU5vRGVmYXVsdAogICAgfQogICAgCiAgICBpZiAoJFNjcmlwdDp1c2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uIC1hbmQgJFNjcmlwdDpvcmlnaW5hbFN0b3JhZ2VBY2NvdW50T2ZVc2VyU3BlY2lmaWVkU3Vic2NyaXB0aW9uKQogICAgewogICAgICAgIFNldC1BenVyZVN1YnNjcmlwdGlvbiBgCiAgICAgICAgICAgIC1TdWJzY3JpcHRpb25OYW1lICRTY3JpcHQ6dXNlclNwZWNpZmllZFN1YnNjcmlwdGlvbiBgCiAgICAgICAgICAgIC1DdXJyZW50U3RvcmFnZUFjY291bnROYW1lICRTY3JpcHQ6b3JpZ2luYWxTdG9yYWdlQWNjb3VudE9mVXNlclNwZWNpZmllZFN1YnNjcmlwdGlvbgogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnUmVzdG9yZS1TdWJzY3JpcHRpb246IEVuZCcKfQoKPCMKLlNZTk9QU0lTCkZpbmRzIGEgV2luZG93cyBBenVyZSBzdG9yYWdlIGFjY291bnQgbmFtZWQgImRldnRlc3QqIiBpbiB0aGUgY3VycmVudCBzdWJzY3JpcHRpb24uCgouREVTQ1JJUFRJT04KVGhlIEdldC1BenVyZVZNU3RvcmFnZSBmdW5jdGlvbiByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBzdG9yYWdlIGFjY291bnQgd2l0aCB0aGUgbmFtZSBwYXR0ZXJuICJkZXZ0ZXN0KiIgKGNhc2UgaW5zZW5zaXRpdmUpIGluIHRoZSBzcGVjaWZpZWQgbG9jYXRpb24gb3IgYWZmaW5pdHkgZ3JvdXAuIElmIHRoZSAiZGV2dGVzdCoiIHN0b3JhZ2UgYWNjb3VudCBkb2VzIG5vdCBtYXRjaCB0aGUgbG9jYXRpb24gb3IgYWZmaW5pdHkgZ3JvdXAsIHRoZSBmdW5jdGlvbiBpZ25vcmVzIGl0LiBZb3UgbXVzdCBzcGVjaWZ5IGVpdGhlciBhIGxvY2F0aW9uIG9yIGFuIGFmZmluaXR5IGdyb3VwLgoKLlBBUkFNRVRFUiAgTG9jYXRpb24KU3BlY2lmaWVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgc3RvcmFnZSBhY2NvdW50LiBWYWxpZCB2YWx1ZXMgYXJlIHRoZSBXaW5kb3dzIEF6dXJlIGxvY2F0aW9ucywgc3VjaCBhcyAiV2VzdCBVUyIuIFlvdSBjYW4gZW50ZXIgYSBsb2NhdGlvbiBvciBhbiBhZmZpbml0eSBncm91cCwgYnV0IG5vdCBib3RoLgoKLlBBUkFNRVRFUiAgQWZmaW5pdHlHcm91cApTcGVjaWZpZXMgdGhlIGFmZmluaXR5IGdyb3VwIG9mIHRoZSBzdG9yYWdlIGFjY291bnQuIFlvdSBjYW4gZW50ZXIgYSBsb2NhdGlvbiBvciBhbiBhZmZpbml0eSBncm91cCwgYnV0IG5vdCBib3RoLgoKLklOUFVUUwpOb25lLiBZb3UgY2Fubm90IHBpcGUgaW5wdXQgdG8gdGhpcyBmdW5jdGlvbi4KCi5PVVRQVVRTClN5c3RlbS5TdHJpbmcKCi5FWEFNUExFClBTIEM6XD4gR2V0LUF6dXJlVk1TdG9yYWdlIC1Mb2NhdGlvbiAiRWFzdCBVUyIKZGV2dGVzdDMtZmFicmljYW0KCi5FWEFNUExFClBTIEM6XD4gR2V0LUF6dXJlVk1TdG9yYWdlIC1BZmZpbml0eUdyb3VwIEZpbmFuY2UKUFMgQzpcPgoKLkVYQU1QTEVcClBTIEM6XD4gR2V0LUF6dXJlVk1TdG9yYWdlIC1BZmZpbml0eUdyb3VwIEZpbmFuY2UgLVZlcmJvc2UKVkVSQk9TRTogR2V0LUF6dXJlVk1TdG9yYWdlOiBTdGFydApWRVJCT1NFOiBHZXQtQXp1cmVWTVN0b3JhZ2U6IEVuZAoKLkxJTksKR2V0LUF6dXJlU3RvcmFnZUFjY291bnQKIz4KZnVuY3Rpb24gR2V0LUF6dXJlVk1TdG9yYWdlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBhcmFtZXRlclNldE5hbWUgPSAnTG9jYXRpb24nKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRMb2NhdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZSA9ICdBZmZpbml0eUdyb3VwJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQWZmaW5pdHlHcm91cAogICAgKQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnR2V0LUF6dXJlVk1TdG9yYWdlOiBTdGFydCcKCiAgICAkc3RvcmFnZXMgPSBAKEdldC1BenVyZVN0b3JhZ2VBY2NvdW50IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKQogICAgJHN0b3JhZ2VOYW1lID0gJG51bGwKCiAgICBmb3JlYWNoICgkc3RvcmFnZSBpbiAkc3RvcmFnZXMpCiAgICB7CiAgICAgICAgIyBHZXQgdGhlIGZpcnN0IHN0b3JhZ2UgYWNjb3VudCB3aG9zZSBuYW1lIGJlZ2lucyB3aXRoICJkZXZ0ZXN0IgogICAgICAgIGlmICgkc3RvcmFnZS5MYWJlbCAtbGlrZSAnZGV2dGVzdConKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRzdG9yYWdlLkFmZmluaXR5R3JvdXAgLWVxICRBZmZpbml0eUdyb3VwIC1vciAkc3RvcmFnZS5Mb2NhdGlvbiAtZXEgJExvY2F0aW9uKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc3RvcmFnZU5hbWUgPSAkc3RvcmFnZS5MYWJlbAoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0V2l0aFRpbWUgKCdHZXQtQXp1cmVWTVN0b3JhZ2U6IEZvdW5kIGRldnRlc3Qgc3RvcmFnZSBhY2NvdW50ICcgKyAkc3RvcmFnZU5hbWUpCiAgICAgICAgICAgICAgICAgICAgJHN0b3JhZ2UgfCBPdXQtU3RyaW5nIHwgV3JpdGUtVmVyYm9zZVdpdGhUaW1lCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnR2V0LUF6dXJlVk1TdG9yYWdlOiBFbmQnCiAgICByZXR1cm4gJHN0b3JhZ2VOYW1lCn0KCgo8IwouU1lOT1BTSVMKQ3JlYXRlcyBhIG5ldyBXaW5kb3dzIEF6dXJlIHN0b3JhZ2UgYWNjb3VudCB3aXRoIGEgdW5pcXVlIG5hbWUgdGhhdCBiZWdpbnMgd2l0aCAiZGV2dGVzdCIuCgouREVTQ1JJUFRJT04KVGhlIEFkZC1BenVyZVZNU3RvcmFnZSBmdW5jdGlvbiBjcmVhdGVzIGEgbmV3IFdpbmRvd3MgQXp1cmUgc3RvcmFnZSBhY2NvdW50IGluIHRoZSBjdXJyZW50IHN1YnNjcmlwdGlvbi4gVGhlIG5hbWUgb2YgdGhlIGFjY291bnQgYmVnaW5zIHdpdGggImRldnRlc3QiIGZvbGxvd2VkIGJ5IGEgdW5pcXVlIGFscGhhbnVtZXJpYyBzdHJpbmcuIFRoZSBmdW5jdGlvbiByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBuZXcgc3RvcmFnZSBhY2NvdW50LiBZb3UgbXVzdCBzcGVjaWZ5IGVpdGhlciBhIGxvY2F0aW9uIG9yIGFuIGFmZmluaXR5IGdyb3VwIGZvciB0aGUgbmV3IHN0b3JhZ2UgYWNjb3VudC4KCi5QQVJBTUVURVIgIExvY2F0aW9uClNwZWNpZmllcyB0aGUgbG9jYXRpb24gb2YgdGhlIHN0b3JhZ2UgYWNjb3VudC4gVmFsaWQgdmFsdWVzIGFyZSB0aGUgV2luZG93cyBBenVyZSBsb2NhdGlvbnMsIHN1Y2ggYXMgIldlc3QgVVMiLiBZb3UgY2FuIGVudGVyIGEgbG9jYXRpb24gb3IgYW4gYWZmaW5pdHkgZ3JvdXAsIGJ1dCBub3QgYm90aC4KCi5QQVJBTUVURVIgIEFmZmluaXR5R3JvdXAKU3BlY2lmaWVzIHRoZSBhZmZpbml0eSBncm91cCBvZiB0aGUgc3RvcmFnZSBhY2NvdW50LiBZb3UgY2FuIGVudGVyIGEgbG9jYXRpb24gb3IgYW4gYWZmaW5pdHkgZ3JvdXAsIGJ1dCBub3QgYm90aC4KCi5JTlBVVFMKTm9uZS4gWW91IGNhbm5vdCBwaXBlIGlucHV0IHRvIHRoaXMgZnVuY3Rpb24uCgouT1VUUFVUUwpTeXN0ZW0uU3RyaW5nLiBUaGUgc3RyaW5nIGlzIHRoZSBuYW1lIG9mIHRoZSBuZXcgc3RvcmFnZSBhY2NvdW50CgouRVhBTVBMRQpQUyBDOlw+IEFkZC1BenVyZVZNU3RvcmFnZSAtTG9jYXRpb24gIkVhc3QgQXNpYSIKZGV2dGVzdGQ2YjQ1ZTIzYTZkZDRiZGFiCgouRVhBTVBMRQpQUyBDOlw+IEFkZC1BenVyZVZNU3RvcmFnZSAtQWZmaW5pdHlHcm91cCBGaW5hbmNlCmRldnRlc3RkNmI0NWUyM2E2ZGQ0YmRhYgoKLkVYQU1QTEUKUFMgQzpcPiBBZGQtQXp1cmVWTVN0b3JhZ2UgLUFmZmluaXR5R3JvdXAgRmluYW5jZSAtVmVyYm9zZQpWRVJCT1NFOiBBZGQtQXp1cmVWTVN0b3JhZ2U6IFN0YXJ0ClZFUkJPU0U6IEFkZC1BenVyZVZNU3RvcmFnZTogQ3JlYXRlZCBuZXcgc3RvcmFnZSBhY2Njb3VudCBkZXZ0ZXN0ZDZiNDVlMjNhNmRkNGJkYWIiClZFUkJPU0U6IEFkZC1BenVyZVZNU3RvcmFnZTogRW5kCmRldnRlc3RkNmI0NWUyM2E2ZGQ0YmRhYgoKLkxJTksKTmV3LUF6dXJlU3RvcmFnZUFjY291bnQKIz4KZnVuY3Rpb24gQWRkLUF6dXJlVk1TdG9yYWdlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBhcmFtZXRlclNldE5hbWUgPSAnTG9jYXRpb24nKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRMb2NhdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZSA9ICdBZmZpbml0eUdyb3VwJyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQWZmaW5pdHlHcm91cAogICAgKQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlVk1TdG9yYWdlOiBTdGFydCcKCiAgICAjIENyZWF0ZSBhIHVuaXF1ZSBuYW1lIGJ5IGFwcGVuZGluZyBwYXJ0IG9mIGEgR1VJRCB0byAiZGV2dGVzdCIKICAgICRuYW1lID0gJ2RldnRlc3QnCiAgICAkc3VmZml4ID0gW2d1aWRdOjpOZXdHdWlkKCkuVG9TdHJpbmcoJ04nKS5TdWJzdHJpbmcoMCwyNCAtICRuYW1lLkxlbmd0aCkKICAgICRuYW1lID0gJG5hbWUgKyAkc3VmZml4CgogICAgIyBDcmVhdGUgYSBuZXcgV2luZG93cyBBenVyZSBzdG9yYWdlIGFjY291bnQgd2l0aCBsb2NhdGlvbi9hZmZpbml0eSBncm91cAogICAgaWYgKCRQU0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAnTG9jYXRpb24nKQogICAgewogICAgICAgIE5ldy1BenVyZVN0b3JhZ2VBY2NvdW50IC1TdG9yYWdlQWNjb3VudE5hbWUgJG5hbWUgLUxvY2F0aW9uICRMb2NhdGlvbiB8IE91dC1OdWxsCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgTmV3LUF6dXJlU3RvcmFnZUFjY291bnQgLVN0b3JhZ2VBY2NvdW50TmFtZSAkbmFtZSAtQWZmaW5pdHlHcm91cCAkQWZmaW5pdHlHcm91cCB8IE91dC1OdWxsCiAgICB9CgogICAgV3JpdGUtSG9zdFdpdGhUaW1lICgiQWRkLUF6dXJlVk1TdG9yYWdlOiAgQ3JlYXRlZCBuZXcgc3RvcmFnZSBhY2Njb3VudCAkbmFtZSIpCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ0FkZC1BenVyZVZNU3RvcmFnZTogRW5kJwogICAgcmV0dXJuICRuYW1lCn0KCgo8IwouU1lOT1BTSVMKVmFsaWRhdGVzIHRoZSBjb25maWcgZmlsZSBhbmQgcmV0dXJucyBhIGhhc2h0YWJsZSBvZiBjb25maWcgZmlsZSB2YWx1ZXMuCgouREVTQ1JJUFRJT04KVGhlIFJlYWQtQ29uZmlnRmlsZSBmdW5jdGlvbiB2YWxpZGF0ZXMgdGhlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIGFuZCByZXR1cm5zIGEgaGFzaCB0YWJsZSBvZiBzZWxlY3RlZCB2YWx1ZXMuCi0tIEl0IGJlZ2lucyBieSBjb252ZXJ0aW5nIHRoZSBKU09OIGZpbGUgdG8gYSBQU0N1c3RvbU9iamVjdC4KLS0gSXQgdmVyaWZpZXMgdGhhdCB0aGUgZW52aXJvbm1lbnRTZXR0aW5ncyBwcm9wZXJ0eSBjb250YWlucyBlaXRoZXIgYSB3ZWIgc2l0ZSBvciBjbG91ZCBzZXJ2aWNlIHByb3BlcnR5LCBidXQgbm90IGJvdGguCi0tIENyZWF0ZXMgYW5kIHJldHVybnMgb25lIG9mIHR3byB0eXBlcyBvZiBoYXNoIHRhYmxlczsgb25lIGZvciBhIHdlYiBzaXRlOyBvbmUgZm9yIGEgY2xvdWQgc2VydmljZS4gVGhlIHdlYiBzaXRlIGhhc2ggdGFibGUgaGFzIHRoZSBmb2xsb3dpbmcga2V5czoKLS0gSXNBenVyZVdlYlNpdGU6ICRUcnVlLiBUaGUgY29uZmlnIGZpbGUgaXMgZm9yIGEgd2ViIHNpdGUuIAotLSBOYW1lOiBXZWIgc2l0ZSBuYW1lCi0tIExvY2F0aW9uOiBXZWIgc2l0ZSBsb2NhdGlvbgotLSBEYXRhYmFzZXM6IFdlYiBzaXRlIFNRTCBkYXRhYmFzZXMKVGhlIGNsb3VkIHNlcnZpY2UgaGFzaCB0YWJsZSBoYXMgdGhlIGZvbGxvd2luZyBrZXlzOgotLSBJc0F6dXJlV2ViU2l0ZTogJEZhbHNlLiBUaGUgY29uZmlnIGZpbGUgaXMgbm90IGZvciBhIHdlYnNpdGUuCi0tIHdlYmRlcGxveXBhcmFtZXRlcnMgOiBPcHRpb25hbC4gTWlnaHQgYmUgJG51bGwgb3IgZW1wdHkuCi0tIERhdGFiYXNlczogU1FMIGRhdGFiYXNlcwoKLlBBUkFNRVRFUiAgQ29uZmlndXJhdGlvbkZpbGUKU3BlY2lmaWVzIHRoZSBwYXRoIGFuZCBuYW1lIG9mIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgeW91ciB3ZWIgcHJvamVjdC4gVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMgdGhlIEpTT04gZmlsZSBhdXRvbWF0aWNhbGx5IHdoZW4geW91IGNyZWF0ZSBhIHdlYiBwcm9qZWN0IGFuZCBzdG9yZXMgaXQgaW4gdGhlIFB1Ymxpc2hTY3JpcHRzIGZvbGRlciBpbiB5b3VyIHNvbHV0aW9uLgoKLlBBUkFNRVRFUiBIYXNXZWJEZXBsb3lQYWNrYWdlCkluZGljYXRlcyB0aGF0IHRoZXJlIGlzIGEgd2ViIGRlcGxveSBwYWNrYWdlIFpJUCBmaWxlIGZvciB0aGUgd2ViIGFwcGxpY2F0aW9uLiBUbyBzcGVjaWZ5IGEgdmFsdWUgb2YgJHRydWUsIHVzZSAtSGFzV2ViRGVwbG95UGFja2FnZSBvciBIYXNXZWJEZXBsb3lQYWNrYWdlOiR0cnVlLiBUbyBzcGVjaWZ5IGEgdmFsdWUgb2YgZmFsc2UsIHVzZSBIYXNXZWJEZXBsb3lQYWNrYWdlOiRmYWxzZS5UaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5JTlBVVFMKTm9uZS4gWW91IGNhbm5vdCBwaXBlIGlucHV0IHRvIHRoaXMgZnVuY3Rpb24uCgouT1VUUFVUUwpTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlCgouRVhBTVBMRQpQUyBDOlw+IFJlYWQtQ29uZmlnRmlsZSAtQ29uZmlndXJhdGlvbkZpbGUgPHBhdGg+IC1IYXNXZWJEZXBsb3lQYWNrYWdlCgoKTmFtZSAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi0tLS0gICAgICAgICAgICAgICAgICAgICAgICAgICAtLS0tLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApkYXRhYmFzZXMgICAgICAgICAgICAgICAgICAgICAge0B7Y29ubmVjdGlvblN0cmluZ05hbWU9OyBkYXRhYmFzZU5hbWU9OyBzZXJ2ZXJOYW1lPTsgdXNlcj07IHBhc3N3b3JkPX19ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKY2xvdWRTZXJ2aWNlICAgICAgICAgICAgICAgICAgIEB7bmFtZT1hc2RmaGw7IGFmZmluaXR5R3JvdXA9c3RlcGh3ZTFhZzFjdXM7IGxvY2F0aW9uPTsgdmlydHVhbE5ldHdvcms9OyBzdWJuZXQ9OyBhdmFpbGFiaWxpdHlTZXQ9OyB2aXJ0dWFsTWFjaGluZT19ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCklzV0FXUyAgICAgICAgICAgICAgICAgICAgICAgICBGYWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAp3ZWJEZXBsb3lQYXJhbWV0ZXJzICAgICAgICAgICAgQHtpaXNXZWJBcHBsaWNhdGlvbk5hbWU9RGVmYXVsdCBXZWIgU2l0ZX0gCiM+CmZ1bmN0aW9uIFJlYWQtQ29uZmlnRmlsZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtUGF0aCAkXyAtUGF0aFR5cGUgTGVhZn0pXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbmZpZ3VyYXRpb25GaWxlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3dpdGNoXQogICAgICAgICRIYXNXZWJEZXBsb3lQYWNrYWdlCSAgICAKICAgICkKCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ1JlYWQtQ29uZmlnRmlsZTogU3RhcnQnCgogICAgIyBHZXQgdGhlIGNvbnRlbnRzIG9mIHRoZSBKU09OIGZpbGUgKC1yYXcgaWdub3JlcyBsaW5lIGJyZWFrcykgYW5kIGNvbnZlcnQgaXQgdG8gYSBQU0N1c3RvbU9iamVjdAogICAgJGNvbmZpZyA9IEdldC1Db250ZW50ICRDb25maWd1cmF0aW9uRmlsZSAtUmF3IHwgQ29udmVydEZyb20tSnNvbgoKICAgIGlmICghJGNvbmZpZykKICAgIHsKICAgICAgICB0aHJvdyAoJ1JlYWQtQ29uZmlnRmlsZTogQ29udmVydEZyb20tSnNvbiBmYWlsZWQ6ICcgKyAkZXJyb3JbMF0pCiAgICB9CgogICAgIyBEZXRlcm1pbmUgd2hldGhlciB0aGUgZW52aXJvbm1lbnRTZXR0aW5ncyBvYmplY3QgaGFzICd3ZWJTaXRlJyBvciAnY2xvdWRTZXJ2aWNlJyBwcm9wZXJ0aWVzIChyZWdhcmRsZXNzIG9mIHRoZSBwcm9wZXJ0eSB2YWx1ZSkKICAgICRoYXNXZWJzaXRlUHJvcGVydHkgPSAgVGVzdC1NZW1iZXIgLU9iamVjdCAkY29uZmlnLmVudmlyb25tZW50U2V0dGluZ3MgLU1lbWJlciAnd2ViU2l0ZScKICAgICRoYXNDbG91ZFNlcnZpY2VQcm9wZXJ0eSA9IFRlc3QtTWVtYmVyIC1PYmplY3QgJGNvbmZpZy5lbnZpcm9ubWVudFNldHRpbmdzIC1NZW1iZXIgJ2Nsb3VkU2VydmljZScKCiAgICBpZiAoISRoYXNXZWJzaXRlUHJvcGVydHkgLWFuZCAhJGhhc0Nsb3VkU2VydmljZVByb3BlcnR5KQogICAgewogICAgICAgIHRocm93ICdSZWFkLUNvbmZpZ0ZpbGU6IE1hbGZvcm1lZCBjb25maWd1cmF0aW9uIGZpbGUuIERvZXMgbm90IGhhdmUgd2ViU2l0ZSBvciBjbG91ZFNlcnZpY2UnCiAgICB9CiAgICBlbHNlaWYgKCRoYXNXZWJzaXRlUHJvcGVydHkgLWFuZCAkaGFzQ2xvdWRTZXJ2aWNlUHJvcGVydHkpCiAgICB7CiAgICAgICAgdGhyb3cgJ1JlYWQtQ29uZmlnRmlsZTogTWFsZm9ybWVkIGNvbmZpZ3VyYXRpb24gZmlsZS4gSGFzIGJvdGggd2ViU2l0ZSBhbmQgY2xvdWRTZXJ2aWNlJwogICAgfQoKICAgICMgQnVpbGQgYSBoYXNoIHRhYmxlIGZyb20gdGhlIHZhbHVlcyBpbiB0aGUgUFNDdXN0b21PYmplY3QKICAgICRyZXR1cm5PYmplY3QgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBIYXNodGFibGUKICAgICRyZXR1cm5PYmplY3QuQWRkKCdJc0F6dXJlV2ViU2l0ZScsICRoYXNXZWJzaXRlUHJvcGVydHkpCgogICAgaWYgKCRoYXNXZWJzaXRlUHJvcGVydHkpCiAgICB7CiAgICAgICAgJHJldHVybk9iamVjdC5BZGQoJ25hbWUnLCAkY29uZmlnLmVudmlyb25tZW50U2V0dGluZ3Mud2ViU2l0ZS5uYW1lKQogICAgICAgICRyZXR1cm5PYmplY3QuQWRkKCdsb2NhdGlvbicsICRjb25maWcuZW52aXJvbm1lbnRTZXR0aW5ncy53ZWJTaXRlLmxvY2F0aW9uKQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRyZXR1cm5PYmplY3QuQWRkKCdjbG91ZFNlcnZpY2UnLCAkY29uZmlnLmVudmlyb25tZW50U2V0dGluZ3MuY2xvdWRTZXJ2aWNlKQogICAgICAgIGlmICgkSGFzV2ViRGVwbG95UGFja2FnZSkKICAgICAgICB7CiAgICAgICAgICAgICRyZXR1cm5PYmplY3QuQWRkKCd3ZWJEZXBsb3lQYXJhbWV0ZXJzJywgJGNvbmZpZy5lbnZpcm9ubWVudFNldHRpbmdzLndlYmRlcGxveVBhcmFtZXRlcnMpCiAgICAgICAgfQogICAgfQoKICAgIGlmIChUZXN0LU1lbWJlciAtT2JqZWN0ICRjb25maWcuZW52aXJvbm1lbnRTZXR0aW5ncyAtTWVtYmVyICdkYXRhYmFzZXMnKQogICAgewogICAgICAgICRyZXR1cm5PYmplY3QuQWRkKCdkYXRhYmFzZXMnLCAkY29uZmlnLmVudmlyb25tZW50U2V0dGluZ3MuZGF0YWJhc2VzKQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnUmVhZC1Db25maWdGaWxlOiBFbmQnCgogICAgcmV0dXJuICRyZXR1cm5PYmplY3QKfQoKPCMKLlNZTk9QU0lTCkFkZHMgbmV3IGlucHV0IGVuZHBvaW50cyB0byBhIHZpcnR1YWwgbWFjaGluZSBhbmQgcmV0dXJucyB0aGUgdmlydHVhbCBtYWNoaW5lIHdpdGggdGhlIG5ldyBlbmRwb2ludC4KCi5ERVNDUklQVElPTgpUaGUgQWRkLUF6dXJlVk1FbmRwb2ludHMgZnVuY3Rpb24gYWRkcyBuZXcgaW5wdXQgZW5kcG9pbnRzIHRvIGEgdmlydHVhbCBtYWNoaW5lIGFuZCByZXR1cm5zIHRoZSB2aXJ0dWFsIG1hY2hpbmUgd2l0aCB0aGUgbmV3IGVuZHBvaW50cy4gVGhpcyBmdW5jdGlvbiBjYWxscyB0aGUgQWRkLUF6dXJlRW5kcG9pbnQgY21kbGV0IChBenVyZSBtb2R1bGUpLgoKLlBBUkFNRVRFUiAgVk0KU3BlY2lmaWVzIHRoZSB2aXJ0dWFsIG1hY2hpbmUgb2JqZWN0LiBFbnRlciBhbiBWTSBvYmplY3QsIHN1Y2ggYXMgdGhlIHR5cGUgdGhhdCB0aGUgTmV3LUF6dXJlVk0gb3IgR2V0LUF6dXJlVk0gY21kbGV0cyByZXR1cm4uIFlvdSBjYW4gcGlwZSBvYmplY3RzIGZyb20gR2V0LUF6dXJlVk0gdG8gQWRkLUF6dXJlVk1FbmRwb2ludHMuCgouUEFSQU1FVEVSICBFbmRwb2ludHMKU3BlY2lmaWVzIGFuIGFycmF5IG9mIGVuZHBvaW50cyB0byBhZGQgdG8gdGhlIFZNLiBUeXBpY2FsbHksIHRoZXNlIGVuZHBvaW50cyBvcmlnaW5hdGUgaW4gdGhlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIHRoYXQgVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMgZm9yIHdlYiBwcm9qZWN0cy4gVXNlIHRoZSBSZWFkLUNvbmZpZ0ZpbGUgZnVuY3Rpb24gaW4gdGhpcyBtb2R1bGUgdG8gY29udmVydCB0aGUgZmlsZSB0byBhIGhhc2ggdGFibGUuIFRoZSBlbmRwb2ludHMgYXJlIGEgcHJvcGVydHkgb2YgdGhlIGNsb3Vkc2VydmljZSBrZXkgb2YgdGhlIGhhc2ggdGFibGUgKCQ8aGFzaHRhYmxlPi5jbG91ZHNlcnZpY2UudmlydHVhbG1hY2hpbmUuZW5kcG9pbnRzKS4gRm9yIGV4YW1wbGUsClBTIEM6XD4gJGNvbmZpZy5jbG91ZHNlcnZpY2UudmlydHVhbG1hY2hpbmUuZW5kcG9pbnRzCm5hbWUgICAgICBwcm90b2NvbCBwdWJsaWNwb3J0IHByaXZhdGVwb3J0Ci0tLS0gICAgICAtLS0tLS0tLSAtLS0tLS0tLS0tIC0tLS0tLS0tLS0tCmh0dHAgICAgICB0Y3AgICAgICA4MCAgICAgICAgIDgwCmh0dHBzICAgICB0Y3AgICAgICA0NDMgICAgICAgIDQ0MwpXZWJEZXBsb3kgdGNwICAgICAgODE3MiAgICAgICA4MTcyCgouSU5QVVRTCk1pY3Jvc29mdC5XaW5kb3dzQXp1cmUuQ29tbWFuZHMuU2VydmljZU1hbmFnZW1lbnQuTW9kZWwuSVBlcnNpc3RlbnRWTQoKLk9VVFBVVFMKTWljcm9zb2Z0LldpbmRvd3NBenVyZS5Db21tYW5kcy5TZXJ2aWNlTWFuYWdlbWVudC5Nb2RlbC5JUGVyc2lzdGVudFZNCgouRVhBTVBMRQpHZXQtQXp1cmVWTQoKLkVYQU1QTEUKCi5MSU5LCkdldC1BenVyZVZNCgouTElOSwpBZGQtQXp1cmVFbmRwb2ludAojPgpmdW5jdGlvbiBBZGQtQXp1cmVWTUVuZHBvaW50cwp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBWYWx1ZUZyb21QaXBlbGluZSA9ICR0cnVlKV0KICAgICAgICBbTWljcm9zb2Z0LldpbmRvd3NBenVyZS5Db21tYW5kcy5TZXJ2aWNlTWFuYWdlbWVudC5Nb2RlbC5QZXJzaXN0ZW50Vk1dCiAgICAgICAgJFZNLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbUFNDdXN0b21PYmplY3RbXV0KICAgICAgICAkRW5kcG9pbnRzCiAgICApCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdBZGQtQXp1cmVWTUVuZHBvaW50czogU3RhcnQnCgogICAgIyBBZGQgZWFjaCBlbmRwb2ludCBmcm9tIHRoZSBKU09OIGZpbGUgdG8gdGhlIFZNCiAgICAkRW5kcG9pbnRzIHwgRm9yRWFjaC1PYmplY3QgYAogICAgewogICAgICAgICRfIHwgT3V0LVN0cmluZyB8IFdyaXRlLVZlcmJvc2VXaXRoVGltZQogICAgICAgIEFkZC1BenVyZUVuZHBvaW50IC1WTSAkVk0gLU5hbWUgJF8ubmFtZSAtUHJvdG9jb2wgJF8ucHJvdG9jb2wgLUxvY2FsUG9ydCAkXy5wcml2YXRlcG9ydCAtUHVibGljUG9ydCAkXy5wdWJsaWNwb3J0IHwgT3V0LU51bGwKICAgIH0KCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ0FkZC1BenVyZVZNRW5kcG9pbnRzOiBFbmQnCiAgICByZXR1cm4gJFZNCn0KCjwjCi5TWU5PUFNJUwpDcmVhdGVzIGFsbCBlbGVtZW50cyBvZiBhIG5ldyB2aXJ0dWFsIG1hY2hpbmUgaW4gYSBXaW5kb3dzIEF6dXJlIHN1YnNjcmlwdGlvbi4KCi5ERVNDUklQVElPTgpUaGlzIGZ1bmN0aW9uIGNyZWF0ZXMgYSBXaW5kb3dzIEF6dXJlIHZpcnR1YWwgbWFjaGluZSAoVk0pIGFuZCByZXR1cm5zIHRoZSBVUkwgb2YgdGhlIGRlcGxveWVkIFZNLiBUaGUgZnVuY3Rpb24gc2V0cyB1cCB0aGUgcHJlcmVxdWlzaXRlcyBhbmQgdGhlbiBjYWxscyB0aGUgTmV3LUF6dXJlVk0gY21kbGV0IChBenVyZSBtb2R1bGUpIHRvIGNyZWF0ZSBhIG5ldyBWTS4gCi0tIEl0IGNhbGxzIHRoZSBOZXctQXp1cmVWTUNvbmZpZyBjbWRsZXQgKEF6dXJlIG1vZHVsZSkgdG8gZ2V0IGEgdmlydHVhbCBtYWNoaW5lIGNvbmZpZ3VyYXRpb24gb2JqZWN0LiAKLS0gSWYgeW91IGluY2x1ZGUgdGhlIFN1Ym5ldCBwYXJhbWV0ZXIgdG8gYWRkIHRoZSBWTSB0byBhbiBBenVyZSBzdWJuZXQsIGl0IGNhbGxzIFNldC1BenVyZVN1Ym5ldCB0byBzZXQgdGhlIHN1Ym5ldCBsaXN0IGZvciB0aGUgVk0uIAotLSBJdCBjYWxscyB0aGUgQWRkLUF6dXJlUHJvdmlzaW9uaW5nQ29uZmlnIChBenVyZSBtb2R1bGUpIHRvIGFkZCBlbGVtZW50cyB0byB0aGUgVk0gY29uZmlndXJhdGlvbi4gSXQgY3JlYXRlcyBhIHN0YW5kYWxvbmUgV2luZG93cyBwcm92aXNpb25pbmcgY29uZmlndXJhdGlvbiAoLVdpbmRvd3MpIHdpdGggYW4gYWRtaW4gYWNjb3VudCBhbmQgcGFzc3dvcmQuIAotLSBJdCBjYWxscyB0aGUgQWRkLUF6dXJlVk1FbmRwb2ludHMgZnVuY3Rpb24gaW4gdGhpcyBtb2R1bGUgdG8gYWRkIHRoZSBlbmRwb2ludHMgc3BlY2lmaWVkIGJ5IHRoZSBFbmRwb2ludHMgcGFyYW1ldGVyLiBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgVk0gb2JqZWN0IGFuZCByZXR1cm5zIGEgVk0gb2JqZWN0IHdpdGggdGhlIGFkZGVkIGVuZHBvaW50cy4gCi0tIEl0IGNhbGxzIHRoZSBBZGQtQXp1cmVWTSBjbWRsZXQgdG8gY3JlYXRlIGEgbmV3IFdpbmRvd3MgQXp1cmUgdmlydHVhbCBtYWNoaW5lIGFuZCByZXR1cm5zIHRoZSBuZXcgVk0uIFRoZSB2YWx1ZXMgb2YgdGhlIGZ1bmN0aW9uIHBhcmFtZXRlcnMgYXJlIHR5cGljYWxseSB0YWtlbiBmcm9tIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzIGZvciBXaW5kb3dzIEF6dXJlLWludGVncmF0ZWQgd2ViIHByb2plY3RzLiBUaGUgUmVhZC1Db25maWdGaWxlIGZ1bmN0aW9uIGluIHRoaXMgbW9kdWxlIGNvbnZlcnRzIHRoZSBKU09OIGZpbGUgaW50byBhIGhhc2ggdGFibGUuIFNhdmUgdGhlIGNsb3Vkc2VydmljZSBrZXkgb2YgdGhlIGhhc2ggdGFibGUgaW4gYSB2YXJpYWJsZSAoYXMgYSBQU0N1c3RvbU9iamVjdCksIGFuZCB1c2VzIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBjdXN0b20gb2JqZWN0IGFzIHBhcmFtZXRlciB2YWx1ZXMuCgouUEFSQU1FVEVSICBVc2VyTmFtZQpTcGVjaWZpZXMgYW4gYWRtaW4gdXNlciBuYW1lLiBUaGlzIGlzIHN1Ym1pdHRlZCBhcyB0aGUgdmFsdWUgb2YgdGhlIEFkbWluVXNlck5hbWUgcGFyYW1ldGVyIG9mIEFkZC1BenVyZVByb3Zpc2lvbmluZ0NvbmZpZy4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouUEFSQU1FVEVSICBVc2VyUGFzc3dvcmQKU3BlY2lmaWVzIGEgcGFzc3dvcmQgZm9yIHRoZSBhZG1pbiB1c2VyIGFjY291bnQuIFRoaXMgaXMgc3VibWl0dGVkIGFzIHRoZSB2YWx1ZSBvZiB0aGUgUGFzc3dvcmQgcGFyYW1ldGVyIG9mIEFkZC1BenVyZVByb3Zpc2lvbmluZ0NvbmZpZy4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouUEFSQU1FVEVSICBWTU5hbWUKU3BlY2lmaWVzIGEgbmFtZSBmb3IgdGhlIG5ldyBWTS4gVGhlIFZNIG5hbWUgbXVzdCBiZSB1bmlxdWUgd2l0aGluIHRoZSBjbG91ZCBzZXJ2aWNlLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5QQVJBTUVURVIgIFZNU2l6ZQpTcGVjaWZpZXMgdGhlIHNpemUgb2YgdGhlIFZNLiBWYWxpZCB2YWx1ZXMgYXJlICJFeHRyYVNtYWxsIiwgIlNtYWxsIiwgIk1lZGl1bSIsICJMYXJnZSIsICJFeHRyYUxhcmdlIiwgIkE1IiwgIkE2IiwgYW5kICJBNyIuIFRoaXMgdmFsdWUgaXMgc3VibWl0dGVkIGFzIHRoZSB2YWx1ZSBvZiB0aGUgSW5zdGFuY2VTaXplIHBhcmFtZXRlciBvZiBOZXctQXp1cmVWTUNvbmZpZy4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuIAoKLlBBUkFNRVRFUiAgU2VydmljZU5hbWUKU3BlY2lmaWVzIGFuIGV4aXN0aW5nIFdpbmRvd3MgQXp1cmUgc2VydmljZSBvciBhIG5hbWUgb2YgYSBuZXcgV2luZG93cyBBenVyZSBzZXJ2aWNlLiBUaGlzIHZhbHVlIGlzIHN1Ym1pdHRlZCB0byB0aGUgU2VydmljZU5hbWUgcGFyYW1ldGVyIG9mIHRoZSBOZXctQXp1cmVWTSBjbWRsZXQsIHdoaWNoIGFkZHMgdGhlIG5ldyB2aXJ0dWFsIG1hY2hpbmUgdG8gYW4gZXhpdGluZyBXaW5kb3dzIEF6dXJlIHNlcnZpY2UsIG9yLCBpZiBMb2NhdGlvbiBvciBBZmZpbml0eUdyb3VwIGlzIHNwZWNpZmllZCwgY3JlYXRlcyBhIG5ldyB2aXJ0dWFsIG1hY2hpbmUgYW5kIHNlcnZpY2UgaW4gdGhlIGN1cnJlbnQgc3Vic2NyaXB0aW9uLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4gCgouUEFSQU1FVEVSICBJbWFnZU5hbWUKU3BlY2lmaWVzIHRoZSBuYW1lIG9mIHRoZSB2aXJ0dWFsIG1hY2hpbmUgaW1hZ2UgdG8gdXNlIGZvciB0aGUgb3BlcmF0aW5nIHN5c3RlbSBkaXNrLiBUaGlzIHBhcmFtZXRlciBpcyBzdWJtaXR0ZWQgYXMgdGhlIHZhbHVlIG9mIHRoZSBJbWFnZU5hbWUgcGFyYW1ldGVyIG9mIHRoZSBOZXctQXp1cmVWTUNvbmZpZyBjbWRsZXQuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLiAKCi5QQVJBTUVURVIgIEVuZHBvaW50cwpTcGVjaWZpZXMgYW4gYXJyYXkgb2YgZW5kcG9pbnRzIHRvIGFkZCB0byB0aGUgVk0uIFRoaXMgdmFsdWUgaXMgc3VibWl0dGVkIHRvIHRoZSBBZGQtQXp1cmVWTUVuZHBvaW50cyBmdW5jdGlvbiB0aGF0IHRoaXMgbW9kdWxlIGV4cG9ydHMuIFRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLiBUeXBpY2FsbHksIHRoZXNlIGVuZHBvaW50cyBvcmlnaW5hdGUgaW4gdGhlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIHRoYXQgVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMgZm9yIHdlYiBwcm9qZWN0cy4gVXNlIHRoZSBSZWFkLUNvbmZpZ0ZpbGUgZnVuY3Rpb24gaW4gdGhpcyBtb2R1bGUgdG8gY29udmVydCB0aGUgZmlsZSB0byBhIGhhc2ggdGFibGUuIFRoZSBlbmRwb2ludHMgYXJlIGEgcHJvcGVydHkgb2YgdGhlIGNsb3VkU2VydmljZSBrZXkgb2YgdGhlIGhhc2ggdGFibGUgKCQ8aGFzaHRhYmxlPi5jbG91ZHNlcnZpY2UudmlydHVhbG1hY2hpbmUuZW5kcG9pbnRzKS4gCgouUEFSQU1FVEVSICBBdmFpbGFiaWxpdHlTZXROYW1lClNwZWNpZmllcyB0aGUgbmFtZSBvZiBhbiBhdmFpbGFiaWxpdHkgc2V0IGZvciB0aGUgbmV3IFZNLiBXaGVuIHlvdSBwbGFjZSBtdWx0aXBsZSB2aXJ0dWFsIG1hY2hpbmVzIGluIGFuIGF2YWlsYWJpbGl0eSBzZXQsIFdpbmRvd3MgQXp1cmUgdHJpZXMgdG8ga2VlcCB0aG9zZSB2aXJ0dWFsIG1hY2hpbmVzIG9uIHNlcGFyYXRlIGhvc3RzIHRvIGltcHJvdmUgY29udGludWl0eSBvZiBzZXJ2aWNlIHNob3VsZCBvbmUgZmFpbC4gVGhpcyBwYXJhbWV0ZXIgaXMgb3B0aW9uYWwuIAoKLlBBUkFNRVRFUiAgVk5ldE5hbWUKU3BlY2lmaWVzIHRoZSBuYW1lIG9mIHRoZSB2aXJ0dWFsIG5ldHdvcmsgbmFtZSB3aGVyZSB0aGUgbmV3IHZpcnR1YWwgbWFjaGluZSBpcyBkZXBsb3llZC4gVGhpcyB2YWx1ZSBpcyBzdWJtaXR0ZWQgdG8gdGhlIFZOZXROYW1lIHBhcmFtZXRlciBvZiB0aGUgQWRkLUF6dXJlVk0gY21kbGV0LiBUaGlzIHBhcmFtZXRlciBpcyBvcHRpb25hbC4gCgouUEFSQU1FVEVSICBMb2NhdGlvbgpTcGVjaWZpZXMgYSBsb2NhdGlvbiBmb3IgdGhlIG5ldyBWTS4gVmFsaWQgdmFsdWVzIGFyZSB0aGUgV2luZG93cyBBenVyZSBsb2NhdGlvbnMsIHN1Y2ggYXMgIldlc3QgVVMiLiBUaGUgZGVmYXVsdCBpcyB0aGUgbG9jYXRpb24gb2YgdGhlIHN1YnNjcmlwdGlvbi4gVGhpcyBwYXJhbWV0ZXIgaXMgb3B0aW9uYWwuIAoKLlBBUkFNRVRFUiAgQWZmaW5pdHlHcm91cApTcGVjaWZpZXMgYW4gYWZmaW5pdHkgZ3JvdXAgZm9yIHRoZSBuZXcgVk0uIEFuIGFmZmluaXR5IGdyb3VwIGlzIGEgZ3JvdXAgb2YgcmVsYXRlZCByZXNvdXJjZXMuIFdoZW4geW91IHNwZWNpZnkgYW4gYWZmaW5pdHkgZ3JvdXAsIFdpbmRvd3MgQXp1cmUgdHJpZXMgdG8ga2VlcCB0aGUgcmVzb3VyY2VzIGluIHRoZSBncm91cCB0b2dldGhlciB0byBpbXByb3ZlIGVmZmljaWVuY3kuIAoKLlBBUkFNRVRFUiBFbmFibGVXZWJEZXBsb3lFeHRlbnNpb24KUHJlcGFyZXMgdGhlIFZNIHRvIGZvciBkZXBsb3ltZW50LiBQcmVwYXJlcyB0aGUgVk0gdG8gZm9yIGRlcGxveW1lbnQuIFRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLiBJZiBpdCBpcyBub3Qgc3BlY2lmaWVkLCB0aGUgVk0gaXMgY3JlYXRlZCwgYnV0IGl0IGlzIG5vdCBkZXBsb3llZC4gVGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1ldGVyIGlzIGluY2x1ZGVkIGluIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzIGZvciBjbG91ZCBzZXJ2aWNlcy4gVGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1ldGVyIGlzIGluY2x1ZGVkIGluIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzIGZvciBjbG91ZCBzZXJ2aWNlcy4KCi5QQVJBTUVURVIgIFN1Ym5ldApTcGVjaWZpZXMgdGhlIHN1Ym5ldCBvZiB0aGUgbmV3IFZNIGNvbmZpZ3VyYXRpb24uIFRoaXMgdmFsdWUgaXMgc3VibWl0dGVkIHRvIHRoZSBTZXQtQXp1cmVTdWJuZXQgY21kbGV0IChBenVyZSBtb2R1bGUpIHdoaWNoIHRha2VzIGEgVk0gYW5kIGFuIGFycmF5IG9mIHN1Ym5ldCBuYW1lcyBhbmQgcmV0dXJucyBhIFZNIHdpdGggdGhlIHN1Ym5ldHMgaW4gaXRzIGNvbmZpZ3VyYXRpb24uCgouSU5QVVRTCk5vbmUuIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgdGFrZSBpbnB1dCBmcm9tIHRoZSBwaXBlbGluZS4KCi5PVVRQVVRTClN5c3RlbS5VcmwKCi5FWEFNUExFCiBUaGlzIGNvbW1hbmQgY2FsbHMgdGhlIEFkZC1BenVyZVZNIGZ1bmN0aW9uLiBNYW55IG9mIHRoZSBwYXJhbWV0ZXIgdmFsdWVzIGNvbWUgZnJvbSBhICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uIG9iamVjdC4gVGhpcyBQU0N1c3RvbU9iamVjdCBpcyB0aGUgY2xvdWRzZXJ2aWNlIGtleSBhbmQgdmFsdWVzIG9mIHRoZSBoYXNoIHRhYmxlIHRoYXQgdGhlIFJlYWQtQ29uZmlnRmlsZSBmdW5jdGlvbiByZXR1cm5zLiBUaGUgc291cmNlIGlzIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzIGZvciB3ZWIgcHJvamVjdHMuCgpQUyBDOlw+ICRjb25maWcgPSBSZWFkLUNvbmZpZ2ZpbGUgPG5hbWU+Lmpzb24KUFMgQzpcPiAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiA9IGNvbmZpZy5jbG91ZHNlcnZpY2UKClBTIEM6XD4gQWRkLUF6dXJlVk0gYAotVXNlck5hbWUgJHVzZXJOYW1lIGAKLVVzZXJQYXNzd29yZCAgJHVzZXJQYXNzd29yZCBgCi1JbWFnZU5hbWUgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24udmlydHVhbG1hY2hpbmUudmhkSW1hZ2UgYAotVk1OYW1lICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxtYWNoaW5lLm5hbWUgYAotVk1TaXplICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxtYWNoaW5lLnNpemVgCi1FbmRwb2ludHMgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24udmlydHVhbG1hY2hpbmUuZW5kcG9pbnRzIGAKLVNlcnZpY2VOYW1lICRzZXJ2aWNlTmFtZSBgCi1Mb2NhdGlvbiAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5sb2NhdGlvbiBgCi1BdmFpbGFiaWxpdHlTZXROYW1lICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLmF2YWlsYWJpbGl0eVNldCBgCi1WTmV0TmFtZSAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsTmV0d29yayBgCi1TdWJuZXQgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24uc3VibmV0IGAKLUFmZmluaXR5R3JvdXAgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24uYWZmaW5pdHlHcm91cCBgCi1FbmFibGVXZWJEZXBsb3lFeHRlbnNpb24KCmh0dHA6Ly9jb250b3NvLmNsb3VkYXBwLm5ldAoKLkVYQU1QTEUKUFMgQzpcPiAkZW5kcG9pbnRzID0gW1BTQ3VzdG9tT2JqZWN0XUB7bmFtZT0iaHR0cCI7cHJvdG9jb2w9InRjcCI7cHVibGljcG9ydD04MDtwcml2YXRlcG9ydD04MH0sIGAKICAgICAgICAgICAgICAgICAgICAgICAgW1BTQ3VzdG9tT2JqZWN0XUB7bmFtZT0iaHR0cHMiO3Byb3RvY29sPSJ0Y3AiO3B1YmxpY3BvcnQ9NDQzO3ByaXZhdGVwb3J0PTQ0M30sYAogICAgICAgICAgICAgICAgICAgICAgICBbUFNDdXN0b21PYmplY3RdQHtuYW1lPSJXZWJEZXBsb3kiO3Byb3RvY29sPSJ0Y3AiO3B1YmxpY3BvcnQ9ODE3Mjtwcml2YXRlcG9ydD04MTcyfQpQUyBDOlw+IEFkZC1BenVyZVZNIGAKLVVzZXJOYW1lIGFkbWluMDEgYAotVXNlclBhc3N3b3JkICJwYSQkd29yZCIgYAotSW1hZ2VOYW1lIGJkNTA3ZDNhNzA5MzQ2OTViYzIxMjhlM2U1YTI1NWJhX19SaWdodEltYWdlLVdpbmRvd3MtMjAxMi14NjQtdjEzLjQuMTIuMiBgCi1WTU5hbWUgRGV2VGVzdFZNMTIzIGAKLVZNU2l6ZSBTbWFsbCBgCi1FbmRwb2ludHMgJGVuZHBvaW50cyBgCi1TZXJ2aWNlTmFtZSBEZXZUZXN0Vk0xMjM0IGAKLUxvY2F0aW9uICJXZXN0IFVTIgoKLkxJTksKTmV3LUF6dXJlVk1Db25maWcKCi5MSU5LClNldC1BenVyZVN1Ym5ldAoKLkxJTksKQWRkLUF6dXJlUHJvdmlzaW9uaW5nQ29uZmlnCgouTElOSwpHZXQtQXp1cmVEZXBsb3ltZW50CiM+CmZ1bmN0aW9uIEFkZC1BenVyZVZNCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRVc2VyUGFzc3dvcmQsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFZNTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVk1TaXplLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZXJ2aWNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkSW1hZ2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtPYmplY3RbXV0KICAgICAgICAkRW5kcG9pbnRzLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0FsbG93RW1wdHlTdHJpbmcoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRBdmFpbGFiaWxpdHlTZXROYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0FsbG93RW1wdHlTdHJpbmcoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRWTmV0TmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtBbGxvd0VtcHR5U3RyaW5nKCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkTG9jYXRpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0KICAgICAgICBbQWxsb3dFbXB0eVN0cmluZygpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEFmZmluaXR5R3JvdXAsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0KICAgICAgICBbQWxsb3dFbXB0eVN0cmluZygpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFN1Ym5ldCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEVuYWJsZVdlYkRlcGxveUV4dGVuc2lvbgogICAgKQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlVk06IFN0YXJ0JwoKICAgICMgQ3JlYXRlIGEgbmV3IFdpbmRvd3MgQXp1cmUgVk0gY29uZmlndXJhdGlvbiBvYmplY3QuCiAgICBpZiAoJEF2YWlsYWJpbGl0eVNldE5hbWUpCiAgICB7CiAgICAgICAgJHZtID0gTmV3LUF6dXJlVk1Db25maWcgLU5hbWUgJFZNTmFtZSAtSW5zdGFuY2VTaXplICRWTVNpemUgLUltYWdlTmFtZSAkSW1hZ2VOYW1lIC1BdmFpbGFiaWxpdHlTZXROYW1lICRBdmFpbGFiaWxpdHlTZXROYW1lCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJHZtID0gTmV3LUF6dXJlVk1Db25maWcgLU5hbWUgJFZNTmFtZSAtSW5zdGFuY2VTaXplICRWTVNpemUgLUltYWdlTmFtZSAkSW1hZ2VOYW1lCiAgICB9CgogICAgaWYgKCEkdm0pCiAgICB7CiAgICAgICAgdGhyb3cgJ0FkZC1BenVyZVZNOiBGYWlsZWQgdG8gY3JlYXRlIEF6dXJlIFZNIGNvbmZpZy4nCiAgICB9CgogICAgaWYgKCRTdWJuZXQpCiAgICB7CiAgICAgICAgIyBTZXQgdGhlIHN1Ym5ldCBsaXN0IGZvciBhIHZpcnR1YWwgbWFjaGluZSBjb25maWd1cmF0aW9uLgogICAgICAgICRzdWJuZXRSZXN1bHQgPSBTZXQtQXp1cmVTdWJuZXQgLVZNICR2bSAtU3VibmV0TmFtZXMgJFN1Ym5ldAoKICAgICAgICBpZiAoISRzdWJuZXRSZXN1bHQpCiAgICAgICAgewogICAgICAgICAgICB0aHJvdyAoJ0FkZC1BenVyZVZNOiBGYWlsZWQgdG8gc2V0IHN1Ym5ldCAnICsgJFN1Ym5ldCkKICAgICAgICB9CiAgICB9CgogICAgIyBBZGQgY29uZmlndXJhdGlvbiBkYXRhIHRvIHRoZSBWTSBjb25maWd1cmF0aW9uCiAgICAkVk1XaXRoQ29uZmlnID0gQWRkLUF6dXJlUHJvdmlzaW9uaW5nQ29uZmlnIC1WTSAkdm0gLVdpbmRvd3MgLVBhc3N3b3JkICRVc2VyUGFzc3dvcmQgLUFkbWluVXNlck5hbWUgJFVzZXJOYW1lCgogICAgaWYgKCEkVk1XaXRoQ29uZmlnKQogICAgewogICAgICAgIHRocm93ICgnQWRkLUF6dXJlVk06IEZhaWxlZCB0byBjcmVhdGUgcHJvdmlzaW9uaW5nIGNvbmZpZy4nKQogICAgfQoKICAgICMgQWRkIGlucHV0IGVuZHBvaW50cyB0byB0aGUgVk0KICAgIGlmICgkRW5kcG9pbnRzIC1hbmQgJEVuZHBvaW50cy5Db3VudCAtZ3QgMCkKICAgIHsKICAgICAgICAkVk1XaXRoQ29uZmlnID0gQWRkLUF6dXJlVk1FbmRwb2ludHMgLUVuZHBvaW50cyAkRW5kcG9pbnRzIC1WTSAkVk1XaXRoQ29uZmlnCiAgICB9CgogICAgaWYgKCEkVk1XaXRoQ29uZmlnKQogICAgewogICAgICAgIHRocm93ICgnQWRkLUF6dXJlVk06IEZhaWxlZCB0byBjcmVhdGUgZW5kcG9pbnRzLicpCiAgICB9CgogICAgaWYgKCRFbmFibGVXZWJEZXBsb3lFeHRlbnNpb24pCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdBZGQtQXp1cmVWTTogQWRkIHdlYmRlcGxveSBleHRlbnNpb24nCgogICAgICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnVG8gdmlldyB0aGUgV2ViRGVwbG95IGxpY2Vuc2UsIHNlZSBodHRwOi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJRD0zODk3NDQgJwoKICAgICAgICAkVk1XaXRoQ29uZmlnID0gU2V0LUF6dXJlVk1FeHRlbnNpb24gYAogICAgICAgICAgICAtVk0gJFZNV2l0aENvbmZpZyBgCiAgICAgICAgICAgIC1FeHRlbnNpb25OYW1lIFdlYkRlcGxveUZvclZTRGV2VGVzdCBgCiAgICAgICAgICAgIC1QdWJsaXNoZXIgJ01pY3Jvc29mdC5WaXN1YWxTdHVkaW8uV2luZG93c0F6dXJlLkRldlRlc3QnIGAKICAgICAgICAgICAgLVZlcnNpb24gJzEuKicgCgogICAgICAgIGlmICghJFZNV2l0aENvbmZpZykKICAgICAgICB7CiAgICAgICAgICAgIHRocm93ICgnQWRkLUF6dXJlVk06IEZhaWxlZCB0byBhZGQgd2ViZGVwbG95IGV4dGVuc2lvbi4nKQogICAgICAgIH0KICAgIH0KCiAgICAjIENyZWF0ZSBhIGhhc2ggdGFibGUgb2YgcGFyYW1ldGVycyBmb3Igc3BsYXR0aW5nCiAgICAkcGFyYW0gPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBIYXNodGFibGUKICAgIGlmICgkVk5ldE5hbWUpCiAgICB7CiAgICAgICAgJHBhcmFtLkFkZCgnVk5ldE5hbWUnLCAkVk5ldE5hbWUpCiAgICB9CgogICAgaWYgKCRMb2NhdGlvbikKICAgIHsKICAgICAgICAkcGFyYW0uQWRkKCdMb2NhdGlvbicsICRMb2NhdGlvbikKICAgIH0KCiAgICBpZiAoJEFmZmluaXR5R3JvdXApCiAgICB7CiAgICAgICAgJHBhcmFtLkFkZCgnQWZmaW5pdHlHcm91cCcsICRBZmZpbml0eUdyb3VwKQogICAgfQoKICAgICRwYXJhbS5BZGQoJ1NlcnZpY2VOYW1lJywgJFNlcnZpY2VOYW1lKQogICAgJHBhcmFtLkFkZCgnVk1zJywgJFZNV2l0aENvbmZpZykKICAgICRwYXJhbS5BZGQoJ1dhaXRGb3JCb290JywgJHRydWUpCgogICAgJHBhcmFtIHwgT3V0LVN0cmluZyB8IFdyaXRlLVZlcmJvc2VXaXRoVGltZQoKICAgIE5ldy1BenVyZVZNIEBwYXJhbSB8IE91dC1OdWxsCgogICAgV3JpdGUtSG9zdFdpdGhUaW1lICgnQWRkLUF6dXJlVk06IENyZWF0ZWQgVmlydHVhbCBtYWNoaW5lICcgKyAkVk1OYW1lKQoKICAgICR1cmwgPSBbU3lzdGVtLlVyaV0oR2V0LUF6dXJlRGVwbG95bWVudCAtU2VydmljZU5hbWUgJFNlcnZpY2VOYW1lKS5VcmwKCiAgICBpZiAoISR1cmwpCiAgICB7CiAgICAgICAgdGhyb3cgJ0FkZC1BenVyZVZNOiBDYW4gbm90IGZpbmQgVk0gVXJsLicKICAgIH0KCiAgICBXcml0ZS1Ib3N0V2l0aFRpbWUgKCdBZGQtQXp1cmVWTTogUHVibGlzaCBVcmwgaHR0cHM6Ly8nICsgJHVybC5Ib3N0ICsgJzonICsgJFdlYkRlcGxveVBvcnQgKyAnL21zZGVwbG95LmF4ZCcpCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdBZGQtQXp1cmVWTTogRW5kJwoKICAgIHJldHVybiAkdXJsLkFic29sdXRlVXJpCn0KCgo8IwouU1lOT1BTSVMKR2V0cyB0aGUgc3BlY2lmaWVkIFdpbmRvd3MgQXp1cmUgdmlydHVhbCBtYWNoaW5lLgoKLkRFU0NSSVBUSU9OClRoZSBGaW5kLUF6dXJlVk0gZnVuY3Rpb24gZ2V0cyBhIFdpbmRvd3MgQXp1cmUgdmlydHVhbCBtYWNoaW5lIChWTSkgYmFzZWQgb24gdGhlIHNlcnZpY2UgbmFtZSBhbmQgVk0gbmFtZS4gVGhpcyBmdW5jdGlvbiBjYWxscyB0aGUgVGVzdC1BenVyZU5hbWUgY21kbGV0IChBenVyZSBtb2R1bGUpIHRvIHZlcmlmeSB0aGF0IHRoZSBzZXJ2aWNlIG5hbWUgZXhpc3RzIGluIFdpbmRvd3MgQXp1cmUuIElmIGl0IGRvZXMsIHRoZSBmdW5jdGlvbiBjYWxscyB0aGUgR2V0LUF6dXJlVk0gY21kbGV0IHRvIGdldCB0aGUgVk0uIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIGhhc2ggdGFibGUgd2l0aCB2bSBhbmQgZm91bmRTZXJ2aWNlIGtleXMuCi0tIEZvdW5kU2VydmljZTogJFRydWUgaWYgVGVzdC1BenVyZU5hbWUgZm91bmQgdGhlIHNlcnZpY2UuIE90aGVyd2lzZSwgJEZhbHNlCi0tIFZNOiBDb250YWlucyB0aGUgVk0gb2JqZWN0IHdoZW4gRm91bmRTZXJ2aWNlIGlzIHRydWUgYW5kIEdldC1BenVyZVZNIHJldHVybiB0aGUgVk0gb2JqZWN0LgoKLlBBUkFNRVRFUiAgU2VydmljZU5hbWUKVGhlIG5hbWUgb2YgYW4gZXhpc3RpbmcgV2luZG93cyBBenVyZSBzZXJ2aWNlLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5QQVJBTUVURVIgIFZNTmFtZQpUaGUgbmFtZSBvZiBhIHZpcnR1YWwgbWFjaGluZSBpbiB0aGUgc2VydmljZS4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouSU5QVVRTCk5vbmUuIFlvdSBjYW5ub3QgcGlwZSBpbnB1dCB0byB0aGlzIGZ1bmN0aW9uLgoKLk9VVFBVVFMKU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZQoKLkVYQU1QTEUKUFMgQzpcPiBGaW5kLUF6dXJlVk0gLVNlcnZpY2UgQ29udG9zbyAtTmFtZSBDb250b3NvVk0yCgpOYW1lICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWUKLS0tLSAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tLS0tCmZvdW5kU2VydmljZSAgICAgICAgICAgICAgICAgICBUcnVlCgpEZXBsb3ltZW50TmFtZSAgICAgICAgOiBDb250b3NvCk5hbWUgICAgICAgICAgICAgICAgICA6IENvbnRvc29WTTIKTGFiZWwgICAgICAgICAgICAgICAgIDoKVk0gICAgICAgICAgICAgICAgICAgIDogTWljcm9zb2Z0LldpbmRvd3NBenVyZS5Db21tYW5kcy5TZXJ2aWNlTWFuYWdlbWVudC5Nb2RlbC5QZXJzaXN0ZW50Vk0KSW5zdGFuY2VTdGF0dXMgICAgICAgIDogUmVhZHlSb2xlCklwQWRkcmVzcyAgICAgICAgICAgICA6IDEwMC43MS4xMTQuMTE4Ckluc3RhbmNlU3RhdGVEZXRhaWxzICA6ClBvd2VyU3RhdGUgICAgICAgICAgICA6IFN0YXJ0ZWQKSW5zdGFuY2VFcnJvckNvZGUgICAgIDoKSW5zdGFuY2VGYXVsdERvbWFpbiAgIDogMApJbnN0YW5jZU5hbWUgICAgICAgICAgOiBDb250b3NvVk0yCkluc3RhbmNlVXBncmFkZURvbWFpbiA6IDAKSW5zdGFuY2VTaXplICAgICAgICAgIDogU21hbGwKQXZhaWxhYmlsaXR5U2V0TmFtZSAgIDoKRE5TTmFtZSAgICAgICAgICAgICAgIDogaHR0cDovL2NvbnRvc28uY2xvdWRhcHAubmV0LwpTZXJ2aWNlTmFtZSAgICAgICAgICAgOiBDb250b3NvCk9wZXJhdGlvbkRlc2NyaXB0aW9uICA6IEdldC1BenVyZVZNCk9wZXJhdGlvbklkICAgICAgICAgICA6IDNjMzhlOTMzLTk0NjQtNjg3Ni1hYWFhLTczNDk5MGE4ODJkNgpPcGVyYXRpb25TdGF0dXMgICAgICAgOiBTdWNjZWVkZWQKCi5MSU5LCkdldC1BenVyZVZNCiM+CmZ1bmN0aW9uIEZpbmQtQXp1cmVWTQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTZXJ2aWNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVk1OYW1lCiAgICApCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdGaW5kLUF6dXJlVk06IFN0YXJ0JwogICAgJGZvdW5kU2VydmljZSA9ICRmYWxzZQogICAgJHZtID0gJG51bGwKCiAgICBpZiAoVGVzdC1BenVyZU5hbWUgLVNlcnZpY2UgLU5hbWUgJFNlcnZpY2VOYW1lKQogICAgewogICAgICAgICRmb3VuZFNlcnZpY2UgPSAkdHJ1ZQogICAgICAgICR2bSA9IEdldC1BenVyZVZNIC1TZXJ2aWNlTmFtZSAkU2VydmljZU5hbWUgLU5hbWUgJFZNTmFtZQogICAgICAgIGlmICgkdm0pCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1Ib3N0V2l0aFRpbWUgKCdGaW5kLUF6dXJlVk06IEZvdW5kIGV4aXN0aW5nIHZpcnR1YWwgbWFjaGluZSAnICsgJHZtLk5hbWUgKQogICAgICAgICAgICAkdm0gfCBPdXQtU3RyaW5nIHwgV3JpdGUtVmVyYm9zZVdpdGhUaW1lCiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnRmluZC1BenVyZVZNOiBFbmQnCiAgICByZXR1cm4gQHsgVk0gPSAkdm07IEZvdW5kU2VydmljZSA9ICRmb3VuZFNlcnZpY2UgfQp9CgoKPCMKLlNZTk9QU0lTCkZpbmRzIG9yIGNyZWF0ZXMgYSB2aXJ0dWFsIG1hY2hpbmUgaW4gdGhlIHN1YnNjcmlwdGlvbiB0aGF0IG1hdGNoZXMgdGhlIHZhbHVlcyBpbiB0aGUgSlNPTiBjb25maWd1cmF0aW9uIGZpbGUuCgouREVTQ1JJUFRJT04KVGhlIE5ldy1BenVyZVZNRW52aXJvbm1lbnQgZnVuY3Rpb24gZmluZHMgb3IgY3JlYXRlcyBhIHZpcnR1YWwgbWFjaGluZSBpbiB0aGUgc3Vic2NyaXB0aW9uIHRoYXQgbWF0Y2hlcyB0aGUgdmFsdWVzIGluIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzIGZvciB3ZWIgcHJvamVjdHMuIEl0IHRha2VzIGEgUFNDdXN0b21PYmplY3QgdGhhdCBpcyB0aGUgY2xvdWRzZXJ2aWNlIGtleSBvZiB0aGUgaGFzaCB0YWJsZSB0aGUgUmVhZC1Db25maWdGaWxlIHJldHVybnMuIFRoaXMgZGF0YSBvcmlnaW5hdGVzIGluIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzLiBUaGUgZnVuY3Rpb24gbG9va3MgZm9yIGEgdmlydHVhbCBtYWNoaW5lIChWTSkgaW4gdGhlIHN1YnNjcmlwdGlvbiB3aXRoIGEgc2VydmljZSBuYW1lIGFuZCB2aXJ0dWFsIG1hY2hpbmUgbmFtZSB0aGF0IG1hdGNoZXMgdGhlIHZhbHVlcyBpbiB0aGUgQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiBjdXN0b20gb2JqZWN0LiBJZiBpdCBjYW5ub3QgZmluZCBhIG1hdGNoaW5nIFZNLCBpdCBjYWxscyB0aGUgQWRkLUF6dXJlVk0gZnVuY3Rpb24gaW4gdGhpcyBtb2R1bGUgYW5kIHVzZXMgdGhlIHZhbHVlcyBpbiB0aGUgQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiBvYmplY3QgdG8gY3JlYXRlIGEgVk0uIFRoZSB2aXJ0dWFsIG1hY2hpbmUgZW52aXJvbm1lbnQgaW5jbHVkZXMgYSBzdG9yYWdlIGFjY291bnQgdGhhdCBoYXMgYSBuYW1lIHRoYXQgYmVnaW5zIHdpdGggImRldnRlc3QiLiBJZiB0aGUgZnVuY3Rpb24gY2Fubm90IGZpbmQgYSBzdG9yYWdlIGFjY291bnQgd2l0aCB0aGF0IG5hbWUgcGF0dGVybiBpbiB0aGUgc3Vic2NyaXB0aW9uLCBpdCBjcmVhdGVzIG9uZS4gVGhlIGZ1bmN0aW9uIHJldHVybnMgYSBoYXNodGFibGUgd2l0aCBWTVVybCwgdXNlck5hbWUsIGFuZCBQYXNzd29yZCBrZXlzIGFuZCBzdHJpbmcgdmFsdWVzLgoKLlBBUkFNRVRFUiAgQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbgpUYWtlcyBhIFBTQ3VzdG9tT2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGNsb3Vkc2VydmljZSBwcm9wZXJ0eSBvZiB0aGUgaGFzaCB0YWJsZSB0aGF0IHRoZSBSZWFkLUNvbmZpZ0ZpbGUgZnVuY3Rpb24gcmV0dXJucy4gQWxsIHZhbHVlcyBvcmlnaW5hdGUgaW4gdGhlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIHRoYXQgVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMgZm9yIHdlYiBwcm9qZWN0cy4gWW91IGNhbiBmaW5kIHRoaXMgZmlsZSBpbiB0aGUgUHVibGlzaFNjcmlwdHMgZm9sZGVyIGluIHlvdXIgc29sdXRpb24uIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgokY29uZmlnID0gUmVhZC1Db25maWdGaWxlIC1Db25maWd1cmF0aW9uRmlsZSA8ZmlsZT4uanNvbiAkY2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiA9ICRjb25maWcuY2xvdWRTZXJ2aWNlCgouUEFSQU1FVEVSICBWTVBhc3N3b3JkClRha2VzIGEgaGFzaCB0YWJsZSB3aXRoIG5hbWUgYW5kIHBhc3N3b3JkIGtleXMsIHN1Y2ggYXM6IEB7TmFtZSA9ICJhZG1pbiI7IFBhc3N3b3JkID0gInBhJCR3b3JkIn0gVGhpcyBwYXJhbWV0ZXIgaXMgb3B0aW9uYWwuIElmIHlvdSBvbWl0IGl0LCB0aGUgZGVmYXVsdCB2YWx1ZXMgYXJlIHRoZSB2aXJ0dWFsIG1hY2hpbmUgdXNlciBuYW1lIGFuZCBwYXNzd29yZCBpbiB0aGUgSlNPTiBjb25maWd1cmF0aW9uIGZpbGUuCgouSU5QVVRTClBTQ3VzdG9tT2JqZWN0ICBTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlCgouT1VUUFVUUwpTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlCgouRVhBTVBMRQokY29uZmlnID0gUmVhZC1Db25maWdGaWxlIC1Db25maWd1cmF0aW9uRmlsZSAkPGZpbGU+Lmpzb24KJGNsb3VkU3ZjQ29uZmlnID0gJGNvbmZpZy5jbG91ZFNlcnZpY2UKJG5hbWVoYXNoID0gQHtuYW1lID0gImFkbWluIjsgcGFzc3dvcmQgPSAicGEkJHdvcmQifQoKTmV3LUF6dXJlVk1FbnZpcm9ubWVudCBgCiAgICAtQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiAkY2xvdWRTdmNDb25maWcgYAogICAgLVZNUGFzc3dvcmQgJG5hbWVoYXNoCgpOYW1lICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWUKLS0tLSAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tLS0tClVzZXJOYW1lICAgICAgICAgICAgICAgICAgICAgICBhZG1pbgpWTVVybCAgICAgICAgICAgICAgICAgICAgICAgICAgY29udG9zby5jbG91ZG5ldC5uZXQKUGFzc3dvcmQgICAgICAgICAgICAgICAgICAgICAgIHBhJCR3b3JkCgouTElOSwpBZGQtQXp1cmVWTQoKLkxJTksKTmV3LUF6dXJlU3RvcmFnZUFjY291bnQKIz4KZnVuY3Rpb24gTmV3LUF6dXJlVk1FbnZpcm9ubWVudAp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbT2JqZWN0XQogICAgICAgICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtIYXNodGFibGVdCiAgICAgICAgJFZNUGFzc3dvcmQKICAgICkKCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgKCdOZXctQXp1cmVWTUVudmlyb25tZW50OiBTdGFydCcpCgogICAgaWYgKCRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLmxvY2F0aW9uIC1hbmQgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24uYWZmaW5pdHlHcm91cCkKICAgIHsKICAgICAgICB0aHJvdyAnTmV3LUF6dXJlVk1FbnZpcm9ubWVudDogTWFsZm9ybWVkIGNvbmZpZ3VyYXRpb24gZmlsZS4gSGFzIGJvdGggbG9jYXRpb24gYW5kIGFmZmluaXR5R3JvdXAnCiAgICB9CgogICAgaWYgKCEkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5sb2NhdGlvbiAtYW5kICEkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5hZmZpbml0eUdyb3VwKQogICAgewogICAgICAgIHRocm93ICdOZXctQXp1cmVWTUVudmlyb25tZW50OiBNYWxmb3JtZWQgY29uZmlndXJhdGlvbiBmaWxlLiBEb2VzIG5vdCBoYXZlIGxvY2F0aW9uIG9yIGFmZmluaXR5R3JvdXAnCiAgICB9CgogICAgIyBJZiB0aGUgQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiBvYmplY3QgaGFzIHRoZSAnbmFtZScgcHJvcGVydHkgKGZvciBzZXJ2aWNlIG5hbWUpIGFuZCB0aGUgJ25hbWUnIHByb3BlcnR5IGhhcyBhIHZhbHVlLCB1c2UgaXQuIE90aGVyd2lzZSwgdXNlIHRoZSB2aXJ0dWFsIG1hY2hpbmUgbmFtZSBpbiB0aGUgQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbiBvYmplY3QsIHdoaWNoIGlzIGFsd2F5cyBwb3B1bGF0ZWQuCiAgICBpZiAoKFRlc3QtTWVtYmVyICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uICduYW1lJykgLWFuZCAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5uYW1lKQogICAgewogICAgICAgICRzZXJ2aWNlTmFtZSA9ICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLm5hbWUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkc2VydmljZU5hbWUgPSAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsTWFjaGluZS5uYW1lCiAgICB9CgogICAgaWYgKCEkVk1QYXNzd29yZCkKICAgIHsKICAgICAgICAkdXNlck5hbWUgPSAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsTWFjaGluZS51c2VyCiAgICAgICAgJHVzZXJQYXNzd29yZCA9ICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxNYWNoaW5lLnBhc3N3b3JkCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJHVzZXJOYW1lID0gJFZNUGFzc3dvcmQuTmFtZQogICAgICAgICR1c2VyUGFzc3dvcmQgPSAkVk1QYXNzd29yZC5QYXNzd29yZAogICAgfQoKICAgICMgR2V0IHRoZSBWTSBuYW1lIGZyb20gdGhlIEpTT04gZmlsZQogICAgJGZpbmRBenVyZVZNUmVzdWx0ID0gRmluZC1BenVyZVZNIC1TZXJ2aWNlTmFtZSAkc2VydmljZU5hbWUgLVZNTmFtZSAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsTWFjaGluZS5uYW1lCgogICAgIyBJZiB3ZSBjYW4ndCBmaW5kIGEgVk0gd2l0aCB0aGF0IG5hbWUgaW4gdGhhdCBjbG91ZCBzZXJ2aWNlLCBjcmVhdGUgb25lLgogICAgaWYgKCEkZmluZEF6dXJlVk1SZXN1bHQuVk0pCiAgICB7CiAgICAgICAgJHN0b3JhZ2VBY2NvdW50TmFtZSA9ICRudWxsCiAgICAgICAgJGltYWdlSW5mbyA9IEdldC1BenVyZVZNSW1hZ2UgLUltYWdlTmFtZSAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsbWFjaGluZS52aGRpbWFnZSAKICAgICAgICBpZiAoJGltYWdlSW5mbyAtYW5kICRpbWFnZUluZm8uQ2F0ZWdvcnkgLWVxICdVc2VyJykKICAgICAgICB7CiAgICAgICAgICAgICRzdG9yYWdlQWNjb3VudE5hbWUgPSAoJGltYWdlSW5mby5NZWRpYUxpbmsuSG9zdCAtc3BsaXQgJ1wuJylbMF0KICAgICAgICB9CgogICAgICAgIGlmICghJHN0b3JhZ2VBY2NvdW50TmFtZSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5sb2NhdGlvbikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHN0b3JhZ2VBY2NvdW50TmFtZSA9IEdldC1BenVyZVZNU3RvcmFnZSAtTG9jYXRpb24gJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24ubG9jYXRpb24KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRzdG9yYWdlQWNjb3VudE5hbWUgPSBHZXQtQXp1cmVWTVN0b3JhZ2UgLUFmZmluaXR5R3JvdXAgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24uYWZmaW5pdHlHcm91cAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjSWYgdGhlcmUncyBubyBkZXZ0ZXN0KiBzdG9yYWdlIGFjY291bnQsIGNyZWF0ZSBvbmUuCiAgICAgICAgaWYgKCEkc3RvcmFnZUFjY291bnROYW1lKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLmxvY2F0aW9uKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc3RvcmFnZUFjY291bnROYW1lID0gQWRkLUF6dXJlVk1TdG9yYWdlIC1Mb2NhdGlvbiAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5sb2NhdGlvbgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHN0b3JhZ2VBY2NvdW50TmFtZSA9IEFkZC1BenVyZVZNU3RvcmFnZSAtQWZmaW5pdHlHcm91cCAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5hZmZpbml0eUdyb3VwCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRjdXJyZW50U3Vic2NyaXB0aW9uID0gR2V0LUF6dXJlU3Vic2NyaXB0aW9uIC1DdXJyZW50CgogICAgICAgIGlmICghJGN1cnJlbnRTdWJzY3JpcHRpb24pCiAgICAgICAgewogICAgICAgICAgICB0aHJvdyAnTmV3LUF6dXJlVk1FbnZpcm9ubWVudDogRmFpbGVkIHRvIGdldCBjdXJyZW50IEF6dXJlIHN1YnNjcmlwdGlvbi4nCiAgICAgICAgfQoKICAgICAgICAjIFNldCB0aGUgZGV2dGVzdCogc3RvcmFnZSBhY2NvdW50IHRvIGN1cnJlbnQKICAgICAgICBTZXQtQXp1cmVTdWJzY3JpcHRpb24gYAogICAgICAgICAgICAtU3Vic2NyaXB0aW9uTmFtZSAkY3VycmVudFN1YnNjcmlwdGlvbi5TdWJzY3JpcHRpb25OYW1lIGAKICAgICAgICAgICAgLUN1cnJlbnRTdG9yYWdlQWNjb3VudE5hbWUgJHN0b3JhZ2VBY2NvdW50TmFtZQoKICAgICAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgKCdOZXctQXp1cmVWTUVudmlyb25tZW50OiBTdG9yYWdlIGFjY291bnQgaXMgc2V0IHRvICcgKyAkc3RvcmFnZUFjY291bnROYW1lKQoKICAgICAgICAkbG9jYXRpb24gPSAnJyAgICAgICAgICAgIAogICAgICAgIGlmICghJGZpbmRBenVyZVZNUmVzdWx0LkZvdW5kU2VydmljZSkKICAgICAgICB7CiAgICAgICAgICAgICRsb2NhdGlvbiA9ICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLmxvY2F0aW9uCiAgICAgICAgfQoKICAgICAgICAkZW5kcG9pbnRzID0gJG51bGwKICAgICAgICBpZiAoVGVzdC1NZW1iZXIgLU9iamVjdCAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsbWFjaGluZSAtTWVtYmVyICdFbmRwb2ludHMnKQogICAgICAgIHsKICAgICAgICAgICAgJGVuZHBvaW50cyA9ICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxtYWNoaW5lLmVuZHBvaW50cwogICAgICAgIH0KCiAgICAgICAgIyBDcmVhdGUgYSBWTSB3aXRoIHRoZSB2YWx1ZXMgZnJvbSB0aGUgSlNPTiBmaWxlICsgcGFyYW1ldGVyIHZhbHVlcwogICAgICAgICRWTVVybCA9IEFkZC1BenVyZVZNIGAKICAgICAgICAgICAgLVVzZXJOYW1lICR1c2VyTmFtZSBgCiAgICAgICAgICAgIC1Vc2VyUGFzc3dvcmQgJHVzZXJQYXNzd29yZCBgCiAgICAgICAgICAgIC1JbWFnZU5hbWUgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24udmlydHVhbE1hY2hpbmUudmhkSW1hZ2UgYAogICAgICAgICAgICAtVk1OYW1lICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxNYWNoaW5lLm5hbWUgYAogICAgICAgICAgICAtVk1TaXplICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxNYWNoaW5lLnNpemVgCiAgICAgICAgICAgIC1FbmRwb2ludHMgJGVuZHBvaW50cyBgCiAgICAgICAgICAgIC1TZXJ2aWNlTmFtZSAkc2VydmljZU5hbWUgYAogICAgICAgICAgICAtTG9jYXRpb24gJGxvY2F0aW9uIGAKICAgICAgICAgICAgLUF2YWlsYWJpbGl0eVNldE5hbWUgJENsb3VkU2VydmljZUNvbmZpZ3VyYXRpb24uYXZhaWxhYmlsaXR5U2V0IGAKICAgICAgICAgICAgLVZOZXROYW1lICRDbG91ZFNlcnZpY2VDb25maWd1cmF0aW9uLnZpcnR1YWxOZXR3b3JrIGAKICAgICAgICAgICAgLVN1Ym5ldCAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5zdWJuZXQgYAogICAgICAgICAgICAtQWZmaW5pdHlHcm91cCAkQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi5hZmZpbml0eUdyb3VwIGAKICAgICAgICAgICAgLUVuYWJsZVdlYkRlcGxveUV4dGVuc2lvbjokQ2xvdWRTZXJ2aWNlQ29uZmlndXJhdGlvbi52aXJ0dWFsTWFjaGluZS5lbmFibGVXZWJEZXBsb3lFeHRlbnNpb24KCiAgICAgICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICgnTmV3LUF6dXJlVk1FbnZpcm9ubWVudDogRW5kJykKCiAgICAgICAgcmV0dXJuIEB7IAogICAgICAgICAgICBWTVVybCA9ICRWTVVybDsgCiAgICAgICAgICAgIFVzZXJOYW1lID0gJHVzZXJOYW1lOyAKICAgICAgICAgICAgUGFzc3dvcmQgPSAkdXNlclBhc3N3b3JkOyAKICAgICAgICAgICAgSXNOZXdDcmVhdGVkVk0gPSAkdHJ1ZTsgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAoJ05ldy1BenVyZVZNRW52aXJvbm1lbnQ6IEZvdW5kIGFuIGV4aXN0aW5nIHZpcnR1YWwgbWFjaGluZSAnICsgJGZpbmRBenVyZVZNUmVzdWx0LlZNLk5hbWUpCiAgICB9CgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICgnTmV3LUF6dXJlVk1FbnZpcm9ubWVudDogRW5kJykKCiAgICByZXR1cm4gQHsgCiAgICAgICAgVk1VcmwgPSAkZmluZEF6dXJlVk1SZXN1bHQuVk0uRE5TTmFtZTsgCiAgICAgICAgVXNlck5hbWUgPSAkdXNlck5hbWU7IAogICAgICAgIFBhc3N3b3JkID0gJHVzZXJQYXNzd29yZDsgCiAgICAgICAgSXNOZXdDcmVhdGVkVk0gPSAkZmFsc2U7IH0KfQoKCjwjCi5TWU5PUFNJUwpSZXR1cm5zIGEgY29tbWFuZCB0byBydW4gdGhlIE1zRGVwbG95LmV4ZSB0b29sCgouREVTQ1JJUFRJT04KVGhlIEdldC1NU0RlcGxveUNtZCBmdW5jdGlvbiBhc3NlbWJsZXMgYW5kIHJldHVybnMgYSB2YWxpZCBjb21tYW5kIHRvIHJ1biBXZWIgRGVwbG95IFRvb2wsIE1TRGVwbG95LmV4ZS4gSXQgZmluZHMgdGhlIGNvcnJlY3QgcGF0aCB0byB0aGUgdG9vbCBvbiB0aGUgbG9jYWwgY29tcHV0ZXIgaW4gYSByZWdpc3RyeSBrZXkuIFRoaXMgZnVuY3Rpb24gaGFzIG5vIHBhcmFtZXRlcnMuCgouSU5QVVRTCk5vbmUKCi5PVVRQVVRTClN5c3RlbS5TdHJpbmcKCi5FWEFNUExFClBTIEM6XD4gR2V0LU1TRGVwbG95Q21kCkM6XFByb2dyYW0gRmlsZXNcSUlTXE1pY3Jvc29mdCBXZWIgRGVwbG95IFYzXE1zRGVwbG95LmV4ZQoKLkxJTksKR2V0LU1TRGVwbG95Q21kCgouTElOSwpXZWIgRGVwbG95IFRvb2wKaHR0cDovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2RkNTY4OTk2KHY9d3MuMTApLmFzcHgKIz4KZnVuY3Rpb24gR2V0LU1TRGVwbG95Q21kCnsKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnR2V0LU1TRGVwbG95Q21kOiBTdGFydCcKICAgICRyZWdLZXkgPSAnSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XElJUyBFeHRlbnNpb25zXE1TRGVwbG95JwoKICAgIGlmICghKFRlc3QtUGF0aCAkcmVnS2V5KSkKICAgIHsKICAgICAgICB0aHJvdyAoJ0dldC1NU0RlcGxveUNtZDogQ2FuIG5vdCBmaW5kICcgKyAkcmVnS2V5KQogICAgfQoKICAgICR2ZXJzaW9ucyA9IEAoR2V0LUNoaWxkSXRlbSAkcmVnS2V5IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKQogICAgJGxhc3Rlc3RWZXJzaW9uID0gICR2ZXJzaW9ucyB8IFNvcnQtT2JqZWN0IC1Qcm9wZXJ0eSBOYW1lIC1EZXNjZW5kaW5nIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMQoKICAgIGlmICgkbGFzdGVzdFZlcnNpb24pCiAgICB7CiAgICAgICAgJGluc3RhbGxQYXRoS2V5cyA9ICdJbnN0YWxsUGF0aCcsJ0luc3RhbGxQYXRoX3g4NicKCiAgICAgICAgZm9yZWFjaCAoJGluc3RhbGxQYXRoS2V5IGluICRpbnN0YWxsUGF0aEtleXMpCiAgICAgICAgewkJICAgIAkKICAgICAgICAgICAgJGluc3RhbGxQYXRoID0gJGxhc3Rlc3RWZXJzaW9uLkdldFZhbHVlKCRpbnN0YWxsUGF0aEtleSkKCiAgICAgICAgICAgIGlmICgkaW5zdGFsbFBhdGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRpbnN0YWxsUGF0aCA9IEpvaW4tUGF0aCAkaW5zdGFsbFBhdGggLUNoaWxkUGF0aCAnTXNEZXBsb3kuZXhlJwoKICAgICAgICAgICAgICAgIGlmIChUZXN0LVBhdGggJGluc3RhbGxQYXRoIC1QYXRoVHlwZSBMZWFmKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRtc2RlcGxveVBhdGggPSAkaW5zdGFsbFBhdGgKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnR2V0LU1TRGVwbG95Q21kOiBFbmQnCiAgICByZXR1cm4gJG1zZGVwbG95UGF0aAp9CgoKPCMKLlNZTk9QU0lTCkNyZWF0ZXMgYSBXaW5kb3dzIEF6dXJlIHdlYiBzaXRlLgoKLkRFU0NSSVBUSU9OCkNyZWF0ZXMgYSBXaW5kb3dzIEF6dXJlIHdlYiBzaXRlIHdpdGggdGhlIHNwZWNpZmljIG5hbWUgYW5kIGxvY2F0aW9uLiBUaGlzIGZ1bmN0aW9uIGNhbGxzIHRoZSBOZXctQXp1cmVXZWJzaXRlIGNtZGxldCBpbiB0aGUgQXp1cmUgbW9kdWxlLiBJZiB0aGUgc3Vic2NyaXB0aW9uIGRvZXMgbm90IHlldCBoYXZlIGEgd2ViIHNpdGUgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUsIHRoaXMgZnVuY3Rpb24gY3JlYXRlcyB0aGUgd2ViIHNpdGUgYW5kIHJldHVybnMgYSB3ZWIgc2l0ZSBvYmplY3QuIE90aGVyd2lzZSwgaXQgcmV0dXJucyAkbnVsbC4KCi5QQVJBTUVURVIgIE5hbWUKU3BlY2lmaWVzIGEgbmFtZSBmb3IgdGhlIG5ldyB3ZWIgc2l0ZS4gVGhlIG5hbWUgbXVzdCBiZSB1bmlxdWUgaW4gV2luZG93cyBBenVyZS4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouUEFSQU1FVEVSICBMb2NhdGlvbgpTcGVjaWZpZXMgdGhlIGxvY2F0aW9uIG9mIHRoZSB3ZWIgc2l0ZS4gVmFsaWQgdmFsdWVzIGFyZSB0aGUgV2luZG93cyBBenVyZSBsb2NhdGlvbnMsIHN1Y2ggYXMgIldlc3QgVVMiLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5JTlBVVFMKTk9ORS4KCi5PVVRQVVRTCk1pY3Jvc29mdC5XaW5kb3dzQXp1cmUuQ29tbWFuZHMuVXRpbGl0aWVzLldlYnNpdGVzLlNlcnZpY2VzLldlYkVudGl0aWVzLlNpdGUKCi5FWEFNUExFCkFkZC1BenVyZVdlYnNpdGUgLU5hbWUgVGVzdFNpdGUgLUxvY2F0aW9uICJXZXN0IFVTIgoKTmFtZSAgICAgICA6IGNvbnRvc28KU3RhdGUgICAgICA6IFJ1bm5pbmcKSG9zdCBOYW1lcyA6IGNvbnRvc28uYXp1cmV3ZWJzaXRlcy5uZXQKCi5MSU5LCk5ldy1BenVyZVdlYnNpdGUKIz4KZnVuY3Rpb24gQWRkLUF6dXJlV2Vic2l0ZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRMb2NhdGlvbgogICAgKQoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlV2Vic2l0ZTogU3RhcnQnCiAgICAkd2Vic2l0ZSA9IEdldC1BenVyZVdlYnNpdGUgLU5hbWUgJE5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCiAgICBpZiAoJHdlYnNpdGUpCiAgICB7CiAgICAgICAgV3JpdGUtSG9zdFdpdGhUaW1lICgnQWRkLUF6dXJlV2Vic2l0ZTogQW4gZXhpc3Rpbmcgd2ViIHNpdGUgJyArCiAgICAgICAgJHdlYnNpdGUuTmFtZSArICcgd2FzIGZvdW5kJykKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBpZiAoVGVzdC1BenVyZU5hbWUgLVdlYnNpdGUgLU5hbWUgJE5hbWUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1FcnJvcldpdGhUaW1lICgnV2Vic2l0ZSB7MH0gYWxyZWFkeSBleGlzdHMnIC1mICROYW1lKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkd2Vic2l0ZSA9IE5ldy1BenVyZVdlYnNpdGUgLU5hbWUgJE5hbWUgLUxvY2F0aW9uICRMb2NhdGlvbgogICAgICAgIH0KICAgIH0KCiAgICAkd2Vic2l0ZSB8IE91dC1TdHJpbmcgfCBXcml0ZS1WZXJib3NlV2l0aFRpbWUKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlV2Vic2l0ZTogRW5kJwoKICAgIHJldHVybiAkd2Vic2l0ZQp9Cgo8IwouU1lOT1BTSVMKUmV0dXJucyAkVHJ1ZSB3aGVuIHRoZSBVUkwgaXMgYWJzb2x1dGUgYW5kIGl0cyBzY2hlbWUgaXMgaHR0cHMuCgouREVTQ1JJUFRJT04KVGhlIFRlc3QtSHR0cHNVcmwgZnVuY3Rpb24gY29udmVydHMgdGhlIGlucHV0IFVSTCB0byBhIFN5c3RlbS5Vcmkgb2JqZWN0LiBSZXR1cm5zICRUcnVlIHdoZW4gdGhlIFVSTCBpcyBhYnNvbHV0ZSAobm90IHJlbGF0aXZlKSBhbmQgaXRzIHNjaGVtZSBpcyBodHRwcy4gSWYgZWl0aGVyIGlzIGZhbHNlLCBvciB0aGUgaW5wdXQgc3RyaW5nIGNhbm5vdCBiZSBjb252ZXJ0ZWQgdG8gYSBVUkwsIHRoZSBmdW5jdGlvbiByZXR1cm5zICRmYWxzZS4KCi5QQVJBTUVURVIgVXJsClNwZWNpZmllcyB0aGUgVVJMIHRvIHRlc3QuIEVudGVyIGEgVVJMIHN0cmluZywKCi5JTlBVVFMKTk9ORS4KCi5PVVRQVVRTClN5c3RlbS5Cb29sZWFuCgouRVhBTVBMRQpQUyBDOlw+JHByb2ZpbGUucHVibGlzaFVybAp3YXdzLXByb2QtYmF5LTAwMS5wdWJsaXNoLmF6dXJld2Vic2l0ZXMud2luZG93cy5uZXQ6NDQzCgpQUyBDOlw+VGVzdC1IdHRwc1VybCAtVXJsICd3YXdzLXByb2QtYmF5LTAwMS5wdWJsaXNoLmF6dXJld2Vic2l0ZXMud2luZG93cy5uZXQ6NDQzJwpGYWxzZQojPgpmdW5jdGlvbiBUZXN0LUh0dHBzVXJsCnsKCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVybAogICAgKQoKICAgICMgSWYgJHVyaSBjYW5ub3QgYmUgY29udmVydGVkIHRvIGEgU3lzdGVtLlVyaSBvYmplY3QsIFRlc3QtSHR0cHNVcmwgcmV0dXJucyAkZmFsc2UKICAgICR1cmkgPSAkVXJsIC1hcyBbU3lzdGVtLlVyaV0KCiAgICByZXR1cm4gJHVyaS5Jc0Fic29sdXRlVXJpIC1hbmQgJHVyaS5TY2hlbWUgLWVxICdodHRwcycKfQoKCjwjCi5TWU5PUFNJUwpEZXBsb3lzIGEgd2ViIHBhY2thZ2UgdG8gV2luZG93cyBBenVyZS4KCi5ERVNDUklQVElPTgpUaGUgUHVibGlzaC1XZWJQYWNrYWdlIGZ1bmN0aW9uIHVzZXMgTXNEZXBsb3kuZXhlIGFuZCBhIHdlYiBkZXBsb3ltZW50IHBhY2thZ2UgWklQIGZpbGUgdG8gZGVwbG95IHJlc291cmNlcyB0byBhIFdpbmRvd3MgQXp1cmUgd2ViIHNpdGUuIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgZ2VuZXJhdGUgYW55IG91dHB1dC4gSWYgdGhlIGNhbGwgdG8gTVNEZXBsb3kuZXhlIGZhaWxzLCB0aGUgZnVuY3Rpb24gdGhyb3dzIGFuIGV4Y2VwdGlvbi4gVG8gZ2V0IG1vcmUgZGV0YWlsZWQgb3V0cHV0LCB1c2UgdGhlIFZlcmJvc2UgY29tbW9uIHBhcmFtZXRlci4KCi5QQVJBTUVURVIgIFdlYkRlcGxveVBhY2thZ2UKU3BlY2lmaWVzIHRoZSBwYXRoIGFuZCBmaWxlIG5hbWUgb2YgYSB3ZWIgZGVwbG95bWVudCBwYWNrYWdlIFpJUCBmaWxlIHRoYXQgVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLiBUbyBjcmVhdGUgYSB3ZWIgZGVwbG95bWVudCBwYWNrYWdlIFpJUCBmaWxlLCBzZWUgIkhvdyB0bzogQ3JlYXRlIGEgV2ViIERlcGxveW1lbnQgUGFja2FnZSBpbiBWaXN1YWwgU3R1ZGlvIiBhdDogaHR0cDovL2dvLm1pY3Jvc29mdC5jb20vZndsaW5rLz9MaW5rSWQ9MzkxMzUzLgoKLlBBUkFNRVRFUiBQdWJsaXNoVXJsClNwZWNpZmllcyB0aGUgVVJMIHRvIHdoaWNoIHRoZSByZXNvdXJjZXMgYXJlIGRlcGxveWVkLiBUaGUgVVJMIG11c3QgdXNlIEhUVFBTIHByb3RvY29sIGFuZCBpbmNsdWRlIHRoZSBwb3J0LiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5QQVJBTUVURVIgU2l0ZU5hbWUKU3BlY2lmaWVzIGEgbmFtZSBmb3IgdGhlIHdlYiBzaXRlLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5QQVJBTUVURVIgVXNlcm5hbWUKU3BlY2lmaWVzIHRoZSB1c2VyIG5hbWUgb2YgdGhlIHdlYiBzaXRlIGFkbWluaXN0cmF0b3IuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBQYXNzd29yZApTcGVjaWZpZXMgYSBwYXNzd29yZCBmb3IgdGhlIHdlYiBzaXRlIGFkbWluaXN0cmF0b3IuIEVudGVyIGEgcGFzc3dvcmQgaW4gcGxhaW4gdGV4dC4gU2VjdXJlIHN0cmluZ3MgYXJlIG5vdCBwZXJtaXR0ZWQuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBBbGxvd1VudHJ1c3RlZApBbGxvd3MgdW50cnVzdGVkIFNTTCBjb25uZWN0aW9ucyB0byB0aGUgc2l0ZS4gVGhpcyBwYXJhbWV0ZXIgaXMgdXNlZCBpbiB0aGUgY2FsbCB0byBNU0RlcGxveS5leGUuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBDb25uZWN0aW9uU3RyaW5nClNwZWNpZmllcyBhIGNvbm5lY3Rpb24gc3RyaW5nIGZvciBhIFNRTCBkYXRhYmFzZS4gVGhpcyBwYXJhbWV0ZXIgdGFrZXMgYSBoYXNoIHRhYmxlIHdpdGggTmFtZSBhbmQgQ29ubmVjdGlvblN0cmluZyBrZXlzLiBUaGUgdmFsdWUgb2YgTmFtZSBpcyB0aGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UuIFRoZSB2YWx1ZSBvZiBDb25uZWN0aW9uU3RyaW5nIGlzIHRoZSBjb25uZWN0aW9uU3RyaW5nTmFtZSBpbiB0aGUgSlNPTiBjb25maWd1cmF0aW9uIGZpbGUuCgouSU5QVVRTCk5vbmUuIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgdGFrZSBpbnB1dCBmcm9tIHRoZSBwaXBlbGluZS4KCi5PVVRQVVRTCk5vbmUKCi5FWEFNUExFClB1Ymxpc2gtV2ViUGFja2FnZSAtV2ViRGVwbG95UGFja2FnZSBDOlxEb2N1bWVudHNcQXp1cmVcQURXZWJBcHAuemlwIGAKICAgIC1QdWJsaXNoVXJsICRwdWJsaXNoVXJsICJodHRwczovL2NvbnRvc28uY2xvdWRuZXQubmV0OjgxNzIvbXNkZXBsb3kuYXhkIiBgCiAgICAtU2l0ZU5hbWUgJ0NvbnRvc28gVGVzdCBTaXRlJyBgCiAgICAtVXNlck5hbWUgJFVzZXJOYW1lIGFkbWluMDEgYAogICAgLVBhc3N3b3JkICRVc2VyUGFzc3dvcmQgcGEkJHdvcmQgYAogICAgLUFsbG93VW50cnVzdGVkOiRGYWxzZSBgCiAgICAtQ29ubmVjdGlvblN0cmluZyBAe05hbWU9J1Rlc3REQic7Q29ubmVjdGlvblN0cmluZz0nRGVmYXVsdENvbm5lY3Rpb24nfQoKLkxJTksKUHVibGlzaC1XZWJQYWNrYWdlVG9WTQoKLkxJTksKV2ViIERlcGxveSBDb21tYW5kIExpbmUgUmVmZXJlbmNlIChNU0RlcGxveS5leGUpCmh0dHA6Ly9nby5taWNyb3NvZnQuY29tL2Z3bGluay8/TGlua0lkPTM5MTM1NAojPgpmdW5jdGlvbiBQdWJsaXNoLVdlYlBhY2thZ2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggJF8gLVBhdGhUeXBlIExlYWZ9KV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRXZWJEZXBsb3lQYWNrYWdlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTY3JpcHQoe1Rlc3QtSHR0cHNVcmwgJF8gfSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHVibGlzaFVybCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2l0ZU5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQYXNzd29yZCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJEFsbG93VW50cnVzdGVkID0gJGZhbHNlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbSGFzaHRhYmxlXQogICAgICAgICRDb25uZWN0aW9uU3RyaW5nCiAgICApCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdQdWJsaXNoLVdlYlBhY2thZ2U6IFN0YXJ0JwoKICAgICRtc2RlcGxveUNtZCA9IEdldC1NU0RlcGxveUNtZAoKICAgIGlmICghJG1zZGVwbG95Q21kKQogICAgewogICAgICAgIHRocm93ICdQdWJsaXNoLVdlYlBhY2thZ2U6IE1zRGVwbG95LmV4ZSBjYW5ub3QgYmUgZm91bmQuJwogICAgfQoKICAgICRXZWJEZXBsb3lQYWNrYWdlID0gKEdldC1JdGVtICRXZWJEZXBsb3lQYWNrYWdlKS5GdWxsTmFtZQoKICAgICRtc2RlcGxveUNtZCA9ICAnIicgKyAkbXNkZXBsb3lDbWQgKyAnIicKICAgICRtc2RlcGxveUNtZCArPSAnIC12ZXJiOnN5bmMnCiAgICAkbXNkZXBsb3lDbWQgKz0gJyAtU291cmNlOlBhY2thZ2U9InswfSInCiAgICAkbXNkZXBsb3lDbWQgKz0gJyAtZGVzdDphdXRvLGNvbXB1dGVybmFtZT0iezF9P3NpdGU9ezJ9Iix1c2VyTmFtZT17M30scGFzc3dvcmQ9ezR9LGF1dGhUeXBlPUJhc2ljJwogICAgaWYgKCRBbGxvd1VudHJ1c3RlZCkKICAgIHsKICAgICAgICAkbXNkZXBsb3lDbWQgKz0gJyAtYWxsb3dVbnRydXN0ZWQnCiAgICB9CiAgICAkbXNkZXBsb3lDbWQgKz0gJyAtc2V0UGFyYW06bmFtZT0iSUlTIFdlYiBBcHBsaWNhdGlvbiBOYW1lIix2YWx1ZT0iezJ9IicKCiAgICBmb3JlYWNoICgkREJDb25uZWN0aW9uIGluICRDb25uZWN0aW9uU3RyaW5nLkdldEVudW1lcmF0b3IoKSkKICAgIHsKICAgICAgICAkbXNkZXBsb3lDbWQgKz0gKCcgLXNldFBhcmFtOm5hbWU9InswfSIsdmFsdWU9InsxfSInIC1mICREQkNvbm5lY3Rpb24uS2V5LCAkREJDb25uZWN0aW9uLlZhbHVlKQogICAgfQoKICAgICRtc2RlcGxveUNtZCA9ICRtc2RlcGxveUNtZCAtZiAkV2ViRGVwbG95UGFja2FnZSwgJFB1Ymxpc2hVcmwsICRTaXRlTmFtZSwgJFVzZXJOYW1lLCAkUGFzc3dvcmQKCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgKCdQdWJsaXNoLVdlYlBhY2thZ2U6IE1zRGVwbG95OiAnICsgJG1zZGVwbG95Q21kKQoKICAgICRtc2RlcGxveUV4ZWN1dGlvbiA9IFN0YXJ0LVByb2Nlc3MgY21kLmV4ZSAtQXJndW1lbnRMaXN0ICgnL0MgIicgKyAkbXNkZXBsb3lDbWQgKyAnIiAnKSAtV2luZG93U3R5bGUgTm9ybWFsIC1XYWl0IC1QYXNzVGhydQoKICAgIGlmICgkbXNkZXBsb3lFeGVjdXRpb24uRXhpdENvZGUgLW5lIDApCiAgICB7CiAgICAgICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAoJ01zZGVwbG95LmV4ZSBleGl0ZWQgd2l0aCBlcnJvci4gRXhpdENvZGU6JyArICRtc2RlcGxveUV4ZWN1dGlvbi5FeGl0Q29kZSkKICAgIH0KCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ1B1Ymxpc2gtV2ViUGFja2FnZTogRW5kJwogICAgcmV0dXJuICgkbXNkZXBsb3lFeGVjdXRpb24uRXhpdENvZGUgLWVxIDApCn0KCgo8IwouU1lOT1BTSVMKRGVwbG95cyBhIHZpcnR1YWwgbWFjaGluZSB0byBXaW5kb3dzIEF6dXJlLgoKLkRFU0NSSVBUSU9OClRoZSBQdWJsaXNoLVdlYlBhY2thZ2VUb1ZNIGZ1bmN0aW9uIGlzIGEgaGVscGVyIGZ1bmN0aW9uIGZvciB0aGF0IHZlcmlmaWVzIHRoZSBwYXJhbWV0ZXIgdmFsdWVzIGFuZCB0aGVuIGNhbGxzIHRoZSBQdWJsaXNoLVdlYlBhY2thZ2UgZnVuY3Rpb24uCgouUEFSQU1FVEVSICBWTURuc05hbWUKU3BlY2lmaWVzIHRoZSBETlMgbmFtZSBvZiB0aGUgV2luZG93cyBBenVyZSB2aXJ0dWFsIG1hY2hpbmUuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBJaXNXZWJBcHBsaWNhdGlvbk5hbWUKU3BlY2lmaWVzIHRoZSBuYW1lIG9mIGFuIElJUyB3ZWIgYXBwbGljYXRpb24gZm9yIHRoZSB0aGUgdmlydHVhbCBtYWNoaW5lLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4gVGhpcyBpcyB0aGUgbmFtZSBvZiB5b3VyIFZpc3VhbCBTdHVkaW8gd2ViIGFwcC4gWW91IGNhbiBmaW5kIHRoZSBuYW1lIGluIHRoZSB3ZWJEZXBsb3lwYXJhbWV0ZXJzIGF0dHJpYnV0ZSBvZiB0aGUgSlNPTiBjb25maWd1cmF0aW9uIGZpbGUgdGhhdCBWaXN1YWwgU3R1ZGlvIGdlbmVyYXRlcy4KCi5QQVJBTUVURVIgV2ViRGVwbG95UGFja2FnZQpTcGVjaWZpZXMgdGhlIHBhdGggYW5kIGZpbGUgbmFtZSBvZiBhIHdlYiBkZXBsb3ltZW50IHBhY2thZ2UgWklQIGZpbGUgdGhhdCBWaXN1YWwgU3R1ZGlvIGdlbmVyYXRlcy4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuIFRvIGNyZWF0ZSBhIHdlYiBkZXBsb3ltZW50IHBhY2thZ2UgWklQIGZpbGUsIHNlZSAiSG93IHRvOiBDcmVhdGUgYSBXZWIgRGVwbG95bWVudCBQYWNrYWdlIGluIFZpc3VhbCBTdHVkaW8iIGF0OiBodHRwOi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJZD0zOTEzNTMuCgouUEFSQU1FVEVSIFVzZXJuYW1lClNwZWNpZmllcyB0aGUgdXNlciBuYW1lIG9mIHRoZSB2aXJ0dWFsIG1hY2hpbmUgYWRtaW5pc3RyYXRvci4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouUEFSQU1FVEVSIFBhc3N3b3JkClNwZWNpZmllcyBhIHBhc3N3b3JkIGZvciB0aGUgdmlydHVhbCBtYWNoaW5lIGFkbWluaXN0cmF0b3IuIEVudGVyIGEgcGFzc3dvcmQgaW4gcGxhaW4gdGV4dC4gU2VjdXJlIHN0cmluZ3MgYXJlIG5vdCBwZXJtaXR0ZWQuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBBbGxvd1VudHJ1c3RlZApBbGxvd3MgdW50cnVzdGVkIFNTTCBjb25uZWN0aW9ucyB0byB0aGUgc2l0ZS4gVGhpcyBwYXJhbWV0ZXIgaXMgdXNlZCBpbiB0aGUgY2FsbCB0byBNU0RlcGxveS5leGUuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiBDb25uZWN0aW9uU3RyaW5nClNwZWNpZmllcyBhIGNvbm5lY3Rpb24gc3RyaW5nIGZvciBhIFNRTCBkYXRhYmFzZS4gVGhpcyBwYXJhbWV0ZXIgdGFrZXMgYSBoYXNoIHRhYmxlIHdpdGggTmFtZSBhbmQgQ29ubmVjdGlvblN0cmluZyBrZXlzLiBUaGUgdmFsdWUgb2YgTmFtZSBpcyB0aGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UuIFRoZSB2YWx1ZSBvZiBDb25uZWN0aW9uU3RyaW5nIGlzIHRoZSBjb25uZWN0aW9uU3RyaW5nTmFtZSBpbiB0aGUgSlNPTiBjb25maWd1cmF0aW9uIGZpbGUuCgouSU5QVVRTCk5vbmUuIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgdGFrZSBpbnB1dCBmcm9tIHRoZSBwaXBlbGluZS4KCi5PVVRQVVRTCk5vbmUuCgouRVhBTVBMRQpQdWJsaXNoLVdlYlBhY2thZ2VUb1ZNIC1WTURuc05hbWUgY29udG9zby5jbG91ZGFwcC5uZXQgYAotSWlzV2ViQXBwbGljYXRpb25OYW1lIG15VGVzdFdlYkFwcCBgCi1XZWJEZXBsb3lQYWNrYWdlIEM6XERvY3VtZW50c1xBenVyZVxBRFdlYkFwcC56aXAKLVVzZXJuYW1lIGFkbWluMDEgYAotUGFzc3dvcmQgcGEkJHdvcmQgYAotQWxsb3dVbnRydXN0ZWQ6JEZhbHNlIGAKLUNvbm5lY3Rpb25TdHJpbmcgQHtOYW1lPSdUZXN0REInO0Nvbm5lY3Rpb25TdHJpbmc9J0RlZmF1bHRDb25uZWN0aW9uJ30KCi5MSU5LClB1Ymxpc2gtV2ViUGFja2FnZQojPgpmdW5jdGlvbiBQdWJsaXNoLVdlYlBhY2thZ2VUb1ZNCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVk1EbnNOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJElpc1dlYkFwcGxpY2F0aW9uTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggJF8gLVBhdGhUeXBlIExlYWZ9KV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRXZWJEZXBsb3lQYWNrYWdlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFVzZXJQYXNzd29yZCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW0Jvb2xdCiAgICAgICAgJEFsbG93VW50cnVzdGVkLAogICAgICAgIAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtIYXNodGFibGVdCiAgICAgICAgJENvbm5lY3Rpb25TdHJpbmcKICAgICkKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnUHVibGlzaC1XZWJQYWNrYWdlVG9WTTogU3RhcnQnCgogICAgJFZNRG5zVXJsID0gJFZNRG5zTmFtZSAtYXMgW1N5c3RlbS5VcmldCgogICAgaWYgKCEkVk1EbnNVcmwpCiAgICB7CiAgICAgICAgdGhyb3cgKCdQdWJsaXNoLVdlYlBhY2thZ2VUb1ZNOiBJbnZhbGlkIHVybCAnICsgJFZNRG5zVXJsKQogICAgfQoKICAgICRwdWJsaXNoVXJsID0gJ2h0dHBzOi8vezB9OnsxfS9tc2RlcGxveS5heGQnIC1mICRWTURuc1VybC5Ib3N0LCAkV2ViRGVwbG95UG9ydAoKICAgICRyZXN1bHQgPSBQdWJsaXNoLVdlYlBhY2thZ2UgYAogICAgICAgIC1XZWJEZXBsb3lQYWNrYWdlICRXZWJEZXBsb3lQYWNrYWdlIGAKICAgICAgICAtUHVibGlzaFVybCAkcHVibGlzaFVybCBgCiAgICAgICAgLVNpdGVOYW1lICRJaXNXZWJBcHBsaWNhdGlvbk5hbWUgYAogICAgICAgIC1Vc2VyTmFtZSAkVXNlck5hbWUgYAogICAgICAgIC1QYXNzd29yZCAkVXNlclBhc3N3b3JkIGAKICAgICAgICAtQWxsb3dVbnRydXN0ZWQ6JEFsbG93VW50cnVzdGVkIGAKICAgICAgICAtQ29ubmVjdGlvblN0cmluZyAkQ29ubmVjdGlvblN0cmluZwoKICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnUHVibGlzaC1XZWJQYWNrYWdlVG9WTTogRW5kJwogICAgcmV0dXJuICRyZXN1bHQKfQoKCjwjCi5TWU5PUFNJUwpDcmVhdGVzIGEgc3RyaW5nIHRoYXQgbGV0cyB5b3UgY29ubmVjdCB0byBhIFdpbmRvd3MgQXp1cmUgU1FMIGRhdGFiYXNlLgoKLkRFU0NSSVBUSU9OClRoZSBHZXQtQXp1cmVTUUxEYXRhYmFzZUNvbm5lY3Rpb25TdHJpbmcgZnVuY3Rpb24gYXNzZW1ibGVzIGEgY29ubmVjdGlvbiBzdHJpbmcgdG8gY29ubmVjdCB0byBhIFdpbmRvd3MgQXp1cmUgU1FMIGRhdGFiYXNlLgoKLlBBUkFNRVRFUiAgRGF0YWJhc2VTZXJ2ZXJOYW1lClNwZWNpZmllcyB0aGUgbmFtZSBvZiBhbiBleGlzdGluZyBkYXRhYmFzZSBzZXJ2ZXIgaW4gdGhlIFdpbmRvd3MgQXp1cmUgc3Vic2NyaXB0aW9uLiBBbGwgV2luZG93cyBBenVyZSBTUUwgZGF0YWJhc2VzIG11c3QgYmUgYXNzb2NpYXRlZCB3aXRoIGEgU1FMIGRhdGFiYXNlIHNlcnZlci4gVG8gZ2V0IHRoZSBzZXJ2ZXIgbmFtZSwgdXNlIHRoZSBHZXQtQXp1cmVTcWxEYXRhYmFzZVNlcnZlciBjbWRsZXQgKEF6dXJlIG1vZHVsZSkuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiAgRGF0YWJhc2VOYW1lClNwZWNpZmllcyB0aGUgbmFtZSBmb3IgdGhlIFNRTCBkYXRhYmFzZS4gVGhpcyBjYW4gYmUgYW4gZXhpc3RpbmcgU1FMIGRhdGFiYXNlIG9yIGEgbmFtZSB1c2VkIGZvciBhIG5ldyBTUUwgZGF0YWJhc2UuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLgoKLlBBUkFNRVRFUiAgVXNlcm5hbWUKU3BlY2lmaWVzIHRoZSBuYW1lIG9mIHRoZSBTUUwgZGF0YWJhc2UgYWRtaW5pc3RyYXRvci4gVGhlIHVzZXJuYW1lIHdpbGwgYmUgJFVzZXJuYW1lQERhdGFiYXNlU2VydmVyTmFtZS4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuCgouUEFSQU1FVEVSICBQYXNzd29yZApTcGVjaWZpZXMgYSBwYXNzd29yZCBmb3IgdGhlIFNRTCBkYXRhYmFzZSBhZG1pbmlzdHJhdG9yLiBFbnRlciBhIHBhc3N3b3JkIGluIHBsYWluIHRleHQuIFNlY3VyZSBzdHJpbmdzIGFyZSBub3QgcGVybWl0dGVkLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZC4KCi5JTlBVVFMKTm9uZS4KCi5PVVRQVVRTClN5c3RlbS5TdHJpbmcKCi5FWEFNUExFClBTIEM6XD4gJFNlcnZlck5hbWUgPSAoR2V0LUF6dXJlU3FsRGF0YWJhc2VTZXJ2ZXIpLlNlcnZlck5hbWUKUFMgQzpcPiBHZXQtQXp1cmVTUUxEYXRhYmFzZUNvbm5lY3Rpb25TdHJpbmcgLURhdGFiYXNlU2VydmVyTmFtZSAkU2VydmVyTmFtZSBgCiAgICAgICAgLURhdGFiYXNlTmFtZSAndGVzdGRiJyAtVXNlck5hbWUgJ2FkbWluJyAgLVBhc3N3b3JkICdwYSQkd29yZCcKClNlcnZlcj10Y3A6YmViYWQxMjM0NS5kYXRhYmFzZS53aW5kb3dzLm5ldCwxNDMzO0RhdGFiYXNlPXRlc3RkYjtVc2VyIElEPWFkbWluQGJlYmFkMTIzNDU7UGFzc3dvcmQ9cGEkJHdvcmQ7VHJ1c3RlZF9Db25uZWN0aW9uPUZhbHNlO0VuY3J5cHQ9VHJ1ZTtDb25uZWN0aW9uIFRpbWVvdXQ9MjA7CiM+CmZ1bmN0aW9uIEdldC1BenVyZVNRTERhdGFiYXNlQ29ubmVjdGlvblN0cmluZwp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREYXRhYmFzZVNlcnZlck5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJERhdGFiYXNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVXNlck5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhc3N3b3JkCiAgICApCgogICAgcmV0dXJuICgnU2VydmVyPXRjcDp7MH0uZGF0YWJhc2Uud2luZG93cy5uZXQsMTQzMztEYXRhYmFzZT17MX07JyArCiAgICAgICAgICAgJ1VzZXIgSUQ9ezJ9QHswfTsnICsKICAgICAgICAgICAnUGFzc3dvcmQ9ezN9OycgKwogICAgICAgICAgICdUcnVzdGVkX0Nvbm5lY3Rpb249RmFsc2U7JyArCiAgICAgICAgICAgJ0VuY3J5cHQ9VHJ1ZTsnICsKICAgICAgICAgICAnQ29ubmVjdGlvbiBUaW1lb3V0PTIwOycpIGAKICAgICAgICAgICAtZiAkRGF0YWJhc2VTZXJ2ZXJOYW1lLCAkRGF0YWJhc2VOYW1lLCAkVXNlck5hbWUsICRQYXNzd29yZAp9CgoKPCMKLlNZTk9QU0lTCkNyZWF0ZXMgV2luZG93cyBBenVyZSBTUUwgZGF0YWJhc2VzIGZyb20gdGhlIHZhbHVlcyBpbiB0aGUgSlNPTiBjb25maWd1YXRpb24gZmlsZSB0aGF0IFZpc3VhbCBTdHVkaW8gZ2VuZXJhdGVzLgoKLkRFU0NSSVBUSU9OClRoZSBBZGQtQXp1cmVTUUxEYXRhYmFzZXMgZnVuY3Rpb24gdGFrZXMgaW5mb3JtYXRpb24gZnJvbSB0aGUgZGF0YWJhc2VzIHNlY3Rpb24gb2YgdGhlIEpTT04gZmlsZS4gVGhpcyBmdW5jdGlvbiwgQWRkLUF6dXJlU1FMRGF0YWJhc2VzIChwbHVyYWwpLCBjYWxscyB0aGUgQWRkLUF6dXJlU1FMRGF0YWJhc2UgKHNpbmd1bGFyKSBmdW5jdGlvbiBmb3IgZWFjaCBTUUwgZGF0YWJhc2UgaW4gdGhlIEpTT04gZmlsZS4gQWRkLUF6dXJlU1FMRGF0YWJhc2UgKHNpbmd1bGFyKSBjYWxscyB0aGUgTmV3LUF6dXJlU3FsRGF0YWJhc2UgY21kbGV0IChBenVyZSBtb2R1bGUpLCB3aGljaCBjcmVhdGVzIHRoZSBTUUwgZGF0YWJhc2VzLiBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90IHJldHVybiBhIGRhdGFiYXNlIG9iamVjdC4gSXQgcmV0dXJucyBhIGhhc2h0YWJsZSBvZiB2YWx1ZXMgdGhhdCB3ZXJlIHVzZWQgdG8gY3JlYXRlIHRoZSBkYXRhYmFzZXMuCgouUEFSQU1FVEVSIERhdGFiYXNlQ29uZmlnCiBUYWtlcyBhbiBhcnJheSBvZiBQU0N1c3RvbU9iamVjdHMgdGhhdCBvcmlnaW5hdGUgaW4gdGhlIEpTT04gZmlsZSB0aGF0IHRoZSBSZWFkLUNvbmZpZ0ZpbGUgZnVuY3Rpb24gcmV0dXJucyB3aGVuIHRoZSBKU09OIGZpbGUgaGFzIGEgd2ViIHNpdGUgcHJvcGVydHkuIEl0IGluY2x1ZGVzIHRoZSBlbnZpcm9ubWVudFNldHRpbmdzLmRhdGFiYXNlcyBwcm9wZXJ0aWVzLiBZb3UgY2FuIHBpcGUgdGhlIGxpc3QgdG8gdGhpcyBmdW5jdGlvbi4KUFMgQzpcPiAkY29uZmlnID0gUmVhZC1Db25maWdGaWxlIDxuYW1lPi5qc29uClBTIEM6XD4gJERhdGFiYXNlQ29uZmlnID0gJGNvbmZpZy5kYXRhYmFzZXN8IHdoZXJlIGNvbm5lY3Rpb25TdHJpbmdOYW1lClBTIEM6XD4gJERhdGFiYXNlQ29uZmlnCmNvbm5lY3Rpb25TdHJpbmdOYW1lOiBEZWZhdWx0IENvbm5lY3Rpb24KZGF0YWJhc2VuYW1lIDogVGVzdERCMQplZGl0aW9uICAgOgpzaXplICAgICA6IDEKY29sbGF0aW9uICA6IFNRTF9MYXRpbjFfR2VuZXJhbF9DUDFfQ0lfQVMKc2VydmVydHlwZSAgOiBOZXcgU1FMIERhdGFiYXNlIFNlcnZlcgpzZXJ2ZXJuYW1lICA6IHIwNDB0dnQyZ3gKdXNlciAgICAgOiBkYnVzZXIKcGFzc3dvcmQgICA6IFRlc3QuMTIzCmxvY2F0aW9uICAgOiBXZXN0IFVTCgouUEFSQU1FVEVSICBEYXRhYmFzZVNlcnZlclBhc3N3b3JkClNwZWNpZmllcyB0aGUgcGFzc3dvcmQgZm9yIHRoZSBTUUwgZGF0YWJhc2Ugc2VydmVyIGFkbWluaXN0cmF0b3IuIEVudGVyIGEgaGFzaHRhYmxlIHdpdGggTmFtZSBhbmQgUGFzc3dvcmQga2V5cy4gVGhlIHZhbHVlIG9mIE5hbWUgaXMgdGhlIG5hbWUgb2YgdGhlIFNRTCBkYXRhYmFzZSBzZXJ2ZXIuIFRoZSB2YWx1ZSBvZiBQYXNzd29yZCBpcyB0aGUgYWRtaW5pc3RyYXRvciBwYXNzd29yZC4gRm9yIGV4YW1wbGU6IEBOYW1lID0gIlRlc3REQjEiOyBQYXNzd29yZCA9ICJwYSQkd29yZCIgVGhpcyBwYXJhbWV0ZXIgaXMgb3B0aW9uYWwuIElmIHlvdSBvbWl0IGl0IG9yIHRoZSBTUUwgZGF0YWJhc2Ugc2VydmVyIG5hbWUgZG9lc24ndCBtYXRjaCB0aGUgdmFsdWUgb2YgdGhlIHNlcnZlck5hbWUgcHJvcGVydHkgb2YgdGhlICREYXRhYmFzZUNvbmZpZyBvYmplY3QsIHRoZSBmdW5jdGlvbiB1c2VzIHRoZSBQYXNzd29yZCBwcm9wZXJ0eSBvZiB0aGUgJERhdGFiYXNlQ29uZmlnIG9iamVjdCBmb3IgdGhlIFNRTCBkYXRhYmFzZSBpbiB0aGUgY29ubmVjdGlvbiBzdHJpbmcuCgouUEFSQU1FVEVSIENyZWF0ZURhdGFiYXNlClZlcmlmaWVzIHRoYXQgeW91IHdhbnQgdG8gY3JlYXRlIGEgZGF0YWJhc2UuIFRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLgoKLklOUFVUUwpTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlW10KCi5PVVRQVVRTClN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGUKCi5FWEFNUExFClBTIEM6XD4gJGNvbmZpZyA9IFJlYWQtQ29uZmlnRmlsZSA8bmFtZT4uanNvbgpQUyBDOlw+ICREYXRhYmFzZUNvbmZpZyA9ICRjb25maWcuZGF0YWJhc2VzfCB3aGVyZSAkY29ubmVjdGlvblN0cmluZ05hbWUKUFMgQzpcPiAkRGF0YWJhc2VDb25maWcgfCBBZGQtQXp1cmVTUUxEYXRhYmFzZXMKCk5hbWUgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZQotLS0tICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0tLS0KQ29ubmVjdGlvblN0cmluZyAgICAgICAgICAgICAgIFNlcnZlcj10Y3A6dGVzdGRiMS5kYXRhYmFzZS53aW5kb3dzLm5ldCwxNDMzO0RhdGFiYXNlPXRlc3RkYjtVc2VyIElEPWFkbWluQHRlc3RkYjE7UGFzc3dvcmQ9cGEkJHdvcmQ7VHJ1c3RlZF9Db25uZWN0aW9uPUZhbHNlO0VuY3J5cHQ9VHJ1ZTtDb25uZWN0aW9uIFRpbWVvdXQ9MjA7Ck5hbWUgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0IENvbm5lY3Rpb24KVHlwZSAgICAgICAgICAgICAgICAgICAgICAgICAgIFNRTEF6dXJlCgouTElOSwpHZXQtQXp1cmVTUUxEYXRhYmFzZUNvbm5lY3Rpb25TdHJpbmcKCi5MSU5LCkNyZWF0ZS1BenVyZVNRTERhdGFiYXNlCiM+CmZ1bmN0aW9uIEFkZC1BenVyZVNRTERhdGFiYXNlcwp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBWYWx1ZUZyb21QaXBlbGluZSA9ICR0cnVlKV0KICAgICAgICBbUFNDdXN0b21PYmplY3RdCiAgICAgICAgJERhdGFiYXNlQ29uZmlnLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtIYXNodGFibGVbXV0KICAgICAgICAkRGF0YWJhc2VTZXJ2ZXJQYXNzd29yZCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJENyZWF0ZURhdGFiYXNlID0gJHRydWUKICAgICkKCiAgICBiZWdpbgogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlU1FMRGF0YWJhc2VzOiBTdGFydCcKICAgIH0KICAgIHByb2Nlc3MKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgKCdBZGQtQXp1cmVTUUxEYXRhYmFzZXM6IENyZWF0aW5nICcgKyAkRGF0YWJhc2VDb25maWcuZGF0YWJhc2VOYW1lKQoKICAgICAgICBpZiAoJENyZWF0ZURhdGFiYXNlKQogICAgICAgIHsKICAgICAgICAgICAgIyBDcmVhdGVzIGEgbmV3IFNRTCBkYXRhYmFzZSB3aXRoIHRoZSBEYXRhYmFzZUNvbmZpZyB2YWx1ZXMgKHVubGVzcyBvbmUgYWxyZWFkeSBleGlzdHMpCiAgICAgICAgICAgICMgVGhlIGNvbW1hbmQgb3V0cHV0IGlzIHN1cHByZXNzZWQuCiAgICAgICAgICAgIEFkZC1BenVyZVNRTERhdGFiYXNlIC1EYXRhYmFzZUNvbmZpZyAkRGF0YWJhc2VDb25maWcgfCBPdXQtTnVsbAogICAgICAgIH0KCiAgICAgICAgJHNlcnZlclBhc3N3b3JkID0gJG51bGwKICAgICAgICBpZiAoJERhdGFiYXNlU2VydmVyUGFzc3dvcmQpCiAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoICgkY3JlZGVudGlhbCBpbiAkRGF0YWJhc2VTZXJ2ZXJQYXNzd29yZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICBpZiAoJGNyZWRlbnRpYWwuTmFtZSAtZXEgJERhdGFiYXNlQ29uZmlnLnNlcnZlck5hbWUpCiAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICRzZXJ2ZXJQYXNzd29yZCA9ICRjcmVkZW50aWFsLnBhc3N3b3JkICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9ICAgICAgICAgICAgICAgCiAgICAgICAgfQoKICAgICAgICBpZiAoISRzZXJ2ZXJQYXNzd29yZCkKICAgICAgICB7CiAgICAgICAgICAgICRzZXJ2ZXJQYXNzd29yZCA9ICREYXRhYmFzZUNvbmZpZy5wYXNzd29yZAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgIE5hbWUgPSAkRGF0YWJhc2VDb25maWcuY29ubmVjdGlvblN0cmluZ05hbWU7CiAgICAgICAgICAgIFR5cGUgPSAnU1FMQXp1cmUnOwogICAgICAgICAgICBDb25uZWN0aW9uU3RyaW5nID0gR2V0LUF6dXJlU1FMRGF0YWJhc2VDb25uZWN0aW9uU3RyaW5nIGAKICAgICAgICAgICAgICAgIC1EYXRhYmFzZVNlcnZlck5hbWUgJERhdGFiYXNlQ29uZmlnLnNlcnZlck5hbWUgYAogICAgICAgICAgICAgICAgLURhdGFiYXNlTmFtZSAkRGF0YWJhc2VDb25maWcuZGF0YWJhc2VOYW1lIGAKICAgICAgICAgICAgICAgIC1Vc2VyTmFtZSAkRGF0YWJhc2VDb25maWcudXNlciBgCiAgICAgICAgICAgICAgICAtUGFzc3dvcmQgJHNlcnZlclBhc3N3b3JkIH0KICAgIH0KICAgIGVuZAogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2VXaXRoVGltZSAnQWRkLUF6dXJlU1FMRGF0YWJhc2VzOiBFbmQnCiAgICB9Cn0KCgo8IwouU1lOT1BTSVMKQ3JlYXRlcyBhIG5ldyBXaW5kb3dzIEF6dXJlIFNRTCBkYXRhYmFzZS4KCi5ERVNDUklQVElPTgpUaGUgQWRkLUF6dXJlU1FMRGF0YWJhc2UgZnVuY3Rpb24gY3JlYXRlcyBhIFdpbmRvd3MgQXp1cmUgU1FMIGRhdGFiYXNlIGZyb20gdGhlIGRhdGEgaW4gdGhlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIHRoYXQgVmlzdWFsIFN0dWRpbyBnZW5lcmF0ZXMgYW5kIHJldHVybnMgdGhlIG5ldyBkYXRhYmFzZS4gSWYgdGhlIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGhhcyBhIFNRTCBkYXRhYmFzZSB3aXRoIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UgbmFtZSBpbiB0aGUgc3BlY2lmaWVkIFNRTCBkYXRhYmFzZSBzZXJ2ZXIsIHRoZSBmdW5jdGlvbiByZXR1cm5zIHRoZSBleGlzdGluZyBkYXRhYmFzZS4gVGhpcyBmdW5jdGlvbiBjYWxscyB0aGUgTmV3LUF6dXJlU3FsRGF0YWJhc2UgY21kbGV0IChBenVyZSBtb2R1bGUpLCB3aGljaCBhY3R1YWxseSBjcmVhdGVzIHRoZSBTUUwgZGF0YWJhc2UuCgouUEFSQU1FVEVSIERhdGFiYXNlQ29uZmlnClRha2VzIGEgUFNDdXN0b21PYmplY3QgdGhhdCBvcmlnaW5hdGVzIGluIHRoZSBKU09OIGNvbmZpZ3VyYXRpb24gZmlsZSB0aGF0IHRoZSBSZWFkLUNvbmZpZ0ZpbGUgZnVuY3Rpb24gcmV0dXJucyB3aGVuIHRoZSBKU09OIGZpbGUgaGFzIGEgd2ViIHNpdGUgcHJvcGVydHkuIEl0IGluY2x1ZGVzIHRoZSBlbnZpcm9ubWVudFNldHRpbmdzLmRhdGFiYXNlcyBwcm9wZXJ0aWVzLiBZb3UgY2Fubm90IHBpcGUgdGhlIG9iamVjdCB0byB0aGlzIGZ1bmN0aW9uLiBWaXN1YWwgU3R1ZGlvIGdlbmVyYXRlcyBhIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIGZvciBhbGwgd2ViIHByb2plY3RzIGFuZCBzdG9yZXMgaXQgaW4gdGhlIFB1Ymxpc2hTY3JpcHRzIGZvbGRlciBvZiB5b3VyIHNvbHV0aW9uLgoKLklOUFVUUwpOb25lLiBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90IHRha2UgaW5wdXQgZnJvbSB0aGUgcGlwZWxpbmUKCi5PVVRQVVRTCk1pY3Jvc29mdC5XaW5kb3dzQXp1cmUuQ29tbWFuZHMuU3FsRGF0YWJhc2UuU2VydmljZXMuU2VydmVyLkRhdGFiYXNlCgouRVhBTVBMRQpQUyBDOlw+ICRjb25maWcgPSBSZWFkLUNvbmZpZ0ZpbGUgPG5hbWU+Lmpzb24KUFMgQzpcPiAkRGF0YWJhc2VDb25maWcgPSAkY29uZmlnLmRhdGFiYXNlcyB8IHdoZXJlIGNvbm5lY3Rpb25TdHJpbmdOYW1lClBTIEM6XD4gJERhdGFiYXNlQ29uZmlnCgpjb25uZWN0aW9uU3RyaW5nTmFtZSAgICA6IERlZmF1bHQgQ29ubmVjdGlvbgpkYXRhYmFzZW5hbWUgOiBUZXN0REIxCmVkaXRpb24gICAgICA6CnNpemUgICAgICAgICA6IDEKY29sbGF0aW9uICAgIDogU1FMX0xhdGluMV9HZW5lcmFsX0NQMV9DSV9BUwpzZXJ2ZXJ0eXBlICAgOiBOZXcgU1FMIERhdGFiYXNlIFNlcnZlcgpzZXJ2ZXJuYW1lICAgOiByMDQwdHZ0Mmd4CnVzZXIgICAgICAgICA6IGRidXNlcgpwYXNzd29yZCAgICAgOiBUZXN0LjEyMwpsb2NhdGlvbiAgICAgOiBXZXN0IFVTCgpQUyBDOlw+IEFkZC1BenVyZVNRTERhdGFiYXNlIC1EYXRhYmFzZUNvbmZpZyAkRGF0YWJhc2VDb25maWcKCi5MSU5LCkFkZC1BenVyZVNRTERhdGFiYXNlcwoKLkxJTksKTmV3LUF6dXJlU1FMRGF0YWJhc2UKIz4KZnVuY3Rpb24gQWRkLUF6dXJlU1FMRGF0YWJhc2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbCgpXQogICAgICAgIFtPYmplY3RdCiAgICAgICAgJERhdGFiYXNlQ29uZmlnCiAgICApCgogICAgV3JpdGUtVmVyYm9zZVdpdGhUaW1lICdBZGQtQXp1cmVTUUxEYXRhYmFzZTogU3RhcnQnCgogICAgIyBGYWlsIGlmIHRoZSBwYXJhbWV0ZXIgdmFsdWUgZG9lc24ndCBoYXZlIHRoZSBzZXJ2ZXJOYW1lIHByb3BlcnR5LCBvciB0aGUgc2VydmVyTmFtZSBwcm9wZXJ0eSB2YWx1ZSBpc24ndCBwb3B1bGF0ZWQuCiAgICBpZiAoLW5vdCAoVGVzdC1NZW1iZXIgJERhdGFiYXNlQ29uZmlnICdzZXJ2ZXJOYW1lJykgLW9yIC1ub3QgJERhdGFiYXNlQ29uZmlnLnNlcnZlck5hbWUpCiAgICB7CiAgICAgICAgdGhyb3cgJ0FkZC1BenVyZVNRTERhdGFiYXNlOiBUaGUgZGF0YWJhc2Ugc2VydmVyTmFtZSAocmVxdWlyZWQpIGlzIG1pc3NpbmcgZnJvbSB0aGUgRGF0YWJhc2VDb25maWcgdmFsdWUuJwogICAgfQoKICAgICMgRmFpbCBpZiB0aGUgcGFyYW1ldGVyIHZhbHVlIGRvZXNuJ3QgaGF2ZSB0aGUgZGF0YWJhc2VuYW1lIHByb3BlcnR5LCBvciB0aGUgZGF0YWJhc2VuYW1lIHByb3BlcnR5IHZhbHVlIGlzbid0IHBvcHVsYXRlZC4KICAgIGlmICgtbm90IChUZXN0LU1lbWJlciAkRGF0YWJhc2VDb25maWcgJ2RhdGFiYXNlTmFtZScpIC1vciAtbm90ICREYXRhYmFzZUNvbmZpZy5kYXRhYmFzZU5hbWUpCiAgICB7CiAgICAgICAgdGhyb3cgJ0FkZC1BenVyZVNRTERhdGFiYXNlOiBUaGUgZGF0YWJhc2VuYW1lIChyZXF1aXJlZCkgaXMgbWlzc2luZyBmcm9tIHRoZSBEYXRhYmFzZUNvbmZpZyB2YWx1ZS4nCiAgICB9CgogICAgJERiU2VydmVyID0gJG51bGwKCiAgICBpZiAoVGVzdC1IdHRwc1VybCAkRGF0YWJhc2VDb25maWcuc2VydmVyTmFtZSkKICAgIHsKICAgICAgICAkYWJzb2x1dGVEYlNlcnZlciA9ICREYXRhYmFzZUNvbmZpZy5zZXJ2ZXJOYW1lIC1hcyBbU3lzdGVtLlVyaV0KICAgICAgICAkc3Vic2NyaXB0aW9uID0gR2V0LUF6dXJlU3Vic2NyaXB0aW9uIC1DdXJyZW50IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgogICAgICAgIGlmICgkc3Vic2NyaXB0aW9uIC1hbmQgJHN1YnNjcmlwdGlvbi5TZXJ2aWNlRW5kcG9pbnQgLWFuZCAkc3Vic2NyaXB0aW9uLlN1YnNjcmlwdGlvbklkKQogICAgICAgIHsKICAgICAgICAgICAgJGFic29sdXRlRGJTZXJ2ZXJSZWdleCA9ICdodHRwczpcL1wvezB9XC97MX1cL3NlcnZpY2VzXC9zcWxzZXJ2ZXJzXC9zZXJ2ZXJzXC8oLispXC5kYXRhYmFzZVwud2luZG93c1wubmV0XC9kYXRhYmFzZXMnIC1mIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdWJzY3JpcHRpb24uc2VydmljZUVuZHBvaW50Lkhvc3QsICRzdWJzY3JpcHRpb24uU3Vic2NyaXB0aW9uSWQKCiAgICAgICAgICAgIGlmICgkYWJzb2x1dGVEYlNlcnZlciAtbWF0Y2ggJGFic29sdXRlRGJTZXJ2ZXJSZWdleCAtYW5kICRNYXRjaGVzLkNvdW50IC1lcSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgJERiU2VydmVyID0gJE1hdGNoZXNbMV0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBpZiAoISREYlNlcnZlcikKICAgIHsKICAgICAgICAkRGJTZXJ2ZXIgPSAkRGF0YWJhc2VDb25maWcuc2VydmVyTmFtZQogICAgfQoKICAgICRkYiA9IEdldC1BenVyZVNxbERhdGFiYXNlIC1TZXJ2ZXJOYW1lICREYlNlcnZlciAtRGF0YWJhc2VOYW1lICREYXRhYmFzZUNvbmZpZy5kYXRhYmFzZU5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCiAgICBpZiAoJGRiKQogICAgewogICAgICAgIFdyaXRlLUhvc3RXaXRoVGltZSAoJ0NyZWF0ZS1BenVyZVNRTERhdGFiYXNlOiBVc2luZyBleGlzdGluZyBkYXRhYmFzZSAnICsgJGRiLk5hbWUpCiAgICAgICAgJGRiIHwgT3V0LVN0cmluZyB8IFdyaXRlLVZlcmJvc2VXaXRoVGltZQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRwYXJhbSA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIEhhc2h0YWJsZQogICAgICAgICRwYXJhbS5BZGQoJ3NlcnZlck5hbWUnLCAkRGJTZXJ2ZXIpCiAgICAgICAgJHBhcmFtLkFkZCgnZGF0YWJhc2VOYW1lJywgJERhdGFiYXNlQ29uZmlnLmRhdGFiYXNlTmFtZSkKCiAgICAgICAgaWYgKChUZXN0LU1lbWJlciAkRGF0YWJhc2VDb25maWcgJ3NpemUnKSAtYW5kICREYXRhYmFzZUNvbmZpZy5zaXplKQogICAgICAgIHsKICAgICAgICAgICAgJHBhcmFtLkFkZCgnTWF4U2l6ZUdCJywgJERhdGFiYXNlQ29uZmlnLnNpemUpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRwYXJhbS5BZGQoJ01heFNpemVHQicsIDEpCiAgICAgICAgfQoKICAgICAgICAjIElmIHRoZSAkRGF0YWJhc2VDb25maWcgb2JqZWN0IGhhcyBhIGNvbGxhdGlvbiBwcm9wZXJ0eSBhbmQgaXQncyBub3QgbnVsbCBvciBlbXB0eQogICAgICAgIGlmICgoVGVzdC1NZW1iZXIgJERhdGFiYXNlQ29uZmlnICdjb2xsYXRpb24nKSAtYW5kICREYXRhYmFzZUNvbmZpZy5jb2xsYXRpb24pCiAgICAgICAgewogICAgICAgICAgICAkcGFyYW0uQWRkKCdDb2xsYXRpb24nLCAkRGF0YWJhc2VDb25maWcuY29sbGF0aW9uKQogICAgICAgIH0KCiAgICAgICAgIyBJZiB0aGUgJERhdGFiYXNlQ29uZmlnIG9iamVjdCBoYXMgYW4gZWRpdGlvbiBwcm9wZXJ0eSBhbmQgaXQncyBub3QgbnVsbCBvciBlbXB0eQogICAgICAgIGlmICgoVGVzdC1NZW1iZXIgJERhdGFiYXNlQ29uZmlnICdlZGl0aW9uJykgLWFuZCAkRGF0YWJhc2VDb25maWcuZWRpdGlvbikKICAgICAgICB7CiAgICAgICAgICAgICRwYXJhbS5BZGQoJ0VkaXRpb24nLCAkRGF0YWJhc2VDb25maWcuZWRpdGlvbikKICAgICAgICB9CgogICAgICAgICMgV3JpdGUgdGhlIGhhc2ggdGFibGUgdG8gdGhlIFZlcmJvc2Ugc3RyZWFtCiAgICAgICAgJHBhcmFtIHwgT3V0LVN0cmluZyB8IFdyaXRlLVZlcmJvc2VXaXRoVGltZQogICAgICAgICMgQ2FsbCBOZXctQXp1cmVTcWxEYXRhYmFzZSB3aXRoIHNwbGF0dGluZyAoc3VwcHJlc3MgdGhlIG91dHB1dCkKICAgICAgICAkZGIgPSBOZXctQXp1cmVTcWxEYXRhYmFzZSBAcGFyYW0KICAgIH0KCiAgICBXcml0ZS1WZXJib3NlV2l0aFRpbWUgJ0FkZC1BenVyZVNRTERhdGFiYXNlOiBFbmQnCiAgICByZXR1cm4gJGRiCn0K
