profile.ps1,c017411253f8ead2fb399c09c1d6e317,Scan result is 1. IsMalware: 0,d3JpdGUtaG9zdCAiTG9hZGluZyBwb3dlcnNoZWxsIHByb2ZpbGUuIjsKCiMgUG93ZXJzaGVsbCBsYWNrcyBhIG51bGwtY29hbGVzY2luZyAoPz8pIG9wZXJhdG9yLCBzbyB0aGlzIGZ1bmN0aW9uIG1ha2VzIHVwIGZvciBpdC4KZnVuY3Rpb24gQ29hbGVzY2UoJGEsICRiKSB7IGlmICgkYSAtbmUgJG51bGwpIHsgJGEgfSBlbHNlIHsgJGIgfSB9CgojIEVhc2lseSBhZGQgYSBwcm9wZXJ0eSB0byBhIGN1c3RvbSBvYmplY3QKZnVuY3Rpb24gQWRkUHJvcFRvLU9iamVjdCgkb2JqLCAkcHJvcE5hbWUsICR2YWx1ZSkgewogICAgJG9iaiB8IEFkZC1NZW1iZXIgLXR5cGUgTm90ZVByb3BlcnR5IC1uYW1lICRwcm9wTmFtZSAtdmFsdWUgJHZhbHVlOwoKICAgIHJldHVybiAkb2JqOwp9CgpTZXQtQWxpYXMgLW5hbWUgPz8gLXZhbHVlIENvYWxlc2NlOwpTZXQtQWxpYXMgLW5hbWUgcHJvcCAtdmFsdWUgQWRkUHJvcFRvLU9iamVjdDsKCiMgU2F2ZSB0aGUgcHJvZmlsZSBuYW1lIGZvciB1c2Ugd2hlbiBjb3B5aW5nIGJldHdlZW4gJFByb2ZpbGUgYW5kICRvbmVkcml2ZS9wcm9maWxlCiRwcm9maWxlTmFtZSA9IChnZXQtaXRlbSAkcHJvZmlsZSkuTmFtZTsKJHByb2ZpbGVGb2xkZXIgPSBzcGxpdC1wYXRoICRwcm9maWxlOwokdXNlcm5hbWUgPSA/PyAkZW52OnVzZXJuYW1lICQod2hvYW1pKTsKCmZ1bmN0aW9uIGdldE1hY2hpbmVUeXBlKCkgewogICAgaWYgKCRJc0xpbnV4KSB7CiAgICAgICAgcmV0dXJuICJMaW51eCI7CiAgICB9OwoKICAgIGlmICgkSXNPU1gpIHsKICAgICAgICByZXR1cm4gIm1hY09TIjsKICAgIH0KCiAgICByZXR1cm4gIldpbmRvd3MiOwp9CgokbWFjaGluZVR5cGUgPSBnZXRNYWNoaW5lVHlwZTsKIyBJc0xpbnV4LCBJc09TWCBhbmQgSXNXaW5kb3dzIGFyZSBwcm92aWRlZCBieSBQUyBvbiAuTkVUIENvcmUsIGJ1dCBub3Qgb24gdmFuaWxsYSBXaW5kb3dzLiAKJGlzTm90V2luZG93cyA9ICRJc0xpbnV4IC1vciAkSXNPU1g7CgojIEN1c3RvbWl6ZSB0aGUgcG9zaC1naXQgcHJvbXB0IHRvIG9ubHkgc2hvdyB0aGUgY3VycmVudCBmb2xkZXIgbmFtZSArIGdpdCBzdGF0dXMKZnVuY3Rpb24gcHJvbXB0IHsKICAgICRvcmlnTGFzdEV4aXRDb2RlID0gJExBU1RFWElUQ09ERTsKICAgICRmb2xkZXJOYW1lID0gKGdldC1pdGVtICRwd2QpLk5hbWU7CiAgICAjICRlbW9qaSA9IFtjaGFyXTo6Q29udmVydEZyb21VdGYzMigweDFGOTE0KTsgIAoKICAgIGlmICgkaXNOb3RXaW5kb3dzKSB7CiAgICAgICAgIyBBIGJ1ZyBpbiBQU1JlYWRsaW5lIG9uIC5ORVQgQ29yZSBtYWtlcyBhbGwgY29sb3JlZCB3cml0ZS1ob3N0IG91dHB1dCBpbiBwcm9tcHQgCiAgICAgICAgIyBmdW5jdGlvbiwgaW5jbHVkaW5nIHdyaXRlLXZjc3N0YXR1cywgZWNobyB0d2ljZS4KICAgICAgICAjIGh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwvaXNzdWVzLzE4OTcKICAgICAgICAjIGh0dHBzOi8vZ2l0aHViLmNvbS9senlia3IvUFNSZWFkTGluZS9pc3N1ZXMvNDY4CiAgICAgICAgIiRmb2xkZXJOYW1lID0+ICI7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICB3cml0ZS1ob3N0ICIkZm9sZGVyTmFtZSIgLW5vbmV3bGluZSAtZm9yZWdyb3VuZGNvbG9yIGdyZWVuOwogICAgICAgIFdyaXRlLVZjc1N0YXR1czsKICAgICAgICAiID0+ICI7CiAgICB9CgogICAgIyBZYXJuIGFuZCBtc2J1aWxkIGhhdmUgYSBoYWJpdCBvZiBjb3JydXB0aW5nIGNvbnNvbGUgY29sb3JzIHdoZW4gY3RybCtjLWluZyB0aGVtLiBSZXNldCBjb2xvcnMgb24gZWFjaCBwcm9tcHQuCiAgICBbQ29uc29sZV06OlJlc2V0Q29sb3IoKTsKCiAgICAkTEFTVEVYSVRDT0RFID0gJG9yaWdMYXN0RXhpdENvZGU7Cn0KCiMgTG9hZCB0aGUgcHNlbnYgZmlsZQokcHNlbnYgPSAiJChTcGxpdC1QYXRoICRwcm9maWxlKS9wc2Vudi5wczEiOwoKaWYgKCEgKFRlc3QtUGF0aCAkcHNlbnYpKSB7CiAgICAjIENyZWF0ZSB0aGUgZW52IGZpbGUgYW5kIHN3YWxsb3cgdGhlIG91dHB1dAogICAgTmV3LUl0ZW0gJHBzZW52IHwgb3V0LW51bGw7Cn0KCi4gJHBzZW52OwoKZnVuY3Rpb24gZmluZEZvbGRlcigkZm9sZGVyTmFtZSkgewogICAgJGJhc2ljRHJpdmUgPSAkbnVsbDsKCiAgICBmb3JlYWNoICgkZHJpdmUgaW4gIn4iLCAiQzoiLCAiRDoiKSB7CiAgICAgICAgaWYgKFRlc3QtUGF0aCAiJGRyaXZlLyRmb2xkZXJOYW1lIikgewogICAgICAgICAgICAkYmFzaWNEcml2ZSA9ICRkcml2ZTsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoJGJhc2ljRHJpdmUgLW5lICRudWxsKSB7CiAgICAgICAgcmV0dXJuICIkYmFzaWNEcml2ZS8kZm9sZGVyTmFtZSI7CiAgICB9CgogICAgaWYgKCRpc05vdFdpbmRvd3MpIHsKICAgICAgICBmdW5jdGlvbiBzZWFyY2hUb3BGb2xkZXIoJGZvbGRlck5hbWUpIHsKICAgICAgICAgICAgJGRyaXZlUGF0aCA9ICRudWxsOwoKICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkZm9sZGVyTmFtZSkgewogICAgICAgICAgICAgICAgIyBVc2luZyBmb3JlYWNoIGhlcmUgaW5zdGVhZCBvZiBwaXBpbmcgdG8gJSwgYmVjYXVzZSBicmVha2luZyBpbiBhICUgcGlwZSBzdG9wcyB0aGUgZnVuY3Rpb24gaXRzZWxmLCBub3QgdGhlICUuCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkZHJpdmUgaW4gZ2NpICIvbWVkaWEvJHVzZXJuYW1lIikgewogICAgICAgICAgICAgICAgICAgIGlmIChUZXN0LVBhdGggIiQoJGRyaXZlLkZ1bGxOYW1lKS8kZm9sZGVyTmFtZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGRyaXZlUGF0aCA9ICRkcml2ZS5GdWxsTmFtZTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJGRyaXZlUGF0aCAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIiRkcml2ZVBhdGgvJGZvbGRlck5hbWUiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJG51bGw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gPz8gKHNlYXJjaFRvcEZvbGRlciAiL21lZGlhLyR1c2VybmFtZSIpIChzZWFyY2hUb3BGb2xkZXIgIi9tbnQiKQogICAgfQoKICAgICMgRG9uJ3Qgc2V0IHRoZSB2YWx1ZSBpZiBpdCB3YXNuJ3QgZm91bmQuCiAgICByZXR1cm4gJG51bGw7Cn0KCiMgRmluZCBPbmVEcml2ZSwgRHJvcGJveCBhbmQgU291cmNlIGZvbGRlcnMKJG9uZWRyaXZlID0gZmluZEZvbGRlciAiT25lRHJpdmUiOwokZHJvcGJveCA9IGZpbmRGb2xkZXIgIkRyb3Bib3giOwokc291cmNlID0gZmluZEZvbGRlciAic291cmNlIjsKCiMgRnVuY3Rpb24gdG8gcmVzZXQgY29sb3JzIHdoZW4gdGhleSBnZXQgbWVzc2VkIHVwIGJ5IHNvbWUgcHJvZ3JhbSAoZS5nLiByZWFjdCBuYXRpdmUpCmZ1bmN0aW9uIFJlc2V0LUNvbG9ycyB7CiAgICBbQ29uc29sZV06OlJlc2V0Q29sb3IoKTsKICAgIGVjaG8gIkNvbnNvbGUgY29sb3JzIGhhdmUgYmVlbiByZXNldC4iOwp9CgpTZXQtQWxpYXMgLU5hbWUgcmVzZXRDb2xvcnMgLVZhbHVlIFJlc2V0LUNvbG9ycyAtT3B0aW9uIEFsbFNjb3BlOwoKIyBTdWRvIGFsaWFzLCBmcm9tIGh0dHA6Ly93d3cuZXhpdHRoZWZhc3RsYW5lLmNvbS8yMDA5LzA4L3N1ZG8tZm9yLXBvd2Vyc2hlbGwuaHRtbApmdW5jdGlvbiBlbGV2YXRlLXByb2Nlc3MgewogICAgJGZpbGUsIFtzdHJpbmddJGFyZ3VtZW50cyA9ICRhcmdzOwogICAgJHBzaSA9IG5ldy1vYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm8gJGZpbGU7CiAgICAkcHNpLkFyZ3VtZW50cyA9ICRhcmd1bWVudHM7CiAgICAkcHNpLlZlcmIgPSAicnVuYXMiOwogICAgJHBzaS5Xb3JraW5nRGlyZWN0b3J5ID0gZ2V0LWxvY2F0aW9uOwogICAgW1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzXTo6U3RhcnQoJHBzaSk7Cn0gCgpTZXQtQWxpYXMgc3VkbyBlbGV2YXRlLXByb2Nlc3M7CgojIEV4dHJhIFBTIGdvb2RpZXMsIGluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9taWtlbWFjY2FuYS9wb3dlcnNoZWxsLXByb2ZpbGUKZnVuY3Rpb24gdXB0aW1lIHsKICAgIGlmICgkaXNOb3RXaW5kb3dzKSB7CiAgICAgICAgYmFzaCAtYyAidXB0aW1lIjsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIEdldC1XbWlPYmplY3Qgd2luMzJfb3BlcmF0aW5nc3lzdGVtIHwgc2VsZWN0IGNzbmFtZSwgQHtMQUJFTCA9ICdMYXN0Qm9vdFVwVGltZSc7CiAgICAgICAgRVhQUkVTU0lPTiA9IHskXy5Db252ZXJ0dG9EYXRlVGltZSgkXy5sYXN0Ym9vdHVwdGltZSl9CiAgICB9Cn0KCmZ1bmN0aW9uIGZyb21Ib21lKCRQYXRoKSB7CiAgICAkUGF0aC5SZXBsYWNlKCIkaG9tZSIsICJ+IikKfQoKIyBodHRwOi8vbW9odW5kcm8uY29tL2Jsb2cvMjAwOS8wMy8zMS9xdWlja2x5LWV4dHJhY3QtZmlsZXMtd2l0aC1wb3dlcnNoZWxsLwpmdW5jdGlvbiB1bmFyY2hpdmUoW3N0cmluZ10kZmlsZSwgW3N0cmluZ10kb3V0cHV0RGlyID0gJycpIHsKICAgIGlmICgtbm90IChUZXN0LVBhdGggJGZpbGUpKSB7CiAgICAgICAgJGZpbGUgPSBSZXNvbHZlLVBhdGggJGZpbGUKICAgIH0KCiAgICBpZiAoJG91dHB1dERpciAtZXEgJycpIHsKICAgICAgICAkb3V0cHV0RGlyID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RmlsZU5hbWVXaXRob3V0RXh0ZW5zaW9uKCRmaWxlKQogICAgfQoKICAgIDd6IGUgIi1vJG91dHB1dERpciIgJGZpbGUKfQoKIyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM5MTQ4MzA0L2Z1c2VyLWVxdWl2YWxlbnQtaW4tcG93ZXJzaGVsbC8zOTE0ODU0MCMzOTE0ODU0MApmdW5jdGlvbiBmdXNlcigkcmVsYXRpdmVGaWxlKSB7CiAgICAkZmlsZSA9IFJlc29sdmUtUGF0aCAkcmVsYXRpdmVGaWxlCgogICAgZWNobyAiTG9va2luZyBmb3IgcHJvY2Vzc2VzIHVzaW5nICRmaWxlIgoKICAgIGlmICgkaXNOb3RXaW5kb3dzKSB7CiAgICAgICAgc3VkbyBiYXNoIC1jICJmdXNlciAkZmlsZS5QYXRoIjsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvcmVhY2ggKCAkUHJvY2VzcyBpbiAoR2V0LVByb2Nlc3MpKSB7CiAgICAgICAgZm9yZWFjaCAoICRNb2R1bGUgaW4gJFByb2Nlc3MuTW9kdWxlcykgewogICAgICAgICAgICBpZiAoICRNb2R1bGUuRmlsZU5hbWUgLWxpa2UgIiRmaWxlKiIgKSB7CiAgICAgICAgICAgICAgICAkUHJvY2VzcyB8IHNlbGVjdCBpZCwgcGF0aAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBmaW5kZmlsZSgkbmFtZSkgewogICAgbHMgLXJlY3Vyc2UgLWZpbHRlciAiKiR7bmFtZX0qIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IGZvcmVhY2ggewogICAgICAgICRwbGFjZV9wYXRoID0gJF8uZGlyZWN0b3J5CiAgICAgICAgZWNobyAiJHtwbGFjZV9wYXRofVwke199IgogICAgfQp9CgpmdW5jdGlvbiB3aGljaCgkbmFtZSkgewogICAgR2V0LUNvbW1hbmQgJG5hbWUgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBEZWZpbml0aW9uCn0KCmZ1bmN0aW9uIHVuemlwICgkZmlsZSkgewogICAgJGRpcm5hbWUgPSAoR2V0LUl0ZW0gJGZpbGUpLkJhc2VuYW1lCiAgICBlY2hvKCJFeHRyYWN0aW5nIiwgJGZpbGUsICJ0byIsICRkaXJuYW1lKQogICAgTmV3LUl0ZW0gLUZvcmNlIC1JdGVtVHlwZSBkaXJlY3RvcnkgLVBhdGggJGRpcm5hbWUKICAgIGV4cGFuZC1hcmNoaXZlICRmaWxlIC1PdXRwdXRQYXRoICRkaXJuYW1lIC1TaG93UHJvZ3Jlc3MKfQoKIyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9hcm9iZW4vNTU0MjUzOApmdW5jdGlvbiBwc3RyZWUgewogICAgJFByb2Nlc3Nlc0J5SWQgPSBAe30KICAgIGZvcmVhY2ggKCRQcm9jZXNzIGluIChHZXQtV01JT2JqZWN0IC1DbGFzcyBXaW4zMl9Qcm9jZXNzKSkgewogICAgICAgICRQcm9jZXNzZXNCeUlkWyRQcm9jZXNzLlByb2Nlc3NJZF0gPSAkUHJvY2VzcwogICAgfQoKICAgICRQcm9jZXNzZXNXaXRob3V0UGFyZW50cyA9IEAoKQogICAgJFByb2Nlc3Nlc0J5UGFyZW50ID0gQHt9CiAgICBmb3JlYWNoICgkUGFpciBpbiAkUHJvY2Vzc2VzQnlJZC5HZXRFbnVtZXJhdG9yKCkpIHsKICAgICAgICAkUHJvY2VzcyA9ICRQYWlyLlZhbHVlCgogICAgICAgIGlmICgoJFByb2Nlc3MuUGFyZW50UHJvY2Vzc0lkIC1lcSAwKSAtb3IgISRQcm9jZXNzZXNCeUlkLkNvbnRhaW5zS2V5KCRQcm9jZXNzLlBhcmVudFByb2Nlc3NJZCkpIHsKICAgICAgICAgICAgJFByb2Nlc3Nlc1dpdGhvdXRQYXJlbnRzICs9ICRQcm9jZXNzCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQoKICAgICAgICBpZiAoISRQcm9jZXNzZXNCeVBhcmVudC5Db250YWluc0tleSgkUHJvY2Vzcy5QYXJlbnRQcm9jZXNzSWQpKSB7CiAgICAgICAgICAgICRQcm9jZXNzZXNCeVBhcmVudFskUHJvY2Vzcy5QYXJlbnRQcm9jZXNzSWRdID0gQCgpCiAgICAgICAgfQogICAgICAgICRTaWJsaW5ncyA9ICRQcm9jZXNzZXNCeVBhcmVudFskUHJvY2Vzcy5QYXJlbnRQcm9jZXNzSWRdCiAgICAgICAgJFNpYmxpbmdzICs9ICRQcm9jZXNzCiAgICAgICAgJFByb2Nlc3Nlc0J5UGFyZW50WyRQcm9jZXNzLlBhcmVudFByb2Nlc3NJZF0gPSAkU2libGluZ3MKICAgIH0KCiAgICBmdW5jdGlvbiBTaG93LVByb2Nlc3NUcmVlKFtVSW50MzJdJFByb2Nlc3NJZCwgJEluZGVudExldmVsKSB7CiAgICAgICAgJFByb2Nlc3MgPSAkUHJvY2Vzc2VzQnlJZFskUHJvY2Vzc0lkXQogICAgICAgICRJbmRlbnQgPSAiICIgKiAkSW5kZW50TGV2ZWwKICAgICAgICBpZiAoJFByb2Nlc3MuQ29tbWFuZExpbmUpIHsKICAgICAgICAgICAgJERlc2NyaXB0aW9uID0gJFByb2Nlc3MuQ29tbWFuZExpbmUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICREZXNjcmlwdGlvbiA9ICRQcm9jZXNzLkNhcHRpb24KICAgICAgICB9CgogICAgICAgIFdyaXRlLU91dHB1dCAoInswLDZ9ezF9IHsyfSIgLWYgJFByb2Nlc3MuUHJvY2Vzc0lkLCAkSW5kZW50LCAkRGVzY3JpcHRpb24pCiAgICAgICAgZm9yZWFjaCAoJENoaWxkIGluICgkUHJvY2Vzc2VzQnlQYXJlbnRbJFByb2Nlc3NJZF0gfCBTb3J0LU9iamVjdCBDcmVhdGlvbkRhdGUpKSB7CiAgICAgICAgICAgIFNob3ctUHJvY2Vzc1RyZWUgJENoaWxkLlByb2Nlc3NJZCAoJEluZGVudExldmVsICsgNCkKICAgICAgICB9CiAgICB9CgogICAgV3JpdGUtT3V0cHV0ICgiezAsNn0gezF9IiAtZiAiUElEIiwgIkNvbW1hbmQgTGluZSIpCiAgICBXcml0ZS1PdXRwdXQgKCJ7MCw2fSB7MX0iIC1mICItLS0iLCAiLS0tLS0tLS0tLS0tIikKCiAgICBmb3JlYWNoICgkUHJvY2VzcyBpbiAoJFByb2Nlc3Nlc1dpdGhvdXRQYXJlbnRzIHwgU29ydC1PYmplY3QgQ3JlYXRpb25EYXRlKSkgewogICAgICAgIFNob3ctUHJvY2Vzc1RyZWUgJFByb2Nlc3MuUHJvY2Vzc0lkIDAKICAgIH0KfQoKIyBVbml4LXRvdWNoCmZ1bmN0aW9uIHVuaXh0b3VjaCgkZmlsZSkgewogICAgaWYgKCRpc05vdFdpbmRvd3MpIHsKICAgICAgICBiYXNoIC1jICJ0b3VjaCAkZmlsZSI7CgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAiIiB8IE91dC1GaWxlICRmaWxlIC1FbmNvZGluZyBBU0NJSQp9CgppZiAoLW5vdCAkaXNOb3RXaW5kb3dzKSB7CiAgICBTZXQtQWxpYXMgLU5hbWUgdG91Y2ggLVZhbHVlIHVuaXh0b3VjaCAtT3B0aW9uIEFsbFNjb3BlCn0KCiMgUHJvZHVjZSBVVEYtOCBieSBkZWZhdWx0CiMgaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS9pdGVtP2lkPTEyOTkxNjkwCiRQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXNbIk91dC1GaWxlOkVuY29kaW5nIl0gPSAidXRmOCIKCiMgaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZWNhbXBpZG9nbGlvLzE2MzU5NTIKZnVuY3Rpb24gT3V0LURpZmYgewogICAgPCMKCS5TeW5vcHNpcwoJCVJlZGlyZWN0cyBhIFVuaXZlcnNhbCBESUZGIGVuY29kZWQgdGV4dCBmcm9tIHRoZSBwaXBlbGluZSB0byB0aGUgaG9zdCB1c2luZyBjb2xvcnMgdG8gaGlnaGxpZ2h0IHRoZSBkaWZmZXJlbmNlcy4KCS5EZXNjcmlwdGlvbgoJCUhlbHBlciBmdW5jdGlvbiB0byBoaWdobGlnaHQgdGhlIGRpZmZlcmVuY2VzIGluIGEgVW5pdmVyc2FsIERJRkYgdGV4dCB1c2luZyBjb2xvciBjb2RpbmcuCgkuUGFyYW1ldGVyIElucHV0T2JqZWN0CgkJVGhlIHRleHQgdG8gZGlzcGxheSBhcyBVbml2ZXJzYWwgRElGRi4KCSM+CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgVmFsdWVGcm9tUGlwZWxpbmUgPSAkdHJ1ZSldCiAgICAgICAgW1BTT2JqZWN0XSRJbnB1dE9iamVjdAogICAgKQogICAgUHJvY2VzcyB7CiAgICAgICAgJGNvbnRlbnRMaW5lID0gJElucHV0T2JqZWN0IHwgT3V0LVN0cmluZwogICAgICAgIGlmICgkY29udGVudExpbmUgLW1hdGNoICJeSW5kZXg6IikgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICRjb250ZW50TGluZSAtRm9yZWdyb3VuZENvbG9yIEN5YW4gLU5vTmV3bGluZQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRjb250ZW50TGluZSAtbWF0Y2ggIl4oXCt8XC18XD0pezN9IikgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICRjb250ZW50TGluZSAtRm9yZWdyb3VuZENvbG9yIEdyYXkgLU5vTmV3bGluZQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRjb250ZW50TGluZSAtbWF0Y2ggIl5cQHsyfSIpIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAkY29udGVudExpbmUgLUZvcmVncm91bmRDb2xvciBHcmF5IC1Ob05ld2xpbmUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkY29udGVudExpbmUgLW1hdGNoICJeXCsiKSB7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJGNvbnRlbnRMaW5lIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4gLU5vTmV3bGluZQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRjb250ZW50TGluZSAtbWF0Y2ggIl5cLSIpIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAkY29udGVudExpbmUgLUZvcmVncm91bmRDb2xvciBSZWQgLU5vTmV3bGluZQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAkY29udGVudExpbmUgLU5vTmV3bGluZQogICAgICAgIH0KICAgIH0KfQoKIyBodHRwczovL2dpdGh1Yi5jb20vSlJKdXJtYW4vUG93ZXJMUwpmdW5jdGlvbiBQb3dlckxTIHsKICAgIDwjCgkuU3lub3BzaXMKCVBvd2Vyc2hlbGwgdW5peC1saWtlIGxzCglXcml0dGVuIGJ5IEplc3NlIEp1cm1hbiAoSlJKdXJtYW4pCgoJLkRlc2NyaXB0aW9uCglBIGNvbG9yZnVsIGxzCgoJLlBhcmFtZXRlciBSZWRpcmVjdAoJVGhlIGZpcnN0IG1vbnRoIHRvIGRpc3BsYXkuCgoJLkV4YW1wbGUKCSMgTGlzdCB0aGUgY3VycmVudCBkaXJlY3RvcnkKCVBvd2VyTFMKCgkuRXhhbXBsZQoJIyBMaXN0IHRoZSBwYXJlbnQgZGlyZWN0b3J5CglQb3dlckxTIC4uLwoJIz4KICAgIHBhcmFtKAogICAgICAgIFtzdHJpbmddJHJlZGlyZWN0ID0gIi4iCiAgICApCiAgICB3cml0ZS1ob3N0ICIiICMgYWRkIG5ld2xpbmUgYXQgdG9wCgogICAgIyBnZXQgdGhlIGNvbnNvbGUgYnVmZmVyc2l6ZQogICAgJGJ1ZmZlciA9IEdldC1Ib3N0CiAgICAkYnVmZmVyd2lkdGggPSAkYnVmZmVyLnVpLnJhd3VpLmJ1ZmZlcnNpemUud2lkdGgKCiAgICAjIGdldCBhbGwgdGhlIGZpbGVzIGFuZCBmb2xkZXJzCiAgICAkY2hpbGRzID0gR2V0LUNoaWxkSXRlbSAkcmVkaXJlY3QKCiAgICAjIGdldCB0aGUgbG9uZ2VzdCBzdHJpbmcgYW5kIGdldCB0aGUgbGVuZ3RoCiAgICAkbG5TdHIgPSAkY2hpbGRzIHwgc2VsZWN0LW9iamVjdCBOYW1lIHwgc29ydC1vYmplY3QgeyAiJF8iLmxlbmd0aCB9IC1kZXNjZW5kaW5nIHwgc2VsZWN0LW9iamVjdCAtZmlyc3QgMQogICAgJGxlbiA9ICRsblN0ci5uYW1lLmxlbmd0aAoKICAgICMga2VlcCB0cmFjayBvZiBob3cgbG9uZyBvdXIgbGluZSBpcyBzbyBmYXIKICAgICRjb3VudCA9IDAKCiAgICAjIGV4dHJhIHNwYWNlIHRvIGdpdmUgc29tZSBicmVhdGhlciBzcGFjZQogICAgJGJyZWF0aGVyID0gNAoKICAgICMgZm9yIGV2ZXJ5IGVsZW1lbnQsIHByaW50IHRoZSBsaW5lCiAgICBmb3JlYWNoICgkZSBpbiAkY2hpbGRzKSB7CgogICAgICAgICRuZXdOYW1lID0gJGUubmFtZSArICgiICIgKiAoJGxlbiAtICRlLm5hbWUubGVuZ3RoICsgJGJyZWF0aGVyKSkKICAgICAgICAkY291bnQgKz0gJG5ld05hbWUubGVuZ3RoCgogICAgICAgICMgZGV0ZXJtaW5lIGNvbG9yIHdlIHNob3VsZCBiZSBwcmludGluZwogICAgICAgICMgQmx1ZSBmb3IgZm9sZGVycywgR3JlZW4gZm9yIGZpbGVzLCBhbmQgR3JheSBmb3IgaGlkZGVuIGZpbGVzCiAgICAgICAgaWYgKCgkbmV3TmFtZSAtbWF0Y2ggIl5cLi4qJCIpIC1hbmQgKFRlc3QtUGF0aCAoJHJlZGlyZWN0ICsgIlwiICsgJGUpIC1wYXRodHlwZSBjb250YWluZXIpKSB7CiAgICAgICAgICAgICNoaWRkZW4gZm9sZGVycwogICAgICAgICAgICAkbmV3TmFtZSA9ICRlLm5hbWUgKyAiXCIgKyAoIiAiICogKCRsZW4gLSAkZS5uYW1lLmxlbmd0aCArICRicmVhdGhlciAtIDEpKQogICAgICAgICAgICB3cml0ZS1ob3N0ICRuZXdOYW1lIC1ub25ld2xpbmUgLWZvcmVncm91bmRjb2xvciBkYXJrY3lhbgogICAgICAgIH0KICAgICAgICBlbHNlaWYgKFRlc3QtUGF0aCAoJHJlZGlyZWN0ICsgIlwiICsgJGUpIC1wYXRodHlwZSBjb250YWluZXIpIHsKICAgICAgICAgICAgI25vcm1hbCBmb2xkZXJzCiAgICAgICAgICAgICRuZXdOYW1lID0gJGUubmFtZSArICJcIiArICgiICIgKiAoJGxlbiAtICRlLm5hbWUubGVuZ3RoICsgJGJyZWF0aGVyIC0gMSkpCiAgICAgICAgICAgIHdyaXRlLWhvc3QgJG5ld05hbWUgLW5vbmV3bGluZSAtZm9yZWdyb3VuZGNvbG9yIGN5YW4KICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkbmV3TmFtZSAtbWF0Y2ggIl5cLi4qJCIpIHsKICAgICAgICAgICAgI2hpZGRlbiBmaWxlcwogICAgICAgICAgICB3cml0ZS1ob3N0ICRuZXdOYW1lIC1ub25ld2xpbmUgLWZvcmVncm91bmRjb2xvciBkYXJrZ3JheQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRuZXdOYW1lIC1tYXRjaCAiXC5bXlwuXSoiKSB7CiAgICAgICAgICAgICNub3JtYWwgZmlsZXMKICAgICAgICAgICAgd3JpdGUtaG9zdCAkbmV3TmFtZSAtbm9uZXdsaW5lIC1mb3JlZ3JvdW5kY29sb3IgZGFya3llbGxvdwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgI290aGVycy4uLgogICAgICAgICAgICB3cml0ZS1ob3N0ICRuZXdOYW1lIC1ub25ld2xpbmUgLWZvcmVncm91bmRjb2xvciBncmF5CiAgICAgICAgfQoKICAgICAgICBpZiAoICRjb3VudCAtZ2UgKCRidWZmZXJ3aWR0aCAtICgkbGVuICsgJGJyZWF0aGVyKSkgKSB7CiAgICAgICAgICAgIHdyaXRlLWhvc3QgIiIKICAgICAgICAgICAgJGNvdW50ID0gMAogICAgICAgIH0KICAgIH0KCiAgICB3cml0ZS1ob3N0ICIiICMgYWRkIG5ld2xpbmUgYXQgYm90dG9tCiAgICB3cml0ZS1ob3N0ICIiICMgYWRkIG5ld2xpbmUgYXQgYm90dG9tCn0KCiMgU2V0IFBvd2VyTFMgYXMgdGhlIGRlZmF1bHQgbHMgQ29tbWFuZApTZXQtQWxpYXMgLU5hbWUgbHMgLVZhbHVlIFBvd2VyTFMgLU9wdGlvbiBBbGxTY29wZQoKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIGJvZ3BhZGRsZS5wczEgc2NyaXB0LgpTZXQtQWxpYXMgLU5hbWUgYm9ncGFkZGxlIC1WYWx1ZSAiJHNvdXJjZVxwb3dlcnNoZWxsLXV0aWxzXGJvZ3BhZGRsZS5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIG5hbWVnZW4ucHMxIHNjcmlwdC4KU2V0LUFsaWFzIC1OYW1lIG5hbWVnZW4gLVZhbHVlICIkc291cmNlXHBvd2Vyc2hlbGwtdXRpbHNcbmFtZWdlbi5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIGttc2lnbmFsci5wczEgc2NyaXB0LgpTZXQtQWxpYXMgLU5hbWUga21zaWduYWxyIC1WYWx1ZSAiJHNvdXJjZVxwb3dlcnNoZWxsLXV0aWxzXGttc2lnbmFsci5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIGRvd25sb2FkLXZpZGVvLnBzMSBzY3JpcHQuClNldC1BbGlhcyAtTmFtZSBkb3dubG9hZC12aWRlbyAtVmFsdWUgIiRzb3VyY2VccG93ZXJzaGVsbC11dGlsc1xkb3dubG9hZC12aWRlby5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIGd1aWQucHMxIHNjcmlwdC4KU2V0LUFsaWFzIC1OYW1lIGd1aWQgLVZhbHVlICIkc291cmNlXHBvd2Vyc2hlbGwtdXRpbHNcZ3VpZC5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIGJjcnlwdC5wczEgc2NyaXB0LgpTZXQtQWxpYXMgLU5hbWUgYmNyeXB0IC1WYWx1ZSAiJHNvdXJjZVxwb3dlcnNoZWxsLXV0aWxzXGJjcnlwdC5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIG5vdy5wczEgc2NyaXB0LgpTZXQtQWxpYXMgLU5hbWUgbm93IC1WYWx1ZSAiJHNvdXJjZVxwb3dlcnNoZWxsLXV0aWxzXG5vdy5wczEiIC1PcHRpb24gQWxsU2NvcGUKIyBBZGQgYW4gYWxpYXMgZm9yIHRoZSBQb3dlcnNoZWxsLVV0aWxzIHRlbXBsYXRlLnBzMSBzY3JpcHQuClNldC1BbGlhcyAtTmFtZSB0ZW1wbGF0ZSAtVmFsdWUgIiRzb3VyY2VccG93ZXJzaGVsbC11dGlsc1x0ZW1wbGF0ZS5wczEiIC1PcHRpb24gQWxsU2NvcGUK
