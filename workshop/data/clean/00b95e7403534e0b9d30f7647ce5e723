Connect-ServiceFabricClusterFromServiceEndpoint.ps1,a93187a3eb7ff2942aa7cf4768176c45,Scan result is 1. IsMalware: 0,IyBGdW5jdGlvbiB0aGF0IGNhbiBiZSBtb2NrZWQgYnkgdGVzdHMKZnVuY3Rpb24gQ3JlYXRlLU9iamVjdAp7CiAgICBQYXJhbSAoCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkVHlwZU5hbWUsCgogICAgICAgIFtPYmplY3RbXV0KICAgICAgICAkQXJndW1lbnRMaXN0CiAgICApCgogICAgcmV0dXJuIE5ldy1PYmplY3QgLVR5cGVOYW1lICRUeXBlTmFtZSAtQXJndW1lbnRMaXN0ICRBcmd1bWVudExpc3QKfQoKZnVuY3Rpb24gR2V0LUFhZFNlY3VyaXR5VG9rZW4KewogICAgUGFyYW0gKAogICAgICAgIFtIYXNodGFibGVdCiAgICAgICAgJENsdXN0ZXJDb25uZWN0aW9uUGFyYW1ldGVycywKCiAgICAgICAgJENvbm5lY3RlZFNlcnZpY2VFbmRwb2ludAogICAgKQoKICAgICMgQ29uZmlndXJlIGNvbm5lY3Rpb24gcGFyYW1ldGVycyB0byBnZXQgY2x1c3RlciBtZXRhZGF0YQogICAgJGNvbm5lY3Rpb25QYXJhbWV0ZXJzV2l0aEdldE1ldGFkYXRhID0gJENsdXN0ZXJDb25uZWN0aW9uUGFyYW1ldGVycy5DbG9uZSgpCiAgICAkY29ubmVjdGlvblBhcmFtZXRlcnNXaXRoR2V0TWV0YWRhdGEuQWRkKCJHZXRNZXRhZGF0YSIsICR0cnVlKQoKICAgICMgUXVlcnkgY2x1c3RlciBtZXRhZGF0YQogICAgJGNvbm5lY3RSZXN1bHQgPSBDb25uZWN0LVNlcnZpY2VGYWJyaWNDbHVzdGVyIEBjb25uZWN0aW9uUGFyYW1ldGVyc1dpdGhHZXRNZXRhZGF0YQogICAgJGF1dGhvcml0eSA9ICRjb25uZWN0UmVzdWx0LkF6dXJlQWN0aXZlRGlyZWN0b3J5TWV0YWRhdGEuQXV0aG9yaXR5CiAgICBXcml0ZS1Ib3N0IChHZXQtVnN0c0xvY1N0cmluZyAtS2V5IEFhZEF1dGhvcml0eSAtQXJndW1lbnRMaXN0ICRhdXRob3JpdHkpCiAgICAkY2x1c3RlckFwcGxpY2F0aW9uSWQgPSAkY29ubmVjdFJlc3VsdC5BenVyZUFjdGl2ZURpcmVjdG9yeU1ldGFkYXRhLkNsdXN0ZXJBcHBsaWNhdGlvbgogICAgV3JpdGUtSG9zdCAoR2V0LVZzdHNMb2NTdHJpbmcgLUtleSBDbHVzdGVyQXBwSWQgLUFyZ3VtZW50TGlzdCAkY2x1c3RlckFwcGxpY2F0aW9uSWQpCiAgICAkY2xpZW50QXBwbGljYXRpb25JZCA9ICRjb25uZWN0UmVzdWx0LkF6dXJlQWN0aXZlRGlyZWN0b3J5TWV0YWRhdGEuQ2xpZW50QXBwbGljYXRpb24KICAgIFdyaXRlLUhvc3QgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgQ2xpZW50QXBwSWQgLUFyZ3VtZW50TGlzdCAkY2xpZW50QXBwbGljYXRpb25JZCkKCiAgICAjIEFjcXVpcmUgQUFEIGFjY2VzcyB0b2tlbgogICAgQWRkLVR5cGUgLUxpdGVyYWxQYXRoICIkUFNTY3JpcHRSb290XE1pY3Jvc29mdC5JZGVudGl0eU1vZGVsLkNsaWVudHMuQWN0aXZlRGlyZWN0b3J5LmRsbCIKICAgICRhdXRoQ29udGV4dCA9IENyZWF0ZS1PYmplY3QgLVR5cGVOYW1lIE1pY3Jvc29mdC5JZGVudGl0eU1vZGVsLkNsaWVudHMuQWN0aXZlRGlyZWN0b3J5LkF1dGhlbnRpY2F0aW9uQ29udGV4dCAtQXJndW1lbnRMaXN0IEAoJGF1dGhvcml0eSkKICAgICRhdXRoUGFyYW1zID0gJENvbm5lY3RlZFNlcnZpY2VFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMKICAgICR1c2VyQ3JlZGVudGlhbCA9IENyZWF0ZS1PYmplY3QgLVR5cGVOYW1lIE1pY3Jvc29mdC5JZGVudGl0eU1vZGVsLkNsaWVudHMuQWN0aXZlRGlyZWN0b3J5LlVzZXJDcmVkZW50aWFsIC1Bcmd1bWVudExpc3QgQCgkYXV0aFBhcmFtcy5Vc2VybmFtZSwgJGF1dGhQYXJhbXMuUGFzc3dvcmQpCgogICAgdHJ5CiAgICB7CiAgICAgICAgIyBBY3F1aXJpbmcgYSB0b2tlbiB1c2luZyBVc2VyQ3JlZGVudGlhbCBpbXBsaWVzIGEgbm9uLWludGVyYWN0aXZlIGZsb3cuIE5vIGNyZWRlbnRpYWwgcHJvbXB0cyB3aWxsIG9jY3VyLgogICAgICAgICRhY2Nlc3NUb2tlbiA9ICRhdXRoQ29udGV4dC5BY3F1aXJlVG9rZW4oJGNsdXN0ZXJBcHBsaWNhdGlvbklkLCAkY2xpZW50QXBwbGljYXRpb25JZCwgJHVzZXJDcmVkZW50aWFsKS5BY2Nlc3NUb2tlbgogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICB0aHJvdyAoR2V0LVZzdHNMb2NTdHJpbmcgLUtleSBFcnJvck9uQWNxdWlyZVRva2VuIC1Bcmd1bWVudExpc3QgJF8pCiAgICB9CgogICAgcmV0dXJuICRhY2Nlc3NUb2tlbgp9CgpmdW5jdGlvbiBBZGQtQ2VydGlmaWNhdGUKewogICAgUGFyYW0gKAogICAgICAgIFtIYXNodGFibGVdCiAgICAgICAgJENsdXN0ZXJDb25uZWN0aW9uUGFyYW1ldGVycywKCiAgICAgICAgJENvbm5lY3RlZFNlcnZpY2VFbmRwb2ludAogICAgKQoKICAgICRzdG9yZU5hbWUgPSBbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YNTA5Q2VydGlmaWNhdGVzLlN0b3JlTmFtZV06Ok15OwogICAgJHN0b3JlTG9jYXRpb24gPSBbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YNTA5Q2VydGlmaWNhdGVzLlN0b3JlTG9jYXRpb25dOjpDdXJyZW50VXNlcgoKICAgICMgR2VuZXJhdGUgYSBjZXJ0aWZpY2F0ZSBmcm9tIHRoZSBzZXJ2aWNlIGVuZHBvaW50IHZhbHVlcwogICAgJGNlcnRpZmljYXRlID0gTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMuWDUwOUNlcnRpZmljYXRlMgoKICAgIHRyeQogICAgewogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJENvbm5lY3RlZFNlcnZpY2VFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuQ2VydGlmaWNhdGUpCgogICAgICAgIGlmICgkQ29ubmVjdGVkU2VydmljZUVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5DZXJ0aWZpY2F0ZVBhc3N3b3JkKQogICAgICAgIHsKICAgICAgICAgICAgJGNlcnRQYXNzd29yZCA9ICRDb25uZWN0ZWRTZXJ2aWNlRW5kcG9pbnQuQXV0aC5QYXJhbWV0ZXJzLkNlcnRpZmljYXRlUGFzc3dvcmQKICAgICAgICB9CgogICAgICAgICMgRXhwbGljaXRseSBzZXQgdGhlIGtleSBzdG9yYWdlIHRvIHVzZSBVc2VyS2V5U2V0LiAgVGhpcyB3aWxsIGVuc3VyZSB0aGUgcHJpdmF0ZSBrZXkgaXMgc3RvcmVkIGluIGEgZm9sZGVyIGxvY2F0aW9uIHdoaWNoIHRoZSB1c2VyIGhhcyBhY2Nlc3MgdG8uCiAgICAgICAgIyBJZiB3ZSBkb24ndCBleHBsaWNpdGx5IHNldCBpdCB0byBVc2VyS2V5U2V0LCBpdCdzIHBvc3NpYmxlIHRoZSBNYWNoaW5lS2V5U2V0IHdpbGwgYmUgdXNlZCB3aGljaCB0aGUgdXNlciBkb2Vzbid0IGhhdmUgYWNjZXNzIHRvIHRoYXQgZm9sZGVyIGxvY2F0aW9uLCByZXN1bHRpbmcgaW4gYW4gYWNjZXNzIGRlbmllZCBlcnJvci4KICAgICAgICAkY2VydGlmaWNhdGUuSW1wb3J0KCRieXRlcywgJGNlcnRQYXNzd29yZCwgW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWDUwOUNlcnRpZmljYXRlcy5YNTA5S2V5U3RvcmFnZUZsYWdzXTo6VXNlcktleVNldCkKICAgIH0KICAgIGNhdGNoCiAgICB7CiAgICAgICAgdGhyb3cgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgRXJyb3JPbkNlcnRpZmljYXRlSW1wb3J0IC1Bcmd1bWVudExpc3QgJF8pCiAgICB9CgogICAgIyBBZGQgdGhlIGNlcnRpZmljYXRlIHRvIHRoZSBjZXJ0IHN0b3JlLgogICAgJHN0b3JlID0gTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMuWDUwOVN0b3JlKCRzdG9yZU5hbWUsICRzdG9yZUxvY2F0aW9uKQogICAgJHN0b3JlLk9wZW4oKFtTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMuT3BlbkZsYWdzXTo6UmVhZFdyaXRlKSkKICAgIHRyeQogICAgewogICAgICAgICRzdG9yZS5BZGQoJGNlcnRpZmljYXRlKQogICAgfQogICAgZmluYWxseQogICAgewogICAgICAgICRzdG9yZS5DbG9zZSgpCiAgICAgICAgJHN0b3JlLkRpc3Bvc2UoKQogICAgfQoKICAgIFdyaXRlLUhvc3QgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgSW1wb3J0ZWRDZXJ0aWZpY2F0ZSAtQXJndW1lbnRMaXN0ICRjZXJ0aWZpY2F0ZS5UaHVtYnByaW50KQoKICAgICMgT3ZlcnJpZGUgdGhlIGNlcnRpZmljYXRlLXJlbGF0ZWQgY2x1c3RlciBjb25uZWN0aW9uIHBhcmFtZXRlcnMgdG8ga25vd24gYW5kIHN1cHBvcnRlZCB2YWx1ZXMKICAgICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnNbIkZpbmRUeXBlIl0gPSAiRmluZEJ5VGh1bWJwcmludCIKICAgICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnNbIkZpbmRWYWx1ZSJdID0gJGNlcnRpZmljYXRlLlRodW1icHJpbnQKICAgICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnNbIlN0b3JlTmFtZSJdID0gJHN0b3JlTmFtZS5Ub1N0cmluZygpCiAgICAkY2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzWyJTdG9yZUxvY2F0aW9uIl0gPSAkc3RvcmVMb2NhdGlvbi5Ub1N0cmluZygpCgogICAgcmV0dXJuICRjZXJ0aWZpY2F0ZQp9CgpmdW5jdGlvbiBDb25uZWN0LVNlcnZpY2VGYWJyaWNDbHVzdGVyRnJvbVNlcnZpY2VFbmRwb2ludCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW0hhc2h0YWJsZV0KICAgICAgICAkQ2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzLAoKICAgICAgICAkQ29ubmVjdGVkU2VydmljZUVuZHBvaW50CiAgICApCgogICAgVHJhY2UtVnN0c0VudGVyaW5nSW52b2NhdGlvbiAkTXlJbnZvY2F0aW9uCiAgICB0cnkgewoKICAgICAgICAkcmVnS2V5ID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxTZXJ2aWNlIEZhYnJpYyBTREsiCiAgICAgICAgaWYgKCEoVGVzdC1QYXRoICRyZWdLZXkpKQogICAgICAgIHsKICAgICAgICAgICAgdGhyb3cgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgU2VydmljZUZhYnJpY1NES05vdEluc3RhbGxlZCkKICAgICAgICB9CgogICAgICAgICRjb25uZWN0aW9uRW5kcG9pbnRVcmwgPSBbU3lzdGVtLlVyaV0kQ29ubmVjdGVkU2VydmljZUVuZHBvaW50LlVybAogICAgICAgICMgT3ZlcnJpZGUgdGhlIHB1Ymxpc2ggcHJvZmlsZSdzIGNvbm5lY3Rpb24gZW5kcG9pbnQgd2l0aCB0aGUgb25lIGRlZmluZWQgb24gdGhlIGFzc29jaWF0ZWQgc2VydmljZSBlbmRwb2ludAogICAgICAgICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnNbIkNvbm5lY3Rpb25FbmRwb2ludCJdID0gJGNvbm5lY3Rpb25FbmRwb2ludFVybC5BdXRob3JpdHkgIyBBdXRob3JpdHkgaW5jbHVkZXMganVzdCB0aGUgaG9zdG5hbWUgYW5kIHBvcnQKCiAgICAgICAgIyBDb25maWd1cmUgY2x1c3RlciBjb25uZWN0aW9uIHByZS1yZXFzCiAgICAgICAgaWYgKCRDb25uZWN0ZWRTZXJ2aWNlRW5kcG9pbnQuQXV0aC5TY2hlbWUgLW5lICJOb25lIikKICAgICAgICB7CiAgICAgICAgICAgICMgQWRkIHNlcnZlciBjZXJ0IHRodW1icHJpbnQgKGNvbW1vbiB0byBib3RoIGF1dGgtdHlwZXMpCiAgICAgICAgICAgIGlmICgkQ29ubmVjdGVkU2VydmljZUVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5TZXJ2ZXJDZXJ0VGh1bWJwcmludCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGNsdXN0ZXJDb25uZWN0aW9uUGFyYW1ldGVyc1siU2VydmVyQ2VydFRodW1icHJpbnQiXSA9ICRDb25uZWN0ZWRTZXJ2aWNlRW5kcG9pbnQuQXV0aC5QYXJhbWV0ZXJzLlNlcnZlckNlcnRUaHVtYnByaW50CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgQWRkIGF1dGgtc3BlY2lmaWMgcGFyYW1ldGVycwogICAgICAgICAgICBpZiAoJENvbm5lY3RlZFNlcnZpY2VFbmRwb2ludC5BdXRoLlNjaGVtZSAtZXEgIlVzZXJOYW1lUGFzc3dvcmQiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjIFNldHVwIHRoZSBBenVyZUFjdGl2ZURpcmVjdG9yeSBhbmQgU2VydmVyQ2VydFRodW1icHJpbnQgcGFyYW1ldGVycyBiZWZvcmUgZ2V0dGluZyB0aGUgc2VjdXJpdHkgdG9rZW4sIGJlY2F1c2UgZ2V0dGluZyB0aGUgc2VjdXJpdHkgdG9rZW4KICAgICAgICAgICAgICAgICMgcmVxdWlyZXMgYSBjb25uZWN0aW9uIHJlcXVlc3QgdG8gdGhlIGNsdXN0ZXIgaW4gb3JkZXIgdG8gZ2V0IG1ldGFkYXRhIGFuZCBzbyB0aGVzZSB0d28gcGFyYW1ldGVycyBhcmUgbmVlZGVkIGZvciB0aGF0IHJlcXVlc3QuCiAgICAgICAgICAgICAgICAkY2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzWyJBenVyZUFjdGl2ZURpcmVjdG9yeSJdID0gJHRydWUKCiAgICAgICAgICAgICAgICAkc2VjdXJpdHlUb2tlbiA9IEdldC1BYWRTZWN1cml0eVRva2VuIC1DbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnMgJGNsdXN0ZXJDb25uZWN0aW9uUGFyYW1ldGVycyAtQ29ubmVjdGVkU2VydmljZUVuZHBvaW50ICRDb25uZWN0ZWRTZXJ2aWNlRW5kcG9pbnQKICAgICAgICAgICAgICAgICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnNbIlNlY3VyaXR5VG9rZW4iXSA9ICRzZWN1cml0eVRva2VuCiAgICAgICAgICAgICAgICAkY2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzWyJXYXJuaW5nQWN0aW9uIl0gPSAiU2lsZW50bHlDb250aW51ZSIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCRDb25uZWN0ZWRTZXJ2aWNlRW5kcG9pbnQuQXV0aC5TY2hlbWUgLWVxICJDZXJ0aWZpY2F0ZSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEFkZC1DZXJ0aWZpY2F0ZSAtQ2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzICRjbHVzdGVyQ29ubmVjdGlvblBhcmFtZXRlcnMgLUNvbm5lY3RlZFNlcnZpY2VFbmRwb2ludCAkQ29ubmVjdGVkU2VydmljZUVuZHBvaW50CiAgICAgICAgICAgICAgICAkY2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzWyJYNTA5Q3JlZGVudGlhbCJdID0gJHRydWUKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBDb25uZWN0IHRvIGNsdXN0ZXIKICAgICAgICB0cnkgewogICAgICAgICAgICBbdm9pZF0oQ29ubmVjdC1TZXJ2aWNlRmFicmljQ2x1c3RlciBAY2x1c3RlckNvbm5lY3Rpb25QYXJhbWV0ZXJzKQogICAgICAgIH0KICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgIGlmICgkY29ubmVjdGlvbkVuZHBvaW50VXJsLlBvcnQgLW5lICIxOTAwMCIpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgRGVmYXVsdFBvcnRXYXJuaW5nICRjb25uZWN0aW9uRW5kcG9pbnRVcmwuUG9ydCkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgJF8KICAgICAgICB9CgogICAgICAgIFdyaXRlLUhvc3QgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgQ29ubmVjdGVkVG9DbHVzdGVyKQoKICAgICAgICAjIFJlc2V0IHRoZSBzY29wZSBvZiB0aGUgQ2x1c3RlckNvbm5lY3Rpb24gdmFyaWFibGUgdGhhdCBnZXRzIHNldCBieSB0aGUgY2FsbCB0byBDb25uZWN0LVNlcnZpY2VGYWJyaWNDbHVzdGVyIHNvIHRoYXQgaXQgaXMgYXZhaWxhYmxlIG91dHNpZGUgdGhlIHNjb3BlIG9mIHRoaXMgbW9kdWxlCiAgICAgICAgU2V0LVZhcmlhYmxlIC1OYW1lIENsdXN0ZXJDb25uZWN0aW9uIC1WYWx1ZSAkUHJpdmF0ZTpDbHVzdGVyQ29ubmVjdGlvbiAtU2NvcGUgR2xvYmFsCgogICAgfSBmaW5hbGx5IHsKICAgICAgICBUcmFjZS1Wc3RzTGVhdmluZ0ludm9jYXRpb24gJE15SW52b2NhdGlvbgogICAgfQp9
