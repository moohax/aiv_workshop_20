MSFT_msAzureSqlDatabaseServerFirewallRule.psm1,cd8d16eb19c816281197e8b3841353cc,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKCVtDbWRsZXRCaW5kaW5nKCldCglbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQoJcGFyYW0KCSgKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkUnVsZU5hbWUsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRTZXJ2ZXJOYW1lLAoKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkU3RhcnRJUEFkZHJlc3MsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRFbmRJUEFkZHJlc3MsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQoJCSRBenVyZVN1YnNjcmlwdGlvbk5hbWUsCgoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRBenVyZVB1Ymxpc2hTZXR0aW5nc0ZpbGUKCSkKCgkjIFNlbGVjdCBBenVyZSBzdWJzY3JpcHRpb24KICAgIGlmICgkQXp1cmVTdWJzY3JpcHRpb25OYW1lIC1hbmQgJEF6dXJlUHVibGlzaFNldHRpbmdzRmlsZSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJBenVyZSBQdWJsaXNoIFNldHRpbmcgcHJvdmlkZWQuIEF6dXJlU3Vic2NyaXB0aW9uTmFtZSA9ICRBenVyZVN1YnNjcmlwdGlvbk5hbWUsICBBenVyZVB1Ymxpc2hTZXR0aW5nc0ZpbGUgPSAkQXp1cmVQdWJsaXNoU2V0dGluZ3NGaWxlLiBTZWxlY3RpbmcgQXp1cmUgc3Vic2NyaXB0aW9uLiIKICAgICAgICBJbXBvcnQtQXp1cmVQdWJsaXNoU2V0dGluZ3NGaWxlICRBenVyZVB1Ymxpc2hTZXR0aW5nc0ZpbGUgLXZlcmJvc2UKICAgICAgICBTZWxlY3QtQXp1cmVTdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbk5hbWUgJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSAtQ3VycmVudCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSAtdmVyYm9zZQogICAgICAgICRjdXJyZW50U3Vic2NyaXB0aW9uID0gR2V0LUF6dXJlU3Vic2NyaXB0aW9uIC1DdXJyZW50IC12ZXJib3NlCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiVGhlIHNlbGVjdGVkIEF6dXJlIHN1YnNjcmlwdGlvbiBJRCBpcyAkKCRjdXJyZW50U3Vic2NyaXB0aW9uLlN1YnNjcmlwdGlvbklEKSIKICAgIH0KCiAgICAkc3RhcnRJUEFkZHJlc3NTdGF0ZSA9ICRudWxsCiAgICAkZW5kSVBBZGRyZXNzU3RhdGUgPSAkbnVsbAogICAgJGVuc3VyZVN0YXRlID0gJG51bGwKCiAgICAjIEdldCBmaXJld2FsbCBydWxlIHN0YXRlCiAgICBXcml0ZS1WZXJib3NlICJHZXR0aW5nIHN0YXR1cyBvZiBmaXJld2FsbCBydWxlICckUnVsZU5hbWUnIgogICAgJGN1cnJlbnRGaXJld2FsbFJ1bGUgPSBHZXQtQXp1cmVTcWxEYXRhYmFzZVNlcnZlckZpcmV3YWxsUnVsZSAtU2VydmVyTmFtZSAkU2VydmVyTmFtZSAtUnVsZU5hbWUgJFJ1bGVOYW1lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIC12ZXJib3NlCiAgICBXcml0ZS1WZXJib3NlICJTdGF0dXMgb2YgZmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyBvYnRhaW5lZC4iCiAgICBpZiAoJGN1cnJlbnRGaXJld2FsbFJ1bGUpIHsKICAgICAgICAkc3RhcnRJUEFkZHJlc3NTdGF0ZSA9ICRjdXJyZW50RmlyZXdhbGxSdWxlLlN0YXJ0SVBBZGRyZXNzCiAgICAgICAgJGVuZElQQWRkcmVzc1N0YXRlID0gJGN1cnJlbnRGaXJld2FsbFJ1bGUuRW5kSVBBZGRyZXNzCiAgICAgICAgJGVuc3VyZVN0YXRlID0gIlByZXNlbnQiCiAgICB9IGVsc2UgewogICAgICAgICRlbnN1cmVTdGF0ZSA9ICJBYnNlbnQiCiAgICB9CgoJJHJldHVyblZhbHVlID0gQHsKCQlSdWxlTmFtZSA9ICRSdWxlTmFtZQoJCVNlcnZlck5hbWUgPSAkU2VydmVyTmFtZQoJCVN0YXJ0SVBBZGRyZXNzID0gJHN0YXJ0SVBBZGRyZXNzU3RhdGUKCQlFbmRJUEFkZHJlc3MgPSAkZW5kSVBBZGRyZXNzU3RhdGUKCQlBenVyZVN1YnNjcmlwdGlvbk5hbWUgPSAkQXp1cmVTdWJzY3JpcHRpb25OYW1lCgkJQXp1cmVQdWJsaXNoU2V0dGluZ3NGaWxlID0gJEF6dXJlUHVibGlzaFNldHRpbmdzRmlsZQoJCUVuc3VyZSA9ICRlbnN1cmVTdGF0ZQoJfQoKCSRyZXR1cm5WYWx1ZQp9CgoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKCVtDbWRsZXRCaW5kaW5nKCldCglwYXJhbQoJKAoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRSdWxlTmFtZSwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCgkJJFNlcnZlck5hbWUsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRTdGFydElQQWRkcmVzcywKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCgkJJEVuZElQQWRkcmVzcywKCgkJW1N5c3RlbS5TdHJpbmddCgkJJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSwKCgkJW1N5c3RlbS5TdHJpbmddCgkJJEF6dXJlUHVibGlzaFNldHRpbmdzRmlsZSwKCgkJW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildCgkJW1N5c3RlbS5TdHJpbmddCgkJJEVuc3VyZSA9ICJQcmVzZW50IgoJKQoKICAgICMgQ2hlY2sgd2hldGhlciBmaXJ3YWxsIHJ1bGUgd2l0aCBzcGVjaWZpYyBuYW1lIGV4aXN0cwogICAgJFBTQm91bmRQYXJhbWV0ZXJzLlJlbW92ZSgiRW5zdXJlIikgfCBPdXQtTnVsbAoJJGN1cnJlbnRGaXJld2FsbFJ1bGUgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICAkZmlyd2FsbFJ1bGVFeGlzdHMgPSAkZmFsc2UKICAgIGlmICgkY3VycmVudEZpcmV3YWxsUnVsZS5FbnN1cmUgLWVxICJQcmVzZW50IikgewogICAgICAgICRmaXJld2FsbFJ1bGVFeGlzdHMgPSAkdHJ1ZQogICAgfQogICAgCiAgICAjIElmIHdlIHdhbnQgdG8gZW5zdXJlIGZpcmV3YWxsIHJ1bGUgaXMgcHJlc2VudAogICAgaWYgKCRFbnN1cmUgLWVxICJQcmVzZW50IikKICAgIHsKICAgICAgICAjIENyZWF0ZSBmaXJld2FsbCBydWxlIGlmIG5vdCBleGlzdHMKICAgICAgICBpZiAoLW5vdCAkZmlyZXdhbGxSdWxlRXhpc3RzKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNyZWF0aW5nIGZpcmV3YWxsIHJ1bGUgJyRSdWxlTmFtZSciCiAgICAgICAgICAgIE5ldy1BenVyZVNxbERhdGFiYXNlU2VydmVyRmlyZXdhbGxSdWxlIC1TZXJ2ZXJOYW1lICRTZXJ2ZXJOYW1lIC1SdWxlTmFtZSAkUnVsZU5hbWUgLVN0YXJ0SXBBZGRyZXNzICRTdGFydElQQWRkcmVzcyAtRW5kSXBBZGRyZXNzICRFbmRJUEFkZHJlc3MgLUVycm9yQWN0aW9uIFN0b3AgfCBPdXQtTnVsbAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGaXJld2FsbCBydWxlICckUnVsZU5hbWUnIGNyZWF0ZWQiCiAgICAgICAgIyBNb2RpZnkgZmlyZXdhbGwgcnVsZSBpZiBleGlzdHMKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJVcGRhdGluZyBmaXJld2FsbCBydWxlICckUnVsZU5hbWUnIgogICAgICAgICAgICBTZXQtQXp1cmVTcWxEYXRhYmFzZVNlcnZlckZpcmV3YWxsUnVsZSAtU2VydmVyTmFtZSAkU2VydmVyTmFtZSAtUnVsZU5hbWUgJFJ1bGVOYW1lIC1TdGFydElwQWRkcmVzcyAkU3RhcnRJUEFkZHJlc3MgLUVuZElwQWRkcmVzcyAkRW5kSVBBZGRyZXNzIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyB1cGRhdGVkIgogICAgICAgIH0KICAgIH0KICAgICMgSWYgd2Ugd2FudCB0byBlbnN1cmUgZGF0YWJhc2UgaXMgYWJzZW50CiAgICBlbHNlaWYgKCRFbnN1cmUgLWVxICJBYnNlbnQiKQogICAgewogICAgICAgICMgUmVtb3ZlIGZpcmV3YWxsIHJ1bGUKICAgICAgICBpZiAoJGZpcmV3YWxsUnVsZUV4aXN0cykgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGaXJld2FsbCBydWxlICckUnVsZU5hbWUnIGV4aXN0cy4gUmVtb3ZpbmcgaXQuIgogICAgICAgICAgICBSZW1vdmUtQXp1cmVTcWxEYXRhYmFzZVNlcnZlckZpcmV3YWxsUnVsZSAtU2VydmVyTmFtZSAkU2VydmVyTmFtZSAtUnVsZU5hbWUgJFJ1bGVOYW1lIC12ZXJib3NlCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZpcmV3YWxsIHJ1bGUgJyRSdWxlTmFtZScgaGFzIGJlZW4gcmVtb3ZlZC4iCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyBkb2VzIG5vdCBleGlzdC4gTm8gbmVlZCB0byByZW1vdmUuIgogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CglbQ21kbGV0QmluZGluZygpXQoJW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCglwYXJhbQoJKAoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRSdWxlTmFtZSwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCgkJJFNlcnZlck5hbWUsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRTdGFydElQQWRkcmVzcywKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCgkJJEVuZElQQWRkcmVzcywKCgkJW1N5c3RlbS5TdHJpbmddCgkJJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSwKCgkJW1N5c3RlbS5TdHJpbmddCgkJJEF6dXJlUHVibGlzaFNldHRpbmdzRmlsZSwKCgkJW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildCgkJW1N5c3RlbS5TdHJpbmddCgkJJEVuc3VyZSA9ICJQcmVzZW50IgoJKQoKICAgICR0ZXN0UmVzdWx0ID0gJHRydWU7CgogICAgJFBTQm91bmRQYXJhbWV0ZXJzLlJlbW92ZSgiRW5zdXJlIikgfCBPdXQtTnVsbAogICAgJGN1cnJlbnRGaXJld2FsbFJ1bGUgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICBXcml0ZS1WZXJib3NlICJUZXN0aW5nIHdoZXRoZXIgcmVzb3VyY2UgaXMgaW4gZGVzaXJlZCBzdGF0ZSIKICAgIGlmKCRFbnN1cmUgLWVxICJQcmVzZW50IikgewogICAgICAgIGlmICgkY3VycmVudEZpcmV3YWxsUnVsZS5FbnN1cmUgLWVxICJQcmVzZW50IikgewogICAgICAgICAgICAKICAgICAgICAgICAgIyBDaGVjayB3aGV0aGVyIGN1cnJlbnQgZmlyZXdhbGwgcnVsZSBwcm9wZXJ0aWVzIG1hdGNoIHRoZSBzcGVjaWZpZWQgb25lcwogICAgICAgICAgICBpZigkY3VycmVudEZpcmV3YWxsUnVsZS5TdGFydElwQWRkcmVzcy5FcXVhbHMoJHN0YXJ0SVBBZGRyZXNzKSAtYW5kICRjdXJyZW50RmlyZXdhbGxSdWxlLkVuZElwQWRkcmVzcy5FcXVhbHMoJGVuZElQQWRkcmVzcykpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNRTCBkYXRhYmFzZSBzZXJ2ZXIgZmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyBleGlzdHMgYW5kIHByb3BlcnRpZXMgbWF0Y2guIFJlc291cmNlIGlzIGluIGRlc2lyZWQgc3RhdGUuIgogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU1FMIGRhdGFiYXNlIHNlcnZlciBmaXJld2FsbCBydWxlICckUnVsZU5hbWUnIGV4aXN0cyBidXQgcHJvcGVydGllcyBkb24ndCBtYXRjaC4gUmVzb3VyY2UgaXMgbm90IGluIGRlc2lyZWQgc3RhdGUuIgogICAgICAgICAgICAgICAgJHRlc3RSZXN1bHQgPSAkZmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNRTCBkYXRhYmFzZSBzZXJ2ZXIgZmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyBkb2VzIG5vdCBleGlzdCwgYnV0IGV4cGVjdGVkIHRvIGJlIHByZXNlbnQuIFJlc291cmNlIGlzIG5vdCBpbiBkZXNpcmVkIHN0YXRlLiIKICAgICAgICAgICAgJHRlc3RSZXN1bHQgPSAkZmFsc2UKICAgICAgICB9CiAgICB9IGVsc2VpZiAoJEVuc3VyZSAtZXEgIkFic2VudCIpIHsKICAgICAgICAKICAgICAgICAjIElmIGZpcmV3YWxsIHJ1bGUgd2l0aCBnaXZlbiBuYW1lIGV4aXN0cywgcmVzb3VyY2UgaXMgbm90IGluIHRoZSBkZXNpcmVkIHN0YXRlCiAgICAgICAgaWYgKCRjdXJyZW50RmlyZXdhbGxSdWxlLkVuc3VyZSAtZXEgIlByZXNlbnQiKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNRTCBkYXRhYmFzZSBzZXJ2ZXIgZmlyZXdhbGwgcnVsZSAnJFJ1bGVOYW1lJyBleGlzdHMsIGJ1dCBleHBlY3RlZCB0byBiZSBhYnNlbnQuIFJlc291cmNlIGlzIG5vdCBpbiBkZXNpcmVkIHN0YXRlLiIKICAgICAgICAgICAgJHRlc3RSZXN1bHQgPSAkZmFsc2UKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTUUwgZGF0YWJhc2Ugc2VydmVyIGZpcmV3YWxsIHJ1bGUgJyRSdWxlTmFtZScgZG9lcyBub3QgZXhpc3QuIFJlc291cmNlIGlzIGluIGRlc2lyZWQgc3RhdGUuIgogICAgICAgIH0KICAgIH0KCiAgICAkdGVzdFJlc3VsdAoKfQoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UKCg==
