machinecheck.ps1,a50586a498f98892af9da99023f706fc,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBNQUNISU5FIENIRUNLIFdSSVRURU4gQlkgTk9PUFpFTiAgLSAyMDEwCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpwYXJhbSAoJHNlcnZlcm5hbWUsICRFbnYsICRNYWNoaW5lQ2xhc3MsICRGZWF0dXJlLCAkUmVsZWFzZSwgJENvbXBvbmVudCwgJFByb2dyYW0sICRXaW5saXN0LCAkUHJvZ0xpc3QsICRQYXRoLCAkRGVidWcsICRub2h0bWwpCgokR0xPQkFMOlJvb3RQYXRoID0gJFBhdGgKJEdMT0JBTDp0YXJnZXQgPSAkc2VydmVybmFtZQokR0xPQkFMOkhUTUwgPSAxCiMkUm9vdFBhdGggPSAiRTpcRGV2X0Ryb3Bcam9zaFxzY3JpcHRzXGV2dFwiCiRkYXRlID0gZ2V0LWRhdGUKJHRtcCA9ICRkYXRlLkdldERhdGVUaW1lRm9ybWF0cygpCiRkYXRlc3RyID0gJHRtcFsxXQojIkRhdGUgaXMgJGRhdGVzdHIiCiRkYXRlX3RpbWUgPSAkdG1wWzY1XQojIkRhdGVfdGltZSAgaXMgJGRhdGVfdGltZSIKJHllYXIgPSAoZ2V0LWRhdGUpLlRvU3RyaW5nKCd5eXl5JykKIyR5ZWFyCiREYXRlUHJlZml4ID0gKGdldC1kYXRlKS5Ub1N0cmluZygneXl5eU1NZGQnKQojJERhdGVQcmVmaXgKJEdMT0JBTDpFbnYgPSAkRW52CiMKaWYoKCRteUludm9jYXRpb24uQm91bmRQYXJhbWV0ZXJzKS5jb3VudCAtZXEgMCl7CndyaXRlLWhvc3QgLWYgcmVkICJgbk5PIEFSR1VNRU5UUyBTVVBQTElFRGBuIgp3cml0ZS1ob3N0IC1mIGN5YW4gIlRvIHJ1biBpbiBhdXRvbWF0ZWQgbW9kZSwgc3VwcGx5IHRoZSBmb2xsb3dpbmcgYXJndW1lbnRzOiIgICcuXG1hY2hpbmVjaGVjay5wczEgLUVudiAiPEVOVklST05NRU5UPiIgLU1hY2hpbmVDbGFzcyAiPE1BQ0hJTkUgQ0xBU1M+IiAtRmVhdHVyZSAiPEZFQVRVUkU+IiAtUmVsZWFzZSAiPFJFTEVBU0U+IiAtc2VydmVybmFtZSAiPFNFUlZFUk5BTUU+IicgCn0KCiRHTE9CQUw6SFRNTCA9ICIxIgojaWYgYW55IG9mIHRoZXNlLCBkbyBub3Qgd3JpdGUgSFRNTAppZigkUHJvZ0xpc3QubGVuZ3RoIC1ndCAwKXsgJEdMT0JBTDpIVE1MID0gIjEifQppZigkV2lubGlzdC5sZW5ndGggLWd0IDApeyAkR0xPQkFMOkhUTUwgPSAiMSJ9CmlmKCRQcm9ncmFtLmxlbmd0aCAtZ3QgMCl7ICRHTE9CQUw6SFRNTCA9ICIxIn0KaWYoJENvbXBvbmVudC5sZW5ndGggLWd0IDApeyAkR0xPQkFMOkhUTUwgPSAiMSJ9CgoKI2lmIGFueSBvZiB0aGVzZSwgZG8gbm90IHdyaXRlIEhUTUwKaWYoJFByb2dMaXN0Lmxlbmd0aCAtZ3QgMCl7ICRHTE9CQUw6SFRNTCA9ICIxIn0KaWYoJFdpbmxpc3QubGVuZ3RoIC1ndCAwKXsgJEdMT0JBTDpIVE1MID0gIjEifQppZigkUHJvZ3JhbS5sZW5ndGggLWd0IDApeyAkR0xPQkFMOkhUTUwgPSAiMSJ9CmlmKCRDb21wb25lbnQubGVuZ3RoIC1ndCAwKXsgJEdMT0JBTDpIVE1MID0gIjEifQoKCmlmKCgkR0xPQkFMOkhUTUwpLmxlbmd0aCAtZ3QgMCl7fQplbHNlewokcmVwb3J0X3BhdGggPSAiIiArICRHTE9CQUw6Um9vdFBhdGggKyAiXGh0bV9yZXBvcnRfIiArICRFbnYgKyAiXyIgKyAkRGF0ZVByZWZpeCArIlwiIAojd3JpdGUtaG9zdCAkcmVwb3J0X3BhdGggCgppZighKFRlc3QtUGF0aCAkcmVwb3J0X3BhdGgpKXtta2RpciAkcmVwb3J0X3BhdGh9CgoKJHJlcG9ydF9maWxlID0gJHJlcG9ydF9wYXRoICsgJHNlcnZlcm5hbWUgKyAnXycgKyAkTWFjaGluZUNsYXNzICsgIl8iICsgJERhdGVQcmVmaXggICsgIi5odG0iCiN3cml0ZS1ob3N0ICRyZXBvcnRfZmlsZQoKfQoKJGNtZGxpbmUgPSAiYG4iICsgJy5cbWFjaGluZWNoZWNrX2h0bWwucHMxIC1FbnYgIicgKyAkRW52ICsgJyIgLU1hY2hpbmVDbGFzcyAiJyArICRNYWNoaW5lQ2xhc3MgKyAnIiAtRmVhdHVyZSAiJyArICRGZWF0dXJlICsgJyIgLVJlbGVhc2UgIicgKyAkUmVsZWFzZSArICciIC1zZXJ2ZXJuYW1lICInICsgJHNlcnZlcm5hbWUgKyciJyArICJgbiIKI3dyaXRlLWhvc3QgJGNtZGxpbmUKI3dyaXRlLWhvc3QgJE1hY2hpbmVDbGFzcyAgCiAgCiRHTE9CQUw6RkFJTCA9IDAKJEdMT0JBTDpXQVJOID0gMAoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBHZXQtRmlsZXZlcnNpb25zOiB0YWtlcyBuZXR3b3JrcGF0aCAgYXMgYXJndW1lbnQuCiMgQ2hlY2tzIHRvIGlmIGEgZmlsZSBpcyBwcmVzZW50CiMgUGFzcyBpcyBmaWxlIGlzIHByZXNlbnQsIGZhaWwgaWYgbm90LiAKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZnVuY3Rpb24gR2V0LUZpbGVWZXJzaW9uKCRsb2NhdGlvbikKewogICAgZ2V0LWNvbW1hbmQgJGxvY2F0aW9uIHwgZm9yZWFjaCB7JF8uRmlsZVZlcnNpb25JbmZvfSB8IGZvcmVhY2h7JF8uRmlsZVZlcnNpb259Cn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKI3BpbmctaXAgCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmZ1bmN0aW9uIHBpbmctaXAgeyAgCiAgICBwYXJhbSggJGlwICkgIAogICAgdHJhcCB7JGZhbHNlOyBjb250aW51ZX0gCiAgICAkdGltZW91dCA9IDIwMDAgIAogICAgJG9iamVjdCA9IE5ldy1PYmplY3Qgc3lzdGVtLk5ldC5OZXR3b3JrSW5mb3JtYXRpb24uUGluZyAKICAgICgoJG9iamVjdC5TZW5kKCRpcCwgJHRpbWVvdXQpKS5TdGF0dXMgLWVxICdTdWNjZXNzJykKIH0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjI1NRTCAgRlVOQ1RJT05TCiMjIyMjIyMjIyMjIyMjIyMjIyMjCmZ1bmN0aW9uIGV4ZWMtcXVlcnkoICRzcWwsJHBhcmFtZXRlcnM9QHt9LCRjb25uLCR0aW1lb3V0PTMwLFtzd2l0Y2hdJGhlbHApewogaWYgKCRoZWxwKXsKICRtc2cgPSBAIgpFeGVjdXRlIGEgc3FsIHN0YXRlbWVudC4gIFBhcmFtZXRlcnMgYXJlIGFsbG93ZWQuCklucHV0IHBhcmFtZXRlcnMgc2hvdWxkIGJlIGEgZGljdGlvbmFyeSBvZiBwYXJhbWV0ZXIgbmFtZXMgYW5kIHZhbHVlcy4KUmV0dXJuIHZhbHVlIHdpbGwgdXN1YWxseSBiZSBhIGxpc3Qgb2YgZGF0YXJvd3MuCiJACiBXcml0ZS1Ib3N0ICRtc2cKIHJldHVybgogfQogJGNtZD1uZXctb2JqZWN0IHN5c3RlbS5EYXRhLlNxbENsaWVudC5TcWxDb21tYW5kKCRzcWwsJGNvbm4pCiAkY21kLkNvbW1hbmRUaW1lb3V0PSR0aW1lb3V0CiBmb3JlYWNoKCRwIGluICRwYXJhbWV0ZXJzLktleXMpewogW1ZvaWRdICRjbWQuUGFyYW1ldGVycy5BZGRXaXRoVmFsdWUoIkAkcCIsJHBhcmFtZXRlcnNbJHBdKQogfQogJGRzPU5ldy1PYmplY3Qgc3lzdGVtLkRhdGEuRGF0YVNldAogJGRhPU5ldy1PYmplY3Qgc3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbERhdGFBZGFwdGVyKCRjbWQpCiAkZGEuZmlsbCgkZHMpIHwgT3V0LU51bGwKCiByZXR1cm4gJGRzCn0KCgpmdW5jdGlvbiBxdWVyeV9zcDIgewoJcGFyYW0oICRxdWVyeXAgKSAKICAgICRjb25uPW5ldy1vYmplY3QgZGF0YS5zcWxjbGllbnQuc3FsY29ubmVjdGlvbiAiU2VydmVyPVNRTFNFUlZFUl9JUDtJbnRlZ3JhdGVkIFNlY3VyaXR5PVRydWU7RGF0YWJhc2U9YnNjbXQiCiAgICAkdGVtcCA9IGV4ZWMtcXVlcnkgJHF1ZXJ5cCAtY29ubiAkY29ubgogICAgJG91dGRiID0gJHRlbXAKICAgICMkb3V0ZGIudGFibGVzWzBdIHwgJXskaXRlbSA9ICRfLkJTTVRfSVRFTTsgJHRlc3QgPSAkXy5CU01UX1RFU1Q7IHdyaXRlLWhvc3QgIiRpdGVtIDsgJHRlc3QifQogICAgcmV0dXJuICRvdXRkYgogICAgICAgIAp9CgpmdW5jdGlvbiBxdWVyeV9pbnZlc250b3J5IHsKCXBhcmFtKCAkcXVlcnlwICkgCiAgICAkY29ubj1uZXctb2JqZWN0IGRhdGEuc3FsY2xpZW50LnNxbGNvbm5lY3Rpb24gIlNlcnZlcj1TUUxTRVJWRVJfSVA7SW50ZWdyYXRlZCBTZWN1cml0eT1UcnVlO0RhdGFiYXNlPWludl9oZCIKICAgICR0ZW1wID0gZXhlYy1xdWVyeSAkcXVlcnlwIC1jb25uICRjb25uCiAgICAkb3V0ZGIgPSAkdGVtcAogICAgIyRvdXRkYi50YWJsZXNbMF0gfCAleyRpdGVtID0gJF8uQlNNVF9JVEVNOyAkdGVzdCA9ICRfLkJTTVRfVEVTVDsgd3JpdGUtaG9zdCAiJGl0ZW0gOyAkdGVzdCJ9CiAgICByZXR1cm4gJG91dGRiCiAgICAgICAgCn0KCgpmdW5jdGlvbiBxdWVyeV9zcWxfc2VydmVyIHsKCXBhcmFtKCAkc3Fsc2VydmVyLCAkc3FsZGIsICRxdWVyeXAgKSAKCSRjb25uc3RyaW5nID0gJyJTZXJ2ZXI9JyArICRzcWxzZXJ2ZXIgKyAnO0ludGVncmF0ZWQgU2VjdXJpdHk9VHJ1ZTtEYXRhYmFzZT0nICsgJHNxbGRiICsgJyInCiAgICAkY29ubj1uZXctb2JqZWN0IGRhdGEuc3FsY2xpZW50LnNxbGNvbm5lY3Rpb24gJGNvbm5zdHJpbmcKICAgICR0ZW1wID0gZXhlYy1xdWVyeSAkcXVlcnlwIC1jb25uICRjb25uCiAgICAkb3V0ZGIgPSAkdGVtcAogICAgIyRvdXRkYi50YWJsZXNbMF0gfCAleyRpdGVtID0gJF8uQlNNVF9JVEVNOyAkdGVzdCA9ICRfLkJTTVRfVEVTVDsgd3JpdGUtaG9zdCAiJGl0ZW0gOyAkdGVzdCJ9CiAgICByZXR1cm4gJG91dGRiCiAgICAgICAgCn0KCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjRU5EIFNRTCAgRlVOQ1RJT05TCiMjIyMjIyMjIyMjIyMjIyMjIyMjCgoKIyRtc21xID0gKEdldC1SZWdLZXkgJHNlcnZlcm5hbWUgIlNPRlRXQVJFXE1pY3Jvc29mdFxNU01RXFBhcmFtZXRlcnMiICJDdXJyZW50QnVpbGQiICJNU01RIikKZnVuY3Rpb24gR2V0LVJlZ0tleU9yaWcKewogICAgcGFyYW0oICRrZXksICRyZWdzdHJpbmcsICRmZWF0LCAkZXhwZWN0ZWRfdmFsdWUpCiAgICAjJHJlZ3N0cmluZyA9ICJDdXJyZW50QnVpbGQiCgkjJGtleT0iU29mdHdhcmVcTWljcm9zb2Z0XE1TTVFcUGFyYW1ldGVycyI7CiAgICAka2V5dHlwZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5SGl2ZV06OkxvY2FsTWFjaGluZTsKICAgICRyZW1vdGViYXNlPVtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlrZXldOjpPcGVucmVtb3RlYmFzZWtleSgka2V5dHlwZSwkR0xPQkFMOnRhcmdldCk7CiAgICAjJHJlbW90ZWJhc2UKICAgICRyZWdrZXk9JHJlbW90ZWJhc2UuT3BlblN1YmtleSgka2V5KTsKCSMkcmVna2V5CiAgICAkcmVndmFsdWUgPSAkcmVna2V5LkdldFZhbHVlKCRyZWdzdHJpbmcpIAoJaWYoICRyZWd2YWx1ZSAtZXEgJGV4cGVjdGVkX3ZhbHVlKXsKICAgICMkcmV0ID0gIiRmZWF0IGB0UEFTUzogVmVyc2lvbjogJHJlZ3ZhbHVlIgogICAgIyRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUiCQogICAgd3JpdGUtSG9zdCAtZiBncmVlbiAiJHJldCA6YHRQQVNTIgoJcmV0dXJuKCIwIikKCX0KCWVsc2UgeyRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUgOmB0RkFJTCIKCXdyaXRlLUhvc3QgLWYgcmVkICRyZXQgCQoJcmV0dXJuKCIxIikKCX0KfQoKCgojJG1zbXEgPSAoR2V0LVJlZ0tleSAkc2VydmVybmFtZSAiU09GVFdBUkVcTWljcm9zb2Z0XE1TTVFcUGFyYW1ldGVycyIgIkN1cnJlbnRCdWlsZCIgIk1TTVEiKQojR0VUX1JFR0tFWSBIS0xvY2FsTWFjaGluZQpmdW5jdGlvbiBHZXQtUmVnS2V5CnsKICAgIHBhcmFtKCRrZXksICRyZWdzdHJpbmcsICRleHBlY3RlZF92YWx1ZSwgJGZlYXQpCiAgICAjJHJlZ3N0cmluZyA9ICJDdXJyZW50QnVpbGQiCgkjJGtleT0iU29mdHdhcmVcTWljcm9zb2Z0XE1TTVFcUGFyYW1ldGVycyI7CiAgICAka2V5dHlwZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5SGl2ZV06OkxvY2FsTWFjaGluZTsKICAgICRyZW1vdGViYXNlPVtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlrZXldOjpPcGVucmVtb3RlYmFzZWtleSgka2V5dHlwZSwkR0xPQkFMOnRhcmdldCk7CiAgICAjJHJlbW90ZWJhc2UKICAgICRyZWdrZXk9JHJlbW90ZWJhc2UuT3BlblN1YmtleSgka2V5KTsKCSMkcmVna2V5CiAgICAkcmVndmFsdWUgPSAkcmVna2V5LkdldFZhbHVlKCRyZWdzdHJpbmcpIAoJaWYoICRyZWd2YWx1ZSAtZXEgJGV4cGVjdGVkX3ZhbHVlKXsKICAgICRyZXQgPSAiJGZlYXQgYHRQQVNTOiBWZXJzaW9uOiAkcmVndmFsdWUiCiAgICAkcmV0ID0gIiRmZWF0IDogJHJlZ3ZhbHVlIgkKICAgICN3cml0ZS1ncmVlbiAiJHJldCA6YHRQQVNTIgogICAgcmV0dXJuKCIwIikKCX0KCWVsc2UgeyRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUgOmB0RkFJTCIKCSN3cml0ZS1yZWQgJHJldCAJCiAgICByZXR1cm4oIjEiKQoJfQp9CgoKCgpmdW5jdGlvbiBHZXQtSXBha1ZlcnNpb24oJHJlZ3N0cmluZykKewoJJGtleT0iU09GVFdBUkVcTWljcm9zb2Z0XG1zbmlwYWsiOwogICAgJGtleXR5cGU9W01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUhpdmVdOjpMb2NhbE1hY2hpbmU7CiAgICAkcmVtb3RlYmFzZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5a2V5XTo6T3BlbnJlbW90ZWJhc2VrZXkoJGtleXR5cGUsJEdMT0JBTDp0YXJnZXQpOwogICAgJHJlZ2tleT0kcmVtb3RlYmFzZS5PcGVuU3Via2V5KCRrZXkpOwoJI3dyaXRlLWhvc3QgJHJlZ2tleS5nZXR2YWx1ZSgkcmVnc3RyaW5nKQogICAgcmV0dXJuICggJHJlZ2tleS5HZXRWYWx1ZSgkcmVnc3RyaW5nKSk7Cn0KCgpmdW5jdGlvbiBPUklHR2V0LUlwYWtWZXJzaW9uKCR0YXJnZXQsICRyZWdzdHJpbmcpCnsKCSRrZXk9IlNPRlRXQVJFXE1pY3Jvc29mdFxtc25pcGFrIjsKICAgICRrZXl0eXBlPVtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlIaXZlXTo6TG9jYWxNYWNoaW5lOwogICAgJHJlbW90ZWJhc2U9W01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeWtleV06Ok9wZW5yZW1vdGViYXNla2V5KCRrZXl0eXBlLCR0YXJnZXQpOwogICAgJHJlZ2tleT0kcmVtb3RlYmFzZS5PcGVuU3Via2V5KCRrZXkpOwogICAgcmV0dXJuICggJHJlZ2tleS5HZXRWYWx1ZSgkcmVnc3RyaW5nKSk7Cn0KCgojR2V0LUhvdEZpeCBbWy1JZF0gPHN0cmluZ1tdPl0gWy1Db21wdXRlck5hbWUgPHN0cmluZ1tdPl0KCmZ1bmN0aW9uIEdldC1BcHBGYWIKewogICAgaWYoR2V0LUhvdEZpeCAtSWQgIktCOTcwNjIyIiAtQ29tcHV0ZXJuYW1lICRHTE9CQUw6dGFyZ2V0KSB7CgkJI3dyaXRlLUhvc3QgLWYgZ3JlZW4gIkFwcEZhYnJpYzpgdFBBU1MiOyAKCQlyZXR1cm4oIjAiKQoJCX0gCgllbHNlIHsKCQkjd3JpdGUtSG9zdCAtZiBncmVlbiAiQXBwRmFicmljIGluc3RhbGw6YHRGQUlMIjsgCgkJcmV0dXJuKCIxIikKCQl9Cgp9CgoKCgoKCgoKCgpmdW5jdGlvbiBHZXQtcG93ZXJzaGVsbHYyCnsKCSRyZWdzdHJpbmcgPSAiUG93ZXJTaGVsbFZlcnNpb24iCgkKCSRrZXk9IlNPRlRXQVJFXE1pY3Jvc29mdFxQb3dlclNoZWxsXDFcUG93ZXJTaGVsbEVuZ2luZSI7CiAgICAka2V5dHlwZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5SGl2ZV06OkxvY2FsTWFjaGluZTsKICAgICRyZW1vdGViYXNlPVtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlrZXldOjpPcGVucmVtb3RlYmFzZWtleSgka2V5dHlwZSwkR0xPQkFMOnRhcmdldCk7CiAgICAkcmVna2V5PSRyZW1vdGViYXNlLk9wZW5TdWJrZXkoJGtleSk7CgkkcmVndmFsdWUgPSAkcmVna2V5LkdldFZhbHVlKCRyZWdzdHJpbmcpIAoJaWYoICRyZWd2YWx1ZSAtZXEgIjIuMCIpewoJI3dyaXRlLWdyZWVuICJQb3dlcnNoZWxsIFYyLjA6ICRyZWd2YWx1ZSBgOnRQQVNTIgogICAgcmV0dXJuKCIwIikKCX0KCWVsc2UgewoJI3dyaXRlLXJlZCAiUG93ZXJzaGVsbCBWMi4wOiAgJHJlZ3ZhbHVlIGB0OkZBSUwiCiAgICByZXR1cm4oIjEiKQoJfQp9CgpmdW5jdGlvbiBHZXQtSW5zdGFsbGVkUHJvZ3JhbXMgewoJJHByb2dyYW1zX2luc3RhbGxlZCA9IEB7fTsKCSMkd2luMzJfcHJvZHVjdCA9IEAoZ2V0LXdtaW9iamVjdCAtY2xhc3MgJ1dpbjMyX1Byb2R1Y3QnIC1jb21wdXRlciAkc2VydmVyKTsKCSR3aW4zMl9wcm9kdWN0ID0gQChnZXQtd21pb2JqZWN0IC1jb21wdXRlciAkR0xPQkFMOnRhcmdldCAtcXVlcnkgInNlbGVjdCBOYW1lLCBWZXJzaW9uIGZyb20gV2luMzJfUHJvZHVjdCIpOwoJCglmb3JlYWNoICgkcHJvZHVjdCBpbiAkd2luMzJfcHJvZHVjdCkgewoJCSRuYW1lID0gJHByb2R1Y3QuTmFtZTsKCQkkdmVyc2lvbiA9ICRwcm9kdWN0LlZlcnNpb247CgkJaWYgKCRuYW1lIC1uZSAkbnVsbCkgewoJCQkkcHJvZ3JhbXNfaW5zdGFsbGVkLiRuYW1lID0gJHZlcnNpb247CgkJCXdyaXRlLUhvc3QgLWYgZ3JheSAiJG5hbWUgJHZlcnNpb24iOwoJCX0KCX0KCXJldHVybiAkcHJvZ3JhbXNfaW5zdGFsbGVkOwp9CgpmdW5jdGlvbiBHZXQtSW5zdGFsbGVkUHJvZ3MzIHsKCSRwcm9ncmFtc19pbnN0YWxsZWQgPSBAKCk7CgkjJHdpbjMyX3Byb2R1Y3QgPSBAKGdldC13bWlvYmplY3QgLWNsYXNzICdXaW4zMl9Qcm9kdWN0JyAtY29tcHV0ZXIgJHNlcnZlcik7Cgkkd2luMzJfcHJvZHVjdCA9IEAoZ2V0LXdtaW9iamVjdCAgLWNvbXB1dGVyICRHTE9CQUw6dGFyZ2V0IC1xdWVyeSAic2VsZWN0IE5hbWUsIFZlcnNpb24gZnJvbSBXaW4zMl9Qcm9kdWN0Iik7CgkKCWZvcmVhY2ggKCRwcm9kdWN0IGluICR3aW4zMl9wcm9kdWN0KSB7CgkJJG5hbWUgPSAkcHJvZHVjdC5OYW1lOwoJCSR2ZXJzaW9uID0gJHByb2R1Y3QuVmVyc2lvbjsKCQlpZiAoJG5hbWUgLW5lICRudWxsKSB7CgkJCSRwcm9ncmFtc19pbnN0YWxsZWQgKz0gIiRuYW1lICR2ZXJzaW9uIjsKCQkJI3dyaXRlLUhvc3QgLWYgZ3JheSAiJG5hbWUgJHZlcnNpb24iOwoJCX0KCX0KCXJldHVybiAoJHByb2dyYW1zX2luc3RhbGxlZCB8IHNvcnQpCn0KCgpmdW5jdGlvbiBHZXQtSW5zdGFsbGVkUHJvZ3MgewoJJHByb2dyYW1zX2luc3RhbGxlZCA9IEAoKTsKCSMkd2luMzJfcHJvZHVjdCA9IEAoZ2V0LXdtaW9iamVjdCAtY2xhc3MgJ1dpbjMyX1Byb2R1Y3QnIC1jb21wdXRlciAkc2VydmVyKTsKCSMkd2luMzJfcHJvZHVjdCA9IEAoZ2V0LXdtaW9iamVjdCAgLWNvbXB1dGVyICRHTE9CQUw6dGFyZ2V0IC1xdWVyeSAic2VsZWN0IE5hbWUsIFZlcnNpb24gZnJvbSBXaW4zMl9Qcm9kdWN0Iik7CgkjJHdpbjMyX3Byb2R1Y3QgPSBpbnZva2UtY29tbWFuZCAtY29tcHV0ZXJuYW1lICRHTE9CQUw6dGFyZ2V0IC1zY3JpcHRibG9ja3tAKGdldC13bWlvYmplY3QgLXF1ZXJ5ICJzZWxlY3QgTmFtZSwgVmVyc2lvbiBmcm9tIFdpbjMyX1Byb2R1Y3QiKTt9CgkKCQoJJHByb2dyYW1zX2luc3RhbGxlZCA9IGludm9rZS1jb21tYW5kIC1jb21wdXRlcm5hbWUgJEdMT0JBTDp0YXJnZXQgLXNjcmlwdGJsb2NreyRvdXQgPSBAe30KCSRLZXlzID0gR2V0LUNoaWxkSXRlbSBIS0xNOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwKCSRJdGVtcyA9ICRrZXlzIHwgZm9yZWFjaC1vYmplY3Qge0dldC1JdGVtUHJvcGVydHkgJF8uUHNQYXRofQoJJGl0ZW1zIHwgJXskbWFqb3IgPSAkXy5WZXJzaW9uTWFqb3I7ICRtaW5vciA9ICRfLnZlcnNpb25taW5vcjsgJHZlcnNpb24gPSAkXy52ZXJzaW9uOyAkdmVyID0gICIkbWFqb3IiICsgIi4iICsgICIkbWlub3IiICsgIi4iICsgICIkdmVyc2lvbiI7IGlmKCRfLkRpc3BsYXlOYW1lKXskb3V0WyRfLkRpc3BsYXlOYW1lXSA9ICIkdmVyIn0gZWxzZSB7fTsgICB9Cgkka2V5cyA9IGdjaSBIS0xNOlxTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwKCSRpdGVtcyA9ICRrZXlzIHwgZm9yZWFjaC1vYmplY3Qge0dldC1JdGVtUHJvcGVydHkgJF8uUHNQYXRofQoJJGl0ZW1zIHwgJXskbWFqb3IgPSAkXy5WZXJzaW9uTWFqb3I7ICRtaW5vciA9ICRfLnZlcnNpb25taW5vcjsgJHZlcnNpb24gPSAkXy52ZXJzaW9uOyAkdmVyID0gICIkbWFqb3IiICsgIi4iICsgICIkbWlub3IiICsgIi4iICsgICIkdmVyc2lvbiI7IGlmKCRfLkRpc3BsYXlOYW1lKXskb3V0WyRfLkRpc3BsYXlOYW1lXSA9ICIkdmVyIn0gZWxzZSB7fTsgIH0KCSRyZXQgPSBAKCkKCWZvcmVhY2ggKCRrZXkgaW4gJG91dC5LZXlzKXskcmV0ICs9ICgiJGtleSAiICArICRvdXRbJGtleV0pfQoJJHJldAoJfQoJCglyZXR1cm4gKCRwcm9ncmFtc19pbnN0YWxsZWQgfCBzb3J0KQp9CgoKCmZ1bmN0aW9uIEdldC1Qcm9ncmFtKCRwcm9nLCAkdmVyKSB7CiAgICAkd2luMzJfcHJvZHVjdCA9ICRHTE9CQUw6aW5zdGFsbGVkX3Byb2dzIC1tYXRjaCAiJHByb2cuKiR2ZXIuKiIgCgkjJHdpbjMyX3Byb2R1Y3QgPSBAKGdldC13bWlvYmplY3QgIC1jb21wdXRlciAkR0xPQkFMOnRhcmdldCAtcXVlcnkgInNlbGVjdCBOYW1lLCBWZXJzaW9uIGZyb20gV2luMzJfUHJvZHVjdCB3aGVyZSBOYW1lIGxpa2UgJ2AlJHByb2dgJSciKTsKCWlmKCEkd2luMzJfcHJvZHVjdCl7CgkJI3dyaXRlLXJlZCAiJHByb2cgTk9UIElOU1RBTExFRDpgdEZBSUwgIjsKCQkkcmV0dXJuID0gMSB9CgllbHNlIHsKICAgICAgICAJCQkJI3dyaXRlLWdyZWVuICIkcHJvZyAkdmVyIElOU1RBTExFRCA6YHRQQVNTIjsKCQkJCQkJJHJldHVybiA9IDAKCQkJCQkJfQogCgkJcmV0dXJuKCRyZXR1cm4pCiAgICAgICAgfQoKCgoKZnVuY3Rpb24gR2V0LUluc3RhbGxlZENvbXBvbmVudHMgewoJJGNvbXBvbmVudHNfaW5zdGFsbGVkCT0gQCgpOwoKCSRyZWdfcGF0aHMJPSBAKCdTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvbidgCgkJCSsgJ1xTZXR1cFxPYyBNYW5hZ2VyXFN1YmNvbXBvbmVudHMnKTsKCSRyZWdfcGF0aHMJKz0gQCgnU09GVFdBUkVcV293NjQzMk5vZGVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb24nYAoJCQkrICdcU2V0dXBcT2MgTWFuYWdlclxTdWJjb21wb25lbnRzJyk7CgoJJGhrZXkJPSAnTG9jYWxNYWNoaW5lJzsKCSRyZWcJPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlblJlbW90ZUJhc2VLZXkoJGhrZXksICRHTE9CQUw6dGFyZ2V0KTsKCWZvcmVhY2ggKCRyZWdfcGF0aCBpbiAkcmVnX3BhdGhzKSB7CgkJJHJlZ19rZXkJPSAkcmVnLk9wZW5TdWJLZXkoJHJlZ19wYXRoKTsKCQlpZiAoJHJlZ19rZXkgLWVxICRudWxsKSB7CgkJCWNvbnRpbnVlOwoJCX0KCQkkbmFtZXMJPSAkcmVnX2tleS5HZXRWYWx1ZU5hbWVzKCk7CgoJCWZvcmVhY2ggKCRuYW1lIGluICRuYW1lcykgewoJCQkkdmFsdWUJPSAkcmVnX2tleS5HZXRWYWx1ZSgkbmFtZSk7CgkJCWlmICgkdmFsdWUgLWd0IDApIHsKCQkJCSRjb21wb25lbnRzX2luc3RhbGxlZCArPSBAKCRuYW1lKTsKCQkJfQoJCX0KCQkkcmVnX2tleS5jbG9zZSgpOwoJfQoJJHJlZy5jbG9zZSgpOwoKCWlmICgkY29tcG9uZW50c19pbnN0YWxsZWQuY291bnQgLWx0IDEpIHsKCQl0cmFwIHsgOwoJCWNvbnRpbnVlIH0gJGZlYXR1cmVzID0gQChnZXQtd21pb2JqZWN0IC1jbGFzcyAnV2luMzJfU2VydmVyRmVhdHVyZScgYAoJCQkJCS1jb21wdXRlciAkdGFyZ2V0IC1lcnJvcmFjdGlvbiAnU3RvcCcpOwoKCQlmb3JlYWNoICgkZmVhdHVyZSBpbiAkZmVhdHVyZXMpIHsKCQkJJGNvbXBvbmVudHNfaW5zdGFsbGVkICs9IEAoJGZlYXR1cmUubmFtZSk7CgkJfQoJfQkJCgoJcmV0dXJuICgkY29tcG9uZW50c19pbnN0YWxsZWQgfCBzb3J0KTsKfQoKI2AKCgpmdW5jdGlvbiBHZXQtRmlsZVZlcnNpb24oJGxvY2F0aW9uKQp7CiAgICBnZXQtY29tbWFuZCAkbG9jYXRpb24gfCBmb3JlYWNoIHskXy5GaWxlVmVyc2lvbkluZm99IHwgZm9yZWFjaHskXy5GaWxlVmVyc2lvbn0KfQoKCgpmdW5jdGlvbiBDb21wYXJlVmVyc2lvbnMoJHNlcnZlcklwYWtWZXJzaW9uLCAkb2ZmaWNpYWxJcGFrVmVyc2lvbikKewoJJG9mZmljaWFsSXBha1ZlcnNpb24gPSAkb2ZmaWNpYWxJcGFrVmVyc2lvbiAtcmVwbGFjZSAiLCAiLCIuIgoJI3dyaXRlLWhvc3QgIkNvbXBhcmluZyAkc2VydmVySXBha1ZlcnNpb24gd2l0aCAkb2ZmaWNpYWxJcGFrVmVyc2lvbiI7CglpZigkc2VydmVySXBha1ZlcnNpb24uY29udGFpbnMoIkluY29tcGxldGUiKSkKCQl7CgkJCXdyaXRlLXJlZCAiJHNlcnZlcklwYWtWZXJzaW9uIGB0RkFJTCIgOwogICAgICAgICAgICByZXR1cm4oIjEiKQoJCX0KCWVsc2VpZighKCRzZXJ2ZXJJcGFrVmVyc2lvbi5jb250YWlucygkb2ZmaWNpYWxJcGFrVmVyc2lvbikpKQoJCXsKCQkJd3JpdGUteWVsbG93ICIkc2VydmVySXBha1ZlcnNpb24gaXMgb3V0IG9mIGRhdGUiICA7CiAgICAgICAgICAgIHJldHVybigiMCIpCgkJfQoKCWVsc2UKCQl7CgkJCSN3cml0ZS1ncmVlbiAgIiRzZXJ2ZXJJcGFrVmVyc2lvbiA6YHRQQVNTIiA7CiAgICAgICAgICAgIHJldHVybigiMCIpCgkJfQp9CgoKZnVuY3Rpb24gY2hlY2stc3FsewojQ2hlY2sgdG8gc2VlIGlmIFNRTCBpcyBpbnN0YWxsZWQKJHNxbElwYWtWZXJzaW9uID0gR2V0LUlwYWtWZXJzaW9uICJTUUwiOwppZigkc3FsSXBha1ZlcnNpb24gLW5lICRudWxsKXsKCUNvbXBhcmVJcGFrVmVyc2lvbnMgJHNxbElwYWtWZXJzaW9uICRvZmZpY2lhbElwYWtWZXJzaW9uczsKCX0KZWxzZXsKCXdyaXRlLXJlZCAiU1FMIE5PVCBJTlNUQUxMRUQ6IGB0RkFJTCIgOwoJcmV0dXJuKCIxIikKCX0KfQoKZnVuY3Rpb24gY2hlY2staWlzewojQ2hlY2sgdG8gc2VlIGlmIHRoZXJlIGlzIElJUyBpbnN0YWxsZWQKJGlpc0lwYWtWZXJzaW9uID0gR2V0LUlwYWtWZXJzaW9uICJJSVMiOwppZigkaWlzSXBha1ZlcnNpb24gLW5lICRudWxsKXsKCUNvbXBhcmVJcGFrVmVyc2lvbnMgJGlpc0lwYWtWZXJzaW9uICRvZmZpY2lhbElwYWtWZXJzaW9uczsKCX0KZWxzZXsKCXdyaXRlLXJlZCAiSUlTIE5PVCBJTlNUQUxMRUQ6ICBgdEZBSUwiIDsKCXJldHVybigiMSIpCgl9Cgp9CgpmdW5jdGlvbiBjaGVjay13aW4yazhSMnsKI0NoZWNrIHRvIHNlZSBpZiB0aGVyZSBpcyBJSVMgaW5zdGFsbGVkCiR3aW5JcGFrVmVyc2lvbiA9IEdldC1JcGFrVmVyc2lvbiAiV2luZG93cyI7CiN3cml0ZS1ob3N0ICR3aW5JcGFrVmVyc2lvbgogICAgaWYoJHdpbklwYWtWZXJzaW9uIC1uZSAkbnVsbCl7CiAgICAgICAgaWYoJHdpbklwYWtWZXJzaW9uLmNvbnRhaW5zKCIyMDA4UjIiKSl7Q29tcGFyZUlwYWtWZXJzaW9ucyAkd2luSXBha1ZlcnNpb24gJG9mZmljaWFsSXBha1ZlcnNpb25zO30KICAgICAgICBlbHNlewoJCQl3cml0ZS1yZWQgIk5vdCBydW5uaW5nIDJrOFIyLiAgUnVubmluZyAkd2luSXBha1ZlcnNpb25gdEZBSUwiIDsKCQkJcmV0dXJuKCIxIikKCQkJfQogICAgICAgIH0KICAgIGVsc2V7CiAgICAgICAgd3JpdGUtcmVkICJPUyAgJHdpbklwYWtWZXJzaW9uICRHTE9CQUw6dGFyZ2V0IGB0RkFJTCIgOwogICAgICAgIHJldHVybigiMSIpCiAgICAgICAgfQp9CgpmdW5jdGlvbiBjaGVjay13aW4yazhTUDF7CiNDaGVjayB0byBzZWUgaWYgdGhlcmUgaXMgSUlTIGluc3RhbGxlZAokd2luSXBha1ZlcnNpb24gPSBHZXQtSXBha1ZlcnNpb24gIldpbmRvd3MiOwojd3JpdGUtaG9zdCAkd2luSXBha1ZlcnNpb24KICAgIGlmKCR3aW5JcGFrVmVyc2lvbiAtbmUgJG51bGwpewogICAgICAgIGlmKCR3aW5JcGFrVmVyc2lvbi5jb250YWlucygiMjAwOFNQMSIpKXtDb21wYXJlSXBha1ZlcnNpb25zICR3aW5JcGFrVmVyc2lvbiAkb2ZmaWNpYWxJcGFrVmVyc2lvbnM7fQogICAgICAgIGVsc2V7CgkJCXdyaXRlLXJlZCAiTm90IHJ1bm5pbmcgV0lOMms4U1AxLiAgUnVubmluZyAkd2luSXBha1ZlcnNpb25gdEZBSUwiIDsKCQkJcmV0dXJuKCIxIikKCQkJfQogICAgICAgIH0KICAgIGVsc2V7CiAgICAgICAgd3JpdGUtcmVkICJPUyAkd2luSXBha1ZlcnNpb24gYHRGQUlMIiA7CiAgICAgICAgcmV0dXJuKCIxIikKICAgICAgICB9Cgp9CgpmdW5jdGlvbiBjaGVjay13aW4yazhTUDJ7CiNDaGVjayB0byBzZWUgaWYgdGhlcmUgaXMgSUlTIGluc3RhbGxlZAokd2luSXBha1ZlcnNpb24gPSBHZXQtSXBha1ZlcnNpb24gIldpbmRvd3MiOwojd3JpdGUtaG9zdCAkd2luSXBha1ZlcnNpb24KICAgIGlmKCR3aW5JcGFrVmVyc2lvbiAtbmUgJG51bGwpewogICAgICAgIGlmKCR3aW5JcGFrVmVyc2lvbi5jb250YWlucygiMjAwOFNQMiIpKXtDb21wYXJlSXBha1ZlcnNpb25zICR3aW5JcGFrVmVyc2lvbiAkb2ZmaWNpYWxJcGFrVmVyc2lvbnM7fQogICAgICAgIGVsc2V7CgkJd3JpdGUtcmVkICJOb3QgcnVubmluZyBXSU4yazhTUDIuICBSdW5uaW5nICR3aW5JcGFrVmVyc2lvbmB0RkFJTCIgOwoJCXJldHVybigiMSIpfQogICAgICAgIH0KICAgIGVsc2V7CiAgICAgICAgd3JpdGUtcmVkICJPUyAkd2luSXBha1ZlcnNpb25gdEZBSUwiIDsKICAgICAgICByZXR1cm4oIjEiKQogICAgICAgIH0KCn0KCmZ1bmN0aW9uIGNoZWNrLWZpbGUoJGZpbGVfcGF0aCwgJGZpbGVfbmFtZSl7CiAgICAkZnVsbF9wYXRoID0gJGZpbGVfcGF0aCArICJcIiArICRmaWxlX25hbWUKICAgIGlmKFRlc3QtUGF0aCAkZnVsbF9wYXRoKXsKICAgICAgICAjd3JpdGUtZ3JlZW4gICIkZnVsbF9wYXRoOiBgblBBU1MiIDsKCQlyZXR1cm4oIjAiKQogICAgICAgIH0KICAgIGVsc2V7CiAgICAgICAgI3dyaXRlLXJlZCAiJGZ1bGxfcGF0aCA6IGB0RkFJTCIgOwoJCXJldHVybigiMSIpCiAgICAgICAgfQp9CgoKZnVuY3Rpb24gY2hlY2tfaWlzY29uZmlnKCR2YWx1ZSl7CgkkcGF0aCA9ICIvLyRHTE9CQUw6dGFyZ2V0L0MkL1dpbmRvd3MvU3lzdGVtMzIvaW5ldHNydi9jb25maWcvYXBwbGljYXRpb25Ib3N0LmNvbmZpZyIKCWlmKFRlc3QtUGF0aCAkcGF0aCl7CgkJJGlpc2NvbmZpZyA9IGdjICRwYXRoCgkJaWYoJGlpc2NvbmZpZyAtbGlrZSAiKiR2YWx1ZSoiKXsKICAgICAgICAjd3JpdGUtZ3JlZW4gICIkdmFsdWUgOmB0UEFTUyIgOwoJCXJldHVybigiMCIpCiAgICAgICAgfQogICAgZWxzZXsKICAgICAgICAjd3JpdGUtcmVkICIkdmFsdWUgOmB0RkFJTCIgOwoJCXJldHVybigiMSIpCiAgICAgICAgfQoJfQp9CgpmdW5jdGlvbiBjaGVja19pZTh7CgkkcGF0aCA9ICIvLyIgKyAkR0xPQkFMOnRhcmdldCArICIvYyQvUHJvZ3JhbSBGaWxlcyAoeDg2KS9JbnRlcm5ldCBFeHBsb3Jlci8iCglpZihUZXN0LVBhdGggJHBhdGgpewoJCSRpZXRlc3QgPSBnY2kgIiRwYXRoL2lleHBsb3JlLmV4ZSIKCQkjd3JpdGUtaG9zdCAkaWV0ZXN0LlZlcnNpb25JbmZvCgkJaWYoJGlldGVzdC5WZXJzaW9uSW5mbyAtbGlrZSAiKjguMCoiKXsKICAgICAgICAJI3dyaXRlLWdyZWVuICAiSUU4ICRpZXRlc3QgOmB0UEFTUyIgOwoJCQlyZXR1cm4oIjAiKQogICAgICAgIAl9CiAgICAJZWxzZXsKICAgICAgICAJI3dyaXRlLXJlZCAiSUU4ICRpZXRlc3QgOmB0RkFJTCIgOwoJCQlyZXR1cm4oIjEiKQogICAgICAgIAl9Cgl9CiAgICAJZWxzZXsKICAgICAgICAJI3dyaXRlLXJlZCAiSUU4IFBBVEggTk9UIEZPVU5EICRQQVRIIDpgdEZBSUwiIDsKCQkJcmV0dXJuKCIxIikKICAgICAgICAJfQoKfQoKCmZ1bmN0aW9uIEdldC1JbnN0YWxsZWRQcm9ncmFtcyB7CgkkcHJvZ3JhbXNfaW5zdGFsbGVkID0gQHt9OwoJIyR3aW4zMl9wcm9kdWN0ID0gQChnZXQtd21pb2JqZWN0IC1jbGFzcyAnV2luMzJfUHJvZHVjdCcgLWNvbXB1dGVyICRHTE9CQUw6dGFyZ2V0KTsKCSR3aW4zMl9wcm9kdWN0ID0gQChnZXQtd21pb2JqZWN0IC1jb21wdXRlciAkR0xPQkFMOnRhcmdldCAtcXVlcnkgInNlbGVjdCBOYW1lLCBWZXJzaW9uIGZyb20gV2luMzJfUHJvZHVjdCIpOwoJCglmb3JlYWNoICgkcHJvZHVjdCBpbiAkd2luMzJfcHJvZHVjdCkgewoJCSRuYW1lID0gJHByb2R1Y3QuTmFtZTsKCQkkdmVyc2lvbiA9ICRwcm9kdWN0LlZlcnNpb247CgkJaWYgKCRuYW1lIC1uZSAkbnVsbCkgewoJCQkkcHJvZ3JhbXNfaW5zdGFsbGVkLiRuYW1lID0gJHZlcnNpb247CgkJCXdyaXRlLUhvc3QgLWYgZ3JheSAiJG5hbWUgOiBWZXJzaW9uOiAkdmVyc2lvbiI7CgkJfQoJfQoJcmV0dXJuICRwcm9ncmFtc19pbnN0YWxsZWQ7Cn0KCgpmdW5jdGlvbiBHZXQtSW5zdGFsbGVkQ29tcG9uZW50cyB7CgkkY29tcG9uZW50c19pbnN0YWxsZWQJPSBAKCk7CgoJJHJlZ19wYXRocwk9IEAoJ1NPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uJ2AKCQkJKyAnXFNldHVwXE9jIE1hbmFnZXJcU3ViY29tcG9uZW50cycpOwoJJHJlZ19wYXRocwkrPSBAKCdTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvbidgCgkJCSsgJ1xTZXR1cFxPYyBNYW5hZ2VyXFN1YmNvbXBvbmVudHMnKTsKCgkkaGtleQk9ICdMb2NhbE1hY2hpbmUnOwoJJHJlZwk9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuUmVtb3RlQmFzZUtleSgkaGtleSwgJEdMT0JBTDp0YXJnZXQpOwoJZm9yZWFjaCAoJHJlZ19wYXRoIGluICRyZWdfcGF0aHMpIHsKCQkkcmVnX2tleQk9ICRyZWcuT3BlblN1YktleSgkcmVnX3BhdGgpOwoJCWlmICgkcmVnX2tleSAtZXEgJG51bGwpIHsKCQkJY29udGludWU7CgkJfQoJCSRuYW1lcwk9ICRyZWdfa2V5LkdldFZhbHVlTmFtZXMoKTsKCgkJZm9yZWFjaCAoJG5hbWUgaW4gJG5hbWVzKSB7CgkJCSR2YWx1ZQk9ICRyZWdfa2V5LkdldFZhbHVlKCRuYW1lKTsKCQkJaWYgKCR2YWx1ZSAtZ3QgMCkgewoJCQkJJGNvbXBvbmVudHNfaW5zdGFsbGVkICs9IEAoJG5hbWUpOwoJCQl9CgkJfQoJCSRyZWdfa2V5LmNsb3NlKCk7Cgl9CgkkcmVnLmNsb3NlKCk7CgoJaWYgKCRjb21wb25lbnRzX2luc3RhbGxlZC5jb3VudCAtbHQgMSkgewoJCXRyYXAgeyA7CgkJY29udGludWUgfSAkZmVhdHVyZXMgPSBAKGdldC13bWlvYmplY3QgLWNsYXNzICdXaW4zMl9TZXJ2ZXJGZWF0dXJlJyBgCgkJCQkJLWNvbXB1dGVyICRHTE9CQUw6dGFyZ2V0IC1lcnJvcmFjdGlvbiAnU3RvcCcpOwoKCQlmb3JlYWNoICgkZmVhdHVyZSBpbiAkZmVhdHVyZXMpIHsKCQkJJGNvbXBvbmVudHNfaW5zdGFsbGVkICs9IEAoJGZlYXR1cmUubmFtZSk7CgkJfQoJfQkJCgoJcmV0dXJuICgkY29tcG9uZW50c19pbnN0YWxsZWQgfCBzb3J0KTsKfQoKZnVuY3Rpb24gZ2V0LXdlYnNlcnZpY2Utc3RhdHVzewokd3d3c2VydmljZSA9IGdldC1zZXJ2aWNlIHczc3ZjIC1jb21wdXRlcm5hbWUgJEdMT0JBTDp0YXJnZXQKJHN0YXR1cyA9ICR3d3dzZXJ2aWNlLnN0YXR1cwogaWYgKCRzdGF0dXMgLWVxICJydW5uaW5nIil7CglyZXR1cm4oIjAiKQogICAgICAgIH0KICAgIGVsc2V7CglyZXR1cm4oIjEiKQogICAgICAgIH0KfQoKCmZ1bmN0aW9uIGdldC1zZXJ2aWNlLXN0YXR1cygkc2VydmljZSl7Cgkkc3RhdHVzICA9IChnZXQtc2VydmljZSAkc2VydmljZSAtY29tcHV0ZXJuYW1lICRHTE9CQUw6dGFyZ2V0KS5zdGF0dXMKIAlpZiAoJHN0YXR1cyAtZXEgInJ1bm5pbmciKXsKCQlyZXR1cm4oIjAiKQogICAgICAgIAl9CiAgICAJZWxzZXsKCQlyZXR1cm4oIjEiKQogICAgICAgIAl9Cn0KCgoKZnVuY3Rpb24gZG9fbm90aGluZ3sKcmV0dXJuKDApCn0KCgoKZnVuY3Rpb24gY2hlY2staW5zdGFsbGVkLXdpbmRvd3MtZmVhdHVyZXMoJGNvbXBvbmVudCl7CiAgICBpZiAoJEdMT0JBTDppbnN0YWxsZWRfY29tcG9uZW50cyAtZXEgJGNvbXBvbmVudCl7CgkJCiAgICAgICAgI3dyaXRlLWdyZWVuICAiJGNvbXBvbmVudCA6YHRQQVNTIiA7cmV0dXJuKCIwIikKCXJldHVybigiMCIpCiAgICAgICAgfQogICAgZWxzZXsKICAgICAgICAjd3JpdGUtcmVkICIkY29tcG9uZW50IDpgdEZBSUwiIDtyZXR1cm4oIjEiKQoJcmV0dXJuKCIxIikKICAgICAgICB9Cn0gCgoKCgpmdW5jdGlvbiBldmFsX3Jlc3BvbnNlX2NvZGV7CnBhcmFtKCR0ZXN0aXRlbSwgJHJlc3BvbnNlKQogaWYoJHJlc3BvbnNlIC1lcSAiMCIpewoJd3JpdGUtZ3JlZW4gIiR0ZXN0aXRlbSA6IGB0UEFTUyIKCSNyZXR1cm4oJHJlc3BvbnNlKQogfQogZWxzZXsKICB3cml0ZS1yZWQgIiR0ZXN0aXRlbSA6IGB0RkFJTCIKICAjcmV0dXJuKCRyZXNwb25zZSkKICB9Cgp9CgoKCgoKCgpmdW5jdGlvbiB0ZXN0LXNpbHZlcmxpZ2h0LWNyb3NzZG9tYWluewokcGF0aCA9ICdcXCcgKyAkR0xPQkFMOnRhcmdldCArICdcRSRcQ29udGVudFxJaXNEcm9wXGNsaWVudGFjY2Vzc3BvbGljeS54bWwnCiRyZXN1bHQgPSBUZXN0LVBhdGggJHBhdGgKI3dyaXRlLWhvc3QgIiAkcmVzdWx0ICRwYXRoICIKcmV0dXJuKCRyZXN1bHQpCn0KCmZ1bmN0aW9uIHNlbmQtbWFpbCB7CglwYXJhbSgKCSAgICBbc3RyaW5nW11dICR0byA9ICQodGhyb3cgIlBsZWFzZSBzcGVjaWZ5IHRoZSBkZXN0aW5hdGlvbiBtYWlsIGFkZHJlc3MiKSwKCSAgICBbc3RyaW5nXSAkc3ViamVjdCA9ICI8Tm8gU3ViamVjdD4iLAoJICAgIFtzdHJpbmddICRib2R5ID0gJCh0aHJvdyAiUGxlYXNlIHNwZWNpZnkgdGhlIG1lc3NhZ2UgY29udGVudCIpLAoJICAgIFtzdHJpbmddICRzbXRwSG9zdCA9ICQodGhyb3cgIlBsZWFzZSBzcGVjaWZ5IGEgbWFpbCBzZXJ2ZXIuIiksCgkgICAgW3N0cmluZ10gJGZyb20gPSAiJCgkZW52OlVzZXJOYW1lKUBleGFtcGxlLmNvbSIKCSAgKQoJCgkjIyBDcmVhdGUgdGhlIG1haWwgbWVzc2FnZQoJJGVtYWlsID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0Lk1haWwuTWFpbE1lc3NhZ2UgCgkkZW1haWwuaXNCb2R5aHRtbCA9ICR0cnVlIAoJCgkKCQoJIyMgUG9wdWxhdGUgaXRzIGZpZWxkcwoJZm9yZWFjaCgkbWFpbFRvIGluICR0bykKCXsKCSAgICAkZW1haWwuVG8uQWRkKCRtYWlsVG8pCgl9CgoJJGVtYWlsLkZyb20gPSAkZnJvbQoJJGVtYWlsLlN1YmplY3QgPSAkc3ViamVjdAoJJGVtYWlsLkJvZHkgPSAkYm9keQoKCSMjIFNlbmQgdGhlIG1haWwKCSRjbGllbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuTWFpbC5TbXRwQ2xpZW50ICRzbXRwSG9zdAoJJGNsaWVudC5Vc2VEZWZhdWx0Q3JlZGVudGlhbHMgPSAkdHJ1ZQoJJGNsaWVudC5TZW5kKCRlbWFpbCkKCgp9CgoKCgpmdW5jdGlvbiB3cml0ZS1ncmVlbiB7CglwYXJhbSgkc3RyaW5nKQoJd3JpdGUtSG9zdCAtZiBncmVlbiAiJHN0cmluZyIKfQoKCmZ1bmN0aW9uIHdyaXRlLXJlZCB7CglwYXJhbSgkc3RyaW5nKQoJd3JpdGUtSG9zdCAtZiByZWQgIiRzdHJpbmciCn0KCgpmdW5jdGlvbiB3cml0ZS15ZWxsb3cgewoJcGFyYW0oJHN0cmluZykKCXdyaXRlLUhvc3QgLWYgeWVsbG93ICIkc3RyaW5nIgp9CgoKZnVuY3Rpb24gd3JpdGUtY3lhbiB7CglwYXJhbSgkc3RyaW5nMSwgJHN0cmluZzIpCgl3cml0ZS1Ib3N0IC1mIGN5YW4gIiRzdHJpbmcxIDogJHN0cmluZzIiCn0KCmZ1bmN0aW9uIHdyaXRlLWdyYXkgewoJcGFyYW0oJHN0cmluZzEsICRzdHJpbmcyKQoJd3JpdGUtSG9zdCAtZiBncmF5ICIkc3RyaW5nMSA6ICRzdHJpbmcyIgp9CgoKCmZ1bmN0aW9uIHdyaXRlLWxpbmsgewoJcGFyYW0oJHN0cmluZzEsICRzdHJpbmcyLCRzdHJpbmczLCAkc3RyaW5nNCkKCXdyaXRlLUhvc3QgLWYgZ3JlZW4gIiRzdHJpbmcxIDogJHN0cmluZzMiCn0KCmZ1bmN0aW9uIHdyaXRlLXJlZC1saW5rIHsKCXBhcmFtKCRzdHJpbmcxLCAkc3RyaW5nMiwkc3RyaW5nMywgJHN0cmluZzQpCgl3cml0ZS1Ib3N0IC1mIHJlZCAiJHN0cmluZzEgOiAkc3RyaW5nMyIKfQoKZnVuY3Rpb24gd3JpdGUteWVsbG93LWxpbmsgewoJcGFyYW0oJHN0cmluZzEsICRzdHJpbmcyLCRzdHJpbmczLCAkc3RyaW5nNCkKCXdyaXRlLUhvc3QgLWYgeWVsbG93ICIkc3RyaW5nMSA6ICRzdHJpbmczIgp9CgoKZnVuY3Rpb24gd3JpdGUtaHRtbC1oZWFkZXJ7Cn0KCmZ1bmN0aW9uIHdyaXRlLXJlcG9ydC1oZWFkZXJ7Cgp9CgpmdW5jdGlvbiB3cml0ZS1yZXBvcnQtZm9vdGVyIHsKfQoKCmZ1bmN0aW9uIHdyaXRlLWh0bWwtZm9vdGVyIHsKfQoKZnVuY3Rpb24gd3JpdGUtaHRtbC1mb290ZXIgewp9CgoKCgojR0VUX1JFR0tFWSBIS0N1cnJlbnRVc2VyCmZ1bmN0aW9uIEdldC1SZWdLZXlDVQp7CiAgICBwYXJhbSgka2V5LCAkcmVnc3RyaW5nLCAkZXhwZWN0ZWRfdmFsdWUsICRmZWF0KQogICAgIyRyZWdzdHJpbmcgPSAiQ3VycmVudEJ1aWxkIgoJIyRrZXk9IlNvZnR3YXJlXE1pY3Jvc29mdFxNU01RXFBhcmFtZXRlcnMiOwogICAgJGtleXR5cGU9W01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUhpdmVdOjpDdXJyZW50VXNlcjsKICAgICRyZW1vdGViYXNlPVtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlrZXldOjpPcGVucmVtb3RlYmFzZWtleSgka2V5dHlwZSwkR0xPQkFMOnRhcmdldCk7CiAgICAjJHJlbW90ZWJhc2UKICAgICRyZWdrZXk9JHJlbW90ZWJhc2UuT3BlblN1YmtleSgka2V5KTsKCSMkcmVna2V5CiAgICAkcmVndmFsdWUgPSAkcmVna2V5LkdldFZhbHVlKCRyZWdzdHJpbmcpIAoJaWYoICRyZWd2YWx1ZSAtZXEgJGV4cGVjdGVkX3ZhbHVlKXsKICAgICRyZXQgPSAiJGZlYXQgYHRQQVNTOiBWZXJzaW9uOiAkcmVndmFsdWUiCiAgICAkcmV0ID0gIiRmZWF0IDogJHJlZ3ZhbHVlIgkKICAgICN3cml0ZS1ncmVlbiAiJHJldCA6YHRQQVNTIgogICAgcmV0dXJuKCIwIikKCX0KCWVsc2UgeyRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUgOmB0RkFJTCIKCSN3cml0ZS1yZWQgJHJldCAJCiAgICByZXR1cm4oIjEiKQoJfQp9CgojZ2VuZXJpYyBnZXQtZmlyZXdhbGxydWxlCmZ1bmN0aW9uIEdldC1GaXJld2FsbFJ1bGUgewoJIHBhcmFtKCRydWxlbmFtZSkKCSMkdGVzdCA9IG5ldHNoIC1yICRHTE9CQUw6dGFyZ2V0IGFkdmZpcmV3YWxsIGZpcmV3YWxsIHNob3cgcnVsZSBuYW1lPSJBbGxvdyA2NCBvY3RvcHVzIgoJJHRlc3QgPWludm9rZS1jb21tYW5kIC1Db21wdXRlck5hbWUgJEdMT0JBTDp0YXJnZXQgLXNjcmlwdGJsb2Nre25ldHNoIGFkdmZpcmV3YWxsIGZpcmV3YWxsIHNob3cgcnVsZSBuYW1lPSIqIn0KCWlmKCR0ZXN0IC1saWtlICIqbm8gcnVsZXMqIil7CgkJcmV0dXJuKCIxIikKCQl9CgllbHNlewoJCXJldHVybigiMCIpCgkJfQp9CgoKZnVuY3Rpb24gZ2VuZXJpY19nZXRfd21pewoJcGFyYW0oJFczMkNsYXNzLCAkTmFtZSwgJFZhbHVlKQoJJGNoZWNrdmFsID0gR2V0LVdtaU9iamVjdCAtY2xhc3MgJFczMkNsYXNzIC1jb21wdXRlciAkR0xPQkFMOnRhcmdldAoJJGNvbXB2YWwgPSAkY2hlY2t2YWwuJE5hbWUKCglpZigkY29tcHZhbCAtZXEgJFZhbHVlKQoJewoJCSN3cml0ZS1vdXRwdXQgIlZhbHVlcyBNYXRjaCIKCQlleGl0IDAgICAgCgl9CgllbHNlCgl7CgkJI3dyaXRlLW91dHB1dCAiJGNvbXB2YWwgZG9lcyBub3QgbWF0Y2ggJFZhbHVlIgoJCWV4aXQgMQoKCX0KCn0KCgoKZnVuY3Rpb24gZ2V0LWFwcC1wb29sLXN0YXR1cyB7CglwYXJhbSgkYXBwX3Bvb2wpCgkkYmxvY2sgPSB7IAoJCWltcG9ydC1tb2R1bGUgJ3dlYkFkbWluaXN0cmF0aW9uJwoJCShHZXQtV2ViQXBwUG9vbFN0YXRlICIkYXBwX3Bvb2wiKS52YWx1ZTsgCgkJfQoJCgkjd3JpdGUtaG9zdCAtZiBjeWFuICJUZXN0aW5nICR0YXJnZXQiCgkkc3RhdGUgPSBJbnZva2UtQ29tbWFuZCAtY29tcHV0ZXJuYW1lICR0YXJnZXQgLVNjcmlwdEJsb2NrICRibG9jawoJaWYoJHN0YXRlIC1lcSAic3RvcHBlZCIpe3dyaXRlLWhvc3QgLWYgcmVkICIkcG9vbCAkc3RhdGUiOyAkcmV0dXJuID0gMTt9CgllbHNle3dyaXRlLWhvc3QgLWYgZ3JlZW4gIiRwb29sICRzdGF0ZSI7ICRyZXR1cm4gPSAwO30KCXJldHVybiAkcmV0dXJuCn0KCQpmdW5jdGlvbiBnZXQtc3FsLXBlcm1zewoJJGJsb2NrID0gewoJCUFkZC1QU1NuYXBpbiBTcWxTZXJ2ZXJDbWRsZXRTbmFwaW4xMDAKCQlBZGQtUFNTbmFwaW4gU3FsU2VydmVyUHJvdmlkZXJTbmFwaW4xMDAKCQlzZXQtTG9jYXRpb24gU1FMU0VSVkVSOlxTUUwKCQlTZXQtTG9jYXRpb24gU1FMU0VSVkVSOlxTUUxcbG9jYWxob3N0XERFRkFVTFRcRGF0YWJhc2VzCgkJZ2NpICB8IGZvcm1hdC1saXN0IC1wcm9wZXJ0eSBQU0NoaWxkTmFtZQoJCWdjaSAuXEFwcEZhYlBlcnNcVXNlcnMKCX0KCgkkc3RhdGUgPSBJbnZva2UtQ29tbWFuZCAtY29tcHV0ZXJuYW1lICR0YXJnZXQgLVNjcmlwdEJsb2NrICRibG9jawoJaWYoJHN0YXRlIC1lcSAic3RvcHBlZCIpe3dyaXRlLWhvc3QgLWYgcmVkICIkcG9vbCAkc3RhdGUiOyByZXR1cm4gMTt9CgllbHNle3dyaXRlLWhvc3QgLWYgZ3JlZW4gIiRwb29sICRzdGF0ZSI7CgkKCX0KfQoKZnVuY3Rpb24gR2V0LURvbWFpbkZpcmV3YWxsUnVsZURldGFpbHMgewoJJG91dHB1dCA9IGludm9rZS1jb21tYW5kIC1Db21wdXRlck5hbWUgJEdMT0JBTDp0YXJnZXQgLXNjcmlwdGJsb2Nre25ldHNoIGFkdmZpcmV3YWxsIG1vbml0b3Igc2hvdyBmaXJld2FsbH0KCSRidWZmZXIgPSBAKCkKCSRoYXNodG1wID0gQHt9CgkkZm91bmQgPSAwCgoJZm9yZWFjaCgkbGluZSBpbiAkb3V0cHV0KXsKCQlpZigkbGluZSAtbGlrZSAiKlByb2ZpbGUgU2V0dGluZ3M6KiIpewoJCQlpZigkZm91bmQgLWd0IDApewoJCQkJI3dyaXRlLWhvc3QgImJ1ZmZlciBpcyAkYnVmZmVyIgoJCQkJJGhhc2h0bXBbJHJ1bGVuYW1lXT1AKCkKCQkJCSRoYXNodG1wWyRydWxlbmFtZV09JGJ1ZmZlcgoJCQkJfQoJCQkkcnVsZW5hbWUgPSAoJGxpbmUgLXJlcGxhY2UgIjoiLCIiKS50cmltZW5kKCkKCQkJI3dyaXRlLWhvc3QgLWYgY3lhbiAiUnVsZSBuYW1lIGlzICRydWxlbmFtZSI7CgkJCSRidWZmZXIgPSBAKCkKCQkJJGZvdW5kKysKCQl9CgkJZWxzZXsKCQkJJGJ1ZmZlciArPSAkbGluZTsKCQl9Cgl9CQoJCgoJaWYoKCRoYXNodG1wWyJEb21haW4gUHJvZmlsZSBTZXR0aW5ncyJdIC1saWtlICIqQWxsb3dJbmJvdW5kLEFsbG93T3V0Ym91bmQqIikpewoJCSN3cml0ZS1ob3N0IC1mIGN5YW4gJGhhc2h0bXBbIkRvbWFpbiBQcm9maWxlIFNldHRpbmdzIl0gCgkJcmV0dXJuIDAKCQl9CgllbHNlewoJI3dyaXRlLWhvc3QgLWYgY3lhbiAkaGFzaHRtcFsiRG9tYWluIFByb2ZpbGUgU2V0dGluZ3MiXSAKCXJldHVybiAxCgl9CgkKfQoKZnVuY3Rpb24gR2V0LUZpcmV3YWxsUnVsZURldGFpbHMgewoJcGFyYW0oJHJ1bGVuYW1lKQoJJG91dHB1dCA9IGludm9rZS1jb21tYW5kIC1Db21wdXRlck5hbWUgJEdMT0JBTDp0YXJnZXQgLXNjcmlwdGJsb2Nre25ldHNoIGFkdmZpcmV3YWxsIGZpcmV3YWxsIHNob3cgcnVsZSBuYW1lPSJhbGwiIGRpcj0iaW4iIHR5cGU9ImR5bmFtaWMifQoJJHRlbXB2YXIgPSBAKCkKCSRoYXNodG1wID0gQHt9CgoJZm9yZWFjaCgkbGluZSBpbiAkb3V0cHV0KXsKCQlpZigkbGluZSAtbGlrZSAiUnVsZSBOYW1lKiIpewoJCQkkaGFzaHRtcFskcnVsZW5hbWVdPUAoKQoJCQkkaGFzaHRtcFskcnVsZW5hbWVdPSR0ZW1wdmFyCgkJCSRydWxlbmFtZSA9ICRsaW5lIC1yZXBsYWNlICJSdWxlIE5hbWU6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICIsIiI7CgkJCXdyaXRlLWhvc3QgLWYgY3lhbiAiUnVsZSBuYW1lIGlzICRydWxlbmFtZSI7CgkJCSR0ZW1wdmFyID0gQCgpCgkJCX0KCQllbHNlewoJCQkkdGVtcHZhciArPSAkbGluZTsKCQl9CQkKCX0KCQoJIyR0ZXN0ID0gbmV0c2ggLXIgJEdMT0JBTDp0YXJnZXQgYWR2ZmlyZXdhbGwgZmlyZXdhbGwgc2hvdyBydWxlIG5hbWU9IkFsbG93IDY0IG9jdG9wdXMiCgoJaWYoJGhhc2h0bXBbJHJ1bGVuYW1lXSl7CgkJd3JpdGUtaG9zdCAkaGFzaHRtcFskcnVsZW5hbWVdCgkJcmV0dXJuKCIwIikKCQl9CgllbHNlewoJCXJldHVybigiMSIpCgkJfQp9CgoKZnVuY3Rpb24gZ2V0LXdlYnBhZ2V7CglwYXJhbSgkdXJsKQoJJHVybCA9ICdodHRwOi8vJyArJEdMT0JBTDp0YXJnZXQgKyAnLycgKyAkdXJsCgkkcmVxID0gW3N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgkdXJsKSAKCSRyZXEudGltZW91dCA9IDEwMDAwCgkkcmVzID0gJHJlcS5HZXRSZXNwb25zZSgpIAoJIyRyZXMuU3RhdHVzQ29kZSAKCSRzdGF0dXNfY29kZSA9IFtpbnRdJHJlcy5TdGF0dXNDb2RlIAoJaWYoJHN0YXR1c19jb2RlIC1lcSAyMDApe3JldHVybigwKX0KCWVsc2V7cmV0dXJuICgxKX0KfQoKCgpmdW5jdGlvbiBnZXQtZ2VuZXJpYy13ZWJwYWdlewoJcGFyYW0oJHVybCkKCSR1cmwgPSAnaHR0cDovLycgKyAkdXJsCgkkcmVxID0gW3N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgkdXJsKSAKCSRyZXEudGltZW91dCA9IDEwMDAwCgkkcmVzID0gJHJlcS5HZXRSZXNwb25zZSgpIAoJIyRyZXMuU3RhdHVzQ29kZSAKCSRzdGF0dXNfY29kZSA9IFtpbnRdJHJlcy5TdGF0dXNDb2RlIAoJaWYoJHN0YXR1c19jb2RlIC1lcSAyMDApe3JldHVybigwKX0KCWVsc2V7cmV0dXJuICgxKX0KfQoJCgpmdW5jdGlvbiBnZXQtd2VicGFnZS1yZW1vdGV7CglwYXJhbSgkdXJsKQoJJHVybCA9ICdodHRwOi8vJyArICR1cmwKCSRibG9jayA9ICckcmVxID0gW3N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgiJyArICR1cmwgKyAnIikgCgkkcmVxLnRpbWVvdXQgPSAxMDAwMAoJJHJlcyA9ICRyZXEuR2V0UmVzcG9uc2UoKSAKCSMkcmVzLlN0YXR1c0NvZGUgCgkkc3RhdHVzX2NvZGUgPSBbaW50XSRyZXMuU3RhdHVzQ29kZQoJI3dyaXRlLWhvc3QgJHN0YXR1c19jb2RlCglyZXR1cm4gJHN0YXR1c19jb2RlJwoJJG91dHB1dCA9IGludm9rZS1jb21tYW5kIC1Db21wdXRlck5hbWUgJEdMT0JBTDp0YXJnZXQgLXNjcmlwdGJsb2Nre3BhcmFtKCRzZW5kYmxvY2spOyBpbnZva2UtZXhwcmVzc2lvbiAkc2VuZGJsb2NrfSAtYXJndW1lbnRsaXN0ICgkYmxvY2spCgkKCWlmKCRvdXRwdXQgLWVxIDIwMCl7CgkJI3dyaXRlLWhvc3QgJG91dHB1dAoJCXJldHVybigwKQoJfQoJZWxzZXsKCSN3cml0ZS1ob3N0ICRvdXRwdXQKCXJldHVybiAoMSkKCX0KfQoKCgpmdW5jdGlvbiBjaGVjay1hZG1pbi1zZWMtZ3JvdXB7CiRzZWNwb2xpY3kgPSAgSW52b2tlLUNvbW1hbmQgLWNvbXB1dGVybmFtZSAkR0xPQkFMOnRhcmdldCAtc2NyaXB0YmxvY2sge25ldCBsb2NhbGdyb3VwIGFkbWluaXN0cmF0b3JzfQppZigkR0xPQkFMOkVudiAtZXEgIklOVCIpeyAkbWF0Y2ggPSAiKmFkbWluaXN0cmF0b3JzKiJ9CmVsc2VpZigkR0xPQkFMOkVudiAtZXEgIlBST0QiKXsgJG1hdGNoID0gIiphZG1pbmlzdHJhdG9ycyoifQplbHNleyRtYXRjaCA9ICIqZ3Vlc3QqIn0KCiN3cml0ZS1ob3N0ICJtYXRjaCBpcyAkbWF0Y2ggZW52IGlzICRHTE9CQUw6RW52IiAKaWYoJHNlY3BvbGljeSAtbGlrZSAkbWF0Y2gpe3JldHVybigwKX0KZWxzZXtyZXR1cm4gKDEpfQp9CgpmdW5jdGlvbiB0ZXN0LWluY29taW5nLXBvcnR7ClBhcmFtKCRwb3J0PTEzNSkKCSRzcnYgPSAkR0xPQkFMOnRhcmdldAoJJHRpbWVvdXQ9MTAwMAoJJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogCgkjIENyZWF0ZSBUQ1AgQ2xpZW50CgkkdGNwY2xpZW50ID0gbmV3LU9iamVjdCBzeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50CiAKCSMgVGVsbCBUQ1AgQ2xpZW50IHRvIGNvbm5lY3QgdG8gbWFjaGluZSBvbiBQb3J0CgkkaWFyID0gJHRjcGNsaWVudC5CZWdpbkNvbm5lY3QoJHNydiwkcG9ydCwkbnVsbCwkbnVsbCkKIAoJIyBTZXQgdGhlIHdhaXQgdGltZQoJJHdhaXQgPSAkaWFyLkFzeW5jV2FpdEhhbmRsZS5XYWl0T25lKCR0aW1lb3V0LCRmYWxzZSkKIAoJIyBDaGVjayB0byBzZWUgaWYgdGhlIGNvbm5lY3Rpb24gaXMgZG9uZQoJaWYoISR3YWl0KQoJewoJCSMgQ2xvc2UgdGhlIGNvbm5lY3Rpb24gYW5kIHJlcG9ydCB0aW1lb3V0CgkJJHRjcGNsaWVudC5DbG9zZSgpCgkJaWYoJHZlcmJvc2Upe1dyaXRlLUhvc3QgIkNvbm5lY3Rpb24gVGltZW91dCJ9CgkJUmV0dXJuICRmYWxzZQoJfQoJZWxzZQoJewoJCSMgQ2xvc2UgdGhlIGNvbm5lY3Rpb24gYW5kIHJlcG9ydCB0aGUgZXJyb3IgaWYgdGhlcmUgaXMgb25lCgkJJGVycm9yLkNsZWFyKCkKCQkkdGNwY2xpZW50LkVuZENvbm5lY3QoJGlhcikgfCBvdXQtTnVsbAoJCWlmKCEkPyl7aWYoJHZlcmJvc2Upe3dyaXRlLWhvc3QgJGVycm9yWzBdfTskZmFpbGVkID0gJHRydWV9CgkJJHRjcGNsaWVudC5DbG9zZSgpCgl9CiAKCSMgUmV0dXJuICR0cnVlIGlmIGNvbm5lY3Rpb24gRXN0YWJsaXNoIGVsc2UgJEZhbHNlCglpZigkZmFpbGVkKXtyZXR1cm4gJGZhbHNlfWVsc2V7cmV0dXJuICR0cnVlfQp9CgoKZnVuY3Rpb24gdGVzdC1vdXRnb2luZy1wb3J0ewoJUGFyYW0oJHNydiwgJHBvcnQ9MTM1KQoJJHRpbWVvdXQ9MTAwMAoJJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgoJJGJsb2NrID0gJwoJCSMgQ3JlYXRlIFRDUCBDbGllbnQKCQkkdGNwY2xpZW50ID0gbmV3LU9iamVjdCBzeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50CgkJIyBUZWxsIFRDUCBDbGllbnQgdG8gY29ubmVjdCB0byBtYWNoaW5lIG9uIFBvcnQKCQkkaWFyID0gJHRjcGNsaWVudC5CZWdpbkNvbm5lY3QoIicgKyAkc3J2ICsgJyIsIicgKyAkcG9ydCArICciLCRudWxsLCRudWxsKQoJCSMgU2V0IHRoZSB3YWl0IHRpbWUKCQkkd2FpdCA9ICRpYXIuQXN5bmNXYWl0SGFuZGxlLldhaXRPbmUoJyArICR0aW1lb3V0ICsgJywkZmFsc2UpCgkJIyBDaGVjayB0byBzZWUgaWYgdGhlIGNvbm5lY3Rpb24gaXMgZG9uZQoJCWlmKCEkd2FpdCkKCQl7CgkJCSMgQ2xvc2UgdGhlIGNvbm5lY3Rpb24gYW5kIHJlcG9ydCB0aW1lb3V0CgkJCSR0Y3BjbGllbnQuQ2xvc2UoKQoJCQlpZigkdmVyYm9zZSl7V3JpdGUtSG9zdCAiQ29ubmVjdGlvbiBUaW1lb3V0In0KCQkJUmV0dXJuICRmYWxzZQoJCX0KCQllbHNlCgkJewoJCQkjIENsb3NlIHRoZSBjb25uZWN0aW9uIGFuZCByZXBvcnQgdGhlIGVycm9yIGlmIHRoZXJlIGlzIG9uZQoJCQkkZXJyb3IuQ2xlYXIoKQoJCQkkdGNwY2xpZW50LkVuZENvbm5lY3QoJGlhcikgfCBvdXQtTnVsbAoJCQlpZighJD8pe2lmKCR2ZXJib3NlKXt3cml0ZS1ob3N0ICRlcnJvclswXX07JGZhaWxlZCA9ICR0cnVlfQoJCQkkdGNwY2xpZW50LkNsb3NlKCkKCQkJIyBSZXR1cm4gJHRydWUgaWYgY29ubmVjdGlvbiBFc3RhYmxpc2ggZWxzZSAkRmFsc2UKCQkJaWYoJGZhaWxlZCl7IFJldHVybiAkZmFsc2V9ZWxzZXsgUmV0dXJuICR0cnVlfQoJCX0nCiAKCgkjd3JpdGUtaG9zdCAkYmxvY2sKCSRvdXRwdXQgPSBpbnZva2UtY29tbWFuZCAtQ29tcHV0ZXJOYW1lICRHTE9CQUw6dGFyZ2V0IC1zY3JpcHRibG9ja3twYXJhbSgkc2VuZGJsb2NrKTsgaW52b2tlLWV4cHJlc3Npb24gJHNlbmRibG9ja30gLWFyZ3VtZW50bGlzdCAoJGJsb2NrKQoJI3dyaXRlLWhvc3QgJG91dHB1dAoJcmV0dXJuICRvdXRwdXQKfQoKCgpmdW5jdGlvbiBjaGVjay1jZXJ0ewoJcGFyYW0oJHVybCkKCSRibG9jayA9ICcKCQkkY2VydCA9IGdjaSBjZXJ0OlxMb2NhbE1hY2hpbmVcTXlcIHwgP3skXy5zdWJqZWN0IC1tYXRjaCAiJyArICR1cmwgKyAnIn0KCQlpZigkY2VydCl7cmV0dXJuICR0cnVlfQoJCWVsc2V7cmV0dXJuICRmYWxzZX0KCScKCSRvdXRwdXQgPSBpbnZva2UtY29tbWFuZCAtQ29tcHV0ZXJOYW1lICRHTE9CQUw6dGFyZ2V0IC1zY3JpcHRibG9ja3twYXJhbSgkc2VuZGJsb2NrKTsgaW52b2tlLWV4cHJlc3Npb24gJHNlbmRibG9ja30gLWFyZ3VtZW50bGlzdCAoJGJsb2NrKQoJI3dyaXRlLWhvc3QgJG91dHB1dAoJcmV0dXJuICRvdXRwdXQKfQoKZnVuY3Rpb24gY2hlY2stdmFsaWRhdGlvbi1jZXJ0ewoJaWYoJEdMT0JBTDpFbnYgLWVxICJJbnQiKXskY2hlY2tfdXJsID0gInZhbGlkYXRpb24uaW50LndpbmRvd3MubWljcm9zb2Z0LmNvbSJ9CgllbHNlaWYoJEdMT0JBTDpFbnYgLWVxICJGdW5jdCIpeyRjaGVja191cmwgPSAidHN0In0KCWVsc2VpZigkR0xPQkFMOkVudiAtZXEgIlBlcmYiKXskY2hlY2tfdXJsID0gInBlcmYifQoJZWxzZXskY2hlY2tfdXJsID0gInZhbGlkYXRpb24udGVzdC5sb2MifQoJKGNoZWNrLWNlcnQgJGNoZWNrX3VybCkKfQoKZnVuY3Rpb24gY2hlY2stc2hhcmUtcGVybWlzc2lvbnN7CnBhcmFtKCRzaGFyZW5hbWUsICRhY2NvdW50X25hbWUpCgkkbG9jdGVzdCA9ICROVUxMCgkkbG9jYXRpb24gPSAiXFwiICsgJEdMT0JBTDp0YXJnZXQgKyAiXCIgKyAkc2hhcmVuYW1lCgkjIgoJZ2NpICRsb2NhdGlvbiAtZWEgc2lsZW50bHljb250aW51ZSB8ICV7CgkkZm9sZGVyID0gJF8KCSRhY2Nlc3Njb250cm9sID0gJF8uZ2V0YWNjZXNzY29udHJvbCgpCgkkYWNjZXNzY29udHJvbC5hY2Nlc3MgfCAlewoJCWlmKCRfLklkZW50aXR5UmVmZXJlbmNlIC1lcSAkYWNjb3VudF9uYW1lKXsKCQkJd3JpdGUtZ3JlZW4gICIkZm9sZGVyICRhY2NvdW50X25hbWU6YHRQQVNTIjsgCgkJCSRsb2N0ZXN0Kyt9CgkJCX0KCXJldHVybigiMCIpCiAgICB9CglpZigkbG9jdGVzdCAtZXEgJE5VTEwpewoJCSN3cml0ZS1yZWQgIiRmb2xkZXIgJGFjY291bnRfbmFtZSA6YHRGQUlMIjsKCQlyZXR1cm4oIjEiKX0KfQoKCmZ1bmN0aW9uIENoZWNrLVJlZ0tleUlFSAp7CiAgICBwYXJhbSgka2V5LCAkcmVnc3RyaW5nLCAkZXhwZWN0ZWRfdmFsdWUsICRmZWF0KSAKICAgJGtleXR5cGU9W01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUhpdmVdOjpMb2NhbE1hY2hpbmU7CiAgICAkcmVtb3RlYmFzZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5a2V5XTo6T3BlbnJlbW90ZWJhc2VrZXkoJGtleXR5cGUsJEdMT0JBTDp0YXJnZXQpOwogICAgJHJlZ2tleT0kcmVtb3RlYmFzZS5PcGVuU3Via2V5KCRrZXkpOwogICAgJHJlZ3ZhbHVlID0gJHJlZ2tleS5HZXRWYWx1ZSgkcmVnc3RyaW5nKSAKICAgICAgICAgICAgICAgIGlmKCAkcmVndmFsdWUgLWVxICRleHBlY3RlZF92YWx1ZSl7CiAgICAkcmV0ID0gIiRmZWF0IGB0UEFTUzogVmVyc2lvbjogJHJlZ3ZhbHVlIgogICAgJHJldCA9ICIkZmVhdCA6ICRyZWd2YWx1ZSIgICAgICAgICAKICAgIHdyaXRlLWdyZWVuICIkcmV0IDpgdEZBSUwiCiAgICAgICAgICAgICAgICByZXR1cm4oIjEiKQogICAgICAgICAgICAgICAgfQplbHNlIHsKJHJldCA9ICIkZmVhdCA6ICRyZWd2YWx1ZSA6YHRQQVNTIgogICAgICAgICAgICAgICAgd3JpdGUtcmVkICRyZXQgICAKICAgICAgICAgICAgICAgIHJldHVybigiMCIpCiAgICAgICAgICAgICAgICB9Cn0KCmZ1bmN0aW9uIENoZWNrLVJlZ0tleUlFSENVCnsKICAgIHBhcmFtKCRrZXksICRyZWdzdHJpbmcsICRleHBlY3RlZF92YWx1ZSwgJGZlYXQpIAogICAka2V5dHlwZT1bTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5SGl2ZV06OkN1cnJlbnRVc2VyOwogICAgJHJlbW90ZWJhc2U9W01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeWtleV06Ok9wZW5yZW1vdGViYXNla2V5KCRrZXl0eXBlLCRHTE9CQUw6dGFyZ2V0KTsKICAgICRyZWdrZXk9JHJlbW90ZWJhc2UuT3BlblN1YmtleSgka2V5KTsKICAgICRyZWd2YWx1ZSA9ICRyZWdrZXkuR2V0VmFsdWUoJHJlZ3N0cmluZykgCiAgICAgICAgICAgICAgICBpZiggJHJlZ3ZhbHVlIC1lcSAkZXhwZWN0ZWRfdmFsdWUpewogICAgJHJldCA9ICIkZmVhdCBgdFBBU1M6IFZlcnNpb246ICRyZWd2YWx1ZSIKICAgICRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUiICAgICAgICAgCiAgICB3cml0ZS1ncmVlbiAiJHJldCA6YHRGQUlMIgogICAgICAgICAgICAgICAgcmV0dXJuKCIxIikKICAgICAgICAgICAgICAgIH0KZWxzZSB7CiRyZXQgPSAiJGZlYXQgOiAkcmVndmFsdWUgOmB0UEFTUyIKICAgICAgICAgICAgICAgIHdyaXRlLXJlZCAkcmV0ICAgCiAgICAgICAgICAgICAgICByZXR1cm4oIjAiKQogICAgICAgICAgICAgICAgfQp9CgpmdW5jdGlvbiBjaGVjay1ob3RmaXgKewoJcGFyYW0oJGhvdGZpeGlkKQogICAgaWYoR2V0LUhvdEZpeCAtZWEgc2lsZW50bHljb250aW51ZSAtSWQgIiRob3RmaXhpZCIgLUNvbXB1dGVybmFtZSAkR0xPQkFMOnRhcmdldCkgewoJCSN3cml0ZS1Ib3N0IC1mIGdyZWVuICIkaG90Zml4aWQ6YHRQQVNTIjsgCgkJcmV0dXJuKCIwIikKCQl9IAoJZWxzZSB7CgkJI3dyaXRlLUhvc3QgLWYgZ3JlZW4gIiRob3RmaXhpZDpgdEZBSUwiOyAKCQlyZXR1cm4oIjEiKQoJCX0KCn0KCmZ1bmN0aW9uIGNoZWNrLXZhbGlkYXRpb24tcGVybWlzc2lvbnN7CgkkYWNjb3VudHMgPSBAKCkKCQoJaWYoJEdMT0JBTDpFbnYgLWVxICJpbnQiKXskYWNjb3VudHMgPSAnbG9jYWxob3N0XGd1ZXN0JywgJypwcmltdXNTRyonfQoJaWYoJEdMT0JBTDpFbnYgLWVxICJwcm9kIil7JGFjY291bnRzID0gJypTRyonfQoJaWYoJEdMT0JBTDpFbnYgLWVxICJvbmVib3giKXskYWNjb3VudHMgPSAnKlNHKid9CiAgICBpZigkR0xPQkFMOkVudiAtZXEgImZ1bmN0Iil7JGFjY291bnRzID0gJypTRyonfQoJCgkjKGNoZWNrLXNoYXJlLXBlcm1pc3Npb25zICdcUFJJTVVTJyAnKlNHKicpCglmb3JlYWNoKCRhY2N0IGluICRhY2NvdW50cyl7CgkoY2hlY2stc2hhcmUtcGVybWlzc2lvbnMgJ1xkJCcgICRhY2N0KQoJfQoKCX0KCmZ1bmN0aW9uIGNoZWNrX3J1bmFzX25ldHdvcmtfc2VydmljZSB7Cgkkc3RhcnRfbmFtZSA9IChnZXQtd21pb2JqZWN0IC1jb21wdXRlciAkR0xPQkFMOnRhcmdldCAtcXVlcnkgInNlbGVjdCBTdGFydE5hbWUgZnJvbSBXaW4zMl9TZXJ2aWNlIHdoZXJlIE5hbWUgPSAnTVNTUUxTRVJWRVInIikuU3RhcnROYW1lIAoJaWYoJHN0YXJ0X25hbWUgIC1lcSAiTlQgQXV0aG9yaXR5XE5ldHdvcmtTZXJ2aWNlIikKCQl7CgkJCXdyaXRlLW91dHB1dCAiQWNjb3VudCBpcyBydW5uaW5nIHVuZGVyIE5ldHdvcmsgU2VydmljZSIKCQkJcmV0dXJuKCIwIikKCQl9CglFbHNlCgkJewoJCQl3cml0ZS1vdXRwdXQgIkFjY291bnQgaXMgbm90IHJ1bm5pbmcgdW5kZXIgTmV0d29yayBTZXJ2aWNlIgoJCQlyZXR1cm4oIjEiKQoJCX0KfQoKCgojTUFJTlNFQ1RJT04KCgppZiAoKHBpbmctaXAgJHNlcnZlcm5hbWUpKXsKCglpZigkQ29tcG9uZW50KXsKCQkkaW5zdGFsbGVkX2NvbXBvbmVudHMgPSAoR2V0LUluc3RhbGxlZENvbXBvbmVudHMgJHNlcnZlcm5hbWUpCgkJY2hlY2staW5zdGFsbGVkLXdpbmRvd3MtZmVhdHVyZXMgJENvbXBvbmVudAoJCUVYSVQKCX0KCgllbHNlaWYoJFByb2dyYW0pewoJCShHZXQtUHJvZ3JhbSAkc2VydmVybmFtZSAkUHJvZ3JhbSkKCQlFWElUCgl9CgllbHNlaWYoJFByb2dMaXN0KXsKCSRpbnN0YWxsZWRfcHJvZ3MgID0gKEdldC1JbnN0YWxsZWRQcm9ncmFtcyAkc2VydmVybmFtZSkKCUVYSVQKCX0KCWVsc2VpZigkV2luTGlzdCl7CgkoR2V0LUluc3RhbGxlZENvbXBvbmVudHMgJHNlcnZlcm5hbWUpCglFWElUCgl9Cg==
