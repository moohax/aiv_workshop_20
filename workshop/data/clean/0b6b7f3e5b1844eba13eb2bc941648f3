MSFT_msAzurePackIdentityProvider.psm1,2de38e08ce6f7f46ab3c0d7321b08fb4,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKCVtDbWRsZXRCaW5kaW5nKCldCglbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQoJcGFyYW0KCSgKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIk1lbWJlcnNoaXAiLCJXaW5kb3dzIildCgkJW1N5c3RlbS5TdHJpbmddCgkJJFRhcmdldCwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEZ1bGx5UXVhbGlmaWVkRG9tYWluTmFtZSwKCiAgICAgICAgW1N5c3RlbS5VSW50MTZdCiAgICAgICAgJFBvcnQsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KCQkkQXp1cmVQYWNrQWRtaW5DcmVkZW50aWFsLAoKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkU1FMU2VydmVyLAoKCQlbU3lzdGVtLlN0cmluZ10KCQkkU1FMSW5zdGFuY2UgPSAiTVNTUUxTRVJWRVIiCgkpCgogICAgaWYoJFNRTEluc3RhbmNlIC1lcSAiTVNTUUxTRVJWRVIiKQogICAgewogICAgICAgICRDb25uZWN0aW9uU3RyaW5nID0gIkRhdGEgU291cmNlPSRTUUxTZXJ2ZXI7SW5pdGlhbCBDYXRhbG9nPU1pY3Jvc29mdC5NZ210U3ZjLlBvcnRhbENvbmZpZ1N0b3JlO0ludGVncmF0ZWQgU2VjdXJpdHk9VHJ1ZSI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJENvbm5lY3Rpb25TdHJpbmcgPSAiRGF0YSBTb3VyY2U9JFNRTFNlcnZlclwkU1FMSW5zdGFuY2U7SW5pdGlhbCBDYXRhbG9nPU1pY3Jvc29mdC5NZ210U3ZjLlBvcnRhbENvbmZpZ1N0b3JlO0ludGVncmF0ZWQgU2VjdXJpdHk9VHJ1ZSI7CiAgICB9CgogICAgJEZRRE4gPSBJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lIC4gLUNyZWRlbnRpYWwgJEF6dXJlUGFja0FkbWluQ3JlZGVudGlhbCAtQXV0aGVudGljYXRpb24gQ3JlZHNzcCB7CiAgICAgICAgJFRhcmdldCA9ICRhcmdzWzBdCiAgICAgICAgJENvbm5lY3Rpb25TdHJpbmcgPSAkYXJnc1sxXQogICAgICAgIHN3aXRjaCgkVGFyZ2V0KQogICAgICAgIHsKICAgICAgICAgICAgIk1lbWJlcnNoaXAiCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICROYW1lc3BhY2UgPSAiQXV0aFNpdGUiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgIldpbmRvd3MiCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICROYW1lc3BhY2UgPSAiV2luZG93c0F1dGhTaXRlIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICgoQ29udmVydEZyb20tSnNvbiAoR2V0LU1nbXRTdmNEYXRhYmFzZVNldHRpbmcgLU5hbWVzcGFjZSAkTmFtZXNwYWNlIC1OYW1lIEF1dGhlbnRpY2F0aW9uLlJlbHlpbmdQYXJ0eS5QcmltYXJ5IC1Db25uZWN0aW9uU3RyaW5nICRDb25uZWN0aW9uU3RyaW5nKS5WYWx1ZSkuUmVwbHlUbykuU3BsaXQoIi8iKVsyXQogICAgfSAtQXJndW1lbnRMaXN0IEAoJFRhcmdldCwkQ29ubmVjdGlvblN0cmluZykKCiAgICAkcmV0dXJuVmFsdWUgPSBAewogICAgICAgIFRhcmdldCA9ICRUYXJnZXQKICAgICAgICBGdWxseVF1YWxpZmllZERvbWFpbk5hbWUgPSAkRlFETi5TcGxpdCgiOiIpWzBdCiAgICAgICAgUG9ydCA9ICRGUUROLlNwbGl0KCI6IilbMV0KCQlTUUxTZXJ2ZXIgPSAkU1FMU2VydmVyCgkJU1FMSW5zdGFuY2UgPSAkU1FMSW5zdGFuY2UKCX0KCgkkcmV0dXJuVmFsdWUKfQoKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CglbQ21kbGV0QmluZGluZygpXQoJcGFyYW0KCSgKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIk1lbWJlcnNoaXAiLCJXaW5kb3dzIildCgkJW1N5c3RlbS5TdHJpbmddCgkJJFRhcmdldCwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEZ1bGx5UXVhbGlmaWVkRG9tYWluTmFtZSwKCiAgICAgICAgW1N5c3RlbS5VSW50MTZdCiAgICAgICAgJFBvcnQsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KCQkkQXp1cmVQYWNrQWRtaW5DcmVkZW50aWFsLAoKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkU1FMU2VydmVyLAoKCQlbU3lzdGVtLlN0cmluZ10KCQkkU1FMSW5zdGFuY2UgPSAiTVNTUUxTRVJWRVIiCgkpCgogICAgaWYoJFBvcnQgLWVxIDApCiAgICB7CiAgICAgICAgU3dpdGNoKCRUYXJnZXQpCiAgICAgICAgewogICAgICAgICAgICAiV2luZG93cyIKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFBvcnQgPSAzMDA5MQogICAgICAgICAgICB9CiAgICAgICAgICAgICJNZW1iZXJzaGlwIgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkUG9ydCA9IDMwMDgxCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIGlmKCRTUUxJbnN0YW5jZSAtZXEgIk1TU1FMU0VSVkVSIikKICAgIHsKICAgICAgICAkUG9ydGFsQ29ubmVjdGlvblN0cmluZyA9ICJEYXRhIFNvdXJjZT0kU1FMU2VydmVyO0luaXRpYWwgQ2F0YWxvZz1NaWNyb3NvZnQuTWdtdFN2Yy5Qb3J0YWxDb25maWdTdG9yZTtJbnRlZ3JhdGVkIFNlY3VyaXR5PVRydWUiOwogICAgICAgICRNYW5hZ2VtZW50Q29ubmVjdGlvblN0cmluZyA9ICJEYXRhIFNvdXJjZT0kU1FMU2VydmVyO0luaXRpYWwgQ2F0YWxvZz1NaWNyb3NvZnQuTWdtdFN2Yy5TdG9yZTtJbnRlZ3JhdGVkIFNlY3VyaXR5PVRydWUiOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRQb3J0YWxDb25uZWN0aW9uU3RyaW5nID0gIkRhdGEgU291cmNlPSRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlO0luaXRpYWwgQ2F0YWxvZz1NaWNyb3NvZnQuTWdtdFN2Yy5Qb3J0YWxDb25maWdTdG9yZTtJbnRlZ3JhdGVkIFNlY3VyaXR5PVRydWUiOwogICAgICAgICRNYW5hZ2VtZW50Q29ubmVjdGlvblN0cmluZyA9ICJEYXRhIFNvdXJjZT0kU1FMU2VydmVyXCRTUUxJbnN0YW5jZTtJbml0aWFsIENhdGFsb2c9TWljcm9zb2Z0Lk1nbXRTdmMuU3RvcmU7SW50ZWdyYXRlZCBTZWN1cml0eT1UcnVlIjsKICAgIH0KCiAgICBJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lIC4gLUNyZWRlbnRpYWwgJEF6dXJlUGFja0FkbWluQ3JlZGVudGlhbCAtQXV0aGVudGljYXRpb24gQ3JlZHNzcCB7CiAgICAgICAgJFRhcmdldCA9ICRhcmdzWzBdCiAgICAgICAgJEZ1bGx5UXVhbGlmaWVkRG9tYWluTmFtZSA9ICRhcmdzWzFdCiAgICAgICAgJFBvcnQgPSAkYXJnc1syXQogICAgICAgICRQb3J0YWxDb25uZWN0aW9uU3RyaW5nID0gJGFyZ3NbM10KICAgICAgICAkTWFuYWdlbWVudENvbm5lY3Rpb25TdHJpbmcgPSAkYXJnc1s0XQogICAgICAgIFNldC1NZ210U3ZjSWRlbnRpdHlQcm92aWRlclNldHRpbmdzIC1UYXJnZXQgJFRhcmdldCAtTWV0YWRhdGFFbmRwb2ludCAiaHR0cHM6Ly8kRnVsbHlRdWFsaWZpZWREb21haW5OYW1lYDokUG9ydC9GZWRlcmF0aW9uTWV0YWRhdGEvMjAwNy0wNi9GZWRlcmF0aW9uTWV0YWRhdGEueG1sIiAtUG9ydGFsQ29ubmVjdGlvblN0cmluZyAkUG9ydGFsQ29ubmVjdGlvblN0cmluZyAtTWFuYWdlbWVudENvbm5lY3Rpb25TdHJpbmcgJE1hbmFnZW1lbnRDb25uZWN0aW9uU3RyaW5nIC1EaXNhYmxlQ2VydGlmaWNhdGVWYWxpZGF0aW9uOwogICAgfSAtQXJndW1lbnRMaXN0IEAoJFRhcmdldCwkRnVsbHlRdWFsaWZpZWREb21haW5OYW1lLCRQb3J0LCRQb3J0YWxDb25uZWN0aW9uU3RyaW5nLCRNYW5hZ2VtZW50Q29ubmVjdGlvblN0cmluZykKCiAgICBpZighKFRlc3QtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzKSkKICAgIHsKICAgICAgICB0aHJvdyAiU2V0LVRhcmdldFJlc291Y2UgZmFpbGVkIgogICAgfQp9CgoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CglbQ21kbGV0QmluZGluZygpXQoJW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCglwYXJhbQoJKAoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZVNldCgiTWVtYmVyc2hpcCIsIldpbmRvd3MiKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkVGFyZ2V0LAoKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRnVsbHlRdWFsaWZpZWREb21haW5OYW1lLAoKICAgICAgICBbU3lzdGVtLlVJbnQxNl0KICAgICAgICAkUG9ydCwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQoJCSRBenVyZVBhY2tBZG1pbkNyZWRlbnRpYWwsCgoJCVtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRTUUxTZXJ2ZXIsCgoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRTUUxJbnN0YW5jZSA9ICJNU1NRTFNFUlZFUiIKCSkKCiAgICBpZigkUG9ydCAtZXEgMCkKICAgIHsKICAgICAgICBTd2l0Y2goJFRhcmdldCkKICAgICAgICB7CiAgICAgICAgICAgICJXaW5kb3dzIgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkUG9ydCA9IDMwMDkxCiAgICAgICAgICAgIH0KICAgICAgICAgICAgIk1lbWJlcnNoaXAiCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRQb3J0ID0gMzAwODEKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAkRlFETiA9IEdldC1UYXJnZXRSZXNvdXJjZSBAUFNCb3VuZFBhcmFtZXRlcnMKICAgIAogICAgJHJlc3VsdCA9ICgoJEZRRE4uRnVsbHlRdWFsaWZpZWREb21haW5OYW1lIC1lcSAkRnVsbHlRdWFsaWZpZWREb21haW5OYW1lKSAtYW5kICgkRlFETi5Qb3J0IC1lcSAkUG9ydCkpCgoJJHJlc3VsdAp9CgoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKi1UYXJnZXRSZXNvdXJjZQo=
