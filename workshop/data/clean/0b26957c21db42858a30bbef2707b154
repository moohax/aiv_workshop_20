MSFT_xSQLServerMemory.psm1,cfdff79e74cd321060116a59c0c28851,Scan result is 1. IsMalware: 0,SW1wb3J0LU1vZHVsZSAtTmFtZSAoSm9pbi1QYXRoIC1QYXRoIChTcGxpdC1QYXRoIChTcGxpdC1QYXRoICRQU1NjcmlwdFJvb3QgLVBhcmVudCkgLVBhcmVudCkgLUNoaWxkUGF0aCAneFNRTFNlcnZlckhlbHBlci5wc20xJykgLUZvcmNlCgo8IwogICAgLlNZTk9QU0lTCiAgICBUaGlzIGZ1bmN0aW9uIGdldHMgdGhlIHZhbHVlIG9mIHRoZSBtaW4gYW5kIG1heCBtZW1vcnkgc2VydmVyIGNvbmZpZ3VyYXRpb24gb3B0aW9uLgoKICAgIC5QQVJBTUVURVIgU1FMU2VydmVyCiAgICBUaGUgaG9zdCBuYW1lIG9mIHRoZSBTUUwgU2VydmVyIHRvIGJlIGNvbmZpZ3VyZWQuCgogICAgLlBBUkFNRVRFUiBTUUxJbnN0YW5jZU5hbWUKICAgIFRoZSBuYW1lIG9mIHRoZSBTUUwgaW5zdGFuY2UgdG8gYmUgY29uZmlndXJlZC4KIz4KCmZ1bmN0aW9uIEdldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMU2VydmVyID0gJGVudjpDT01QVVRFUk5BTUUKICAgICkKCiAgICAkc3FsU2VydmVyT2JqZWN0ID0gQ29ubmVjdC1TUUwgLVNRTFNlcnZlciAkU1FMU2VydmVyIC1TUUxJbnN0YW5jZU5hbWUgJFNRTEluc3RhbmNlTmFtZQoKICAgIGlmICgkc3FsU2VydmVyT2JqZWN0KQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgJ0dldHRpbmcgdGhlIHZhbHVlIGZvciBtaW5pbXVtIGFuZCBtYXhpbXVtIFNRTCBzZXJ2ZXIgbWVtb3J5LicKICAgICAgICAkbWluTWVtb3J5ID0gJHNxbFNlcnZlck9iamVjdC5Db25maWd1cmF0aW9uLk1pblNlcnZlck1lbW9yeS5Db25maWdWYWx1ZQogICAgICAgICRtYXhNZW1vcnkgPSAkc3FsU2VydmVyT2JqZWN0LkNvbmZpZ3VyYXRpb24uTWF4U2VydmVyTWVtb3J5LkNvbmZpZ1ZhbHVlCiAgICB9CgogICAgJHJldHVyblZhbHVlID0gQHsKICAgICAgICBTUUxJbnN0YW5jZU5hbWUgPSAkU1FMSW5zdGFuY2VOYW1lCiAgICAgICAgU1FMU2VydmVyICAgICAgID0gJFNRTFNlcnZlcgogICAgICAgIE1pbk1lbW9yeSAgICAgICA9ICRtaW5NZW1vcnkKICAgICAgICBNYXhNZW1vcnkgICAgICAgPSAkbWF4TWVtb3J5CiAgICB9CgogICAgJHJldHVyblZhbHVlCn0KCjwjCiAgICAuU1lOT1BTSVMKICAgIFRoaXMgZnVuY3Rpb24gc2V0cyB0aGUgdmFsdWUgZm9yIHRoZSBtaW4gYW5kIG1heCBtZW1vcnkgc2VydmVyIGNvbmZpZ3VyYXRpb24gb3B0aW9uLgoKICAgIC5QQVJBTUVURVIgU1FMU2VydmVyCiAgICBUaGUgaG9zdCBuYW1lIG9mIHRoZSBTUUwgU2VydmVyIHRvIGJlIGNvbmZpZ3VyZWQuCgogICAgLlBBUkFNRVRFUiBTUUxJbnN0YW5jZU5hbWUKICAgIFRoZSBuYW1lIG9mIHRoZSBTUUwgaW5zdGFuY2UgdG8gYmUgY29uZmlndXJlZC4KICAgIAogICAgLlBBUkFNRVRFUiBFbnN1cmUKICAgIFdoZW4gc2V0IHRvICdQcmVzZW50JyB0aGVuIG1pbiBhbmQgbWF4IG1lbW9yeSB3aWxsIGJlIHNldCB0byBlaXRoZXIgdGhlIHZhbHVlIGluIHBhcmFtZXRlciBNaW5NZW1vcnkgYW5kIE1heE1lbW9yeSBvciBkeW5hbWljYWxseSBjb25maWd1cmVkIHdoZW4gcGFyYW1ldGVyIER5bmFtaWNBbGxvYyBpcyBzZXQgdG8gJHRydWUuCiAgICBXaGVuIHNldCB0byAnQWJzZW50JyBtaW4gYW5kIG1heCBtZW1vcnkgd2lsbCBiZSBzZXQgdG8gZGVmYXVsdCB2YWx1ZXMuCgogICAgLlBBUkFNRVRFUiBEeW5hbWljQWxsb2MKICAgIElmIHNldCB0byAkdHJ1ZSB0aGVuIG1heCBtZW1vcnkgd2lsbCBiZSBkeW5hbWljYWxseSBjb25maWd1cmVkLgogICAgV2hlbiB0aGlzIGlzIHNldCBwYXJhbWV0ZXIgaXMgc2V0IHRvICR0cnVlLCB0aGUgcGFyYW1ldGVyIE1heE1lbW9yeSBtdXN0IGJlIHNldCB0byAkbnVsbCBvciBub3QgYmUgY29uZmlndXJlZC4KCiAgICAuUEFSQU1FVEVSIE1pbk1lbW9yeQogICAgVGhpcyBpcyB0aGUgbWluaW11bSBhbW91bnQgb2YgbWVtb3J5LCBpbiBNQiwgaW4gdGhlIGJ1ZmZlciBwb29sIHVzZWQgYnkgdGhlIGluc3RhbmNlIG9mIFNRTCBTZXJ2ZXIuCgogICAgLlBBUkFNRVRFUiBNYXhNZW1vcnkKICAgIFRoaXMgaXMgdGhlIG1heGltdW0gYW1vdW50IG9mIG1lbW9yeSwgaW4gTUIsIGluIHRoZSBidWZmZXIgcG9vbCB1c2VkIGJ5IHRoZSBpbnN0YW5jZSBvZiBTUUwgU2VydmVyLgojPgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMU2VydmVyID0gJGVudjpDT01QVVRFUk5BTUUsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gJ1ByZXNlbnQnLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N5c3RlbS5Cb29sZWFuXQogICAgICAgICREeW5hbWljQWxsb2MgPSAkZmFsc2UsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3lzdGVtLkludDMyXQogICAgICAgICRNaW5NZW1vcnksCiAgICAgICAgCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtTeXN0ZW0uSW50MzJdCiAgICAgICAgJE1heE1lbW9yeQogICAgKQoKICAgICRzcWxTZXJ2ZXJPYmplY3QgPSBDb25uZWN0LVNRTCAtU1FMU2VydmVyICRTUUxTZXJ2ZXIgLVNRTEluc3RhbmNlTmFtZSAkU1FMSW5zdGFuY2VOYW1lCiAgICAKICAgIGlmICgkc3FsU2VydmVyT2JqZWN0KQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgJ1NldHRpbmcgdGhlIG1pbmltdW0gYW5kIG1heGltdW0gbWVtb3J5IHVzZWQgYnkgdGhlIGluc3RhbmNlLicKICAgICAgICBzd2l0Y2ggKCRFbnN1cmUpCiAgICAgICAgewogICAgICAgICAgICAnUHJlc2VudCcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCREeW5hbWljQWxsb2MpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRNYXhNZW1vcnkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBOZXctVGVybWluYXRpbmdFcnJvciAtRXJyb3JUeXBlIE1heE1lbW9yeVBhcmFtTXVzdEJlTnVsbCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Gb3JtYXRBcmdzIEAoICRTUUxTZXJ2ZXIsJFNRTEluc3RhbmNlTmFtZSApIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUVycm9yQ2F0ZWdvcnkgSW52YWxpZEFyZ3VtZW50ICAKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRNYXhNZW1vcnkgPSBHZXQtU3FsRHNjRHluYW1pY01heE1lbW9yeQogICAgICAgICAgICAgICAgICAgIE5ldy1WZXJib3NlTWVzc2FnZSAtTWVzc2FnZSAiRHluYW1pYyBtYXhpbXVtIG1lbW9yeSBoYXMgYmVlbiBjYWxjdWxhdGVkIHRvICQoJE1heE1lbW9yeSlNQi4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKC1ub3QgJE1heE1lbW9yeSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IE5ldy1UZXJtaW5hdGluZ0Vycm9yIC1FcnJvclR5cGUgTWF4TWVtb3J5UGFyYW1NdXN0Tm90QmVOdWxsIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUZvcm1hdEFyZ3MgQCggJFNRTFNlcnZlciwkU1FMSW5zdGFuY2VOYW1lICkgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRXJyb3JDYXRlZ29yeSBJbnZhbGlkQXJndW1lbnQgIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkc3FsU2VydmVyT2JqZWN0LkNvbmZpZ3VyYXRpb24uTWF4U2VydmVyTWVtb3J5LkNvbmZpZ1ZhbHVlID0gJE1heE1lbW9yeQogICAgICAgICAgICAgICAgTmV3LVZlcmJvc2VNZXNzYWdlIC1NZXNzYWdlICJNYXhpbXVtIG1lbW9yeSB1c2VkIGJ5IHRoZSBpbnN0YW5jZSBoYXMgYmVlbiBsaW1pdGVkIHRvICQoJE1heE1lbW9yeSlNQi4iCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICdBYnNlbnQnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRzcWxTZXJ2ZXJPYmplY3QuQ29uZmlndXJhdGlvbi5NYXhTZXJ2ZXJNZW1vcnkuQ29uZmlnVmFsdWUgPSAyMTQ3NDgzNjQ3CiAgICAgICAgICAgICAgICAkc3FsU2VydmVyT2JqZWN0LkNvbmZpZ3VyYXRpb24uTWluU2VydmVyTWVtb3J5LkNvbmZpZ1ZhbHVlID0gMAogICAgICAgICAgICAgICAgTmV3LVZlcmJvc2VNZXNzYWdlIC1NZXNzYWdlICgnRW5zdXJlIGlzIHNldCB0byBhYnNlbnQuIE1pbmltdW0gYW5kIG1heGltdW0gc2VydmVyIG1lbW9yeScgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YWx1ZXMgdXNlZCBieSB0aGUgaW5zdGFuY2UgYXJlIHJlc2V0IHRvIHRoZSBkZWZhdWx0IHZhbHVlcy4nKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkTWluTWVtb3J5KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc3FsU2VydmVyT2JqZWN0LkNvbmZpZ3VyYXRpb24uTWluU2VydmVyTWVtb3J5LkNvbmZpZ1ZhbHVlID0gJE1pbk1lbW9yeQogICAgICAgICAgICAgICAgTmV3LVZlcmJvc2VNZXNzYWdlIC1NZXNzYWdlICJNaW5pbXVtIG1lbW9yeSB1c2VkIGJ5IHRoZSBpbnN0YW5jZSBpcyBzZXQgdG8gJCgkTWluTWVtb3J5KU1CLiIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHNxbFNlcnZlck9iamVjdC5BbHRlcigpCiAgICAgICAgfQogICAgICAgIGNhdGNoCiAgICAgICAgewogICAgICAgICAgICB0aHJvdyBOZXctVGVybWluYXRpbmdFcnJvciAtRXJyb3JUeXBlIEFsdGVyU2VydmVyTWVtb3J5RmFpbGVkIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUZvcm1hdEFyZ3MgQCgkU1FMU2VydmVyLCRTUUxJbnN0YW5jZU5hbWUpIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUVycm9yQ2F0ZWdvcnkgSW52YWxpZE9wZXJhdGlvbiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Jbm5lckV4Y2VwdGlvbiAkXy5FeGNlcHRpb24KICAgICAgICB9CiAgICB9Cn0KCjwjCiAgICAuU1lOT1BTSVMKICAgIFRoaXMgZnVuY3Rpb24gdGVzdHMgdGhlIHZhbHVlIG9mIHRoZSBtaW4gYW5kIG1heCBtZW1vcnkgc2VydmVyIGNvbmZpZ3VyYXRpb24gb3B0aW9uLgoKICAgIC5QQVJBTUVURVIgU1FMU2VydmVyCiAgICBUaGUgaG9zdCBuYW1lIG9mIHRoZSBTUUwgU2VydmVyIHRvIGJlIGNvbmZpZ3VyZWQuCgogICAgLlBBUkFNRVRFUiBTUUxJbnN0YW5jZU5hbWUKICAgIFRoZSBuYW1lIG9mIHRoZSBTUUwgaW5zdGFuY2UgdG8gYmUgY29uZmlndXJlZC4KICAgIAogICAgLlBBUkFNRVRFUiBFbnN1cmUKICAgIFdoZW4gc2V0IHRvICdQcmVzZW50JyB0aGVuIG1pbiBhbmQgbWF4IG1lbW9yeSB3aWxsIGJlIHNldCB0byBlaXRoZXIgdGhlIHZhbHVlIGluIHBhcmFtZXRlciBNaW5NZW1vcnkgYW5kIE1heE1lbW9yeSBvciBkeW5hbWljYWxseSBjb25maWd1cmVkIHdoZW4gcGFyYW1ldGVyIER5bmFtaWNBbGxvYyBpcyBzZXQgdG8gJHRydWUuCiAgICBXaGVuIHNldCB0byAnQWJzZW50JyBtaW4gYW5kIG1heCBtZW1vcnkgd2lsbCBiZSBzZXQgdG8gZGVmYXVsdCB2YWx1ZXMuCgogICAgLlBBUkFNRVRFUiBEeW5hbWljQWxsb2MKICAgIElmIHNldCB0byAkdHJ1ZSB0aGVuIG1heCBtZW1vcnkgd2lsbCBiZSBkeW5hbWljYWxseSBjb25maWd1cmVkLgogICAgV2hlbiB0aGlzIGlzIHNldCBwYXJhbWV0ZXIgaXMgc2V0IHRvICR0cnVlLCB0aGUgcGFyYW1ldGVyIE1heE1lbW9yeSBtdXN0IGJlIHNldCB0byAkbnVsbCBvciBub3QgYmUgY29uZmlndXJlZC4KCiAgICAuUEFSQU1FVEVSIE1pbk1lbW9yeQogICAgVGhpcyBpcyB0aGUgbWluaW11bSBhbW91bnQgb2YgbWVtb3J5LCBpbiBNQiwgaW4gdGhlIGJ1ZmZlciBwb29sIHVzZWQgYnkgdGhlIGluc3RhbmNlIG9mIFNRTCBTZXJ2ZXIuCgogICAgLlBBUkFNRVRFUiBNYXhNZW1vcnkKICAgIFRoaXMgaXMgdGhlIG1heGltdW0gYW1vdW50IG9mIG1lbW9yeSwgaW4gTUIsIGluIHRoZSBidWZmZXIgcG9vbCB1c2VkIGJ5IHRoZSBpbnN0YW5jZSBvZiBTUUwgU2VydmVyLgojPgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMU2VydmVyID0gJGVudjpDT01QVVRFUk5BTUUsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gJ1ByZXNlbnQnLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N5c3RlbS5Cb29sZWFuXQogICAgICAgICREeW5hbWljQWxsb2MgPSAkZmFsc2UsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3lzdGVtLkludDMyXQogICAgICAgICRNaW5NZW1vcnksCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3lzdGVtLkludDMyXQogICAgICAgICRNYXhNZW1vcnkKICAgICkKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICdUZXN0aW5nIHRoZSB2YWx1ZXMgb2YgdGhlIG1pbmltdW0gYW5kIG1heGltdW0gbWVtb3J5IHNlcnZlciBjb25maWd1cmF0aW9uIG9wdGlvbiBzZXQgdG8gYmUgdXNlZCBieSB0aGUgaW5zdGFuY2UuJyAgCgogICAgJGdldFRhcmdldFJlc291cmNlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgU1FMSW5zdGFuY2VOYW1lID0gJFBTQm91bmRQYXJhbWV0ZXJzLlNRTEluc3RhbmNlTmFtZQogICAgICAgIFNRTFNlcnZlciAgICAgICA9ICRQU0JvdW5kUGFyYW1ldGVycy5TUUxTZXJ2ZXIKICAgIH0KCiAgICAkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQGdldFRhcmdldFJlc291cmNlUGFyYW1ldGVycwogICAgCiAgICAkY3VycmVudE1pbk1lbW9yeSA9ICRnZXRUYXJnZXRSZXNvdXJjZVJlc3VsdC5NaW5NZW1vcnkKICAgICRjdXJyZW50TWF4TWVtb3J5ID0gJGdldFRhcmdldFJlc291cmNlUmVzdWx0Lk1heE1lbW9yeQogICAgJGlzU2VydmVyTWVtb3J5SW5EZXNpcmVkU3RhdGUgPSAkdHJ1ZQoKICAgIHN3aXRjaCAoJEVuc3VyZSkKICAgIHsKICAgICAgICAnQWJzZW50JwogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRjdXJyZW50TWF4TWVtb3J5IC1uZSAyMTQ3NDgzNjQ3KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBOZXctVmVyYm9zZU1lc3NhZ2UgLU1lc3NhZ2UgIkN1cnJlbnQgbWF4aW11bSBzZXJ2ZXIgbWVtb3J5IHVzZWQgYnkgdGhlIGluc3RhbmNlIGlzICQoJGN1cnJlbnRNYXhNZW1vcnkpTUIuIEV4cGVjdGVkIDIxNDc0ODM2NDdNQi4iCiAgICAgICAgICAgICAgICAkaXNTZXJ2ZXJNZW1vcnlJbkRlc2lyZWRTdGF0ZSA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJGN1cnJlbnRNaW5NZW1vcnkgLW5lIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIE5ldy1WZXJib3NlTWVzc2FnZSAtTWVzc2FnZSAiQ3VycmVudCBtaW5pbXVtIHNlcnZlciBtZW1vcnkgdXNlZCBieSB0aGUgaW5zdGFuY2UgaXMgJCgkY3VycmVudE1pbk1lbW9yeSlNQi4gRXhwZWN0ZWQgME1CLiIKICAgICAgICAgICAgICAgICRpc1NlcnZlck1lbW9yeUluRGVzaXJlZFN0YXRlID0gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICdQcmVzZW50JwogICAgICAgIHsKICAgICAgICAgICAgaWYgKCREeW5hbWljQWxsb2MpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkTWF4TWVtb3J5KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRocm93IE5ldy1UZXJtaW5hdGluZ0Vycm9yIC1FcnJvclR5cGUgTWF4TWVtb3J5UGFyYW1NdXN0QmVOdWxsIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRm9ybWF0QXJncyBAKCAkU1FMU2VydmVyLCRTUUxJbnN0YW5jZU5hbWUgKSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUVycm9yQ2F0ZWdvcnkgSW52YWxpZEFyZ3VtZW50ICAKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkTWF4TWVtb3J5ID0gR2V0LVNxbERzY0R5bmFtaWNNYXhNZW1vcnkKICAgICAgICAgICAgICAgIE5ldy1WZXJib3NlTWVzc2FnZSAtTWVzc2FnZSAiRHluYW1pYyBtYXhpbXVtIG1lbW9yeSBoYXMgYmVlbiBjYWxjdWxhdGVkIHRvICQoJE1heE1lbW9yeSlNQi4iCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoLW5vdCAkTWF4TWVtb3J5KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRocm93IE5ldy1UZXJtaW5hdGluZ0Vycm9yIC1FcnJvclR5cGUgTWF4TWVtb3J5UGFyYW1NdXN0Tm90QmVOdWxsIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRm9ybWF0QXJncyBAKCAkU1FMU2VydmVyLCRTUUxJbnN0YW5jZU5hbWUgKSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUVycm9yQ2F0ZWdvcnkgSW52YWxpZEFyZ3VtZW50ICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRNYXhNZW1vcnkgLW5lICRjdXJyZW50TWF4TWVtb3J5KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBOZXctVmVyYm9zZU1lc3NhZ2UgLU1lc3NhZ2UgKCJDdXJyZW50IG1heGltdW0gc2VydmVyIG1lbW9yeSB1c2VkIGJ5IHRoZSBpbnN0YW5jZSAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaXMgJCgkY3VycmVudE1heE1lbW9yeSlNQi4gRXhwZWN0ZWQgJCgkTWF4TWVtb3J5KU1CLiIpCiAgICAgICAgICAgICAgICAkaXNTZXJ2ZXJNZW1vcnlJbkRlc2lyZWRTdGF0ZSA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJE1pbk1lbW9yeSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICBpZiAoJE1pbk1lbW9yeSAtbmUgJGN1cnJlbnRNaW5NZW1vcnkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTmV3LVZlcmJvc2VNZXNzYWdlIC1NZXNzYWdlICgiQ3VycmVudCBtaW5pbXVtIHNlcnZlciBtZW1vcnkgdXNlZCBieSB0aGUgaW5zdGFuY2UgIiArIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpcyAkKCRjdXJyZW50TWluTWVtb3J5KU1CLiBFeHBlY3RlZCAkKCRNaW5NZW1vcnkpTUIuIikKICAgICAgICAgICAgICAgICAgICAkaXNTZXJ2ZXJNZW1vcnlJbkRlc2lyZWRTdGF0ZSA9ICRmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkaXNTZXJ2ZXJNZW1vcnlJbkRlc2lyZWRTdGF0ZQp9Cgo8IwogICAgLlNZTk9QU0lTCiAgICBUaGlzIGNtZGxldCBpcyB1c2VkIHRvIHJldHVybiB0aGUgRHluYW1pYyBNYXhNZW1vcnkgb2YgYSBTUUwgSW5zdGFuY2UKIz4KZnVuY3Rpb24gR2V0LVNxbERzY0R5bmFtaWNNYXhNZW1vcnkKewogICAgdHJ5CiAgICB7CiAgICAgICAgJHBoeXNpY2FsTWVtb3J5ID0gKChHZXQtQ2ltSW5zdGFuY2UgLUNsYXNzTmFtZSBXaW4zMl9QaHlzaWNhbE1lbW9yeSkuQ2FwYWNpdHkgfCBNZWFzdXJlLU9iamVjdCAtU3VtKS5TdW0KICAgICAgICAkcGh5c2ljYWxNZW1vcnlJbk1lZ2FCeXRlcyA9IFtNYXRoXTo6Um91bmQoJHBoeXNpY2FsTWVtb3J5IC8gMU1CKQogICAgICAgIAogICAgICAgICMgRmluZCBob3cgbXVjaCB0byBzYXZlIGZvciBPUzogMjAlIG9mIHRvdGFsIHJhbSBmb3IgdW5kZXIgMTVHQiAvIDEyLjUlIGZvciBvdmVyIDIwR0IKICAgICAgICBpZiAoJHBoeXNpY2FsTWVtb3J5SW5NZWdhQnl0ZXMgLWdlIDIwNDgwKQogICAgICAgIHsKICAgICAgICAgICAgJHJlc2VydmVkT3BlcmF0aW5nU3lzdGVtTWVtb3J5ID0gW01hdGhdOjpSb3VuZCgoMC4xMjUgKiAkcGh5c2ljYWxNZW1vcnlJbk1lZ2FCeXRlcykpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRyZXNlcnZlZE9wZXJhdGluZ1N5c3RlbU1lbW9yeSA9IFtNYXRoXTo6Um91bmQoKDAuMiAqICRwaHlzaWNhbE1lbW9yeUluTWVnYUJ5dGVzKSkKICAgICAgICB9CgogICAgICAgICRudW1iZXJPZkNvcmVzID0gKEdldC1DaW1JbnN0YW5jZSAtQ2xhc3NOYW1lIFdpbjMyX1Byb2Nlc3NvciB8IE1lYXN1cmUtT2JqZWN0IC1Qcm9wZXJ0eSBOdW1iZXJPZkNvcmVzIC1TdW0pLlN1bQoKICAgICAgICAjIEdldCB0aGUgbnVtYmVyIG9mIFNRTCB0aHJlYWRzLgogICAgICAgIGlmICgkbnVtYmVyT2ZDb3JlcyAtZ2UgNCkKICAgICAgICB7CiAgICAgICAgICAgICRudW1iZXJPZlNxbFRocmVhZHMgPSAyNTYgKyAoJG51bWJlck9mQ29yZXMgLSA0KSAqIDgKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJG51bWJlck9mU3FsVGhyZWFkcyA9IDAKICAgICAgICB9CgogICAgICAgICRvcGVyYXRpbmdTeXN0ZW1BcmNoaXRlY3R1cmUgPSAoR2V0LUNpbUluc3RhbmNlIC1DbGFzc05hbWUgV2luMzJfb3BlcmF0aW5nc3lzdGVtKS5PU0FyY2hpdGVjdHVyZQogICAgICAgIAogICAgICAgICMgRmluZCB0aHJlYWRTdGFja1NpemUgMU1CIHg4Ni8gMk1CIHg2NC8gNE1CIElBNjQKICAgICAgICBpZiAoJG9wZXJhdGluZ1N5c3RlbUFyY2hpdGVjdHVyZSAtZXEgJzMyLWJpdCcpCiAgICAgICAgewogICAgICAgICAgICAkdGhyZWFkU3RhY2tTaXplID0gMQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRvcGVyYXRpbmdTeXN0ZW1BcmNoaXRlY3R1cmUgLWVxICc2NC1iaXQnKQogICAgICAgIHsKICAgICAgICAgICAgJHRocmVhZFN0YWNrU2l6ZSA9IDIKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJHRocmVhZFN0YWNrU2l6ZSA9IDQKICAgICAgICB9CgogICAgICAgICRtYXhNZW1vcnkgPSAkcGh5c2ljYWxNZW1vcnlJbk1lZ2FCeXRlcyAtICRyZXNlcnZlZE9wZXJhdGluZ1N5c3RlbU1lbW9yeSAtICgkbnVtYmVyT2ZTcWxUaHJlYWRzICogJHRocmVhZFN0YWNrU2l6ZSkgLSAoMTAyNCAqIFtTeXN0ZW0uTWF0aF06OkNlaWxpbmcoJG51bWJlck9mQ29yZXMgLyA0KSkKICAgIH0KICAgIGNhdGNoCiAgICB7CiAgICAgICAgdGhyb3cgTmV3LVRlcm1pbmF0aW5nRXJyb3IgLUVycm9yVHlwZSBFcnJvckdldER5bmFtaWNNYXhNZW1vcnkgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1FcnJvckNhdGVnb3J5IEludmFsaWRPcGVyYXRpb24gYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Jbm5lckV4Y2VwdGlvbiAkXy5FeGNlcHRpb24KICAgIH0KCiAgICAkbWF4TWVtb3J5Cn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UK
