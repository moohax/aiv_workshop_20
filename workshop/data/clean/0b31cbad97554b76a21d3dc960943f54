DM_SaveRestore.ps1,b103c8fdeb6183f35a5082bf260eac92,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgRE1fU2F2ZVJlc3RvcmUucHMxIAojCiMgRGVzY3JpcHRpb246CiMgICAgIFZlcmlmIGEgVk0gdGhhdCBoYXMgaGFkIGl0cyBBc3NpZ25lZCBNZW1vcnkgbW9kaWZpZWQgY2FuCiMgICAgIGJlIHNhdmVkIGFuZCByZXN0b3JlZC4KIwojICAgICBUaGUgSUNBIHNjcmlwdHMgd2lsbCBhbHdheXMgcGFzcyB0aGUgdm1OYW1lLCBodlNlcnZlciwgYW5kIGEKIyAgICAgc3RyaW5nIG9mIHRlc3RQYXJhbXMgdG8gdGhlIFBvd2VyU2hlbGwgdGVzdCBjYXNlIHNjcmlwdC4gRm9yCiMgICAgIGV4YW1wbGUsIGlmIHRoZSA8dGVzdFBhcmFtcz4gc2VjdGlvbiB3YXMgd3JpdHRlbiBhczoKIwojICAgICAgICAgPHRlc3RQYXJhbXM+CiMgICAgICAgICAgICAgPHBhcmFtPlZNMU5hbWU9U3VTRS1ETS1WTTE8L3BhcmFtPgojICAgICAgICAgICAgIDxwYXJhbT5WTTJOYW1lPVN1U0UtRE0tVk0yPC9wYXJhbT4KIyAgICAgICAgIDwvdGVzdFBhcmFtcz4KIwojICAgICBUaGUgc3RyaW5nIHBhc3NlZCBpbiB0aGUgdGVzdFBhcmFtcyB2YXJpYWJsZSB0byB0aGUgUG93ZXJTaGVsbAojICAgICB0ZXN0IGNhc2Ugc2NyaXB0IHNjcmlwdCB3b3VsZCBiZToKIwojICAgICAgICAgIlZNMU5hbWU9U3VTRS1ETS1WTTE7Vk0yTmFtZT1TdVNFLURNLVZNMiIKIwojICAgICBUaGVzIFBvd2VyU2hlbGwgdGVzdCBjYXNlIGNyaXB0cyBuZWVkIHRvIHBhcnNlIHRoZSB0ZXN0UGFyYW0KIyAgICAgc3RyaW5nIHRvIGZpbmQgYW55IHBhcmFtZXRlcnMgaXQgbmVlZHMuCiMKIyAgICAgQWxsIHNldHVwIGFuZCBjbGVhbnVwIHNjcmlwdHMgbXVzdCByZXR1cm4gYSBib29sZWFuICgkVHJ1ZSBvciAkRmFsc2UpCiMgICAgIHRvIGluZGljYXRlIGlmIHRoZSBzY3JpcHQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSBvciBub3QuCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpwYXJhbShbc3RyaW5nXSAkdm1OYW1lLCBbc3RyaW5nXSAkaHZTZXJ2ZXIsIFtzdHJpbmddICR0ZXN0UGFyYW1zKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBHZXRJUHY0VmlhS1ZQKCkKIwojIERlc2NyaXB0aW9uOgojCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZnVuY3Rpb24gR2V0SVB2NFZpYUtWUCggW1N0cmluZ10gJHZtLCBbU3RyaW5nXSAkc2VydmVyKQp7CgogICAgJHZtT2JqID0gR2V0LVdtaU9iamVjdCAtTmFtZXNwYWNlIHJvb3RcdmlydHVhbGl6YXRpb24gLVF1ZXJ5ICJTZWxlY3QgKiBGcm9tIE1zdm1fQ29tcHV0ZXJTeXN0ZW0gV2hlcmUgRWxlbWVudE5hbWU9YCckdm1gJyIgLUNvbXB1dGVyTmFtZSAkc2VydmVyCiAgICBpZiAoLW5vdCAkdm1PYmopCiAgICB7CiAgICAgICAgcmV0dXJuICRudWxsCiAgICB9CgogICAgJGt2cCA9IEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSByb290XHZpcnR1YWxpemF0aW9uIC1RdWVyeSAiQXNzb2NpYXRvcnMgb2YgeyR2bU9ian0gV2hlcmUgQXNzb2NDbGFzcz1Nc3ZtX1N5c3RlbURldmljZSBSZXN1bHRDbGFzcz1Nc3ZtX0t2cEV4Y2hhbmdlQ29tcG9uZW50IiAtQ29tcHV0ZXJOYW1lICRTZXJ2ZXIKICAgIGlmICgtbm90ICRrdnApCiAgICB7CiAgICAgICAgcmV0dXJuICRudWxsCiAgICB9CgogICAgJHJhd0RhdGEgPSAkS3ZwLkd1ZXN0SW50cmluc2ljRXhjaGFuZ2VJdGVtcwogICAgaWYgKC1ub3QgJHJhd0RhdGEpCiAgICB7CiAgICAgICAgcmV0dXJuICRudWxsCiAgICB9CgogICAgJG5hbWUgPSAkbnVsbAogICAgJGFkZHJlc3NlcyA9ICRudWxsCgogICAgZm9yZWFjaCAoJGRhdGFJdGVtIGluICRyYXdEYXRhKQogICAgewogICAgICAgICRmb3VuZCA9IDAKICAgICAgICAkeG1sRGF0YSA9IFtYbWxdICRkYXRhSXRlbQogICAgICAgIGZvcmVhY2ggKCRwIGluICR4bWxEYXRhLklOU1RBTkNFLlBST1BFUlRZKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKCRwLk5hbWUgLWVxICJOYW1lIiAtYW5kICRwLlZhbHVlIC1lcSAiTmV0d29ya0FkZHJlc3NJUHY0IikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGZvdW5kICs9IDEKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRwLk5hbWUgLWVxICJEYXRhIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGFkZHJlc3NlcyA9ICRwLlZhbHVlCiAgICAgICAgICAgICAgICAkZm91bmQgKz0gMQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJGZvdW5kIC1lcSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkYWRkcnMgPSAkYWRkcmVzc2VzLlNwbGl0KCI7IikKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRhZGRyIGluICRhZGRycykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAoJGFkZHIuU3RhcnRzV2l0aCgiMTI3LiIpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgQ29udGludWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRhZGRyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuICRudWxsCn0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCiMgV2FpdFRvRW50ZXJWTVN0YXRlKCkKIwojIERlc2NyaXB0aW9uOgojICAgICBXYWl0IHVwIHRvIDIgbWludXRlcyBmb3IgYSBWTSB0byBlbnRlciBhIHNwZWNpZmljIHN0YXRlCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZnVuY3Rpb24gV2FpdFRvRW50ZXJWTVN0YXRlKFtTdHJpbmddICRuYW1lLCBbU3RyaW5nXSAkc2VydmVyLCBbU3RyaW5nXSAkc3RhdGUpCnsKICAgICRpc0luU3RhdGUgPSAkRmFsc2UKCiAgICAkY291bnQgPSAxMgoKICAgIHdoaWxlICgkY291bnQgLWd0IDApCiAgICB7CiAgICAgICAgJHZtID0gR2V0LVZNIC1OYW1lICRuYW1lIC1Db21wdXRlck5hbWUgJHNlcnZlcgogICAgICAgIGlmICgtbm90ICR2bSkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAkRmFsc2UKICAgICAgICB9CgogICAgICAgIGlmICgkdm0uU3RhdGUgLWVxICRzdGF0ZSkKICAgICAgICB7CiAgICAgICAgICAgICRpc0luU3RhdGUgPSAkVHJ1ZQogICAgICAgICAgICBicmVhawogICAgICAgIH0KCiAgICAgICAgU3RhcnQtU2xlZXAgLXMgMTAKICAgIH0KCiAgICByZXR1cm4gJGlzSW5TdGF0ZQp9CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIEdldElQdjRWaWFLVlAoKQojCiMgRGVzY3JpcHRpb246CiMKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpmdW5jdGlvbiBHZXRJUHY0VmlhS1ZQKCBbU3RyaW5nXSAkdm0sIFtTdHJpbmddICRzZXJ2ZXIpCnsKCiAgICAkdm1PYmogPSBHZXQtV21pT2JqZWN0IC1OYW1lc3BhY2Ugcm9vdFx2aXJ0dWFsaXphdGlvbiAtUXVlcnkgIlNlbGVjdCAqIEZyb20gTXN2bV9Db21wdXRlclN5c3RlbSBXaGVyZSBFbGVtZW50TmFtZT1gJyR2bWAnIiAtQ29tcHV0ZXJOYW1lICRzZXJ2ZXIKICAgIGlmICgtbm90ICR2bU9iaikKICAgIHsKICAgICAgICByZXR1cm4gJG51bGwKICAgIH0KCiAgICAka3ZwID0gR2V0LVdtaU9iamVjdCAtTmFtZXNwYWNlIHJvb3RcdmlydHVhbGl6YXRpb24gLVF1ZXJ5ICJBc3NvY2lhdG9ycyBvZiB7JHZtT2JqfSBXaGVyZSBBc3NvY0NsYXNzPU1zdm1fU3lzdGVtRGV2aWNlIFJlc3VsdENsYXNzPU1zdm1fS3ZwRXhjaGFuZ2VDb21wb25lbnQiIC1Db21wdXRlck5hbWUgJFNlcnZlcgogICAgaWYgKC1ub3QgJGt2cCkKICAgIHsKICAgICAgICByZXR1cm4gJG51bGwKICAgIH0KCiAgICAkcmF3RGF0YSA9ICRLdnAuR3Vlc3RJbnRyaW5zaWNFeGNoYW5nZUl0ZW1zCiAgICBpZiAoLW5vdCAkcmF3RGF0YSkKICAgIHsKICAgICAgICByZXR1cm4gJG51bGwKICAgIH0KCiAgICAkbmFtZSA9ICRudWxsCiAgICAkYWRkcmVzc2VzID0gJG51bGwKCiAgICBmb3JlYWNoICgkZGF0YUl0ZW0gaW4gJHJhd0RhdGEpCiAgICB7CiAgICAgICAgJGZvdW5kID0gMAogICAgICAgICR4bWxEYXRhID0gW1htbF0gJGRhdGFJdGVtCiAgICAgICAgZm9yZWFjaCAoJHAgaW4gJHhtbERhdGEuSU5TVEFOQ0UuUFJPUEVSVFkpCiAgICAgICAgewogICAgICAgICAgICBpZiAoJHAuTmFtZSAtZXEgIk5hbWUiIC1hbmQgJHAuVmFsdWUgLWVxICJOZXR3b3JrQWRkcmVzc0lQdjQiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkZm91bmQgKz0gMQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJHAuTmFtZSAtZXEgIkRhdGEiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkYWRkcmVzc2VzID0gJHAuVmFsdWUKICAgICAgICAgICAgICAgICRmb3VuZCArPSAxCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkZm91bmQgLWVxIDIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRhZGRycyA9ICRhZGRyZXNzZXMuU3BsaXQoIjsiKQogICAgICAgICAgICAgICAgZm9yZWFjaCAoJGFkZHIgaW4gJGFkZHJzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICgkYWRkci5TdGFydHNXaXRoKCIxMjcuIikpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBDb250aW51ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGFkZHIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJG51bGwKfQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBXYWlGb3JWTVRvU3RhcnRLVlAoKQojCiMgRGVzY3JpcHRpb246CiMgICAgVXNlIEtWUCB0byBnZXQgYSBWTXMgSVAgYWRkcmVzcy4gIE9uY2UgdGhlIGFkZHJlc3MgaXMgcmV0dXJuZWQsCiMgICAgY29uc2lkZXIgdGhlIFZNIHVwLgojCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmZ1bmN0aW9uIFdhaXRGb3JWTVRvU3RhcnRLVlAoW1N0cmluZ10gJHZtTmFtZSwgW1N0cmluZ10gJGh2U2VydmVyLCBbaW50XSAkdGltZW91dCkKewogICAgJGlwdjQgPSAkbnVsbAogICAgJHJldFZhbCA9ICRGYWxzZQoKICAgICR3YWl0VGltZU91dCA9ICR0aW1lb3V0CiAgICB3aGlsZSAoJHdhaXRUaW1lT3V0IC1ndCAwKQogICAgewogICAgICAgICRpcHY0ID0gR2V0SVB2NFZpYUtWUCAkdm1OYW1lICRodlNlcnZlcgogICAgICAgIGlmICgkaXB2NCkKICAgICAgICB7CiAgICAgICAgICAgICRyZXRWYWwgPSAkVHJ1ZQogICAgICAgICAgICBicmVhawogICAgICAgIH0KCiAgICAgICAgJHdhaXRUaW1lT3V0IC09IDEwCiAgICAgICAgU3RhcnQtU2xlZXAgLXMgMTAKICAgIH0KCiAgICByZXR1cm4gJHJldFZhbAp9CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIE1haW4gc2NyaXB0IGJvZHkKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKJHJldFZhbCA9ICRmYWxzZQoKIwojIENoZWNrIGlucHV0IGFyZ3VtZW50cwojCmlmICgkdm1OYW1lIC1lcSAkbnVsbCkKewogICAgIkVycm9yOiBWTSBuYW1lIGlzIG51bGwiCiAgICByZXR1cm4gJHJldFZhbAp9CgppZiAoJGh2U2VydmVyIC1lcSAkbnVsbCkKewogICAgIkVycm9yOiBodlNlcnZlciBpcyBudWxsIgogICAgcmV0dXJuICRyZXRWYWwKfQoKJGlwdjQgPSAkbnVsbAokc3NoS2V5ID0gJG51bGwKJHZtMk5hbWUgPSAkbnVsbAokdm0yaXB2NCA9ICRudWxsCgojCiMgRGlzcGxheSB0aGUgdGVzdCBwYXJhbXMgaW4gdGhlIGxvZwojCiJUZXN0IHBhcmFtcyA9ICR0ZXN0UGFyYW1zIgoKJHBhcmFtcyA9ICR0ZXN0UGFyYW1zLlNwbGl0KCI7IikKZm9yZWFjaCAoJHAgaW4gJHBhcmFtcykKewogICAgJGZpZWxkcyA9ICRwLlNwbGl0KCI9IikKICAgIAogICAgc3dpdGNoICgkZmllbGRzWzBdLlRyaW0oKSkKICAgIHsKICAgICJ2bTJOYW1lIiB7ICR2bTJOYW1lID0gJGZpZWxkc1sxXS5UcmltKCkgfQogICAgInNzaEtleSIgIHsgJHNzaEtleSAgPSAkZmllbGRzWzFdLlRyaW0oKSB9CiAgICAiaXB2NCIgICAgeyAkaXB2NCAgICA9ICRmaWVsZHNbMV0uVHJpbSgpIH0KCSJyb290ZGlyIiB7ICRyb290RGlyID0gJGZpZWxkc1sxXS5UcmltKCkgfQogICAgZGVmYXVsdCAge30gICAgICAgCiAgICB9Cn0KCmlmICgkbnVsbCAtZXEgJHZtMk5hbWUpCnsKICAgICJFcnJvcjogVGVzdCBwYXJhbWV0ZXIgdm0yTmFtZSB3YXMgbm90IHNwZWNpZmllZCIKICAgIHJldHVybiAkRmFsc2UKfQoKaWYgKCRudWxsIC1lcSAkc3NoS2V5KQp7CiAgICAiRXJyb3I6IFRlc3QgcGFyYW1ldGVyIHNzaEtleSB3YXMgbm90IHNwZWNpZmllZCIKICAgIHJldHVybiAkRmFsc2UKfQoKaWYgKCRudWxsIC1lcSAkaXB2NCkKewogICAgIkVycm9yOiBUZXN0IHBhcmFtZXRlciBpcHY0IHdhcyBub3Qgc3BlY2lmaWVkIgogICAgcmV0dXJuICRGYWxzZQp9Cgokdm0xTmFtZSA9ICR2bU5hbWUKCiMKIyBJbmNsdWRlIHNvbWUgaW5mbyBpbiB0aGUgbG9ncyIKIwoiSW5mbyA6IHZtMU5hbWUgPSAke3ZtMU5hbWV9IgoiSW5mbyA6IHZtMk5hbWUgPSAke3ZtMk5hbWV9IgoiSW5mbyA6IGlwdjQgICAgPSAke2lwdjR9IgoiSW5mbyA6IHNzaEtleSAgPSAke3NzaEtleX0iCgojCiMgQ2hhbmdlIHRoZSB3b3JraW5nIGRpcmVjdG9yeSB0byB3aGVyZSB3ZSBuZWVkIHRvIGJlCiMKaWYgKC1ub3QgKFRlc3QtUGF0aCAkcm9vdERpcikpCnsKICAgICJFcnJvcjogVGhlIGRpcmVjdG9yeSBgIiR7cm9vdERpcn1gIiBkb2VzIG5vdCBleGlzdCIKICAgIHJldHVybiAkRmFsc2UKfQoKY2QgJHJvb3REaXIKCiMKIyBWZXJpZnkgYm90aCBWTXMgZXhpc3QKIwokdm0xID0gR2V0LVZNIC1OYW1lICR2bTFOYW1lIC1Db21wdXRlck5hbWUgJGh2U2VydmVyIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCmlmICgtbm90ICR2bTEpCnsKICAgICJFcnJvcjogVk0gJHt2bTFOYW1lfSBkb2VzIG5vdCBleGlzdCIKICAgIHJldHVybiAkRmFsc2UKfQoKJHZtMiA9IEdldC1WTSAtTmFtZSAkdm0yTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlciAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQppZiAoLW5vdCAkdm0yKQp7CiAgICAiRXJyb3I6IFZNICR7dm0yTmFtZX0gZG9lcyBub3QgZXhpc3QiCiAgICByZXR1cm4gJEZhbHNlCn0KCiMKIyBDb2xsZWN0IFZNMSBzdGF0cyBiZWZvcmUgc3RhcnRpbmcgVk0yCiMKJHZtMSA9IEdldC1WTSAtTmFtZSAkdm0xTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlciAKJGJlZm9yZU1lbW9yeSA9ICR2bTEuTWVtb3J5QXNzaWduZWQKCiMKIyBMZXQgdGhlIERNIHN5c3RlbSBzZXR0bGUgb3V0CiMKU3RhcnQtU2xlZXAgLXMgNDUKClN0YXJ0LVZNIC1OYW1lICR2bTJOYW1lIC1Db21wdXRlck5hbWUgJGh2U2VydmVyIAppZiAoLW5vdCAoV2FpdEZvclZNVG9TdGFydEtWUCAkdm0yTmFtZSAkaHZTZXJ2ZXIgMzAwKSkKewogICAgIkVycm9yOiAke3ZtMk5hbWV9IGZhaWxlZCB0byBzdGFydCIKICAgIHJldHVybiAkRmFsc2UKfQoKJHZtMmlwdjQgPSBHZXRJUHY0VmlhS1ZQICR2bTJOYW1lICRodlNlcnZlcgppZiAoLW5vdCAkdm0yaXB2NCkKewogICAgIkVycm9yOiBVbmFibGUgdG8gZ2V0IGlwdjQgdmlhIEtWUCBmb3IgVk0gJHt2bTJOYW1lfSIKICAgIFN0b3AtVk0gLU5hbWUgJHZtMk5hbWUgLUZvcmNlIC1UdXJuT2ZmCiAgICByZXR1cm4gJEZhbHNlCn0KCiMKIyBDb2xsZWN0IG1ldHJpY3MgZm9yIFZNMSBhZ2FpbiBub3cgdGhhdCBWTTIgaXMgdXAgYW5kIHJ1bm5pbmcKIyBhbmQgY29tcHV0ZSB0aGUgZGlmZmVyZW5jZSBpbiBhc3NpZ25lZCBtZW1vcnkKIwokdm0xID0gR2V0LVZNIC1OYW1lICR2bTFOYW1lIC1Db21wdXRlck5hbWUgJGh2U2VydmVyIAokYWZ0ZXJNZW1vcnkgPSAkdm0xLk1lbW9yeUFzc2lnbmVkCiRzdGFydHVwTWVtb3J5ID0gJHZtMS5NZW1vcnlTdGFydHVwCgokbWVtRGVsdGEgPSAkYWZ0ZXJNZW1vcnkgLSAkYmVmb3JlTWVtb3J5CiJJbmZvIDogQmVmb3JlIG1lbW9yeSA6ICR7YmVmb3JlTWVtb3J5fSIKIkluZm8gOiBBZnRlciBtZW1vcnkgIDogJHthZnRlck1lbW9yeX0iCiJJbmZvIDogJHt2bTFOYW1lfSBBc3NpZ25lZCBNZW1vcnkgY2hhbmdlIGJ5ICR7bWVtRGVsdGF9IGJ5dGVzIgoiSW5mbyA6IFN0YXJ0dXAgbWVtb3J5OiAke3N0YXJ0dXBNZW1vcnl9IgoKIwojIElmIHRoZSBhc3NpZ25lbWQgbWVtb3J5IGZvciBWTTEgd2FzIG1vZGlmaWVkLCB0cnkgdGhlIGFjdHVhbAojIGEgc2F2ZSBhbmQgcmVzdG9yZS4KIwokcmVzdWx0cyA9ICJGYWlsZWQiCiRyZXRWYWwgPSAkRmFsc2UKaWYgKCRtZW1EZWx0YSAtbmUgMCAtb3IgJGFmdGVyTWVtb3J5IC1sdCAkc3RhcnR1cE1lbW9yeSkKewogICAgU2F2ZS1WbSAtTmFtZSAkdm0xTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlcgogICAgaWYgKC1ub3QgKFdhaXRUb0VudGVyVk1TdGF0ZSAkdm0xTmFtZSAkaHZTZXJ2ZXIgIlNBVkVEIikpCiAgICB7CiAgICAgICAgIkVycm9yOiBVbmFibGUgdG8gU2F2ZSBWTSAke3ZtMU5hbWV9IgogICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KCiAgICBTdGFydC1WTSAtTmFtZSAkdm0xTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlcgogICAgaWYgKC1ub3QgKFdhaXRGb3JWTVRvU3RhcnRLVlAgJHZtMU5hbWUgJGh2U2VydmVyIDMwMCkpCiAgICB7CiAgICAgICAgIkVycm9yOiAke3ZtMU5hbWV9IGZhaWxlZCB0byByZXN1bWUiCiAgICAgICAgcmV0dXJuICRGYWxzZQogICAgfQoKICAgICRobiA9IC5cYmluXHBsaW5rLmV4ZSAtaSAuXHNzaFwkc3NoS2V5IHJvb3RAJHtpcHY0fSBob3N0bmFtZQogICAgaWYgKCRudWxsIC1uZSAkaG4pCiAgICB7CiAgICAgICAgJHJlc3VsdHMgPSAiUGFzc2VkIgogICAgICAgICRyZXRWYWwgPSAkVHJ1ZQogICAgfQp9CmVsc2UKewogICAgIkVycm9yOiBBc3NpZ25lZCBNZW1vcnkgaGFzIG5vdCBiZWVuIG1vZGlmaWVkIgp9CgojCiMgU3RvcCB2bTIgc2luY2UgSUNBIGRvZXMgbm90IGtub3cgYWJvdXQgaXQuCiMKLlxiaW5ccGxpbmsuZXhlIC1pIHNzaFwke3NzaEtleX0gcm9vdEAke3ZtMmlwdjR9ICJpbml0IDAiCmlmICgtbm90ICQ/KQp7CiAgICAiRXJyb3I6IFVuYWJsZSB0byBzZW5kICdpbml0IDAnIHRvIFZNICR7dm0yTmFtZX0iCiAgICByZXR1cm4gJEZhbHNlCn0KCiMKIyBXYWl0IGZvciB2bTIgdG8gZ28gdG8gYSBzdG9wcGVkIHN0YXRlCiMKJHRpbWVvdXQgPSAxMjAKd2hpbGUgKCR0aW1lb3V0IC1ndCAwKQp7CiAgICAkdm0gPSBHZXQtVk0gLU5hbWUgJHZtMk5hbWUgLUNvbXB1dGVyTmFtZSAkaHZTZXJ2ZXIKICAgIGlmICgkdm0uU3RhdGUgLWVxICJPZmYiKQogICAgewogICAgICAgIGJyZWFrOwogICAgfQogICAgJHRpbWVvdXQgLT0gNQogICAgU3RhcnQtU2xlZXAgLXMgNQp9CgppZiAoJHRpbWVvdXQgLWxlIDApCnsKICAgIFN0b3AtVk0gLU5hbWUgJHZtMk5hbWUgLUNvbXB1dGVyTmFtZSAkaHZTZXJ2ZXIgLVR1cm5PZmYgLUZvcmNlCn0KCiMKIwojCiJJbmZvIDogVGVzdCAke3Jlc3VsdHN9IgoKcmV0dXJuICRyZXRWYWwKCg==
