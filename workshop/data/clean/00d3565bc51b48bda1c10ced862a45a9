Connect-ActiveDirectory.ps1,85a7f7ec7553076d044a8852740e7610,Scan result is 1. IsMalware: 0,w6/Cu8K/ZnVuY3Rpb24gQ29ubmVjdC1BY3RpdmVEaXJlY3Rvcnkgewo8IwouRVhBTVBMRQokY3JlZCA9IEdldC1DcmVkZW50aWFsCiRhID0gQ29ubmVjdC1BY3RpdmVEaXJlY3RvcnkgLUFEQ29udGV4dFR5cGU6RGlyZWN0b3J5RW50cnkgLUNyZWRzICRjcmVkIC1Db21wdXRlck5hbWUgMTAuMTAuMTAuMTAKJGEuUGF0aCA9ICdMREFQOi8vMTAuMTAuMTAuMTAvUm9vdERTRScKJGEubmFtaW5nQ29udGV4dHMKCkRlc2NyaXB0aW9uCi0tLS0tLS0tLS0tClVzaW5nIGFsdGVybmF0ZSBjcmVkZW50aWFscyBjb25uZWN0IHRvIDEwLjEwLjEwLjEwIHRoZW4gYnJvd3NlIHRvIHRoZSBSb290RFNFIGFuZCB1c2UgaXQgdG8gbGlzdCBhbGwgdGhlIGF2YWlsYWJsZSBBRCBwYXJ0aXRpb25zCgouRVhBTVBMRQokY3JlZCA9IEdldC1DcmVkZW50aWFsCiRhID0gQ29ubmVjdC1BY3RpdmVEaXJlY3RvcnkgLUFEQ29udGV4dFR5cGU6RGlyZWN0b3J5RW50cnkgLUNyZWRzICRjcmVkIC1Db21wdXRlck5hbWUgMTAuMTAuMTAuMTAKJGEuUGF0aCA9ICdMREFQOi8vMTAuMTAuMTAuMTAvUm9vdERTRScKJERvbWFpbnMgPSBDb25uZWN0LUFjdGl2ZURpcmVjdG9yeSAtQURDb250ZXh0VHlwZTpEb21haW4gLUNyZWRzICRjcmVkIC1Db21wdXRlciAxMC4xMC4xMC4xMAokRENzID0gJERvbWFpbnMuRG9tYWluQ29udHJvbGxlcnMKRm9yRWFjaCgkcGFydGl0aW9uIGluICgkYS5uYW1pbmdDb250ZXh0cykpIHsKICAgIFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvcjpNYWdlbnRhICJQYXJ0aXRpb246ICQoJHBhcnRpdGlvbikiCiAgICBGb3JlYWNoICgkREMgaW4gJERDcykgewogICAgICAgICRkb21haW5Db250cm9sbGVyTWV0YWRhdGEgPSAkREMuR2V0UmVwbGljYXRpb25NZXRhZGF0YSgkcGFydGl0aW9uKQogICAgICAgICRkc2FTaWduYXR1cmUgPSAkZG9tYWluQ29udHJvbGxlck1ldGFkYXRhLkl0ZW0oImRzYVNpZ25hdHVyZSIpIAogICAgICAgIFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvcjpEYXJrTWFnZW50YSAiICAgIFNlcnZlciA9ICQoJERDKSAtLS0gQmFja2VkIHVwICQoJGRzYVNpZ25hdHVyZS5MYXN0T3JpZ2luYXRpbmdDaGFuZ2VUaW1lLkRhdGVUaW1lKWBuIgogICAgfQp9CgpEZXNjcmlwdGlvbgotLS0tLS0tLS0tLQpVc2luZyBhbHRlcm5hdGUgY3JlZGVudGlhbHMgY29ubmVjdCB0byAxMC4xMC4xMC4xMCB0aGVuIGVudW1lcmF0ZSB0aGUgcGFydGl0aW9ucyBpbiB0aGUgZG9tYWluIGFzIHdlbGwgYXMgdGhlIERDcy4gVGhlbiBnZW5lcmF0ZSBhIHJlcG9ydCBvZiB0aGUgbGFzdCBiYWNrdXAKdGltZSBiZWluZyByZXBvcnRlZCBvbiBlYWNoIERDIGZvciBlYWNoIHBhcnRpdGlvbi4KIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSdDcmVkZW50aWFsJyldCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSdDcmVkZW50aWFsT2JqZWN0JyldCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSdEZWZhdWx0JyldCiAgICAgICAgW3N0cmluZ10kQ29tcHV0ZXJOYW1lLAogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZT0nQ3JlZGVudGlhbCcpXQogICAgICAgIFtzdHJpbmddJERvbWFpbk5hbWUsCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSdDcmVkZW50aWFsJywgTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRVc2VyTmFtZSwKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWU9J0NyZWRlbnRpYWwnLCBIZWxwTWVzc2FnZT0nUGFzc3dvcmQgZm9yIFVzZXJuYW1lIGluIHJlbW90ZSBkb21haW4uJywgTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRQYXNzd29yZCwKICAgICAgICBbcGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWU9J0NyZWRlbnRpYWxPYmplY3QnLEhlbHBNZXNzYWdlPSdGdWxsIGNyZWRlbnRpYWwgb2JqZWN0JyxNYW5kYXRvcnk9JFRydWUpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0kQ3JlZHMsCiAgICAgICAgW1BhcmFtZXRlcihIZWxwTWVzc2FnZT0nQ29udGV4dCB0byByZXR1cm4sIGZvcmVzdCwgZG9tYWluLCBvciBEaXJlY3RvcnlFbnRyeS4nKV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ0RvbWFpbicsJ0ZvcmVzdCcsJ0RpcmVjdG9yeUVudHJ5JywnQURDb250ZXh0JyldCiAgICAgICAgW3N0cmluZ10kQURDb250ZXh0VHlwZSA9ICdBRENvbnRleHQnCiAgICApCiAgICAKICAgICRVc2luZ0FsdENyZWQgPSAkZmFsc2UKICAgIAogICAgIyBJZiB0aGUgdXNlcm5hbWUgd2FzIHBhc3NlZCBpbiBkb21haW5cPHVzZXJuYW1lPiBvciB1c2VybmFtZUBkb21haW4gdGhlbiBnYW5rIHRoZSBkb21haW4gbmFtZSBmb3IgbGF0ZXIgdXNlCiAgICBpZiAoKCRVc2VyTmFtZSAtc3BsaXQgIlxcIikuQ291bnQgLWd0IDEpIHsKICAgICAgICAkRG9tYWluTmFtZSA9ICgkVXNlck5hbWUgLXNwbGl0ICJcXCIpWzBdCiAgICAgICAgJFVzZXJOYW1lID0gKCRVc2VyTmFtZSAtc3BsaXQgIlxcIilbMV0KICAgIH0KICAgIGlmICgoJFVzZXJOYW1lIC1zcGxpdCAiXEAiKS5Db3VudCAtZ3QgMSkgewogICAgICAgICREb21haW5OYW1lID0gKCRVc2VyTmFtZSAtc3BsaXQgIlxAIilbMV0KICAgICAgICAkVXNlck5hbWUgPSAoJFVzZXJOYW1lIC1zcGxpdCAiXEAiKVswXQogICAgfQogICAgCiAgICBzd2l0Y2ggKCRQU0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lKSB7CiAgICAgICAgJ0NyZWRlbnRpYWxPYmplY3QnIHsKICAgICAgICAgICAgaWYgKCRDcmVkcy5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLkRvbWFpbiAtbmUgJycpICB7CiAgICAgICAgICAgICAgICAkVXNlck5hbWU9ICRDcmVkcy5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlVzZXJOYW1lCiAgICAgICAgICAgICAgICAkUGFzc3dvcmQgPSAkQ3JlZHMuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZAogICAgICAgICAgICAgICAgJERvbWFpbk5hbWUgPSAkQ3JlZHMuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5Eb21haW4KICAgICAgICAgICAgICAgICRVc2luZ0FsdENyZWQgPSAkdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3cgJ1RoZSBjcmVkZW50aWFsIG9iamVjdCBtdXN0IGluY2x1ZGUgYSBkZWZpbmVkIGRvbWFpbi4nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJ0NyZWRlbnRpYWwnIHsKICAgICAgICAgICAgaWYgKC1ub3QgJERvbWFpbk5hbWUpIHsKICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICdVc2VybmFtZSBtdXN0IGJlIGluIEBkb21haW5uYW1lLmNvbSBvciA8ZG9tYWlubmFtZT5cPHVzZXJuYW1lPiBmb3JtYXQgb3IgdGhlIGRvbWFpbiBuYW1lIG11c3QgYmUgbWFudWFsbHkgcGFzc2VkIGluIHRoZSBEb21haW5OYW1lIHBhcmFtZXRlcicKICAgICAgICAgICAgICAgIHJldHVybiAkbnVsbAogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJFVzZXJOYW1lID0gJERvbWFpbk5hbWUgKyAnXCcgKyAkVXNlck5hbWUKICAgICAgICAgICAgICAgICRVc2luZ0FsdENyZWQgPSAkdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgICRBRFNlcnZlciA9ICcnCiAgICAKICAgICMgSWYgYSBjb21wdXRlciBuYW1lIHdhcyBzcGVjaWZpZWQgdGhlbiB3ZSB3aWxsIGF0dGVtcHQgdG8gcGVyZm9ybSBhIHJlbW90ZSBjb25uZWN0aW9uCiAgICBpZiAoJENvbXB1dGVyTmFtZSkgewogICAgICAgICMgSWYgYSBjb21wdXRlcm5hbWUgd2FzIHNwZWNpZmllZCB0aGVuIHdlIGFyZSBjb25uZWN0aW5nIHJlbW90ZWx5CiAgICAgICAgJEFEU2VydmVyID0gIkxEQVA6Ly8kKCRDb21wdXRlck5hbWUpIgogICAgICAgICRDb250ZXh0VHlwZSA9IFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRpcmVjdG9yeUNvbnRleHRUeXBlXTo6RGlyZWN0b3J5U2VydmVyCgogICAgICAgIGlmICgkVXNpbmdBbHRDcmVkKSB7CiAgICAgICAgICAgICRBRENvbnRleHQgPSBOZXctT2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRGlyZWN0b3J5Q29udGV4dCAkQ29udGV4dFR5cGUsICRDb21wdXRlck5hbWUsICRVc2VyTmFtZSwgJFBhc3N3b3JkCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiAoJENvbXB1dGVyTmFtZSkgewogICAgICAgICAgICAgICAgJEFEQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0ICRDb250ZXh0VHlwZSwgJENvbXB1dGVyTmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJEFEQ29udGV4dCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0ICRDb250ZXh0VHlwZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN3aXRjaCAoJEFEQ29udGV4dFR5cGUpIHsKICAgICAgICAgICAgICAgICdBRENvbnRleHQnIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJEFEQ29udGV4dAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJ0RpcmVjdG9yeUVudHJ5JyB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRVc2luZ0FsdENyZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeUVudHJ5KCRBRFNlcnZlciAsJFVzZXJOYW1lLCAkUGFzc3dvcmQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeUVudHJ5ICRBRFNlcnZlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICdGb3Jlc3QnIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRm9yZXN0XTo6R2V0Rm9yZXN0KCRBRENvbnRleHQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAnRG9tYWluJyB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRvbWFpbl06OkdldERvbWFpbigkQURDb250ZXh0KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgdGhyb3cKICAgICAgICB9CiAgICB9CiAgICAKICAgICMgSWYgdXNpbmcganVzdCBhbiBhbHRlcm5hdGUgY3JlZGVudGlhbCB3aXRob3V0IHNwZWNpZnlpbmcgYSByZW1vdGUgY29tcHV0ZXIgKGRjKSB0byBjb25uZWN0IHRoZXkKICAgICMgdHJ5IGNvbm5lY3RpbmcgdG8gdGhlIGxvY2FsbHkgam9pbmVkIGRvbWFpbiB3aXRoIHRoZSBjcmVkZW50aWFscy4KICAgIGlmICgkVXNpbmdBbHRDcmVkKSB7CiAgICAgICAgIyAqKiogRklOSVNIIE1FICoqKgogICAgfQogICAgIyBXZSBoYXZlIG5vdCBzcGVjaWZpZWQgYW5vdGhlciBjb21wdXRlciBvciBjcmVkZW50aWFsIHNvIGNvbm5lY3QgdG8gdGhlIGxvY2FsIGRvbWFpbiBpZiBwb3NzaWJsZS4KICAgIHRyeSB7CiAgICAgICAgJENvbnRleHRUeXBlID0gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRGlyZWN0b3J5Q29udGV4dFR5cGVdOjpEb21haW4KICAgIH0KICAgIGNhdGNoIHsKICAgICAgICB0aHJvdyAnVW5hYmxlIHRvIGNvbm5lY3QgdG8gYSBkZWZhdWx0IGRvbWFpbi4gSXMgdGhpcyBhIGRvbWFpbiBqb2luZWQgYWNjb3VudD8nCiAgICB9CiAgICB0cnkgewogICAgICAgIHN3aXRjaCAoJEFEQ29udGV4dFR5cGUpIHsKICAgICAgICAgICAgJ0FEQ29udGV4dCcgewogICAgICAgICAgICAgICAgcmV0dXJuIE5ldy1PYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjdGl2ZURpcmVjdG9yeS5EaXJlY3RvcnlDb250ZXh0ICRDb250ZXh0VHlwZQogICAgICAgICAgICB9CiAgICAgICAgICAgICdEaXJlY3RvcnlFbnRyeScgewogICAgICAgICAgICAgICAgcmV0dXJuIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuRGlyZWN0b3J5RW50cnldJycKICAgICAgICAgICAgfQogICAgICAgICAgICAnRm9yZXN0JyB7CiAgICAgICAgICAgICAgICByZXR1cm4gW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY3RpdmVEaXJlY3RvcnkuRm9yZXN0XTo6R2V0Q3VycmVudEZvcmVzdCgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJ0RvbWFpbicgewogICAgICAgICAgICAgICAgcmV0dXJuIFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWN0aXZlRGlyZWN0b3J5LkRvbWFpbl06OkdldEN1cnJlbnREb21haW4oKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggewogICAgICAgIHRocm93CiAgICB9Cn0K
