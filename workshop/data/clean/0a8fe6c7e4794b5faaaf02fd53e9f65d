Deploy-AzureResourceGroup.ps1,5b923d31f5409037ddbb60ef15bedc91,Scan result is 1. IsMalware: 0,I1JlcXVpcmVzIC1WZXJzaW9uIDMuMAojUmVxdWlyZXMgLU1vZHVsZSBBenVyZVJNLlJlc291cmNlcwojUmVxdWlyZXMgLU1vZHVsZSBBenVyZS5TdG9yYWdlCgpQYXJhbSgKICAgIFtzdHJpbmddIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0gJFJlc291cmNlR3JvdXBMb2NhdGlvbiwKICAgIFtzdHJpbmddICRSZXNvdXJjZUdyb3VwTmFtZSA9ICdWQ1AtUkRTRkFSTS1WTS1Qcm92aXNpb25pbmcnLAogICAgW3N3aXRjaF0gJFVwbG9hZEFydGlmYWN0cywKICAgIFtzdHJpbmddICRTdG9yYWdlQWNjb3VudE5hbWUsCiAgICBbc3RyaW5nXSAkU3RvcmFnZUNvbnRhaW5lck5hbWUgPSAkUmVzb3VyY2VHcm91cE5hbWUuVG9Mb3dlckludmFyaWFudCgpICsgJy1zdGFnZWFydGlmYWN0cycsCiAgICBbc3RyaW5nXSAkVGVtcGxhdGVGaWxlID0gJ2F6dXJlZGVwbG95Lmpzb24nLAogICAgW3N0cmluZ10gJFRlbXBsYXRlUGFyYW1ldGVyc0ZpbGUgPSAnYXp1cmVkZXBsb3kucGFyYW1ldGVycy5qc29uJywKICAgIFtzdHJpbmddICRBcnRpZmFjdFN0YWdpbmdEaXJlY3RvcnkgPSAnLicsCiAgICBbc3RyaW5nXSAkRFNDU291cmNlRm9sZGVyID0gJ0RTQycsCiAgICBbc3dpdGNoXSAkVmFsaWRhdGVPbmx5CikKCnRyeSB7CiAgICBbTWljcm9zb2Z0LkF6dXJlLkNvbW1vbi5BdXRoZW50aWNhdGlvbi5BenVyZVNlc3Npb25dOjpDbGllbnRGYWN0b3J5LkFkZFVzZXJBZ2VudCgiVlNBenVyZVRvb2xzLSRVSSQoJGhvc3QubmFtZSkiLnJlcGxhY2UoJyAnLCdfJyksICcyLjkuNicpCn0gY2F0Y2ggeyB9CgokRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnClNldC1TdHJpY3RNb2RlIC1WZXJzaW9uIDMKCmZ1bmN0aW9uIEZvcm1hdC1WYWxpZGF0aW9uT3V0cHV0IHsKICAgIHBhcmFtICgkVmFsaWRhdGlvbk91dHB1dCwgW2ludF0gJERlcHRoID0gMCkKICAgIFNldC1TdHJpY3RNb2RlIC1PZmYKICAgIHJldHVybiBAKCRWYWxpZGF0aW9uT3V0cHV0IHwgV2hlcmUtT2JqZWN0IHsgJF8gLW5lICRudWxsIH0gfCBGb3JFYWNoLU9iamVjdCB7IEAoJyAgJyAqICREZXB0aCArICc6ICcgKyAkXy5NZXNzYWdlKSArIEAoRm9ybWF0LVZhbGlkYXRpb25PdXRwdXQgQCgkXy5EZXRhaWxzKSAoJERlcHRoICsgMSkpIH0pCn0KCiRPcHRpb25hbFBhcmFtZXRlcnMgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBIYXNodGFibGUKJFRlbXBsYXRlRmlsZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZ1bGxQYXRoKFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJFBTU2NyaXB0Um9vdCwgJFRlbXBsYXRlRmlsZSkpCiRUZW1wbGF0ZVBhcmFtZXRlcnNGaWxlID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RnVsbFBhdGgoW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkUFNTY3JpcHRSb290LCAkVGVtcGxhdGVQYXJhbWV0ZXJzRmlsZSkpCgppZiAoJFVwbG9hZEFydGlmYWN0cykgewogICAgIyBDb252ZXJ0IHJlbGF0aXZlIHBhdGhzIHRvIGFic29sdXRlIHBhdGhzIGlmIG5lZWRlZAogICAgJEFydGlmYWN0U3RhZ2luZ0RpcmVjdG9yeSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZ1bGxQYXRoKFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJFBTU2NyaXB0Um9vdCwgJEFydGlmYWN0U3RhZ2luZ0RpcmVjdG9yeSkpCiAgICAkRFNDU291cmNlRm9sZGVyID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RnVsbFBhdGgoW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkUFNTY3JpcHRSb290LCAkRFNDU291cmNlRm9sZGVyKSkKCiAgICAjIFBhcnNlIHRoZSBwYXJhbWV0ZXIgZmlsZSBhbmQgdXBkYXRlIHRoZSB2YWx1ZXMgb2YgYXJ0aWZhY3RzIGxvY2F0aW9uIGFuZCBhcnRpZmFjdHMgbG9jYXRpb24gU0FTIHRva2VuIGlmIHRoZXkgYXJlIHByZXNlbnQKICAgICRKc29uUGFyYW1ldGVycyA9IEdldC1Db250ZW50ICRUZW1wbGF0ZVBhcmFtZXRlcnNGaWxlIC1SYXcgfCBDb252ZXJ0RnJvbS1Kc29uCiAgICBpZiAoKCRKc29uUGFyYW1ldGVycyB8IEdldC1NZW1iZXIgLVR5cGUgTm90ZVByb3BlcnR5ICdwYXJhbWV0ZXJzJykgLW5lICRudWxsKSB7CiAgICAgICAgJEpzb25QYXJhbWV0ZXJzID0gJEpzb25QYXJhbWV0ZXJzLnBhcmFtZXRlcnMKICAgIH0KICAgICRBcnRpZmFjdHNMb2NhdGlvbk5hbWUgPSAnX2FydGlmYWN0c0xvY2F0aW9uJwogICAgJEFydGlmYWN0c0xvY2F0aW9uU2FzVG9rZW5OYW1lID0gJ19hcnRpZmFjdHNMb2NhdGlvblNhc1Rva2VuJwogICAgJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25OYW1lXSA9ICRKc29uUGFyYW1ldGVycyB8IFNlbGVjdCAtRXhwYW5kICRBcnRpZmFjdHNMb2NhdGlvbk5hbWUgLUVycm9yQWN0aW9uIElnbm9yZSB8IFNlbGVjdCAtRXhwYW5kICd2YWx1ZScgLUVycm9yQWN0aW9uIElnbm9yZQogICAgJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25TYXNUb2tlbk5hbWVdID0gJEpzb25QYXJhbWV0ZXJzIHwgU2VsZWN0IC1FeHBhbmQgJEFydGlmYWN0c0xvY2F0aW9uU2FzVG9rZW5OYW1lIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBTZWxlY3QgLUV4cGFuZCAndmFsdWUnIC1FcnJvckFjdGlvbiBJZ25vcmUKCiAgICAjIENyZWF0ZSBEU0MgY29uZmlndXJhdGlvbiBhcmNoaXZlCiAgICBpZiAoVGVzdC1QYXRoICREU0NTb3VyY2VGb2xkZXIpIHsKICAgICAgICAkRFNDU291cmNlRmlsZVBhdGhzID0gQChHZXQtQ2hpbGRJdGVtICREU0NTb3VyY2VGb2xkZXIgLUZpbGUgLUZpbHRlciAnKi5wczEnIHwgRm9yRWFjaC1PYmplY3QgLVByb2Nlc3MgeyRfLkZ1bGxOYW1lfSkKICAgICAgICBmb3JlYWNoICgkRFNDU291cmNlRmlsZVBhdGggaW4gJERTQ1NvdXJjZUZpbGVQYXRocykgewogICAgICAgICAgICAkRFNDQXJjaGl2ZUZpbGVQYXRoID0gJERTQ1NvdXJjZUZpbGVQYXRoLlN1YnN0cmluZygwLCAkRFNDU291cmNlRmlsZVBhdGguTGVuZ3RoIC0gNCkgKyAnLnppcCcKICAgICAgICAgICAgUHVibGlzaC1BenVyZVJtVk1Ec2NDb25maWd1cmF0aW9uICREU0NTb3VyY2VGaWxlUGF0aCAtT3V0cHV0QXJjaGl2ZVBhdGggJERTQ0FyY2hpdmVGaWxlUGF0aCAtRm9yY2UgLVZlcmJvc2UKICAgICAgICB9CiAgICB9CgogICAgIyBDcmVhdGUgYSBzdG9yYWdlIGFjY291bnQgbmFtZSBpZiBub25lIHdhcyBwcm92aWRlZAogICAgaWYgKCRTdG9yYWdlQWNjb3VudE5hbWUgLWVxICcnKSB7CiAgICAgICAgJFN0b3JhZ2VBY2NvdW50TmFtZSA9ICdzdGFnZScgKyAoKEdldC1BenVyZVJtQ29udGV4dCkuU3Vic2NyaXB0aW9uLlN1YnNjcmlwdGlvbklkKS5SZXBsYWNlKCctJywgJycpLnN1YnN0cmluZygwLCAxOSkKICAgIH0KCiAgICAkU3RvcmFnZUFjY291bnQgPSAoR2V0LUF6dXJlUm1TdG9yYWdlQWNjb3VudCB8IFdoZXJlLU9iamVjdHskXy5TdG9yYWdlQWNjb3VudE5hbWUgLWVxICRTdG9yYWdlQWNjb3VudE5hbWV9KQoKICAgICMgQ3JlYXRlIHRoZSBzdG9yYWdlIGFjY291bnQgaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0CiAgICBpZiAoJFN0b3JhZ2VBY2NvdW50IC1lcSAkbnVsbCkgewogICAgICAgICRTdG9yYWdlUmVzb3VyY2VHcm91cE5hbWUgPSAnQVJNX0RlcGxveV9TdGFnaW5nJwogICAgICAgIE5ldy1BenVyZVJtUmVzb3VyY2VHcm91cCAtTG9jYXRpb24gIiRSZXNvdXJjZUdyb3VwTG9jYXRpb24iIC1OYW1lICRTdG9yYWdlUmVzb3VyY2VHcm91cE5hbWUgLUZvcmNlCiAgICAgICAgJFN0b3JhZ2VBY2NvdW50ID0gTmV3LUF6dXJlUm1TdG9yYWdlQWNjb3VudCAtU3RvcmFnZUFjY291bnROYW1lICRTdG9yYWdlQWNjb3VudE5hbWUgLVR5cGUgJ1N0YW5kYXJkX0xSUycgLVJlc291cmNlR3JvdXBOYW1lICRTdG9yYWdlUmVzb3VyY2VHcm91cE5hbWUgLUxvY2F0aW9uICIkUmVzb3VyY2VHcm91cExvY2F0aW9uIgogICAgfQoKICAgICMgR2VuZXJhdGUgdGhlIHZhbHVlIGZvciBhcnRpZmFjdHMgbG9jYXRpb24gaWYgaXQgaXMgbm90IHByb3ZpZGVkIGluIHRoZSBwYXJhbWV0ZXIgZmlsZQogICAgaWYgKCRPcHRpb25hbFBhcmFtZXRlcnNbJEFydGlmYWN0c0xvY2F0aW9uTmFtZV0gLWVxICRudWxsKSB7CiAgICAgICAgJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25OYW1lXSA9ICRTdG9yYWdlQWNjb3VudC5Db250ZXh0LkJsb2JFbmRQb2ludCArICRTdG9yYWdlQ29udGFpbmVyTmFtZQogICAgfQoKICAgICMgQ29weSBmaWxlcyBmcm9tIHRoZSBsb2NhbCBzdG9yYWdlIHN0YWdpbmcgbG9jYXRpb24gdG8gdGhlIHN0b3JhZ2UgYWNjb3VudCBjb250YWluZXIKICAgIE5ldy1BenVyZVN0b3JhZ2VDb250YWluZXIgLU5hbWUgJFN0b3JhZ2VDb250YWluZXJOYW1lIC1Db250ZXh0ICRTdG9yYWdlQWNjb3VudC5Db250ZXh0IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlICo+JjEKCiAgICAkQXJ0aWZhY3RGaWxlUGF0aHMgPSBHZXQtQ2hpbGRJdGVtICRBcnRpZmFjdFN0YWdpbmdEaXJlY3RvcnkgLVJlY3Vyc2UgLUZpbGUgfCBGb3JFYWNoLU9iamVjdCAtUHJvY2VzcyB7JF8uRnVsbE5hbWV9CiAgICBmb3JlYWNoICgkU291cmNlUGF0aCBpbiAkQXJ0aWZhY3RGaWxlUGF0aHMpIHsKICAgICAgICBTZXQtQXp1cmVTdG9yYWdlQmxvYkNvbnRlbnQgLUZpbGUgJFNvdXJjZVBhdGggLUJsb2IgJFNvdXJjZVBhdGguU3Vic3RyaW5nKCRBcnRpZmFjdFN0YWdpbmdEaXJlY3RvcnkubGVuZ3RoICsgMSkgYAogICAgICAgICAgICAtQ29udGFpbmVyICRTdG9yYWdlQ29udGFpbmVyTmFtZSAtQ29udGV4dCAkU3RvcmFnZUFjY291bnQuQ29udGV4dCAtRm9yY2UKICAgIH0KCiAgICAjIEdlbmVyYXRlIGEgNCBob3VyIFNBUyB0b2tlbiBmb3IgdGhlIGFydGlmYWN0cyBsb2NhdGlvbiBpZiBvbmUgd2FzIG5vdCBwcm92aWRlZCBpbiB0aGUgcGFyYW1ldGVycyBmaWxlCiAgICBpZiAoJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25TYXNUb2tlbk5hbWVdIC1lcSAkbnVsbCkgewogICAgICAgICRPcHRpb25hbFBhcmFtZXRlcnNbJEFydGlmYWN0c0xvY2F0aW9uU2FzVG9rZW5OYW1lXSA9IENvbnZlcnRUby1TZWN1cmVTdHJpbmcgLUFzUGxhaW5UZXh0IC1Gb3JjZSBgCiAgICAgICAgICAgIChOZXctQXp1cmVTdG9yYWdlQ29udGFpbmVyU0FTVG9rZW4gLUNvbnRhaW5lciAkU3RvcmFnZUNvbnRhaW5lck5hbWUgLUNvbnRleHQgJFN0b3JhZ2VBY2NvdW50LkNvbnRleHQgLVBlcm1pc3Npb24gciAtRXhwaXJ5VGltZSAoR2V0LURhdGUpLkFkZEhvdXJzKDQpKQogICAgfQp9CgojIENyZWF0ZSBvciB1cGRhdGUgdGhlIHJlc291cmNlIGdyb3VwIHVzaW5nIHRoZSBzcGVjaWZpZWQgdGVtcGxhdGUgZmlsZSBhbmQgdGVtcGxhdGUgcGFyYW1ldGVycyBmaWxlCk5ldy1BenVyZVJtUmVzb3VyY2VHcm91cCAtTmFtZSAkUmVzb3VyY2VHcm91cE5hbWUgLUxvY2F0aW9uICRSZXNvdXJjZUdyb3VwTG9jYXRpb24gLVZlcmJvc2UgLUZvcmNlCgppZiAoJFZhbGlkYXRlT25seSkgewogICAgJEVycm9yTWVzc2FnZXMgPSBGb3JtYXQtVmFsaWRhdGlvbk91dHB1dCAoVGVzdC1BenVyZVJtUmVzb3VyY2VHcm91cERlcGxveW1lbnQgLVJlc291cmNlR3JvdXBOYW1lICRSZXNvdXJjZUdyb3VwTmFtZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVGVtcGxhdGVGaWxlICRUZW1wbGF0ZUZpbGUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVRlbXBsYXRlUGFyYW1ldGVyRmlsZSAkVGVtcGxhdGVQYXJhbWV0ZXJzRmlsZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAT3B0aW9uYWxQYXJhbWV0ZXJzKQogICAgaWYgKCRFcnJvck1lc3NhZ2VzKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICcnLCAnVmFsaWRhdGlvbiByZXR1cm5lZCB0aGUgZm9sbG93aW5nIGVycm9yczonLCBAKCRFcnJvck1lc3NhZ2VzKSwgJycsICdUZW1wbGF0ZSBpcyBpbnZhbGlkLicKICAgIH0KICAgIGVsc2UgewogICAgICAgIFdyaXRlLU91dHB1dCAnJywgJ1RlbXBsYXRlIGlzIHZhbGlkLicKICAgIH0KfQplbHNlIHsKICAgIE5ldy1BenVyZVJtUmVzb3VyY2VHcm91cERlcGxveW1lbnQgLU5hbWUgKChHZXQtQ2hpbGRJdGVtICRUZW1wbGF0ZUZpbGUpLkJhc2VOYW1lICsgJy0nICsgKChHZXQtRGF0ZSkuVG9Vbml2ZXJzYWxUaW1lKCkpLlRvU3RyaW5nKCdNTWRkLUhIbW0nKSkgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtUmVzb3VyY2VHcm91cE5hbWUgJFJlc291cmNlR3JvdXBOYW1lIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVRlbXBsYXRlRmlsZSAkVGVtcGxhdGVGaWxlIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVRlbXBsYXRlUGFyYW1ldGVyRmlsZSAkVGVtcGxhdGVQYXJhbWV0ZXJzRmlsZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBPcHRpb25hbFBhcmFtZXRlcnMgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRm9yY2UgLVZlcmJvc2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRXJyb3JWYXJpYWJsZSBFcnJvck1lc3NhZ2VzCiAgICBpZiAoJEVycm9yTWVzc2FnZXMpIHsKICAgICAgICBXcml0ZS1PdXRwdXQgJycsICdUZW1wbGF0ZSBkZXBsb3ltZW50IHJldHVybmVkIHRoZSBmb2xsb3dpbmcgZXJyb3JzOicsIEAoQCgkRXJyb3JNZXNzYWdlcykgfCBGb3JFYWNoLU9iamVjdCB7ICRfLkV4Y2VwdGlvbi5NZXNzYWdlLlRyaW1FbmQoImByYG4iKSB9KQogICAgfQp9
