VIAUtilityModule.psm1,1570f5dd47368ced13bff70c2007fc1f,Scan result is 1. IsMalware: 0,w6/Cu8K/PCMKLlN5bm9wc2lzCiAgIFZJQVV0aWxpdHkucHNtMQouREVTQ1JJUFRJT04KICAgVklBVXRpbGl0eS5wc20xCi5FWEFNUExFCiAgIEV4YW1wbGUgb2YgaG93IHRvIHVzZSB0aGlzIGNtZGxldAojPgpGdW5jdGlvbiBJbnZva2UtVklBRXhlCnsKICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2Vzcz0kdHJ1ZSldCgogICAgcGFyYW0oCiAgICAgICAgW3BhcmFtZXRlcihtYW5kYXRvcnk9JHRydWUscG9zaXRpb249MCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXQogICAgICAgICRFeGVjdXRhYmxlLAoKICAgICAgICBbcGFyYW1ldGVyKG1hbmRhdG9yeT0kdHJ1ZSxwb3NpdGlvbj0xKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddCiAgICAgICAgJEFyZ3VtZW50cywKCiAgICAgICAgW3BhcmFtZXRlcihtYW5kYXRvcnk9JGZhbHNlLHBvc2l0aW9uPTIpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW2ludF0KICAgICAgICAkU3VjY2Vzc2Z1bFJldHVybkNvZGUgPSAwCiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAiUnVubmluZyAkUmV0dXJuRnJvbUVYRSA9IFN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICRFeGVjdXRhYmxlIC1Bcmd1bWVudExpc3QgJEFyZ3VtZW50cyAtTm9OZXdXaW5kb3cgLVdhaXQgLVBhc3N0aHJ1IgogICAgJFJldHVybkZyb21FWEUgPSBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAkRXhlY3V0YWJsZSAtQXJndW1lbnRMaXN0ICRBcmd1bWVudHMgLU5vTmV3V2luZG93IC1XYWl0IC1QYXNzdGhydQoKICAgIFdyaXRlLVZlcmJvc2UgIlJldHVybmNvZGUgaXMgJCgkUmV0dXJuRnJvbUVYRS5FeGl0Q29kZSkiCgogICAgaWYoISgkUmV0dXJuRnJvbUVYRS5FeGl0Q29kZSAtZXEgJFN1Y2Nlc3NmdWxSZXR1cm5Db2RlKSkgewogICAgICAgIHRocm93ICIkRXhlY3V0YWJsZSBmYWlsZWQgd2l0aCBjb2RlICQoJFJldHVybkZyb21FWEUuRXhpdENvZGUpIgogICAgfQp9CkZ1bmN0aW9uIENvbnZlcnQtU3VibmV0CnsKICAgIDwjCiAgICAuU1lOT1BTSVMKICAgIENvbnZlcnRzIGJldHdlZW4gUHJlZml4TGVuZ3RoIGFuZCBzdWJuZXQgbWFzay4gCgoKICAgIC5ERVNDUklQVElPTgogICAgVGhpcyBzY3JpcHQgY29udmVydHMgYmV0d2VlbiBQcmVmaXhMZW5ndGggYW5kIHN1Ym5ldCBtYXNrIHBhcmFtZXRlcnMsIHRoZXNlIHBhcmFtZXRlcnMgZGVmaW5lIHRoZSBzaXplIG9mIGEgc3VibmV0IGZvciBJUHY0IGFkZHJlc3Nlcy4gIAogICAgVGhpcyBzY3JpcHQgYXNzdW1lcyB2YWxpZCBzdWJuZXQgbWFzayBpbnB1dCBhbmQgZG9lcyBub3Qgc3VwcG9ydCBzY2VuYXJpb3Mgc3VjaCBhcyBub24tY29udGlndW91cyBzdWJuZXQgbWFza3MuIAoKCiAgICAuSU5QVVRTCiAgICBOb25lCgogICAgLk9VVFBVVFMKICAgIFRoZSBzY3JpcHQgb3V0cHV0cyBhIFByZWZpeExlbmd0aCBpZiBTdWJuZXRNYXNrIHdhcyBlbnRlcmVkLCBvciBhIFN1Ym5ldE1hc2sgaWYgYSBQcmVmaXhMZW5ndGggd2FzIGVudGVyZWQuCgogICAgLk5PVEVTCiAgICBSZXF1aXJlcyBXaW5kb3dzIDggb3IgbGF0ZXIuCgogICAgIz4KCiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQoKICAgIFBhcmFtKCAKICAgICAgICBbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWU9IlN1Ym5ldE1hc2siLE1hbmRhdG9yeT0kVHJ1ZSldCiAgICAgICAgW3N0cmluZ10KICAgICAgICAkU3VibmV0TWFzaywgCiAgICAgICAgCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSJQcmVmaXhMZW5ndGgiLE1hbmRhdG9yeT0kVHJ1ZSldCiAgICAgICAgW2ludF0KICAgICAgICAkUHJlZml4TGVuZ3RoCiAgICApCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjVXNlciBwcm92aWRlZCBhIHByZWZpeAogICAgaWYgKCRQcmVmaXhMZW5ndGgpCiAgICB7CiAgICAgICAgJFByZWZpeExlbmd0aFJldHVybiA9ICRQcmVmaXhMZW5ndGgKICAgICAgICBpZiAoJFByZWZpeExlbmd0aCAtZ3QgMzIpIAogICAgICAgIHsgCiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkludmFsaWQgaW5wdXQsIHByZWZpeCBsZW5ndGggbXVzdCBiZSBsZXNzIHRoYW4gMzIiCiAgICAgICAgICAgIGV4aXQoMSkKICAgICAgICB9CiAgICAgICAgICAgICAgIAogICAgICAgICRiaXRBcnJheT0iIgogICAgICAgIGZvcigkYml0Q291bnQgPSAwOyAkUHJlZml4TGVuZ3RoIC1uZSAiMCI7ICRiaXRDb3VudCsrKSAKICAgICAgICB7CiAgICAgICAgICAgICRiaXRBcnJheSArPSAnMScKICAgICAgICAgICAgJFByZWZpeExlbmd0aCA9ICRQcmVmaXhMZW5ndGggLSAxOwogICAgICAgIH0KICAgIAogICAgICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgI0ZpbGwgaW4gdGhlIHJlc3Qgd2l0aCB6ZXJvZXMKICAgICAgICBXaGlsZSAoJGJpdENvdW50IC1uZSAzMikgCiAgICAgICAgewogICAgICAgICAgICAkYml0QXJyYXkgKz0gJzAnCiAgICAgICAgICAgICRiaXRDb3VudCsrIAogICAgICAgIH0KICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAjQ29udmVydCB0aGUgYml0IGFycmF5IGludG8gc3VibmV0IG1hc2sKICAgICAgICAkQ2xhc3NBQWRkcmVzcyA9ICRiaXRBcnJheS5TdWJTdHJpbmcoMCw4KQogICAgICAgICRDbGFzc0FBZGRyZXNzID0gW0NvbnZlcnRdOjpUb1VJbnQzMigkQ2xhc3NBQWRkcmVzcywgMikKICAgICAgICAkQ2xhc3NCQWRkcmVzcyA9ICRiaXRBcnJheS5TdWJTdHJpbmcoOCw4KQogICAgICAgICRDbGFzc0JBZGRyZXNzID0gW0NvbnZlcnRdOjpUb1VJbnQzMigkQ2xhc3NCQWRkcmVzcywgMikKICAgICAgICAkQ2xhc3NDQWRkcmVzcyA9ICRiaXRBcnJheS5TdWJTdHJpbmcoMTYsOCkKICAgICAgICAkQ2xhc3NDQWRkcmVzcyA9IFtDb252ZXJ0XTo6VG9VSW50MzIoJENsYXNzQ0FkZHJlc3MsIDIpCiAgICAgICAgJENsYXNzREFkZHJlc3MgPSAkYml0QXJyYXkuU3ViU3RyaW5nKDI0LDgpICAgICAgICAgICAKICAgICAgICAkQ2xhc3NEQWRkcmVzcyA9IFtDb252ZXJ0XTo6VG9VSW50MzIoJENsYXNzREFkZHJlc3MsIDIpCiAKICAgICAgICAkU3VibmV0TWFza1JldHVybiA9ICAiJENsYXNzQUFkZHJlc3MuJENsYXNzQkFkZHJlc3MuJENsYXNzQ0FkZHJlc3MuJENsYXNzREFkZHJlc3MiCiAgICB9CgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjI1VzZXIgcHJvdmlkZWQgYSBzdWJuZXQgbWFzawogICAgaWYgKCRTdWJuZXRNYXNrKQogICAgewoJICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgICAgICNFbnN1cmUgdmFsaWQgSVAgYWRkcmVzcyBpbnB1dC4gIE5vdGUgdGhpcyBkb2VzIG5vdCBjaGVjayBmb3Igbm9uLWNvbnRpZ3VvdXMgc3VibmV0IG1hc2tzIQogICAgICAgICRBZGRyZXNzPVtTeXN0ZW0uTmV0LklQYWRkcmVzc10iMC4wLjAuMCIKICAgICAgICBUcnkKICAgICAgICB7CiAgICAgICAgICAgICRJc1ZhbGlkSW5wdXQ9W1N5c3RlbS5OZXQuSVBhZGRyZXNzXTo6VHJ5UGFyc2UoJFN1Ym5ldE1hc2ssIFtyZWZdJEFkZHJlc3MpCiAgICAgICAgfQogICAgICAgIENhdGNoIAogICAgICAgIHsKCiAgICAgICAgfQogICAgICAgIEZpbmFsbHkKICAgICAgICB7CgogICAgICAgIH0gICAgCgogICAgICAgIGlmICgkSXNWYWxpZElucHV0IC1lcSAkRmFsc2UpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJJbnZhbGlkIElucHV0LiBQbGVhc2UgZW50ZXIgYSBwcm9wZXJseSBmb3JtYXR0ZWQgc3VibmV0IG1hc2suIgogICAgICAgICAgICBFeGl0KDEpCiAgICAgICAgfQoKICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAjQ29udmVydCBzdWJuZXQgbWFzayB0byBwcmVmaXggbGVuZ3RoCiAgICAgICAgSWYoJElzVmFsaWRJbnB1dCkKICAgICAgICB7CiAgICAgICAgICAgICRQcmVmaXhBcnJheT1AKCkKICAgICAgICAgICAgJFByZWZpeExlbmd0aCA9IDAKICAgICAgICAgICAgJEJ5dGVBcnJheSA9ICRTdWJuZXRNYXNrLlNwbGl0KCIuIikKICAgICAgICAKICAgICAgICAgICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjICAgICAgICAKICAgICAgICAgICAgI1RoaXMgbG9vcCBjb252ZXJ0cyB0aGUgYnl0ZXMgdG8gYml0cywgYWRkIHplcm9lcyB3aGVuIG5lY2Vzc2FyeQogICAgICAgICAgICBmb3IoJGJ5dGVDb3VudCA9IDA7ICRieXRlQ291bnQtbHQgNDsgJGJ5dGVDb3VudCsrKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGJpdFZhcmlhYmxlID0gJEJ5dGVBcnJheVskYnl0ZUNvdW50XQogICAgICAgICAgICAgICAgJGJpdFZhcmlhYmxlID0gW0NvbnZlcnRdOjpUb1N0cmluZygkYml0VmFyaWFibGUsIDIpCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoJGJpdFZhcmlhYmxlLkxlbmd0aCAtbHQgOCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgJE51bU9uZXM9JGJpdFZhcmlhYmxlLkxlbmd0aAogICAgICAgICAgICAgICAgICAkTnVtWmVyb2VzPTgtJGJpdFZhcmlhYmxlLkxlbmd0aAoKICAgICAgICAgICAgICAgICAgZm9yKCRiaXRDb3VudD0wOyAkYml0Q291bnQgLWx0ICROdW1aZXJvZXM7ICRiaXRDb3VudCsrKSAKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRUZW1wPSRUZW1wKyIwIgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICRiaXRWYXJpYWJsZT0kVGVtcCskYml0VmFyaWFibGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAgICAgICAgICNUaGlzIGxvb3AgY291bnRzIHRoZSBiaXRzIGluIHRoZSBwcmVmaXgKICAgICAgICAgICAgICAgIGZvcigkYml0Q291bnQ9MDsgJGJpdENvdW50IC1sdCA4OyAkYml0Q291bnQrKykgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRiaXRWYXJpYWJsZVskYml0Q291bnRdIC1lcSAiMSIpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJlZml4TGVuZ3RoKysgCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkUHJlZml4QXJyYXk9JFByZWZpeEFycmF5ICsgKCRiaXRWYXJpYWJsZVskYml0Q291bnRdKQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICAgICAgICAgI0NoZWNrIGlmIHRoZSBzdWJuZXQgbWFzayB3YXMgY29udGlndW91cywgZmFpbCBpZiBpdCB3YXNuJ3QuCiAgICAgICAgICAgICRNYXJrPSRGYWxzZQoKICAgICAgICAgICAgZm9yZWFjaCAoJGJpdCBpbiAkUHJlZml4QXJyYXkpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZigkYml0IC1lcSAiMCIpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoJE1hcmsgLWVxICRGYWxzZSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRNYXJrPSRUcnVlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoJGJpdCAtZXEgIjEiKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKCRNYXJrIC1lcSAkVHJ1ZSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkludmFsaWQgSW5wdXQuIFBsZWFzZSBlbnRlciBhIHByb3Blcmx5IGZvcm1hdHRlZCBzdWJuZXQgbWFzay4iCiAgICAgICAgICAgICAgICAgICAgICAgIEV4aXQoMSkKICAgICAgICAgICAgICAgICAgICB9ICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KCgkgICAgICAgICRTdWJuZXRNYXNrUmV0dXJuID0gJFN1Ym5ldE1hc2sKCSAgICAgICAgJFByZWZpeExlbmd0aFJldHVybiA9ICRQcmVmaXhMZW5ndGgKCSAgICB9CiAgICB9CiAgICAjI0NyZWF0ZSB0aGUgb2JqZWN0IHRvIGJlIHJldHVybmVkIHRvIHRoZSBjb25zb2xlCiAgICAkUmV0dXJuID0gbmV3LW9iamVjdCBPYmplY3QKICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRSZXR1cm4gLU5hbWUgUHJlZml4TGVuZ3RoIC1WYWx1ZSAkUHJlZml4TGVuZ3RoUmV0dXJuIC1UeXBlIE5vdGVQcm9wZXJ0eQogICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJFJldHVybiAtTmFtZSBTdWJuZXRNYXNrIC1WYWx1ZSAgJFN1Ym5ldE1hc2tSZXR1cm4gLVR5cGUgTm90ZVByb3BlcnR5CiAgICAkUmV0dXJuCn0KRnVuY3Rpb24gQ29tcHJlc3MtVklBRGVEdXBEcml2ZQp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQogICAgUGFyYW0oCiAgICAgICAgJERyaXZlTGV0dGVyCiAgICApCiAgICBGb3JlYWNoKCRJdGVtIGluICREcml2ZUxldHRlcil7CiAgICAgICAgJERyaXZlID0gJERyaXZlTGV0dGVyICsgIjoiCiAgICAgICAgU3RhcnQtRGVkdXBKb2IgJERyaXZlIC1UeXBlIE9wdGltaXphdGlvbiAtUHJpb3JpdHkgSGlnaCAtTWVtb3J5IDc1IC1XYWl0CiAgICAgICAgU3RhcnQtRGVkdXBKb2IgJERyaXZlIC1UeXBlIEdhcmJhZ2VDb2xsZWN0aW9uIC1Qcmlvcml0eSBIaWdoIC1NZW1vcnkgNzUgLVdhaXQKICAgICAgICBTdGFydC1EZWR1cEpvYiAkRHJpdmUgLVR5cGUgU2NydWJiaW5nIC1Qcmlvcml0eSBIaWdoIC1NZW1vcnkgNzUgLVdhaXQKICAgIH0KfQpGdW5jdGlvbiBFbmFibGUtVklBQ3JlZFNTUAp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSxWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlLFBvc2l0aW9uPTApXQogICAgICAgICRDb25uZWN0aW9uCiAgICApCgogICAgI0VuYWJsZSBDcmVkU1NQIG9uIENsaWVudAogICAgRW5hYmxlLVdTTWFuQ3JlZFNTUCAtUm9sZSBDbGllbnQgLURlbGVnYXRlQ29tcHV0ZXIgJENvbm5lY3Rpb24gLUZvcmNlIC1FcnJvckFjdGlvbiBTdG9wCiAgICBTZXQtSXRlbSBXU01hbjpcbG9jYWxob3N0XENsaWVudFxBbGxvd1VuZW5jcnlwdGVkIC1WYWx1ZSAkdHJ1ZSAtRm9yY2UKICAgIFNldC1JdGVtIFdTTWFuOlxsb2NhbGhvc3RcQ2xpZW50XFRydXN0ZWRIb3N0cyAtVmFsdWUgKiAtRm9yY2UgLUNvbmNhdGVuYXRlCn0KRnVuY3Rpb24gR2V0LVZJQU9TVmVyc2lvbgp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQogICAgUGFyYW0oCiAgICApCiAgICAkT1MgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0KICAgICRPU3ZlcnNpb24gPSBbU3lzdGVtLkVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24KICAgICRPU3ZlcnNpb25Db21wbGV0ZSA9ICIkKCR2ZXJzaW9uLm1ham9yKS4kKCR2ZXJzaW9uLk1pbm9yKS4kKCR2ZXJzaW9uLmJ1aWxkKSIKICAgICRPU3ZlcnNpb25NYWpvck1pbm9yID0gIiQoJHZlcnNpb24ubWFqb3IpLiQoJHZlcnNpb24uTWlub3IpIgogICAgJE9TdmVyc2lvbk1ham9yID0gIiQoJHZlcnNpb24ubWFqb3IpLiQoJHZlcnNpb24uTWlub3IpIgoKCiAgICBTd2l0Y2ggKCRPU3ZlcnNpb25NYWpvcikKICAgIHsKICAgICI2LjEiCiAgICB7CiAgICAgICAgSWYoJE9TLlByb2R1Y3RUeXBlIC1lcSAxKXskT1N2ID0gIlc3In1FbHNleyRPU3YgPSAiV1MyMDA4UjIifQogICAgfQogICAgIjYuMiIKICAgIHsKICAgICAgICBJZigkT1MuUHJvZHVjdFR5cGUgLWVxIDEpeyRPU3YgPSAiVzgifUVsc2V7JE9TdiA9ICJXUzIwMTIifQogICAgfQogICAgIjYuMyIKICAgIHsKICAgICAgICBJZigkT1MuUHJvZHVjdFR5cGUgLWVxIDEpeyRPU3YgPSAiVzgxIn1FbHNleyRPU3YgPSAiV1MyMDEyUjIifQogICAgfQogICAgIjEwLjAiCiAgICB7CiAgICAgICAgSWYoJE9TLlByb2R1Y3RUeXBlIC1lcSAxKXskT1N2ID0gIlcxMCJ9RWxzZXskT1N2ID0gIldTMjAxNiJ9CiAgICB9CiAgICAgICAgREVGQVVMVCB7JE9Tdj0iVW5rbm93biJ9CiAgICB9IAogICAgUmV0dXJuICRPU1YKfQpGdW5jdGlvbiBJbnN0YWxsLVZJQVNOTVAKewogICAgW0NtZGxldEJpbmRpbmcoU3VwcG9ydHNTaG91bGRQcm9jZXNzPSR0cnVlKV0KCiAgICBQYXJhbSgKICAgICAgICAgICAgJENvbXB1dGVyTmFtZQogICAgKQogICAgRm9yZWFjaCgkSXRlbSBpbiAkQ29tcHV0ZXJOYW1lKXsKICAgICAgICBJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICRJdGVtIC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgIEFkZC1XaW5kb3dzRmVhdHVyZSAtTmFtZSBTTk1QLVNlcnZpY2UgLUluY2x1ZGVBbGxTdWJGZWF0dXJlIC1JbmNsdWRlTWFuYWdlbWVudFRvb2xzCiAgICAgICAgfQogICAgfQp9CkZ1bmN0aW9uIEluc3RhbGwtVklBRENCCnsKICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2Vzcz0kdHJ1ZSldCgogICAgUGFyYW0oCiAgICAgICAgJENvbXB1dGVyTmFtZQogICAgKQogICAgRm9yZWFjaCgkSXRlbSBpbiAkQ29tcHV0ZXJOYW1lKXsKICAgICAgICBJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICRJdGVtIC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgIEFkZC1XaW5kb3dzRmVhdHVyZSAtTmFtZSBEYXRhLUNlbnRlci1CcmlkZ2luZyAtSW5jbHVkZUFsbFN1YkZlYXR1cmUgLUluY2x1ZGVNYW5hZ2VtZW50VG9vbHMKICAgICAgICB9CiAgICB9Cn0KRnVuY3Rpb24gUmVzdGFydC1WSUFDb21wdXRlcgp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQoKICAgIFBhcmFtKAogICAgICAgICRDb21wdXRlck5hbWUKICAgICkKICAgIEZvcmVhY2goJEl0ZW0gaW4gJENvbXB1dGVyTmFtZSl7CiAgICAgICAgUmVzdGFydC1Db21wdXRlciAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUZvcmNlIC1Bc0pvYgogICAgfQp9CkZ1bmN0aW9uIFNob3ctVklBVGV4dAp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQoKICAgIFBhcmFtKAogICAgICAgICRUZXh0LAogICAgICAgICRDb2xvcgogICAgKQogICAgCiAgICBXcml0ZS1Ib3N0ICRUZXh0IC1Gb3JlZ3JvdW5kQ29sb3IgJENvbG9yCn0KRnVuY3Rpb24gTmV3LVZJQVJhbmRvbVBhc3N3b3JkCnsKICAgIFtDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2Vzcz0kdHJ1ZSldCgogICAgUGFyYW0oCiAgICAgICAgW2ludF0kUGFzc3dvcmRMZW5ndGgsCiAgICAgICAgW2Jvb2xlYW5dJENvbXBsZXgKICAgICkKCiAgICAjQ2hhcmFjdGVycyB0byB1c2UgYmFzZWQKICAgICRzdHJTaW1wbGUgPSAiQSIsIkIiLCJDIiwiRCIsIkUiLCJGIiwiRyIsIkgiLCJKIiwiSyIsIkwiLCJNIiwiTiIsIlAiLCJRIiwiUiIsIlMiLCJUIiwiVSIsIlYiLCJXIiwiWCIsIlkiLCJaIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiMCIsImEiLCJiIiwiYyIsImQiLCJlIiwiZiIsImciLCJoIiwiaSIsImoiLCJrIiwibCIsIm0iLCJuIiwibyIsInAiLCJxIiwiciIsInMiLCJ0IiwidSIsInYiLCJ3IiwieCIsInkiLCJ6w6LigqwgCiAgICAkc3RyQ29tcGxleCA9ICJBIiwiQiIsIkMiLCJEIiwiRSIsIkYiLCJHIiwiSCIsIkoiLCJLIiwiTCIsIk0iLCJOIiwiUCIsIlEiLCJSIiwiUyIsIlQiLCJVIiwiViIsIlciLCJYIiwiWSIsIloiLCIxIiwiMiIsIjMiLCI0IiwiNSIsIjYiLCI3IiwiOCIsIjkiLCIwIiwiYSIsImIiLCJjIiwiZCIsImUiLCJmIiwiZyIsImgiLCJpIiwiaiIsImsiLCJsIiwibSIsIm4iLCJvIiwicCIsInEiLCJyIiwicyIsInQiLCJ1IiwidiIsInciLCJ4IiwieSIsInrDouKCrCwiISIsIl8iIAogICAgJHN0ck51bWJlcnMgPSAiMiIsIjMiLCI0IiwiNSIsIjYiLCI3IiwiOCIsIjkiLCIwIgogICAgIAogICAgI0NoZWNrIHRvIHNlZSBpZiBwYXNzd29yZCBjb250YWlucyBhdCBsZWFzdCAxIGRpZ2l0CiAgICAkYm9sSGFzTnVtYmVyID0gJGZhbHNlCiAgICAkcGFzcyA9ICRudWxsCiAgICAgCiAgICAjU2V0cyB3aGljaCBDaGFyYWN0ZXIgQXJyYXkgdG8gdXNlIGJhc2VkIG9uICRDb21wbGV4CiAgICBpZiAoJENvbXBsZXgpeyRzdHJDaGFyYWN0ZXJzID0gJHN0ckNvbXBsZXh9ZWxzZXskc3RyQ2hhcmFjdGVycyA9ICRzdHJTaW1wbGV9CiAgIAogICAgI0xvb3AgdG8gYWN0dWFsbHkgZ2VuZXJhdGUgdGhlIHBhc3N3b3JkCiAgICBmb3IgKCRpPTA7JGkgLWx0ICRQYXNzd29yZExlbmd0aDsgJGkrKyl7JGMgPSBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAkc3RyQ2hhcmFjdGVycwogICAgIGlmIChbY2hhcl06OklzRGlnaXQoJGMpKXskYm9sSGFzTnVtYmVyID0gJHRydWV9JHBhc3MgKz0gJGN9CiAgICAKICAgICNDaGVjayB0byBzZWUgaWYgYSBEaWdpdCB3YXMgc2VlbiwgaWYgbm90LCBmaXhpdAogICAgaWYgKCRib2xIYXNOdW1iZXIpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJHBhc3MKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJHBvcyA9IEdldC1SYW5kb20gLU1heGltdW0gJFBhc3N3b3JkTGVuZ3RoCiAgICAgICAgICAgICRuID0gR2V0LVJhbmRvbSAtSW5wdXRPYmplY3QgJHN0ck51bWJlcnMKICAgICAgICAgICAgJHB3QXJyYXkgPSAkcGFzcy5Ub0NoYXJBcnJheSgpCiAgICAgICAgICAgICRwd0FycmF5WyRwb3NdID0gJG4KICAgICAgICAgICAgJHBhc3MgPSAiIgogICAgICAgICAgICBmb3JlYWNoICgkcyBpbiAkcHdBcnJheSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHBhc3MgKz0gJHMKICAgICAgICAgICAgfQogICAgICAgIHJldHVybiAkcGFzcwogICAgfQp9CkZ1bmN0aW9uIFVwZGF0ZS1WSUFMb2cKewogICAgW0NtZGxldEJpbmRpbmcoU3VwcG9ydHNTaG91bGRQcm9jZXNzPSR0cnVlKV0KCiAgICBQYXJhbSgKICAgIFtQYXJhbWV0ZXIoCiAgICAgICAgTWFuZGF0b3J5PSR0cnVlLCAKICAgICAgICBWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSwKICAgICAgICBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlLAogICAgICAgIFBvc2l0aW9uPTAKICAgICldCiAgICBbc3RyaW5nXSREYXRhLAoKICAgIFtQYXJhbWV0ZXIoCiAgICAgICAgTWFuZGF0b3J5PSRmYWxzZSwgCiAgICAgICAgVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUsCiAgICAgICAgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSwKICAgICAgICBQb3NpdGlvbj0wCiAgICApXQogICAgW3N0cmluZ10kU29sdXRpb24gPSAkU29sdXRpb24sCgogICAgW1BhcmFtZXRlcigKICAgICAgICBNYW5kYXRvcnk9JGZhbHNlLCAKICAgICAgICBWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSwKICAgICAgICBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlLAogICAgICAgIFBvc2l0aW9uPTEKICAgICldCiAgICBbdmFsaWRhdGVzZXQoJ0luZm9ybWF0aW9uJywnV2FybmluZycsJ0Vycm9yJyldCiAgICBbc3RyaW5nXSRDbGFzcyA9ICJJbmZvcm1hdGlvbiIKCiAgICApCiAgICAkTG9nU3RyaW5nID0gIiRTb2x1dGlvbiwgJERhdGEsICRDbGFzcywgJChHZXQtRGF0ZSkiCiAgICAkSG9zdFN0cmluZyA9ICIkU29sdXRpb24sICREYXRhLCAkKEdldC1EYXRlKSIKICAgIAogICAgQWRkLUNvbnRlbnQgLVBhdGggJExvZ1BhdGggLVZhbHVlICRMb2dTdHJpbmcKICAgIHN3aXRjaCAoJENsYXNzKQogICAgewogICAgICAgICdJbmZvcm1hdGlvbid7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJEhvc3RTdHJpbmcgLUZvcmVncm91bmRDb2xvciBHcmF5CiAgICAgICAgICAgIH0KICAgICAgICAnV2FybmluZyd7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJEhvc3RTdHJpbmcgLUZvcmVncm91bmRDb2xvciBZZWxsb3cKICAgICAgICAgICAgfQogICAgICAgICdFcnJvcid7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJEhvc3RTdHJpbmcgLUZvcmVncm91bmRDb2xvciBSZWQKICAgICAgICAgICAgfQogICAgICAgIERlZmF1bHQge30KICAgIH0KfQpGdW5jdGlvbiBTdXNwZW5kLVZJQVNjcmlwdAp7CiAgICBbQ21kbGV0QmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JHRydWUpXQoKICAgIFBhcmFtKAogICAgICAgICRNZXNzYWdlID0gIlByZXNzIGFueSBrZXkgdG8gY29udGludWUgLiAuIC4gIgogICAgKQoKICAgIElmICgkcHNJU0UpIHsKICAgICAgICAjIFRoZSAiUmVhZEtleSIgZnVuY3Rpb25hbGl0eSBpcyBub3Qgc3VwcG9ydGVkIGluIFdpbmRvd3MgUG93ZXJTaGVsbCBJU0UuCiAgICAgICAgJFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0ICJXU2NyaXB0LlNoZWxsIgogICAgICAgICRCdXR0b24gPSAkU2hlbGwuUG9wdXAoIkNsaWNrIE9LIHRvIGNvbnRpbnVlLiIsIDAsICJTY3JpcHQgUGF1c2VkIiwgMCkKICAgICAgICBSZXR1cm4KICAgIH0KIAogICAgV3JpdGUtSG9zdCAtTm9OZXdsaW5lICRNZXNzYWdlCiAgICAkSWdub3JlID0KICAgICAgICAxNiwgICMgU2hpZnQgKGxlZnQgb3IgcmlnaHQpCiAgICAgICAgMTcsICAjIEN0cmwgKGxlZnQgb3IgcmlnaHQpCiAgICAgICAgMTgsICAjIEFsdCAobGVmdCBvciByaWdodCkKICAgICAgICAyMCwgICMgQ2FwcyBsb2NrCiAgICAgICAgOTEsICAjIFdpbmRvd3Mga2V5IChsZWZ0KQogICAgICAgIDkyLCAgIyBXaW5kb3dzIGtleSAocmlnaHQpCiAgICAgICAgOTMsICAjIE1lbnUga2V5CiAgICAgICAgMTQ0LCAjIE51bSBsb2NrCiAgICAgICAgMTQ1LCAjIFNjcm9sbCBsb2NrCiAgICAgICAgMTY2LCAjIEJhY2sKICAgICAgICAxNjcsICMgRm9yd2FyZAogICAgICAgIDE2OCwgIyBSZWZyZXNoCiAgICAgICAgMTY5LCAjIFN0b3AKICAgICAgICAxNzAsICMgU2VhcmNoCiAgICAgICAgMTcxLCAjIEZhdm9yaXRlcwogICAgICAgIDE3MiwgIyBTdGFydC9Ib21lCiAgICAgICAgMTczLCAjIE11dGUKICAgICAgICAxNzQsICMgVm9sdW1lIERvd24KICAgICAgICAxNzUsICMgVm9sdW1lIFVwCiAgICAgICAgMTc2LCAjIE5leHQgVHJhY2sKICAgICAgICAxNzcsICMgUHJldmlvdXMgVHJhY2sKICAgICAgICAxNzgsICMgU3RvcCBNZWRpYQogICAgICAgIDE3OSwgIyBQbGF5CiAgICAgICAgMTgwLCAjIE1haWwKICAgICAgICAxODEsICMgU2VsZWN0IE1lZGlhCiAgICAgICAgMTgyLCAjIEFwcGxpY2F0aW9uIDEKICAgICAgICAxODMgICMgQXBwbGljYXRpb24gMgogCiAgICBXaGlsZSAoJEtleUluZm8uVmlydHVhbEtleUNvZGUgLUVxICROdWxsIC1PciAkSWdub3JlIC1Db250YWlucyAkS2V5SW5mby5WaXJ0dWFsS2V5Q29kZSkgewogICAgICAgICRLZXlJbmZvID0gJEhvc3QuVUkuUmF3VUkuUmVhZEtleSgiTm9FY2hvLCBJbmNsdWRlS2V5RG93biIpCiAgICB9CiAKICAgIFdyaXRlLUhvc3QKfQpGdW5jdGlvbiBDbGVhci1WSUFWb2x1bWUKewogICAgW2NtZGxldGJpbmRpbmcoU3VwcG9ydHNTaG91bGRQcm9jZXNzPSRUcnVlKV0KCiAgICBQYXJhbSgKICAgICAgICAkVm9sdW1lTGFiZWwKICAgICkKICAgIEdldC1Wb2x1bWUgLUZpbGVTeXN0ZW1MYWJlbCAkVm9sdW1lTGFiZWwgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWV8IEdldC1QYXJ0aXRpb24gfCBHZXQtRGlzayB8IENsZWFyLURpc2sgLVJlbW92ZURhdGEgLVJlbW92ZU9FTSAtQ29uZmlybTokZmFsc2UKfQpGdW5jdGlvbiBTdGFydC1WSUFTb3VuZE5vdGlmeQp7CgogICAgW2NtZGxldGJpbmRpbmcoU3VwcG9ydHNTaG91bGRQcm9jZXNzPSRUcnVlKV0KCiAgICBQYXJhbSgKICAgICkKCiAgICAkc291bmQgPSBuZXctT2JqZWN0IFN5c3RlbS5NZWRpYS5Tb3VuZFBsYXllcjsKICAgICRzb3VuZC5Tb3VuZExvY2F0aW9uPSJjOlxXSU5ET1dTXE1lZGlhXG5vdGlmeS53YXYiOwogICAgJHNvdW5kLlBsYXkoKTsKfQpGdW5jdGlvbiBXYWl0LVZJQVNlcnZpY2VUb1J1bgp7CiAgICBbY21kbGV0YmluZGluZyhTdXBwb3J0c1Nob3VsZFByb2Nlc3M9JFRydWUpXQogICAgUGFyYW0oCiAgICAgICAgJFNlcnZpY2VOYW1lID0gJ0xhbm1hbldvcmtzdGF0aW9uJywKICAgICAgICAkVk1uYW1lLAogICAgICAgICRDcmVkZW50aWFscwogICAgKQogICAgV3JpdGUtVmVyYm9zZSAiV2FpdGluZyBmb3IgJFNlcnZpY2VOYW1lIHRvIHN0YXJ0IG9uICRWTW5hbWUiCiAgICBJbnZva2UtQ29tbWFuZCAtVk1OYW1lICRWTW5hbWUgLVNjcmlwdEJsb2NrIHsKICAgICAgICBQYXJhbSgkU2VydmljZU5hbWUpCiAgICAgICAgZG97CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIldhaXRpbmcgZm9yICRTZXJ2aWNlTmFtZSB0byBzdGFydCIKICAgICAgICAgICAgR2V0LVNlcnZpY2UgLU5hbWUgJFNlcnZpY2VOYW1lCiAgICAgICAgfXVudGlsKChHZXQtU2VydmljZSAtTmFtZSAkU2VydmljZU5hbWUpLlN0YXR1cyAtZXEgJ1J1bm5pbmcnICkKICAgIH0gLUNyZWRlbnRpYWwgJENyZWRlbnRpYWxzIC1Bcmd1bWVudExpc3QgJFNlcnZpY2VOYW1lCn0KCg==
