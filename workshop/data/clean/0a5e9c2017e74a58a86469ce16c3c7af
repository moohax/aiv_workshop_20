SamplePSReadlineProfile.ps1,1ac9afd8480ac452517f6b472a56e43c,Scan result is 1. IsMalware: 0,CiMgVGhpcyBpcyBhbiBleGFtcGxlIHByb2ZpbGUgZm9yIFBTUmVhZGxpbmUuCiMKIyBUaGlzIGlzIHJvdWdobHkgd2hhdCBJIHVzZSBzbyB0aGVyZSBpcyBzb21lIGVtcGhhc2lzIG9uIGVtYWNzIGJpbmRpbmdzLAojIGJ1dCBtb3N0IG9mIHRoZXNlIGJpbmRpbmdzIG1ha2Ugc2Vuc2UgaW4gV2luZG93cyBtb2RlIGFzIHdlbGwuCgpJbXBvcnQtTW9kdWxlIFBTUmVhZExpbmUKClNldC1QU1JlYWRMaW5lT3B0aW9uIC1FZGl0TW9kZSBFbWFjcwoKIyBTZWFyY2hpbmcgZm9yIGNvbW1hbmRzIHdpdGggdXAvZG93biBhcnJvdyBpcyByZWFsbHkgaGFuZHkuICBUaGUKIyBvcHRpb24gIm1vdmVzIHRvIGVuZCIgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRoZSBjdXJzb3IgYXQgdGhlIGVuZAojIG9mIHRoZSBsaW5lIHdoaWxlIGN5Y2xpbmcgdGhyb3VnaCBoaXN0b3J5IGxpa2UgaXQgZG9lcyB3L28gc2VhcmNoaW5nLAojIHdpdGhvdXQgdGhhdCBvcHRpb24sIHRoZSBjdXJzb3Igd2lsbCByZW1haW4gYXQgdGhlIHBvc2l0aW9uIGl0IHdhcwojIHdoZW4geW91IHVzZWQgdXAgYXJyb3csIHdoaWNoIGNhbiBiZSB1c2VmdWwgaWYgeW91IGZvcmdldCB0aGUgZXhhY3QKIyBzdHJpbmcgeW91IHN0YXJ0ZWQgdGhlIHNlYXJjaCBvbi4KU2V0LVBTUmVhZExpbmVPcHRpb24gLUhpc3RvcnlTZWFyY2hDdXJzb3JNb3Zlc1RvRW5kIApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBVcEFycm93IC1GdW5jdGlvbiBIaXN0b3J5U2VhcmNoQmFja3dhcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgRG93bkFycm93IC1GdW5jdGlvbiBIaXN0b3J5U2VhcmNoRm9yd2FyZAoKIyBUaGlzIGlzIGFuIGV4YW1wbGUgb2YgYSBtYWNybyB0aGF0IHlvdSBtaWdodCB1c2UgdG8gZXhlY3V0ZSBhIGNvbW1hbmQuCiMgVGhpcyB3aWxsIGFkZCB0aGUgY29tbWFuZCB0byBoaXN0b3J5LgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBDdHJsK0IgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gQnVpbGRDdXJyZW50RGlyZWN0b3J5IGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIkJ1aWxkIHRoZSBjdXJyZW50IGRpcmVjdG9yeSIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpSZXZlcnRMaW5lKCkKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIm1zYnVpbGQiKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkFjY2VwdExpbmUoKQp9CgojIEluIEVtYWNzIG1vZGUgLSBUYWIgaXMgYWN0cyBsaWtlIGluIGJhc2gsIGJ1dCB0aGUgV2luZG93cyBzdHlsZSBjb21wbGV0aW9uCiMgaXMgc3RpbGwgdXNlZnVsIHNvbWV0aW1lcywgc28gYmluZCBzb21lIGtleXMgc28gd2UgY2FuIGRvIGJvdGgKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtRIC1GdW5jdGlvbiBUYWJDb21wbGV0ZU5leHQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtTaGlmdCtRIC1GdW5jdGlvbiBUYWJDb21wbGV0ZVByZXZpb3VzCgojIENsaXBib2FyZCBpbnRlcmFjdGlvbiBpcyBib3VuZCBieSBkZWZhdWx0IGluIFdpbmRvd3MgbW9kZSwgYnV0IG5vdCBFbWFjcyBtb2RlLgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBTaGlmdCtDdHJsK0MgLUZ1bmN0aW9uIENvcHkKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtWIC1GdW5jdGlvbiBQYXN0ZQoKIyBEZW1vIG1vZGUgaXMgZ3JlYXQgZm9yIGdpdmluZyBkZW1vcyBvZiBQU1JlYWRsaW5lLApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUNob3JkICdDdHJsK0QsQ3RybCtFJyAtRnVuY3Rpb24gRW5hYmxlRGVtb01vZGUKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1DaG9yZCAnQ3RybCtELEN0cmwrRCcgLUZ1bmN0aW9uIERpc2FibGVEZW1vTW9kZQoKIyBDYXB0dXJlU2NyZWVuIGlzIGdvb2QgZm9yIGJsb2cgcG9zdHMgb3IgZW1haWwgc2hvd2luZyBhIHRyYW5zYWN0aW9uCiMgb2Ygd2hhdCB5b3UgZGlkIHdoZW4gYXNraW5nIGZvciBoZWxwIG9yIGRlbW9uc3RyYXRpbmcgYSB0ZWNobmlxdWUuClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtQ2hvcmQgJ0N0cmwrRCxDdHJsK0MnIC1GdW5jdGlvbiBDYXB0dXJlU2NyZWVuCgojIFRoZSBidWlsdC1pbiB3b3JkIG1vdmVtZW50IHVzZXMgY2hhcmFjdGVyIGRlbGltaXRlcnMsIGJ1dCB0b2tlbiBiYXNlZCB3b3JkCiMgbW92ZW1lbnQgaXMgYWxzbyB2ZXJ5IHVzZWZ1bCAtIHRoZXNlIGFyZSB0aGUgYmluZGluZ3MgeW91J2QgdXNlIGlmIHlvdQojIHByZWZlciB0aGUgdG9rZW4gYmFzZWQgbW92ZW1lbnRzIGJvdW5kIHRvIHRoZSBub3JtYWwgZW1hY3Mgd29yZCBtb3ZlbWVudAojIGtleSBiaW5kaW5ncy4KU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQWx0K0QgLUZ1bmN0aW9uIFNoZWxsS2lsbFdvcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQWx0K0JhY2tzcGFjZSAtRnVuY3Rpb24gU2hlbGxCYWNrd2FyZEtpbGxXb3JkClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEFsdCtCIC1GdW5jdGlvbiBTaGVsbEJhY2t3YXJkV29yZApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBBbHQrRiAtRnVuY3Rpb24gU2hlbGxGb3J3YXJkV29yZApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBTaGlmdCtBbHQrQiAtRnVuY3Rpb24gU2VsZWN0U2hlbGxCYWNrd2FyZFdvcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgU2hpZnQrQWx0K0YgLUZ1bmN0aW9uIFNlbGVjdFNoZWxsRm9yd2FyZFdvcmQKCiNyZWdpb24gU21hcnQgSW5zZXJ0L0RlbGV0ZQoKIyBUaGUgbmV4dCBmb3VyIGtleSBoYW5kbGVycyBhcmUgZGVzaWduZWQgdG8gbWFrZSBlbnRlcmluZyBtYXRjaGVkIHF1b3RlcwojIHBhcmVucywgYW5kIGJyYWNlcyBhIG5pY2VyIGV4cGVyaWVuY2UuICBJJ2QgbGlrZSB0byBpbmNsdWRlIGZ1bmN0aW9ucwojIGluIHRoZSBtb2R1bGUgdGhhdCBkbyB0aGlzLCBidXQgdGhpcyBpbXBsZW1lbnRhdGlvbiBzdGlsbCBpc24ndCBhcyBzbWFydAojIGFzIFJlU2hhcnBlciwgc28gSSdtIGp1c3QgcHJvdmlkaW5nIGl0IGFzIGEgc2FtcGxlLgoKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgJyInLCInIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBTbWFydEluc2VydFF1b3RlIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIkluc2VydCBwYWlyZWQgcXVvdGVzIGlmIG5vdCBhbHJlYWR5IG9uIGEgcXVvdGUiIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1TY3JpcHRCbG9jayB7CiAgICBwYXJhbSgka2V5LCAkYXJnKQoKICAgICRsaW5lID0gJG51bGwKICAgICRjdXJzb3IgPSAkbnVsbAogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkdldEJ1ZmZlclN0YXRlKFtyZWZdJGxpbmUsIFtyZWZdJGN1cnNvcikKCiAgICBpZiAoJGxpbmVbJGN1cnNvcl0gLWVxICRrZXkuS2V5Q2hhcikgewogICAgICAgICMgSnVzdCBtb3ZlIHRoZSBjdXJzb3IKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6U2V0Q3Vyc29yUG9zaXRpb24oJGN1cnNvciArIDEpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAjIEluc2VydCBtYXRjaGluZyBxdW90ZXMsIG1vdmUgY3Vyc29yIHRvIGJlIGluIGJldHdlZW4gdGhlIHF1b3RlcwogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIiQoJGtleS5LZXlDaGFyKSIgKiAyKQogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlNldEN1cnNvclBvc2l0aW9uKCRjdXJzb3IgLSAxKQogICAgfQp9CgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSAnKCcsJ3snLCdbJyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBJbnNlcnRQYWlyZWRCcmFjZXMgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiSW5zZXJ0IG1hdGNoaW5nIGJyYWNlcyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGNsb3NlQ2hhciA9IHN3aXRjaCAoJGtleS5LZXlDaGFyKQogICAgewogICAgICAgIDwjY2FzZSM+ICcoJyB7IFtjaGFyXScpJzsgYnJlYWsgfQogICAgICAgIDwjY2FzZSM+ICd7JyB7IFtjaGFyXSd9JzsgYnJlYWsgfQogICAgICAgIDwjY2FzZSM+ICdbJyB7IFtjaGFyXSddJzsgYnJlYWsgfQogICAgfQoKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIiQoJGtleS5LZXlDaGFyKSRjbG9zZUNoYXIiKQogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlNldEN1cnNvclBvc2l0aW9uKCRjdXJzb3IgLSAxKSAgICAgICAgCn0KClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5ICcpJywnXScsJ30nIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1CcmllZkRlc2NyaXB0aW9uIFNtYXJ0Q2xvc2VCcmFjZXMgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiSW5zZXJ0IGNsb3NpbmcgYnJhY2Ugb3Igc2tpcCIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQoKICAgIGlmICgkbGluZVskY3Vyc29yXSAtZXEgJGtleS5LZXlDaGFyKQogICAgewogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpTZXRDdXJzb3JQb3NpdGlvbigkY3Vyc29yICsgMSkKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6SW5zZXJ0KCIkKCRrZXkuS2V5Q2hhcikiKQogICAgfQp9CgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBCYWNrc3BhY2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gU21hcnRCYWNrc3BhY2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiRGVsZXRlIHByZXZpb3VzIGNoYXJhY3RlciBvciBtYXRjaGluZyBxdW90ZXMvcGFyZW5zL2JyYWNlcyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQoKICAgIGlmICgkY3Vyc29yIC1ndCAwKQogICAgewogICAgICAgICR0b01hdGNoID0gJG51bGwKICAgICAgICBzd2l0Y2ggKCRsaW5lWyRjdXJzb3JdKQogICAgICAgIHsKICAgICAgICAgICAgPCNjYXNlIz4gJyInIHsgJHRvTWF0Y2ggPSAnIic7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gIiciIHsgJHRvTWF0Y2ggPSAiJyI7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJyknIHsgJHRvTWF0Y2ggPSAnKCc7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJ10nIHsgJHRvTWF0Y2ggPSAnWyc7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJ30nIHsgJHRvTWF0Y2ggPSAneyc7IGJyZWFrIH0KICAgICAgICB9CgogICAgICAgIGlmICgkdG9NYXRjaCAtbmUgJG51bGwgLWFuZCAkbGluZVskY3Vyc29yLTFdIC1lcSAkdG9NYXRjaCkKICAgICAgICB7CiAgICAgICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpEZWxldGUoJGN1cnNvciAtIDEsIDIpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpCYWNrd2FyZERlbGV0ZUNoYXIoJGtleSwgJGFyZykKICAgICAgICB9CiAgICB9Cn0KCiNlbmRyZWdpb24gU21hcnQgSW5zZXJ0L0RlbGV0ZQoKIyBTb21ldGltZXMgeW91IGVudGVyIGEgY29tbWFuZCBidXQgcmVhbGl6ZSB5b3UgZm9yZ290IHRvIGRvIHNvbWV0aGluZyBlbHNlIGZpcnN0LgojIFRoaXMgYmluZGluZyB3aWxsIGxldCB5b3Ugc2F2ZSB0aGF0IGNvbW1hbmQgaW4gdGhlIGhpc3Rvcnkgc28geW91IGNhbiByZWNhbGwgaXQsCiMgYnV0IGl0IGRvZXNuJ3QgYWN0dWFsbHkgZXhlY3V0ZS4gIEl0IGFsc28gY2xlYXJzIHRoZSBsaW5lIHdpdGggUmV2ZXJ0TGluZSBzbyB0aGUKIyB1bmRvIHN0YWNrIGlzIHJlc2V0IC0gdGhvdWdoIHJlZG8gd2lsbCBzdGlsbCByZWNvbnN0cnVjdCB0aGUgY29tbWFuZCBsaW5lLgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBBbHQrdyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBTYXZlSW5IaXN0b3J5IGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlNhdmUgY3VycmVudCBsaW5lIGluIGhpc3RvcnkgYnV0IGRvIG5vdCBleGVjdXRlIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkbGluZSA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6QWRkVG9IaXN0b3J5KCRsaW5lKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlJldmVydExpbmUoKQp9CgojIEluc2VydCB0ZXh0IGZyb20gdGhlIGNsaXBib2FyZCBhcyBhIGhlcmUgc3RyaW5nClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEN0cmwrU2hpZnQrdiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBQYXN0ZUFzSGVyZVN0cmluZyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJQYXN0ZSB0aGUgY2xpcGJvYXJkIHRleHQgYXMgYSBoZXJlIHN0cmluZyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgQWRkLVR5cGUgLUFzc2VtYmx5IFByZXNlbnRhdGlvbkNvcmUKICAgIGlmIChbU3lzdGVtLldpbmRvd3MuQ2xpcGJvYXJkXTo6Q29udGFpbnNUZXh0KCkpCiAgICB7CiAgICAgICAgIyBHZXQgY2xpcGJvYXJkIHRleHQgLSByZW1vdmUgdHJhaWxpbmcgc3BhY2VzLCBjb252ZXJ0IFxyXG4gdG8gXG4sIGFuZCByZW1vdmUgdGhlIGZpbmFsIFxuLgogICAgICAgICR0ZXh0ID0gKFtTeXN0ZW0uV2luZG93cy5DbGlwYm9hcmRdOjpHZXRUZXh0KCkgLXJlcGxhY2UgIlxwe1pzfSpgcj9gbiIsImBuIikuVHJpbUVuZCgpCiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06Okluc2VydCgiQCdgbiR0ZXh0YG4nQCIpCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkRpbmcoKQogICAgfQp9CgojIFNvbWV0aW1lcyB5b3Ugd2FudCB0byBnZXQgYSBwcm9wZXJ0eSBvZiBpbnZva2UgYSBtZW1iZXIgb24gd2hhdCB5b3UndmUgZW50ZXJlZCBzbyBmYXIKIyBidXQgeW91IG5lZWQgcGFyZW5zIHRvIGRvIHRoYXQuICBUaGlzIGJpbmRpbmcgd2lsbCBoZWxwIGJ5IHB1dHRpbmcgcGFyZW5zIGFyb3VuZCB0aGUgd2hvbGUgbGluZS4KU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgJ0FsdCsoJyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBQYXJlbnRoZXNpemVMaW5lIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlB1dCBwYXJlbnRoZXNpcyBhcm91bmQgdGhlIGVudGlyZSBsaW5lIGFuZCBtb3ZlIHRoZSBjdXJzb3IgdG8gdGhlIGVuZCBvZiBsaW5lIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkbGluZSA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6UmVwbGFjZSgwLCAkbGluZS5MZW5ndGgsICcoJyArICRsaW5lICsgJyknKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkVuZE9mTGluZSgpCn0KCiMgRWFjaCB0aW1lIHlvdSBwcmVzcyBBbHQrJywgdGhpcyBrZXkgaGFuZGxlciB3aWxsIGNoYW5nZSB0aGUgdG9rZW4KIyB1bmRlciBvciBiZWZvcmUgdGhlIGN1cnNvci4gIEl0IHdpbGwgY3ljbGUgdGhyb3VnaCBzaW5nbGUgcXVvdGVzLCBkb3VibGUgcXVvdGVzLCBvcgojIG5vIHF1b3RlcyBlYWNoIHRpbWUgaXQgaXMgaW52b2tlZC4KU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgIkFsdCsnIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBUb2dnbGVRdW90ZUFyZ3VtZW50IGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlRvZ2dsZSBxdW90ZXMgb24gdGhlIGFyZ3VtZW50IHVuZGVyIHRoZSBjdXJzb3IiIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1TY3JpcHRCbG9jayB7CiAgICBwYXJhbSgka2V5LCAkYXJnKQoKICAgICRhc3QgPSAkbnVsbAogICAgJHRva2VucyA9ICRudWxsCiAgICAkZXJyb3JzID0gJG51bGwKICAgICRjdXJzb3IgPSAkbnVsbAogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkdldEJ1ZmZlclN0YXRlKFtyZWZdJGFzdCwgW3JlZl0kdG9rZW5zLCBbcmVmXSRlcnJvcnMsIFtyZWZdJGN1cnNvcikKCiAgICAkdG9rZW5Ub0NoYW5nZSA9ICRudWxsCiAgICBmb3JlYWNoICgkdG9rZW4gaW4gJHRva2VucykKICAgIHsKICAgICAgICAkZXh0ZW50ID0gJHRva2VuLkV4dGVudAogICAgICAgIGlmICgkZXh0ZW50LlN0YXJ0T2Zmc2V0IC1sZSAkY3Vyc29yIC1hbmQgJGV4dGVudC5FbmRPZmZzZXQgLWdlICRjdXJzb3IpCiAgICAgICAgewogICAgICAgICAgICAkdG9rZW5Ub0NoYW5nZSA9ICR0b2tlbgoKICAgICAgICAgICAgIyBJZiB0aGUgY3Vyc29yIGlzIGF0IHRoZSBlbmQgKGl0J3MgcmVhbGx5IDEgcGFzdCB0aGUgZW5kKSBvZiB0aGUgcHJldmlvdXMgdG9rZW4sCiAgICAgICAgICAgICMgd2Ugb25seSB3YW50IHRvIGNoYW5nZSB0aGUgcHJldmlvdXMgdG9rZW4gaWYgdGhlcmUgaXMgbm8gdG9rZW4gdW5kZXIgdGhlIGN1cnNvcgogICAgICAgICAgICBpZiAoJGV4dGVudC5FbmRPZmZzZXQgLWVxICRjdXJzb3IgLWFuZCAkZm9yZWFjaC5Nb3ZlTmV4dCgpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkbmV4dFRva2VuID0gJGZvcmVhY2guQ3VycmVudAogICAgICAgICAgICAgICAgaWYgKCRuZXh0VG9rZW4uRXh0ZW50LlN0YXJ0T2Zmc2V0IC1lcSAkY3Vyc29yKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICR0b2tlblRvQ2hhbmdlID0gJG5leHRUb2tlbgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgfQoKICAgIGlmICgkdG9rZW5Ub0NoYW5nZSAtbmUgJG51bGwpCiAgICB7CiAgICAgICAgJGV4dGVudCA9ICR0b2tlblRvQ2hhbmdlLkV4dGVudAogICAgICAgICR0b2tlblRleHQgPSAkZXh0ZW50LlRleHQKICAgICAgICBpZiAoJHRva2VuVGV4dFswXSAtZXEgJyInIC1hbmQgJHRva2VuVGV4dFstMV0gLWVxICciJykKICAgICAgICB7CiAgICAgICAgICAgICMgU3dpdGNoIHRvIG5vIHF1b3RlcwogICAgICAgICAgICAkcmVwbGFjZW1lbnQgPSAkdG9rZW5UZXh0LlN1YnN0cmluZygxLCAkdG9rZW5UZXh0Lkxlbmd0aCAtIDIpCiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoJHRva2VuVGV4dFswXSAtZXEgIiciIC1hbmQgJHRva2VuVGV4dFstMV0gLWVxICInIikKICAgICAgICB7CiAgICAgICAgICAgICMgU3dpdGNoIHRvIGRvdWJsZSBxdW90ZXMKICAgICAgICAgICAgJHJlcGxhY2VtZW50ID0gJyInICsgJHRva2VuVGV4dC5TdWJzdHJpbmcoMSwgJHRva2VuVGV4dC5MZW5ndGggLSAyKSArICciJwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIEFkZCBzaW5nbGUgcXVvdGVzCiAgICAgICAgICAgICRyZXBsYWNlbWVudCA9ICInIiArICR0b2tlblRleHQgKyAiJyIKICAgICAgICB9CgogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpSZXBsYWNlKAogICAgICAgICAgICAkZXh0ZW50LlN0YXJ0T2Zmc2V0LAogICAgICAgICAgICAkdG9rZW5UZXh0Lkxlbmd0aCwKICAgICAgICAgICAgJHJlcGxhY2VtZW50KQogICAgfQp9CgojIFRoaXMgZXhhbXBsZSB3aWxsIHJlcGxhY2UgYW55IGFsaWFzZXMgb24gdGhlIGNvbW1hbmQgbGluZSB3aXRoIHRoZSByZXNvbHZlZCBjb21tYW5kcy4KU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgIkFsdCslIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBFeHBhbmRBbGlhc2VzIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlJlcGxhY2UgYWxsIGFsaWFzZXMgd2l0aCB0aGUgZnVsbCBjb21tYW5kIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkYXN0ID0gJG51bGwKICAgICR0b2tlbnMgPSAkbnVsbAogICAgJGVycm9ycyA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRhc3QsIFtyZWZdJHRva2VucywgW3JlZl0kZXJyb3JzLCBbcmVmXSRjdXJzb3IpCgogICAgJHN0YXJ0QWRqdXN0bWVudCA9IDAKICAgIGZvcmVhY2ggKCR0b2tlbiBpbiAkdG9rZW5zKQogICAgewogICAgICAgIGlmICgkdG9rZW4uVG9rZW5GbGFncyAtYmFuZCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5MYW5ndWFnZS5Ub2tlbkZsYWdzXTo6Q29tbWFuZE5hbWUpCiAgICAgICAgewogICAgICAgICAgICAkYWxpYXMgPSAkRXhlY3V0aW9uQ29udGV4dC5JbnZva2VDb21tYW5kLkdldENvbW1hbmQoJHRva2VuLkV4dGVudC5UZXh0LCAnQWxpYXMnKQogICAgICAgICAgICBpZiAoJGFsaWFzIC1uZSAkbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHJlc29sdmVkQ29tbWFuZCA9ICRhbGlhcy5SZXNvbHZlZENvbW1hbmROYW1lIAogICAgICAgICAgICAgICAgaWYgKCRyZXNvbHZlZENvbW1hbmQgLW5lICRudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRleHRlbnQgPSAkdG9rZW4uRXh0ZW50CiAgICAgICAgICAgICAgICAgICAgJGxlbmd0aCA9ICRleHRlbnQuRW5kT2Zmc2V0IC0gJGV4dGVudC5TdGFydE9mZnNldAogICAgICAgICAgICAgICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpSZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAkZXh0ZW50LlN0YXJ0T2Zmc2V0ICsgJHN0YXJ0QWRqdXN0bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgJGxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc29sdmVkQ29tbWFuZCkKCiAgICAgICAgICAgICAgICAgICAgIyBPdXIgY29weSBvZiB0aGUgdG9rZW5zIHdvbid0IGhhdmUgYmVlbiB1cGRhdGVkLCBzbyB3ZSBuZWVkIHRvCiAgICAgICAgICAgICAgICAgICAgIyBhZGp1c3QgYnkgdGhlIGRpZmZlcmVuY2UgaW4gbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgJHN0YXJ0QWRqdXN0bWVudCArPSAoJHJlc29sdmVkQ29tbWFuZC5MZW5ndGggLSAkbGVuZ3RoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgojIEYxIGZvciBoZWxwIG9uIHRoZSBjb21tYW5kIGxpbmUgLSBuYXR1cmFsbHkKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgRjEgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gQ29tbWFuZEhlbHAgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiT3BlbiB0aGUgaGVscCB3aW5kb3cgZm9yIHRoZSBjdXJyZW50IGNvbW1hbmQiIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1TY3JpcHRCbG9jayB7CiAgICBwYXJhbSgka2V5LCAkYXJnKQoKICAgICRhc3QgPSAkbnVsbAogICAgJHRva2VucyA9ICRudWxsCiAgICAkZXJyb3JzID0gJG51bGwKICAgICRjdXJzb3IgPSAkbnVsbAogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkdldEJ1ZmZlclN0YXRlKFtyZWZdJGFzdCwgW3JlZl0kdG9rZW5zLCBbcmVmXSRlcnJvcnMsIFtyZWZdJGN1cnNvcikKCiAgICAkY29tbWFuZEFzdCA9ICRhc3QuRmluZEFsbCggewogICAgICAgICRub2RlID0gJGFyZ3NbMF0KICAgICAgICAkbm9kZSAtaXMgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uTGFuZ3VhZ2UuQ29tbWFuZEFzdF0gLWFuZAogICAgICAgICAgICAkbm9kZS5FeHRlbnQuU3RhcnRPZmZzZXQgLWxlICRjdXJzb3IgLWFuZAogICAgICAgICAgICAkbm9kZS5FeHRlbnQuRW5kT2Zmc2V0IC1nZSAkY3Vyc29yCiAgICAgICAgfSwgJHRydWUpIHwgU2VsZWN0LU9iamVjdCAtTGFzdCAxCgogICAgaWYgKCRjb21tYW5kQXN0IC1uZSAkbnVsbCkKICAgIHsKICAgICAgICAkY29tbWFuZE5hbWUgPSAkY29tbWFuZEFzdC5HZXRDb21tYW5kTmFtZSgpCiAgICAgICAgaWYgKCRjb21tYW5kTmFtZSAtbmUgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICAkY29tbWFuZCA9ICRFeGVjdXRpb25Db250ZXh0Lkludm9rZUNvbW1hbmQuR2V0Q29tbWFuZCgkY29tbWFuZE5hbWUsICdBbGwnKQogICAgICAgICAgICBpZiAoJGNvbW1hbmQgLWlzIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkFsaWFzSW5mb10pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRjb21tYW5kTmFtZSA9ICRjb21tYW5kLlJlc29sdmVkQ29tbWFuZE5hbWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRjb21tYW5kTmFtZSAtbmUgJG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEdldC1IZWxwICRjb21tYW5kTmFtZSAtU2hvd1dpbmRvdwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==
