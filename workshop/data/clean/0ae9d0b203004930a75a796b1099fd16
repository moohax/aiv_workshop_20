MSFT_xDSCWebService.psm1,0a386070bf3ddd90027912eaf85ddaf5,Scan result is 1. IsMalware: 0,IyBJbXBvcnQgdGhlIGhlbHBlciBmdW5jdGlvbnMKSW1wb3J0LU1vZHVsZSAkUFNTY3JpcHRSb290XFBTV1NJSVNFbmRwb2ludC5wc20xIC1WZXJib3NlOiRmYWxzZQoKIyBUaGUgR2V0LVRhcmdldFJlc291cmNlIGNtZGxldC4KZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtPdXRwdXRUeXBlKFtIYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgIyBQcmVmaXggb2YgdGhlIFdDRiBTVkMgRmlsZQogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddJEVuZHBvaW50TmFtZSwKICAgICAgICAgICAgCiAgICAgICAgIyBUaHVtYnByaW50IG9mIHRoZSBDZXJ0aWZpY2F0ZSBpbiBDRVJUOlxMb2NhbE1hY2hpbmVcTVlcIGZvciBQdWxsIFNlcnZlciAgIAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXSAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRDZXJ0aWZpY2F0ZVRodW1iUHJpbnQgICAgICAKICAgICkKCiAgICAkd2ViU2l0ZSA9IEdldC1XZWJzaXRlIC1OYW1lICRFbmRwb2ludE5hbWUKCiAgICBpZiAoJHdlYlNpdGUpCiAgICB7CiAgICAgICAgICAgICRFbnN1cmUgPSAnUHJlc2VudCcKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAjIEdldCBGdWxsIFBhdGggZm9yIFdlYi5jb25maWcgZmlsZSAgICAKICAgICAgICAgICAgJHdlYkNvbmZpZ0Z1bGxQYXRoID0gSm9pbi1QYXRoICR3ZWJzaXRlLnBoeXNpY2FsUGF0aCAid2ViLmNvbmZpZyIKCiAgICAgICAgICAgICMgR2V0IG1vZHVsZSBhbmQgY29uZmlndXJhdGlvbiBwYXRoCiAgICAgICAgICAgICRtb2R1bGVQYXRoID0gR2V0LVdlYkNvbmZpZ0FwcFNldHRpbmcgLVdlYkNvbmZpZ0Z1bGxQYXRoICR3ZWJDb25maWdGdWxsUGF0aCAtQXBwU2V0dGluZ05hbWUgIk1vZHVsZVBhdGgiCiAgICAgICAgICAgICRDb25maWd1cmF0aW9uUGF0aCA9IEdldC1XZWJDb25maWdBcHBTZXR0aW5nIC1XZWJDb25maWdGdWxsUGF0aCAkd2ViQ29uZmlnRnVsbFBhdGggLUFwcFNldHRpbmdOYW1lICJDb25maWd1cmF0aW9uUGF0aCIKCiAgICAgICAgICAgICRVcmxQcmVmaXggPSAkd2Vic2l0ZS5iaW5kaW5ncy5Db2xsZWN0aW9uWzBdLnByb3RvY29sICsgIjovLyIKCiAgICAgICAgICAgICRmcWRuID0gJGVudjpDT01QVVRFUk5BTUUKICAgICAgICAgICAgaWYgKCRlbnY6VVNFUkROU0RPTUFJTikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGZxZG4gPSAkZW52OkNPTVBVVEVSTkFNRSArICIuIiArICRlbnY6VVNFUkROU0RPTUFJTgogICAgICAgICAgICB9CgogICAgICAgICAgICAkaWlzUG9ydCA9ICR3ZWJzaXRlLmJpbmRpbmdzLkNvbGxlY3Rpb25bMF0uYmluZGluZ0luZm9ybWF0aW9uLlNwbGl0KCI6IilbMV0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICRzdmNGaWxlTmFtZSA9IChHZXQtQ2hpbGRJdGVtIC1QYXRoICR3ZWJzaXRlLnBoeXNpY2FsUGF0aCAtRmlsdGVyICIqLnN2YyIpLk5hbWUKCiAgICAgICAgICAgICRzZXJ2ZXJVcmwgPSAkVXJsUHJlZml4ICsgJGZxZG4gKyAiOiIgKyAkaWlzUG9ydCArICIvIiArICRzdmNGaWxlTmFtZQoKICAgICAgICAgICAgJHdlYkJpbmRpbmcgPSBHZXQtV2ViQmluZGluZyAtTmFtZSAkRW5kcG9pbnROYW1lCiAgICAgICAgICAgIAogICAgICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkRW5zdXJlID0gJ0Fic2VudCcKICAgIH0KCiAgICBAewogICAgICAgIEVuZHBvaW50TmFtZSAgICAgID0gJEVuZHBvaW50TmFtZQogICAgICAgIENlcnRpZmljYXRlVGh1bWJQcmludCA9IGlmKCRDZXJ0aWZpY2F0ZVRodW1iUHJpbnQgLWVxICdBbGxvd1VuZW5jcnlwdGVkVHJhZmZpYycpeyRDZXJ0aWZpY2F0ZVRodW1iUHJpbnR9IGVsc2Uge0dldC1XZWJCaW5kaW5nIC1OYW1lICRFbmRwb2ludE5hbWV9CiAgICAgICAgUG9ydCAgICAgICAgICAgICAgPSAkaWlzUG9ydAogICAgICAgIFBoeXNpY2FsUGF0aCAgICAgID0gJHdlYnNpdGUucGh5c2ljYWxQYXRoCiAgICAgICAgU3RhdGUgICAgICAgICAgICAgPSAkd2ViU2l0ZS5zdGF0ZQogICAgICAgIE1vZHVsZVBhdGggICAgICAgID0gJG1vZHVsZVBhdGgKICAgICAgICBDb25maWd1cmF0aW9uUGF0aCA9ICRDb25maWd1cmF0aW9uUGF0aAogICAgICAgIERTQ1NlcnZlclVybCAgICAgID0gJHNlcnZlclVybAogICAgICAgIEVuc3VyZSAgICAgICAgICAgID0gJEVuc3VyZQogICAgfQp9CgojIFRoZSBTZXQtVGFyZ2V0UmVzb3VyY2UgY21kbGV0LgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgcGFyYW0KICAgICgKICAgICAgICAjIFByZWZpeCBvZiB0aGUgV0NGIFNWQyBGaWxlCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW3N0cmluZ10kRW5kcG9pbnROYW1lLAoKICAgICAgICAjIFBvcnQgbnVtYmVyIG9mIHRoZSBEU0MgUHVsbCBTZXJ2ZXIgSUlTIEVuZHBvaW50CiAgICAgICAgW1VpbnQzMl0kUG9ydCA9ICQoIGlmICgkSXNDb21wbGlhbmNlU2VydmVyKSB7IDcwNzAgfSBlbHNlIHsgODA4MCB9ICksCgogICAgICAgICMgUGh5c2ljYWwgcGF0aCBmb3IgdGhlIElJUyBFbmRwb2ludCBvbiB0aGUgbWFjaGluZSAodXN1YWxseSB1bmRlciBpbmV0cHViL3d3d3Jvb3QpICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIFtzdHJpbmddJFBoeXNpY2FsUGF0aCA9ICIkZW52OlN5c3RlbURyaXZlXGluZXRwdWJcd3d3cm9vdFwkRW5kcG9pbnROYW1lIiwKCiAgICAgICAgIyBUaHVtYnByaW50IG9mIHRoZSBDZXJ0aWZpY2F0ZSBpbiBDRVJUOlxMb2NhbE1hY2hpbmVcTVlcIGZvciBQdWxsIFNlcnZlcgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRDZXJ0aWZpY2F0ZVRodW1iUHJpbnQsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsICJBYnNlbnQiKV0KICAgICAgICBbc3RyaW5nXSRFbnN1cmUgPSAiUHJlc2VudCIsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiU3RhcnRlZCIsICJTdG9wcGVkIildCiAgICAgICAgW3N0cmluZ10kU3RhdGUgPSAiU3RhcnRlZCIsCiAgICAKICAgICAgICAjIExvY2F0aW9uIG9uIHRoZSBkaXNrIHdoZXJlIHRoZSBNb2R1bGVzIGFyZSBzdG9yZWQgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRNb2R1bGVQYXRoID0gIiRlbnY6UFJPR1JBTUZJTEVTXFdpbmRvd3NQb3dlclNoZWxsXERzY1NlcnZpY2VcTW9kdWxlcyIsCgogICAgICAgICMgTG9jYXRpb24gb24gdGhlIGRpc2sgd2hlcmUgdGhlIENvbmZpZ3VyYXRpb24gaXMgc3RvcmVkICAgICAgICAgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRDb25maWd1cmF0aW9uUGF0aCA9ICIkZW52OlBST0dSQU1GSUxFU1xXaW5kb3dzUG93ZXJTaGVsbFxEc2NTZXJ2aWNlXENvbmZpZ3VyYXRpb24iLAoKICAgICAgICAjIElzIHRoZSBlbmRwb2ludCBmb3IgYSBEU0MgQ29tcGxpYW5jZSBTZXJ2ZXIKICAgICAgICBbYm9vbGVhbl0gJElzQ29tcGxpYW5jZVNlcnZlcgogICAgKQoKICAgICMgSW5pdGlhbGl6ZSB3aXRoIGRlZmF1bHQgdmFsdWVzICAgICAgICAKICAgICRwYXRoUHVsbFNlcnZlciA9ICIkcHNob21lXG1vZHVsZXNcUFNEZXNpcmVkU3RhdGVDb25maWd1cmF0aW9uXFB1bGxTZXJ2ZXIiCiAgICAkcm9vdERhdGFQYXRoID0iJGVudjpQUk9HUkFNRklMRVNcV2luZG93c1Bvd2VyU2hlbGxcRHNjU2VydmljZSIKICAgICRqZXQ0cHJvdmlkZXIgPSAiU3lzdGVtLkRhdGEuT2xlRGIiCiAgICAkamV0NGRhdGFiYXNlID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5KZXQuT0xFREIuNC4wO0RhdGEgU291cmNlPSRlbnY6UFJPR1JBTUZJTEVTXFdpbmRvd3NQb3dlclNoZWxsXERzY1NlcnZpY2VcRGV2aWNlcy5tZGI7IgogICAgJGVzZXByb3ZpZGVyID0gIkVTRU5UIjsKICAgICRlc2VkYXRhYmFzZSA9ICIkZW52OlBST0dSQU1GSUxFU1xXaW5kb3dzUG93ZXJTaGVsbFxEc2NTZXJ2aWNlXERldmljZXMuZWRiIjsKCiAgICAkY3VsdHVyZSA9IEdldC1DdWx0dXJlCiAgICAkbGFuZ3VhZ2UgPSAkY3VsdHVyZS5Ud29MZXR0ZXJJU09MYW5ndWFnZU5hbWUKCiAgICAkb3MgPSBbU3lzdGVtLkVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24KICAgICRJc0JsdWUgPSAkZmFsc2U7CiAgICBpZigkb3MuTWFqb3IgLWVxIDYgLWFuZCAkb3MuTWlub3IgLWVxIDMpCiAgICB7CiAgICAgICAgJElzQmx1ZSA9ICR0cnVlOwogICAgfQoKICAgICMgVXNlIFB1bGwgU2VydmVyIHZhbHVlcyBmb3IgZGVmYXVsdHMKICAgICR3ZWJDb25maWdGaWxlTmFtZSA9ICIkcGF0aFB1bGxTZXJ2ZXJcUFNEU0NQdWxsU2VydmVyLmNvbmZpZyIKICAgICRzdmNGaWxlTmFtZSA9ICIkcGF0aFB1bGxTZXJ2ZXJcUFNEU0NQdWxsU2VydmVyLnN2YyIKICAgICRwc3dzTW9mRmlsZU5hbWUgPSAiJHBhdGhQdWxsU2VydmVyXFBTRFNDUHVsbFNlcnZlci5tb2YiCiAgICAkcHN3c0Rpc3BhdGNoRmlsZU5hbWUgPSAiJHBhdGhQdWxsU2VydmVyXFBTRFNDUHVsbFNlcnZlci54bWwiCgogICAgIyBVcGRhdGUgb25seSBpZiBDb21wbGlhbmNlIFNlcnZlciBpbnN0YWxsIGlzIHJlcXVlc3RlZAogICAgaWYgKCRJc0NvbXBsaWFuY2VTZXJ2ZXIpCiAgICB7CiAgICAgICAgJHdlYkNvbmZpZ0ZpbGVOYW1lID0gIiRwYXRoUHVsbFNlcnZlclxQU0RTQ0NvbXBsaWFuY2VTZXJ2ZXIuY29uZmlnIgogICAgICAgICRzdmNGaWxlTmFtZSA9ICIkcGF0aFB1bGxTZXJ2ZXJcUFNEU0NDb21wbGlhbmNlU2VydmVyLnN2YyIKICAgICAgICAkcHN3c01vZkZpbGVOYW1lID0gIiRwYXRoUHVsbFNlcnZlclxQU0RTQ0NvbXBsaWFuY2VTZXJ2ZXIubW9mIgogICAgICAgICRwc3dzRGlzcGF0Y2hGaWxlTmFtZSA9ICIkcGF0aFB1bGxTZXJ2ZXJcUFNEU0NDb21wbGlhbmNlU2VydmVyLnhtbCIKICAgIH0KICAgICAgICAgICAgICAgIAogICAgV3JpdGUtVmVyYm9zZSAiQ3JlYXRlIHRoZSBJSVMgZW5kcG9pbnQiICAgIAogICAgUFNXU0lJU0VuZHBvaW50XE5ldy1QU1dTRW5kcG9pbnQgLXNpdGUgJEVuZHBvaW50TmFtZSBgCiAgICAgICAgICAgICAgICAgICAgIC1wYXRoICRQaHlzaWNhbFBhdGggYAogICAgICAgICAgICAgICAgICAgICAtY2ZnZmlsZSAkd2ViQ29uZmlnRmlsZU5hbWUgYAogICAgICAgICAgICAgICAgICAgICAtcG9ydCAkUG9ydCBgCiAgICAgICAgICAgICAgICAgICAgIC1hcHBsaWNhdGlvblBvb2xJZGVudGl0eVR5cGUgTG9jYWxTeXN0ZW0gYAogICAgICAgICAgICAgICAgICAgICAtYXBwICRFbmRwb2ludE5hbWUgYAogICAgICAgICAgICAgICAgICAgICAtc3ZjICRzdmNGaWxlTmFtZSBgCiAgICAgICAgICAgICAgICAgICAgIC1tb2YgJHBzd3NNb2ZGaWxlTmFtZSBgCiAgICAgICAgICAgICAgICAgICAgIC1kaXNwYXRjaCAkcHN3c0Rpc3BhdGNoRmlsZU5hbWUgYAogICAgICAgICAgICAgICAgICAgICAtYXNheCAiJHBhdGhQdWxsU2VydmVyXEdsb2JhbC5hc2F4IiBgCiAgICAgICAgICAgICAgICAgICAgIC1kZXBlbmRlbnRCaW5hcmllcyAgIiRwYXRoUHVsbFNlcnZlclxNaWNyb3NvZnQuUG93ZXJzaGVsbC5EZXNpcmVkU3RhdGVDb25maWd1cmF0aW9uLlNlcnZpY2UuZGxsIiBgCiAgICAgICAgICAgICAgICAgICAgIC1sYW5ndWFnZSAkbGFuZ3VhZ2UgYAogICAgICAgICAgICAgICAgICAgICAtZGVwZW5kZW50TVVJRmlsZXMgICIkcGF0aFB1bGxTZXJ2ZXJcJGxhbmd1YWdlXE1pY3Jvc29mdC5Qb3dlcnNoZWxsLkRlc2lyZWRTdGF0ZUNvbmZpZ3VyYXRpb24uU2VydmljZS5SZXNvdXJjZXMuZGxsIiBgCiAgICAgICAgICAgICAgICAgICAgIC1jZXJ0aWZpY2F0ZVRodW1iUHJpbnQgJENlcnRpZmljYXRlVGh1bWJQcmludCBgCiAgICAgICAgICAgICAgICAgICAgIC1FbmFibGVGaXJld2FsbEV4Y2VwdGlvbiAkdHJ1ZSAtVmVyYm9zZQoKICAgIFVwZGF0ZS1Mb2NhdGlvblRhZ0luQXBwbGljYXRpb25Ib3N0Q29uZmlnRm9yQXV0aGVudGljYXRpb24gLVdlYlNpdGUgJEVuZHBvaW50TmFtZSAtQXV0aGVudGljYXRpb24gImFub255bW91cyIKICAgIFVwZGF0ZS1Mb2NhdGlvblRhZ0luQXBwbGljYXRpb25Ib3N0Q29uZmlnRm9yQXV0aGVudGljYXRpb24gLVdlYlNpdGUgJEVuZHBvaW50TmFtZSAtQXV0aGVudGljYXRpb24gImJhc2ljIgogICAgVXBkYXRlLUxvY2F0aW9uVGFnSW5BcHBsaWNhdGlvbkhvc3RDb25maWdGb3JBdXRoZW50aWNhdGlvbiAtV2ViU2l0ZSAkRW5kcG9pbnROYW1lIC1BdXRoZW50aWNhdGlvbiAid2luZG93cyIKICAgICAgICAKCiAgICBpZiAoJElzQmx1ZSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJTZXQgdmFsdWVzIGludG8gdGhlIHdlYi5jb25maWcgdGhhdCBkZWZpbmUgdGhlIHJlcG9zaXRvcnkgZm9yIEJMVUUgT1MiCiAgICAgICAgUFNXU0lJU0VuZHBvaW50XFNldC1BcHBTZXR0aW5nc0luV2ViY29uZmlnIC1wYXRoICRQaHlzaWNhbFBhdGggLWtleSAiZGJwcm92aWRlciIgLXZhbHVlICRlc2Vwcm92aWRlcgogICAgICAgIFBTV1NJSVNFbmRwb2ludFxTZXQtQXBwU2V0dGluZ3NJbldlYmNvbmZpZyAtcGF0aCAkUGh5c2ljYWxQYXRoIC1rZXkgImRiY29ubmVjdGlvbnN0ciItdmFsdWUgJGVzZWRhdGFiYXNlCiAgICAgICAgU2V0LUJpbmRpbmdSZWRpcmVjdFNldHRpbmdJbldlYkNvbmZpZyAtcGF0aCAkUGh5c2ljYWxQYXRoCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0IHZhbHVlcyBpbnRvIHRoZSB3ZWIuY29uZmlnIHRoYXQgZGVmaW5lIHRoZSByZXBvc2l0b3J5IGZvciBub24tQkxVRSBEb3dubGV2ZWwgT1MiCiAgICAgICAgJHJlcG9zaXRvcnkgPSBKb2luLVBhdGggIiRyb290RGF0YVBhdGgiICJEZXZpY2VzLm1kYiIKICAgICAgICBDb3B5LUl0ZW0gIiRwYXRoUHVsbFNlcnZlclxEZXZpY2VzLm1kYiIgJHJlcG9zaXRvcnkgLUZvcmNlCgogICAgICAgIFBTV1NJSVNFbmRwb2ludFxTZXQtQXBwU2V0dGluZ3NJbldlYmNvbmZpZyAtcGF0aCAkUGh5c2ljYWxQYXRoIC1rZXkgImRicHJvdmlkZXIiIC12YWx1ZSAkamV0NHByb3ZpZGVyCiAgICAgICAgUFNXU0lJU0VuZHBvaW50XFNldC1BcHBTZXR0aW5nc0luV2ViY29uZmlnIC1wYXRoICRQaHlzaWNhbFBhdGggLWtleSAiZGJjb25uZWN0aW9uc3RyIiAtdmFsdWUgJGpldDRkYXRhYmFzZQogICAgfQoKICAgIGlmICgkSXNDb21wbGlhbmNlU2VydmVyKQogICAgeyAgICAKICAgICAgICBXcml0ZS1WZXJib3NlICJDb21wbGlhbmNlIFNlcnZlcjogU2V0IHZhbHVlcyBpbnRvIHRoZSB3ZWIuY29uZmlnIHRoYXQgaW5kaWNhdGUgdGhpcyBpcyB0aGUgYWRtaW4gZW5kcG9pbnQiCiAgICAgICAgUFNXU0lJU0VuZHBvaW50XFNldC1BcHBTZXR0aW5nc0luV2ViY29uZmlnIC1wYXRoICRQaHlzaWNhbFBhdGggLWtleSAiQWRtaW5FbmRQb2ludCIgLXZhbHVlICJ0cnVlIgogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlB1bGwgU2VydmVyOiBTZXQgdmFsdWVzIGludG8gdGhlIHdlYi5jb25maWcgdGhhdCBpbmRpY2F0ZSB0aGUgbG9jYXRpb24gb2YgcmVwb3NpdG9yeSwgY29uZmlndXJhdGlvbiwgbW9kdWxlcyIKCiAgICAgICAgIyBDcmVhdGUgdGhlIGFwcGxpY2F0aW9uIGRhdGEgZGlyZWN0b3J5IGNhbGN1bGF0ZWQgYWJvdmUgICAgICAgIAogICAgICAgICRudWxsID0gTmV3LUl0ZW0gLXBhdGggJHJvb3REYXRhUGF0aCAtaXRlbVR5cGUgImRpcmVjdG9yeSIgLUZvcmNlCiAgICAgICAgICAgICAgICAKICAgICAgICAkcmVwb3NpdG9yeSA9IEpvaW4tUGF0aCAkcm9vdERhdGFQYXRoICJEZXZpY2VzLm1kYiIKICAgICAgICBDb3B5LUl0ZW0gIiRwYXRoUHVsbFNlcnZlclxEZXZpY2VzLm1kYiIgJHJlcG9zaXRvcnkgLUZvcmNlCgogICAgICAgICRudWxsID0gTmV3LUl0ZW0gLXBhdGggIiRDb25maWd1cmF0aW9uUGF0aCIgLWl0ZW1UeXBlICJkaXJlY3RvcnkiIC1Gb3JjZQoKICAgICAgICBQU1dTSUlTRW5kcG9pbnRcU2V0LUFwcFNldHRpbmdzSW5XZWJjb25maWcgLXBhdGggJFBoeXNpY2FsUGF0aCAta2V5ICJDb25maWd1cmF0aW9uUGF0aCIgLXZhbHVlICRDb25maWd1cmF0aW9uUGF0aAoKICAgICAgICAkbnVsbCA9IE5ldy1JdGVtIC1wYXRoICIkTW9kdWxlUGF0aCIgLWl0ZW1UeXBlICJkaXJlY3RvcnkiIC1Gb3JjZQoKICAgICAgICBQU1dTSUlTRW5kcG9pbnRcU2V0LUFwcFNldHRpbmdzSW5XZWJjb25maWcgLXBhdGggJFBoeXNpY2FsUGF0aCAta2V5ICJNb2R1bGVQYXRoIiAtdmFsdWUgJE1vZHVsZVBhdGgJCiAgICB9Cn0KCiMgVGhlIFRlc3QtVGFyZ2V0UmVzb3VyY2UgY21kbGV0LgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKCVtPdXRwdXRUeXBlKFtCb29sZWFuXSldCiAgICBwYXJhbQogICAgKAogICAgICAgICMgUHJlZml4IG9mIHRoZSBXQ0YgU1ZDIEZpbGUKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSRFbmRwb2ludE5hbWUsCgogICAgICAgICMgUG9ydCBudW1iZXIgb2YgdGhlIERTQyBQdWxsIFNlcnZlciBJSVMgRW5kcG9pbnQKICAgICAgICBbVWludDMyXSRQb3J0ID0gJCggaWYgKCRJc0NvbXBsaWFuY2VTZXJ2ZXIpIHsgNzA3MCB9IGVsc2UgeyA4MDgwIH0gKSwKCiAgICAgICAgIyBQaHlzaWNhbCBwYXRoIGZvciB0aGUgSUlTIEVuZHBvaW50IG9uIHRoZSBtYWNoaW5lICh1c3VhbGx5IHVuZGVyIGluZXRwdWIvd3d3cm9vdCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgW3N0cmluZ10kUGh5c2ljYWxQYXRoID0gIiRlbnY6U3lzdGVtRHJpdmVcaW5ldHB1Ylx3d3dyb290XCRFbmRwb2ludE5hbWUiLAoKICAgICAgICAjIFRodW1icHJpbnQgb2YgdGhlIENlcnRpZmljYXRlIGluIENFUlQ6XExvY2FsTWFjaGluZVxNWVwgZm9yIFB1bGwgU2VydmVyCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIFtzdHJpbmddJENlcnRpZmljYXRlVGh1bWJQcmludCA9ICJBbGxvd1VuZW5jcnlwdGVkVHJhZmZpYyIsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsICJBYnNlbnQiKV0KICAgICAgICBbc3RyaW5nXSRFbnN1cmUgPSAiUHJlc2VudCIsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiU3RhcnRlZCIsICJTdG9wcGVkIildCiAgICAgICAgW3N0cmluZ10kU3RhdGUgPSAiU3RhcnRlZCIsCiAgICAKICAgICAgICAjIExvY2F0aW9uIG9uIHRoZSBkaXNrIHdoZXJlIHRoZSBNb2R1bGVzIGFyZSBzdG9yZWQgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRNb2R1bGVQYXRoID0gIiRlbnY6UFJPR1JBTUZJTEVTXFdpbmRvd3NQb3dlclNoZWxsXERzY1NlcnZpY2VcTW9kdWxlcyIsCgogICAgICAgICMgTG9jYXRpb24gb24gdGhlIGRpc2sgd2hlcmUgdGhlIENvbmZpZ3VyYXRpb24gaXMgc3RvcmVkICAgICAgICAgICAgICAgICAgICAKICAgICAgICBbc3RyaW5nXSRDb25maWd1cmF0aW9uUGF0aCA9ICIkZW52OlBST0dSQU1GSUxFU1xXaW5kb3dzUG93ZXJTaGVsbFxEc2NTZXJ2aWNlXENvbmZpZ3VyYXRpb24iLAoKICAgICAgICAjIElzIHRoZSBlbmRwb2ludCBmb3IgYSBEU0MgQ29tcGxpYW5jZSBTZXJ2ZXIKICAgICAgICBbYm9vbGVhbl0gJElzQ29tcGxpYW5jZVNlcnZlcgogICAgKQoKICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJHRydWU7CgogICAgJHdlYnNpdGUgPSBHZXQtV2Vic2l0ZSAtTmFtZSAkRW5kcG9pbnROYW1lCiAgICAkc3RvcCA9ICR0cnVlCgogICAgRG8KICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVjayBFbnN1cmUiCiAgICAgICAgaWYoKCRFbnN1cmUgLWVxICJQcmVzZW50IiAtYW5kICR3ZWJzaXRlIC1lcSAkbnVsbCkgLW9yICgkRW5zdXJlIC1lcSAiQWJzZW50IiAtYW5kICR3ZWJzaXRlIC1uZSAkbnVsbCkpCiAgICAgICAgewogICAgICAgICAgICAkRGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZSAgICAgICAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJUaGUgV2Vic2l0ZSAkRW5kcG9pbnROYW1lIGlzIG5vdCBwcmVzZW50IgogICAgICAgICAgICBicmVhayAgICAgICAKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNrIFBvcnQiCiAgICAgICAgJGFjdHVhbFBvcnQgPSAkd2Vic2l0ZS5iaW5kaW5ncy5Db2xsZWN0aW9uWzBdLmJpbmRpbmdJbmZvcm1hdGlvbi5TcGxpdCgiOiIpWzFdCiAgICAgICAgaWYgKCRQb3J0IC1uZSAkYWN0dWFsUG9ydCkKICAgICAgICB7CiAgICAgICAgICAgICREZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlBvcnQgZm9yIHRoZSBXZWJzaXRlICRFbmRwb2ludE5hbWUgZG9lcyBub3QgbWF0Y2ggdGhlIGRlc2lyZWQgc3RhdGUuIgogICAgICAgICAgICBicmVhayAgICAgICAKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoZWNrIFBoeXNpY2FsIFBhdGggcHJvcGVydHkiCiAgICAgICAgaWYoVGVzdC1XZWJzaXRlUGF0aCAtRW5kcG9pbnROYW1lICRFbmRwb2ludE5hbWUgLVBoeXNpY2FsUGF0aCAkUGh5c2ljYWxQYXRoKQogICAgICAgIHsKICAgICAgICAgICAgJERlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUGh5c2ljYWwgUGF0aCBvZiBXZWJzaXRlICRFbmRwb2ludE5hbWUgZG9lcyBub3QgbWF0Y2ggdGhlIGRlc2lyZWQgc3RhdGUuIgogICAgICAgICAgICBicmVhawogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2hlY2sgU3RhdGUiCiAgICAgICAgaWYoJHdlYnNpdGUuc3RhdGUgLW5lICRTdGF0ZSAtYW5kICRTdGF0ZSAtbmUgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICAkRGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJUaGUgc3RhdGUgb2YgV2Vic2l0ZSAkRW5kcG9pbnROYW1lIGRvZXMgbm90IG1hdGNoIHRoZSBkZXNpcmVkIHN0YXRlLiIKICAgICAgICAgICAgYnJlYWsgICAgICAKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIkdldCBGdWxsIFBhdGggZm9yIFdlYi5jb25maWcgZmlsZSIKICAgICAgICAkd2ViQ29uZmlnRnVsbFBhdGggPSBKb2luLVBhdGggJHdlYnNpdGUucGh5c2ljYWxQYXRoICJ3ZWIuY29uZmlnIgogICAgICAgIGlmICgkSXNDb21wbGlhbmNlU2VydmVyIC1lcSAkZmFsc2UpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDaGVjayBNb2R1bGVQYXRoIgogICAgICAgICAgICBpZiAoJE1vZHVsZVBhdGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgtbm90IChUZXN0LVdlYkNvbmZpZ0FwcFNldHRpbmcgLVdlYkNvbmZpZ0Z1bGxQYXRoICR3ZWJDb25maWdGdWxsUGF0aCAtQXBwU2V0dGluZ05hbWUgIk1vZHVsZVBhdGgiIC1FeHBlY3RlZEFwcFNldHRpbmdWYWx1ZSAkTW9kdWxlUGF0aCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJERlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9ICAgIAoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ2hlY2sgQ29uZmlndXJhdGlvblBhdGgiCiAgICAgICAgICAgIGlmICgkQ29uZmlndXJhdGlvblBhdGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgtbm90IChUZXN0LVdlYkNvbmZpZ0FwcFNldHRpbmcgLVdlYkNvbmZpZ0Z1bGxQYXRoICR3ZWJDb25maWdGdWxsUGF0aCAtQXBwU2V0dGluZ05hbWUgIkNvbmZpZ3VyYXRpb25QYXRoIiAtRXhwZWN0ZWRBcHBTZXR0aW5nVmFsdWUgJENvbmZpZ3VyYXRpb25QYXRoKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkRGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJHN0b3AgPSAkZmFsc2UKICAgIH0KICAgIFdoaWxlKCRzdG9wKSAgCgogICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2g7Cn0KCiMgSGVscGVyIGZ1bmN0aW9uIHVzZWQgdG8gdmFsaWRhdGUgd2Vic2l0ZSBwYXRoCmZ1bmN0aW9uIFRlc3QtV2Vic2l0ZVBhdGgKewogICAgcGFyYW0KICAgICgKICAgICAgICBbc3RyaW5nXSAkRW5kcG9pbnROYW1lLAogICAgICAgIFtzdHJpbmddICRQaHlzaWNhbFBhdGgKICAgICkKCiAgICAkcGF0aE5lZWRzVXBkYXRpbmcgPSAkZmFsc2UKCiAgICBpZigoR2V0LUl0ZW1Qcm9wZXJ0eSAiSUlTOlxTaXRlc1wkRW5kcG9pbnROYW1lIiAtTmFtZSBwaHlzaWNhbFBhdGgpIC1uZSAkUGh5c2ljYWxQYXRoKQogICAgewogICAgICAgICRwYXRoTmVlZHNVcGRhdGluZyA9ICR0cnVlCiAgICB9CgogICAgJHBhdGhOZWVkc1VwZGF0aW5nCn0KCiMgSGVscGVyIGZ1bmN0aW9uIHRvIFRlc3QgdGhlIHNwZWNpZmllZCBXZWIuQ29uZmlnIEFwcCBTZXR0aW5nCmZ1bmN0aW9uIFRlc3QtV2ViQ29uZmlnQXBwU2V0dGluZwp7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtzdHJpbmddICRXZWJDb25maWdGdWxsUGF0aCwKICAgICAgICBbc3RyaW5nXSAkQXBwU2V0dGluZ05hbWUsCiAgICAgICAgW3N0cmluZ10gJEV4cGVjdGVkQXBwU2V0dGluZ1ZhbHVlCiAgICApCiAgICAKICAgICRyZXR1cm5WYWx1ZSA9ICR0cnVlCgogICAgaWYgKFRlc3QtUGF0aCAkV2ViQ29uZmlnRnVsbFBhdGgpCiAgICB7CiAgICAgICAgJHdlYkNvbmZpZ1htbCA9IFt4bWxdKGdldC1jb250ZW50ICRXZWJDb25maWdGdWxsUGF0aCkKICAgICAgICAkcm9vdCA9ICR3ZWJDb25maWdYbWwuZ2V0X0RvY3VtZW50RWxlbWVudCgpIAoKICAgICAgICBmb3JlYWNoICgkaXRlbSBpbiAkcm9vdC5hcHBTZXR0aW5ncy5hZGQpIAogICAgICAgIHsgCiAgICAgICAgICAgIGlmKCAkaXRlbS5rZXkgLWVxICRBcHBTZXR0aW5nTmFtZSApIAogICAgICAgICAgICB7ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0gCiAgICAgICAgfQoKICAgICAgICBpZigkaXRlbS52YWx1ZSAtbmUgJEV4cGVjdGVkQXBwU2V0dGluZ1ZhbHVlKQogICAgICAgIHsKICAgICAgICAgICAgJHJldHVyblZhbHVlID0gJGZhbHNlCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlRoZSBzdGF0ZSBvZiBXZWIuQ29uZmlnIEFwcFNldHRpbmcgJEFwcFNldHRpbmdOYW1lIGRvZXMgbm90IG1hdGNoIHRoZSBkZXNpcmVkIHN0YXRlLiIKICAgICAgICB9CgogICAgfQogICAgJHJldHVyblZhbHVlCn0KCiMgSGVscGVyIGZ1bmN0aW9uIHRvIEdldCB0aGUgc3BlY2lmaWVkIFdlYi5Db25maWcgQXBwIFNldHRpbmcKZnVuY3Rpb24gR2V0LVdlYkNvbmZpZ0FwcFNldHRpbmcKewogICAgcGFyYW0KICAgICgKICAgICAgICBbc3RyaW5nXSAkV2ViQ29uZmlnRnVsbFBhdGgsCiAgICAgICAgW3N0cmluZ10gJEFwcFNldHRpbmdOYW1lCiAgICApCiAgICAKICAgICRhcHBTZXR0aW5nVmFsdWUgPSAiIgogICAgaWYgKFRlc3QtUGF0aCAkV2ViQ29uZmlnRnVsbFBhdGgpCiAgICB7CiAgICAgICAgJHdlYkNvbmZpZ1htbCA9IFt4bWxdKGdldC1jb250ZW50ICRXZWJDb25maWdGdWxsUGF0aCkKICAgICAgICAkcm9vdCA9ICR3ZWJDb25maWdYbWwuZ2V0X0RvY3VtZW50RWxlbWVudCgpIAoKICAgICAgICBmb3JlYWNoICgkaXRlbSBpbiAkcm9vdC5hcHBTZXR0aW5ncy5hZGQpIAogICAgICAgIHsgCiAgICAgICAgICAgIGlmKCAkaXRlbS5rZXkgLWVxICRBcHBTZXR0aW5nTmFtZSApIAogICAgICAgICAgICB7ICAgICAKICAgICAgICAgICAgICAgICRhcHBTZXR0aW5nVmFsdWUgPSAkaXRlbS52YWx1ZSAgICAgICAgICAKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0gCiAgICAgICAgfSAgICAgICAgCiAgICB9CiAgICAKICAgICRhcHBTZXR0aW5nVmFsdWUKfQoKIyBIZWxwZXIgdG8gZ2V0IGN1cnJlbnQgc2NyaXB0IEZvbGRlcgpmdW5jdGlvbiBHZXQtU2NyaXB0Rm9sZGVyCnsKICAgICRJbnZvY2F0aW9uID0gKEdldC1WYXJpYWJsZSBNeUludm9jYXRpb24gLVNjb3BlIDEpLlZhbHVlCiAgICBTcGxpdC1QYXRoICRJbnZvY2F0aW9uLk15Q29tbWFuZC5QYXRoCn0KCiMgQWxsb3cgdGhpcyBXZWJzaXRlIHRvIGVuYWJsZS9kaXNhYmxlIHNwZWNpZmljIEF1dGggU2NoZW1lcyBieSBhZGRpbmcgPGxvY2F0aW9uPiB0YWcgaW4gYXBwbGljYXRpb25ob3N0LmNvbmZpZwpmdW5jdGlvbiBVcGRhdGUtTG9jYXRpb25UYWdJbkFwcGxpY2F0aW9uSG9zdENvbmZpZ0ZvckF1dGhlbnRpY2F0aW9uCnsKICAgIHBhcmFtICgKICAgICAgICAjIE5hbWUgb2YgdGhlIFdlYlNpdGUgICAgICAgIAogICAgICAgIFtTdHJpbmddICRXZWJTaXRlLAoKICAgICAgICAjIEF1dGhlbnRpY2F0aW9uIFR5cGUKICAgICAgICBbVmFsaWRhdGVTZXQoJ2Fub255bW91cycsICdiYXNpYycsICd3aW5kb3dzJyldCQkKICAgICAgICBbU3RyaW5nXSAkQXV0aGVudGljYXRpb24KICAgICkKCiAgICBbU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkV2l0aFBhcnRpYWxOYW1lKCJNaWNyb3NvZnQuV2ViLkFkbWluaXN0cmF0aW9uIikgfCBPdXQtTnVsbAoKICAgICR3ZWJBZG1pblNydk1nciA9IG5ldy1vYmplY3QgTWljcm9zb2Z0LldlYi5BZG1pbmlzdHJhdGlvbi5TZXJ2ZXJNYW5hZ2VyCgogICAgJGFwcEhvc3RDb25maWcgPSAkd2ViQWRtaW5TcnZNZ3IuR2V0QXBwbGljYXRpb25Ib3N0Q29uZmlndXJhdGlvbigpCgogICAgJGF1dGhlbnRpY2F0aW9uVHlwZSA9ICRBdXRoZW50aWNhdGlvbiArICJBdXRoZW50aWNhdGlvbiIKICAgICRhcHBIb3N0Q29uZmlnU2VjdGlvbiA9ICRhcHBIb3N0Q29uZmlnLkdldFNlY3Rpb24oInN5c3RlbS53ZWJTZXJ2ZXIvc2VjdXJpdHkvYXV0aGVudGljYXRpb24vJGF1dGhlbnRpY2F0aW9uVHlwZSIsICRXZWJTaXRlKQogICAgJGFwcEhvc3RDb25maWdTZWN0aW9uLk92ZXJyaWRlTW9kZT0iQWxsb3ciCiAgICAkd2ViQWRtaW5TcnZNZ3IuQ29tbWl0Q2hhbmdlcygpCn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U=
