Write-Ajax.ps1,69d1bdf3698bd9cb908181af5832d668,Scan result is 1. IsMalware: 0,w6/Cu8K/ZnVuY3Rpb24gV3JpdGUtQWpheAp7CiAgICA8IwogICAgLlN5bm9wc2lzCiAgICAgICAgV3JpdGVzIEFKQVggIAogICAgLkRlc2NyaXB0aW9uCiAgICAgICAgV3JpdGVzIEFKQVguICBUaGlzIHdpbGwgZXhlY3V0ZSB0aGUgVVJMIGFuZCByZXBsYWNlIHRoZSBjb250ZW50cyBvZgogICAgICAgIHRoZSBIVE1MIGVsZW1lbnQgd2l0aCB0aGUgSUQgJHVwZGF0ZUlkIHdpdGggdGhlIGNvbnRlbnRzIG9mIHRoZSByZXR1cm5lZCBkb2N1bWVudCAKICAgIC5MaW5rCiAgICAgICAgTmV3LVdlYlBhZ2UKICAgICAgCiAgICAjPgogICAgW091dHB1dFR5cGUoW3N0cmluZ10pXQogICAgcGFyYW0oICAgICAgIAogICAgIyBUaGUgVVJMIHRoYXQgd2lsbCByZXR1cm4gdXBkYXRlZCBjb250ZW50cwogICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUsVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICBbVXJpXSRVcmwsICAgIAogICAgCiAgICAjIFRoZSBtZXRob2QgdG8gdXNlIGZvciB0aGUgcmVxdWVzdAogICAgW1ZhbGlkYXRlU2V0KCJHRVQiLCAiUE9TVCIpXQogICAgW3N0cmluZ10kTWV0aG9kID0gIkdFVCIsCiAgICAKICAgICMgVGhlIElEIHRvIGF1dG9tYXRpY2FsbHkgdXBkYXRlICAgIAogICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUsVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICBbc3RyaW5nXSRVcGRhdGVJZCwKICAgIAogICAgIyBPbmUgb3IgbW9yZSBpbnB1dCBxdWVyeSB2YWx1ZXMuCiAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgW3N0cmluZ1tdXSRJbnB1dFF1ZXJ5LAogICAgCiAgICAjIFRoZSBJbnB1dElEcyB0aGUgcHJvdmlkZSB0aGUgcXVlcnkgdmFsdWVzLgogICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgIFtzdHJpbmdbXV0kSW5wdXRJZCwKICAgIAogICAgIyBUaGUgbmFtZSBvZiB0aGUgZ2VuZXJhdGVkIGZ1bmN0aW9uLiAgSWYgdGhpcyBpcyBub3QgcHJvdmlkZWQsIGl0IHdpbGwgYmUgc2V0IGF1dG9tYXRpY2FsbHkgZnJvbSB0aGUgVVJMCiAgICBbc3RyaW5nXSROYW1lLAogICAgCiAgICAjIEFueSBwb3N0IGRhdGEKICAgIFtzdHJpbmddJFBvc3REYXRhLAogICAgICAgICAgICAKICAgICMgVGhlIFByb3BlcnR5IHRvIHVwZGF0ZSBvbiB0aGUgdXBkYXRlIGVsZW1lbnQKICAgIFtzdHJpbmddJFVwZGF0ZVByb3BlcnR5ID0gImlubmVySFRNTCIsCiAgICAKICAgICMgSWYgc2V0LCB3aWxsIG91dHB1dCB0aGUgYWpheCBjaHVuayBpbiBhIDxzY3JpcHQ+IHRhZyA8L3NjcmlwdD4KICAgIFtzd2l0Y2hdJEluY2x1ZGVTY3JpcHRUYWcsCiAgICAKICAgICMgSWYgc2V0LCB3aWxsIGVzY2FwZSB0aGUgb3V0cHV0IGNvbnRlbnQuICAKICAgICMgSWYgZ2VuZXJhdGluZyB3ZWIgcGFnZXMgd2l0aCBXcml0ZS1BamF4IHRvIGRpc3BsYXkgdG8gdGhlIHVzZXIsIGluc3RlYWQgb2YgcnVuIGluIHRoZSBicm93c2VyLCB1c2UgLUVzY2FwZQogICAgW1N3aXRjaF0kRXNjYXBlLAogICAgICAgIAogICAgIyBSdW5zIG9uZSBvciBtb3JlIGphdmFzY3JpcHQgZnVuY3Rpb25zIHdoZW4gYW4gYWpheCBjYWxsIGNvbXBsZXRlcywgYnV0IGJlZm9yZSB0aGUgcHJvcGVydHkgaXMgc2V0CiAgICBbc3RyaW5nW11dCiAgICAkV2hlblJlc3VsdFJlY2VpdmVkLCAgICAgICAgICAgICAgICAKICAgIAogICAgIyBSdW5zIG9uZSBvciBtb3JlIGphdmFzY3JpcHQgZnVuY3Rpb25zIHdoZW4gYW4gYWpheCBjYWxsIGlzIG1hZGUgCiAgICBbc3RyaW5nW11dCiAgICAkV2hlblJlcXVlc3RNYWRlLCAgICAgIAogICAgCiAgICAjIFJ1bnMgb25lIG9yIG1vcmUgamF2YXNjcmlwdCBmdW5jdGlvbnMgd2hlbiBiZWZvcmUgYW4gYWpheCBjYWxsIGlzIG1hZGUgCiAgICBbc3RyaW5nW11dCiAgICAkQmVmb3JlUmVxdWVzdE1hZGUsICAgICAgICAgICAKICAgIAogICAgIyBSdW5zIG9uZSBvciBtb3JlIGphdmFzY3JpcHQgZnVuY3Rpb25zIHdoZW4gYW4gYWpheCBjYWxsIGNvbXBsZXRlcyBhbmQgaGFzIHNldCBhIHByb3BlcnR5CiAgICBbc3RyaW5nW11dCiAgICAkVGhlblJ1biAgICAgICAgICAgICAgICAKICAgICkKICAgIAogICAgcHJvY2VzcyB7CiAgICAgICAgI3JlZ2lvbiBJZiBubyBuYW1lIGlzIHByb3ZpZGVkLCBnZW5lcmF0ZSBvbmUKICAgICAgICBpZiAoLW5vdCAkcHNCb3VuZFBhcmFtZXRlcnMuTmFtZSkgewogICAgICAgICAgICAkVXJsRnVuY3Rpb25OYW1lID0gJHVybC5Ub1N0cmluZygpCiAgICAgICAgICAgIGlmICgkdXJsRnVuY3Rpb25OYW1lLkNvbnRhaW5zKCI/IikpIHsKICAgICAgICAgICAgICAgICRVcmxGdW5jdGlvbk5hbWUgPSAkVXJsRnVuY3Rpb25OYW1lLlN1YnN0cmluZygwICwkdXJsRnVuY3Rpb25OYW1lLkluZGV4T2YoIj8iKSkgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJFVybEZ1bmN0aW9uTmFtZSA9ICRVcmxGdW5jdGlvbk5hbWUuUmVwbGFjZSgiLyIsIl9zbGFzaF8iKS5SZXBsYWNlKCJcIiwiX2JhY2tzbGFzaF8iKS5SZXBsYWNlKCI6IiwgIl9jb2xvbl8iKS5SZXBsYWNlKCIuIiwgIl9kb3RfIikuUmVwbGFjZSgiLSIsIl8iKSAgICAgICAgICAgIAogICAgICAgICAgICAkbmFtZSA9ICRVcmxGdW5jdGlvbk5hbWUKICAgICAgICB9CiAgICAgICAgI2VuZHJlZ2lvbiBJZiBubyBuYW1lIGlzIHByb3ZpZGVkLCBnZW5lcmF0ZSBvbmUKICAgICAgICAKICAgICAgICAjcmVnaW9uIERldGVybWluZSB0aGUgcXVlcnkgZGF0YSBiYXNlZCBvZmYgb2YgdGhlIHJlbGF0ZWQgY29udHJvbHMKICAgICAgICAkdXBkYXRlUXVlcnlEYXRhID0gIiIKICAgICAgICBpZiAoJGlucHV0UXVlcnkpIHsKICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkSW5wdXRRdWVyeS5Db3VudDsgJGkrKykgewogICAgICAgICAgICAgICAgaWYgKEAoJGlucHV0SWQpWyRpXSkgewogICAgICAgICAgICAgICAgICAgICR1cGRhdGVRdWVyeURhdGEgKz0gIgogICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnJCgkaW5wdXRJZFskaV0pJykKICAgIGlmIChlbGVtZW50ICE9IG51bGwgJiYgZWxlbWVudC52YWx1ZS5sZW5ndGggIT0gMCkgIAogICAgewogICAgICAgIGlmIChxdWVyeURhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICBxdWVyeURhdGEgPSBxdWVyeURhdGEgKyAnJiQoJGlucHV0UXVlcnlbJGldKT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCckKCRpbnB1dElkWyRpXSknKS52YWx1ZSk7IAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHF1ZXJ5RGF0YSA9ICckKCRpbnB1dFF1ZXJ5WyRpXSk9JyArIGVuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnJCgkaW5wdXRJZFskaV0pJykudmFsdWUpOyAKICAgICAgICB9ICAgIAogICAgfQoiICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICB9ICAgICAgICAgICAgIAogICAgICAgICNlbmRyZWdpb24gRGV0ZXJtaW5lIHRoZSBxdWVyeSBkYXRhIGJhc2VkIG9mZiBvZiB0aGUgcmVsYXRlZCBjb250cm9scwogICAgICAgIGlmICgkdXBkYXRlUXVlcnlEYXRhKSB7ICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJHVwZGF0ZVF1ZXJ5RGF0YQogICAgICAgIH0KCiAgICAgICAgJHhtbEh0dHBWYXIgPSAieG1sSHR0cCR7JE5hbWV9IgogICAgICAgIGlmICgtbm90ICRwc0JvdW5kUGFyYW1ldGVycy5OYW1lKSB7CiAgICAgICAgICAgICROYW1lID0gInVwZGF0ZSR7VXBkYXRlSWR9RnJvbV8ke05hbWV9IgogICAgICAgIH0KICAgICAgICAjcmVnaW9uIENvZGUgR2VuZXJhdGUgdGhlIEFqYXggICAgICAKJGFqYXhGdW5jdGlvbiA9IEAiCmZ1bmN0aW9uICR7bmFtZX0oKSB7CiAgICB2YXIgJHhtbEh0dHBWYXI7CiAgICB2YXIgdXJsID0gIiR1cmwiOwogICAgdmFyIHF1ZXJ5RGF0YSA9ICIkcG9zdERhdGEiOwogICAgdmFyIG1ldGhvZCA9ICckKCRtZXRob2QuVG9VcHBlcigpKSc7CiAgICBpZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0KSAKICAgIHsKICAgICAgICAvLyBjb2RlIGZvciBJRTcrLCBGaXJlRm94LCBDaHJvbWUsIE9wZXJhLCBTYWZhcmkKICAgICAgICAkeG1sSHR0cFZhciA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgfSBlbHNlIAogICAgewogICAgICAgIC8vIGNvZGUgZm9yIElFNSwgSUU2CiAgICAgICAkeG1sSHR0cFZhciA9IG5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOwogICAgfQogICAgCiAgICAkdXBkYXRlUXVlcnlEYXRhCiAgICAgICAgICAgCiAgICBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiRVcGRhdGVJZCIpOyAgICAKICAgIGlmIChlbGVtZW50Lm5vZGVOYW1lICA9PSAnSUZSQU1FJykgewogICAgICAgIGVsZW1lbnQuc3JjID0gdXJsCiAgICB9IAogICAgCiAgICAkeG1sSHR0cFZhci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoJHt4bWxIdHRwVmFyfS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgaWYgKCR7eG1sSHR0cFZhcn0uc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXNwb25zZURhdGEgPSAkeG1sSHR0cFZhci5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAkKGlmICgkZXNjYXBlKSB7ICdyZXNwb25zZURhdGEgPSBlc2NhcGUocmVzcG9uc2VEYXRhKSd9KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkKGlmICgkV2hlblJlc3VsdFJlY2VpdmVkKSB7ICRXaGVuUmVzdWx0UmVjZWl2ZWQgLWpvaW4gKCc7JyArIFtFbnZpcm9ubWVudF06Ok5ld0xpbmUpICsgKCcgJyAqIDEyKSB9KSAKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIkVXBkYXRlSWQiKS4ke1VwZGF0ZVByb3BlcnR5fT0gcmVzcG9uc2VEYXRhOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkKGlmICgkdGhlblJ1bikgeyAkdGhlblJ1biAtam9pbiAoJzsnICsgW0Vudmlyb25tZW50XTo6TmV3TGluZSkgKyAoJyAnICogMTIpIH0pICAgIAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiRVcGRhdGVJZCIpLiR7VXBkYXRlUHJvcGVydHl9PSAkeG1sSHR0cFZhci5TdGF0dXM7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoJHt4bWxIdHRwVmFyfS5yZWFkeVN0YXRlICE9IDEpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIkVXBkYXRlSWQiKS4ke1VwZGF0ZVByb3BlcnR5fT0gJHhtbEh0dHBWYXIucmVhZHlTdGF0ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICQoaWYgKCRXaGVuUmVxdWVzdE1hZGUpIHsgJFdoZW5SZXF1ZXN0TWFkZSAtam9pbiAoJzsnICsgW0Vudmlyb25tZW50XTo6TmV3TGluZSkgKyAoJyAnICogMTIpIH0pIAogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgfQogICAgfQogICAgJChpZiAoJEJlZm9yZVJlcXVlc3RNYWRlKSB7ICRCZWZvcmVSZXF1ZXN0TWFkZSAtam9pbiAoJzsnICsgW0Vudmlyb25tZW50XTo6TmV3TGluZSkgKyAoJyAnICogMTIpIH0pIAogICAgCiAgICBpZiAobWV0aG9kID09ICdQT1NUJykgewogICAgICAgICR4bWxIdHRwVmFyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpOyAgICAKICAgICAgICAkeG1sSHR0cFZhci5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LXR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgJHhtbEh0dHBWYXIuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1sZW5ndGgiLCBxdWVyeURhdGEubGVuZ3RoKTsKICAgICAgICAkeG1sSHR0cFZhci5zZXRSZXF1ZXN0SGVhZGVyKCJDb25uZWN0aW9uIiwgImNsb3NlIik7CiAgICAgICAgJHhtbEh0dHBWYXIuc2VuZChxdWVyeURhdGEpOyAgICAKICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGZ1bGxVcmw7CiAgICAgICAgaWYgKHVybC5pbmRleE9mKCc/JykgIT0gLTEpIHsKICAgICAgICAgICAgZnVsbFVybCA9IHVybCArICcmJyArIHF1ZXJ5RGF0YTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmdWxsVXJsID0gdXJsICsgJz8nICsgcXVlcnlEYXRhOwogICAgICAgIH0gICAgICAgIAogICAgICAgICR4bWxIdHRwVmFyLm9wZW4obWV0aG9kLCBmdWxsVXJsLCB0cnVlKTsgICAgCiAgICAgICAgJHhtbEh0dHBWYXIuc2VuZCgpOwogICAgfSAgICAKICAgIAp9ICAgICAgICAgICAgCiJAICAgICAgICAKICAgICAgICAjZW5kcmVnaW9uIENvZGUgR2VuZXJhdGUgdGhlIEFqYXgKICAgICAgICBpZiAoJEluY2x1ZGVTY3JpcHRUYWcpIHsKICAgICAgICAgICAgQCIKPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnPgokYWpheEZ1bmN0aW9uCjwvc2NyaXB0PgoiQAogICAgICAgIH0gZWxzZSB7CiRhamF4RnVuY3Rpb24gICAgICAgICAgICAKICAgICAgICB9CiAgICB9Cn0K
