MSFT_xDisk.psm1,b15965f365a824e0ed1f7131a0c76792,Scan result is 1. IsMalware: 0,IwojIHhDb21wdXRlcjogRFNDIHJlc291cmNlIHRvIGluaXRpYWxpemUsIHBhcnRpdGlvbiwgYW5kIGZvcm1hdCBkaXNrcy4KIwoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbdWludDMyXSAkRGlza051bWJlciwKCiAgICAgICAgW3N0cmluZ10gJERyaXZlTGV0dGVyCiAgICApCgogICAgJGRpc2sgPSBHZXQtRGlzayAtTnVtYmVyICREaXNrTnVtYmVyCiAgICAkcmV0dXJuVmFsdWUgPSBAewogICAgICAgIERpc2tOdW1iZXIgPSAkZGlzay5OdW1iZXIKICAgICAgICBEcml2ZUxldHRlciA9ICRkaXNrIHwgR2V0LVBhcnRpdGlvbiB8IFdoZXJlLU9iamVjdCB7ICRfLkRyaXZlTGV0dGVyIC1uZSAiYDAiIH0gfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBEcml2ZUxldHRlcgogICAgfQogICAgJHJldHVyblZhbHVlCn0KCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbdWludDMyXSAkRGlza051bWJlciwKCiAgICAgICAgW3N0cmluZ10gJERyaXZlTGV0dGVyCiAgICApCiAgICAKICAgICRkaXNrID0gR2V0LURpc2sgLU51bWJlciAkRGlza051bWJlcgogICAgCiAgICBpZiAoJGRpc2suSXNPZmZsaW5lIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICdTZXR0aW5nIGRpc2sgT25saW5lJwogICAgICAgICRkaXNrIHwgU2V0LURpc2sgLUlzT2ZmbGluZSAkZmFsc2UKICAgIH0KICAgIAogICAgaWYgKCRkaXNrLklzUmVhZE9ubHkgLWVxICR0cnVlKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgJ1NldHRpbmcgZGlzayB0byBub3QgUmVhZE9ubHknCiAgICAgICAgJGRpc2sgfCBTZXQtRGlzayAtSXNSZWFkT25seSAkZmFsc2UKICAgIH0KICAgIAogICAgaWYgKCRkaXNrLlBhcnRpdGlvblN0eWxlIC1lcSAiUkFXIikKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJJbml0aWFsaXppbmcgZGlzayBudW1iZXIgJyQoJERpc2tOdW1iZXIpJy4uLiIKCiAgICAgICAgJGRpc2sgfCBJbml0aWFsaXplLURpc2sgLVBhcnRpdGlvblN0eWxlIEdQVCAtUGFzc1RocnUKICAgICAgICBpZiAoJERyaXZlTGV0dGVyKQogICAgICAgIHsKICAgICAgICAgICAgJHBhcnRpdGlvbiA9ICRkaXNrIHwgTmV3LVBhcnRpdGlvbiAtRHJpdmVMZXR0ZXIgJERyaXZlTGV0dGVyIC1Vc2VNYXhpbXVtU2l6ZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkcGFydGl0aW9uID0gJGRpc2sgfCBOZXctUGFydGl0aW9uIC1Bc3NpZ25Ecml2ZUxldHRlciAtVXNlTWF4aW11bVNpemUKICAgICAgICB9CgogICAgICAgICMgU29tZXRpbWVzIHRoZSBkaXNrIHdpbGwgc3RpbGwgYmUgcmVhZC1vbmx5IGFmdGVyIHRoZSBjYWxsIHRvIE5ldy1QYXJ0aXRpb24gcmV0dXJucy4KICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA1CgogICAgICAgICR2b2x1bWUgPSAkcGFydGl0aW9uIHwgRm9ybWF0LVZvbHVtZSAtRmlsZVN5c3RlbSBOVEZTIC1Db25maXJtOiRmYWxzZQoKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTdWNjZXNzZnVsbHkgaW5pdGlhbGl6ZWQgZGlzayBudW1iZXIgJyQoJERpc2tOdW1iZXIpJy4iCiAgICB9CiAgICAKICAgIGlmICgoJGRpc2sgfCBHZXQtUGFydGl0aW9uIHwgV2hlcmUtT2JqZWN0IHsgJF8uRHJpdmVMZXR0ZXIgLW5lICJgMCIgfSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IERyaXZlTGV0dGVyKSAtbmUgJERyaXZlTGV0dGVyKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIkNoYW5naW5nIGRyaXZlIGxldHRlciB0byAkRHJpdmVMZXR0ZXIiCiAgICAgICAgU2V0LVBhcnRpdGlvbiAtRGlza051bWJlciAkZGlza251bWJlciAtUGFydGl0aW9uTnVtYmVyIChHZXQtUGFydGl0aW9uIC1EaXNrICRkaXNrIHwgV2hlcmUtT2JqZWN0IHsgJF8uRHJpdmVMZXR0ZXIgLW5lICJgMCIgfSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFBhcnRpdGlvbk51bWJlcikgLU5ld0RyaXZlTGV0dGVyICRkcml2ZWxldHRlcgogICAgfQogICAgCiAgICAkZ2xvYmFsOkRTQ01hY2hpbmVTdGF0dXMgPSAxICAgIAp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKCVtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW3VpbnQzMl0gJERpc2tOdW1iZXIsCgogICAgICAgIFtzdHJpbmddICREcml2ZUxldHRlcgogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNoZWNraW5nIGlmIGRpc2sgbnVtYmVyICckKCREaXNrTnVtYmVyKScgaXMgaW5pdGlhbGl6ZWQuLi4iCiAgICAkZGlzayA9IEdldC1EaXNrIC1OdW1iZXIgJERpc2tOdW1iZXIKICAgIGlmICgtbm90ICRkaXNrKQogICAgewogICAgICAgIHRocm93ICJEaXNrIG51bWJlciAnJCgkRGlza051bWJlciknIGRvZXMgbm90IGV4aXN0LiIKICAgIH0KICAgIGlmICgkZGlzay5QYXJ0aXRpb25TdHlsZSAtbmUgIlJBVyIpCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRGlzayBudW1iZXIgJyQoJERpc2tOdW1iZXIpJyBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkLiIKCiAgICAgICAgJGRyaXZlTGV0dGVyRnJvbURpc2sgPSAkZGlzayB8IEdldC1QYXJ0aXRpb24gfCBXaGVyZS1PYmplY3QgeyAkXy5Ecml2ZUxldHRlciAtbmUgImAwIiB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgRHJpdmVMZXR0ZXIKICAgICAgICBpZiAoJERyaXZlTGV0dGVyIC1uZSAiIiAtYW5kICREcml2ZUxldHRlciAtbmUgJGRyaXZlTGV0dGVyRnJvbURpc2spCiAgICAgICAgewogICAgICAgICAgICB3cml0ZS12ZXJib3NlICJEaXNrIG51bWJlciAnJCgkRGlza051bWJlciknIGhhcyBhbiB1bmV4cGVjdGVkIGRyaXZlIGxldHRlci4gRXhwZWN0ZWQ6ICREcml2ZUxldHRlci4gQWN0dWFsOiAkZHJpdmVMZXR0ZXJGcm9tRGlzay4iCiAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICB9CiAgICAgICAgaWYgKCRkaXNrLklzT2ZmbGluZSAtZXEgJHRydWUpIAogICAgICAgIHsKICAgICAgICAgICAgd3JpdGUtdmVyYm9zZSAiRGlzayBpcyBzZXQgT2ZmbGluZS4iCiAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICB9CiAgICAgICAgaWYgKCRkaXNrLklzUmVhZE9ubHkgLWVxICR0cnVlKSAKICAgICAgICB7CiAgICAgICAgICAgIHdyaXRlLXZlcmJvc2UgIkRpc2sgaXMgc2V0IFJlYWRPbmx5LiIKICAgICAgICAgICAgcmV0dXJuICRmYWxzZQogICAgICAgIH0KICAgICAgICByZXR1cm4gJHRydWUKICAgIH0KICAgIHJldHVybiAkZmFsc2UKfQoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UK
