Script.Template.Library.ps1,3dc89b04130d3655a225b7edda88b379,Scan result is 1. IsMalware: 0,IyBTY3JpcHQuVGVtcGxhdGUuTGlicmFyeSAxLjAuMTcwNjEuNAojIAojIENvcHlyaWdodCAoQykgMjAxNi0yMDE3IGdpdGh1Yi5jb20vdHJvbmRyCiMKIyBBbGwgcmlnaHRzIHJlc2VydmVkLgojIAojIExpY2Vuc2U6IE5ldyBCU0QgKGh0dHBzOi8vZ2l0aHViLmNvbS90cm9uZHIvU2NyaXB0LlRlbXBsYXRlL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQpCgpTZXQtU3RyaWN0TW9kZSAtVmVyc2lvbiBMYXRlc3QKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojICAgRnVuY3Rpb25zCiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gRXhlY3V0ZUFjdGlvbihbc2NyaXB0YmxvY2tdJGFjdGlvbikKewogICAgJGV4aXRDb2RlID0gJiAkYWN0aW9uCgogICAgcmV0dXJuICRleGl0Q29kZQp9CgokZ2xvYmFsOnJ1bm5pbmdJbklzZUNoZWNrZWQgPSAkZmFsc2UKJGdsb2JhbDpydW5uaW5nSW5Jc2UgPSAkZmFsc2UKZnVuY3Rpb24gUnVubmluZ0luSXNlCnsKICAgIGlmKCRnbG9iYWw6cnVubmluZ0luSXNlQ2hlY2tlZCAtZXEgJGZhbHNlKQogICAgewogICAgICAgICR2YXJpYWJsZSA9IEdldC1WYXJpYWJsZSBwc0lTRSAtU2NvcGUgR2xvYmFsIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgaWYoJHZhcmlhYmxlIC1uZSAkbnVsbCkKICAgICAgICB7CiAgICAgICAgICAgICRnbG9iYWw6cnVubmluZ0luSXNlID0gJHRydWUKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJGdsb2JhbDpydW5uaW5nSW5Jc2UgPSAkZmFsc2UKICAgICAgICB9CiAgICAgICAgJGdsb2JhbDpydW5uaW5nSW5Jc2VDaGVja2VkID0gJHRydWUKICAgICAgICBXcml0ZS1WZXJib3NlICJSdW5uaW5nIGluIElTRTogJCgkZ2xvYmFsOnJ1bm5pbmdJbklzZSkiCiAgICB9CiAgICByZXR1cm4gJGdsb2JhbDpydW5uaW5nSW5Jc2UKfQoKZnVuY3Rpb24gTG9nSW5mbwp7CiAgICBwYXJhbSgkbWVzc2FnZSkKCiAgICBpZigkbG9nZ2VyLklzSW5mb0VuYWJsZWQpCiAgICB7CiAgICAgICAgaWYoUnVubmluZ0luSXNlIC1lcSAkdHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJG1lc3NhZ2UgLUJhY2tncm91bmRDb2xvciBHcmVlbiAtRm9yZWdyb3VuZENvbG9yIFdoaXRlCiAgICAgICAgfSAgICAKICAgICAgICAkbG9nZ2VyLkluZm8oJG1lc3NhZ2UpCiAgICB9ICAgIAp9CgpmdW5jdGlvbiBMb2dXYXJuaW5nCnsKICAgIHBhcmFtKCRtZXNzYWdlKQoKICAgIGlmKCRsb2dnZXIuSXNXYXJuRW5hYmxlZCkKICAgIHsKICAgICAgICBpZihSdW5uaW5nSW5Jc2UgLWVxICR0cnVlKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAkbWVzc2FnZSAtQmFja2dyb3VuZENvbG9yIFllbGxvdyAtRm9yZWdyb3VuZENvbG9yIFJlZAogICAgICAgIH0gICAgCiAgICAgICAgJGxvZ2dlci5XYXJuKCRtZXNzYWdlKQogICAgfSAgICAKfQoKZnVuY3Rpb24gTG9nRXJyb3IKewogICAgcGFyYW0oJG1lc3NhZ2UpCgogICAgaWYoJGxvZ2dlci5Jc0Vycm9yRW5hYmxlZCkKICAgIHsKICAgICAgICBpZihSdW5uaW5nSW5Jc2UgLWVxICR0cnVlKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAkbWVzc2FnZSAtQmFja2dyb3VuZENvbG9yIFJlZCAtRm9yZWdyb3VuZENvbG9yIFllbGxvdwogICAgICAgIH0gICAgCiAgICAgICAgJGxvZ2dlci5FcnJvcigkbWVzc2FnZSkKICAgIH0gICAgCn0KCmZ1bmN0aW9uIExvZ0ZhdGFsCnsKICAgIHBhcmFtKCRtZXNzYWdlKQoKICAgIGlmKCRsb2dnZXIuSXNGYXRhbEVuYWJsZWQpCiAgICB7CiAgICAgICAgaWYoUnVubmluZ0luSXNlIC1lcSAkdHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgJG1lc3NhZ2UgLUJhY2tncm91bmRDb2xvciBSZWQgLUZvcmVncm91bmRDb2xvciBZZWxsb3cKICAgICAgICB9ICAgIAogICAgICAgICRsb2dnZXIuRmF0YWwoJG1lc3NhZ2UpCiAgICB9ICAgIAp9CgpmdW5jdGlvbiBMb2dEZWJ1Zwp7CiAgICBwYXJhbSgkbWVzc2FnZSkKCiAgICBpZigkbG9nZ2VyLklzRGVidWdFbmFibGVkKQogICAgewogICAgICAgIGlmKFJ1bm5pbmdJbklzZSAtZXEgJHRydWUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICRtZXNzYWdlIC1CYWNrZ3JvdW5kQ29sb3IgQmx1ZSAtRm9yZWdyb3VuZENvbG9yIFdoaXRlCiAgICAgICAgfSAgICAKICAgICAgICAkbG9nZ2VyLkRlYnVnKCRtZXNzYWdlKQogICAgfSAgICAKfQoKJGdsb2JhbDpzY3JpcHRGb2xkZXIgPSBbU3lzdGVtLlN0cmluZ106OkVtcHR5CmZ1bmN0aW9uIEdldFNjcmlwdEZvbGRlcgp7CiAgICBpZihbU3lzdGVtLlN0cmluZ106OklzTnVsbE9yRW1wdHkoJGdsb2JhbDpzY3JpcHRGb2xkZXIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkZ2xvYmFsOnNjcmlwdEZvbGRlciA9IFNwbGl0LVBhdGggLVBhcmVudCAkZ2xvYmFsOnNjcmlwdAogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNjcmlwdEZvbGRlcj0kKCRnbG9iYWw6c2NyaXB0Rm9sZGVyKSIKICAgIH0gICAgCiAgICByZXR1cm4gJGdsb2JhbDpzY3JpcHRGb2xkZXIKfQoKJGdsb2JhbDpyZW1vdGVTY3JpcHRGb2xkZXIgPSBbU3lzdGVtLlN0cmluZ106OkVtcHR5CmZ1bmN0aW9uIEdldFJlbW90ZVNjcmlwdEZvbGRlcgp7CiAgICBpZihbU3lzdGVtLlN0cmluZ106OklzTnVsbE9yRW1wdHkoJGdsb2JhbDpyZW1vdGVTY3JpcHRGb2xkZXIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkZ2xvYmFsOnJlbW90ZVNjcmlwdEZvbGRlciA9ICRlbnY6U2NyaXB0Rm9sZGVyCiAgICAgICAgaWYoW1N5c3RlbS5TdHJpbmddOjpJc051bGxPckVtcHR5KCRnbG9iYWw6cmVtb3RlU2NyaXB0Rm9sZGVyKSAtZXEgJHRydWUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJXQVJOSU5HLiAnU2NyaXB0Rm9sZGVyJyBub3Qgc2V0IGFzIGVudmlyb25tZW50IHZhcmlhYmxlLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cgICAgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIFdyaXRlLVZlcmJvc2UgIkZyb20gRW52aXJvbm1lbnQgKFNjcmlwdEZvbGRlcik6IFJlbW90ZVNjcmlwdEZvbGRlcj0kKCRnbG9iYWw6cmVtb3RlU2NyaXB0Rm9sZGVyKSIgICAgICAgIAogICAgfQogICAgcmV0dXJuICRnbG9iYWw6cmVtb3RlU2NyaXB0Rm9sZGVyCn0KCiRnbG9iYWw6bG9jYWxTY3JpcHRGb2xkZXIgPSBbU3lzdGVtLlN0cmluZ106OkVtcHR5CmZ1bmN0aW9uIEdldExvY2FsU2NyaXB0Rm9sZGVyCnsgICAgICAgIAogICAgaWYoW1N5c3RlbS5TdHJpbmddOjpJc051bGxPckVtcHR5KCRnbG9iYWw6bG9jYWxTY3JpcHRGb2xkZXIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkZ2xvYmFsOmxvY2FsU2NyaXB0Rm9sZGVyID0gJGVudjpMb2NhbFNjcmlwdEZvbGRlcgogICAgICAgIGlmKFtTeXN0ZW0uU3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkZ2xvYmFsOmxvY2FsU2NyaXB0Rm9sZGVyKSAtZXEgJHRydWUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJXQVJOSU5HLiAnTG9jYWxTY3JpcHRGb2xkZXInIG5vdCBzZXQgYXMgZW52aXJvbm1lbnQgdmFyaWFibGUuIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdyAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRnJvbSBFbnZpcm9ubWVudCAoTG9jYWxTY3JpcHRGb2xkZXIpOiBMb2NhbFNjcmlwdEZvbGRlcj0kKCRnbG9iYWw6bG9jYWxTY3JpcHRGb2xkZXIpIgogICAgfQogICAgcmV0dXJuICRsb2NhbFNjcmlwdEZvbGRlcgp9CgokZ2xvYmFsOnNjcmlwdE5hbWUgPSBbU3lzdGVtLlN0cmluZ106OkVtcHR5CmZ1bmN0aW9uIEdldFNjcmlwdE5hbWUKewogICAgaWYoW1N5c3RlbS5TdHJpbmddOjpJc051bGxPckVtcHR5KCRnbG9iYWw6c2NyaXB0TmFtZSkgLWVxICR0cnVlKQogICAgewogICAgICAgICRnbG9iYWw6c2NyaXB0TmFtZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZpbGVOYW1lV2l0aG91dEV4dGVuc2lvbigkZ2xvYmFsOnNjcmlwdCkKICAgICAgICBXcml0ZS1WZXJib3NlICJTY3JpcHROYW1lPSQoJGdsb2JhbDpzY3JpcHROYW1lKSIgICAgCiAgICB9ICAgIAogICAgcmV0dXJuICRzY3JpcHROYW1lCn0KCiRnbG9iYWw6cmVtb3RlU2NyaXB0TmFtZSA9IFtTeXN0ZW0uU3RyaW5nXTo6RW1wdHkKZnVuY3Rpb24gR2V0UmVtb3RlU2NyaXB0TmFtZQp7CiAgICBpZihbU3lzdGVtLlN0cmluZ106OklzTnVsbE9yRW1wdHkoJGdsb2JhbDpyZW1vdGVTY3JpcHROYW1lKSAtZXEgJHRydWUpCiAgICB7CiAgICAgICAgJGdsb2JhbDpyZW1vdGVTY3JpcHROYW1lID0gJGVudjpTY3JpcHROYW1lCiAgICAgICAgaWYoW1N5c3RlbS5TdHJpbmddOjpJc051bGxPckVtcHR5KCRnbG9iYWw6cmVtb3RlU2NyaXB0TmFtZSkgLWVxICR0cnVlKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAiV0FSTklORy4gJ1NjcmlwdE5hbWUnIG5vdCBzZXQgYXMgZW52aXJvbm1lbnQgdmFyaWFibGUuIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdyAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRnJvbSBFbnZpcm9ubWVudCAoU2NyaXB0TmFtZSk6IFJlbW90ZVNjcmlwdE5hbWU9JCgkZ2xvYmFsOnJlbW90ZVNjcmlwdE5hbWUpIgogICAgfQogICAgcmV0dXJuICRnbG9iYWw6cmVtb3RlU2NyaXB0TmFtZQp9CgpmdW5jdGlvbiBMb2FkTGlicmFyeShbc3RyaW5nXSRsaWJyYXJ5RmlsZVBhdGgpCnsKICAgIGlmKCBbU3lzdGVtLklPLkZpbGVdOjpFeGlzdHMoJGxpYnJhcnlGaWxlUGF0aCkgLWVxICRmYWxzZSApCiAgICB7CiAgICAgICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBsb2FkIGxpYnJhcnkuIExpYnJhcnkgZmlsZSBub3QgZm91bmQ6ICckbGlicmFyeUZpbGVQYXRoJy4iCgkJcmV0dXJuICRudWxsCiAgICB9ICAgIAogICAgJGxpYnJhcnkgPSBbU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkRnJvbSgkbGlicmFyeUZpbGVQYXRoKQogICAgaWYoJGxpYnJhcnkgLWVxICRudWxsKQogICAgewogICAgICAgIFdyaXRlLUhvc3QgLUZvcmVncm91bmRDb2xvciBSZWQgIkZhaWxlZCB0byBsb2FkIGxpYnJhcnk6ICckbGlicmFyeVRhcmdldEZpbGVQYXRoJy4iCiAgICB9CiAgICByZXR1cm4gJGxpYnJhcnkKfQoKZnVuY3Rpb24gQ3JlYXRlRm9sZGVyKFtzdHJpbmddICRmb2xkZXIpCnsKICAgIGlmKFtzdHJpbmddOjpJc051bGxPcldoaXRlU3BhY2UoJGZvbGRlcikgLWVxICR0cnVlKQogICAgewogICAgICAgIFdyaXRlLUhvc3QgIkZhaWxlZCB0byBjcmVhdGUgZm9sZGVyLiBGb2xkZXIgJyRmb2xkZXInIGlzIG51bGwgb3IgZW1wdHkgb3Igd2hpdGUgc3BhY2UiIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkOwogICAgICAgIHJldHVybgogICAgfQogICAgaWYoW1N5c3RlbS5JTy5EaXJlY3RvcnldOjpFeGlzdHMoJGZvbGRlcikgLWVxICRmYWxzZSkKICAgIHsKICAgICAgICBXcml0ZS1Ib3N0ICJDcmVhdGluZyBmb2xkZXIgJyRmb2xkZXInIgogICAgICAgICRkaXJlY3RvcnlJbmZvID0gW1N5c3RlbS5JTy5EaXJlY3RvcnldOjpDcmVhdGVEaXJlY3RvcnkoJGZvbGRlcik7CiAgICB9Cn0KCiMkbGlicmFyeSA9IFtTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoIlN5c3RlbS5Db21wb25lbnRNb2RlbCIpCmZ1bmN0aW9uIEdldEVycm9yTWVzc2FnZShbaW50XSAkZXJyb3JDb2RlKQp7CiAgICAgJHdpbjMyRXhjZXB0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uQ29tcG9uZW50TW9kZWwuV2luMzJFeGNlcHRpb24gLUFyZ3VtZW50TGlzdCBAKCwkZXJyb3JDb2RlKQogICAgICRtZXNzYWdlID0gJHdpbjMyRXhjZXB0aW9uLk1lc3NhZ2UKICAgICByZXR1cm4gJG1lc3NhZ2UKfQoKJGdsb2JhbDptZXNzYWdlc0ZvbGRlciA9IFtTeXN0ZW0uU3RyaW5nXTo6RW1wdHkKZnVuY3Rpb24gR2V0TWVzc2FnZXNGb2xkZXIKewogICAgaWYoW1N5c3RlbS5TdHJpbmddOjpJc051bGxPckVtcHR5KCRnbG9iYWw6bWVzc2FnZXNGb2xkZXIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkc2NyaXB0Rm9sZGVyID0gR2V0U2NyaXB0Rm9sZGVyCiAgICAgICAgJGdsb2JhbDptZXNzYWdlc0ZvbGRlciA9IFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJHNjcmlwdEZvbGRlciwiTWVzc2FnZXMiKQogICAgICAgIFdyaXRlLVZlcmJvc2UgIk1lc3NhZ2VzRm9sZGVyPSQoJGdsb2JhbDptZXNzYWdlc0ZvbGRlcikiCiAgICB9ICAgIAogICAgcmV0dXJuICRnbG9iYWw6bWVzc2FnZXNGb2xkZXIKfQoKZnVuY3Rpb24gR2V0TWVzc2FnZQp7CiAgICBwYXJhbShbU3lzdGVtLkdsb2JhbGl6YXRpb24uQ3VsdHVyZUluZm9dJGN1bHR1cmUsIFtTeXN0ZW0uU3RyaW5nXSRtZXNzYWdlS2V5LCAkZGVmYXVsdE1lc3NhZ2UpCiAgICAKICAgICRvbGRDdWx0dXJlID0gW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6Q3VycmVudFRocmVhZC5DdXJyZW50Q3VsdHVyZQogICAgJG9sZFVpQ3VsdHVyZSA9IFtTeXN0ZW0uVGhyZWFkaW5nLlRocmVhZF06OkN1cnJlbnRUaHJlYWQuQ3VycmVudFVJQ3VsdHVyZQogICAgdHJ5CiAgICB7CiAgICAgICAgW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6Q3VycmVudFRocmVhZC5DdXJyZW50Q3VsdHVyZSA9ICRjdWx0dXJlCiAgICAgICAgW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6Q3VycmVudFRocmVhZC5DdXJyZW50VUlDdWx0dXJlID0gJGN1bHR1cmUgICAgICAgIAogICAgICAgICRzY3JpcHROYW1lID0gR2V0U2NyaXB0TmFtZQogICAgICAgICRtZXNzYWdlc0ZvbGRlciA9IEdldE1lc3NhZ2VzRm9sZGVyICAgICAgCiAgICAgICAgJG1lc3NhZ2VGaWxlTmFtZSA9ICAgIiQoJHNjcmlwdE5hbWUpTWVzc2FnZXMucHNkMSIKICAgICAgICBJbXBvcnQtTG9jYWxpemVkRGF0YSAtQmFzZURpcmVjdG9yeSAiJG1lc3NhZ2VzRm9sZGVyIiAtQmluZGluZ1ZhcmlhYmxlIG1lc3NhZ2VzIC1GaWxlTmFtZSAkbWVzc2FnZUZpbGVOYW1lIAogICAgICAgIGlmKCRtZXNzYWdlcy5Db250YWluc0tleSgkbWVzc2FnZUtleSkgLWVxICR0cnVlKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuICRtZXNzYWdlcy5HZXRfSXRlbSgkbWVzc2FnZUtleSkKICAgICAgICB9IAogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmKCRsb2dnZXIuSXNXYXJuRW5hYmxlZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGxvZ2dlci5XYXJuKCJVc2luZyBkZWZhbHQgbWVzc2FnZSAnJGRlZmF1bHRNZXNzYWdlJyBmb3Igbm9uIGV4aXN0aW5nIG1lc3NhZ2Uga2V5ICckbWVzc2FnZUtleSciKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkZGVmYXVsdE1lc3NhZ2UKICAgICAgICB9CiAgICB9CiAgICBmaW5hbGx5CiAgICB7CiAgICAgICBbU3lzdGVtLlRocmVhZGluZy5UaHJlYWRdOjpDdXJyZW50VGhyZWFkLkN1cnJlbnRDdWx0dXJlID0gJG9sZEN1bHR1cmUKICAgICAgIFtTeXN0ZW0uVGhyZWFkaW5nLlRocmVhZF06OkN1cnJlbnRUaHJlYWQuQ3VycmVudFVJQ3VsdHVyZSA9ICRvbGRVaUN1bHR1cmUKICAgIH0KfQoKZnVuY3Rpb24gR2V0QXBwQ29uZmlnCnsKICAgICRzY3JpcHROYW1lID0gR2V0U2NyaXB0TmFtZQogICAgJGFwcENvbmZpZyA9IFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJGdsb2JhbDpzY3JpcHRGb2xkZXIsIiQoJHNjcmlwdE5hbWUpLmNvbmZpZyIpCiAgICBXcml0ZS1WZXJib3NlICJBcHAgY29uZmlnIGZpbGU6ICRhcHBDb25maWciCiAgICByZXR1cm4gJGFwcENvbmZpZwp9CgpmdW5jdGlvbiBDb25maWd1cmVBcHBDb25maWcoKQp7CiAgICBXcml0ZS1WZXJib3NlICJDb25maWd1cmluZyBhcHAgY29uZmlnLi4uIgogICAgJGFwcENvbmZpZyA9IEdldEFwcENvbmZpZwogICAgW1N5c3RlbS5BcHBEb21haW5dOjpDdXJyZW50RG9tYWluLlNldERhdGEoIkFQUF9DT05GSUdfRklMRSIsICRhcHBDb25maWcpCn0KCmZ1bmN0aW9uIEdldExvZ0ZvbGRlcigpCnsKICAgICRzY3JpcHROYW1lID0gR2V0U2NyaXB0TmFtZQogICAgJGxvZ0ZvbGRlciA9IFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkZW52OlB1YmxpYywgIkxvZ3MiKSwgJHNjcmlwdE5hbWUpOwogICAgJHJlbW90ZVNjcmlwdEZvbGRlciA9IEdldFJlbW90ZVNjcmlwdEZvbGRlcgogICAgaWYoKCRzdG9yZUxvZ0ZpbGVzSW5QdWJsaWNMb2dzRm9sZGVyIC1lcSAkZmFsc2UpIC1hbmQgKCFbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkcmVtb3RlU2NyaXB0Rm9sZGVyKSkpCiAgICB7ICAgIAogICAgICAgICRsb2dGb2xkZXIgPSBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRyZW1vdGVTY3JpcHRGb2xkZXIsICJMb2dzIik7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJHNjcmlwdEZvbGRlciA9IEdldFNjcmlwdEZvbGRlcgogICAgICAgIGlmKCgkc3RvcmVMb2dGaWxlc0luUHVibGljTG9nc0ZvbGRlciAtZXEgJGZhbHNlKSAtYW5kICghW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHNjcmlwdEZvbGRlcikpKQogICAgICAgIHsgICAgCiAgICAgICAgICAgICRsb2dGb2xkZXIgPSBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRzY3JpcHRGb2xkZXIsICJMb2dzIik7CiAgICAgICAgfQogICAgfQogICAgaWYoIChbU3lzdGVtLklPLlBhdGhdOjpJc1BhdGhSb290ZWQoJGxvZ0ZvbGRlcikpIC1lcSAkZmFsc2UpCiAgICB7CiAgICAgICAgV3JpdGUtSG9zdCAiTG9nIGZvbGRlciAnJGxvZ0ZvbGRlcicgaXMgbm90IGEgZnVsbCBwYXRoLiIgIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkCiAgICAgICAgdGhyb3cgW1N5c3RlbS5JTy5EaXJlY3RvcnlOb3RGb3VuZEV4Y2VwdGlvbl0gIkRpcmVjdG9yeSBub3QgZm91bmQ6ICRsb2dGb2xkZXIiCiAgICB9CiAgICBDcmVhdGVGb2xkZXIgJGxvZ0ZvbGRlcjsgIAogICAgcmV0dXJuICRsb2dGb2xkZXI7Cn0KCmZ1bmN0aW9uIEdldExvZ0ZpbGUoKQp7CiAgICAkbG9nRm9sZGVyID0gR2V0TG9nRm9sZGVyCiAgICAkdXNlck5hbWUgPSAkZW52OlVTRVJOQU1FCiAgICAkc2NyaXB0TmFtZSA9IEdldFNjcmlwdE5hbWUKICAgICRsb2dGaWxlID0gW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkbG9nRm9sZGVyLCAiJHNjcmlwdE5hbWUtJHVzZXJOYW1lLmxvZyIpOwogICAgV3JpdGUtSG9zdCAiTG9nIGZpbGU6ICRsb2dGaWxlIgogICAgcmV0dXJuICRsb2dGaWxlOwp9CgpmdW5jdGlvbiBHZXRMb2c0TmV0RGxsCnsKICAgICRzY3JpcHRGb2xkZXIgPSBHZXRTY3JpcHRGb2xkZXIKICAgICRsb2c0TmV0RGxsID0gW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZShbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRzY3JpcHRGb2xkZXIsIkxpYnMiKSwibG9nNG5ldC5kbGwiKQogICAgV3JpdGUtVmVyYm9zZSAibG9nNE5ldERsbDogJGxvZzROZXREbGwiCiAgICByZXR1cm4gJGxvZzROZXREbGwKfQoKZnVuY3Rpb24gQ29uZmlndXJlTG9nZ2luZwp7CiAgICBXcml0ZS1WZXJib3NlICJDb25maWd1cmluZyBsb2dnaW5nLi4uIjsKICAgICRsb2c0TmV0RGxsID0gR2V0TG9nNE5ldERsbAogICAgJGxpYnJhcnkgPSBMb2FkTGlicmFyeSAkbG9nNE5ldERsbAogICAgaWYoJGxpYnJhcnkgLWVxICRudWxsKQogICAgewogICAgICAgIFdyaXRlLUhvc3QgIkZhaWxlZCB0byBsb2FkIGxvZzRuZXQuZGxsIiAtRm9yZWdyb3VuZENvbG9yIFJlZAogICAgICAgIGV4aXQgMQogICAgfSAgICAKICAgICRsb2dGaWxlID0gR2V0TG9nRmlsZQogICAgW2xvZzRuZXQuR2xvYmFsQ29udGV4dF06OlByb3BlcnRpZXNbIkxvZ0ZpbGUiXSA9ICRsb2dGaWxlOyAgICAKICAgICRhcHBDb25maWcgPSBHZXRBcHBDb25maWcKICAgICR4bWxDb25maWd1cmF0b3IgPSBbbG9nNG5ldC5Db25maWcuWG1sQ29uZmlndXJhdG9yXTo6Q29uZmlndXJlQW5kV2F0Y2goJGFwcENvbmZpZyk7CiAgICAkbG9nTWFuYWdlciA9IFtsb2c0bmV0LkxvZ01hbmFnZXJdCiAgICAkc2NyaXB0TmFtZSA9IEdldFNjcmlwdE5hbWUKICAgICRnbG9iYWw6bG9nZ2VyID0gJGxvZ01hbmFnZXI6OkdldExvZ2dlcigiJHNjcmlwdE5hbWUiKTsKfQoKZnVuY3Rpb24gQ29uZmlndXJlCnsKICAgIENvbmZpZ3VyZUFwcENvbmZpZwogICAgQ29uZmlndXJlTG9nZ2luZwp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyAgIENvbmZpZ3VyZSBzY3JpcHQKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpDb25maWd1cmUKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojICAgTG9hZCB1c2VyIHNjcmlwdCBsaWJyYXJ5CiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpXcml0ZS1WZXJib3NlICJMb2FkaW5nIHVzZXIgc2NyaXB0IGxpYnJhcnkuLi4iOwokc2NyaXB0Rm9sZGVyID0gR2V0U2NyaXB0Rm9sZGVyCiRzY3JpcHROYW1lID0gR2V0U2NyaXB0TmFtZQokc2NyaXB0TGlicmFyeSA9IFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJHNjcmlwdEZvbGRlciAsIiQoJHNjcmlwdE5hbWUpTGlicmFyeS5wczEiKQppZigoVGVzdC1QYXRoICRzY3JpcHRMaWJyYXJ5KSAtZXEgJGZhbHNlKQp7CiAgICBXcml0ZS1Ib3N0IC1Gb3JlZ3JvdW5kQ29sb3IgUmVkICJTY3JpcHQgbGlicmFyeSAnJHNjcmlwdExpYnJhcnknIG5vdCBmb3VuZC4iCiAgICBFWElUIDEKfQpXcml0ZS1WZXJib3NlICJTY3JpcHRMaWJyYXJ5PSRzY3JpcHRMaWJyYXJ5IgpXcml0ZS1WZXJib3NlICJMb2FkaW5nIHNjcmlwdCBsaWJyYXJ5ICckc2NyaXB0TGlicmFyeScuLi4iCi4gJHNjcmlwdExpYnJhcnkKSWYgKCQ/IC1lcSAkZmFsc2UpIAp7IAogICAgV3JpdGUtSG9zdCAtRm9yZWdyb3VuZENvbG9yIFJlZCAiRmFpbGVkIHRvIGxvYWQgbGlicmFyeSAnJHNjcmlwdExpYnJhcnknLiBFcnJvcjogJCgkZXJyb3JbMF0pIjsgYnJlYWsgCiAgICBFWElUIDEKfTsKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojICAgUnVuIHVzZXIgc2NyaXB0CiMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpXcml0ZS1WZXJib3NlICJFeGVjdXRpbmcgdXNlciBzY3JpcHQsIFJ1bigpLi4uIjsKV3JpdGUtVmVyYm9zZSAiQ0xSIHJ1bnRpbWUgdmVyc2lvbjogJChbU3lzdGVtLkVudmlyb25tZW50XTo6VmVyc2lvbikiOwokY29tbWFuZExpbmUgPSBbU3lzdGVtLkVudmlyb25tZW50XTo6Q29tbWFuZExpbmUKTG9nSW5mbyAiU3RhcnQ6ICRzY3JpcHROYW1lICRzY3JpcHRWZXJzaW9uIENvbW1hbmQgbGluZTogJGNvbW1hbmRMaW5lIgoKJGdsb2JhbDpzY3JpcHRFeGl0Q29kZSA9IEV4ZWN1dGVBY3Rpb24oW3NjcmlwdGJsb2NrXSRmdW5jdGlvbjpSdW4pCgokc3VjY2Vzc0V4aXRDb2RlID0gW2ludF0wCiRleHBlY3RlZEV4aXRDb2RlVHlwZSA9ICRzdWNjZXNzRXhpdENvZGUuR2V0VHlwZSgpCiRleGl0Q29kZVR5cGUgPSAkc2NyaXB0RXhpdENvZGUuR2V0VHlwZSgpCmlmKCRleGl0Q29kZVR5cGUuTmFtZSAtZXEgJGV4cGVjdGVkRXhpdENvZGVUeXBlLk5hbWUpCnsKICAgICRlcnJvck1lc3NhZ2UgPSBHZXRFcnJvck1lc3NhZ2UoJHNjcmlwdEV4aXRDb2RlKSAgICAKICAgIExvZ0luZm8gIlN0b3A6ICRzY3JpcHROYW1lICRzY3JpcHRWZXJzaW9uIEV4aXQgY29kZTogJHNjcmlwdEV4aXRDb2RlICgkZXJyb3JNZXNzYWdlKSIKfQplbHNlCnsKICAgICRnbG9iYWw6c2NyaXB0RXhpdENvZGUgPSAxCiAgICAkZXJyb3JNZXNzYWdlID0gIlRoZSBSdW4oKSBmdW5jdGlvbiBkaWQgbm90IHJldHVybiBhbiBleGl0IGNvZGUgb2YgdHlwZSBTeXN0ZW0uSW50MzIuIFBsZWFzZSBtYWtlIHN1cmUgdGhhdCBhbnkgY29kZSBsaW5lcyBpbiBSdW4oKSBmdW5jdGlvbiBpcyBub3QgcmV0dXJuaW5nICckZXhpdENvZGVUeXBlJyBhbmQgdGhlcmUgYnkgaW50ZXJjZXB0cyB0aGUgcmV0dXJuIHN0YXRlbWVudC4iCiAgICBMb2dFcnJvciAiU3RvcDogJHNjcmlwdE5hbWUgJHNjcmlwdFZlcnNpb24gRXhpdCBjb2RlOiAkc2NyaXB0RXhpdENvZGUgKCRlcnJvck1lc3NhZ2UpIgp9CldyaXRlLVZlcmJvc2UgIkZpbmlzaGVkIGV4ZWN1dGluZyB1c2VyIHNjcmlwdCwgUnVuKCkuIjs=
