Functions-Nssm.tests.ps1,bd60c14efd34f04aa470e41f9765d28a,Scan result is 1. IsMalware: 0,JGhlcmUgPSBTcGxpdC1QYXRoIC1QYXJlbnQgJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuUGF0aAokc3V0ID0gKFNwbGl0LVBhdGggLUxlYWYgJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuUGF0aCkgLWlyZXBsYWNlICJ0ZXN0cy4iLCAiIgouICIkaGVyZVwkc3V0IgoKLiAiJGN1cnJlbnREaXJlY3RvcnlQYXRoXF9GaW5kLVJvb3REaXJlY3RvcnkucHMxIgokcm9vdERpcmVjdG9yeSA9IEZpbmQtUm9vdERpcmVjdG9yeSAkaGVyZQoKZnVuY3Rpb24gR2V0LVVuaXF1ZVRlc3RXb3JraW5nRGlyZWN0b3J5CnsKICAgICR0ZW1wRGlyZWN0b3J5TmFtZSA9IFtEYXRlVGltZV06OlV0Y05vdy5Ub1N0cmluZygieXl5eU1NZGRISG1tc3NmZiIpCiAgICByZXR1cm4gIiRoZXJlXHRlc3Qtd29ya2luZ1wkdGVtcERpcmVjdG9yeU5hbWUiCn0KCkRlc2NyaWJlICJHZXQtTnNzbUV4ZWN1dGFibGUiIHsKICAgIENvbnRleHQgIldoZW4gZnVuY3Rpb24gZXhlY3V0ZWQiIHsKICAgICAgICBJdCAiUmV0dXJucyB2YWxpZCBleGVjdXRhYmxlIiB7CiAgICAgICAgICAgICRleGVjdXRhYmxlID0gR2V0LU51R2V0RXhlY3V0YWJsZQoKICAgICAgICAgICAgJGV4ZWN1dGFibGUuRnVsbE5hbWUgfCBTaG91bGQgTWF0Y2ggIm5zc20uXC5leGUiCiAgICAgICAgICAgICRleGVjdXRhYmxlLkZ1bGxOYW1lIHwgU2hvdWxkIEV4aXN0CiAgICAgICAgfQogICAgfQp9CgpEZXNjcmliZSAiTnNzbS1JbnN0YWxsIiB7CiAgICBCZWZvcmVFYWNoIHsKICAgICAgICAkd29ya2luZ0RpcmVjdG9yeVBhdGggPSBHZXQtVW5pcXVlVGVzdFdvcmtpbmdEaXJlY3RvcnkKICAgIH0KCiAgICBDb250ZXh0ICJXaGVuIGluc3RhbGxpbmcgYSB2YWxpZCBwcm9ncmFtIGFuZCBzcGVjaWZ5aW5nIHRoZSBtYXggbG9nIGZpbGUgc2l6ZSBhcyAxS0IiIHsKICAgICAgICBJdCAiTG9nIGRpcmVjdG9yeSBjb250YWlucyBtdWx0aXBsZSBmaWxlcyBhZnRlciBzZXJ2aWNlIGhhcyBiZWVuIHJ1bm5pbmcgZm9yIDYwIHNlY29uZHMiIHsKICAgICAgICAgICAgI1JlcXVpcmVzIC1SdW5Bc0FkbWluaXN0cmF0b3IKICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc2VydmljZU5hbWUgPSAiVCQoW0RhdGVUaW1lXTo6VXRjTm93LlRvU3RyaW5nKCJ5eXl5TU1kZEhIbW1zc2ZmIikpIgoKICAgICAgICAgICAgICAgICRwcm9ncmFtID0gInBvd2Vyc2hlbGwgLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUNvbW1hbmQgd2hpbGUgKGAkdHJ1ZSkgeyBXcml0ZS1PdXRwdXQgYCJUaGlzIGlzIGFuIGluZmluaXRlIGxvb3AuYCIgfSIKICAgICAgICAgICAgICAgICRleGVjdXRhYmxlID0gTmV3LUl0ZW0gLUl0ZW1UeXBlIEZpbGUgLVBhdGggIiR3b3JraW5nRGlyZWN0b3J5UGF0aFwkc2VydmljZU5hbWUuYmF0IiAtRm9yY2UKICAgICAgICAgICAgICAgIFNldC1Db250ZW50IC1QYXRoICRleGVjdXRhYmxlLkZ1bGxOYW1lIC1WYWx1ZSAkcHJvZ3JhbQoKICAgICAgICAgICAgICAgICRsb2dzRGlyZWN0b3J5ID0gIiR3b3JraW5nRGlyZWN0b3J5UGF0aFxsb2dzIgogICAgICAgICAgICAgICAgJG1heExvZ0ZpbGVTaXplID0gMTAwMAoKICAgICAgICAgICAgICAgIE5zc20tSW5zdGFsbCAtU2VydmljZSAkc2VydmljZU5hbWUgLVByb2dyYW0gJGV4ZWN1dGFibGUgLW1heExvZ0ZpbGVTaXplQnl0ZXNCZWZvcmVSb3RhdGlvbiAkbWF4TG9nRmlsZVNpemUgLURJX0xvZ0ZpbGVzRGlyZWN0b3J5ICRsb2dzRGlyZWN0b3J5CgogICAgICAgICAgICAgICAgJHNlcnZpY2UgPSBHZXQtU2VydmljZSAkc2VydmljZU5hbWUKICAgICAgICAgICAgICAgICRzZXJ2aWNlLlN0YXJ0KCkKICAgICAgICAgICAgICAgICRzZXJ2aWNlLldhaXRGb3JTdGF0dXMoIlJ1bm5pbmciLCBbVGltZVNwYW5dOjpGcm9tU2Vjb25kcygzMCkpCgogICAgICAgICAgICAgICAgU2xlZXAgLVNlY29uZHMgMQoKICAgICAgICAgICAgICAgICRzZXJ2aWNlLlN0b3AoKQogICAgICAgICAgICAgICAgJHNlcnZpY2UuV2FpdEZvclN0YXR1cygiU3RvcHBlZCIsIFtUaW1lU3Bhbl06OkZyb21TZWNvbmRzKDMwKSkKCiAgICAgICAgICAgICAgICAkbG9nRmlsZXMgPSBHZXQtQ2hpbGRJdGVtICRsb2dzRGlyZWN0b3J5IC1SZWN1cnNlIC1GaWxlCiAgICAgICAgICAgICAgICAjIFRoaXMgaXMgYSBiaXQgb2YgYSBoYWNreSBjaGVjaywgYnV0IGl0IGJhc2ljYWxseSBwcm92ZXMgdGhhdCB0aGUgbG9nIGZpbGUgcm90YXRpb24gaXMgd29ya2luZyBhcyBleHBlY3RlZC4KICAgICAgICAgICAgICAgICRsb2dGaWxlcy5MZW5ndGggLWd0IDEgfCBTaG91bGQgQmUgJHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgICBmaW5hbGx5CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRzZXJ2aWNlID0gR2V0LVNlcnZpY2UgLU5hbWUgJHNlcnZpY2VOYW1lCiAgICAgICAgICAgICAgICAgICAgaWYgKCRzZXJ2aWNlIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2VydmljZS5TdGF0dXMgLWVxICJSdW5uaW5nIikKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNlcnZpY2UuU3RvcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2VydmljZS5XYWl0Rm9yU3RhdHVzKCJTdG9wcGVkIiwgW1RpbWVTcGFuXTo6RnJvbVNlY29uZHMoMzApKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIE5zc20tUmVtb3ZlICRzZXJ2aWNlTmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiQ291bGQgbm90IGRldGVjdCBleGlzdGluZyBzZXJ2aWNlLiBDaGVjayB0aGUgZm9sbG93aW5nIHRleHQgdG8gc2VlIGlmIGl0cyBzb21lIHNvcnQgb2YgYWNjZXNzIGlzc3VlLiIKICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICRfCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgQWZ0ZXJFYWNoIHsKICAgICAgICBpZiAoW1N5c3RlbS5JTy5EaXJlY3RvcnldOjpFeGlzdHMoJHdvcmtpbmdEaXJlY3RvcnlQYXRoKSkKICAgICAgICB7CiAgICAgICAgICAgIFtTeXN0ZW0uSU8uRGlyZWN0b3J5XTo6RGVsZXRlKCR3b3JraW5nRGlyZWN0b3J5UGF0aCwgJHRydWUpCiAgICAgICAgfQogICAgfQp9
