MSFT_xSPDistributedCacheService.psm1,cbc6eb02ff9008f29599e786e1f95b38,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtTeXN0ZW0uU3RyaW5nXSAgJE5hbWUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICBbU3lzdGVtLlVJbnQzMl0gICRDYWNoZVNpemVJbk1CLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1N5c3RlbS5TdHJpbmddICAkU2VydmljZUFjY291bnQsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICBbU3lzdGVtLkJvb2xlYW5dICRDcmVhdGVGaXJld2FsbFJ1bGVzLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildIFtTeXN0ZW0uU3RyaW5nXSAkRW5zdXJlLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSAkSW5zdGFsbEFjY291bnQgICAgICAgIAogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkdldHRpbmcgdGhlIGNhY2hlIGhvc3QgaW5mb3JtYXRpb24iCiAgICAKICAgICRyZXN1bHQgPSBJbnZva2UteFNoYXJlUG9pbnRDb21tYW5kIC1DcmVkZW50aWFsICRJbnN0YWxsQWNjb3VudCAtQXJndW1lbnRzICRQU0JvdW5kUGFyYW1ldGVycyAtU2NyaXB0QmxvY2sgewogICAgICAgICRwYXJhbXMgPSAkYXJnc1swXQogICAgICAgICRudWxsUmV0dXJuVmFsdWUgPSBAewogICAgICAgICAgICBOYW1lID0gJHBhcmFtcy5OYW1lCiAgICAgICAgICAgIEVuc3VyZSA9ICJBYnNlbnQiCiAgICAgICAgICAgIEluc3RhbGxBY2NvdW50ID0gJHBhcmFtcy5JbnN0YWxsQWNjb3VudAogICAgICAgIH0KCiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICBVc2UtQ2FjaGVDbHVzdGVyIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgICAgICRjYWNoZUhvc3QgPSBHZXQtQ2FjaGVIb3N0IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgogICAgICAgICAgICBpZiAoJG51bGwgLWVxICRjYWNoZUhvc3QpIHsgcmV0dXJuICRudWxsUmV0dXJuVmFsdWUgfQogICAgICAgICAgICAkY29tcHV0ZXJOYW1lID0gKFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RCeU5hbWUoJGVudjpjb21wdXRlck5hbWUpKS5Ib3N0TmFtZQogICAgICAgICAgICAkY2FjaGVIb3N0Q29uZmlnID0gR2V0LUFGQ2FjaGVIb3N0Q29uZmlndXJhdGlvbiAtQ29tcHV0ZXJOYW1lICRjb21wdXRlck5hbWUgLUNhY2hlUG9ydCAoJGNhY2hlSG9zdCB8IFdoZXJlLU9iamVjdCB7ICRfLkhvc3ROYW1lIC1lcSAkY29tcHV0ZXJOYW1lIH0pLlBvcnRObyAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQoKICAgICAgICAgICAgJHdpbmRvd3NTZXJ2aWNlID0gR2V0LVdtaU9iamVjdCAid2luMzJfc2VydmljZSIgLUZpbHRlciAiTmFtZT0nQXBwRmFicmljQ2FjaGluZ1NlcnZpY2UnIgogICAgICAgICAgICAkZmlyZXdhbGxSdWxlID0gR2V0LU5ldEZpcmV3YWxsUnVsZSAtRGlzcGxheU5hbWUgIlNoYXJlUG9pbnQgRGlzdHJpYnV0ZWQgQ2FjaGUiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgogICAgICAgICAgICByZXR1cm4gQHsKICAgICAgICAgICAgICAgIE5hbWUgPSAkcGFyYW1zLk5hbWUKICAgICAgICAgICAgICAgIENhY2hlU2l6ZUluTUIgPSAkY2FjaGVIb3N0Q29uZmlnLlNpemUKICAgICAgICAgICAgICAgIFNlcnZpY2VBY2NvdW50ID0gJHdpbmRvd3NTZXJ2aWNlLlN0YXJ0TmFtZQogICAgICAgICAgICAgICAgQ3JlYXRlRmlyZXdhbGxSdWxlcyA9ICgkZmlyZXdhbGxSdWxlIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgIEVuc3VyZSA9ICJQcmVzZW50IgogICAgICAgICAgICAgICAgSW5zdGFsbEFjY291bnQgPSAkcGFyYW1zLkluc3RhbGxBY2NvdW50CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICByZXR1cm4gJG51bGxSZXR1cm5WYWx1ZQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcmVzdWx0Cn0KCgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICBbU3lzdGVtLlN0cmluZ10gICROYW1lLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1N5c3RlbS5VSW50MzJdICAkQ2FjaGVTaXplSW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtTeXN0ZW0uU3RyaW5nXSAgJFNlcnZpY2VBY2NvdW50LAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1N5c3RlbS5Cb29sZWFuXSAkQ3JlYXRlRmlyZXdhbGxSdWxlcywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXSBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCgogICAgJEN1cnJlbnRTdGF0ZSA9IEdldC1UYXJnZXRSZXNvdXJjZSBAUFNCb3VuZFBhcmFtZXRlcnMKCiAgICBpZiAoJEVuc3VyZSAtZXEgIlByZXNlbnQiKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiQWRkaW5nIHRoZSBkaXN0cmlidXRlZCBjYWNoZSB0byB0aGUgc2VydmVyIgogICAgICAgIGlmKCRjcmVhdGVGaXJld2FsbFJ1bGVzIC1lcSAkdHJ1ZSkgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJDcmVhdGUgYSBmaXJld2FsbCBydWxlIGZvciBBcHBGYWJyaWMiCiAgICAgICAgICAgIEludm9rZS14U2hhcmVQb2ludENvbW1hbmQgLUNyZWRlbnRpYWwgJEluc3RhbGxBY2NvdW50IC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgICAgICAkaWNtcEZpcmV3YWxsUnVsZSA9IEdldC1OZXRGaXJld2FsbFJ1bGUgLURpc3BsYXlOYW1lICJGaWxlIGFuZCBQcmludGVyIFNoYXJpbmcgKEVjaG8gUmVxdWVzdCAtIElDTVB2NC1JbikiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgICAgICAgICBpZigkbnVsbCAtZXEgJGljbXBGaXJld2FsbFJ1bGUgKSB7CiAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSAtTmFtZSBBbGxvd19QaW5nIC1EaXNwbGF5TmFtZSAiRmlsZSBhbmQgUHJpbnRlciBTaGFyaW5nIChFY2hvIFJlcXVlc3QgLSBJQ01QdjQtSW4pIiAtRGVzY3JpcHRpb24gIkFsbG93IElDTVB2NCBwaW5nIiAtUHJvdG9jb2wgSUNNUHY0IC1JY21wVHlwZSA4IC1FbmFibGVkIFRydWUgLVByb2ZpbGUgQW55IC1BY3Rpb24gQWxsb3cgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBFbmFibGUtTmV0RmlyZXdhbGxSdWxlIC1EaXNwbGF5TmFtZSAiRmlsZSBhbmQgUHJpbnRlciBTaGFyaW5nIChFY2hvIFJlcXVlc3QgLSBJQ01QdjQtSW4pIgoKICAgICAgICAgICAgICAgICRmaXJld2FsbFJ1bGUgPSBHZXQtTmV0RmlyZXdhbGxSdWxlIC1EaXNwbGF5TmFtZSAiU2hhcmVQb2ludCBEaXN0cmlidXRlZCBDYWNoZSIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAgICAgICAgIGlmKCRudWxsIC1lcSAkZmlyZXdhbGxSdWxlKSB7CiAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSAtTmFtZSAiU1BEaXN0Q2FjaGUiIC1EaXNwbGF5TmFtZSAiU2hhcmVQb2ludCBEaXN0cmlidXRlZCBDYWNoZSIgLVByb3RvY29sIFRDUCAtTG9jYWxQb3J0IDIyMjMzLTIyMjM2IC1Hcm91cCAiU2hhcmVQb2ludCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEVuYWJsZS1OZXRGaXJld2FsbFJ1bGUgLURpc3BsYXlOYW1lICJTaGFyZVBvaW50IERpc3RyaWJ1dGVkIENhY2hlIgogICAgICAgICAgICB9CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkZpcmV3YWxsIHJ1bGUgYWRkZWQiCiAgICAgICAgfQogICAgICAgIFdyaXRlLVZlcmJvc2UgIkN1cnJlbnQgc3RhdGUgaXMgJyQoJEN1cnJlbnRTdGF0ZS5FbnN1cmUpJyBhbmQgZGVzaXJlZCBzdGF0ZSBpcyAnJEVuc3VyZSciCiAgICAgICAgaWYgKCRDdXJyZW50U3RhdGUuRW5zdXJlIC1uZSAkRW5zdXJlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkVuYWJsaW5nIGRpc3RyaWJ1dGVkIGNhY2hlIHNlcnZpY2UiCiAgICAgICAgICAgIEludm9rZS14U2hhcmVQb2ludENvbW1hbmQgLUNyZWRlbnRpYWwgJEluc3RhbGxBY2NvdW50IC1Bcmd1bWVudHMgJFBTQm91bmRQYXJhbWV0ZXJzIC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgICAgICAkcGFyYW1zID0gJGFyZ3NbMF0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgQWRkLVNQRGlzdHJpYnV0ZWRDYWNoZVNlcnZpY2VJbnN0YW5jZQoKICAgICAgICAgICAgICAgIEdldC1TUFNlcnZpY2VJbnN0YW5jZSB8IFdoZXJlLU9iamVjdCB7ICRfLlR5cGVOYW1lIC1lcSAiRGlzdHJpYnV0ZWQgQ2FjaGUiIH0gfCBTdG9wLVNQU2VydmljZUluc3RhbmNlIC1Db25maXJtOiRmYWxzZQoKICAgICAgICAgICAgICAgICRjb3VudCA9IDAKICAgICAgICAgICAgICAgICRtYXhDb3VudCA9IDMwCiAgICAgICAgICAgICAgICB3aGlsZSAoKCRjb3VudCAtbHQgJG1heENvdW50KSAtYW5kICgoR2V0LVNQU2VydmljZUluc3RhbmNlIHwgPyB7ICRfLlR5cGVOYW1lIC1lcSAiRGlzdHJpYnV0ZWQgQ2FjaGUiIC1hbmQgJF8uU3RhdHVzIC1uZSAiRGlzYWJsZWQiIH0pIC1uZSAkbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA2MAogICAgICAgICAgICAgICAgICAgICRjb3VudCsrCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgVXBkYXRlLVNQRGlzdHJpYnV0ZWRDYWNoZVNpemUgLUNhY2hlU2l6ZUluTUIgJHBhcmFtcy5DYWNoZVNpemVJbk1CCgogICAgICAgICAgICAgICAgR2V0LVNQU2VydmljZUluc3RhbmNlIHwgV2hlcmUtT2JqZWN0IHsgJF8uVHlwZU5hbWUgLWVxICJEaXN0cmlidXRlZCBDYWNoZSIgfSB8IFN0YXJ0LVNQU2VydmljZUluc3RhbmNlIAoKICAgICAgICAgICAgICAgICRjb3VudCA9IDAKICAgICAgICAgICAgICAgICRtYXhDb3VudCA9IDMwCiAgICAgICAgICAgICAgICB3aGlsZSAoKCRjb3VudCAtbHQgJG1heENvdW50KSAtYW5kICgoR2V0LVNQU2VydmljZUluc3RhbmNlIHwgPyB7ICRfLlR5cGVOYW1lIC1lcSAiRGlzdHJpYnV0ZWQgQ2FjaGUiIC1hbmQgJF8uU3RhdHVzIC1uZSAiT25saW5lIiB9KSAtbmUgJG51bGwpKSB7CiAgICAgICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKICAgICAgICAgICAgICAgICAgICAkY291bnQrKwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRmYXJtID0gR2V0LVNQRmFybQogICAgICAgICAgICAgICAgJGNhY2hlU2VydmljZSA9ICRmYXJtLlNlcnZpY2VzIHwgV2hlcmUtT2JqZWN0IHsgJF8uTmFtZSAtZXEgIkFwcEZhYnJpY0NhY2hpbmdTZXJ2aWNlIiB9CgogICAgICAgICAgICAgICAgaWYgKCRjYWNoZVNlcnZpY2UuUHJvY2Vzc0lkZW50aXR5Lk1hbmFnZWRBY2NvdW50LlVzZXJuYW1lIC1uZSAkcGFyYW1zLlNlcnZpY2VBY2NvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgJGNhY2hlU2VydmljZS5Qcm9jZXNzSWRlbnRpdHkuQ3VycmVudElkZW50aXR5VHlwZSA9ICJTcGVjaWZpY1VzZXIiCiAgICAgICAgICAgICAgICAgICAgJGFjY291bnQgPSBHZXQtU1BNYW5hZ2VkQWNjb3VudCAtSWRlbnRpdHkgJHBhcmFtcy5TZXJ2aWNlQWNjb3VudAogICAgICAgICAgICAgICAgICAgICRjYWNoZVNlcnZpY2UuUHJvY2Vzc0lkZW50aXR5Lk1hbmFnZWRBY2NvdW50ID0gJGFjY291bnQKICAgICAgICAgICAgICAgICAgICAkY2FjaGVTZXJ2aWNlLlByb2Nlc3NJZGVudGl0eS5VcGRhdGUoKSAKICAgICAgICAgICAgICAgICAgICAkY2FjaGVTZXJ2aWNlLlByb2Nlc3NJZGVudGl0eS5EZXBsb3koKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJSZW1vdmluZyBkaXN0cmlidXRlZCBjYWNoZSB0byB0aGUgc2VydmVyIgogICAgICAgIEludm9rZS14U2hhcmVQb2ludENvbW1hbmQgLUNyZWRlbnRpYWwgJEluc3RhbGxBY2NvdW50IC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgICRzZXJ2aWNlSW5zdGFuY2UgPSBHZXQtU1BTZXJ2aWNlSW5zdGFuY2UgfCBXaGVyZS1PYmplY3QgeyAoJF8uU2VydmljZS5Ub3N0cmluZygpKSAtZXEgIlNQRGlzdHJpYnV0ZWRDYWNoZVNlcnZpY2UgTmFtZT1BcHBGYWJyaWNDYWNoaW5nU2VydmljZSIgLWFuZCAoJF8uU2VydmVyLk5hbWUpIC1lcSAkZW52OmNvbXB1dGVybmFtZSB9CiAgICAgICAgICAgICRzZXJ2aWNlSW5zdGFuY2UuRGVsZXRlKCkgCiAgICAgICAgICAgIAogICAgICAgICAgICBSZW1vdmUtU1BEaXN0cmlidXRlZENhY2hlU2VydmljZUluc3RhbmNlCiAgICAgICAgfQogICAgICAgIGlmICgkQ3JlYXRlRmlyZXdhbGxSdWxlcyAtZXEgJHRydWUpIHsKICAgICAgICAgICAgSW52b2tlLXhTaGFyZVBvaW50Q29tbWFuZCAtQ3JlZGVudGlhbCAkSW5zdGFsbEFjY291bnQgLVNjcmlwdEJsb2NrIHsKICAgICAgICAgICAgICAgICRmaXJld2FsbFJ1bGUgPSBHZXQtTmV0RmlyZXdhbGxSdWxlIC1EaXNwbGF5TmFtZSAiU2hhcmVQb2ludCBEaXN0cmlidXRlIENhY2hlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgICAgICAgICAgaWYoJG51bGwgLW5lICRmaXJld2FsbFJ1bGUpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJEaXNhYmxpbmcgZmlyZXdhbGwgcnVsZXMuIgogICAgICAgICAgICAgICAgICAgIERpc2FibGUtTmV0RmlyZXdhbGxSdWxlIC1EaXNwbGF5TmFtZSAiU2hhcmVQb2ludCBEaXN0cmlidXRlIENhY2hlIiAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAgCiAgICAgICAgfQogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkRpc3RyaWJ1dGVkIGNhY2hlIHJlbW92ZWQuIgogICAgfQp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICBbU3lzdGVtLlN0cmluZ10gICROYW1lLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1N5c3RlbS5VSW50MzJdICAkQ2FjaGVTaXplSW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtTeXN0ZW0uU3RyaW5nXSAgJFNlcnZpY2VBY2NvdW50LAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXSAgW1N5c3RlbS5Cb29sZWFuXSAkQ3JlYXRlRmlyZXdhbGxSdWxlcywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXSBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCgogICAgJEN1cnJlbnRWYWx1ZXMgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJUZXN0aW5nIGZvciBkaXN0cmlidXRlZCBjYWNoZSBjb25maWd1cmF0aW9uIgogICAgcmV0dXJuIFRlc3QteFNoYXJlUG9pbnRTcGVjaWZpY1BhcmFtZXRlcnMgLUN1cnJlbnRWYWx1ZXMgJEN1cnJlbnRWYWx1ZXMgLURlc2lyZWRWYWx1ZXMgJFBTQm91bmRQYXJhbWV0ZXJzIC1WYWx1ZXNUb0NoZWNrIEAoIkVuc3VyZSIsICJDcmVhdGVGaXJld2FsbFJ1bGVzIikKfQoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UKCg==
