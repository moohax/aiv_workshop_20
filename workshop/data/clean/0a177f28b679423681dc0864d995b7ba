renum-v0.4.ps1,8be96355db69d384f142b1d8dcfa5dda,Scan result is 1. IsMalware: 0,cGFyYW0oCiAgICBbc3RyaW5nXSRHbG9iYWw6UkVNT1RFX0hPU1QsCiAgICBbc3RyaW5nXSR1c2VyLAogICAgW3N3aXRjaF0kc2hlbGwsCiAgICBbc3dpdGNoXSRhcnAsCiAgICBbc3dpdGNoXSRpcGNmZywKICAgIFtzd2l0Y2hdJHJvdXRlLAogICAgW3N3aXRjaF0kY29ubnMsCiAgICBbc3dpdGNoXSRwcm9jcywKICAgIFtzd2l0Y2hdJHVzZXJzLAogICAgW3N3aXRjaF0kYWNjb3VudHMsCiAgICBbc3dpdGNoXSR1c2JlbnVtLAogICAgW3N3aXRjaF0kcmVncXVlcnksCiAgICBbc3RyaW5nXSRrZXksCiAgICBbc3dpdGNoXSRhdXRvcnVucywKICAgIFtzd2l0Y2hdJG1vdW50LAogICAgW3N3aXRjaF0kbW91bnRlZGQsCiAgICBbc3dpdGNoXSRtb3VudGVkcywKICAgIFtzd2l0Y2hdJGRyaXZlcnMsCiAgICBbc3dpdGNoXSRwcmVmZXRjaCwKICAgIFtzd2l0Y2hdJHJlY2VudCwKICAgIFtzd2l0Y2hdJGRvd25sb2FkcywKICAgIFtzd2l0Y2hdJG5idGNhY2hlLAogICAgW3N3aXRjaF0kZGVza3RvcCwKICAgIFtzd2l0Y2hdJHR5cGVkdXJscywKICAgIFtzd2l0Y2hdJGFydGVmYWN0cywKICAgIFtzd2l0Y2hdJG5ldHN0YXRzLAogICAgW3N3aXRjaF0kc2Vzc2lvbnMsCiAgICBbc3dpdGNoXSRkbnNjYWNoZSwKICAgIFtzd2l0Y2hdJHByb2dyYW1zLAogICAgW3N3aXRjaF0kbWZ0LAogICAgW3N3aXRjaF0kbWFpbGZpbGUsCiAgICBbc3dpdGNoXSRsb2dnZWRvbiwKICAgIFtzd2l0Y2hdJG1haWxmaWxlbywKICAgIFtzd2l0Y2hdJHdpbnZlciwKICAgIFtzd2l0Y2hdJHNuaWZmZXIsCiAgICBbc3RyaW5nXSRtb2R1bGUsCiAgICBbc3RyaW5nXSRtb2RhcmdzLAogICAgW3N3aXRjaF0kaAopCgojIElmIHRoZXNlIG5vdCBzZXQsIHlvdSB3aWxsIGJlIHByb21wdGVkIGZvciB5b3VyIHNlcnZpY2UgaWQgY3JlZGVudGlhbHMuIFNldHRpbmcgdGhlc2UgaXMgbm90IGVuY291cmFnZWQuCiRHbG9iYWw6U0VSVklDRV9JRCA9ICIiCiRHbG9iYWw6UEFTU1dPUkQgPSAnJwokR2xvYmFsOlNFU1NJT04gPSAiIgokR2xvYmFsOkNPTU1BTkRfU1BFQ0lGSUVEID0gJGZhbHNlCiRHbG9iYWw6TU9EU19QQVRIID0gIi5cbW9kc1wiCiRHbG9iYWw6VVRJTFNfUEFUSCA9ICIuXHV0aWxzXCIKJEdsb2JhbDpBUlRFRkFDVFNfUEFUSCA9ICJDOlxhcnRlZmFjdHNcIgoKZnVuY3Rpb24gQ29uc3RydWN0TW9kdWxlT2JqZWN0KFtzdHJpbmddICRfbmFtZSwgW3N0cmluZ10gJF9oZWxwVGV4dCwgJF9zaG91bGRFeGVjdXRlLCBbc3RyaW5nXSAkX2FyZ3VtZW50cyA9ICRmYWxzZSwgW2Jvb2xdICRfdXNlcklEUmVxdWlyZWQgPSAkZmFsc2UpIHsKICAgICRtb2R1bGVPYmplY3QgPSBAewogICAgICAgIG5hbWUgPSAkX25hbWUKICAgICAgICBoZWxwVGV4dCA9ICRfaGVscFRleHQKICAgICAgICBzaG91bGRFeGVjdXRlID0gJF9zaG91bGRFeGVjdXRlCiAgICAgICAgaXNVc2VySURSZXF1aXJlZCA9ICRfdXNlcklEUmVxdWlyZWQKICAgICAgICBhcmd1bWVudHMgPSAkX2FyZ3VtZW50cwogICAgfQogICAgcmV0dXJuICRtb2R1bGVPYmplY3QKfQoKJEdsb2JhbDpNT0RVTEVTID0gW2FycmF5XSAoCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJhcnAiICItYXJwYHRgdCBHZXQgQVJQIGNhY2hlIiAkYXJwKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgImlwY2ZnIiAiLWlwY2ZnYHRgdCBHZXQgSVAgY29uZmlndXJhdGlvbiIgJGlwY2ZnKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInJvdXRpbmciICItcm91dGVgdGB0IEdldCByb3V0aW5nIHRhYmxlcyIgJHJvdXRlKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInRhc2tsaXN0IiAiLXByb2NzYHRgdCBHZXQgcnVubmluZyBwcm9jZXNzZXMiICRwcm9jcyksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJjb25uZWN0aW9ucyIgIi1jb25uc2B0YHQgR2V0IGVzdGFibGlzaGVkIGNvbm5lY3Rpb25zICYgcG9ydHMgbGlzdGVuaW5nIiAkY29ubnMpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAidXNlcnMiICItdXNlcnNgdGB0IEdldCB1c2VycyB3aG8gaGF2ZSB1c2VkIHRoZSBtYWNoaW5lIiAkdXNlcnMpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAibG9nZ2Vkb24iICItbG9nZ2Vkb24sYHQgR2V0IGN1cnJlbnRseSBsb2dnZWQgb24gdXNlcnMiICRsb2dnZWRvbiksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJyZWdxdWVyeSIgIi1yZWdxdWVyeWB0IEdldCByZWdpc3RyeSBrZXkgaW5mby4gVXNlIC1rZXkgdG8gc3BlY2lmeSB0aGUgJ2tleScuIE1pbmQgdGhlIHF1b3Rlcy4iICRyZWdxdWVyeSAka2V5KSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgImF1dG9ydW5zIiAiLWF1dG9ydW5zYHQgR2V0IGF1dG9ydW5zIGZyb20gcG9wdWxhciBwZXJzaXN0ZW5jZSBsb2NhdGlvbnMuIFJlcXVpcmVzIC11c2VyIDx1c2VybmFtZT4iICRhdXRvcnVucyAkdXNlciAkdHJ1ZSksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJtb3VudGVkZGV2aWNlcyIgIi1tb3VudGVkZGB0IEdldCBjdXJyZW50bHkgbW91bnRlZCBwaHlzaWNhbCBkZXZpY2UgbGV0dGVycyIgJG1vdW50ZWRkKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgIm1vdW50ZWRzaGFyZXMiICItbW91bnRlZHNgdCBHZXQgY3VycmVudGx5IG1vdW50ZWQgc2hhcmVzIiAkbW91bnRlZHMpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAicHJvZ3JhbXMiICItcHJvZ3JhbXNgdCBHZXQgY3VycmVudGx5IGluc3RhbGxlZCBwcm9ncmFtcyIgJHByb2dyYW1zKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInNoZWxsIiAiLXNoZWxsYHRgdCBHZXQgcmVtb3RlIHNoZWxsIiAkc2hlbGwpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAibW9kdWxlIiAiLW1vZHVsZWB0IFNwZWNpZnkgcGF0aCBvZiBhbiBleHRlcm5hbCBtb2R1bGUgdG8gYmUgZXhlY3V0ZWQuIC1tb2RhcmdzIHRvIHN1cHBseSBhcmd1bWVudHMiICRtb2R1bGUgJG1vZGFyZ3MpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAiZHJpdmVycyIgIi1kcml2ZXJzYHQgR2V0IGluc3RhbGxlZCBkcml2ZXJzIiAkZHJpdmVycyksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJtYWlsZmlsZSIgIi1tYWlsZmlsZWB0IE9wZW4gZG9taW5vIG1haWxmaWxlLiBSZXF1aXJlcyAtdXNlciA8dXNlcm5hbWU+IiAkbWFpbGZpbGUpLAogICAgIyAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJtYWlsZmlsZW8iICItbWFpbGZpbGVvYHQgT3BlbiBPMzY1IG1haWxmaWxlLiBSZXF1aXJlcyAtdXNlciA8dXNlcm5hbWU+IiAkbWFpbGZpbGVvKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInVzYmVudW1lcmF0aW9uIiAiLXVzYmVudW1gdCBHZXQgVVNCIGRldmljZXMgdGhhdCBoYWQgYmVlbiBwbHVnZ2VkIGluIiAkdXNiZW51bSksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJzbmlmZmVyIiAiLXNuaWZmZXJgdCBTbmlmZiB0cmFmZmljLiBDdXJyZW50bHkgZHVtcHMgcmVzdWx0cyB0byB0byBDU1Ygb25seS4iICRzbmlmZmVyKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgIm5ldGJpb3NjYWNoZSIgIi1uYnRjYWNoZWB0IEdldCBOZXRCaW9zIGNhY2hlIiAkbmJ0Y2FjaGUpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAiYWNjb3VudHMiICItYWNjb3VudHNgdCBHZXQgdXNlciBhY2NvdW50cyBmb3IgbWFjaGluZSIgJGFjY291bnRzKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInNtYnNlc3Npb25zIiAiLXNlc3Npb25zYHQgR2V0IGEgbGlzdCBvZiBTTUIgc2Vzc2lvbnMgaW5jb21pbmcgdG8gdGhlIHJlbW90ZSBtYWNoaW5lIiAkc2Vzc2lvbnMpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAibmV0c3RhdHMiICItbmV0c3RhdHNgdCBHZXQgdXB0aW1lLCBwZXJtaXNzaW9ucyBhbmQgcGFzc3dvcmQgdmlvbGF0aW9ucyBjb3VudCIgJG5ldHN0YXRzKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInR5cGVkdXJscyIgIi10eXBlZHVybHNgdCBHZXQgVVJMcyAgdHlwZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgYWRkcmVzcyBiYXIuIFJlcXVpcmVzIC11c2VyIDx1c2VybmFtZT4iICR0eXBlZHVybHMgJHVzZXIgJHRydWUpLAogICAgKENvbnN0cnVjdE1vZHVsZU9iamVjdCAiZG93bmxvYWRzIiAiLWRvd25sb2Fkc2B0IEdldCBjb250ZW50cyBvZiB0aGUgZG93bmxvYWRzIGZvbGRlci4gUmVxdWlyZXMgLXVzZXIgPHVzZXJuYW1lPiIgJGRvd25sb2FkcyAkdXNlciAkdHJ1ZSksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJkZXNrdG9wIiAiLWRlc2t0b3BgdCBHZXQgY29udGVudHMgb2YgdGhlIGRlc2t0b3AuIFJlcXVpcmVzIC11c2VyIDx1c2VybmFtZT4iICRkZXNrdG9wICR1c2VyICR0cnVlKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgIm1mdCIgIi1tZnRgdGB0IEdldCBNYXN0ZXIgRmlsZSBUYWJsZSIgJG1mdCksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJkbnNjYWNoZSIgIi1kbnNjYWNoZWB0IEdldCBETlMgY2FjaGUiICRkbnNjYWNoZSksCiAgICAoQ29uc3RydWN0TW9kdWxlT2JqZWN0ICJ3aW5kb3dzdmVyc2lvbiIgIi13aW52ZXJgdCBHZXQgV2luZG93cyBPUyB2ZXJzaW9uLCBpbmNsdWRpbmcgU2VydmljZSBQYWNrIiAkd2ludmVyKSwKICAgIChDb25zdHJ1Y3RNb2R1bGVPYmplY3QgInJlY2VudCIgIi1yZWNlbnRgdCBHZXQgcmVjZW50bHkgYWNjZXNzZWQgZG9jdW1lbnRzLiBSZXF1aXJlcyAtdXNlciA8dXNlcm5hbWU+IiAkcmVjZW50ICR1c2VyICR0cnVlKQopCgpmdW5jdGlvbiBtYWluKCkgewogICAgY2hhbmdlV29ya2luZ0RpcmVjdG9yeQogICAgcHJvY2Vzc0FyZ3VtZW50cwogICAgICAgIAogICAgaWYgKCRoKSB7CiAgICAgICAgcHJpbnRIZWxwCiAgICB9IAogICAgCiAgICBlc3RhYmxpc2hSZW1vdGVTZXNzaW9uCiAgICBlbnVtZXJhdGVTeXN0ZW0KICAgIGNsb3NlUmVtb3RlU2Vzc2lvbgp9CgpmdW5jdGlvbiBjbG9zZVJlbW90ZVNlc3Npb24oKSB7CiAgICBHZXQtUFNTZXNzaW9uIHwgUmVtb3ZlLVBTU2Vzc2lvbgogICAgY21ka2V5LmV4ZSAvZGVsZXRlOiRHbG9iYWw6UkVNT1RFX0hPU1QgfCBPdXQtTnVsbAp9CgpmdW5jdGlvbiBwcmludEhlbHAoKSB7CgoKICAgIFdyaXRlLUhvc3QgIgogICAgICBfX18gICAgICAgICAgIF9fXyAgICAgICAgICAgX19fICAgICAgICAgICBfX18gICAgICAgICAgIF9fXyAgICAgCiAgICAgL1wgIFwgICAgICAgICAvXCAgXCAgICAgICAgIC9cX19cICAgICAgICAgL1xfX1wgICAgICAgICAvXF9fXCAgICAKICAgIC8gIFwgIFwgICAgICAgLyAgXCAgXCAgICAgICAvICB8ICB8ICAgICAgIC8gLyAgLyAgICAgICAgLyAgfCAgfCAgIAogICAvIC9cIFwgIFwgICAgIC8gL1wgXCAgXCAgICAgLyB8IHwgIHwgICAgICAvIC8gIC8gICAgICAgIC8gfCB8ICB8ICAgCiAgLyAgXCBcIFwgIFwgICAvICBcIFwgXCAgXCAgIC8gL3wgfCAgfF9fICAgLyAvICAvICBfX18gICAvIC98IHxfX3xfXyAKIC8gL1wgXCBcIFxfX1wgLyAvXCBcIFwgXF9fXCAvIC8gfCB8IC9cX19cIC8gL19fLyAgL1xfX1wgLyAvIHwgICAgXF9fXAogXC9ffCAgXC8gLyAgLyBcIFwgXCBcIFwvX18vIFwvX198IHwvIC8gIC8gXCBcICBcIC8gLyAgLyBcL19fLy0tLyAvICAvCiAgICB8IHwgIC8gIC8gICBcIFwgXCBcX19cICAgICAgIHwgLyAvICAvICAgXCBcICAvIC8gIC8gICAgICAgIC8gLyAgLyAKICAgIHwgfFwvX18vICAgICBcIFwgXC9fXy8gICAgICAgfCAgLyAgLyAgICAgXCBcLyAvICAvICAgICAgICAvIC8gIC8gIAogICAgfCB8ICB8ICAgICAgICBcIFxfX1wgICAgICAgICAvIC8gIC8gICAgICAgXCAgLyAgLyAgICAgICAgLyAvICAvICAgCiAgICAgXHxfX3wgICAgICAgICBcL19fLyAgICAgICAgIFwvX18vICAgICAgICAgXC9fXy8gICAgICAgICBcL19fLyAgICAKICAgICAgICAKICAgICAgICAiIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93CgogICAgICAgIFdyaXRlLUhvc3QgIlsqXSBSRW51bSAoUmVtb3RlRW51bWVyYXRpb24pIGlzIGEgY29sbGVjdGlvbiBvZiBjb252ZW5pZW5jZSBmdW5jdGlvbnMgdG8gaGVscCBkdXJpbmcgYW4gaW52ZXN0aWd0aW9uLiIgLUZvcmVncm91bmRDb2xvciBDeWFuCiAgICAgICAgV3JpdGUtSG9zdCBbaV0gU3BlY2lmeSByZW1vdGUgaG9zdCBhbmQgLVtjb21tYW5kXSB5b3Ugd2FudCB0byBleGVjdXRlLmBuW2ldIEV4YW1wbGU6IHRvIGdldCByZW1vdGUgbWFjaGluZSBJUCBjb25maWd1cmF0aW9uLCB0eXBlOiByZW51bS12MC4xLnBzMSAxMjcuMC4wLjEgLWlwY2ZnCiAgICAgICAgV3JpdGUtSG9zdCAiYG5baV0gQXZhaWxhYmxlIGNvbW1hbmRzOmBuCiAgICAgICAgVGlwOmB0YHQgT21pdCB0aGUgY29tbWFuZCB0byBvcGVuIEMkIHNoYXJlIHdpdGhvdXQgbW91bnRpbmcgaXQuLi4gb3IgdXNlIC1tb3VudCB0byBkbyBpdCIKICAgICAgICAKICAgICAgICBmb3JlYWNoICgkbW9kdWxlIGluICRHbG9iYWw6TU9EVUxFUykgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJgdCIgJG1vZHVsZS5oZWxwVGV4dAogICAgICAgIH0KICAgICAgICBicmVhawp9CgpmdW5jdGlvbiBwcm9jZXNzQXJndW1lbnRzKCkgewogICAgaWYgKCRHbG9iYWw6UkVNT1RFX0hPU1QgLWVxICIiKSB7CiAgICAgICAgcHJpbnRIZWxwCiAgICB9CiAgICBwcm9jZXNzSG9zdCAgCiAgICBwcm9jZXNzQ3JlZGVudGlhbHMKfQoKZnVuY3Rpb24gcHJvY2Vzc0hvc3QoKSB7CiAgICB0cnkgewogICAgICAgIGlmIChbaXBhZGRyZXNzXSAkR2xvYmFsOlJFTU9URV9IT1NUKSB7CiAgICAgICAgICAgICRHbG9iYWw6UkVNT1RFX0hPU1QgPSBbU3lzdGVtLk5ldC5EbnNdOjpHZXRIb3N0QnlBZGRyZXNzKCRHbG9iYWw6UkVNT1RFX0hPU1QpLkhvc3ROYW1lCiAgICAgICAgfQogICAgfSBjYXRjaCB7fQp9CgpmdW5jdGlvbiBwcm9jZXNzQ3JlZGVudGlhbHMoKSB7CiAgICBpZiAoJEdsb2JhbDpQQVNTV09SRCAtZXEgJycgLW9yICRHbG9iYWw6U0VSVklDRV9JRCAtZXEgJycpIHsKICAgICAgICAkR2xvYmFsOkNSRURFTlRJQUxTID0gR2V0LUNyZWRlbnRpYWwKICAgIH0gZWxzZSB7CiAgICAgICAgJEdsb2JhbDpQQVNTV09SRDIgPSBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICRHbG9iYWw6UEFTU1dPUkQgLUFzUGxhaW5UZXh0IC1Gb3JjZQogICAgICAgICRHbG9iYWw6Q1JFREVOVElBTFMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsKCRHbG9iYWw6U0VSVklDRV9JRCwgJEdsb2JhbDpQQVNTV09SRDIpCiAgICB9Cn0KCmZ1bmN0aW9uIGlzVXNlclNwZWNpZmllZCgpIHsKICAgIGlmICgkdXNlciAtZXEgIiIgLW9yICR1c2VyIC1lcSAkbnVsbCkgewogICAgICAgICR1c2VybmFtZSA9IFJlYWQtSG9zdCAtUHJvbXB0ICJbIV0gRW50ZXIgdXNlcm5hbWUgb2YgdGhlIGRlc3RpbmF0aW9uIG1hY2hpbmUgKFRpcDogc3dpdGNoIC11c2VycyBzaG93cyB1c2VycyB3aG8gaGFkIGVuZ2FnZWQgd2l0aCB0aGUgcmVtb3RlIG1hY2hpbmUpIgogICAgICAgIFdyaXRlLUhvc3QgIltpXSBUaXA6IHVzZSAtdXNlciA8dXNlcj4gdG8gYXZvaWQgdGhpcyBwcm9tcHQgaW4gdGhlIGZ1dHVyZS4uLiIKICAgICAgICByZXR1cm4gJHVzZXJuYW1lCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAkdXNlcgogICAgfQp9CgpmdW5jdGlvbiBzbmlmZlRyYWZmaWMoJG1vZHVsZSkgewogICAgJGlnbm9yZUlQID0gKFRlc3QtQ29ubmVjdGlvbiAtQ29tcHV0ZXJOYW1lIChob3N0bmFtZSkgLUNvdW50IDEgfCBTZWxlY3QgSVBWNEFkZHJlc3MpLklQVjRBZGRyZXNzLklQQWRkcmVzc1RvU3RyaW5nCiAgICBleGVjdXRlUmVtb3RlQ29tbWFuZCAkbW9kdWxlICRpZ25vcmVJUAogICAgJHBhY2tldENhcHR1cmVGaWxlTG9jYXRpb24gPSB3YWl0Rm9yRXNjYXBlS2V5CiAgICBpZGVudGlmeVN1c3BpY2lvdXNUcmFmZmljICRwYWNrZXRDYXB0dXJlRmlsZUxvY2F0aW9uCn0KCmZ1bmN0aW9uIGlkZW50aWZ5U3VzcGljaW91c1RyYWZmaWMoJHBhY2tldENhcHR1cmVGaWxlTG9jYXRpb24pIHsKICAgIHBvd2Vyc2hlbGwgJEdsb2JhbDpVVElMU19QQVRIXGZpbmQtc3VzcGljaW91cy10cmFmZmljLnBzMSAkR2xvYmFsOkFSVEVGQUNUU19QQVRIXCRwYWNrZXRDYXB0dXJlRmlsZUxvY2F0aW9uCn0KCmZ1bmN0aW9uIHdhaXRGb3JFc2NhcGVLZXkoKSB7CiAgICBbaW50XSAkcGVyY2VudCA9IDAKICAgIFtkYXRlXSAkc25pZmZpbmdTdGFydFRpbWUgPSAoR2V0LURhdGUpCgogICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgICAgV3JpdGUtUHJvZ3Jlc3MgLUFjdGl2aXR5ICJTbmlmZmluZyB0cmFmZmljICRHbG9iYWw6UkVNT1RFX0hPU1QuLi4gUHJlc3MgRVNDIG9yIEN0cmwrQyB0byBzdG9wIGFuZCBkb3dubG9hZCB0aGUgcmVzdWx0cy4uLiIgLVN0YXR1cyAoKEdldC1EYXRlKSAtICRzbmlmZmluZ1N0YXJ0VGltZSkgLVBlcmNlbnRDb21wbGV0ZSAkcGVyY2VudAoKICAgICAgICBpZiAoJGhvc3QudWkuUmF3VWkuS2V5QXZhaWxhYmxlKSB7CiAgICAgICAgICAgICRwcmVzc2VkS2V5ID0gJGhvc3QudWkuUmF3VUkuUmVhZEtleSgiTm9FY2hvLEluY2x1ZGVLZXlEb3duIikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICgkcHJlc3NlZEtleS5WaXJ0dWFsS2V5Q29kZSAtZXEgMjcgLW9yICgzIC1lcSBbaW50XSRIb3N0LlVJLlJhd1VJLlJlYWRLZXkoIkFsbG93Q3RybEMsSW5jbHVkZUtleVVwLE5vRWNobyIpLkNoYXJhY3RlcikpIHsKICAgICAgICAgICAgICAgIEdldC1Kb2IgfCBTdG9wLUpvYiAKICAgICAgICAgICAgICAgIEdldC1Kb2IgfCBSZW1vdmUtSm9iCiAgICAgICAgICAgICAgICAkcGFja2V0Q2FwdHVyZUZpbGVuYW1lID0gIiRHbG9iYWw6UkVNT1RFX0hPU1Qtc25pZmYuY3N2IgogICAgICAgICAgICAgICAgJGFydGVmYWN0ID0gZG93bmxvYWRBcnRlZmFjdCAkcGFja2V0Q2FwdHVyZUZpbGVuYW1lCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbKl0gRG93bmxvYWQgY29tcGxldGUuIgogICAgICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gJGFydGVmYWN0CiAgICAgICAgICAgICAgICByZXR1cm4gJHBhY2tldENhcHR1cmVGaWxlbmFtZQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgIH0gCgogICAgICAgIGlmICgkcGVyY2VudCAtZXEgMTAwKSB7CiAgICAgICAgICAgICRwZXJjZW50ID0gMAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwZXJjZW50KysKICAgICAgICB9CiAgICAgICAgU3RhcnQtU2xlZXAgMC4xCiAgICB9Cn0KCmZ1bmN0aW9uIGdldE1GVCgkbW9kdWxlKSB7CiAgICBjb3B5VXRpbHNUb1JlbW90ZUhvc3QKICAgIGV4ZWN1dGVSZW1vdGVDb21tYW5kICRtb2R1bGUKICAgICRyZW1vdGVNRlRwYXRoID0gZG93bmxvYWRBcnRlZmFjdCAiJEdsb2JhbDpSRU1PVEVfSE9TVC5tZnQiCiAgICBSZW1vdmUtSXRlbSAkcmVtb3RlTUZUcGF0aCAgIAogICAgcGFyc2VNRlQKfQoKZnVuY3Rpb24gcGFyc2VNRlQoKSB7CiAgICAkbWZ0TG9jYXRpb24gPSAiJEdsb2JhbDpBUlRFRkFDVFNfUEFUSFwkR2xvYmFsOlJFTU9URV9IT1NULm1mdCIKICAgICRtZnRSZXBvcnQgPSAiJEdsb2JhbDpBUlRFRkFDVFNfUEFUSFwkR2xvYmFsOlJFTU9URV9IT1NULW1mdC54bHMiCgogICAgV3JpdGUtSG9zdCAiWypdIFBhcnNpbmcgJEdsb2JhbDpSRU1PVEVfSE9TVC5tZnQuLi4iCiAgICBwb3dlcnNoZWxsICRHbG9iYWw6VVRJTFNfUEFUSFxtZnRkdW1wLmV4ZSAkbWZ0TG9jYXRpb24gL28gJG1mdFJlcG9ydAogICAgV3JpdGUtSG9zdCAiWypdIE9wZW5pbmcgJEdsb2JhbDpSRU1PVEVfSE9TVCBNRlQsIHBsZWFzZSB3YWl0Li4uIgogICAgSW52b2tlLUl0ZW0gJG1mdFJlcG9ydAp9CgpmdW5jdGlvbiBnZXRTaGVsbCgpIHsKICAgICRHbG9iYWw6Q09NTUFORF9TUEVDSUZJRUQgPSAkdHJ1ZQogICAgRW50ZXItUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgJEdsb2JhbDpSRU1PVEVfSE9TVCAtQ3JlZGVudGlhbCAkR2xvYmFsOkNSRURFTlRJQUxTCn0KCmZ1bmN0aW9uIG1vdW50U2hhcmUoKSB7CiAgICBuZXQgdXNlICogXFwkR2xvYmFsOlJFTU9URV9IT1NUXGMkIC91c2VyOiRHbG9iYWw6U0VSVklDRV9JRCAkR2xvYmFsOlBBU1NXT1JECiAgICBJbnZva2UtSXRlbSBcXCRHbG9iYWw6UkVNT1RFX0hPU1RcYyQKfQoKZnVuY3Rpb24gZ2V0TWFpbEZpbGUoKSB7CiAgICAkdXNlciA9IGlzVXNlclNwZWNpZmllZAogICAgJEdsb2JhbDpDT01NQU5EX1NQRUNJRklFRCA9ICR0cnVlCiAgICAkbWFpbGZpbGUgPSAiJHVzZXIubnNmIgogICAgJG1haWxmaWxlRGVzdGluYXRpb24gPSAiQzpcVXNlcnNcJGVudjpVU0VSTkFNRVxEb3dubG9hZHNcJG1haWxmaWxlIgogICAgJG1haWxmaWxlU291cmNlID0gIlxcIiArICIkR2xvYmFsOlJFTU9URV9IT1NUXGQkXExvdHVzXERvbWlub1xkYXRhXG1haWxcJG1haWxmaWxlIgogICAgCiAgICBXcml0ZS1Ib3N0ICJbKl0gRG93bmxvYWRpbmcgbWFpbGZpbGUgdG8gJG1haWxmaWxlRGVzdGluYXRpb24uIFBsZWFzZSB3YWl0LCBpdCB3aWxsIGJlIG9wZW5lZCBhdXRvbWF0aWNhbGx5Li4uIgogICAgQ29weS1JdGVtICRtYWlsZmlsZVNvdXJjZSAtRGVzdGluYXRpb24gJG1haWxmaWxlRGVzdGluYXRpb24gLUZvcmNlIC1SZWN1cnNlCiAgICBXcml0ZS1Ib3N0IFsqXSBPcGVuaW5nIG1haWxmaWxlLi4uIERvIG5vdCBmb3JnZXQgdG8gZGVsZXRlIGl0IG9uY2UgZG9uZS4KICAgIEludm9rZS1JdGVtICRtYWlsZmlsZURlc3RpbmF0aW9uCn0KCmZ1bmN0aW9uIGdldE91dGxvb2tNYWlsRmlsZSgpIHsKICAgICR1c2VyID0gaXNVc2VyU3BlY2lmaWVkCiAgICAkR2xvYmFsOkNPTU1BTkRfU1BFQ0lGSUVEID0gJHRydWUKICAgICRtYWlsZmlsZSA9ICIqLm9zdCIKICAgICRtYWlsZmlsZURlc3RpbmF0aW9uID0gIkM6XFVzZXJzXCRlbnY6VVNFUk5BTUVcRG93bmxvYWRzXCIKICAgICRtYWlsZmlsZVNvdXJjZSA9ICJcXCIgKyAiJEdsb2JhbDpSRU1PVEVfSE9TVFxjJFx1c2Vyc1wkdXNlclxBcHBEYXRhXExvY2FsXE1pY3Jvc29mdFxPdXRsb29rXCoub3N0IgogICAgCiAgICBXcml0ZS1Ib3N0ICJbKl0gRG93bmxvYWRpbmcgbWFpbGZpbGUgdG8gJG1haWxmaWxlRGVzdGluYXRpb24uIFBsZWFzZSB3YWl0LCBpdCB3aWxsIGJlIG9wZW5lZCBhdXRvbWF0aWNhbGx5Li4uIgogICAgQ29weS1JdGVtICRtYWlsZmlsZVNvdXJjZSAtRGVzdGluYXRpb24gJG1haWxmaWxlRGVzdGluYXRpb24gLUZvcmNlIC1SZWN1cnNlCiAgICBXcml0ZS1Ib3N0IFsqXSBPcGVuaW5nIG1haWxmaWxlLi4uIERvIG5vdCBmb3JnZXQgdG8gZGVsZXRlIGl0IG9uY2UgZG9uZS4KICAgIEludm9rZS1JdGVtICRtYWlsZmlsZURlc3RpbmF0aW9uCn0KCmZ1bmN0aW9uIGdldERyaXZlcnMoKSB7CiAgICAkR2xvYmFsOkNPTU1BTkRfU1BFQ0lGSUVEID0gJHRydWUKICAgIGRyaXZlcnF1ZXJ5IC9zICRHbG9iYWw6UkVNT1RFX0hPU1QgL3UgJEdsb2JhbDpTRVJWSUNFX0lEIC9wICRHbG9iYWw6UEFTU1dPUkQKfQoKZnVuY3Rpb24gZW51bWVyYXRlU3lzdGVtKCkgewogICAgZm9yZWFjaCAoJG1vZHVsZSBpbiAkR2xvYmFsOk1PRFVMRVMpIHsKICAgICAgICBpZiAoJG1vZHVsZS5zaG91bGRFeGVjdXRlKSB7CiAgICAgICAgICAgIHN3aXRjaCAoJG1vZHVsZS5uYW1lKSB7CiAgICAgICAgICAgICAgICAic2hlbGwiIHsgZ2V0U2hlbGwgfQogICAgICAgICAgICAgICAgIm1mdCIgeyBnZXRNRlQgJG1vZHVsZSB9CiAgICAgICAgICAgICAgICAiZHJpdmVycyIgeyBnZXREcml2ZXJzIH0KICAgICAgICAgICAgICAgICJtYWlsZmlsZSIgeyBnZXRNYWlsRmlsZSB9CiAgICAgICAgICAgICAgICAibWFpbGZpbGVvIiB7IGdldE91dGxvb2tNYWlsRmlsZSB9CiAgICAgICAgICAgICAgICAic25pZmZlciIgeyBzbmlmZlRyYWZmaWMgJG1vZHVsZSB9CiAgICAgICAgICAgICAgICAibW9kdWxlIiB7IGV4ZWN1dGVFeHRlcm5hbE1vZHVsZSAkbW9kdWxlICRtb2RhcmdzIH0KICAgICAgICAgICAgICAgIERlZmF1bHQgeyBleGVjdXRlUmVtb3RlQ29tbWFuZCAkbW9kdWxlICRtb2R1bGUgfQogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgfQogICAgfQogICAgCiAgICBpc0NvbW1hbmROb3RTcGVjaWZpZWQKfQoKZnVuY3Rpb24gaXNDb21tYW5kTm90U3BlY2lmaWVkKCkgewogICAgaWYgKCEkR2xvYmFsOkNPTU1BTkRfU1BFQ0lGSUVEKSB7CiAgICAgICAgaWYgKCRtb3VudCkgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJbaV0gTW91bnRpbmcgc2hhcmUgXFwkR2xvYmFsOlJFTU9URV9IT1NUXEMkIgogICAgICAgICAgICBtb3VudFNoYXJlCiAgICAgICAgfQogICAgICAgIFdyaXRlLUhvc3QgIltpXSBPcGVuaW5nIHNoYXJlIFxcJEdsb2JhbDpSRU1PVEVfSE9TVFxDJCIKICAgICAgICBJbnZva2UtSXRlbSBcXCRHbG9iYWw6UkVNT1RFX0hPU1RcYyQKICAgIH0KfQoKZnVuY3Rpb24gZXhlY3V0ZUV4dGVybmFsTW9kdWxlKCRtb2R1bGUsICRtb2RhcmdzKSB7CiAgICBleGVjdXRlUmVtb3RlQ29tbWFuZCAkbW9kdWxlICRtb2RhcmdzICR0cnVlCn0KCmZ1bmN0aW9uIGNoYW5nZVdvcmtpbmdEaXJlY3RvcnkoKSB7CiAgICBTZXQtTG9jYXRpb24gJE15SW52b2NhdGlvbi5QU1NjcmlwdFJvb3QKfQoKZnVuY3Rpb24gZXhlY3V0ZVJlbW90ZUNvbW1hbmQoJG1vZHVsZSwgJGFyZ3VtZW50cz0kbnVsbCwgJGlzRXh0ZXJuYWxNb2R1bGU9JGZhbHNlKSB7CiAgICAkR2xvYmFsOkNPTU1BTkRfU1BFQ0lGSUVEID0gJHRydWUKICAgICRjb21tYW5kID0gJG1vZHVsZS5uYW1lCgogICAgaWYgKCRtb2R1bGUuaXNVc2VySURSZXF1aXJlZCAtYW5kICR1c2VyIC1lcSAiIikgewogICAgICAgICRtb2R1bGUuYXJndW1lbnRzID0gaXNVc2VyU3BlY2lmaWVkCiAgICB9CiAgICAkYXJndW1lbnRzID0gJG1vZHVsZS5hcmd1bWVudHMKCiAgICBpZiAoISRpc0V4dGVybmFsTW9kdWxlKSB7CiAgICAgICAgJG1vZHVsZSA9ICIkR2xvYmFsOk1PRFNfUEFUSFwkY29tbWFuZC5wczEiCiAgICB9CiAgICAKICAgIGlmICgkY29tbWFuZCAtZXEgInNuaWZmZXIiKSB7CiAgICAgICAgSW52b2tlLUNvbW1hbmQgLVNlc3Npb24gJEdsb2JhbDpTRVNTSU9OIC1GaWxlUGF0aCAkbW9kdWxlIC1Bcmd1bWVudExpc3QgJGFyZ3VtZW50cyAtQXNKb2IgfCBPdXQtTnVsbAogICAgfSBlbHNlIHsKICAgICAgICBJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkR2xvYmFsOlNFU1NJT04gLUZpbGVQYXRoICRtb2R1bGUgLUFyZ3VtZW50TGlzdCAkYXJndW1lbnRzCiAgICB9Cn0KCmZ1bmN0aW9uIGRvd25sb2FkQXJ0ZWZhY3QoJGFydGVmYWN0TmFtZSwgJGlzTG9ja2VkPSRmYWxzZSkgewogICAgJGFydGVmYWN0c1NhdmVMb2NhdGlvbiA9ICIkR2xvYmFsOkFSVEVGQUNUU19QQVRIJGFydGVmYWN0TmFtZSIKICAgICRhcnRlZmFjdFNvdXJjZUxvY2F0aW9uID0gIlxcIiArICRHbG9iYWw6UkVNT1RFX0hPU1QgKyAiXGMkXHRlbXBcJGFydGVmYWN0TmFtZSIKICAgIFdyaXRlLUhvc3QgIlsqXSBEb3dubG9hZGluZyAkYXJ0ZWZhY3ROYW1lIHRvICRhcnRlZmFjdHNTYXZlTG9jYXRpb24iCiAgICBDb3B5LUl0ZW0gJGFydGVmYWN0U291cmNlTG9jYXRpb24gLURlc3RpbmF0aW9uICRhcnRlZmFjdHNTYXZlTG9jYXRpb24gLUZvcmNlIC1SZWN1cnNlCiAgICByZXR1cm4gJGFydGVmYWN0U291cmNlTG9jYXRpb24KfQoKZnVuY3Rpb24gY29weVV0aWxzVG9SZW1vdGVIb3N0KCkgewogICAgQ29weS1JdGVtICRHbG9iYWw6VVRJTFNfUEFUSFxjb3B5LmV4ZSAtRGVzdGluYXRpb24gXFwkR2xvYmFsOlJFTU9URV9IT1NUXGMkXFRFTVBcY29weS5leGUgLVJlY3Vyc2UgLUZvcmNlCn0KCmZ1bmN0aW9uIG5vdGlmeUNvbm5lY3Rpb25FcnJvcigpIHsKICAgIFdyaXRlLUhvc3QgIlsqXSBOb3QgY29ubmVjdGVkLiBNYWNoaW5lIG9mZmxpbmUgb3IgbWlzc3BlbGxlZC4uLiIKICAgIGJyZWFrCn0KCmZ1bmN0aW9uIGVzdGFibGlzaFJlbW90ZVNlc3Npb24oKSB7CiAgICBXcml0ZS1Ib3N0ICJbKl0gQ29ubmVjdGluZyB0byIgJEdsb2JhbDpSRU1PVEVfSE9TVAogICAgY21ka2V5LmV4ZSAvYWRkOiRHbG9iYWw6UkVNT1RFX0hPU1QgL3VzZXI6JEdsb2JhbDpTRVJWSUNFX0lEIC9wYXNzOiRHbG9iYWw6UEFTU1dPUkQgfCBPdXQtTnVsbAoKICAgIGlmICghJG1haWxmaWxlIC1hbmQgJEdsb2JhbDpSRU1PVEVfSE9TVC5MZW5ndGggLWd0IDcpIHsKICAgICAgICAkR2xvYmFsOlNFU1NJT04gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgJEdsb2JhbDpSRU1PVEVfSE9TVCAtQ3JlZGVudGlhbCAkR2xvYmFsOkNSRURFTlRJQUxTCiAgICAgICAgaWYgKCRHbG9iYWw6U0VTU0lPTikgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJbKl0gQ29ubmVjdGVkISIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBub3RpZnlDb25uZWN0aW9uRXJyb3IKICAgICAgICB9CiAgICB9Cn0KCm1haW4K
