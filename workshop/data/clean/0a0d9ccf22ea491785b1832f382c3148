UniversalFunctions.ps1,cd98669f971bbf3221e825947dab6484,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgIExldHMgbWUgY29sb3VyIG91dHB1dCAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZpbHRlciBDb2xvdXJXb3JkIHsKICAgIHBhcmFtKAogICAgICAgIFtzdHJpbmddICR3b3JkLAogICAgICAgIFtzdHJpbmddICRjb2xvdXIKICAgICkKICAgICRsaW5lID0gJF8KICAgICRpbmRleCA9ICRsaW5lLkluZGV4T2YoJHdvcmQsIFtTeXN0ZW0uU3RyaW5nQ29tcGFyaXNvbl06OkludmFyaWFudEN1bHR1cmVJZ25vcmVDYXNlKQogICAgd2hpbGUoJGluZGV4IC1nZSAwKXsKICAgICAgICBXcml0ZS1Ib3N0ICRsaW5lLlN1YnN0cmluZygwLCRpbmRleCkgLU5vTmV3bGluZQogICAgICAgIFdyaXRlLUhvc3QgJGxpbmUuU3Vic3RyaW5nKCRpbmRleCwgJHdvcmQuTGVuZ3RoKSAtTm9OZXdsaW5lIC1Gb3JlZ3JvdW5kQ29sb3IgJGNvbG91cgogICAgICAgICR1c2VkID0gJHdvcmQuTGVuZ3RoICsgJGluZGV4CiAgICAgICAgJHJlbWFpbiA9ICRsaW5lLkxlbmd0aCAtICR1c2VkCiAgICAgICAgJGxpbmUgPSAkbGluZS5TdWJzdHJpbmcoJHVzZWQsICRyZW1haW4pCiAgICAgICAgJGluZGV4ID0gJGxpbmUuSW5kZXhPZigkd29yZCwgW1N5c3RlbS5TdHJpbmdDb21wYXJpc29uXTo6SW52YXJpYW50Q3VsdHVyZUlnbm9yZUNhc2UpCiAgICB9CiAgICBXcml0ZS1Ib3N0ICRsaW5lCn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIEFkZCBwb3NpeCB0b3VjaCBjb21tYW5kICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBTZXQtRmlsZVRpbWV7CiAgcGFyYW0oCiAgICBbc3RyaW5nW11dJHBhdGhzLAogICAgW2Jvb2xdJG9ubHlfbW9kaWZpY2F0aW9uID0gJGZhbHNlLAogICAgW2Jvb2xdJG9ubHlfYWNjZXNzID0gJGZhbHNlCiAgKTsKCiAgYmVnaW4gewogICAgZnVuY3Rpb24gdXBkYXRlRmlsZVN5c3RlbUluZm8oW1N5c3RlbS5JTy5GaWxlU3lzdGVtSW5mb10kZnNJbmZvKSB7CiAgICAgICRkYXRldGltZSA9IGdldC1kYXRlCiAgICAgIGlmICggJG9ubHlfYWNjZXNzICkKICAgICAgewogICAgICAgICAkZnNJbmZvLkxhc3RBY2Nlc3NUaW1lID0gJGRhdGV0aW1lCiAgICAgIH0KICAgICAgZWxzZWlmICggJG9ubHlfbW9kaWZpY2F0aW9uICkKICAgICAgewogICAgICAgICAkZnNJbmZvLkxhc3RXcml0ZVRpbWUgPSAkZGF0ZXRpbWUKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICAgJGZzSW5mby5DcmVhdGlvblRpbWUgPSAkZGF0ZXRpbWUKICAgICAgICAgJGZzSW5mby5MYXN0V3JpdGVUaW1lID0gJGRhdGV0aW1lCiAgICAgICAgICRmc0luZm8uTGFzdEFjY2Vzc1RpbWUgPSAkZGF0ZXRpbWUKICAgICAgIH0KICAgIH0KICAgCiAgICBmdW5jdGlvbiB0b3VjaEV4aXN0aW5nRmlsZSgkYXJnKSB7CiAgICAgIGlmICgkYXJnIC1pcyBbU3lzdGVtLklPLkZpbGVTeXN0ZW1JbmZvXSkgewogICAgICAgIHVwZGF0ZUZpbGVTeXN0ZW1JbmZvKCRhcmcpCiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgJHJlc29sdmVkUGF0aHMgPSByZXNvbHZlLXBhdGggJGFyZwogICAgICAgIGZvcmVhY2ggKCRycGF0aCBpbiAkcmVzb2x2ZWRQYXRocykgewogICAgICAgICAgaWYgKHRlc3QtcGF0aCAtdHlwZSBDb250YWluZXIgJHJwYXRoKSB7CiAgICAgICAgICAgICRmc0luZm8gPSBuZXctb2JqZWN0IFN5c3RlbS5JTy5EaXJlY3RvcnlJbmZvKCRycGF0aCkKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAkZnNJbmZvID0gbmV3LW9iamVjdCBTeXN0ZW0uSU8uRmlsZUluZm8oJHJwYXRoKQogICAgICAgICAgfQogICAgICAgICAgdXBkYXRlRmlsZVN5c3RlbUluZm8oJGZzSW5mbykKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgCiAgICBmdW5jdGlvbiB0b3VjaE5ld0ZpbGUoW3N0cmluZ10kcGF0aCkgewogICAgICAjJG51bGwgPiAkcGF0aAogICAgICBTZXQtQ29udGVudCAtUGF0aCAkcGF0aCAtdmFsdWUgJG51bGw7CiAgICB9CiAgfQogCiAgcHJvY2VzcyB7CiAgICBpZiAoJF8pIHsKICAgICAgaWYgKHRlc3QtcGF0aCAkXykgewogICAgICAgIHRvdWNoRXhpc3RpbmdGaWxlKCRfKQogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIHRvdWNoTmV3RmlsZSgkXykKICAgICAgfQogICAgfQogIH0KIAogIGVuZCB7CiAgICBpZiAoJHBhdGhzKSB7CiAgICAgIGZvcmVhY2ggKCRwYXRoIGluICRwYXRocykgewogICAgICAgIGlmICh0ZXN0LXBhdGggJHBhdGgpIHsKICAgICAgICAgIHRvdWNoRXhpc3RpbmdGaWxlKCRwYXRoKQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgIHRvdWNoTmV3RmlsZSgkcGF0aCkKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KCk5ldy1BbGlhcyB0b3VjaCBTZXQtRmlsZVRpbWUKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojICAgQWRkIGEgc3VkbyBjb21tYW5kICAgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBFbGV2YXRlLVByb2Nlc3MKewogICAgJGZpbGUsIFtzdHJpbmddJGFyZ3VtZW50cyA9ICRhcmdzOwogICAgJHBzaSA9IG5ldy1vYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm8gJGZpbGU7CiAgICAkcHNpLkFyZ3VtZW50cyA9ICRhcmd1bWVudHM7CiAgICAkcHNpLlZlcmIgPSAicnVuYXMiOwogICAgJHBzaS5Xb3JraW5nRGlyZWN0b3J5ID0gZ2V0LWxvY2F0aW9uOwogICAgW1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzXTo6U3RhcnQoJHBzaSk7Cn0gCgpOZXctQWxpYXMgc3VkbyBFbGV2YXRlLVByb2Nlc3MKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIEFkZCBHZXQtQ3VycmVudFBhdGggY21kICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmdW5jdGlvbiBHZXQtQ3VycmVudFBhdGgKewogICAgKEdldC1JdGVtIC1QYXRoICIuXCIgLVZlcmJvc2UpLkZ1bGxOYW1lCn0KCg==
