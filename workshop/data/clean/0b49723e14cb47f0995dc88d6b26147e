SamplePSReadlineProfile.ps1,825f2c087b7b608384d945e75537016b,Scan result is 1. IsMalware: 0,CiMgVGhpcyBpcyBhbiBleGFtcGxlIHByb2ZpbGUgZm9yIFBTUmVhZGxpbmUuCiMKIyBUaGlzIGlzIHJvdWdobHkgd2hhdCBJIHVzZSBzbyB0aGVyZSBpcyBzb21lIGVtcGhhc2lzIG9uIGVtYWNzIGJpbmRpbmdzLAojIGJ1dCBtb3N0IG9mIHRoZXNlIGJpbmRpbmdzIG1ha2Ugc2Vuc2UgaW4gV2luZG93cyBtb2RlIGFzIHdlbGwuCgpJbXBvcnQtTW9kdWxlIFBTUmVhZExpbmUKClNldC1QU1JlYWRMaW5lT3B0aW9uIC1FZGl0TW9kZSBFbWFjcwoKIyBTZWFyY2hpbmcgZm9yIGNvbW1hbmRzIHdpdGggdXAvZG93biBhcnJvdyBpcyByZWFsbHkgaGFuZHkuICBUaGUKIyBvcHRpb24gIm1vdmVzIHRvIGVuZCIgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRoZSBjdXJzb3IgYXQgdGhlIGVuZAojIG9mIHRoZSBsaW5lIHdoaWxlIGN5Y2xpbmcgdGhyb3VnaCBoaXN0b3J5IGxpa2UgaXQgZG9lcyB3L28gc2VhcmNoaW5nLAojIHdpdGhvdXQgdGhhdCBvcHRpb24sIHRoZSBjdXJzb3Igd2lsbCByZW1haW4gYXQgdGhlIHBvc2l0aW9uIGl0IHdhcwojIHdoZW4geW91IHVzZWQgdXAgYXJyb3csIHdoaWNoIGNhbiBiZSB1c2VmdWwgaWYgeW91IGZvcmdldCB0aGUgZXhhY3QKIyBzdHJpbmcgeW91IHN0YXJ0ZWQgdGhlIHNlYXJjaCBvbi4KU2V0LVBTUmVhZExpbmVPcHRpb24gLUhpc3RvcnlTZWFyY2hDdXJzb3JNb3Zlc1RvRW5kIApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBVcEFycm93IC1GdW5jdGlvbiBIaXN0b3J5U2VhcmNoQmFja3dhcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgRG93bkFycm93IC1GdW5jdGlvbiBIaXN0b3J5U2VhcmNoRm9yd2FyZAoKIyBUaGlzIGlzIGFuIGV4YW1wbGUgb2YgYSBtYWNybyB0aGF0IHlvdSBtaWdodCB1c2UgdG8gZXhlY3V0ZSBhIGNvbW1hbmQuCiMgVGhpcyB3aWxsIGFkZCB0aGUgY29tbWFuZCB0byBoaXN0b3J5LgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBDdHJsK0IgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gQnVpbGRDdXJyZW50RGlyZWN0b3J5IGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIkJ1aWxkIHRoZSBjdXJyZW50IGRpcmVjdG9yeSIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpSZXZlcnRMaW5lKCkKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIm1zYnVpbGQiKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkFjY2VwdExpbmUoKQp9CgojIEluIEVtYWNzIG1vZGUgLSBUYWIgYWN0cyBsaWtlIGluIGJhc2gsIGJ1dCB0aGUgV2luZG93cyBzdHlsZSBjb21wbGV0aW9uCiMgaXMgc3RpbGwgdXNlZnVsIHNvbWV0aW1lcywgc28gYmluZCBzb21lIGtleXMgc28gd2UgY2FuIGRvIGJvdGgKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtRIC1GdW5jdGlvbiBUYWJDb21wbGV0ZU5leHQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtTaGlmdCtRIC1GdW5jdGlvbiBUYWJDb21wbGV0ZVByZXZpb3VzCgojIENsaXBib2FyZCBpbnRlcmFjdGlvbiBpcyBib3VuZCBieSBkZWZhdWx0IGluIFdpbmRvd3MgbW9kZSwgYnV0IG5vdCBFbWFjcyBtb2RlLgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBTaGlmdCtDdHJsK0MgLUZ1bmN0aW9uIENvcHkKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtWIC1GdW5jdGlvbiBQYXN0ZQoKIyBDYXB0dXJlU2NyZWVuIGlzIGdvb2QgZm9yIGJsb2cgcG9zdHMgb3IgZW1haWwgc2hvd2luZyBhIHRyYW5zYWN0aW9uCiMgb2Ygd2hhdCB5b3UgZGlkIHdoZW4gYXNraW5nIGZvciBoZWxwIG9yIGRlbW9uc3RyYXRpbmcgYSB0ZWNobmlxdWUuClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtQ2hvcmQgJ0N0cmwrRCxDdHJsK0MnIC1GdW5jdGlvbiBDYXB0dXJlU2NyZWVuCgojIFRoZSBidWlsdC1pbiB3b3JkIG1vdmVtZW50IHVzZXMgY2hhcmFjdGVyIGRlbGltaXRlcnMsIGJ1dCB0b2tlbiBiYXNlZCB3b3JkCiMgbW92ZW1lbnQgaXMgYWxzbyB2ZXJ5IHVzZWZ1bCAtIHRoZXNlIGFyZSB0aGUgYmluZGluZ3MgeW91J2QgdXNlIGlmIHlvdQojIHByZWZlciB0aGUgdG9rZW4gYmFzZWQgbW92ZW1lbnRzIGJvdW5kIHRvIHRoZSBub3JtYWwgZW1hY3Mgd29yZCBtb3ZlbWVudAojIGtleSBiaW5kaW5ncy4KU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQWx0K0QgLUZ1bmN0aW9uIFNoZWxsS2lsbFdvcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQWx0K0JhY2tzcGFjZSAtRnVuY3Rpb24gU2hlbGxCYWNrd2FyZEtpbGxXb3JkClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEFsdCtCIC1GdW5jdGlvbiBTaGVsbEJhY2t3YXJkV29yZApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBBbHQrRiAtRnVuY3Rpb24gU2hlbGxGb3J3YXJkV29yZApTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBTaGlmdCtBbHQrQiAtRnVuY3Rpb24gU2VsZWN0U2hlbGxCYWNrd2FyZFdvcmQKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgU2hpZnQrQWx0K0YgLUZ1bmN0aW9uIFNlbGVjdFNoZWxsRm9yd2FyZFdvcmQKCiNyZWdpb24gU21hcnQgSW5zZXJ0L0RlbGV0ZQoKIyBUaGUgbmV4dCBmb3VyIGtleSBoYW5kbGVycyBhcmUgZGVzaWduZWQgdG8gbWFrZSBlbnRlcmluZyBtYXRjaGVkIHF1b3RlcwojIHBhcmVucywgYW5kIGJyYWNlcyBhIG5pY2VyIGV4cGVyaWVuY2UuICBJJ2QgbGlrZSB0byBpbmNsdWRlIGZ1bmN0aW9ucwojIGluIHRoZSBtb2R1bGUgdGhhdCBkbyB0aGlzLCBidXQgdGhpcyBpbXBsZW1lbnRhdGlvbiBzdGlsbCBpc24ndCBhcyBzbWFydAojIGFzIFJlU2hhcnBlciwgc28gSSdtIGp1c3QgcHJvdmlkaW5nIGl0IGFzIGEgc2FtcGxlLgoKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgJyInLCInIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBTbWFydEluc2VydFF1b3RlIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIkluc2VydCBwYWlyZWQgcXVvdGVzIGlmIG5vdCBhbHJlYWR5IG9uIGEgcXVvdGUiIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1TY3JpcHRCbG9jayB7CiAgICBwYXJhbSgka2V5LCAkYXJnKQoKICAgICRsaW5lID0gJG51bGwKICAgICRjdXJzb3IgPSAkbnVsbAogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkdldEJ1ZmZlclN0YXRlKFtyZWZdJGxpbmUsIFtyZWZdJGN1cnNvcikKCiAgICBpZiAoJGxpbmVbJGN1cnNvcl0gLWVxICRrZXkuS2V5Q2hhcikgewogICAgICAgICMgSnVzdCBtb3ZlIHRoZSBjdXJzb3IKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6U2V0Q3Vyc29yUG9zaXRpb24oJGN1cnNvciArIDEpCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAjIEluc2VydCBtYXRjaGluZyBxdW90ZXMsIG1vdmUgY3Vyc29yIHRvIGJlIGluIGJldHdlZW4gdGhlIHF1b3RlcwogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIiQoJGtleS5LZXlDaGFyKSIgKiAyKQogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlNldEN1cnNvclBvc2l0aW9uKCRjdXJzb3IgLSAxKQogICAgfQp9CgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSAnKCcsJ3snLCdbJyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBJbnNlcnRQYWlyZWRCcmFjZXMgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiSW5zZXJ0IG1hdGNoaW5nIGJyYWNlcyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGNsb3NlQ2hhciA9IHN3aXRjaCAoJGtleS5LZXlDaGFyKQogICAgewogICAgICAgIDwjY2FzZSM+ICcoJyB7IFtjaGFyXScpJzsgYnJlYWsgfQogICAgICAgIDwjY2FzZSM+ICd7JyB7IFtjaGFyXSd9JzsgYnJlYWsgfQogICAgICAgIDwjY2FzZSM+ICdbJyB7IFtjaGFyXSddJzsgYnJlYWsgfQogICAgfQoKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpJbnNlcnQoIiQoJGtleS5LZXlDaGFyKSRjbG9zZUNoYXIiKQogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlNldEN1cnNvclBvc2l0aW9uKCRjdXJzb3IgLSAxKSAgICAgICAgCn0KClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5ICcpJywnXScsJ30nIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1CcmllZkRlc2NyaXB0aW9uIFNtYXJ0Q2xvc2VCcmFjZXMgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiSW5zZXJ0IGNsb3NpbmcgYnJhY2Ugb3Igc2tpcCIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQoKICAgIGlmICgkbGluZVskY3Vyc29yXSAtZXEgJGtleS5LZXlDaGFyKQogICAgewogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpTZXRDdXJzb3JQb3NpdGlvbigkY3Vyc29yICsgMSkKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6SW5zZXJ0KCIkKCRrZXkuS2V5Q2hhcikiKQogICAgfQp9CgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBCYWNrc3BhY2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gU21hcnRCYWNrc3BhY2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiRGVsZXRlIHByZXZpb3VzIGNoYXJhY3RlciBvciBtYXRjaGluZyBxdW90ZXMvcGFyZW5zL2JyYWNlcyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGxpbmUgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kbGluZSwgW3JlZl0kY3Vyc29yKQoKICAgIGlmICgkY3Vyc29yIC1ndCAwKQogICAgewogICAgICAgICR0b01hdGNoID0gJG51bGwKICAgICAgICBzd2l0Y2ggKCRsaW5lWyRjdXJzb3JdKQogICAgICAgIHsKICAgICAgICAgICAgPCNjYXNlIz4gJyInIHsgJHRvTWF0Y2ggPSAnIic7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gIiciIHsgJHRvTWF0Y2ggPSAiJyI7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJyknIHsgJHRvTWF0Y2ggPSAnKCc7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJ10nIHsgJHRvTWF0Y2ggPSAnWyc7IGJyZWFrIH0KICAgICAgICAgICAgPCNjYXNlIz4gJ30nIHsgJHRvTWF0Y2ggPSAneyc7IGJyZWFrIH0KICAgICAgICB9CgogICAgICAgIGlmICgkdG9NYXRjaCAtbmUgJG51bGwgLWFuZCAkbGluZVskY3Vyc29yLTFdIC1lcSAkdG9NYXRjaCkKICAgICAgICB7CiAgICAgICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpEZWxldGUoJGN1cnNvciAtIDEsIDIpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpCYWNrd2FyZERlbGV0ZUNoYXIoJGtleSwgJGFyZykKICAgICAgICB9CiAgICB9Cn0KCiNlbmRyZWdpb24gU21hcnQgSW5zZXJ0L0RlbGV0ZQoKIyBTb21ldGltZXMgeW91IGVudGVyIGEgY29tbWFuZCBidXQgcmVhbGl6ZSB5b3UgZm9yZ290IHRvIGRvIHNvbWV0aGluZyBlbHNlIGZpcnN0LgojIFRoaXMgYmluZGluZyB3aWxsIGxldCB5b3Ugc2F2ZSB0aGF0IGNvbW1hbmQgaW4gdGhlIGhpc3Rvcnkgc28geW91IGNhbiByZWNhbGwgaXQsCiMgYnV0IGl0IGRvZXNuJ3QgYWN0dWFsbHkgZXhlY3V0ZS4gIEl0IGFsc28gY2xlYXJzIHRoZSBsaW5lIHdpdGggUmV2ZXJ0TGluZSBzbyB0aGUKIyB1bmRvIHN0YWNrIGlzIHJlc2V0IC0gdGhvdWdoIHJlZG8gd2lsbCBzdGlsbCByZWNvbnN0cnVjdCB0aGUgY29tbWFuZCBsaW5lLgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBBbHQrdyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBTYXZlSW5IaXN0b3J5IGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlNhdmUgY3VycmVudCBsaW5lIGluIGhpc3RvcnkgYnV0IGRvIG5vdCBleGVjdXRlIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkbGluZSA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6QWRkVG9IaXN0b3J5KCRsaW5lKQogICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlJldmVydExpbmUoKQp9CgojIEluc2VydCB0ZXh0IGZyb20gdGhlIGNsaXBib2FyZCBhcyBhIGhlcmUgc3RyaW5nClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEN0cmwrU2hpZnQrdiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQnJpZWZEZXNjcmlwdGlvbiBQYXN0ZUFzSGVyZVN0cmluZyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJQYXN0ZSB0aGUgY2xpcGJvYXJkIHRleHQgYXMgYSBoZXJlIHN0cmluZyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgQWRkLVR5cGUgLUFzc2VtYmx5IFByZXNlbnRhdGlvbkNvcmUKICAgIGlmIChbU3lzdGVtLldpbmRvd3MuQ2xpcGJvYXJkXTo6Q29udGFpbnNUZXh0KCkpCiAgICB7CiAgICAgICAgIyBHZXQgY2xpcGJvYXJkIHRleHQgLSByZW1vdmUgdHJhaWxpbmcgc3BhY2VzLCBjb252ZXJ0IFxyXG4gdG8gXG4sIGFuZCByZW1vdmUgdGhlIGZpbmFsIFxuLgogICAgICAgICR0ZXh0ID0gKFtTeXN0ZW0uV2luZG93cy5DbGlwYm9hcmRdOjpHZXRUZXh0KCkgLXJlcGxhY2UgIlxwe1pzfSpgcj9gbiIsImBuIikuVHJpbUVuZCgpCiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06Okluc2VydCgiQCdgbiR0ZXh0YG4nQCIpCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OkRpbmcoKQogICAgfQp9CgojIFNvbWV0aW1lcyB5b3Ugd2FudCB0byBnZXQgYSBwcm9wZXJ0eSBvZiBpbnZva2UgYSBtZW1iZXIgb24gd2hhdCB5b3UndmUgZW50ZXJlZCBzbyBmYXIKIyBidXQgeW91IG5lZWQgcGFyZW5zIHRvIGRvIHRoYXQuICBUaGlzIGJpbmRpbmcgd2lsbCBoZWxwIGJ5IHB1dHRpbmcgcGFyZW5zIGFyb3VuZCB0aGUgY3VycmVudCBzZWxlY3Rpb24sCiMgb3IgaWYgbm90aGluZyBpcyBzZWxlY3RlZCwgdGhlIHdob2xlIGxpbmUuClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5ICdBbHQrKCcgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gUGFyZW50aGVzaXplU2VsZWN0aW9uIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIlB1dCBwYXJlbnRoZXNpcyBhcm91bmQgdGhlIHNlbGVjdGlvbiBvciBlbnRpcmUgbGluZSBhbmQgbW92ZSB0aGUgY3Vyc29yIHRvIGFmdGVyIHRoZSBjbG9zaW5nIHBhcmVudGhlc2lzIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkc2VsZWN0aW9uU3RhcnQgPSAkbnVsbAogICAgJHNlbGVjdGlvbkxlbmd0aCA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0U2VsZWN0aW9uU3RhdGUoW3JlZl0kc2VsZWN0aW9uU3RhcnQsIFtyZWZdJHNlbGVjdGlvbkxlbmd0aCkKCiAgICAkbGluZSA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRsaW5lLCBbcmVmXSRjdXJzb3IpCiAgICBpZiAoJHNlbGVjdGlvblN0YXJ0IC1uZSAtMSkKICAgIHsKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6UmVwbGFjZSgkc2VsZWN0aW9uU3RhcnQsICRzZWxlY3Rpb25MZW5ndGgsICcoJyArICRsaW5lLlN1YlN0cmluZygkc2VsZWN0aW9uU3RhcnQsICRzZWxlY3Rpb25MZW5ndGgpICsgJyknKQogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpTZXRDdXJzb3JQb3NpdGlvbigkc2VsZWN0aW9uU3RhcnQgKyAkc2VsZWN0aW9uTGVuZ3RoICsgMikKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6UmVwbGFjZSgwLCAkbGluZS5MZW5ndGgsICcoJyArICRsaW5lICsgJyknKQogICAgICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpFbmRPZkxpbmUoKQogICAgfQp9CgojIEVhY2ggdGltZSB5b3UgcHJlc3MgQWx0KycsIHRoaXMga2V5IGhhbmRsZXIgd2lsbCBjaGFuZ2UgdGhlIHRva2VuCiMgdW5kZXIgb3IgYmVmb3JlIHRoZSBjdXJzb3IuICBJdCB3aWxsIGN5Y2xlIHRocm91Z2ggc2luZ2xlIHF1b3RlcywgZG91YmxlIHF1b3Rlcywgb3IKIyBubyBxdW90ZXMgZWFjaCB0aW1lIGl0IGlzIGludm9rZWQuClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5ICJBbHQrJyIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gVG9nZ2xlUXVvdGVBcmd1bWVudCBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJUb2dnbGUgcXVvdGVzIG9uIHRoZSBhcmd1bWVudCB1bmRlciB0aGUgY3Vyc29yIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkYXN0ID0gJG51bGwKICAgICR0b2tlbnMgPSAkbnVsbAogICAgJGVycm9ycyA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRhc3QsIFtyZWZdJHRva2VucywgW3JlZl0kZXJyb3JzLCBbcmVmXSRjdXJzb3IpCgogICAgJHRva2VuVG9DaGFuZ2UgPSAkbnVsbAogICAgZm9yZWFjaCAoJHRva2VuIGluICR0b2tlbnMpCiAgICB7CiAgICAgICAgJGV4dGVudCA9ICR0b2tlbi5FeHRlbnQKICAgICAgICBpZiAoJGV4dGVudC5TdGFydE9mZnNldCAtbGUgJGN1cnNvciAtYW5kICRleHRlbnQuRW5kT2Zmc2V0IC1nZSAkY3Vyc29yKQogICAgICAgIHsKICAgICAgICAgICAgJHRva2VuVG9DaGFuZ2UgPSAkdG9rZW4KCiAgICAgICAgICAgICMgSWYgdGhlIGN1cnNvciBpcyBhdCB0aGUgZW5kIChpdCdzIHJlYWxseSAxIHBhc3QgdGhlIGVuZCkgb2YgdGhlIHByZXZpb3VzIHRva2VuLAogICAgICAgICAgICAjIHdlIG9ubHkgd2FudCB0byBjaGFuZ2UgdGhlIHByZXZpb3VzIHRva2VuIGlmIHRoZXJlIGlzIG5vIHRva2VuIHVuZGVyIHRoZSBjdXJzb3IKICAgICAgICAgICAgaWYgKCRleHRlbnQuRW5kT2Zmc2V0IC1lcSAkY3Vyc29yIC1hbmQgJGZvcmVhY2guTW92ZU5leHQoKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJG5leHRUb2tlbiA9ICRmb3JlYWNoLkN1cnJlbnQKICAgICAgICAgICAgICAgIGlmICgkbmV4dFRva2VuLkV4dGVudC5TdGFydE9mZnNldCAtZXEgJGN1cnNvcikKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkdG9rZW5Ub0NoYW5nZSA9ICRuZXh0VG9rZW4KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhawogICAgICAgIH0KICAgIH0KCiAgICBpZiAoJHRva2VuVG9DaGFuZ2UgLW5lICRudWxsKQogICAgewogICAgICAgICRleHRlbnQgPSAkdG9rZW5Ub0NoYW5nZS5FeHRlbnQKICAgICAgICAkdG9rZW5UZXh0ID0gJGV4dGVudC5UZXh0CiAgICAgICAgaWYgKCR0b2tlblRleHRbMF0gLWVxICciJyAtYW5kICR0b2tlblRleHRbLTFdIC1lcSAnIicpCiAgICAgICAgewogICAgICAgICAgICAjIFN3aXRjaCB0byBubyBxdW90ZXMKICAgICAgICAgICAgJHJlcGxhY2VtZW50ID0gJHRva2VuVGV4dC5TdWJzdHJpbmcoMSwgJHRva2VuVGV4dC5MZW5ndGggLSAyKQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCR0b2tlblRleHRbMF0gLWVxICInIiAtYW5kICR0b2tlblRleHRbLTFdIC1lcSAiJyIpCiAgICAgICAgewogICAgICAgICAgICAjIFN3aXRjaCB0byBkb3VibGUgcXVvdGVzCiAgICAgICAgICAgICRyZXBsYWNlbWVudCA9ICciJyArICR0b2tlblRleHQuU3Vic3RyaW5nKDEsICR0b2tlblRleHQuTGVuZ3RoIC0gMikgKyAnIicKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgIyBBZGQgc2luZ2xlIHF1b3RlcwogICAgICAgICAgICAkcmVwbGFjZW1lbnQgPSAiJyIgKyAkdG9rZW5UZXh0ICsgIiciCiAgICAgICAgfQoKICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6UmVwbGFjZSgKICAgICAgICAgICAgJGV4dGVudC5TdGFydE9mZnNldCwKICAgICAgICAgICAgJHRva2VuVGV4dC5MZW5ndGgsCiAgICAgICAgICAgICRyZXBsYWNlbWVudCkKICAgIH0KfQoKIyBUaGlzIGV4YW1wbGUgd2lsbCByZXBsYWNlIGFueSBhbGlhc2VzIG9uIHRoZSBjb21tYW5kIGxpbmUgd2l0aCB0aGUgcmVzb2x2ZWQgY29tbWFuZHMuClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5ICJBbHQrJSIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gRXhwYW5kQWxpYXNlcyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJSZXBsYWNlIGFsbCBhbGlhc2VzIHdpdGggdGhlIGZ1bGwgY29tbWFuZCIgYAogICAgICAgICAgICAgICAgICAgICAgICAgLVNjcmlwdEJsb2NrIHsKICAgIHBhcmFtKCRrZXksICRhcmcpCgogICAgJGFzdCA9ICRudWxsCiAgICAkdG9rZW5zID0gJG51bGwKICAgICRlcnJvcnMgPSAkbnVsbAogICAgJGN1cnNvciA9ICRudWxsCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6R2V0QnVmZmVyU3RhdGUoW3JlZl0kYXN0LCBbcmVmXSR0b2tlbnMsIFtyZWZdJGVycm9ycywgW3JlZl0kY3Vyc29yKQoKICAgICRzdGFydEFkanVzdG1lbnQgPSAwCiAgICBmb3JlYWNoICgkdG9rZW4gaW4gJHRva2VucykKICAgIHsKICAgICAgICBpZiAoJHRva2VuLlRva2VuRmxhZ3MgLWJhbmQgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uTGFuZ3VhZ2UuVG9rZW5GbGFnc106OkNvbW1hbmROYW1lKQogICAgICAgIHsKICAgICAgICAgICAgJGFsaWFzID0gJEV4ZWN1dGlvbkNvbnRleHQuSW52b2tlQ29tbWFuZC5HZXRDb21tYW5kKCR0b2tlbi5FeHRlbnQuVGV4dCwgJ0FsaWFzJykKICAgICAgICAgICAgaWYgKCRhbGlhcyAtbmUgJG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRyZXNvbHZlZENvbW1hbmQgPSAkYWxpYXMuUmVzb2x2ZWRDb21tYW5kTmFtZSAKICAgICAgICAgICAgICAgIGlmICgkcmVzb2x2ZWRDb21tYW5kIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkZXh0ZW50ID0gJHRva2VuLkV4dGVudAogICAgICAgICAgICAgICAgICAgICRsZW5ndGggPSAkZXh0ZW50LkVuZE9mZnNldCAtICRleHRlbnQuU3RhcnRPZmZzZXQKICAgICAgICAgICAgICAgICAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6UmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAgICAgJGV4dGVudC5TdGFydE9mZnNldCArICRzdGFydEFkanVzdG1lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICRsZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvbHZlZENvbW1hbmQpCgogICAgICAgICAgICAgICAgICAgICMgT3VyIGNvcHkgb2YgdGhlIHRva2VucyB3b24ndCBoYXZlIGJlZW4gdXBkYXRlZCwgc28gd2UgbmVlZCB0bwogICAgICAgICAgICAgICAgICAgICMgYWRqdXN0IGJ5IHRoZSBkaWZmZXJlbmNlIGluIGxlbmd0aAogICAgICAgICAgICAgICAgICAgICRzdGFydEFkanVzdG1lbnQgKz0gKCRyZXNvbHZlZENvbW1hbmQuTGVuZ3RoIC0gJGxlbmd0aCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKIyBGMSBmb3IgaGVscCBvbiB0aGUgY29tbWFuZCBsaW5lIC0gbmF0dXJhbGx5ClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEYxIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1CcmllZkRlc2NyaXB0aW9uIENvbW1hbmRIZWxwIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1Mb25nRGVzY3JpcHRpb24gIk9wZW4gdGhlIGhlbHAgd2luZG93IGZvciB0aGUgY3VycmVudCBjb21tYW5kIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkYXN0ID0gJG51bGwKICAgICR0b2tlbnMgPSAkbnVsbAogICAgJGVycm9ycyA9ICRudWxsCiAgICAkY3Vyc29yID0gJG51bGwKICAgIFtQU0NvbnNvbGVVdGlsaXRpZXMuUFNDb25zb2xlUmVhZExpbmVdOjpHZXRCdWZmZXJTdGF0ZShbcmVmXSRhc3QsIFtyZWZdJHRva2VucywgW3JlZl0kZXJyb3JzLCBbcmVmXSRjdXJzb3IpCgogICAgJGNvbW1hbmRBc3QgPSAkYXN0LkZpbmRBbGwoIHsKICAgICAgICAkbm9kZSA9ICRhcmdzWzBdCiAgICAgICAgJG5vZGUgLWlzIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkxhbmd1YWdlLkNvbW1hbmRBc3RdIC1hbmQKICAgICAgICAgICAgJG5vZGUuRXh0ZW50LlN0YXJ0T2Zmc2V0IC1sZSAkY3Vyc29yIC1hbmQKICAgICAgICAgICAgJG5vZGUuRXh0ZW50LkVuZE9mZnNldCAtZ2UgJGN1cnNvcgogICAgICAgIH0sICR0cnVlKSB8IFNlbGVjdC1PYmplY3QgLUxhc3QgMQoKICAgIGlmICgkY29tbWFuZEFzdCAtbmUgJG51bGwpCiAgICB7CiAgICAgICAgJGNvbW1hbmROYW1lID0gJGNvbW1hbmRBc3QuR2V0Q29tbWFuZE5hbWUoKQogICAgICAgIGlmICgkY29tbWFuZE5hbWUgLW5lICRudWxsKQogICAgICAgIHsKICAgICAgICAgICAgJGNvbW1hbmQgPSAkRXhlY3V0aW9uQ29udGV4dC5JbnZva2VDb21tYW5kLkdldENvbW1hbmQoJGNvbW1hbmROYW1lLCAnQWxsJykKICAgICAgICAgICAgaWYgKCRjb21tYW5kIC1pcyBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5BbGlhc0luZm9dKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkY29tbWFuZE5hbWUgPSAkY29tbWFuZC5SZXNvbHZlZENvbW1hbmROYW1lCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkY29tbWFuZE5hbWUgLW5lICRudWxsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBHZXQtSGVscCAkY29tbWFuZE5hbWUgLVNob3dXaW5kb3cKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCiMKIyBDdHJsK1NoaWZ0K2ogdGhlbiB0eXBlIGEga2V5IHRvIG1hcmsgdGhlIGN1cnJlbnQgZGlyZWN0b3J5LgojIEN0cmoraiB0aGVuIHRoZSBzYW1lIGtleSB3aWxsIGNoYW5nZSBiYWNrIHRvIHRoYXQgZGlyZWN0b3J5IHdpdGhvdXQKIyBuZWVkaW5nIHRvIHR5cGUgY2QgYW5kIHdvbid0IGNoYW5nZSB0aGUgY29tbWFuZCBsaW5lLgoKIwokZ2xvYmFsOlBTUmVhZGxpbmVNYXJrcyA9IEB7fQoKU2V0LVBTUmVhZGxpbmVLZXlIYW5kbGVyIC1LZXkgQ3RybCtTaGlmdCtqIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1CcmllZkRlc2NyaXB0aW9uIE1hcmtEaXJlY3RvcnkgYAogICAgICAgICAgICAgICAgICAgICAgICAgLUxvbmdEZXNjcmlwdGlvbiAiTWFyayB0aGUgY3VycmVudCBkaXJlY3RvcnkiIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1TY3JpcHRCbG9jayB7CiAgICBwYXJhbSgka2V5LCAkYXJnKQoKICAgICRrZXkgPSBbQ29uc29sZV06OlJlYWRLZXkoJHRydWUpCiAgICAkZ2xvYmFsOlBTUmVhZGxpbmVNYXJrc1ska2V5LktleUNoYXJdID0gJHB3ZAp9CgpTZXQtUFNSZWFkbGluZUtleUhhbmRsZXIgLUtleSBDdHJsK2ogYAogICAgICAgICAgICAgICAgICAgICAgICAgLUJyaWVmRGVzY3JpcHRpb24gSnVtcERpcmVjdG9yeSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJHb3RvIHRoZSBtYXJrZWQgZGlyZWN0b3J5IiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAka2V5ID0gW0NvbnNvbGVdOjpSZWFkS2V5KCkKICAgICRkaXIgPSAkZ2xvYmFsOlBTUmVhZGxpbmVNYXJrc1ska2V5LktleUNoYXJdCiAgICBpZiAoJGRpcikKICAgIHsKICAgICAgICBjZCAkZGlyCiAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06Okludm9rZVByb21wdCgpCiAgICB9Cn0KClNldC1QU1JlYWRsaW5lS2V5SGFuZGxlciAtS2V5IEFsdCtqIGAKICAgICAgICAgICAgICAgICAgICAgICAgIC1CcmllZkRlc2NyaXB0aW9uIFNob3dEaXJlY3RvcnlNYXJrcyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtTG9uZ0Rlc2NyaXB0aW9uICJTaG93IHRoZSBjdXJyZW50bHkgbWFya2VkIGRpcmVjdG9yaWVzIiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtU2NyaXB0QmxvY2sgewogICAgcGFyYW0oJGtleSwgJGFyZykKCiAgICAkZ2xvYmFsOlBTUmVhZGxpbmVNYXJrcy5HZXRFbnVtZXJhdG9yKCkgfCAlIHsKICAgICAgICBbUFNDdXN0b21PYmplY3RdQHtLZXkgPSAkXy5LZXk7IERpciA9ICRfLlZhbHVlfSB9IHwKICAgICAgICBGb3JtYXQtVGFibGUgLUF1dG9TaXplIHwgT3V0LUhvc3QKCiAgICBbUFNDb25zb2xlVXRpbGl0aWVzLlBTQ29uc29sZVJlYWRMaW5lXTo6SW52b2tlUHJvbXB0KCkKfQoKU2V0LVBTUmVhZGxpbmVPcHRpb24gLUNvbW1hbmRWYWxpZGF0aW9uSGFuZGxlciB7CiAgICBwYXJhbShbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5MYW5ndWFnZS5Db21tYW5kQXN0XSRDb21tYW5kQXN0KQoKICAgIHN3aXRjaCAoJENvbW1hbmRBc3QuR2V0Q29tbWFuZE5hbWUoKSkKICAgIHsKICAgICAgICAnZ2l0JyB7CiAgICAgICAgICAgICRnaXRDbWQgPSAkQ29tbWFuZEFzdC5Db21tYW5kRWxlbWVudHNbMV0uRXh0ZW50CiAgICAgICAgICAgIHN3aXRjaCAoJGdpdENtZC5UZXh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAnY210JyB7CiAgICAgICAgICAgICAgICAgICAgW1BTQ29uc29sZVV0aWxpdGllcy5QU0NvbnNvbGVSZWFkTGluZV06OlJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgICAgICRnaXRDbWQuU3RhcnRPZmZzZXQsICRnaXRDbWQuRW5kT2Zmc2V0IC0gJGdpdENtZC5TdGFydE9mZnNldCwgJ2NvbW1pdCcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0K
