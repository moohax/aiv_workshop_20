QS-Config-v2.0.ps1,ea64ea484f2bd348f3811b4aa25199ff,Scan result is 1. IsMalware: 0,CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgU0NSSVBUIEdFTkVSQVRFUyBJTkkgRklMRVMgV0hJQ0ggQ0FOIEJFIFVTRUQgVE8gUEVSRk9STSBVTkFUVEVOREVEIElOU1RBTExTICMjIwojIyMgT0YgU1FMIFNFUlZFUi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjCQkJCQkJCQlIZWxwIENvbnRleHQJCQkJCQkJCQkjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCjwjCi5TWU5PUFNJUwpUaGlzIHNjcmlwdCB3aWxsIGNyZWF0ZSB0aGUgY29uZmlndXJhdGlvbi5pbmkgZmlsZShzKSBuZWNlc3NhcnkgZm9yIGFuIHVuYXR0ZW5kZWQgb3Igc2lsZW50Cmluc3RhbGxhdGlvbiBvZiBNUyBTUUwgU2VydmVyIDIwMDggdGhyb3VnaCAyMDE0IGFzIGEgU3RhbmQtQS1Mb25lIEluc3RhbmNlIG9yIGEgV2luZG93cyBGYWlsLU92ZXIgQ2x1c3Rlci4KCi5ERVNDUklQVElPTgpUaGlzIHNjcmlwdCBpcyBkZXNpZ25lZCB0byBiZSBhIHN0YXJ0IHRvIGZpbmlzaCBzb2x1dGlvbiBmb3IgdW5hdHRlbmRlZCBvciBzaWxlbnQgaW5zdGFsbGF0aW9ucwpvZiBNUyBTUUwgU2VydmVyIDIwMDggdGhyb3VnaCAyMDE0LiBJdCB3aWxsIHdhbGsgeW91IHRocm91Z2ggYSBudW1iZXIgb2YgcXVlc3Rpb25zIHNwZWNpZmljIHRvIHRoZSBzZXJ2ZXIgb3IgY2x1c3RlciAKdGhhdCB5b3UgYXJlIGluc3RhbGxpbmcgdGhpcyBpbnN0YW5jZSBvbiBhbmQgdGhlbiBjcmVhdGUgdGhlIG5lY2Vzc2FyeSBjb25maWd1cmF0aW9uLmluaSBmaWxlcy4gCllvdXIgdGVtcGxhdGUgZmlsZSB3aWxsIGJlIHNhdmVkIHRvIGEgbG9jYXRpb24gb2YgeW91ciBjaG9pY2UuCgouRVhBTVBMRQouXFFTLUNvbmZpZy12Mi4wLnBzMQoKLk5PVEVTCkF1dGhvcjogRGVyaWsgSGFtbWVyClR3aXR0ZXI6IEBTUUxIYW1tZXIKVVJMOiBodHRwOi8vd3d3LnNxbGhhbW1lci5jb20vYmxvZy9xcy1jb25maWcvCgouSU5QVVRTCk5vbmUuCgouT1VUUFVUUwpOb25lLgojPgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjI0luY2x1ZGVzIGFuZCBEZWNsYXJlcyMjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiNsb2FkIHdpbmRvd3MgZm9ybSBhc3NlbWJseQpbcmVmbGVjdGlvbi5hc3NlbWJseV06OmxvYWR3aXRocGFydGlhbG5hbWUoJ3N5c3RlbS53aW5kb3dzLmZvcm1zJykgfCBPdXQtTnVsbDsgCgojSW5zdGFudGlhdGVzIGEgbmV3IGNvbSBvYmplY3Qgd2UnbGwgdXNlIGZvciBjaG9vc2luZyBmb2xkZXJzCiRvYmplY3QgPSBOZXctT2JqZWN0IC1jb21PYmplY3QgU2hlbGwuQXBwbGljYXRpb24KCiNJbnN0YW50aWF0ZXMgYSBuZXcgUVNDb25maWcuU1FMSW5zdGFsbENvbmZpZ3VyYXRpb24gb2JqZWN0CiRzY3JpcHREaXIgPSBTcGxpdC1QYXRoIC1QYXRoICRNeUludm9jYXRpb24uTXlDb21tYW5kLkRlZmluaXRpb24gLVBhcmVudAouICRzY3JpcHREaXJcUVMtQ29uZmlnLXYyLjAuU1FMSW5zdGFsbENvbmZpZ3VyYXRpb24uY2xhc3MucHMxOyAKJFNjcmlwdDpjb25maWcgPSBHZXQtU1FMSW5zdGFsbENvbmZpZ3VyYXRpb247CgojIyMjIyMjIyMjIyMjIyMjCiMjI0Z1bmN0aW9ucyMjIyMKIyMjIyMjIyMjIyMjIyMjIwoKI2RpYWxvZyBidWlsZGVyCmZ1bmN0aW9uIENyZWF0ZVllc05vRGlhbG9nKFtzdHJpbmddJGNhcHRpb24sIFtzdHJpbmddJHF1ZXN0aW9uLCBbc3RyaW5nXSR5ZXNNc2csIFtzdHJpbmddJG5vTXNnLCBbaW50XSRkZWZhdWx0ID0gMCkKewogICAgJFllcyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImWWVzIiwkeWVzTXNnCgkkTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk5vIiwkbm9Nc2cKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkWWVzLCRObykKCSRjYXB0aW9uID0gJGNhcHRpb24KCSRtZXNzYWdlID0gJHF1ZXN0aW9uCgkkY2hvaWNlID0gJEhvc3QuVUkuUHJvbXB0Rm9yQ2hvaWNlKCRjYXB0aW9uLCRtZXNzYWdlLCRjaG9pY2VzLCRkZWZhdWx0KQoKICAgIHN3aXRjaCAoJGNob2ljZSkKICAgIHsKICAgICAgICAwIHsgJG91dHB1dD0iWUVTIiB9CiAgICAgICAgMSB7ICRvdXRwdXQ9Ik5PIiB9CiAgICB9CgogICAgcmV0dXJuICRvdXRwdXQ7Cn0KCiN3ZWxjb21lIG1lc3NhZ2UKZnVuY3Rpb24gV2VsY29tZU1lc3NhZ2UoKQp7CiAgICBXcml0ZS1Ib3N0IEAiClFTLUNvbmZpZyB2Mi4wYHRPcGVuIEJFVEEKQXV0aG9yOmB0YHREZXJpayBIYW1tZXIKVHdpdHRlcjpgdEBTUUxIYW1tZXIKV2Vic2l0ZTpgdHd3dy5zcWxoYW1tZXIuY29tCiJAIC1CYWNrZ3JvdW5kQ29sb3IgQmxhY2sgLUZvcmVncm91bmRDb2xvciBHcmVlbgoKCSNMZXQgdGhlIHVzZXIga25vdyB3aGF0IHRoaXMgc2NyaXB0IGRvZXMKCVtzeXN0ZW0uV2luZG93cy5Gb3Jtcy5NZXNzYWdlQm94XTo6c2hvdygiWW91IGFyZSBhYm91dCB0byBjcmVhdGUgaW5pIGZpbGVzIHRoYXQgY2FuIGJlIHVzZWQgdG8gYXV0b21hdGUgaW5zdGFsbGF0aW9uIG9mIFNRTCBpbnN0YW5jZXMgaW50byBhIHN0YW5kLWFsb25lIHNlcnZlciBvciBjbHVzdGVyLgoJCQkJCldoZW4gY2hvb3NpbmcgdG8gY3JlYXRlIHRoZSBpbmkgZm9yIGEgbmV3IGNsdXN0ZXJlZCBpbnN0YW5jZSBpdCB3aWxsIGFsc28gY3JlYXRlIHRoZSBpbmkgZmlsZSB1c2VkIHRvIGFkZCBub2RlcyB0byB0aGF0IGNsdXN0ZXIuCgpUaGUgaW5pIGZpbGVzIGNhbiBiZSByZW5hbWVkIHdoZW4gdGhleSBhcmUgY29tcGxldGVkLgoJIikKfQoKI1NldCB2YXJpYWJsZXMgZm9yIGZpbGUgbmFtaW5nCmZ1bmN0aW9uIFNldEZpbGVQYXRoKCkKewoJI0dyYWIgdGhlIGN1cnJlbnQgdXNlciBhbmQgY3VycmVudCB0aW1lLCB3ZSdsbCB1c2UgdGhlc2UgdG8gY3JlYXRlIHRoZSBmaWxlCgkkQ3VyclVzZXIgPSBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKSB8IHNlbGVjdCBOYW1lCgkkU2NyaXB0OkZpbGVDcmVhdG9yID0gJEN1cnJVc2VyLk5hbWUKCSRTY3JpcHQ6Q3VyckRhdGUgPSAoR2V0LURhdGUgLVVGb3JtYXQgIiVZLSVtLSVkICVIOiVNIikgCgkkQ3VyckRhdGVTYW5pdGl6ZWQgPSAkQ3VyckRhdGUgLXJlcGxhY2UgIjoiLCIiCgoJI1N0cmlwIG91dCB0aGUgZG9tYWluIGZyb20gdGhlIHVzZXIgYWNjb3VudAoJaWYgKCRGaWxlQ3JlYXRvciAtaWxpa2UgIipcKiIpIAoJewoJCSRzdHJpbmcgPSAkRmlsZUNyZWF0b3IuU3BsaXQoIlwiKQoJCSRGaWxlUGFydDEgPSAoJHN0cmluZ1sxXSkgLXJlcGxhY2UgIlwuIiwgIiAiCgkJJEZpbGVQYXJ0MSA9IChHZXQtQ3VsdHVyZSkuVGV4dEluZm8uVG9UaXRsZUNhc2UoJEZpbGVQYXJ0MSkKCX0KCWVsc2UKCXsKCQkkRmlsZVBhcnQxID0gKEdldC1DdWx0dXJlKS5UZXh0SW5mby5Ub1RpdGxlQ2FzZSgkRmlsZUNyZWF0b3IpCgl9CgoJI0N1cnJlbnQgdXNlciArIGRhdGUgdGltZSA9IGZpbGVuYW1lCQoJJFNjcmlwdDpGaWxlTmFtZSA9ICRGaWxlUGFydDErIiAiKyRDdXJyRGF0ZVNhbml0aXplZCsiIE5ldyBJbnN0YW5jZS5pbmkiCgkkU2NyaXB0OkZpbGVOYW1lQWRkTm9kZSA9ICRGaWxlUGFydDErIiAiKyRDdXJyRGF0ZVNhbml0aXplZCsiIEFkZCBOb2RlLmluaSIKCQkKCSNBc2sgdGhlIHVzZXIgZm9yIHRoZSBwYXRoIHdoZXJlIHRoZXkgd2FudCB0byBwdXQgdGhlIGluaSBmaWxlCQoJJGluaWZvbGRlciA9ICRvYmplY3QuQnJvd3NlRm9yRm9sZGVyKDAsICJQbGVhc2UgY2hvb3NlIHRoZSBmb2xkZXIgd2hlcmUgeW91IHdpc2ggdG8gcHV0IHRoZSBJTkkgZmlsZSIsIDApCglpZiAoJGluaWZvbGRlciAtbmUgJG51bGwpIAoJewoJCSRpbmkgPSAkaW5pZm9sZGVyLnNlbGYuUGF0aCAKCQkjaWYgd2UgdXNlIGEgcm9vdCBkcml2ZSB3ZSBuZWVkIHRvIHJlbW92ZSB0aGUgXAoJCSRpbmlSb290ID0kaW5pZm9sZGVyLlNlbGYuVHlwZQoJCWlmICgkaW5pUm9vdCAtZXEgIkxvY2FsIERpc2siKSAKCQl7IAoJCQkkaW5pID0gJGluaSAtcmVwbGFjZSAiXFwiLCIiIAoJCX0KCQkkU2NyaXB0OmZpbGUgPSAkaW5pICsiXCIrICRmaWxlTmFtZQoJCSRTY3JpcHQ6RmlsZU5hbWVBZGROb2RlID0gJGluaSArIlwiKyAkRmlsZU5hbWVBZGROb2RlCgl9Cn0KCiNDcmVhdGUgY2hvaWNlcyBmb3Igd2hldGhlciB3ZSB3YW50IHRvIGluc3RhbGwgYSBuZXcgY2x1c3RlcmVkIGluc3RhbmNlLCBhZGQgYSBub2RlLCBvciBwZXJmb3JtIGEgc3RhbmQtYWxvbmUgaW5zdGFsbApmdW5jdGlvbiBTZXRJbnN0YWxsYXRpb25UeXBlKCkKewoJJFZlcnNpb24xMCA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICIxJjAgKDIwMDgvMjAwOCBSMikiLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgdXNlIGNvbmZpZ3VyYXRpb25zIGZvciBTUUwgU2VydmVyIDIwMDgvMjAwOCBSMi4iCgkkVmVyc2lvbjExID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIjEmMSAoMjAxMikiLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgdXNlIGNvbmZpZ3VyYXRpb25zIGZvciBTUUwgU2VydmVyIDIwMTIuIgogICAgJFZlcnNpb24xMiA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICIxJjIgKDIwMTQpIiwiQnkgc2VsZWN0aW5nIHRoaXMgb3B0aW9uIHlvdSB3aWxsIHVzZSBjb25maWd1cmF0aW9ucyBmb3IgU1FMIFNlcnZlciAyMDE0LiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkVmVyc2lvbjEwLCRWZXJzaW9uMTEsJFZlcnNpb24xMikKCSRjYXB0aW9uID0gIlF1ZXN0aW9uISIKCSRtZXNzYWdlID0gIldoYXQgdmVyc2lvbiBvZiBTUUwgU2VydmVyIGFyZSB5b3UgbG9va2luZyB0byBpbnN0YWxsPyIKCSRWZXJzaW9uQ2hvaWNlID0gJEhvc3QuVUkuUHJvbXB0Rm9yQ2hvaWNlKCRjYXB0aW9uLCRtZXNzYWdlLCRjaG9pY2VzLDIpCgoJc3dpdGNoICgkVmVyc2lvbkNob2ljZSkKCXsKCQkwIHskY29uZmlnLk1ham9yU1FMVmVyc2lvbiA9IDEwfQoJCTEgeyRjb25maWcuTWFqb3JTUUxWZXJzaW9uID0gMTF9CgkJMiB7JGNvbmZpZy5NYWpvclNRTFZlcnNpb24gPSAxMn0KICAgICAgICBkZWZhdWx0IHsgJFNjcmlwdDpNYWpvclNRTFZlcnNpb24gPSAwIH0KCX0KCiAgICAkSW5zdGFsbENsdXN0ZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk5ldyBDbHVzdGVyZWQgSW5zdGFuY2UiLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgZ2VuZXJhdGUgdHdvIGluaSBmaWxlcy4gT25lIGZvciB0aGUgbmV3IGluc3RhbmNlIGluc3RhbGxhdGlvbiBhbmQgb25lIHRvIGFkZCBhIG5vZGUuIgoJJEFkZE5vZGUgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkFkZCBOb2RlIFRvIENsdXN0ZXIiLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgc2tpcCBzZXZlcmFsIGlycmVsZXZhbnQgcXVlc3Rpb25zIGFuZCBvbmx5IGdlbmVyYXRlIG9uZSBpbmkgZmlsZSBkZXNpZ25lZCBmb3IgYWRkaW5nIGEgbm9kZSB0byBhbiBleGlzdGluZyBpbnN0YW5jZS4iCgkkU3RhbmRBbG9uZSA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICJOZXcgJlN0YW5kIEFsb25lIEluc3RhbmNlIiwiQnkgc2VsZWN0aW5nIHRoaXMgb3B0aW9uIHlvdSB3aWxsIGdlbmVyYXRlIG9uZSBpbmkgZmlsZSBuZWNlc3NhcnkgdG8gaW5zdGFsbCB5b3VyIGluc3RhbmNlLiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkSW5zdGFsbENsdXN0ZXIsJEFkZE5vZGUsJFN0YW5kQWxvbmUpCgkkY2FwdGlvbiA9ICJRdWVzdGlvbiEiCgkkbWVzc2FnZSA9ICJJbnN0YWxsIHN0YW5kLWFsb25lIGluc3RhbmNlLCBjbHVzdGVyZWQgaW5zdGFuY2Ugb3IgYWRkIG5vZGUgdG8gZXhpc3RpbmcgY2x1c3Rlcj8iCgkkSW5zdGFsbENob2ljZSA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkY2FwdGlvbiwkbWVzc2FnZSwkY2hvaWNlcywyKQoKCXN3aXRjaCAoJEluc3RhbGxDaG9pY2UpCgl7CgkJMCB7JFNjcmlwdDpJbnN0YWxsQ2hvaWNlPSJJTlNUQUxMQ0xVU1RFUiJ9CgkJMSB7JFNjcmlwdDpJbnN0YWxsQ2hvaWNlPSJBREROT0RFIn0KCQkyIHskU2NyaXB0Okluc3RhbGxDaG9pY2U9IlNUQU5EQUxPTkVJTlNUQUxMIn0KCX0KfQoKI1NldCBub24tY29uZmlndXJhYmxlIG9wdGlvbnMKZnVuY3Rpb24gV3JpdGVOb25Db25maWd1cmFibGVPcHRpb25zKCkKewogICAgI0NvbW1vbiBkZWZhdWx0IHNldHRpbmdzCiAgICAkY29uZmlnLkNyZWF0b3IgPSAkRmlsZUNyZWF0b3I7CiAgICAkY29uZmlnLlg4NiA9ICRmYWxzZTsKICAgICRjb25maWcuQWRkQ3VycmVudFVzZXJBc1NRTEFkbWluID0gJGZhbHNlOwkKCiAgICBpZiAoKCRJbnN0YWxsQ2hvaWNlIC1lcSAiU1RBTkRBTE9ORUlOU1RBTEwiKSAtb3IgKCRJbnN0YWxsQ2hvaWNlIC1lcSAiSU5TVEFMTENMVVNURVIiKSkKICAgIHsKICAgICAgICAjSW5zdGFsbCBzcGVjaWZpYyBzZXR0aW5ncwoJICAgIGlmICgkSW5zdGFsbENob2ljZSAtZXEgIlNUQU5EQUxPTkVJTlNUQUxMIikKCSAgICB7CgkJICAgICNJbnN0YWxsaW5nIG5ldyBzZXJ2ZXIKICAgICAgICAgICAgJGNvbmZpZy5BY3Rpb24gPSAnSW5zdGFsbCc7CgkJICAgIAoJCSAgICAjRGVmYXVsdCBzZXR0aW5ncwogICAgICAgICAgICAkY29uZmlnLkFndFN2Y1N0YXJ0dXBUeXBlID0gJ0F1dG9tYXRpYyc7CiAgICAgICAgICAgICRjb25maWcuU1FMU3ZjU3RhcnR1cFR5cGUgPSAnQXV0b21hdGljJzsKCQkgICAgJGNvbmZpZy5Ccm93c2VyU3ZjU3RhcnR1cFR5cGUgPSAnQXV0b21hdGljJzsKCQkgICAgJGNvbmZpZy5UQ1BFbmFibGVkID0gMTsKCSAgICB9CiAgICAgICAgZWxzZWlmICgkSW5zdGFsbENob2ljZSAtZXEgIklOU1RBTExDTFVTVEVSIikKICAgICAgICB7CiAgICAgICAgICAgICNJbnN0YWxsaW5nIG5ldyBjbHVzdGVyCiAgICAgICAgICAgICRjb25maWcuQWN0aW9uID0gJ0luc3RhbGxGYWlsb3ZlckNsdXN0ZXInOwogICAgICAgIH0KICAgIH0KICAgIGVsc2VpZiAoJEluc3RhbGxDaG9pY2UgLWVxICJBREROT0RFIikKICAgIHsKICAgICAgICAjQWRkaW5nIGEgbmV3IG5vZGUKICAgICAgICAkY29uZmlnLkFjdGlvbiA9ICdBZGROb2RlJzsKICAgIH0KfQoKI1NldCBTUUwgdmlydHVhbCBuZXR3b3JrIG5hbWUsIEluc3RhbmNlIG5hbWUsIGFuZCBJUApmdW5jdGlvbiBDb25maWd1cmVJbnN0YW5jZU9wdGlvbnMoKQp7CiAgICAjU1FMIEluc3RhbmNlIE5hbWUgb3IgZGVmYXVsdAoJJFllcyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImWWVzIiwiQnkgc2VsZWN0aW5nIHRoaXMgb3B0aW9uIHlvdSB3aWxsIGFkZCB1cGRhdGVzIHRvIHRoaXMgc2V0IG9mIGluc3RhbGxzLiIKCSRObyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImTm8iLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgbm90IGFwcGVuZCB1cGRhdGVzIHRvIHRoaXMgaW5zdGFsbCBzZXQuIgoJJGNob2ljZXMgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uW11dKCRZZXMsJE5vKQoJJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJJG1lc3NhZ2UgPSAiV291bGQgeW91IGxpa2UgdG8gaW5jbHVkZSB1cGRhdGVzIGluIHRoaXMgaW5zdGFsbD8iCgkkSW5jbHVkZVVwZGF0ZXMgPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJGNhcHRpb24sJG1lc3NhZ2UsJGNob2ljZXMsMCkKCglzd2l0Y2ggKCRJbmNsdWRlVXBkYXRlcykKCXsKCQkwIHskU2NyaXB0OkluY2x1ZGVVcGRhdGVzPSJZRVMifQoJCTEgeyRTY3JpcHQ6SW5jbHVkZVVwZGF0ZXM9Ik5PIn0KCX0KCQkJCglpZiAoICRTY3JpcHQ6SW5jbHVkZVVwZGF0ZXMgLWVxICJZRVMiICkKCXsKICAgICAgICAkVXBkYXRlUGF0aCA9IFJlYWQtSG9zdCAiV2hlcmUgd291bGQgeW91IGxpa2UgeW91ciB1cGRhdGVzIHRvIGNvbWUgZnJvbT8gSW5wdXQgYCJNVWAiIGZvciBNaWNyb3NvZnQgVXBkYXRlcyBvciBhIGRpcmVjdG9yeSBwYXRoIgoKICAgICAgICAkY29uZmlnLlVwZGF0ZVNvdXJjZSA9ICRVcGRhdGVQYXRoOwogICAgICAgICRjb25maWcuVXBkYXRlRW5hYmxlZCA9ICR0cnVlOwoJfQoJZWxzZQoJewoJCSRjb25maWcuVXBkYXRlRW5hYmxlZCA9ICRmYWxzZTsKCX0KCglzd2l0Y2ggKCAkSW5zdGFsbENob2ljZSApCgl7CgkJIlNUQU5EQUxPTkVJTlNUQUxMIgoJCXsKCQkJI1NRTCBJbnN0YW5jZSBOYW1lIG9yIGRlZmF1bHQKCQkJJFllcyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImWWVzIiwiQnkgc2VsZWN0aW5nIHRoaXMgb3B0aW9uIHlvdSB3aWxsIGluc3RhbGwgYSBkZWZhdWx0IGluc3RhbmNlIGJ5IHRoZSBuYW1lIG9mIGAiTVNTUUxTZXJ2ZXJgIi4iCgkJCSRObyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImTm8iLCJCeSBzZWxlY3RpbmcgdGhpcyBvcHRpb24geW91IHdpbGwgaW5zdGFsbCBhbiBpbnN0YW5jZSB3aXRoIGEgbmFtZSB0aGF0IHlvdSBjaG9vc2UuIgoJCQkkY2hvaWNlcyA9IFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb25bXV0oJFllcywkTm8pCgkJCSRjYXB0aW9uID0gIlF1ZXN0aW9uISIKCQkJJG1lc3NhZ2UgPSAiSXMgdGhpcyBnb2luZyB0byBiZSBhIGRlZmF1bHQgaW5zdGFuY2U/IgoJCQkkSXNEZWZhdWx0SW5zdGFuY2UgPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJGNhcHRpb24sJG1lc3NhZ2UsJGNob2ljZXMsMSkKCgkJCXN3aXRjaCAoJElzRGVmYXVsdEluc3RhbmNlKQoJCQl7CgkJCQkwIHskU2NyaXB0OklzRGVmYXVsdEluc3RhbmNlPSJZRVMifQoJCQkJMSB7JFNjcmlwdDpJc0RlZmF1bHRJbnN0YW5jZT0iTk8ifQoJCQl9CgkJCQoJCQlpZiAoICRTY3JpcHQ6SXNEZWZhdWx0SW5zdGFuY2UgLWVxICJZRVMiICkKCQkJewoJCQkJJFNjcmlwdDpTUUxJbnN0YW5jZU5hbWUgPSAiTVNTUUxTRVJWRVIiCiAgICAgICAgICAgICAgICAkY29uZmlnLkluc3RhbmNlTmFtZSA9ICRTUUxJbnN0YW5jZU5hbWU7CgkJCQkkY29uZmlnLkluc3RhbmNlSWQgPSAkU1FMSW5zdGFuY2VOYW1lOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJJFNRTEluc3RhbmNlTmFtZSA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIFNRTCBpbnN0YW5jZSBuYW1lCglpZTogQ0xEQjAwMUEiCgkJCQkkU2NyaXB0OlNRTEluc3RhbmNlTmFtZSA9ICRTUUxJbnN0YW5jZU5hbWUuVG9VcHBlcigpCiAgICAgICAgICAgICAgICAkY29uZmlnLkluc3RhbmNlTmFtZSA9ICRTUUxJbnN0YW5jZU5hbWU7CgkJCQkkY29uZmlnLkluc3RhbmNlSWQgPSAkU1FMSW5zdGFuY2VOYW1lOwoJCQl9CgkJfQoJCSJJTlNUQUxMQ0xVU1RFUiIKCQl7CgkJCSNTUUwgVmlydHVhbCBOYW1lCgkJCSRTUUxWaXJ0dWFsTmFtZSA9IHJlYWQtaG9zdCAiRW50ZXIgdGhlIFNRTCB2aXJ0dWFsIG5ldHdvcmsgbmFtZQoJaWU6IENMLURCLTAwMS1BIgoJCQkkU2NyaXB0OlNRTFZpcnR1YWxOYW1lID0gJFNRTFZpcnR1YWxOYW1lLlRvVXBwZXIoKQogICAgICAgICAgICAkY29uZmlnLkZhaWxvdmVyQ2x1c3Rlck5ldHdvcmtOYW1lID0gJFNRTFZpcnR1YWxOYW1lOwoJCQkJCgkJCSNTUUwgSW5zdGFuY2UgTmFtZSAod2lsbCBhbHNvIHVzZSBmb3IgSW5zdGFuY2UgSUQgYW5kIGZhaWxvdmVyIGNsdXN0ZXIgZ3JvdXApCgkJCSRTUUxJbnN0YW5jZU5hbWUgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSBTUUwgaW5zdGFuY2UgbmFtZQoJaWU6IENMREIwMDFBIgoJCQkkU2NyaXB0OlNRTEluc3RhbmNlTmFtZSA9ICRTUUxJbnN0YW5jZU5hbWUuVG9VcHBlcigpCiAgICAgICAgICAgICRjb25maWcuSW5zdGFuY2VOYW1lID0gJFNRTEluc3RhbmNlTmFtZTsKCQkJJGNvbmZpZy5JbnN0YW5jZUlkID0gJFNRTEluc3RhbmNlTmFtZTsKICAgICAgICAgICAgJGNvbmZpZy5GYWlsb3ZlckNsdXN0ZXJHcm91cCA9ICRTUUxWaXJ0dWFsTmFtZTsKCgkJCSNJUEFkZHJlc3MgKHJ1bm5pbmcgSVBWNCBvbmx5KQogICAgICAgICAgICAkQ2x1c3Rlck5ldHdvcmtOYW1lID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgQ2x1c3RlciBOZXR3b3JrIE5hbWUgKGllLiBDbHVzdGVyIE5ldHdvcmsgMSkiCgkJCSRJUEFkZHJlc3MgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSBJUCBBZGRyZXNzIChJUHY0IG9ubHkpIgogICAgICAgICAgICAkU3VibmV0ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgc3VibmV0IgogICAgICAgICAgICAkY29uZmlnLkZhaWxvdmVyQ2x1c3RlcklwQWRkcmVzc0xpc3QgKz0gIklQdjQ7JElQQWRkcmVzczskQ2x1c3Rlck5ldHdvcmtOYW1lOyRTdWJuZXQiOwoJCX0KCQkiQURETk9ERSIKCQl7CgkJCSNTUUwgVmlydHVhbCBOYW1lCgkJCSRTUUxWaXJ0dWFsTmFtZSA9IHJlYWQtaG9zdCAiRW50ZXIgdGhlIFNRTCB2aXJ0dWFsIG5ldHdvcmsgbmFtZQoJCQlpZTogQ0wtREItMDAxLUEiCgkJCSRTY3JpcHQ6U1FMVmlydHVhbE5hbWUgPSAkU1FMVmlydHVhbE5hbWUuVG9VcHBlcigpCiAgICAgICAgICAgICRjb25maWcuRmFpbG92ZXJDbHVzdGVyTmV0d29ya05hbWUgPSAkU1FMVmlydHVhbE5hbWU7CgoJCQkjU1FMIEluc3RhbmNlIE5hbWUgKHdpbGwgYWxzbyB1c2UgZm9yIEluc3RhbmNlIElEIGFuZCBmYWlsb3ZlciBjbHVzdGVyIGdyb3VwKQoJCQkkU1FMSW5zdGFuY2VOYW1lID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgU1FMIGluc3RhbmNlIG5hbWUKCQkJaWU6IENMREIwMDFBIgoJCQkkU2NyaXB0OlNRTEluc3RhbmNlTmFtZSA9ICRTUUxJbnN0YW5jZU5hbWUuVG9VcHBlcigpCiAgICAgICAgICAgICRjb25maWcuSW5zdGFuY2VOYW1lID0gJFNRTEluc3RhbmNlTmFtZTsKICAgICAgICAgICAgJGNvbmZpZy5GYWlsb3ZlckNsdXN0ZXJHcm91cCA9ICRTUUxWaXJ0dWFsTmFtZTsKCQl9CgkJZGVmYXVsdAoJCXsKCQkJV3JpdGUtRXJyb3IgIkluc3RhbGxhdGlvbiBjaG9pY2Ugbm90IHJlY29nbml6ZWQuIgoJCX0KCX0KfQoKZnVuY3Rpb24gQWNjZXB0RmVhdHVyZXMoJENoZWNrZWRMaXN0Qm94KQp7CiAgICAjdmFsaWRhdGUgZW50cnkKICAgIGlmKCgkQ2hlY2tlZExpc3RCb3ggLWVxICRudWxsKSAtb3IgKCRDaGVja2VkTGlzdEJveC5DaGVja2VkSXRlbXMuQ291bnQgLWVxIDApKQogICAgewogICAgICAgIFtXaW5kb3dzLkZvcm1zLk1lc3NhZ2VCb3hdOjpTaG93KCJZb3UgbXVzdCBzZWxlY3QgYXQgbGVhc3Qgb25lIGZlYXR1cmUuIiwgIk5vIGZlYXR1cmUgc2VsZWN0ZWQiLCBbV2luZG93cy5Gb3Jtcy5NZXNzYWdlQm94QnV0dG9uc106Ok9LKQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGZvcmVhY2ggKCRpdGVtIGluICRDaGVja2VkTGlzdEJveC5DaGVja2VkSXRlbXMpCiAgICAgICAgewogICAgICAgICAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLlNldF9JdGVtKCRpdGVtLlRvU3RyaW5nKCksICR0cnVlKTsKCiAgICAgICAgICAgIHN3aXRjaCAoJGl0ZW0uVG9TdHJpbmcoKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIkRhdGFiYXNlIGVuZ2luZSIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIlNRTEVOR0lORSJ9CiAgICAgICAgICAgICAgICAiUmVwbGljYXRpb24iIHskY29uZmlnLkZlYXR1cmVMaXN0ICs9ICJSRVBMSUNBVElPTiJ9CiAgICAgICAgICAgICAgICAiRnVsbC10ZXh0IGFuZCBzZW1hbnRpYyBleHRyYWN0aW9ucyBmb3Igc2VhcmNoIiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiRlVMTFRFWFQifQogICAgICAgICAgICAgICAgIkRhdGEgcXVhbGl0eSBzZXJ2aWNlcyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIkRRIn0KICAgICAgICAgICAgICAgICJBbmFseXNpcyBzZXJ2aWNlcyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIkFTIn0KICAgICAgICAgICAgICAgICJSZXBvcnRpbmcgc2VydmljZXMgLSBuYXRpdmUiIHskY29uZmlnLkZlYXR1cmVMaXN0ICs9ICJSUyJ9CiAgICAgICAgICAgICAgICAiUmVwb3J0aW5nIHNlcnZpY2VzIC0gc2hhcmVwb2ludCIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIlJTX1NIUCJ9CiAgICAgICAgICAgICAgICAiUmVwb3J0aW5nIHNlcnZpY2VzIGFkZC1pbiBmb3Igc2hhcmVwb2ludCBwcm9kdWN0cyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIlJTX1NIUFdGRSJ9CiAgICAgICAgICAgICAgICAiRGF0YSBxdWFsaXR5IGNsaWVudCIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIkRRQyJ9CiAgICAgICAgICAgICAgICAiQWxsIFRvb2xzIiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiVE9PTFMifQogICAgICAgICAgICAgICAgIkJ1c2luZXNzIEludGVsbGlnZW5jZSBEZXZlbG9wbWVudCBTdHVkaW8iIHskY29uZmlnLkZlYXR1cmVMaXN0ICs9ICJCSURTIn0KICAgICAgICAgICAgICAgICJDbGllbnQgdG9vbHMgY29ubmVjdGl2aXR5IiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiQ09OTiJ9CiAgICAgICAgICAgICAgICAiSW50ZWdyYXRpb24gc2VydmljZXMiIHskY29uZmlnLkZlYXR1cmVMaXN0ICs9ICJJUyJ9CiAgICAgICAgICAgICAgICAiQ2xpZW50IHRvb2xzIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiQkMifQogICAgICAgICAgICAgICAgIkNsaWVudCB0b29scyBTREsiIHskY29uZmlnLkZlYXR1cmVMaXN0ICs9ICJTREsifQogICAgICAgICAgICAgICAgIkRvY3VtZW50YXRpb24gY29tcG9uZW50cyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIkJPTCJ9CiAgICAgICAgICAgICAgICAiTWFuYWdlbWVudCB0b29scyAtIGJhc2ljIiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiU1NNUyJ9CiAgICAgICAgICAgICAgICAiTWFuYWdlbWVudCB0b29scyAtIGFkdmFuY2VkIiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiQURWX1NTTVMifQogICAgICAgICAgICAgICAgIkRpc3RyaWJ1dGVkIHJlcGxheSBjb250cm9sbGVyIiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiRFJFUExBWV9DVExSIn0KICAgICAgICAgICAgICAgICJEaXN0cmlidXRlZCByZXBsYXkgY2xpZW50IiB7JGNvbmZpZy5GZWF0dXJlTGlzdCArPSAiRFJFUExBWV9DTFQifQogICAgICAgICAgICAgICAgIlNRTCBjbGllbnQgY29ubmVjdGl2aXR5IFNESyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIlNOQUNfU0RLIn0KICAgICAgICAgICAgICAgICJNYXN0ZXIgZGF0YSBzZXJ2aWNlcyIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIk1EUyJ9CiAgICAgICAgICAgICAgICAiTG9jYWxEYiIgeyRjb25maWcuRmVhdHVyZUxpc3QgKz0gIkxvY2FsRGIifQogICAgICAgICAgICAgICAgZGVmYXVsdCB7V3JpdGUtSG9zdCAiU2VsZWN0ZWQgZmVhdHVyZSAoIiArICRpdGVtLlRvU3RyaW5nKCkgKyAiKSBub3QgcmVjb2duaXplZC4gRGVidWcgc2NyaXB0LiJ9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRGZWF0dXJlRm9ybS5DbG9zZSgpIHwgT3V0LU51bGw7CiAgICB9Cn0KCmZ1bmN0aW9uIEluaXRpYWxpemVGZWF0dXJlTGlzdChbUkVGXSRDaGVja2VkTGlzdEJveCkKewogICAgW2hhc2h0YWJsZV0kU2NyaXB0OkZlYXR1cmVIYXNoID0gQHt9OwogICAgJFNjcmlwdDpGZWF0dXJlSGFzaC5BZGQoIkRhdGFiYXNlIGVuZ2luZSIsICRmYWxzZSk7ICAgIAogICAgJFNjcmlwdDpGZWF0dXJlSGFzaC5BZGQoIlJlcGxpY2F0aW9uIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJGdWxsLXRleHQgYW5kIHNlbWFudGljIGV4dHJhY3Rpb25zIGZvciBzZWFyY2giLCAkZmFsc2UpOwogICAgJFNjcmlwdDpGZWF0dXJlSGFzaC5BZGQoIkRhdGEgcXVhbGl0eSBzZXJ2aWNlcyIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiQW5hbHlzaXMgc2VydmljZXMiLCAkZmFsc2UpOwogICAgJFNjcmlwdDpGZWF0dXJlSGFzaC5BZGQoIlJlcG9ydGluZyBzZXJ2aWNlcyAtIG5hdGl2ZSIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiUmVwb3J0aW5nIHNlcnZpY2VzIC0gc2hhcmVwb2ludCIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiUmVwb3J0aW5nIHNlcnZpY2VzIGFkZC1pbiBmb3Igc2hhcmVwb2ludCBwcm9kdWN0cyIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiRGF0YSBxdWFsaXR5IGNsaWVudCIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiQWxsIFRvb2xzIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJCdXNpbmVzcyBJbnRlbGxpZ2VuY2UgRGV2ZWxvcG1lbnQgU3R1ZGlvIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJDbGllbnQgdG9vbHMgY29ubmVjdGl2aXR5IiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJJbnRlZ3JhdGlvbiBzZXJ2aWNlcyIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiQ2xpZW50IHRvb2xzIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJDbGllbnQgdG9vbHMgU0RLIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJEb2N1bWVudGF0aW9uIGNvbXBvbmVudHMiLCAkZmFsc2UpOwogICAgJFNjcmlwdDpGZWF0dXJlSGFzaC5BZGQoIk1hbmFnZW1lbnQgdG9vbHMgLSBiYXNpYyIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiTWFuYWdlbWVudCB0b29scyAtIGFkdmFuY2VkIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJEaXN0cmlidXRlZCByZXBsYXkgY29udHJvbGxlciIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiRGlzdHJpYnV0ZWQgcmVwbGF5IGNsaWVudCIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiU1FMIGNsaWVudCBjb25uZWN0aXZpdHkgU0RLIiwgJGZhbHNlKTsKICAgICRTY3JpcHQ6RmVhdHVyZUhhc2guQWRkKCJNYXN0ZXIgZGF0YSBzZXJ2aWNlcyIsICRmYWxzZSk7CiAgICAkU2NyaXB0OkZlYXR1cmVIYXNoLkFkZCgiTG9jYWxEYiIsICRmYWxzZSk7CgogICAgIyBTZXQgdGhlIGxpc3QgaXRlbXMgaGVyZSB0byBjZW50cmFsaXplIGEgbG9jYXRpb24gZm9yIGNoYW5naW5nIHRoZSBmZWF0dXJlIGxpc3QKICAgIGlmICgkQ2hlY2tlZExpc3RCb3ggLW5lICRudWxsKQogICAgewogICAgICAgIGlmKCRjb25maWcuVmFsaWRhdGVGZWF0dXJlTGlzdCgiU1FMRU5HSU5FIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJEYXRhYmFzZSBlbmdpbmUiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJSRVBMSUNBVElPTiIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiUmVwbGljYXRpb24iKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJGVUxMVEVYVCIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiRnVsbC10ZXh0IGFuZCBzZW1hbnRpYyBleHRyYWN0aW9ucyBmb3Igc2VhcmNoIikgfCBPdXQtTnVsbDsgfQogICAgICAgIGlmKCRjb25maWcuVmFsaWRhdGVGZWF0dXJlTGlzdCgiRFEiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkRhdGEgcXVhbGl0eSBzZXJ2aWNlcyIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIkFTIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJBbmFseXNpcyBzZXJ2aWNlcyIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIlJTIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJSZXBvcnRpbmcgc2VydmljZXMgLSBuYXRpdmUiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJSU19TSFAiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIlJlcG9ydGluZyBzZXJ2aWNlcyAtIHNoYXJlcG9pbnQiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJSU19TSFBXRkUiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIlJlcG9ydGluZyBzZXJ2aWNlcyBhZGQtaW4gZm9yIHNoYXJlcG9pbnQgcHJvZHVjdHMiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJEUUMiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkRhdGEgcXVhbGl0eSBjbGllbnQiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJUT09MUyIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiQWxsIFRvb2xzIikgfCBPdXQtTnVsbDsgfQogICAgICAgIGlmKCRjb25maWcuVmFsaWRhdGVGZWF0dXJlTGlzdCgiQ09OTiIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiQ2xpZW50IHRvb2xzIGNvbm5lY3Rpdml0eSIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIklTIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJJbnRlZ3JhdGlvbiBzZXJ2aWNlcyIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIkJDIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJDbGllbnQgdG9vbHMgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJTREsiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkNsaWVudCB0b29scyBTREsiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJCT0wiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkRvY3VtZW50YXRpb24gY29tcG9uZW50cyIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIlNTTVMiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIk1hbmFnZW1lbnQgdG9vbHMgLSBiYXNpYyIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIkFEVl9TU01TIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJNYW5hZ2VtZW50IHRvb2xzIC0gYWR2YW5jZWQiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJEUkVQTEFZX0NUTFIiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkRpc3RyaWJ1dGVkIHJlcGxheSBjb250cm9sbGVyIikgfCBPdXQtTnVsbDsgfQogICAgICAgIGlmKCRjb25maWcuVmFsaWRhdGVGZWF0dXJlTGlzdCgiRFJFUExBWV9DTFQiKS5pc1ZhbGlkKSB7ICRDaGVja2VkTGlzdEJveC5WYWx1ZS5JdGVtcy5BZGQoIkRpc3RyaWJ1dGVkIHJlcGxheSBjbGllbnQiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJTTkFDX1NESyIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiU1FMIGNsaWVudCBjb25uZWN0aXZpdHkgU0RLIikgfCBPdXQtTnVsbDsgfQogICAgICAgIGlmKCRjb25maWcuVmFsaWRhdGVGZWF0dXJlTGlzdCgiTG9jYWxEQiIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiTG9jYWxEYiIpIHwgT3V0LU51bGw7IH0KICAgICAgICBpZigkY29uZmlnLlZhbGlkYXRlRmVhdHVyZUxpc3QoIk1EUyIpLmlzVmFsaWQpIHsgJENoZWNrZWRMaXN0Qm94LlZhbHVlLkl0ZW1zLkFkZCgiTWFzdGVyIGRhdGEgc2VydmljZXMiKSB8IE91dC1OdWxsOyB9CiAgICAgICAgaWYoJGNvbmZpZy5WYWxpZGF0ZUZlYXR1cmVMaXN0KCJCSURTIikuaXNWYWxpZCkgeyAkQ2hlY2tlZExpc3RCb3guVmFsdWUuSXRlbXMuQWRkKCJCdXNpbmVzcyBJbnRlbGxpZ2VuY2UgRGV2ZWxvcG1lbnQgU3R1ZGlvIikgfCBPdXQtTnVsbDsgfQogICAgfQp9CgpmdW5jdGlvbiBTZXRGZWF0dXJlcygpCnsKICAgICMgQ3JlYXRlIGEgRm9ybQogICAgJEZlYXR1cmVGb3JtID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMuRm9ybTsKICAgICRGZWF0dXJlRm9ybS5XaWR0aCA9IDM0NTsKICAgICRGZWF0dXJlRm9ybS5IZWlnaHQgPSA0MDQ7CiAgICAkRmVhdHVyZUZvcm0uRm9ybUJvcmRlclN0eWxlID0gW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkZvcm1Cb3JkZXJTdHlsZV06OkZpeGVkRGlhbG9nOwogICAgJEZlYXR1cmVGb3JtLlN0YXJ0UG9zaXRpb24gPSAiQ2VudGVyU2NyZWVuIjsKICAgICRGZWF0dXJlRm9ybS5NYXhpbWl6ZUJveCA9ICRmYWxzZTsKICAgICRGZWF0dXJlRm9ybS5UZXh0ID0gIkZlYXR1cmUgc2VsZWN0aW9uIjsKICAgICMgQ3JlYXRlIGEgQ2hlY2tlZExpc3RCb3gKICAgICRDaGVja2VkTGlzdEJveCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5XaW5kb3dzLkZvcm1zLkNoZWNrZWRMaXN0Qm94OwogICAgIyBBZGQgdGhlIENoZWNrZWRMaXN0Qm94IHRvIHRoZSBGb3JtCiAgICAkRmVhdHVyZUZvcm0uQ29udHJvbHMuQWRkKCRDaGVja2VkTGlzdEJveCk7CiAgICAjIFdpZGVuIHRoZSBDaGVja2VkTGlzdEJveAogICAgJENoZWNrZWRMaXN0Qm94LldpZHRoID0gMzI1OwogICAgJENoZWNrZWRMaXN0Qm94LkhlaWdodCA9IDM0MDsKICAgICRDaGVja2VkTGlzdEJveC5MZWZ0ID0gNTsKICAgICRDaGVja2VkTGlzdEJveC5Ub3AgPSA1OwogICAgJENoZWNrZWRMaXN0Qm94LkNoZWNrT25DbGljayA9ICR0cnVlCiAgICAjQ3JlYXRlIGJ1dHRvbgogICAgJE9LQnV0dG9uID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMuQnV0dG9uOwogICAgJE9LQnV0dG9uLlRleHQgPSAiQWNjZXB0IjsKICAgICRPS0J1dHRvbi5Ub3AgPSAkQ2hlY2tlZExpc3RCb3guVG9wICsgJENoZWNrZWRMaXN0Qm94LkhlaWdodCArIDI7CiAgICAkT0tCdXR0b24uTGVmdCA9ICgkRmVhdHVyZUZvcm0uV2lkdGggLyAyKSAtICgkT0tCdXR0b24uV2lkdGggLyAyKTsKICAgICRPS0J1dHRvbi5hZGRfQ2xpY2soe0FjY2VwdEZlYXR1cmVzICRDaGVja2VkTGlzdEJveH0pOwogICAgI0FkZCBidXR0b24KICAgICRGZWF0dXJlRm9ybS5Db250cm9scy5BZGQoJE9LQnV0dG9uKTsKCiAgICAjIEFkZCB0aGUgQ2hlY2tlZExpc3RCb3ggdG8gdGhlIEZvcm0KICAgIEluaXRpYWxpemVGZWF0dXJlTGlzdCAoW1JFRl0kQ2hlY2tlZExpc3RCb3gpCiAgICAkRmVhdHVyZUZvcm0uQ29udHJvbHMuQWRkKCRDaGVja2VkTGlzdEJveCk7CgogICAgIyBDbGVhciBhbGwgZXhpc3Rpbmcgc2VsZWN0aW9ucwogICAgJENoZWNrZWRMaXN0Qm94LkNsZWFyU2VsZWN0ZWQoKTsKCiAgICAjIFNob3cgdGhlIGZvcm0KICAgICRGZWF0dXJlRm9ybS5TaG93RGlhbG9nKCk7Cn0KCmZ1bmN0aW9uIFNldFN5c0FkbWluQWNjb3VudHMoKQp7CiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiU1FMRU5HSU5FIikKICAgIHsKCSAgICAjU0VUIFNZU0FETUlOIEFDQ09VTlQgSEVSRQoJICAgICRBY2N0TGlzdCA9IChyZWFkLWhvc3QgIkVudGVyIGEgY29tbWEgZGVsaW1pdGVkIGxpc3Qgb2Ygc3lzYWRtaW4gYWNjb3VudHMgZm9yIHRoaXMgaW5zdGFuY2UKCSAgICBlZyBET01BSU5cRGF0YWJhc2UgQWRtaW5pc3RyYXRpb24sIERPTUFJTlxBY2NvdW50MiIpLnNwbGl0KCIsIikKCgkgICAgZm9yZWFjaCAoJEFjY3QgaW4gJEFjY3RMaXN0KQoJCXsKCQkgICAgJGNvbmZpZy5TUUxTeXNBZG1pbkFjY291bnRMaXN0ICs9ICRBY2N0LlRyaW0oKQoJICAgIH0KCgkgICAgI0Nob29zZSBTZWN1cml0eSBNb2RlCgkgICAgJFllcyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImWWVzIiwiU2VsZWN0aW5nIHllcyB5b3Ugd2lsbCBlbmFibGUgbWl4ZWQgbW9kZSBhdXRoZW50aWNhdGlvbiB3aGljaCBhbGxvd3MgZm9yIFdpbmRvd3Mgb3IgU1FMIEF1dGhlbnRpY2F0aW9uLiIKCSAgICAkTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk5vIiwiU2VsZWN0aW5nIG5vIHlvdSB3aWxsIHJlc3RyaWN0IHlvdXIgaW5zdGFsbGF0aW9uIHRvIFdpbmRvd3MgQXV0aGVudGljYXRpb24uIgoJICAgICRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkWWVzLCRObykKCSAgICAkY2FwdGlvbiA9ICJRdWVzdGlvbiEiCgkgICAgJG1lc3NhZ2UgPSAiV291bGQgeW91IGxpa2UgdG8gdXNlIE1peGVkIE1vZGUgQXV0aGVudGljYXRpb24gKG5vdCByZWNvbW1lbmRlZCk/IgoJICAgICRTZWNDaG9pY2UgPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJGNhcHRpb24sJG1lc3NhZ2UsJGNob2ljZXMsMSkKCQkKCSAgICBzd2l0Y2ggKCRTZWNDaG9pY2UpCgkgICAgewoJCSAgICAwIHsgJFNjcmlwdDpTZWNDaG9pY2U9IllFUyIgfQoJCSAgICAxIHsgJFNjcmlwdDpTZWNDaG9pY2U9Ik5PIiB9CgkgICAgfQoJCQoJICAgIElGICgkU2NyaXB0OlNlY0Nob2ljZSAtZXEgIllFUyIpCgkgICAgewogICAgICAgICAgICAkY29uZmlnLlNlY3VyaXR5TW9kZSA9ICdTUUwnOwoJICAgIH0KICAgIH0KCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiQVMiKQogICAgewogICAgICAgICRBY2N0TGlzdCA9IChyZWFkLWhvc3QgIkVudGVyIGEgY29tbWEgZGVsaW1pdGVkIGxpc3Qgb2Ygc3lzYWRtaW4gYWNjb3VudHMgZm9yIHRoZSBBbmFseXNpcyBTZXJ2aWNlcwoJICAgIGVnIERPTUFJTlxEYXRhYmFzZSBBZG1pbmlzdHJhdGlvbiwgRE9NQUlOXEFjY291bnQyIikuc3BsaXQoIiwiKQoKCSAgICBmb3JlYWNoICgkQWNjdCBpbiAkQWNjdExpc3QpCgkJewoJCSAgICAkY29uZmlnLkFTU3lzQWRtaW5BY2NvdW50TGlzdCArPSAkQWNjdC5UcmltKCkKCSAgICB9CiAgICB9Cn0KCiNTZXQgc2VydmljZSBhY2NvdW50cwpmdW5jdGlvbiBTZXRTZXJ2aWNlQWNjb3VudHMoKQp7CgkjQ2hvb3NlIHNlcnZpY2UgYWNjb3VudHMKICAgIGlmKCRjb25maWcuRmVhdHVyZUxpc3QgLWljb250YWlucyAiU1FMRU5HSU5FIikKICAgIHsKCSAgICAkU2NyaXB0OlNRTFNlcnZpY2VBY2NvdW50ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgU1FMIFNlcnZpY2UgYWNjb3VudCB0byBiZSB1c2VkIgogICAgICAgICRjb25maWcuU1FMU3ZjQWNjb3VudCA9ICRTUUxTZXJ2aWNlQWNjb3VudDsKCSAgICAkU2NyaXB0OlNRTEFnZW50QWNjb3VudCA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIFNRTCBBZ2VudCBhY2NvdW50IHRvIGJlIHVzZWQiCiAgICAgICAgJGNvbmZpZy5BZ3RTdmNBY2NvdW50ID0gJFNRTEFnZW50QWNjb3VudDsKICAgIH0KCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1pY29udGFpbnMgIlJTIikKICAgIHsKICAgICAgICAkU2NyaXB0OlJTQWNjb3VudCA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIFNRTCBTZXJ2ZXIgUmVwb3J0aW5nIFNlcnZpY2VzIGFjY291bnQgdG8gYmUgdXNlZCIKICAgICAgICAkY29uZmlnLlJTU3ZjQWNjb3VudCA9ICRTY3JpcHQ6UlNBY2NvdW50OwogICAgfQoKICAgIGlmKCRjb25maWcuRmVhdHVyZUxpc3QgLWljb250YWlucyAiQVMiKQogICAgewogICAgICAgICRTY3JpcHQ6QVNBY2NvdW50ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgU1FMIFNlcnZlciBBbmFseXNpcyBTZXJ2aWNlcyBhY2NvdW50IHRvIGJlIHVzZWQiCiAgICAgICAgJGNvbmZpZy5BU1N2Y0FjY291bnQgPSAkU2NyaXB0OkFTQWNjb3VudDsKICAgIH0KCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1pY29udGFpbnMgIklTIikKICAgIHsKICAgICAgICAkU2NyaXB0OklTQWNjb3VudCA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIFNRTCBTZXJ2ZXIgSW50ZWdyYXRpb24gc2VydmljZXMgYWNjb3VudCB0byBiZSB1c2VkIgogICAgICAgICRjb25maWcuSVNTdmNBY2NvdW50ID0gJFNjcmlwdDpJU0FjY291bnQ7CiAgICB9CgogICAgaWYoJGNvbmZpZy5GZWF0dXJlTGlzdCAtaWNvbnRhaW5zICJGdWxsVGV4dCIpCiAgICB7CiAgICAgICAgJFNjcmlwdDpGVEFjY291bnQgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSBTUUwgU2VydmVyIEZ1bGwtdGV4dCBzZXJ2aWNlIGFjY291bnQgdG8gYmUgdXNlZCIKICAgICAgICAkY29uZmlnLkZUU3ZjQWNjb3VudCA9ICRTY3JpcHQ6RlRBY2NvdW50OwogICAgfQp9CgpmdW5jdGlvbiBTZXRGaWxlRGlyZWN0b3JpZXMoKQp7CiAgICBbc3RyaW5nXSRWZXJzaW9uU3RyaW5nID0gKFtzdHJpbmddJE1ham9yU1FMVmVyc2lvbikuUmVwbGFjZSgiLiIsICJfIik7CgogICAgI1NRTCBiaW5hcmllcyBsb2NhdGlvbiAoaW4gdGhpcyBjYXNlIHRvIEM6IEkgdXN1YWxseSB1c2UgRDopCgkkY29uZmlnLkluc3RhbGxTaGFyZWREaXIgPSAnQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgU1FMIFNlcnZlcicKICAgICRjb25maWcuSW5zdGFsbFNoYXJlZFdPV0RpciA9ICdDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBTUUwgU2VydmVyJwoJJGNvbmZpZy5JbnN0YW5jZURpciA9ICdDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBTUUwgU2VydmVyJwoKICAgICRZZXMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJlllcyIsIlNlbGVjdGluZyB5ZXMgd2lsbCB1c2UgZGVmYXVsdCBpbnN0YWxsYXRpb24gZGlyZWN0b3JpZXMuIgoJJE5vID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZObyIsIlNlbGVjdGluZyBubyB3aWxsIHNwYXduIGFkZGl0aW9uYWwgcHJvbXB0cyBmb3IgY3VzdG9tIGluc3RhbGwgZGlyZWN0b3JpZXMuIgoJJGNob2ljZXMgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uW11dKCRZZXMsJE5vKQoJJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJJG1lc3NhZ2UgPSAiV291bGQgeW91IGxpa2UgdG8gdXNlIHRoZSBkZWZhdWx0IGluc3RhbGxhdGlvbiBkaXJlY3RvcmllcyBmb3IgdGhlIFNRTCBTZXJ2ZXIgYmluYXJpZXM/IgoJJGNob2ljZSA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkY2FwdGlvbiwkbWVzc2FnZSwkY2hvaWNlcywwKQoKICAgIGlmKCRjaG9pY2UgLWVxIDEpCiAgICB7CiAgICAgICAgJGNvbmZpZy5JbnN0YWxsU1FMRGF0YURpciA9IFJlYWQtSG9zdCAiU2VsZWN0IGRpcmVjdG9yeSBmb3IgdGhlIFNRTCBTZXJ2ZXIgYmluYXJpZXMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IFNRTCBTZXJ2ZXIiCgkgICAgCgkgICAgJGNvbmZpZy5JbnN0YWxsU2hhcmVkV09XRGlyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciB0aGUgU1FMIFNlcnZlciAzMi1iaXQgYmluYXJpZXMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IFNRTCBTZXJ2ZXIiCgoJICAgICRjb25maWcuSW5zdGFuY2VEaXIgPSBSZWFkLUhvc3QgIlNlbGVjdCBkaXJlY3RvcnkgZm9yIFNRTCBTZXJ2ZXIgaW5zdGFuY2UgZmlsZXMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IFNRTCBTZXJ2ZXIiCiAgICB9CiAgICAKICAgIGlmKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJTUUxFTkdJTkUiKQogICAgewoJICAgICNTeXN0ZW0gZGF0YWJhc2VzCgkgICAgJFN5c0RCZm9sZGVyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciBTUUwgU1lTVEVNIGRhdGFiYXNlcyAoRG8gbm90IGluY2x1ZGUgdGhlIHRyYWlsaW5nICdcJykKCSAgICBlZy4gSjogb3IgSjpcU1FMU2VydmVyXFN5c3RlbURCcyIKCSAgICAkY29uZmlnLkluc3RhbGxTUUxEYXRhRGlyID0gJFN5c0RCZm9sZGVyOwoKCSAgICAjRGVmYXVsdCBVc2VyIERCIGxvY2F0aW9uCgkgICAgJFVzZXJEQmZvbGRlciA9IFJlYWQtSG9zdCAiU2VsZWN0IGRpcmVjdG9yeSBmb3IgVVNFUiBEQVRBQkFTRSBEQVRBIGZpbGVzIChEbyBub3QgaW5jbHVkZSB0aGUgdHJhaWxpbmcgJ1wnKQoJICAgIGVnLiBKOiBvciBKOlxTUUxTZXJ2ZXJcVXNlckRhdGEiCgkgICAgJGNvbmZpZy5TUUxVc2VyRGJEaXIgPSAkVXNlckRCZm9sZGVyOwoKCSAgICAjRGVmYXVsdCBVc2VyIExvZyBsb2NhdGlvbgoJICAgICRVc2VyTG9nZm9sZGVyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciBVU0VSIERBVEFCQVNFIExPRyBmaWxlcyAoRG8gbm90IGluY2x1ZGUgdGhlIHRyYWlsaW5nICdcJykKCSAgICBlZy4gSjogb3IgSjpcU1FMU2VydmVyXFVzZXJMb2dzIgoJICAgICRjb25maWcuU1FMVXNlckRiTG9nRGlyID0gJFVzZXJMb2dmb2xkZXI7CgkKCSAgICAjVGVtcERCCgkgICAgJFRlbXBEQmZvbGRlciA9IFJlYWQtSG9zdCAiU2VsZWN0IGRpcmVjdG9yeSBmb3IgU1FMIFRlbXBEQiAoRG8gbm90IGluY2x1ZGUgdGhlIHRyYWlsaW5nICdcJykKCSAgICBlZy4gSjogb3IgSjpcU1FMU2VydmVyXHRlbXBkYkRhdGEiCgkgICAgJGNvbmZpZy5TUUx0ZW1wZGJEaXIgPSAkVGVtcERCZm9sZGVyOwoKCSAgICAjRGVmYXVsdCBiYWNrdXAgbG9jYXRpb24KCSAgICAkQmFja3VwZm9sZGVyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciBEQVRBQkFTRSBCQUNLVVBTIChEbyBub3QgaW5jbHVkZSB0aGUgdHJhaWxpbmcgJ1wnKQoJICAgIGVnLiBKOiBvciBKOlxTUUxTZXJ2ZXJcQmFja3VwIgoJICAgICRjb25maWcuU1FMQmFja3VwRGlyID0gJEJhY2t1cGZvbGRlcjsKICAgIH0KCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiQVMiKQogICAgewoJICAgICNDb25maWcgZGF0YWJhc2VzCgkgICAgJENvbmZpZ2ZvbGRlciA9IFJlYWQtSG9zdCAiU2VsZWN0IGRpcmVjdG9yeSBmb3IgU1NBUyBjb25maWcgZmlsZXMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEo6XFNRTFNlcnZlclxBbmFseXNpc1NlcnZpY2VzQ29uZmlnIgoJICAgICRjb25maWcuQVNDb25maWdEaXIgPSAkQ29uZmlnRGlyOwoKCSAgICAjRGVmYXVsdCBEQVRBIGxvY2F0aW9uCgkgICAgJERhdGFGb2xkZXIgPSBSZWFkLUhvc3QgIlNlbGVjdCBkaXJlY3RvcnkgZm9yIFNTQVMgREFUQSBmaWxlcyAoRG8gbm90IGluY2x1ZGUgdGhlIHRyYWlsaW5nICdcJykKCSAgICBlZy4gSjogb3IgSjpcU1FMU2VydmVyXEFuYWx5c2lzU2VydmljZXNEYXRhIgoJICAgICRjb25maWcuQVNEYXRhRGlyID0gJERhdGFEaXI7CgoJICAgICNEZWZhdWx0IExvZyBsb2NhdGlvbgoJICAgICRMb2dmb2xkZXIgPSBSZWFkLUhvc3QgIlNlbGVjdCBkaXJlY3RvcnkgZm9yIFNTQVMgTE9HIGZpbGVzIChEbyBub3QgaW5jbHVkZSB0aGUgdHJhaWxpbmcgJ1wnKQoJICAgIGVnLiBKOiBvciBKOlxTUUxTZXJ2ZXJcQW5hbHlzaXNTZXJ2aWNlc0xvZ3MiCgkgICAgJGNvbmZpZy5BU0xvZ0RpciA9ICRMb2dEaXI7CgkKCSAgICAjVGVtcAoJICAgICRUZW1wZm9sZGVyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciBTU0FTIFRlbXAgZmlsZXMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEo6XFNRTFNlcnZlclxBbmFseXNpc1NlcnZpY2VzVGVtcCIKCSAgICAkY29uZmlnLkFTVGVtcERpciA9ICRUZW1wRGlyOwoKCSAgICAjRGVmYXVsdCBiYWNrdXAgbG9jYXRpb24KCSAgICAkQmFja3VwZm9sZGVyID0gUmVhZC1Ib3N0ICJTZWxlY3QgZGlyZWN0b3J5IGZvciBTU0FTIEJBQ0tVUFMgKERvIG5vdCBpbmNsdWRlIHRoZSB0cmFpbGluZyAnXCcpCgkgICAgZWcuIEo6IG9yIEo6XFNRTFNlcnZlclxBbmFseXNpc1NlcnZpY2VzQmFja3VwIgoJICAgICRjb25maWcuQVNCYWNrdXBEaXIgPSAkQmFja3VwOwogICAgfQp9CgpmdW5jdGlvbiBTZXREaXN0cmlidXRlZFJlcGxheUluZm9ybWF0aW9uKCkKewogICAgJElucHV0ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgY29tcHV0ZXIgbmFtZSB0aGF0IHRoZSBjbGllbnQgY29tbXVuaWNhdGVzIHdpdGggZm9yIHRoZSBEaXN0cmlidXRlZCBSZXBsYXkgQ29udHJvbGxlciBzZXJ2aWNlLiI7CiAgICAkY29uZmlnLkNsdEN0bHJOYW1lID0gJElucHV0OwoKICAgICRJbnB1dExpc3QgPSAoUmVhZC1Ib3N0ICJFbnRlciB0aGUgV2luZG93cyBhY2NvdW50KHMpIHVzZWQgdG8gZ3JhbnQgcGVybWlzc2lvbiB0byB0aGUgRGlzdHJpYnV0ZWQgUmVwbGF5IENvbnRyb2xsZXIgc2VydmljZS4KICAgIGVnIERPTUFJTlxEYXRhYmFzZSBBZG1pbmlzdHJhdGlvbiwgRE9NQUlOXEFjY291bnQyIikuc3BsaXQoIiwiKTsKCglmb3JlYWNoICgkQWNjdCBpbiAkSW5wdXRMaXN0KQoJewoJCSRjb25maWcuQ3RsclVzZXJMaXN0ICs9ICRBY2N0LlRyaW0oKTsKCX0KCiAgICAkSW5wdXQgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSBhY2NvdW50IHVzZWQgYnkgdGhlIERpc3RyaWJ1dGVkIFJlcGxheSBDb250cm9sbGVyIFNlcnZpY2UuCiAgICBlZyBOVCBTZXJ2aWNlXFNRTCBTZXJ2ZXIgRGlzdHJpYnV0ZWQgUmVwbGF5IENvbnRyb2xsZXIiOwogICAgJGNvbmZpZy5DdGxyU3ZjQWNjb3VudCA9ICRJbnB1dDsKCiAgICAkTWFudWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZNYW51YWwiLCJTZWxlY3RpbmcgbWFudWFsIHdpbGwgc2V0IHRoZSBzdGFydHVwIHR5cGUgdG8gbWFudWFsLiIKCSRBdXRvbWF0aWMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkF1dG9tYXRpYyIsIlNlbGVjdGluZyBhdXRvbWF0aWMgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBhdXRvbWF0aWMuIgogICAgJERpc2FibGVkID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZEaXNhYmxlZCIsIlNlbGVjdGluZyBkaXNhYmxlZCB3aWxsIHNldCB0aGUgc3RhcnR1cCB0eXBlIHRvIGRpc2FibGVkLiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkTWFudWFsLCRBdXRvbWF0aWMsJERpc2FibGVkKQoJJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJJG1lc3NhZ2UgPSAiV2hhdCBzdGFydHVwIHR5cGUgd291bGQgeW91IGxpa2UgeW91ciBEaXN0cmlidXRlZCBSZXBsYXkgQ29udHJvbGxlciBTZXJ2aWNlIHNldCB0bz8iCgkkY2hvaWNlID0gJEhvc3QuVUkuUHJvbXB0Rm9yQ2hvaWNlKCRjYXB0aW9uLCRtZXNzYWdlLCRjaG9pY2VzLDApCgogICAgc3dpdGNoICgkY2hvaWNlKQogICAgewogICAgICAgIDAgeyAkSW5wdXQ9Ik1hbnVhbCIgfQogICAgICAgIDEgeyAkSW5wdXQ9IkF1dG9tYXRpYyIgfQogICAgICAgIDIgeyAkSW5wdXQ9IkRpc2FibGVkIiB9CiAgICB9CiAgICAkY29uZmlnLkN0bHJTdGFydHVwVHlwZSA9ICRJbnB1dDsKCiAgICAkSW5wdXQgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSBhY2NvdW50IHVzZWQgYnkgdGhlIERpc3RyaWJ1dGVkIFJlcGxheSBDbGllbnQgU2VydmljZS4KICAgIGVnIE5UIFNlcnZpY2VcU1FMIFNlcnZlciBEaXN0cmlidXRlZCBSZXBsYXkgQ2xpZW50IjsKICAgICRjb25maWcuQ2x0U3ZjQWNjb3VudCA9ICRJbnB1dDsKCiAgICAkTWFudWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZNYW51YWwiLCJTZWxlY3RpbmcgbWFudWFsIHdpbGwgc2V0IHRoZSBzdGFydHVwIHR5cGUgdG8gbWFudWFsLiIKCSRBdXRvbWF0aWMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkF1dG9tYXRpYyIsIlNlbGVjdGluZyBhdXRvbWF0aWMgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBhdXRvbWF0aWMuIgogICAgJERpc2FibGVkID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZEaXNhYmxlZCIsIlNlbGVjdGluZyBkaXNhYmxlZCB3aWxsIHNldCB0aGUgc3RhcnR1cCB0eXBlIHRvIGRpc2FibGVkLiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkTWFudWFsLCRBdXRvbWF0aWMsJERpc2FibGVkKQoJJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJJG1lc3NhZ2UgPSAiV2hhdCBzdGFydHVwIHR5cGUgd291bGQgeW91IGxpa2UgeW91ciBEaXN0cmlidXRlZCBSZXBsYXkgQ2xpZW50IFNlcnZpY2Ugc2V0IHRvPyIKCSRjaG9pY2UgPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJGNhcHRpb24sJG1lc3NhZ2UsJGNob2ljZXMsMCkKCiAgICBzd2l0Y2ggKCRjaG9pY2UpCiAgICB7CiAgICAgICAgMCB7ICRJbnB1dD0iTWFudWFsIiB9CiAgICAgICAgMSB7ICRJbnB1dD0iQXV0b21hdGljIiB9CiAgICAgICAgMiB7ICRJbnB1dD0iRGlzYWJsZWQiIH0KICAgIH0KICAgICRjb25maWcuQ2x0U3RhcnR1cFR5cGUgPSAkSW5wdXQ7CgogICAgJElucHV0ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcmVzdWx0IGRpcmVjdG9yeSBmb3IgdGhlIERpc3RyaWJ1dGVkIFJlcGxheSBDbGllbnQgc2VydmljZS4gKE5vIHRyYWlsaW5nIHNsYXNoKSI7CiAgICAkY29uZmlnLkNsdFJlc3VsdERpciA9ICRJbnB1dDsKCiAgICAkSW5wdXQgPSBSZWFkLUhvc3QgIkVudGVyIHRoZSB3b3JraW5nIGRpcmVjdG9yeSBmb3IgdGhlIERpc3RyaWJ1dGVkIFJlcGxheSBDbGllbnQgc2VydmljZS4gKE5vIHRyYWlsaW5nIHNsYXNoKSI7CiAgICAkY29uZmlnLkNsdFdvcmtpbmdEaXIgPSAkSW5wdXQ7Cn0KCmZ1bmN0aW9uIFNldENsdXN0ZXJEaXNrcygpCnsKCSREaXNrTGlzdCA9IChyZWFkLWhvc3QgIkVudGVyIGEgY29tbWEgZGVsaW1pdGVkIGxpc3Qgb2YgZmFpbG92ZXIgY2x1c3RlciBkaXNrcyBmb3IgdXNlIGluIHRoaXMgY2x1c3RlcgoJZWcgU1FMIERhdGEsIFNRTCBMb2csIFNRTCBCYWNrdXAiKS5zcGxpdCgiLCIpCgoJZm9yZWFjaCAoJERpc2sgaW4gJERpc2tMaXN0KQoJewoJCSRjb25maWcuRmFpbG92ZXJDbHVzdGVyRGlza3MgKz0gJERpc2suVHJpbSgpOwoJfQp9CgojTGV0IHRoZSB1c2VyIGtub3cgdGhlIHNjcmlwdCBpcyBjb21wbGV0ZSBhbmQgd2hlcmUgdGhlIGZpbGVzIHJlc2lkZQkJCmZ1bmN0aW9uIEV4aXRNZXNzYWdlKCkKewoJaWYoJFNraXBNZXNzYWdlIC1lcSAiTk8iKQoJewoJCXN3aXRjaCAoICRJbnN0YWxsQ2hvaWNlICkKCQl7CgkJCSJTVEFOREFMT05FSU5TVEFMTCIKCQkJewoJCQkJW3N5c3RlbS5XaW5kb3dzLkZvcm1zLk1lc3NhZ2VCb3hdOjpzaG93CgkJCQkoCgkJCQkJIlNRTCBpbmkgZmlsZSBjcmVhdGVkIQoJCQkJCQlCZSBzdXJlIHRvIGNoZWNrIHlvdXIgaW5pIGNvbmZpZyBiZWZvcmUgdXNpbmcuCgkJCQkJCQkKCQkJCQlUbyBjcmVhdGUgYSBuZXcgU1FMIGluc3RhbmNlIHVzZToKCQkJCQkJYCIkZmlsZWAiIAoJCQkJCQkKCQkJCQlFeGFtcGxlOiAKCQkJCQkJc2V0dXAuZXhlIC9DT05GSUdVUkFUSU9ORklMRT1gIjxGaWxlbmFtZS5pbmk+YCIgCgkJCQkJCS9TUUxTVkNQQVNTV09SRD1gIjxTUUwgc2VydmljZSBhY2NvdW50IHB3ZD5gIiAKCQkJCQkJL0FHVFNWQ1BBU1NXT1JEPWAiPEFnZW50IHNlcnZpY2UgYWNjb3VudCBwd2Q+YCIKCQkJCQkJCgkJCQkJU2V0dXAgY29tbWFuZCB3cml0dGVuIHRvIFBvd2VyU2hlbGwgb3V0cHV0IHdpbmRvdy4gICAgCgkJCQkiKQoJCQl9CgkJCSJJTlNUQUxMQ0xVU1RFUiIKCQkJewoJCQkJW3N5c3RlbS5XaW5kb3dzLkZvcm1zLk1lc3NhZ2VCb3hdOjpzaG93CgkJCQkoCgkJCQkJIlNRTCBpbmkgZmlsZXMgY3JlYXRlZCEKCQkJCQkJQmUgc3VyZSB0byBjaGVjayB5b3VyIGluaSBjb25maWcgYmVmb3JlIHVzaW5nLgoJCQkJCQkJCgkJCQkJVG8gY3JlYXRlIGEgbmV3IGNsdXN0ZXJlZCBTUUwgaW5zdGFuY2UgdXNlOgoJCQkJCQlgIiRmaWxlYCIgCgkJCQkJCQoJCQkJCVRvIGFkZCBhIG5vZGUgdG8gYW4gZXhpc3RpbmcgY2x1c3RlciB1c2U6CQoJCQkJCQlgIiRGaWxlTmFtZUFkZE5vZGVgIgoJCQkJCQkJCgkJCQkJRXhhbXBsZTogCgkJCQkJCXNldHVwLmV4ZSAvQ09ORklHVVJBVElPTkZJTEU9YCI8RmlsZW5hbWUuaW5pPmAiIAoJCQkJCQkvU1FMU1ZDUEFTU1dPUkQ9YCI8U1FMIHNlcnZpY2UgYWNjb3VudCBwd2Q+YCIgCgkJCQkJCS9BR1RTVkNQQVNTV09SRD1gIjxBZ2VudCBzZXJ2aWNlIGFjY291bnQgcHdkPmAiCgkJCQkJCQoJCQkJCVNldHVwIGNvbW1hbmQgd3JpdHRlbiB0byBQb3dlclNoZWxsIG91dHB1dCB3aW5kb3cuICAgIAoJCQkJIikKCQkJfQoJCQkiQURETk9ERSIKCQkJewoJCQkJW3N5c3RlbS5XaW5kb3dzLkZvcm1zLk1lc3NhZ2VCb3hdOjpzaG93CgkJCQkoCgkJCQkJIlNRTCBpbmkgZmlsZXMgY3JlYXRlZCEKCQkJCQkJQmUgc3VyZSB0byBjaGVjayB5b3VyIGluaSBjb25maWcgYmVmb3JlIHVzaW5nLgoJCQkJCQkKCQkJCQlUbyBhZGQgYSBub2RlIHRvIGFuIGV4aXN0aW5nIGNsdXN0ZXIgdXNlOgkKCQkJCQkJYCIkRmlsZU5hbWVBZGROb2RlYCIKCQkJCQkJCQoJCQkJCUV4YW1wbGU6IAoJCQkJCQlzZXR1cC5leGUgL0NPTkZJR1VSQVRJT05GSUxFPWAiPEZpbGVuYW1lLmluaT5gIiAKCQkJCQkJL1NRTFNWQ1BBU1NXT1JEPWAiPFNRTCBzZXJ2aWNlIGFjY291bnQgcHdkPmAiIAoJCQkJCQkvQUdUU1ZDUEFTU1dPUkQ9YCI8QWdlbnQgc2VydmljZSBhY2NvdW50IHB3ZD5gIgoJCQkJCQkKCQkJCQlTZXR1cCBjb21tYW5kIHdyaXR0ZW4gdG8gUG93ZXJTaGVsbCBvdXRwdXQgd2luZG93LiAgICAKCQkJCSIpCgkJCX0KCQkJZGVmYXVsdAoJCQl7CgkJCQlXcml0ZS1FcnJvciAiSW5zdGFsbGF0aW9uIGNob2ljZSBub3QgcmVjb2duaXplZC4iCgkJCX0KCQl9Cgl9Cn0KCiNXcml0ZSBldmVyeXRoaW5nIHRvIHRoZSBBZGROb2RlIGluaSBmaWxlCmZ1bmN0aW9uIFdyaXRlQWRkTm9kZUZpbGUoKQp7CiAgICAkYWRkTm9kZUNvbmZpZyA9IEdldC1TUUxJbnN0YWxsQ29uZmlndXJhdGlvbjsKCiAgICAkYWRkTm9kZUNvbmZpZy5DcmVhdG9yID0gJGNvbmZpZy5DcmVhdG9yOwogICAgJGFkZE5vZGVDb25maWcuTWFqb3JTUUxWZXJzaW9uID0gJGNvbmZpZy5NYWpvclNRTFZlcnNpb247CgoJJGFkZE5vZGVDb25maWcuQWN0aW9uID0gJ0FkZE5vZGUnOwogICAgJGFkZE5vZGVDb25maWcuWDg2ID0gJGNvbmZpZy5YODY7CQoJJGFkZE5vZGVDb25maWcuRlRTdmNBY2NvdW50ID0gJEZUQWNjb3VudDsKCSRhZGROb2RlQ29uZmlnLlNRTFN2Y0FjY291bnQgPSAkU1FMU2VydmljZUFjY291bnQ7CiAgICAkYWRkTm9kZUNvbmZpZy5BZ3RTdmNBY2NvdW50ID0gJFNRTEFnZW50QWNjb3VudDsKCSRhZGROb2RlQ29uZmlnLkZhaWxvdmVyQ2x1c3Rlck5ldHdvcmtOYW1lID0gJFNRTFZpcnR1YWxOYW1lOwogICAgJGFkZE5vZGVDb25maWcuSW5zdGFuY2VOYW1lID0gJFNRTEluc3RhbmNlTmFtZTsKICAgICRhZGROb2RlQ29uZmlnLkZhaWxvdmVyQ2x1c3Rlckdyb3VwID0gJFNRTFZpcnR1YWxOYW1lOwoKICAgICRhZGROb2RlQ29uZmlnLlByZXBhcmUoW3JlZl0kYWRkTm9kZUNvbmZpZyk7CiAgICAkYWRkTm9kZUNvbmZpZy5TYXZlVG9GaWxlKCRGaWxlTmFtZUFkZE5vZGUsIFtyZWZdJGFkZE5vZGVDb25maWcpOwp9CgpmdW5jdGlvbiBQcmludEV4ZWNDTUQoKQp7CgkkRXhlY0NtZFByaW50T3V0ID0gInNldHVwLmV4ZSAvQ09ORklHVVJBVElPTkZJTEU9YCIkZmlsZWAiIgogICAgCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiU1FMRU5HSU5FIikKICAgIHsKICAgICAgICAkRXhlY0NtZFByaW50T3V0ID0gJEV4ZWNDbWRQcmludE91dCArICIgL1NRTFNWQ1BBU1NXT1JEPWAiPGVudGVyIHB3ZD5gIiAvQUdUU1ZDUEFTU1dPUkQ9YCI8ZW50ZXIgcHdkPmAiIjsKICAgIH0KICAgIGlmICgkU2NyaXB0OlNlY0Nob2ljZSAtZXEgIllFUyIpCgl7CgkJJEV4ZWNDbWRQcmludE91dCA9ICRFeGVjQ21kUHJpbnRPdXQgKyAiIC9TQVBXRD1gIjxlbnRlciBwd2Q+YCIiOwoJfQogICAgaWYgKCgkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiUlMiKSAtb3IgKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJSU19TSFAiKSkKCXsKCQkkRXhlY0NtZFByaW50T3V0ID0gJEV4ZWNDbWRQcmludE91dCArICIgL1JTU1ZDQUNDT1VOVD1gIjxlbnRlciBwd2Q+YCIiOwoJfQogICAgaWYgKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJBUyIpCgl7CgkJJEV4ZWNDbWRQcmludE91dCA9ICRFeGVjQ21kUHJpbnRPdXQgKyAiIC9BU1NWQ0FDQ09VTlQ9YCI8ZW50ZXIgcHdkPmAiIjsKCX0KICAgIGlmICgkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiSVMiKQoJewoJCSRFeGVjQ21kUHJpbnRPdXQgPSAkRXhlY0NtZFByaW50T3V0ICsgIiAvSVNTVkNBQ0NPVU5UPWAiPGVudGVyIHB3ZD5gIiI7Cgl9CiAgICAKICAgIFdyaXRlLUhvc3QgIiIKICAgIFdyaXRlLUhvc3QgJEV4ZWNDbWRQcmludE91dAogICAgV3JpdGUtSG9zdCAiIgogICAgUmVhZC1Ib3N0ICJQcmVzcyBFTlRFUiB0byBleGl0Igp9CgpmdW5jdGlvbiBTZXRSZXBvcnRpbmdJbmZvcm1hdGlvbiAoKQp7CiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiUlMiKQogICAgewogICAgICAgICRNYW51YWwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk1hbnVhbCIsIlNlbGVjdGluZyBtYW51YWwgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBtYW51YWwuIgoJICAgICRBdXRvbWF0aWMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkF1dG9tYXRpYyIsIlNlbGVjdGluZyBhdXRvbWF0aWMgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBhdXRvbWF0aWMuIgogICAgICAgICREaXNhYmxlZCA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImRGlzYWJsZWQiLCJTZWxlY3RpbmcgZGlzYWJsZWQgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBkaXNhYmxlZC4iCgkgICAgJGNob2ljZXMgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uW11dKCRNYW51YWwsJEF1dG9tYXRpYywkRGlzYWJsZWQpCgkgICAgJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJICAgICRtZXNzYWdlID0gIldoYXQgc3RhcnR1cCB0eXBlIHdvdWxkIHlvdSBsaWtlIHlvdXIgUmVwb3J0aW5nIFNlcnZpY2Ugc2V0IHRvPyIKCSAgICAkY2hvaWNlID0gJEhvc3QuVUkuUHJvbXB0Rm9yQ2hvaWNlKCRjYXB0aW9uLCRtZXNzYWdlLCRjaG9pY2VzLDApCgogICAgICAgIHN3aXRjaCAoJGNob2ljZSkKICAgICAgICB7CiAgICAgICAgICAgIDAgeyAkSW5wdXQ9Ik1hbnVhbCIgfQogICAgICAgICAgICAxIHsgJElucHV0PSJBdXRvbWF0aWMiIH0KICAgICAgICAgICAgMiB7ICRJbnB1dD0iRGlzYWJsZWQiIH0KICAgICAgICB9CiAgICAgICAgJGNvbmZpZy5Sc1N2Y1N0YXJ0dXBUeXBlID0gJElucHV0OwoKICAgICAgICAjRGVmYXVsdCB0byBmaWxlcyBvbmx5IG1vZGUKICAgICAgICAkY29uZmlnLlJTSW5zdGFsbE1vZGUgPSAnRmlsZXNPbmx5TW9kZSc7CiAgICB9CgogICAgaWYoJGNvbmZpZy5GZWF0dXJlTGlzdCAtY29udGFpbnMgIlJTX1NIUCIpCiAgICB7CiAgICAgICAgI0RlZmF1bHQgdG8gZmlsZXMgb25seSBtb2RlCiAgICAgICAgJGNvbmZpZy5SU0luc3RhbGxNb2RlID0gJ1NoYXJlUG9pbnRGaWxlc09ubHlNb2RlJzsKICAgIH0KfQoKZnVuY3Rpb24gU2V0SW50ZWdyYXRpb25JbmZvcm1hdGlvbiAoKQp7CiAgICAkTWFudWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZNYW51YWwiLCJTZWxlY3RpbmcgbWFudWFsIHdpbGwgc2V0IHRoZSBzdGFydHVwIHR5cGUgdG8gbWFudWFsLiIKCSRBdXRvbWF0aWMgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkF1dG9tYXRpYyIsIlNlbGVjdGluZyBhdXRvbWF0aWMgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBhdXRvbWF0aWMuIgogICAgJERpc2FibGVkID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiZEaXNhYmxlZCIsIlNlbGVjdGluZyBkaXNhYmxlZCB3aWxsIHNldCB0aGUgc3RhcnR1cCB0eXBlIHRvIGRpc2FibGVkLiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkTWFudWFsLCRBdXRvbWF0aWMsJERpc2FibGVkKQoJJGNhcHRpb24gPSAiUXVlc3Rpb24hIgoJJG1lc3NhZ2UgPSAiV2hhdCBzdGFydHVwIHR5cGUgd291bGQgeW91IGxpa2UgeW91ciBJbnRlZ3JhdGlvbiBTZXJ2aWNlcyBzZXQgdG8/IgoJJGNob2ljZSA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkY2FwdGlvbiwkbWVzc2FnZSwkY2hvaWNlcywwKQoKICAgIHN3aXRjaCAoJGNob2ljZSkKICAgIHsKICAgICAgICAwIHsgJElucHV0PSJNYW51YWwiIH0KICAgICAgICAxIHsgJElucHV0PSJBdXRvbWF0aWMiIH0KICAgICAgICAyIHsgJElucHV0PSJEaXNhYmxlZCIgfQogICAgfQogICAgJGNvbmZpZy5JU1N2Y1N0YXJ0dXBUeXBlID0gJElucHV0Owp9CgpmdW5jdGlvbiBTZXRBbmFseXNpc0luZm9ybWF0aW9uICgpCnsKICAgICRJbnB1dCA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIGFjY291bnQgdXNlZCBieSB0aGUgQW5hbHlzaXMgU2VydmljZXMgKGVnLiBTUUxfTGF0aW4xX0dlbmVyYWxfQ1AxX0NJX0FTKSI7CiAgICAkY29uZmlnLkFTQ29sbGF0aW9uID0gJElucHV0OwoKICAgICRNYW51YWwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk1hbnVhbCIsIlNlbGVjdGluZyBtYW51YWwgd2lsbCBzZXQgdGhlIHN0YXJ0dXAgdHlwZSB0byBtYW51YWwuIgoJJEF1dG9tYXRpYyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImQXV0b21hdGljIiwiU2VsZWN0aW5nIGF1dG9tYXRpYyB3aWxsIHNldCB0aGUgc3RhcnR1cCB0eXBlIHRvIGF1dG9tYXRpYy4iCiAgICAkRGlzYWJsZWQgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJkRpc2FibGVkIiwiU2VsZWN0aW5nIGRpc2FibGVkIHdpbGwgc2V0IHRoZSBzdGFydHVwIHR5cGUgdG8gZGlzYWJsZWQuIgoJJGNob2ljZXMgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uW11dKCRNYW51YWwsJEF1dG9tYXRpYywkRGlzYWJsZWQpCgkkY2FwdGlvbiA9ICJRdWVzdGlvbiEiCgkkbWVzc2FnZSA9ICJXaGF0IHN0YXJ0dXAgdHlwZSB3b3VsZCB5b3UgbGlrZSB5b3VyIEFuYWx5c2lzIFNlcnZpY2VzIHNldCB0bz8iCgkkY2hvaWNlID0gJEhvc3QuVUkuUHJvbXB0Rm9yQ2hvaWNlKCRjYXB0aW9uLCRtZXNzYWdlLCRjaG9pY2VzLDApCgogICAgc3dpdGNoICgkY2hvaWNlKQogICAgewogICAgICAgIDAgeyAkSW5wdXQ9Ik1hbnVhbCIgfQogICAgICAgIDEgeyAkSW5wdXQ9IkF1dG9tYXRpYyIgfQogICAgICAgIDIgeyAkSW5wdXQ9IkRpc2FibGVkIiB9CiAgICB9CiAgICAkY29uZmlnLkFTU3ZjU3RhcnR1cFR5cGUgPSAkSW5wdXQ7CgogICAgJE1VTFRJRElNRU5TSU9OQUwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk1VTFRJRElNRU5TSU9OQUwiLCJTZWxlY3RpbmcgbXVsdGlkZWltZW5zaW9uYWwgd2lsbCBzZXQgdGhlIEFuYWx5c2lzIFNlcnZlciBtb2RlIGFzIHN1Y2guIgoJJFBPV0VSUElWT1QgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJlBPV0VSUElWT1QiLCJTZWxlY3RpbmcgcG93ZXJwaXZvdCB3aWxsIHNldCB0aGUgQW5hbHlzaXMgU2VydmVyIG1vZGUgYXMgc3VjaC4iCiAgICAkVEFCVUxBUiA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImVEFCVUxBUiIsIlNlbGVjdGluZyB0YWJ1bGFyIHdpbGwgc2V0IHRoZSBBbmFseXNpcyBTZXJ2ZXIgbW9kZSBhcyBzdWNoLiIKCSRjaG9pY2VzID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbltdXSgkTVVMVElESU1FTlNJT05BTCwkUE9XRVJQSVZPVCwkVEFCVUxBUikKCSRjYXB0aW9uID0gIlF1ZXN0aW9uISIKCSRtZXNzYWdlID0gIldoYXQgc2VydmVyIG1vZGUgd291bGQgeW91IGxpa2UgeW91ciBBbmFseXNpcyBTZXJ2aWNlcyBzZXQgdG8/IgoJJGNob2ljZSA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkY2FwdGlvbiwkbWVzc2FnZSwkY2hvaWNlcywwKQoKICAgIHN3aXRjaCAoJGNob2ljZSkKICAgIHsKICAgICAgICAwIHsgJElucHV0PSJNVUxUSURJTUVOU0lPTkFMIiB9CiAgICAgICAgMSB7ICRJbnB1dD0iUE9XRVJQSVZPVCIgfQogICAgICAgIDIgeyAkSW5wdXQ9IlRBQlVMQVIiIH0KICAgIH0KICAgICRjb25maWcuQVNTZXJ2ZXJNb2RlID0gJElucHV0OwoKICAgICNDaG9vc2UgcHJvdmlkZXIgbW9kZQoJJFllcyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImWWVzIiwiQnkgc2VsZWN0aW5nIHllcyB5b3Ugd2lsbCBlbmFibGUgdGhlIE1TT0xBUCBwcm92aWRlciB0byBydW4gaW4tcHJvY2Vzcy4iCgkkTm8gPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJk5vIiwiQnkgc2VsZWN0aW5nIG5vIHlvdSB3aWxsIGRpc2FibGUgdGhlIE1TT0xBUCBwcm92aWRlciBmcm9tIHJ1bm5pbmcgaW4tcHJvY2Vzcy4iCgkkY2hvaWNlcyA9IFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb25bXV0oJFllcywkTm8pCgkkY2FwdGlvbiA9ICJRdWVzdGlvbiEiCgkkbWVzc2FnZSA9ICJXb3VsZCB5b3UgbGlrZSB0byBlbmFibGUgdGhlIE1TT0xBUCBwcm92aWRlciB0byBydW4gaW4tcHJvY2Vzcz8iCgkkTVNPTEFQcHJvdmlkZXIgPSAkSG9zdC5VSS5Qcm9tcHRGb3JDaG9pY2UoJGNhcHRpb24sJG1lc3NhZ2UsJGNob2ljZXMsMCkKCQkKCXN3aXRjaCAoJE1TT0xBUHByb3ZpZGVyKQoJewoJCTAgeyAkU2NyaXB0Ok1TT0xBUHByb3ZpZGVyPSJZRVMiIH0KCQkxIHsgJFNjcmlwdDpNU09MQVBwcm92aWRlcj0iTk8iIH0KCX0KCQkKCUlGICgkU2NyaXB0Ok1TT0xBUHByb3ZpZGVyIC1lcSAiWUVTIikKCXsKICAgICAgICAkY29uZmlnLkFTUHJvdmlkZXJNU09MQVAgPSAxOwoJfQogICAgZWxzZQogICAgewogICAgICAgICRjb25maWcuQVNQcm92aWRlck1TT0xBUCA9IDA7CiAgICB9Cn0KCmZ1bmN0aW9uIFNldFNRTEVuZ2luZUluZm9ybWF0aW9uICgpCnsKICAgICRJbnB1dCA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIGNvbGxhdGlvbiB0aGF0IHlvdSB3b3VsZCBsaWtlIHRvIHVzZSBmb3IgdGhlIFNRTCBFbmdpbmUgKGVnLiBTUUxfTGF0aW4xX0dlbmVyYWxfQ1AxX0NJX0FTKSIKICAgICRjb25maWcuU1FMQ29sbGF0aW9uID0gJElucHV0OwoKICAgICNDaG9vc2UgZmlsZXN0cmVhbSBtb2RlCgkkemVybyA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNob2ljZURlc2NyaXB0aW9uICImMCIsIkRpc2FibGUgRklMRVNUUkVBTSBzdXBwb3J0IGZvciB0aGlzIGluc3RhbmNlLiIKCSRvbmUgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5DaG9pY2VEZXNjcmlwdGlvbiAiJjEiLCJFbmFibGUgRklMRVNUUkVBTSBmb3IgVHJhbnNhY3QtU1FMIGFjY2Vzcy4iCiAgICAkdHdvID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiYyIiwiRW5hYmxlIEZJTEVTVFJFQU0gZm9yIFRyYW5zYWN0LVNRTCBhbmQgZmlsZSBJL08gc3RyZWFtaW5nIGFjY2Vzcy4gKE5vdCB2YWxpZCBmb3IgY2x1c3RlciBzY2VuYXJpb3MpIgogICAgJHRocmVlID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb24gIiYzIiwiQWxsb3cgcmVtb3RlIGNsaWVudHMgdG8gaGF2ZSBzdHJlYW1pbmcgYWNjZXNzIHRvIEZJTEVTVFJFQU0gZGF0YS4iCgkkY2hvaWNlcyA9IFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuQ2hvaWNlRGVzY3JpcHRpb25bXV0oJHplcm8sJG9uZSwkdHdvLCR0aHJlZSk7CgkkY2FwdGlvbiA9ICJRdWVzdGlvbiEiCgkkbWVzc2FnZSA9ICJTcGVjaWZ5IHRoZSBhY2Nlc3MgbGV2ZWwgZm9yIHRoZSBGSUxFU1RSRUFNIGZlYXR1cmUuIgoJJEZpbGVTdHJlYW1BY2Nlc3NMZXZlbCA9ICRIb3N0LlVJLlByb21wdEZvckNob2ljZSgkY2FwdGlvbiwkbWVzc2FnZSwkY2hvaWNlcywwKQoKICAgIHN3aXRjaCAoJEZpbGVTdHJlYW1BY2Nlc3NMZXZlbCkKCXsKCQkwIHsgJGNvbmZpZy5GaWxlU3RyZWFtTGV2ZWwgPSAwOyB9CgkJMSB7ICRjb25maWcuRmlsZVN0cmVhbUxldmVsID0gMTsgfQogICAgICAgIDIgeyAkY29uZmlnLkZpbGVTdHJlYW1MZXZlbCA9IDI7IH0KICAgICAgICAzIHsgJGNvbmZpZy5GaWxlU3RyZWFtTGV2ZWwgPSAzOyB9Cgl9CgogICAgaWYgKCgkY29uZmlnLkZpbGVTdHJlYW1MZXZlbCAtZXEgMikgLW9yICgkY29uZmlnLkZpbGVTdHJlYW1MZXZlbCAtZXEgMykpCiAgICB7CiAgICAgICAgJElucHV0ID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgZmlsZXN0cmVhbSBzaGFyZSB0aGF0IHlvdSB3b3VsZCBsaWtlIHRvIHVzZToiCiAgICAgICAgJGNvbmZpZy5GaWxlU3RyZWFtU2hhcmVOYW1lID0gJElucHV0OwogICAgfQp9CgpmdW5jdGlvbiBXcml0ZUNvbmZpZ0ZpbGUgKCkKewogICAgJGNvbmZpZy5QcmVwYXJlKFtyZWZdJGNvbmZpZyk7CiAgICAkY29uZmlnLlNhdmVUb0ZpbGUoJGZpbGUsIFtyZWZdJGNvbmZpZyk7Cn0KCiMjIyMjIyMjIyMjIyMjIyMKIyMjICAgTWFpbiAgIyMjIwojIyMjIyMjIyMjIyMjIyMjCgpXZWxjb21lTWVzc2FnZQoKU2V0SW5zdGFsbGF0aW9uVHlwZQoKU2V0RmlsZVBhdGgKCldyaXRlTm9uQ29uZmlndXJhYmxlT3B0aW9ucwoKQ29uZmlndXJlSW5zdGFuY2VPcHRpb25zCgppZigkSW5zdGFsbENob2ljZSAtbmUgIkFERE5PREUiKQp7CiAgICBTZXRGZWF0dXJlcwoKICAgIGlmKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJTUUxFTkdJTkUiKSB7IFNldFNRTEVuZ2luZUluZm9ybWF0aW9uIH0KCiAgICBpZigkY29uZmlnLkZlYXR1cmVMaXN0IC1jb250YWlucyAiRFJFUExBWV9DVExSIikgeyBTZXREaXN0cmlidXRlZFJlcGxheUluZm9ybWF0aW9uIH0KCiAgICBpZiAoKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJSUyIpIC1vciAoJGNvbmZpZy5GZWF0dXJlTGlzdCAtY29udGFpbnMgIlJTX1NIUCIpKQogICAgICAgIHsgU2V0UmVwb3J0aW5nSW5mb3JtYXRpb24gfQoKICAgIGlmKCRjb25maWcuRmVhdHVyZUxpc3QgLWNvbnRhaW5zICJBUyIpIHsgU2V0QW5hbHlzaXNJbmZvcm1hdGlvbiB9CgogICAgaWYoJGNvbmZpZy5GZWF0dXJlTGlzdCAtY29udGFpbnMgIklTIikgeyBTZXRJbnRlZ3JhdGlvbkluZm9ybWF0aW9uIH0KCiAgICBTZXRGaWxlRGlyZWN0b3JpZXMKCQkJCiAgICBTZXRTeXNBZG1pbkFjY291bnRzIAp9CgpTZXRTZXJ2aWNlQWNjb3VudHMgCgppZigkSW5zdGFsbENob2ljZSAtZXEgIklOU1RBTExDTFVTVEVSIikKewogICAgU2V0Q2x1c3RlckRpc2tzCgogICAgV3JpdGVBZGROb2RlRmlsZQp9CgpXcml0ZUNvbmZpZ0ZpbGUKCkV4aXRNZXNzYWdlCgkJClByaW50RXhlY0NNRAoK
