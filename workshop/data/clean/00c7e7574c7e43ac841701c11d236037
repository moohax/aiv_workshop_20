Invoke-SqlCmd2.psm1,5e6bcfaf38cf330a75ade495790541fc,Scan result is 1. IsMalware: 0,PCMKICAgIC5TWU5PUFNJUwogICAgICAgIFJ1bnMgYSBULVNRTCBzY3JpcHQuCiAgICAgCiAgICAuREVTQ1JJUFRJT04KICAgICAgICBSdW5zIGEgVC1TUUwgc2NyaXB0LiBJbnZva2UtU3FsY21kMiBvbmx5IHJldHVybnMgbWVzc2FnZSBvdXRwdXQsIHN1Y2ggYXMgdGhlIG91dHB1dCBvZiBQUklOVCBzdGF0ZW1lbnRzIHdoZW4gLXZlcmJvc2UgcGFyYW1ldGVyIGlzIHNwZWNpZmllZC4KICAgICAgICBQYXJhbWF0ZXJpemVkIHF1ZXJpZXMgYXJlIHN1cHBvcnRlZC4KICAgICAKICAgICAgICBIZWxwIGRldGFpbHMgYmVsb3cgYm9ycm93ZWQgZnJvbSBJbnZva2UtU3FsY21kLiAgTm90IHZlcmlmaWVkIGJ5IGEgU1FMIGV4cGVydCEKICAgICAKICAgIC5QQVJBTUVURVIgU2VydmVySW5zdGFuY2UKICAgICAgICBBIGNoYXJhY3RlciBzdHJpbmcgc3BlY2lmeWluZyB0aGUgbmFtZSBvZiBhbiBpbnN0YW5jZSBvZiB0aGUgRGF0YWJhc2UgRW5naW5lLiBGb3IgZGVmYXVsdCBpbnN0YW5jZXMsIG9ubHkgc3BlY2lmeSB0aGUgY29tcHV0ZXIgbmFtZTogIk15Q29tcHV0ZXIiLiBGb3IgbmFtZWQgaW5zdGFuY2VzLCB1c2UgdGhlIGZvcm1hdCAiQ29tcHV0ZXJOYW1lXEluc3RhbmNlTmFtZSIuCiAgICAgCiAgICAuUEFSQU1FVEVSIERhdGFiYXNlCiAgICAgICAgQSBjaGFyYWN0ZXIgc3RyaW5nIHNwZWNpZnlpbmcgdGhlIG5hbWUgb2YgYSBkYXRhYmFzZS4gSW52b2tlLVNxbGNtZDIgY29ubmVjdHMgdG8gdGhpcyBkYXRhYmFzZSBpbiB0aGUgaW5zdGFuY2UgdGhhdCBpcyBzcGVjaWZpZWQgaW4gLVNlcnZlckluc3RhbmNlLgogICAgIAogICAgLlBBUkFNRVRFUiBRdWVyeQogICAgICAgIFNwZWNpZmllcyBvbmUgb3IgbW9yZSBxdWVyaWVzIHRvIGJlIHJ1bi4gVGhlIHF1ZXJpZXMgY2FuIGJlIFRyYW5zYWN0LVNRTCAoPyBvciBYUXVlcnkgc3RhdGVtZW50cywgb3Igc3FsY21kIGNvbW1hbmRzLiBNdWx0aXBsZSBxdWVyaWVzIHNlcGFyYXRlZCBieSBhIHNlbWljb2xvbiBjYW4gYmUgc3BlY2lmaWVkLiBEbyBub3Qgc3BlY2lmeSB0aGUgc3FsY21kIEdPIHNlcGFyYXRvci4gRXNjYXBlIGFueSBkb3VibGUgcXVvdGF0aW9uIG1hcmtzIGluY2x1ZGVkIGluIHRoZSBzdHJpbmcgPykuIENvbnNpZGVyIHVzaW5nIGJyYWNrZXRlZCBpZGVudGlmaWVycyBzdWNoIGFzIFtNeVRhYmxlXSBpbnN0ZWFkIG9mIHF1b3RlZCBpZGVudGlmaWVycyBzdWNoIGFzICJNeVRhYmxlIi4KICAgICAKICAgIC5QQVJBTUVURVIgSW5wdXRGaWxlCiAgICAgICAgU3BlY2lmaWVzIGEgZmlsZSB0byBiZSB1c2VkIGFzIHRoZSBxdWVyeSBpbnB1dCB0byBJbnZva2UtU3FsY21kMi4gVGhlIGZpbGUgY2FuIGNvbnRhaW4gVHJhbnNhY3QtU1FMIHN0YXRlbWVudHMsICg/IFhRdWVyeSBzdGF0ZW1lbnRzLCBhbmQgc3FsY21kIGNvbW1hbmRzIGFuZCBzY3JpcHRpbmcgdmFyaWFibGVzID8pLiBTcGVjaWZ5IHRoZSBmdWxsIHBhdGggdG8gdGhlIGZpbGUuCiAgICAgCiAgICAuUEFSQU1FVEVSIFVzZXJuYW1lCiAgICAgICAgU3BlY2lmaWVzIHRoZSBsb2dpbiBJRCBmb3IgbWFraW5nIGEgU1FMIFNlcnZlciBBdXRoZW50aWNhdGlvbiBjb25uZWN0aW9uIHRvIGFuIGluc3RhbmNlIG9mIHRoZSBEYXRhYmFzZSBFbmdpbmUuIFRoZSBwYXNzd29yZCBtdXN0IGJlIHNwZWNpZmllZCB1c2luZyAtUGFzc3dvcmQuIElmIC1Vc2VybmFtZSBhbmQgLVBhc3N3b3JkIGFyZSBub3Qgc3BlY2lmaWVkLCBJbnZva2UtU3FsY21kIGF0dGVtcHRzIGEgV2luZG93cyBBdXRoZW50aWNhdGlvbiBjb25uZWN0aW9uIHVzaW5nIHRoZSBXaW5kb3dzIGFjY291bnQgcnVubmluZyB0aGUgUG93ZXJTaGVsbCBzZXNzaW9uLgogICAgICAgIFdoZW4gcG9zc2libGUsIHVzZSBXaW5kb3dzIEF1dGhlbnRpY2F0aW9uLgogICAgIAogICAgLlBBUkFNRVRFUiBQYXNzd29yZAogICAgICAgIFNwZWNpZmllcyB0aGUgcGFzc3dvcmQgZm9yIHRoZSBTUUwgU2VydmVyIEF1dGhlbnRpY2F0aW9uIGxvZ2luIElEIHRoYXQgd2FzIHNwZWNpZmllZCBpbiAtVXNlcm5hbWUuIFBhc3N3b3JkcyBhcmUgY2FzZS1zZW5zaXRpdmUuIFdoZW4gcG9zc2libGUsIHVzZSBXaW5kb3dzIEF1dGhlbnRpY2F0aW9uLiBEbyBub3QgdXNlIGEgYmxhbmsgcGFzc3dvcmQsIHdoZW4gcG9zc2libGUgdXNlIGEgc3Ryb25nIHBhc3N3b3JkLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlICJTdHJvbmcgUGFzc3dvcmQiIGluIFNRTCBTZXJ2ZXIgQm9va3MgT25saW5lLgogICAgICAgIFNFQ1VSSVRZIE5PVEU6IElmIHlvdSB0eXBlIC1QYXNzd29yZCBmb2xsb3dlZCBieSB5b3VyIHBhc3N3b3JkLCB0aGUgcGFzc3dvcmQgaXMgdmlzaWJsZSB0byBhbnlvbmUgd2hvIGNhbiBzZWUgeW91ciBtb25pdG9yLiBJZiB5b3UgY29kZSAtUGFzc3dvcmQgZm9sbG93ZWQgYnkgeW91ciBwYXNzd29yZCBpbiBhIC5wczEgc2NyaXB0LCBhbnlvbmUgcmVhZGluZyB0aGUgc2NyaXB0IGZpbGUgd2lsbCBzZWUgeW91ciBwYXNzd29yZC4gQXNzaWduIHRoZSBhcHByb3ByaWF0ZSBOVEZTIHBlcm1pc3Npb25zIHRvIHRoZSBmaWxlIHRvIHByZXZlbnQgb3RoZXIgdXNlcnMgZnJvbSBiZWluZyBhYmxlIHRvIHJlYWQgdGhlIGZpbGUuCiAgICAgCiAgICAuUEFSQU1FVEVSIFF1ZXJ5VGltZW91dAogICAgICAgIFNwZWNpZmllcyB0aGUgbnVtYmVyIG9mIHNlY29uZHMgYmVmb3JlIHRoZSBxdWVyaWVzIHRpbWUgb3V0LgogICAgIAogICAgLlBBUkFNRVRFUiBDb25uZWN0aW9uVGltZW91dAogICAgICAgIFNwZWNpZmllcyB0aGUgbnVtYmVyIG9mIHNlY29uZHMgd2hlbiBJbnZva2UtU3FsY21kMiB0aW1lcyBvdXQgaWYgaXQgY2Fubm90IHN1Y2Nlc3NmdWxseSBjb25uZWN0IHRvIGFuIGluc3RhbmNlIG9mIHRoZSBEYXRhYmFzZSBFbmdpbmUuIFRoZSB0aW1lb3V0IHZhbHVlIG11c3QgYmUgYW4gaW50ZWdlciBiZXR3ZWVuIDAgYW5kIDY1NTM0LiBJZiAwIGlzIHNwZWNpZmllZCwgY29ubmVjdGlvbiBhdHRlbXB0cyBkbyBub3QgdGltZSBvdXQuCiAgICAgCiAgICAuUEFSQU1FVEVSIEFzCiAgICAgICAgU3BlY2lmaWVzIG91dHB1dCB0eXBlIC0gRGF0YVNldCwgRGF0YVRhYmxlLCBhcnJheSBvZiBEYXRhUm93LCBvciBTaW5nbGUgVmFsdWUKICAgICAKICAgIC5QQVJBTUVURVIgREJOdWxsVG9OdWxsCiAgICAgICAgSWYgc3BlY2lmaWVkLCBhcnJheSBvZiBEYXRhUm93IHJlc3VsdHMgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gUFNPYmplY3QgYXJyYXkgd2l0aCBubyBEQk51bGwgdmFsdWVzLgogICAgICAgIFByb3BzIHRvIERhdmUgV3lhdHQgaHR0cDovL3Bvd2Vyc2hlbGwub3JnL3dwL2ZvcnVtcy90b3BpYy9kZWFsaW5nLXdpdGgtZGJudWxsLwogICAgIAogICAgLklOUFVUUwogICAgICAgIE5vbmUKICAgICAgICAgICAgWW91IGNhbm5vdCBwaXBlIG9iamVjdHMgdG8gSW52b2tlLVNxbGNtZDIKICAgICAKICAgIC5PVVRQVVRTCiAgICAgICBTeXN0ZW0uRGF0YS5EYXRhVGFibGUKICAgICAKICAgIC5FWEFNUExFCiAgICAgICAgSW52b2tlLVNxbGNtZDIgLVNlcnZlckluc3RhbmNlICJNeUNvbXB1dGVyXE15SW5zdGFuY2UiIC1RdWVyeSAiU0VMRUNUIGxvZ2luX3RpbWUgQVMgJ1N0YXJ0VGltZScgRlJPTSBzeXNwcm9jZXNzZXMgV0hFUkUgc3BpZCA9IDEiCiAgICAgICAKICAgICAgICBUaGlzIGV4YW1wbGUgY29ubmVjdHMgdG8gYSBuYW1lZCBpbnN0YW5jZSBvZiB0aGUgRGF0YWJhc2UgRW5naW5lIG9uIGEgY29tcHV0ZXIgYW5kIHJ1bnMgYSBiYXNpYyBULVNRTCBxdWVyeS4KICAgICAgICBTdGFydFRpbWUKICAgICAgICAtLS0tLS0tLS0tLQogICAgICAgIDIwMTAtMDgtMTIgMjE6MjE6MDMuNTkzCiAgICAgCiAgICAuRVhBTVBMRQogICAgICAgIEludm9rZS1TcWxjbWQyIC1TZXJ2ZXJJbnN0YW5jZSAiTXlDb21wdXRlclxNeUluc3RhbmNlIiAtSW5wdXRGaWxlICJDOlxNeUZvbGRlclx0c3Fsc2NyaXB0LnNxbCIgfCBPdXQtRmlsZSAtZmlsZVBhdGggIkM6XE15Rm9sZGVyXHRzcWxzY3JpcHQucnB0IgogICAgICAgCiAgICAgICAgVGhpcyBleGFtcGxlIHJlYWRzIGEgZmlsZSBjb250YWluaW5nIFQtU1FMIHN0YXRlbWVudHMsIHJ1bnMgdGhlIGZpbGUsIGFuZCB3cml0ZXMgdGhlIG91dHB1dCB0byBhbm90aGVyIGZpbGUuCiAgICAgCiAgICAuRVhBTVBMRQogICAgICAgIEludm9rZS1TcWxjbWQyICAtU2VydmVySW5zdGFuY2UgIk15Q29tcHV0ZXJcTXlJbnN0YW5jZSIgLVF1ZXJ5ICJQUklOVCAnaGVsbG8gd29ybGQnIiAtVmVyYm9zZQogICAgIAogICAgICAgIFRoaXMgZXhhbXBsZSB1c2VzIHRoZSBQb3dlclNoZWxsIC1WZXJib3NlIHBhcmFtZXRlciB0byByZXR1cm4gdGhlIG1lc3NhZ2Ugb3V0cHV0IG9mIHRoZSBQUklOVCBjb21tYW5kLgogICAgICAgIFZFUkJPU0U6IGhlbGxvIHdvcmxkCiAgICAgCiAgICAuTk9URVMKICAgIFZlcnNpb24gSGlzdG9yeQogICAgdjEuMCAgIC0gQ2hhZCBNaWxsZXIgLSBJbml0aWFsIHJlbGVhc2UKICAgIHYxLjEgICAtIENoYWQgTWlsbGVyIC0gRml4ZWQgSXNzdWUgd2l0aCBjb25uZWN0aW9uIGNsb3NpbmcKICAgIHYxLjIgICAtIENoYWQgTWlsbGVyIC0gQWRkZWQgaW5wdXRmaWxlLCBTUUwgYXV0aCBzdXBwb3J0LCBjb25uZWN0aW9udGltZW91dCBhbmQgb3V0cHV0IG1lc3NhZ2UgaGFuZGxpbmcuIFVwZGF0ZWQgaGVscCBkb2N1bWVudGF0aW9uCiAgICB2MS4zICAgLSBDaGFkIE1pbGxlciAtIEFkZGVkIEFzIHBhcmFtZXRlciB0byBjb250cm9sIERhdGFTZXQsIERhdGFUYWJsZSBvciBhcnJheSBvZiBEYXRhUm93IE91dHB1dCB0eXBlCiAgICB2MS40ICAgLSBKdXN0aW4gRGVhcmluZyA8emlwcHkxOTgxIF9hdF8gZ21haWwuY29tPiAtIEFkZGVkIHRoZSBhYmlsaXR5IHRvIHBhc3MgcGFyYW1ldGVycyB0byB0aGUgcXVlcnkuCiAgICB2MS40LjEgLSBQYXVsIEJyeXNvbiA8YXRhbWlkbyBfYXRfIGdtYWlsLmNvbT4gLSBBZGRlZCBmaXggdG8gY2hlY2sgZm9yIG51bGwgdmFsdWVzIGluIHBhcmFtZXRlcml6ZWQgcXVlcmllcyBhbmQgcmVwbGFjZSB3aXRoIFtEQk51bGxdCiAgICB2MS41ICAgLSBKb2VsIEJlbm5ldHQgLSBhZGQgU2luZ2xlVmFsdWUgb3V0cHV0IG9wdGlvbgogICAgdjEuNS4xIC0gUmFtYmxpbmdDb29raWVNb25zdGVyIC0gQWRkZWQgUGFyYW1ldGVyU2V0cywgc2V0IFF1ZXJ5IGFuZCBJbnB1dEZpbGUgdG8gbWFuZGF0b3J5CiAgICB2MS41LjIgLSBSYW1ibGluZ0Nvb2tpZU1vbnN0ZXIgLSBBZGRlZCBEQk51bGxUb051bGwgc3dpdGNoIGFuZCBjb2RlIGZyb20gRGF2ZSBXeWF0dC4gIEFkZGVkIHBhcmFtZXRlcnMgdG8gY29tbWVudCBiYXNlZCBoZWxwIChuZWVkIHNvbWVvbmUgd2l0aCBTUUwgZXhwZXJ0aXNlIHRvIHZlcmlmeSB0aGVzZSkKICAgIHYxLjUuMyAtIEFhcm9uIENhbGRlcm9uIC0gQWRkZWQgW3N3aXRjaF0kVHJ1c3RlZENvbm5lY3Rpb24gcGFyYW1ldGVyIHRvIGFsbG93IGZvciBjb25uZWN0aW5nIHdpdGggdHJ1c3RlZCBjb25uZWN0aW9ucyB0byBEQi4KCQoJRG93bmxvYWRlZCBmcm9tCgkgaHR0cDovL3Bvc2hjb2RlLm9yZy82MzQwCgkgCiM+CmZ1bmN0aW9uIEludm9rZS1TcWxjbWQyCnsKCVtDbWRsZXRCaW5kaW5nKAoJCURlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSdRdWVyeScKCSldCglwYXJhbSgKCQlbUGFyYW1ldGVyKCBQb3NpdGlvbj0wLCBNYW5kYXRvcnk9JHRydWUpXQoJCVtzdHJpbmddJFNlcnZlckluc3RhbmNlLAogICAKCQlbUGFyYW1ldGVyKCBQb3NpdGlvbj0xLCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbc3RyaW5nXSREYXRhYmFzZSwKICAgCgkJW1BhcmFtZXRlciggUG9zaXRpb249MiwKCQkJCQlNYW5kYXRvcnk9JHRydWUsCgkJCQkJUGFyYW1ldGVyU2V0TmFtZT0iUXVlcnkiKV0KCQlbc3RyaW5nXSRRdWVyeSwKICAgCgkJW1BhcmFtZXRlciggUG9zaXRpb249MiwKCQkJCQlNYW5kYXRvcnk9JHRydWUsCgkJCQkJUGFyYW1ldGVyU2V0TmFtZT0iRmlsZSIpXQoJCVtWYWxpZGF0ZVNjcmlwdCh7dGVzdC1wYXRoICRffSldCgkJW3N0cmluZ10kSW5wdXRGaWxlLAogCgkJW1BhcmFtZXRlcihQb3NpdGlvbj0zLCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbc3RyaW5nXSRVc2VybmFtZSwKICAgCgkJW1BhcmFtZXRlcihQb3NpdGlvbj00LCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbc3RyaW5nXSRQYXNzd29yZCwKICAgCgkJW1BhcmFtZXRlcihQb3NpdGlvbj01LCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbSW50MzJdJFF1ZXJ5VGltZW91dD02MDAsCiAgIAoJCVtQYXJhbWV0ZXIoUG9zaXRpb249NiwgTWFuZGF0b3J5PSRmYWxzZSldCgkJW0ludDMyXSRDb25uZWN0aW9uVGltZW91dD0xNSwKICAgCgkJW1BhcmFtZXRlcihQb3NpdGlvbj03LCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbVmFsaWRhdGVTZXQoIkRhdGFTZXQiLCAiRGF0YVRhYmxlIiwgIkRhdGFSb3ciLCJTaW5nbGVWYWx1ZSIpXQoJCVtzdHJpbmddJEFzPSJEYXRhUm93IiwKICAgCgkJW1BhcmFtZXRlcihQb3NpdGlvbj04LCBNYW5kYXRvcnk9JGZhbHNlKV0KCQlbU3lzdGVtLkNvbGxlY3Rpb25zLklEaWN0aW9uYXJ5XSRTcWxQYXJhbWV0ZXJzLAogCgkJW3N3aXRjaF0kREJOdWxsVG9OdWxsLAogCgkJW1BhcmFtZXRlcihNYW5kYXRvcnk9JGZhbHNlKV0gW3N3aXRjaF0kVHJ1c3RlZENvbm5lY3Rpb24KCSkKIAoJaWYgKCRJbnB1dEZpbGUpCgl7CgkJJGZpbGVQYXRoID0gJChSZXNvbHZlLVBhdGggJElucHV0RmlsZSkucGF0aAoJCSRRdWVyeSA9ICBbU3lzdGVtLklPLkZpbGVdOjpSZWFkQWxsVGV4dCgiJGZpbGVQYXRoIikKCX0KIAoJJGNvbm4gPSBOZXctT2JqZWN0IFN5c3RlbS5EYXRhLlNxbENsaWVudC5TUUxDb25uZWN0aW9uCgkjIGFsbG93IHRoZSB1c2Ugb2YgdHJ1c3RlZCBjb25uZWN0aW9ucwoJaWYoJFRydXN0ZWRDb25uZWN0aW9uKSB7ICR0cnVzdCA9ICdUcnVlJ30gZWxzZSB7ICR0cnVzdCA9ICdGYWxzZSd9CgkgCglpZiAoJFRydXN0ZWRDb25uZWN0aW9uKQoJeyAkQ29ubmVjdGlvblN0cmluZyA9ICJTZXJ2ZXI9ezB9O0RhdGFiYXNlPXsxfTtUcnVzdGVkX0Nvbm5lY3Rpb249ezJ9O0Nvbm5lY3QgVGltZW91dD17M30iIC1mICRTZXJ2ZXJJbnN0YW5jZSwkRGF0YWJhc2UsJHRydXN0LCRDb25uZWN0aW9uVGltZW91dCB9CgllbHNlaWYgKCRVc2VybmFtZSkKCXsgJENvbm5lY3Rpb25TdHJpbmcgPSAiU2VydmVyPXswfTtEYXRhYmFzZT17MX07VXNlciBJRD17Mn07UGFzc3dvcmQ9ezN9O1RydXN0ZWRfQ29ubmVjdGlvbj1GYWxzZTtDb25uZWN0IFRpbWVvdXQ9ezR9IiAtZiAkU2VydmVySW5zdGFuY2UsJERhdGFiYXNlLCRVc2VybmFtZSwkUGFzc3dvcmQsJENvbm5lY3Rpb25UaW1lb3V0IH0KCWVsc2UKCXsgJENvbm5lY3Rpb25TdHJpbmcgPSAiU2VydmVyPXswfTtEYXRhYmFzZT17MX07SW50ZWdyYXRlZCBTZWN1cml0eT1UcnVlO0Nvbm5lY3QgVGltZW91dD17Mn0iIC1mICRTZXJ2ZXJJbnN0YW5jZSwkRGF0YWJhc2UsJENvbm5lY3Rpb25UaW1lb3V0IH0KIAoJJGNvbm4uQ29ubmVjdGlvblN0cmluZyA9ICRDb25uZWN0aW9uU3RyaW5nCgkgCgkjRm9sbG93aW5nIEV2ZW50SGFuZGxlciBpcyB1c2VkIGZvciBQUklOVCBhbmQgUkFJU0VSUk9SIFQtU1FMIHN0YXRlbWVudHMuIEV4ZWN1dGVkIHdoZW4gLVZlcmJvc2UgcGFyYW1ldGVyIHNwZWNpZmllZCBieSBjYWxsZXIKCWlmICgkUFNCb3VuZFBhcmFtZXRlcnMuVmVyYm9zZSkKCXsKCQkkY29ubi5GaXJlSW5mb01lc3NhZ2VFdmVudE9uVXNlckVycm9ycz0kdHJ1ZQoJCSRoYW5kbGVyID0gW1N5c3RlbS5EYXRhLlNxbENsaWVudC5TcWxJbmZvTWVzc2FnZUV2ZW50SGFuZGxlcl0geyBXcml0ZS1WZXJib3NlICIkKCRfKSIgfQoJCSRjb25uLmFkZF9JbmZvTWVzc2FnZSgkaGFuZGxlcikKCX0KCSAKCSRjb25uLk9wZW4oKQogCgkkY21kID0gTmV3LU9iamVjdCBzeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsQ29tbWFuZCgkUXVlcnksJGNvbm4pCgkkY21kLkNvbW1hbmRUaW1lb3V0PSRRdWVyeVRpbWVvdXQKIAoJaWYgKCRTcWxQYXJhbWV0ZXJzIC1uZSAkbnVsbCkKCXsKCQkkU3FsUGFyYW1ldGVycy5HZXRFbnVtZXJhdG9yKCkgfAoJCQlGb3JFYWNoLU9iamVjdCB7CgkJCQlJZiAoJF8uVmFsdWUgLW5lICRudWxsKQoJCQkJeyAkY21kLlBhcmFtZXRlcnMuQWRkV2l0aFZhbHVlKCRfLktleSwgJF8uVmFsdWUpIH0KCQkJCUVsc2UKCQkJCXsgJGNtZC5QYXJhbWV0ZXJzLkFkZFdpdGhWYWx1ZSgkXy5LZXksIFtEQk51bGxdOjpWYWx1ZSkgfQoJCQl9ID4gJG51bGwKCX0KICAgCgkkZHMgPSBOZXctT2JqZWN0IHN5c3RlbS5EYXRhLkRhdGFTZXQKCSRkYSA9IE5ldy1PYmplY3Qgc3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbERhdGFBZGFwdGVyKCRjbWQpCiAgIAoJW3ZvaWRdJGRhLmZpbGwoJGRzKQoJJGNvbm4uQ2xvc2UoKQogCgkjVGhpcyBjb2RlIHNjcnVicyBEQk51bGxzCgkkY1NoYXJwID0gQCcKCSAgIHVzaW5nIFN5c3RlbTsKCSAgIHVzaW5nIFN5c3RlbS5EYXRhOwoJICAgdXNpbmcgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbjsKIAoJICAgcHVibGljIGNsYXNzIERCTnVsbFNjcnViYmVyCgkgICB7CgkJICAgcHVibGljIHN0YXRpYyBQU09iamVjdCBEYXRhUm93VG9QU09iamVjdChEYXRhUm93IHJvdykKCQkgICB7CgkJCSAgIFBTT2JqZWN0IHBzT2JqZWN0ID0gbmV3IFBTT2JqZWN0KCk7CiAKCQkJICAgaWYgKHJvdyAhPSBudWxsICYmIChyb3cuUm93U3RhdGUgJiBEYXRhUm93U3RhdGUuRGV0YWNoZWQpICE9IERhdGFSb3dTdGF0ZS5EZXRhY2hlZCkKCQkJICAgewoJCQkJICAgZm9yZWFjaCAoRGF0YUNvbHVtbiBjb2x1bW4gaW4gcm93LlRhYmxlLkNvbHVtbnMpCgkJCQkgICB7CgkJCQkJICAgT2JqZWN0IHZhbHVlID0gbnVsbDsKCQkJCQkgICBpZiAoIXJvdy5Jc051bGwoY29sdW1uKSkKCQkJCQkgICB7CgkJCQkJCSAgIHZhbHVlID0gcm93W2NvbHVtbl07CgkJCQkJICAgfQogCgkJCQkJICAgcHNPYmplY3QuUHJvcGVydGllcy5BZGQobmV3IFBTTm90ZVByb3BlcnR5KGNvbHVtbi5Db2x1bW5OYW1lLCB2YWx1ZSkpOwoJCQkJICAgfQoJCQkgICB9CiAKCQkJICAgcmV0dXJuIHBzT2JqZWN0OwoJCSAgIH0KCSAgIH0KJ0AKIAoJc3dpdGNoICgkQXMpCgl7CgkJJ0RhdGFTZXQnCgkJewoJCQkkZHMKCQl9CgkJJ0RhdGFUYWJsZScKCQl7CgkJCSRkcy5UYWJsZXMKCQl9CgkJJ0RhdGFSb3cnCgkJewoJCQlpZigtbm90ICREQk51bGxUb051bGwpCgkJCXsKCQkJCSRkcy5UYWJsZXNbMF0KCQkJfQoJCQllbHNlCgkJCXsKCQkJCSNTY3J1YiBEQk51bGxzIGlmIHNwZWNpZmllZC4KCQkJCSNQcm92aWRlcyBjb252ZW5pZW50IHJlc3VsdHMgeW91IGNhbiB1c2UgY29tcGFyaXNvbnMgd2l0aAoJCQkJI0ludHJvZHVjZXMgb3ZlcmhlYWQgKGUuZy4gfjIwMDAgcm93cyB3LyB+ODAgY29sdW1ucyB3ZW50IGZyb20gLjE1IFNlY29uZHMgdG8gLjY1IFNlY29uZHMgLSBkZXBlbmRpbmcgb24geW91ciBkYXRhIGNvdWxkIGJlIG11Y2ggbW9yZSEpCgkJCQlBZGQtVHlwZSAtVHlwZURlZmluaXRpb24gJGNTaGFycCAtUmVmZXJlbmNlZEFzc2VtYmxpZXMgJ1N5c3RlbS5EYXRhJywnU3lzdGVtLlhtbCcKIAoJCQkJZm9yZWFjaCAoJHJvdyBpbiAkZHMuVGFibGVzWzBdLlJvd3MpCgkJCQl7CgkJCQkJW0RCTnVsbFNjcnViYmVyXTo6RGF0YVJvd1RvUFNPYmplY3QoJHJvdykKCQkJCX0KCQkJfQoJCX0KCQknU2luZ2xlVmFsdWUnCgkJewoJCQkkZHMuVGFibGVzWzBdIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kICRkcy5UYWJsZXNbMF0uQ29sdW1uc1swXS5Db2x1bW5OYW1lCgkJfQoJfQogCn0gI0ludm9rZS1TcWxjbWQyCg==
