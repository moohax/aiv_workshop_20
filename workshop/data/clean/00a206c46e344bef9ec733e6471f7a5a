InitializeFunctions.ps1,99d8d9a7bdebbc6b13205f2c8f209e02,Scan result is 1. IsMalware: 0,w6/Cu8K/ZnVuY3Rpb24gQWRkLUNlcnRpZmljYXRlIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbShbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldJEVuZHBvaW50KQoKICAgICMgQWRkIHRoZSBjZXJ0aWZpY2F0ZSB0byB0aGUgY2VydCBzdG9yZS4KICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJEVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5DZXJ0aWZpY2F0ZSkKICAgICRjZXJ0aWZpY2F0ZSA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YNTA5Q2VydGlmaWNhdGVzLlg1MDlDZXJ0aWZpY2F0ZTIKICAgICRjZXJ0aWZpY2F0ZS5JbXBvcnQoJGJ5dGVzKQogICAgJHN0b3JlID0gTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMuWDUwOVN0b3JlKAogICAgICAgIChbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YNTA5Q2VydGlmaWNhdGVzLlN0b3JlTmFtZV06Ok15KSwKICAgICAgICAoW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWDUwOUNlcnRpZmljYXRlcy5TdG9yZUxvY2F0aW9uXTo6Q3VycmVudFVzZXIpKQogICAgJHN0b3JlLk9wZW4oKFtTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Llg1MDlDZXJ0aWZpY2F0ZXMuT3BlbkZsYWdzXTo6UmVhZFdyaXRlKSkKICAgICRzdG9yZS5BZGQoJGNlcnRpZmljYXRlKQogICAgJHN0b3JlLkNsb3NlKCkKICAgIHJldHVybiAkY2VydGlmaWNhdGUKfQoKZnVuY3Rpb24gRm9ybWF0LVNwbGF0IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbShbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV1baGFzaHRhYmxlXSRIYXNodGFibGUpCgogICAgIyBDb2xsZWN0IHRoZSBwYXJhbWV0ZXJzIChuYW1lcyBhbmQgdmFsdWVzKSBpbiBhbiBhcnJheS4KICAgICRwYXJhbWV0ZXJzID0gZm9yZWFjaCAoJGtleSBpbiAkSGFzaHRhYmxlLktleXMpIHsKICAgICAgICAkdmFsdWUgPSAkSGFzaHRhYmxlWyRrZXldCiAgICAgICAgIyBJZiB0aGUgdmFsdWUgaXMgYSBib29sLCBmb3JtYXQgdGhlIHBhcmFtZXRlciBhcyBhIHN3aXRjaCAoZW5kaW5nIHdpdGggJzonKS4KICAgICAgICBpZiAoJHZhbHVlIC1pcyBbYm9vbF0pIHsgIi0kKCRrZXkpOiIgfSBlbHNlIHsgIi0ka2V5IiB9CiAgICAgICAgJHZhbHVlCiAgICB9CgogICAgJE9GUyA9ICIgIgogICAgIiRwYXJhbWV0ZXJzIiAjIFN0cmluZyBqb2luIHRoZSBhcnJheS4KfQoKZnVuY3Rpb24gSW5pdGlhbGl6ZS1BenVyZVN1YnNjcmlwdGlvbiB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgICRFbmRwb2ludCwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kZmFsc2UpXQogICAgICAgIFtzdHJpbmddJFN0b3JhZ2VBY2NvdW50KQoKICAgICNTZXQgVXNlckFnZW50IGZvciBBenVyZSBDYWxscwogICAgU2V0LVVzZXJBZ2VudAoKICAgICRlbnZpcm9ubWVudE5hbWUgPSAiQXp1cmVDbG91ZCIKICAgIGlmKCRFbmRwb2ludC5EYXRhLkVudmlyb25tZW50KSB7CiAgICAgICAgJGVudmlyb25tZW50TmFtZSA9ICRFbmRwb2ludC5EYXRhLkVudmlyb25tZW50CiAgICB9CiAgICAKICAgIGlmICgkRW5kcG9pbnQuQXV0aC5TY2hlbWUgLWVxICdDZXJ0aWZpY2F0ZScpIHsKICAgICAgICAjIENlcnRpZmljYXRlIGlzIG9ubHkgc3VwcG9ydGVkIGZvciB0aGUgQXp1cmUgbW9kdWxlLgogICAgICAgIGlmICghJHNjcmlwdDphenVyZU1vZHVsZSkgewogICAgICAgICAgICB0aHJvdyAoR2V0LVZzdHNMb2NTdHJpbmcgLUtleSBBWl9DZXJ0aWZpY2F0ZUF1dGhOb3RTdXBwb3J0ZWQpCiAgICAgICAgfQoKICAgICAgICAjIEFkZCB0aGUgY2VydGlmaWNhdGUgdG8gdGhlIGNlcnQgc3RvcmUuCiAgICAgICAgJGNlcnRpZmljYXRlID0gQWRkLUNlcnRpZmljYXRlIC1FbmRwb2ludCAkRW5kcG9pbnQKCiAgICAgICAgIyBTZXR1cCB0aGUgYWRkaXRpb25hbCBwYXJhbWV0ZXJzLgogICAgICAgICRhZGRpdGlvbmFsID0gQHsgfQogICAgICAgIGlmICgkU3RvcmFnZUFjY291bnQpIHsKICAgICAgICAgICAgJGFkZGl0aW9uYWxbJ0N1cnJlbnRTdG9yYWdlQWNjb3VudE5hbWUnXSA9ICRTdG9yYWdlQWNjb3VudAogICAgICAgIH0KCiAgICAgICAgIyBTZXQgdGhlIHN1YnNjcmlwdGlvbi4KICAgICAgICBXcml0ZS1Ib3N0ICIjI1tjb21tYW5kXVNldC1BenVyZVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uTmFtZSAkKCRFbmRwb2ludC5EYXRhLlN1YnNjcmlwdGlvbk5hbWUpIC1TdWJzY3JpcHRpb25JZCAkKCRFbmRwb2ludC5EYXRhLlN1YnNjcmlwdGlvbklkKSAtQ2VydGlmaWNhdGUgKioqKioqKiogLUVudmlyb25tZW50ICRlbnZpcm9ubWVudE5hbWUgJChGb3JtYXQtU3BsYXQgJGFkZGl0aW9uYWwpIgogICAgICAgIFNldC1BenVyZVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uTmFtZSAkRW5kcG9pbnQuRGF0YS5TdWJzY3JpcHRpb25OYW1lIC1TdWJzY3JpcHRpb25JZCAkRW5kcG9pbnQuRGF0YS5TdWJzY3JpcHRpb25JZCAtQ2VydGlmaWNhdGUgJGNlcnRpZmljYXRlIC1FbnZpcm9ubWVudCAkZW52aXJvbm1lbnROYW1lIEBhZGRpdGlvbmFsCiAgICAgICAgU2V0LUN1cnJlbnRBenVyZVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uSWQgJEVuZHBvaW50LkRhdGEuU3Vic2NyaXB0aW9uSWQgLVN0b3JhZ2VBY2NvdW50ICRTdG9yYWdlQWNjb3VudAogICAgfSBlbHNlaWYgKCRFbmRwb2ludC5BdXRoLlNjaGVtZSAtZXEgJ1VzZXJOYW1lUGFzc3dvcmQnKSB7CiAgICAgICAgJHBzQ3JlZGVudGlhbCA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWwoCiAgICAgICAgICAgICRFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuVXNlck5hbWUsCiAgICAgICAgICAgIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICRFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuUGFzc3dvcmQgLUFzUGxhaW5UZXh0IC1Gb3JjZSkpCgogICAgICAgICMgQWRkIGFjY291bnQgKEF6dXJlKS4KICAgICAgICBpZiAoJHNjcmlwdDphenVyZU1vZHVsZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiIyNbY29tbWFuZF1BZGQtQXp1cmVBY2NvdW50IC1DcmVkZW50aWFsICRwc0NyZWRlbnRpYWwiCiAgICAgICAgICAgICAgICAkbnVsbCA9IEFkZC1BenVyZUFjY291bnQgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbAogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICMgUHJvdmlkZSBhbiBhZGRpdGlvbmFsLCBjdXN0b20sIGNyZWRlbnRpYWxzLXJlbGF0ZWQgZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgICAgIFdyaXRlLVZzdHNUYXNrRXJyb3IgLU1lc3NhZ2UgJF8uRXhjZXB0aW9uLk1lc3NhZ2UKICAgICAgICAgICAgICAgIHRocm93IChOZXctT2JqZWN0IFN5c3RlbS5FeGNlcHRpb24oKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgQVpfQ3JlZGVudGlhbHNFcnJvciksICRfLkV4Y2VwdGlvbikpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgQWRkIGFjY291bnQgKEF6dXJlUk0pLgogICAgICAgIGlmICgkc2NyaXB0OmF6dXJlUk1Qcm9maWxlTW9kdWxlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICIjI1tjb21tYW5kXUFkZC1BenVyZVJNQWNjb3VudCAtQ3JlZGVudGlhbCAkcHNDcmVkZW50aWFsIgogICAgICAgICAgICAgICAgJG51bGwgPSBBZGQtQXp1cmVSTUFjY291bnQgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbAogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICMgUHJvdmlkZSBhbiBhZGRpdGlvbmFsLCBjdXN0b20sIGNyZWRlbnRpYWxzLXJlbGF0ZWQgZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgICAgIFdyaXRlLVZzdHNUYXNrRXJyb3IgLU1lc3NhZ2UgJF8uRXhjZXB0aW9uLk1lc3NhZ2UKICAgICAgICAgICAgICAgIHRocm93IChOZXctT2JqZWN0IFN5c3RlbS5FeGNlcHRpb24oKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgQVpfQ3JlZGVudGlhbHNFcnJvciksICRfLkV4Y2VwdGlvbikpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgU2VsZWN0IHN1YnNjcmlwdGlvbiAoQXp1cmUpLgogICAgICAgIGlmICgkc2NyaXB0OmF6dXJlTW9kdWxlKSB7CiAgICAgICAgICAgIFNldC1DdXJyZW50QXp1cmVTdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbklkICRFbmRwb2ludC5EYXRhLlN1YnNjcmlwdGlvbklkIC1TdG9yYWdlQWNjb3VudCAkU3RvcmFnZUFjY291bnQKICAgICAgICB9CgogICAgICAgICMgU2VsZWN0IHN1YnNjcmlwdGlvbiAoQXp1cmVSTSkuCiAgICAgICAgaWYgKCRzY3JpcHQ6YXp1cmVSTVByb2ZpbGVNb2R1bGUpIHsKICAgICAgICAgICAgU2V0LUN1cnJlbnRBenVyZVJNU3Vic2NyaXB0aW9uIC1TdWJzY3JpcHRpb25JZCAkRW5kcG9pbnQuRGF0YS5TdWJzY3JpcHRpb25JZAogICAgICAgIH0KICAgIH0gZWxzZWlmICgkRW5kcG9pbnQuQXV0aC5TY2hlbWUgLWVxICdTZXJ2aWNlUHJpbmNpcGFsJykgewogICAgICAgICRwc0NyZWRlbnRpYWwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsKAogICAgICAgICAgICAkRW5kcG9pbnQuQXV0aC5QYXJhbWV0ZXJzLlNlcnZpY2VQcmluY2lwYWxJZCwKICAgICAgICAgICAgKENvbnZlcnRUby1TZWN1cmVTdHJpbmcgJEVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5TZXJ2aWNlUHJpbmNpcGFsS2V5IC1Bc1BsYWluVGV4dCAtRm9yY2UpKQogICAgICAgIGlmICgkc2NyaXB0OmF6dXJlTW9kdWxlIC1hbmQgJHNjcmlwdDphenVyZU1vZHVsZS5WZXJzaW9uIC1sdCAoW3ZlcnNpb25dJzAuOS45JykpIHsKICAgICAgICAgICAgIyBTZXJ2aWNlIHByaW5jaXBhbHMgYXJlbnQgc3VwcG9ydGVkIGZyb20gMC45LjkgYW5kIGdyZWF0ZXIgaW4gdGhlIEF6dXJlIG1vZHVsZS4KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIiMjW2NvbW1hbmRdQWRkLUF6dXJlQWNjb3VudCAtU2VydmljZVByaW5jaXBhbCAtVGVuYW50ICQoJEVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5UZW5hbnRJZCkgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbCIKICAgICAgICAgICAgICAgICRudWxsID0gQWRkLUF6dXJlQWNjb3VudCAtU2VydmljZVByaW5jaXBhbCAtVGVuYW50ICRFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuVGVuYW50SWQgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbAogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICMgUHJvdmlkZSBhbiBhZGRpdGlvbmFsLCBjdXN0b20sIGNyZWRlbnRpYWxzLXJlbGF0ZWQgZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgICAgIFdyaXRlLVZzdHNUYXNrRXJyb3IgLU1lc3NhZ2UgJF8uRXhjZXB0aW9uLk1lc3NhZ2UKICAgICAgICAgICAgICAgIHRocm93IChOZXctT2JqZWN0IFN5c3RlbS5FeGNlcHRpb24oKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgQVpfU2VydmljZVByaW5jaXBhbEVycm9yKSwgJF8uRXhjZXB0aW9uKSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgU2V0LUN1cnJlbnRBenVyZVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uSWQgJEVuZHBvaW50LkRhdGEuU3Vic2NyaXB0aW9uSWQgLVN0b3JhZ2VBY2NvdW50ICRTdG9yYWdlQWNjb3VudAogICAgICAgIH0gZWxzZWlmICgkc2NyaXB0OmF6dXJlTW9kdWxlKSB7CiAgICAgICAgICAgICMgVGhyb3cgaWYgPj0wLjkuOSBBenVyZS4KICAgICAgICAgICAgdGhyb3cgKEdldC1Wc3RzTG9jU3RyaW5nIC1LZXkgIkFaX1NlcnZpY2VQcmluY2lwYWxBdXRoTm90U3VwcG9ydGVkQXp1cmVWZXJzaW9uMCIgLUFyZ3VtZW50TGlzdCAkc2NyaXB0OmF6dXJlTW9kdWxlLlZlcnNpb24pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIyBFbHNlLCB0aGlzIGlzIEF6dXJlUk0uCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICIjI1tjb21tYW5kXUFkZC1BenVyZVJNQWNjb3VudCAtU2VydmljZVByaW5jaXBhbCAtVGVuYW50ICQoJEVuZHBvaW50LkF1dGguUGFyYW1ldGVycy5UZW5hbnRJZCkgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbCAtRW52aXJvbm1lbnROYW1lICRlbnZpcm9ubWVudE5hbWUiCiAgICAgICAgICAgICAgICAkbnVsbCA9IEFkZC1BenVyZVJNQWNjb3VudCAtU2VydmljZVByaW5jaXBhbCAtVGVuYW50ICRFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuVGVuYW50SWQgLUNyZWRlbnRpYWwgJHBzQ3JlZGVudGlhbCAtRW52aXJvbm1lbnROYW1lICRlbnZpcm9ubWVudE5hbWUKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAjIFByb3ZpZGUgYW4gYWRkaXRpb25hbCwgY3VzdG9tLCBjcmVkZW50aWFscy1yZWxhdGVkIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgICAgICAgICBXcml0ZS1Wc3RzVGFza0Vycm9yIC1NZXNzYWdlICRfLkV4Y2VwdGlvbi5NZXNzYWdlCiAgICAgICAgICAgICAgICB0aHJvdyAoTmV3LU9iamVjdCBTeXN0ZW0uRXhjZXB0aW9uKChHZXQtVnN0c0xvY1N0cmluZyAtS2V5IEFaX1NlcnZpY2VQcmluY2lwYWxFcnJvciksICRfLkV4Y2VwdGlvbikpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFNldC1DdXJyZW50QXp1cmVSTVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uSWQgJEVuZHBvaW50LkRhdGEuU3Vic2NyaXB0aW9uSWQgLVRlbmFudElkICRFbmRwb2ludC5BdXRoLlBhcmFtZXRlcnMuVGVuYW50SWQKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIHRocm93IChHZXQtVnN0c0xvY1N0cmluZyAtS2V5IEFaX1Vuc3VwcG9ydGVkQXV0aFNjaGVtZTAgLUFyZ3VtZW50TGlzdCAkRW5kcG9pbnQuQXV0aC5TY2hlbWUpCiAgICB9Cn0KCmZ1bmN0aW9uIFNldC1DdXJyZW50QXp1cmVTdWJzY3JpcHRpb24gewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRTdWJzY3JpcHRpb25JZCwKICAgICAgICBbc3RyaW5nXSRTdG9yYWdlQWNjb3VudCkKCiAgICAkYWRkaXRpb25hbCA9IEB7IH0KICAgIGlmICgkc2NyaXB0OmF6dXJlTW9kdWxlLlZlcnNpb24gLWx0IChbdmVyc2lvbl0nMC44LjE1JykpIHsKICAgICAgICAkYWRkaXRpb25hbFsnRGVmYXVsdCddID0gJHRydWUgIyBUaGUgRGVmYXVsdCBzd2l0Y2ggaXMgcmVxdWlyZWQgcHJpb3IgdG8gMC44LjE1LgogICAgfQoKICAgIFdyaXRlLUhvc3QgIiMjW2NvbW1hbmRdU2VsZWN0LUF6dXJlU3Vic2NyaXB0aW9uIC1TdWJzY3JpcHRpb25JZCAkU3Vic2NyaXB0aW9uSWQgJChGb3JtYXQtU3BsYXQgJGFkZGl0aW9uYWwpIgogICAgJG51bGwgPSBTZWxlY3QtQXp1cmVTdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbklkICRTdWJzY3JpcHRpb25JZCBAYWRkaXRpb25hbAogICAgaWYgKCRTdG9yYWdlQWNjb3VudCkgewogICAgICAgIFdyaXRlLUhvc3QgIiMjW2NvbW1hbmRdU2V0LUF6dXJlU3Vic2NyaXB0aW9uIC1TdWJzY3JpcHRpb25JZCAkU3Vic2NyaXB0aW9uSWQgLUN1cnJlbnRTdG9yYWdlQWNjb3VudE5hbWUgJFN0b3JhZ2VBY2NvdW50IgogICAgICAgIFNldC1BenVyZVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uSWQgJFN1YnNjcmlwdGlvbklkIC1DdXJyZW50U3RvcmFnZUFjY291bnROYW1lICRTdG9yYWdlQWNjb3VudAogICAgfQp9CgpmdW5jdGlvbiBTZXQtQ3VycmVudEF6dXJlUk1TdWJzY3JpcHRpb24gewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRTdWJzY3JpcHRpb25JZCwKICAgICAgICBbc3RyaW5nXSRUZW5hbnRJZCkKCiAgICAkYWRkaXRpb25hbCA9IEB7IH0KICAgIGlmICgkVGVuYW50SWQpIHsgJGFkZGl0aW9uYWxbJ1RlbmFudElkJ10gPSAkVGVuYW50SWQgfQogICAgV3JpdGUtSG9zdCAiIyNbY29tbWFuZF1TZWxlY3QtQXp1cmVSTVN1YnNjcmlwdGlvbiAtU3Vic2NyaXB0aW9uSWQgJFN1YnNjcmlwdGlvbklkICQoRm9ybWF0LVNwbGF0ICRhZGRpdGlvbmFsKSIKICAgICRudWxsID0gU2VsZWN0LUF6dXJlUk1TdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbklkICRTdWJzY3JpcHRpb25JZCBAYWRkaXRpb25hbAp9CgpmdW5jdGlvbiBTZXQtVXNlckFnZW50IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgpCgoJJHVzZXJBZ2VudCA9IEdldC1Wc3RzVGFza1ZhcmlhYmxlIC1OYW1lIEFaVVJFX0hUVFBfVVNFUl9BR0VOVAogICAgaWYgKCR1c2VyQWdlbnQpIHsKICAgICAgICBTZXQtVXNlckFnZW50X0NvcmUgLVVzZXJBZ2VudCAkdXNlckFnZW50CiAgICB9Cn0KCmZ1bmN0aW9uIFNldC1Vc2VyQWdlbnRfQ29yZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVXNlckFnZW50KQoKICAgIFRyYWNlLVZzdHNFbnRlcmluZ0ludm9jYXRpb24gJE15SW52b2NhdGlvbgogICAgdHJ5IHsKICAgICAgICBbTWljcm9zb2Z0LkF6dXJlLkNvbW1vbi5BdXRoZW50aWNhdGlvbi5BenVyZVNlc3Npb25dOjpDbGllbnRGYWN0b3J5LkFkZFVzZXJBZ2VudCgkVXNlckFnZW50KQogICAgfSBjYXRjaCB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0LVVzZXJBZ2VudCBmYWlsZWQgd2l0aCBleGNlcHRpb24gbWVzc2FnZTogJF8uRXhjZXB0aW9uLk1lc3NhZ2UiCiAgICB9IGZpbmFsbHkgewogICAgICAgIFRyYWNlLVZzdHNMZWF2aW5nSW52b2NhdGlvbiAkTXlJbnZvY2F0aW9uCiAgICB9Cn0=
