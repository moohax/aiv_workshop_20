ADOHelpers.psm1,2f31e0c82ffd9b70d3b1dda7765ac42e,Scan result is 1. IsMalware: 0,w6/Cu8K/U2V0LVN0cmljdE1vZGUgLVZlcnNpb24gTGF0ZXN0CgpJbXBvcnQtTW9kdWxlIChKb2luLVBhdGggJFBTU2NyaXB0Um9vdCBMb2dnZXIucHNtMSkKCmlmICggLW5vdCAoR2V0LVZhcmlhYmxlIGRiVHJhY2UgLVNjb3BlIGdsb2JhbCAtRXJyb3JBY3Rpb24gSWdub3JlKSApCnsKCSRnbG9iYWw6ZGJUcmFjZSA9ICRmYWxzZQp9Cgokc2NyaXB0OkFET1ByaW50SGFuZGxlckRlZmF1bHQgPSB7CiAgICBwYXJhbSgkbXNnKSAKICAgIFdyaXRlLUhvc3QgJG1zZwogICAgfQoKIyBuZWVkcyB0byBiZSBnbG9iYWwgc2luY2UgZXZlbnQgY2FuJ3QgZ2V0IGl0IGZyb20gJFNjcmlwdDoKJGdsb2JhbDpBRE9QcmludEhhbmRsZXIgPSAkc2NyaXB0OkFET1ByaW50SGFuZGxlckRlZmF1bHQgCgo8IwouU3lub3BzaXMKCVNldCB0aGUgaGFuZGxlciBmb3IgaGFuZGxpbmcgUFJJTlQgc3RhdG1lbnRzIGluIFNRTAoKLlBhcmFtZXRlciBzYgoJVGhlIHNjcmlwdCBibG9jayB0aGF0IHRha2VzIGEgJG1zZyBwYXJhbWV0ZXIKCi5PdXRwdXRzCglUaGUgY3VycmVudCBzY3JpcHQgYmxvY2ssIHNvIHlvdSBjYW4gcmVzdG9yZSBpdAojPgpmdW5jdGlvbiBTZXQtQURPUHJpbnRIYW5kbGVyCnsKW1BhcmFtZXRlcihNYW5kYXRvcnkpXQpwYXJhbSgKW3NjcmlwdGJsb2NrXSAkc2IgCikgCiAKCSRwcmV2ID0gJGdsb2JhbDpBRE9QcmludEhhbmRsZXI7IAoJJGdsb2JhbDpBRE9QcmludEhhbmRsZXIgPSAkc2I7IAoJJHByZXYgCn0KCmZ1bmN0aW9uIF93cml0ZVRyYWNlTWVzc2FnZSggJG1zZyApCnsKCWlmICggJGdsb2JhbDpkYlRyYWNlICkKCXsKCQlXcml0ZS1Ib3N0ICRtc2cgLUZvcmVncm91bmRDb2xvciBDeWFuICMgd3JpdGUtaG9zdCBvawoJfQp9Cgo8IwogZG8gdGhpcyB0byBnZXQgUHJpbnQgc3RhdGVtZW50cyBmcm9tIFNRTAojPgpmdW5jdGlvbiBfcmVnaXN0ZXJGb3JFdmVudCggJENvbm4gKQp7CglVbnJlZ2lzdGVyLUV2ZW50IC1Tb3VyY2VJZGVudGlmaWVyIEFET0hlbHBlci5HZXREYlJvd3MgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmUKCSMgdGhlcmUncyBhbHNvICRldmVudC5Tb3VyY2VFdmVudEFyZ3MuRXJyb3JzIHdoaWNoIGlzIGEgU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbEVycm9yQ29sbGVjdGlvbiBvZiBTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsRXJyb3IKCWlmICggJGdsb2JhbDpBRE9QcmludEhhbmRsZXIgKQoJewoJCSRudWxsID0gUmVnaXN0ZXItT2JqZWN0RXZlbnQgLUlucHV0T2JqZWN0ICRDb25uIC1FdmVudE5hbWUgSW5mb01lc3NhZ2UgLVNvdXJjZUlkZW50aWZpZXIgIkFET0hlbHBlci5HZXREYlJvd3MiIC1BY3Rpb24gewoJCQkgSW52b2tlLUNvbW1hbmQgLXNjcmlwdEJsb2NrICRnbG9iYWw6QURPUHJpbnRIYW5kbGVyIC1hcmcgJGV2ZW50LlNvdXJjZUV2ZW50QXJncy5NZXNzYWdlIH0KCX0KCWVsc2UgCgl7CgkJX3dyaXRlVHJhY2VNZXNzYWdlICJObyByZWdpc3RyYXRpb24gc2luY2UgbnVsbCBoYW5kbGVyIgoJfQp9Cgo8IwpoZWxwZXIgdG8gdW5yZWdpc3RlciBmcm9tIHRoZSBvdXRwdXQgZXZlbnRzCiM+CmZ1bmN0aW9uIF91bnJlZ2lzdGVyRXZlbnQoKQp7CglVbnJlZ2lzdGVyLUV2ZW50IC1Tb3VyY2VJZGVudGlmaWVyIEFET0hlbHBlci5HZXREYlJvd3MgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmUKfQoKPCMKLlN5bm9wc2lzCgloZWxwZXIgdG8gb3BlbiB0aGUgY29ubmVjdGlvbiwgZGF0YWJhc2UKCi5PdXRwdXRzCgljb25uZWN0aW9uLCBjb21tYW5kCiM+CmZ1bmN0aW9uIF9vcGVuQWxsKCAkZGJDb25uZWN0aW9uU3RyaW5nLCAkdGltZW91dCA9IDEyMDAgKQp7CglpZiAoICRkYkNvbm5lY3Rpb25TdHJpbmcgLWxpa2UgIiouc2RmIiApCgl7CgkJIyBTUUxTZXJ2ZXIgQ0UsIGxvYWQgdGhlIHR5cGUKCQlpZiAoIFRlc3QtUGF0aCAiSEtMTTpcU09GVFdBUkVcV293NjQzMk5vZGVcTWljcm9zb2Z0XE1pY3Jvc29mdCBTUUwgU2VydmVyIENvbXBhY3QgRWRpdGlvblx2My41IiApCgkJewkKCQkJJGRpciA9IChHZXQtSXRlbVByb3BlcnR5IC1wYXRoICJIS0xNOlxTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgQ29tcGFjdCBFZGl0aW9uXHYzLjUiIC1OYW1lIGluc3RhbGxkaXIpLmluc3RhbGxkaXIKCQkJQWRkLVR5cGUgLVBhdGggKEpvaW4tUGF0aCAkZGlyICJEZXNrdG9wXFN5c3RlbS5EYXRhLlNxbFNlcnZlckNlLmRsbCIpCgkJCQoJCQkkQ29ubiA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuU3FsU2VydmVyQ2UuU3FsQ2VDb25uZWN0aW9uKCRkYkNvbm5lY3Rpb25TdHJpbmcpCgkJCSRDbWQgPSBOZXctT2JqZWN0IFN5c3RlbS5EYXRhLlNxbFNlcnZlckNlLlNxbENlQ29tbWFuZAoJCQkkdGltZW91dCA9IDAKCQl9CgkJZWxzZQoJCXsKCQkJdGhyb3cgIlNRTFNlcnZlciBDRSAzLjUgZG9lcyBub3QgYXBwZWFyIHRvIGJlIGluc3RhbGxlZC4gIENhbid0IG9wZW4gc2RmIGZpbGUiCgkJfQoJfQoJZWxzZQoJewoJCSRDb25uID0gTmV3LU9iamVjdCBTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsQ29ubmVjdGlvbigkZGJDb25uZWN0aW9uU3RyaW5nKQoJCSRDbWQgPSBOZXctT2JqZWN0IFN5c3RlbS5EYXRhLlNxbENsaWVudC5TcWxDb21tYW5kCgl9CglfcmVnaXN0ZXJGb3JFdmVudCAkQ29ubgoJJENvbm4uT3BlbigpCgkkQ21kLkNvbm5lY3Rpb24gPSAkQ29ubgoJJENtZC5Db21tYW5kVGltZW91dCA9ICR0aW1lb3V0CgkKCWlmICggJGdsb2JhbDpkYlRyYWNlICkKCXsKCQkkQ21kLkNvbW1hbmRUZXh0ID0gJ3NlbGVjdCBAQFNQSUQnCgkJJHNwaWQgPSAkQ21kLkV4ZWN1dGVTY2FsYXIoKQoJCV93cml0ZVRyYWNlTWVzc2FnZSAiT3BlbmVkIGNtZCB3aXRoIHNwaWQgb2YgJHNwaWQiIAoJfQoJV3JpdGUtT3V0cHV0ICRDb25uCglXcml0ZS1PdXRwdXQgJENtZAp9Cgo8IwpoZWxwZXIgdG8gY2xvc2UgdGhlIGNvbm5lY3Rpb24sIGRhdGFiYXNlCiM+CmZ1bmN0aW9uIF9jbG9zZUFsbCggJENtZCwgJENvbm4gKQp7CgkkaGFkRXJyb3IgPSBbYm9vbF0kRXJyb3IKCglfdW5yZWdpc3RlckV2ZW50CgoJCglpZiAoICRnbG9iYWw6ZGJUcmFjZSApCgl7CgkJJENtZC5Db21tYW5kVGV4dCA9ICdzZWxlY3QgQEBTUElEJwoJCSRzcGlkID0gJENtZC5FeGVjdXRlU2NhbGFyKCkKCQlfd3JpdGVUcmFjZU1lc3NhZ2UgIkNsb3NpbmcgY21kIHdpdGggc3BpZCBvZiAkc3BpZCIgCgl9CglpZiAoICRDbWQgKQoJewoJCXRyeSB7ICRjbWQuRGlzcG9zZSgpIH0gCgkJY2F0Y2ggCgkJewoJCQlXcml0ZS1Mb2dNZXNzYWdlIFdhcm5pbmcgIkVycm9yIGNsb3NpbmcgY21kICRfIgoJCX0KCX0KCWlmICggJENvbm4gICkKCXsKCQl0cnkKCQl7CgkJCXRyeQoJCQl7CgkJCQkkQ29ubi5DaGFuZ2VEYXRhYmFzZSgnbWFzdGVyJykgIyBzb21ldGltZXMgY29ubiBrZXB0IGFsaXZlLCB0aGlzIGF0IGxlYXN0IHN3aXRjaGVkIG9mZiBhbm90aGVyIGRiCgkJCX0KCQkJY2F0Y2ggCgkJCXsKCQkJCVdyaXRlLUxvZ01lc3NhZ2UgRXJyb3IgIkVycm9yIHRyeWluZyB0byByZS11c2UgY29ubmVjdGlvbjpgbiRfIgoJCQl9CgkJCQoJCQlpZiAoICRnbG9iYWw6ZGJUcmFjZSApCgkJCXsKCQkJCV93cml0ZVRyYWNlTWVzc2FnZSAiQ2xvc2luZyBjb25uIiAKCQkJfQoJCQkkQ29ubi5DbG9zZSgpCgkJCWlmICggJGdsb2JhbDpkYlRyYWNlICkKCQkJewoJCQkJX3dyaXRlVHJhY2VNZXNzYWdlICJDb25uJ3Mgc3RhdGUgaXMgbm93ICQoJENvbm4uU3RhdGUpIiAKCQkJfQoJCQkkQ29ubi5EaXNwb3NlKCkKCQl9CgkJY2F0Y2ggCgkJewoJCQlXcml0ZS1Mb2dNZXNzYWdlIFdhcm5pbmcgIkVycm9yIGNsb3NpbmcgY29ubiAkXyIKCQl9Cgl9CgkKCWlmICggLW5vdCAkaGFkRXJyb3IgLWFuZCAkRXJyb3IgKQoJewoJCSRFcnJvci5DbGVhcigpICMgZG9uJ3QgbGV0IHRoaXMgc3RvcCBkZXBsb3kKCX0KCn0KCmZ1bmN0aW9uIF9zZXRQYXJhbWV0ZXJzKCAkcGFyYW1ldGVycywgJENtZCApCnsKCSRDbWQuUGFyYW1ldGVycy5DbGVhcigpCglpZiAoICRwYXJhbWV0ZXJzICkKCXsKCQlmb3JlYWNoICggJHAgaW4gJHBhcmFtZXRlcnMuS2V5cyApCgkJewoJCQkka2V5ID0gJHAKCQkJaWYgKCAkcCAtbm90bGlrZSAiQCoiICkKCQkJewoJCQkJJGtleSA9ICJAJHAiCgkJCX0KCQkJX3dyaXRlVHJhY2VNZXNzYWdlICJBZGRpbmcgcGFyYW1ldGVyICRrZXkgPSAkKCRwYXJhbWV0ZXJzWyRwXSkiCgkJCSRudWxsID0gJENtZC5QYXJhbWV0ZXJzLkFkZFdpdGhWYWx1ZSgkcCwkcGFyYW1ldGVyc1skcF0pCgkJfQoJfQp9CgpmdW5jdGlvbiBfZm9ybWF0RXhjZXB0aW9uTWVzc2FnZSggJHNlcnZlck5hbWUsICRzcWwsICR0aGVFcnJvciApCnsKCSRtc2cgPSAiRXJyb3IgZXhlY3V0aW5nIFNRTCBvbiAkc2VydmVyTmFtZSIKCglpZiAoICR0aGVFcnJvci5FeGNlcHRpb24gLWFuZCAkdGhlRXJyb3IuRXhjZXB0aW9uLklubmVyRXhjZXB0aW9uIC1hbmQgJHRoZUVycm9yLkV4Y2VwdGlvbi5Jbm5lckV4Y2VwdGlvbiAtaXMgW1N5c3RlbS5EYXRhLlNxbENsaWVudC5TcWxFeGNlcHRpb25dKQoJewoJCSRlID0gJHRoZUVycm9yLkV4Y2VwdGlvbi5Jbm5lckV4Y2VwdGlvbgoJCWlmICggJGUuUHJvY2VkdXJlICkKCQl7CgkJCSRtc2cgKz0gKCJgbk1zZyB7MH0sIExldmVsIHsxfSwgU3RhdGUgezJ9LCBQcm9jZWR1cmUgezN9LCBMaW5lIHs0fWBuIiAtZiAkZS5OdW1iZXIsICRlLkNsYXNzLCAkZS5TdGF0ZSwgJGUuUHJvY2VkdXJlLCAkZS5MaW5lTnVtYmVyKQoJCX0KCQllbHNlIAoJCXsKCQkJJG1zZyArPSAoImBuTXNnIHswfSwgTGV2ZWwgezF9LCBTdGF0ZSB7Mn0sIExpbmUgezN9YG4iIC1mICRlLk51bWJlciwgJGUuQ2xhc3MsICRlLlN0YXRlLCAkZS5MaW5lTnVtYmVyKQoJCX0KCQkKCQkkbXNnICs9ICIkKCR0aGVFcnJvci5FeGNlcHRpb24uSW5uZXJFeGNlcHRpb24uTWVzc2FnZSlgbiQoJHRoZUVycm9yLlNjcmlwdFN0YWNrVHJhY2UpIiAgCgl9CgllbHNlCgl7CgkJJG1zZyArPSAiYG4iKyR0aGVFcnJvci5Ub1N0cmluZygpKyJgbiIrJHRoZUVycm9yLlNjcmlwdFN0YWNrVHJhY2UuVG9TdHJpbmcoKQoJfQoJJG1zZyArPSAiYG4kc3FsIgoKCSRtc2cKfQoKZnVuY3Rpb24gX3J1blNxbAp7CltDbWRsZXRCaW5kaW5nKFN1cHBvcnRzU2hvdWxkUHJvY2VzcyldCnBhcmFtCiggJHRtcFNxbCwgJGNtZCwgJGRiQ29ubm5lY3Rpb25TdHJpbmcsICRzY2FsYXIsICRxdWVyaWVzLCAkd2FudENvdW50LCAkZG9udFRocm93ICkKCglJZigkdG1wU3FsIC1hbmQgJHRtcFNxbC5UcmltKCkpIAoJeyAKCQlpZiAoICRQU0NtZGxldC5TaG91bGRQcm9jZXNzKCRkYkNvbm5lY3Rpb25TdHJpbmcsICR0bXBTcWwuVHJpbSgpICkgKQoJCXsKCQkJdHJ5IAoJCQl7CgkJCQkkQ21kLkNvbW1hbmRUZXh0ID0gJHRtcFNxbAoJCQkJX3NldFBhcmFtZXRlcnMgJHBhcmFtZXRlcnMgJENtZAoJCQkJX3dyaXRlVHJhY2VNZXNzYWdlICJleGVjdXRpbmc6ICR0bXBTcWwiCgkJCQkJCQoJCQkJaWYgKCAkc2NhbGFyICkKCQkJCXsKCQkJCQkkcmV0ID0gJENtZC5FeGVjdXRlU2NhbGFyKCkKCQkJCQlfd3JpdGVUcmFjZU1lc3NhZ2UgIlNjYWxhciByZXR1cm4gaXMgJHJldCIKCQkJCQkkcmV0IAoJCQkJfQoJCQkJZWxzZWlmICggJHF1ZXJpZXMgKQoJCQkJewoJCQkJCSRyZXQgPSAkQ21kLkV4ZWN1dGVSZWFkZXIoKQoJCQkJCXdoaWxlICggJHJldC5SZWFkKCkgKQoJCQkJCXsKCQkJCQkJSW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrICRmbiAtQXJndW1lbnRMaXN0ICRyZXQgCgkJCQkJfQoJCQkJCXdoaWxlICggJHJldC5OZXh0UmVzdWx0KCkgKQoJCQkJCXsKCQkJCQkJd2hpbGUgKCAkcmV0LlJlYWQoKSApCgkJCQkJCXsKCQkJCQkJCUludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkZm4gLUFyZ3VtZW50TGlzdCAkcmV0IAoJCQkJCQl9CgkJCQkJfQoJCQkJCSRyZXQuQ2xvc2UoKQoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCSRyZXQgPSAkQ21kLkV4ZWN1dGVOb25RdWVyeSgpCgkJCQkJaWYgKCAkd2FudENvdW50ICkKCQkJCQl7CgkJCQkJCV93cml0ZVRyYWNlTWVzc2FnZSAiV2FudCBjb3VudCByZXR1cm4gaXMgJHJldCIKCQkJCQkJJHJldAoJCQkJCX0KCQkJCX0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaAogICAgICAgICAgICB7CgkJCQlpZiAoICRkb250VGhyb3cgKQoJCQkJewoJCQkJCVdyaXRlLUxvZ01lc3NhZ2UgV2FybmluZyAiRXhjZXB0aW9uIHJ1bm5pbmcgU1FMOiAkdG1wU3FsYG4kXyIKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQl0aHJvdyAiRXhjZXB0aW9uIHJ1bm5pbmcgU1FMOiAkdG1wU3FsYG4kXyIKCQkJCX0KICAgICAgICAgICAgfQoJCX0KCX0KfQoKZnVuY3Rpb24gX2ludm9rZVNxbAp7CltDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSJTZXJ2ZXIiLFN1cHBvcnRzU2hvdWxkUHJvY2VzcyldCnBhcmFtKApbc3RyaW5nXSRzZXJ2ZXIsCltzdHJpbmddICRkYk5hbWUsCltzdHJpbmddJGRiQ29ubmVjdGlvblN0cmluZywKJENvbm4sCiRjbWQsCltQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXQpbU3RyaW5nXSAkY29tbWFuZCwKW2hhc2h0YWJsZV0gJHBhcmFtZXRlcnMsCltWYWxpZGF0ZVJhbmdlKDEsMTAwMDAwKV0KW2ludF0gJHRpbWVvdXRTZWNzID0gMTIwMCwKW3N3aXRjaF0gJHF1ZXJpZXMsCltzY3JpcHRibG9ja10gJGZuLApbc3dpdGNoXSAkc2NhbGFyLApbc3dpdGNoXSAkd2FudENvdW50LApbc3dpdGNoXSAkZG9udFRocm93CikKCgliZWdpbgoJewoJCSRvcGVuZWRDb25uID0gLW5vdCAkY29ubiAtYW5kIC1ub3QgJGNtZAoJCWlmICggJG9wZW5lZENvbm4gKQoJCXsKCQkJaWYgKCAkc2VydmVyIC1hbmQgJGRiTmFtZSApCgkJCXsKCQkJCSRkYkNvbm5lY3Rpb25TdHJpbmcgPSAiU2VydmVyPSRzZXJ2ZXI7SW5pdGlhbCBDYXRhbG9nPSRkYk5hbWU7SW50ZWdyYXRlZCBTZWN1cml0eT1UcnVlO011bHRpcGxlQWN0aXZlUmVzdWx0U2V0cz1UcnVlIgoJCQl9CgkJCWVsc2VpZiAoIC1ub3QgJGRiQ29ubmVjdGlvblN0cmluZyApCgkJCXsKCQkJCXRocm93ICJJbnZhbGlkIHBhcmFtZXRlcnMuICBNdXN0IHN1cHBseSBjb25uZWN0aW9uLCBkYXRhYmFzZSwgb3IgY29ubmVjdGlvbiBzdHJpbmciCgkJCX0KCgoJCQkjU2V0dGluZyBVcCBTcWwgQ29ubmVjdGlvbi9Db21tYW5kIG9iamVjdHMgJiBvcGVuaW5nIHRoZSBjb25uZWN0aW9uCgkJCSRDb25uLCAkQ21kID0gX29wZW5BbGwgJGRiQ29ubmVjdGlvblN0cmluZyAtdGltZW91dFNlY3MgJHRpbWVvdXRTZWNzCgkJfQoKCQkkdG1wU3FsID0gJG51bGwKCX0KCQoJcHJvY2VzcwoJewoJCXRyeQoJCXsKCQkJaWYgKCAkUFNDbWRsZXQuU2hvdWxkUHJvY2Vzcygkc2VydmVyLCJFeGVjdXRlIFNRTCIpKQoJCQl7CgkJCQkkcyA9ICRjb21tYW5kCgkJCQlJZigkcy50cmltKCkgLWxpa2UgImdvKiIpCgkJCQl7CgkJCQkJX3J1blNxbCAkdG1wU3FsICRjbWQgJGRiQ29ubmVjdGlvblN0cmluZyAkc2NhbGFyICRxdWVyaWVzICR3YW50Q291bnQgJGRvbnRUaHJvdwoJCQkJCSR0bXBTcWwgPSAiIgoJCQkJfQoJCQkJRWxzZQoJCQkJewoJCQkJCSR0bXBTcWwgKz0gW1N5c3RlbS5FbnZpcm9ubWVudF06Ok5ld0xpbmUKCQkJCQkkdG1wU3FsICs9ICRzCgkJCQl9CgkJCX0KCQl9CgkJY2F0Y2ggCgkJewoJCQlpZiAoICRvcGVuZWRDb25uICkKCQkJewoJCQkJX2Nsb3NlQWxsICRDbWQgJENvbm4KCQkJCSRDbWQgPSAkbnVsbAoJCQkJJENvbm4gPSAkbnVsbAoJCQl9CgkJCSR0aGVFcnJvciA9ICRfCgkJCXRocm93IChfZm9ybWF0RXhjZXB0aW9uTWVzc2FnZSAkZGJDb25uZWN0aW9uU3RyaW5nICR0bXBTcWwgJHRoZUVycm9yKQoJCX0KCX0KCQoJZW5kCgl7CgkJV3JpdGUtTG9nTWVzc2FnZSBWZXJib3NlICJJbiBlbmQiCgkJaWYoJHRtcFNxbCkKCQl7CgkJCV9ydW5TcWwgJHRtcFNxbCAkY21kICRkYkNvbm5lY3Rpb25TdHJpbmcgJHNjYWxhciAkcXVlcmllcyAkd2FudENvdW50ICRkb250VGhyb3cKCQl9CgkJaWYgKCAkb3BlbmVkQ29ubiAtYW5kICRjbWQgKQoJCXsKCQkJX2Nsb3NlQWxsICRDbWQgJENvbm4KCQl9Cgl9Cn0KCgo8IwouU3lub3BzaXMKCUV4ZWN1dGUgYSBzY2FsYXIgcXVlcnkgb24gdGhlIGRhdGFiYXNlCgouUGFyYW1ldGVyIHNlcnZlcgoJU1FMIFNlcnZlcgoKLlBhcmFtZXRlciBkYk5hbWUKCWRhdGFiYXNlIG5hbWUKCi5QYXJhbWV0ZXIgZGJDb25uZWN0aW9uU3RyaW5nCgl0aGUgY29ubmVjdGlvbiBzdHJpbmcKCi5QYXJhbWV0ZXIgY29tbWFuZAoJdGhlIGNvbW1hbmQgdG8gcnVuIAoJCi5QYXJhbWV0ZXIgdGltZW91dFNlY3MKCXRpbWVvdXQgZm9yIGNvbm5lY3Rpb24gaW4gc2Vjb25kcywgZGVmYXVsdHMgdG8gMTIwICgyIG1pbnV0ZXMpCgkKLk91dHB1dHMKCXRoZSBzY2FsYXIgdmFsdWUKIz4KRnVuY3Rpb24gSW52b2tlLURiU2NhbGFyCnsKW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWU9IlNlcnZlciIsU3VwcG9ydHNTaG91bGRQcm9jZXNzKV0KcGFyYW0oCltQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iU2VydmVyIildCltzdHJpbmddJHNlcnZlciwKW1BhcmFtZXRlcihQb3NpdGlvbj0xLE1hbmRhdG9yeSxQYXJhbWV0ZXJTZXROYW1lPSJTZXJ2ZXIiKV0KW3N0cmluZ10gJGRiTmFtZSwKW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeSxQYXJhbWV0ZXJTZXROYW1lPSJDb25uU3RyIildCltzdHJpbmddJGRiQ29ubmVjdGlvblN0cmluZywKW1BhcmFtZXRlcihQb3NpdGlvbj0xLE1hbmRhdG9yeSxQYXJhbWV0ZXJTZXROYW1lPSJDb25uU3RyIildCltQYXJhbWV0ZXIoUG9zaXRpb249MixNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iU2VydmVyIildCltzdHJpbmddICRjb21tYW5kLApbaGFzaHRhYmxlXSAkcGFyYW1ldGVycywKW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMDApXQpbaW50XSAkdGltZW91dFNlY3MgPSAxMjAwCikKCUludm9rZS1EYk5vblF1ZXJ5IEBQU0JvdW5kUGFyYW1ldGVycyAtc2NhbGFyIAp9Cgo8IwouU3lub3BzaXMKCUV4ZWN1dGUgb25lIG9yIG1vcmUgbm9uIHF1ZXJpZXMgb24gdGhlIGRhdGFiYXNlCgouUGFyYW1ldGVyIHNlcnZlcgoJU1FMIFNlcnZlcgoKLlBhcmFtZXRlciBkYk5hbWUKCWRhdGFiYXNlIG5hbWUKCi5QYXJhbWV0ZXIgZGJDb25uZWN0aW9uU3RyaW5nCgl0aGUgY29ubmVjdGlvbiBzdHJpbmcKCi5QYXJhbWV0ZXIgY29tbWFuZHMKCXN0cmluZ3MgdGhhdCBtYWtlIHVwIHRoZSBjb21tYW5kcywgc2VwYXJhdGUgbXVsdGlwbGUgY29tbWFuZHMgd2l0aCBhIGxpbmUgc3RhcnRpbmcgd2l0aCBHTywgY2FuIHBpcGUgYSBmaWxlIGluCgkKLlBhcmFtZXRlciBwYXJhbWV0ZXJzCglvcHRpb25hbCBoYXNoIHRhYmxlIG9mIHN1YnN0aXR1dGlvbiB2YWx1ZXMuICBJZiBuYW1lIG5vdCBwcmVmaXhlZCB3aXRoIEAsIHdpbGwgYWRkIGl0CgouUGFyYW1ldGVyIHRpbWVvdXRTZWNzCgl0aW1lb3V0IGZvciBjb25uZWN0aW9uIGluIHNlY29uZHMsIGRlZmF1bHRzIHRvIDEyMCAoMiBtaW51dGVzKQoJCiM+CmZ1bmN0aW9uIEludm9rZS1EYk5vblF1ZXJ5CnsKW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWU9IlNlcnZlciIsU3VwcG9ydHNTaG91bGRQcm9jZXNzKV0KcGFyYW0oCltQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iU2VydmVyIildCltzdHJpbmddJHNlcnZlciwKW1BhcmFtZXRlcihQb3NpdGlvbj0xLE1hbmRhdG9yeSxQYXJhbWV0ZXJTZXROYW1lPSJTZXJ2ZXIiKV0KW3N0cmluZ10gJGRiTmFtZSwKW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeSxQYXJhbWV0ZXJTZXROYW1lPSJDb25uU3RyIildCltzdHJpbmddJGRiQ29ubmVjdGlvblN0cmluZywKW1BhcmFtZXRlcihQb3NpdGlvbj0yLFZhbHVlRnJvbVBpcGVsaW5lKV0KW0FsaWFzKCJjb21tYW5kcyIpXQpbU3RyaW5nXSAkY29tbWFuZCwKW2hhc2h0YWJsZV0gJHBhcmFtZXRlcnMsCltzd2l0Y2hdICRzY2FsYXIsCltWYWxpZGF0ZVJhbmdlKDEsMTAwMDAwKV0KW2ludF0gJHRpbWVvdXRTZWNzID0gMTIwMCwKW3N3aXRjaF0gJHdhbnRDb3VudCwKW3N3aXRjaF0gJGRvbnRUaHJvdwopCgkKCmJlZ2luCnsKCSMgZ2V0IHBpcGVsaW5lIHNvIHdlIGNhc2NhZGUgaXQgZnJvbSB0aGlzIHNjcmlwdAogICAgJG91dEJ1ZmZlciA9ICRudWxsCiAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzLlRyeUdldFZhbHVlKMOi4oKsy5xPdXRCdWZmZXLDouKCrOKEoiwgW3JlZl0kb3V0QnVmZmVyKSkKICAgIHsKICAgICAgICAkUFNCb3VuZFBhcmFtZXRlcnNbw6LigqzLnE91dEJ1ZmZlcsOi4oKs4oSiXSA9IDEKICAgIH0KICAgICR3cmFwcGVkQ21kID0gR2V0LWNvbW1hbmQgIl9pbnZva2VTcWwiIAogICAgJHNiID0geyYgJHdyYXBwZWRDbWQgQFBTQm91bmRQYXJhbWV0ZXJzIH0gCgogICAgJHNwID0gJHNiLkdldFN0ZXBwYWJsZVBpcGVsaW5lKCRteUludm9jYXRpb24uQ29tbWFuZE9yaWdpbikKCSRjb3VudCA9IDAKCSRzcC5CZWdpbigkUFNDbWRMZXQpCn0KCnByb2Nlc3MKewoJJHNwLlByb2Nlc3MoJF8pCn0KCmVuZAp7Cgkkc3AuRW5kKCkKfQoKfQoKPCMKLlN5bm9wc2lzCglFeGVjdXRlIGEgcXVlcnkgb24gdGhlIGRhdGFiYXNlLCBjYWxsaW5nIHRoZSBzY3JpcHRibG9jayBmb3IgZWFjaCByb3cKCi5QYXJhbWV0ZXIgc2VydmVyCglTUUwgU2VydmVyCgouUGFyYW1ldGVyIGRiTmFtZQoJZGF0YWJhc2UgbmFtZQoKLlBhcmFtZXRlciBkYkNvbm5lY3Rpb25TdHJpbmcKCXRoZSBjb25uZWN0aW9uIHN0cmluZwoKLlBhcmFtZXRlciBmbgoJYSBzY3JpcHQgYmxvY2sgdG8gcHJvY2VzcyB0aGUgcm93cy4gIFNlZSB0aGUgZXhhbXBsZSBmb3IgZGV0YWlscwoKLlBhcmFtZXRlciBxdWVyeQoJcXVlcnkgdG8gcnVuCgkKLlBhcmFtZXRlciBwYXJhbWV0ZXJzCglvcHRpb25hbCBoYXNoIHRhYmxlIG9mIHN1YnN0aXR1dGlvbiB2YWx1ZXMuICBJZiBuYW1lIG5vdCBwcmVmaXhlZCB3aXRoIEAsIHdpbGwgYWRkIGl0CgkKLk91dHB1dHMgCglOb25lCgouRXhhbXBsZQoJUnVuIGEgcXVlcnkgYW5kIGFkZCBlYWNoIGZpcnN0IGNvbHVtbiB0byBhbiBhcnJheQoJCglAc2NyaXB0OnVpU2l0ZXMgPSBAKCkgCglHZXQtRGJSb3cgJGNvbm5TdHIgeyBwYXJhbShbU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbERhdGFSZWFkZXJdJHJlYWRlcikgJFNjcmlwdDp1aVNpdGVzICs9ICwkcmVhZGVyWzBdIH0gJHVpU2l0ZVNxbCAKCi5FeGFtcGxlCgoJUnVuIGEgcXVlcnkgYW5kIGFkZCBlYWNoIGZpcnN0IGNvbHVtbiB0byBhbiBhcnJheQoJCglAc2NyaXB0OnVpU2l0ZXMgPSBAKCkgCglFeGVjdXRlUXVlcnkgJHNlcnZlciBteWRhdGFiYXNlbmFtZSB7IHBhcmFtKFtTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsRGF0YVJlYWRlcl0kcmVhZGVyKSAkU2NyaXB0OnVpU2l0ZXMgKz0gLCRyZWFkZXJbMF0gfSAkdWlTaXRlU3FsCiM+CkZ1bmN0aW9uIEdldC1EYlJvdwp7CltDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSJTZXJ2ZXIiLFN1cHBvcnRzU2hvdWxkUHJvY2VzcyldCnBhcmFtKApbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5LFBhcmFtZXRlclNldE5hbWU9IlNlcnZlciIpXQpbc3RyaW5nXSRzZXJ2ZXIsCltQYXJhbWV0ZXIoUG9zaXRpb249MSxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iU2VydmVyIildCltzdHJpbmddICRkYk5hbWUsCltQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iQ29ublN0ciIpXQpbc3RyaW5nXSRkYkNvbm5lY3Rpb25TdHJpbmcsCltQYXJhbWV0ZXIoUG9zaXRpb249MixNYW5kYXRvcnkpXQpbc2NyaXB0YmxvY2tdJGZuLApbUGFyYW1ldGVyKFBvc2l0aW9uPTMsTWFuZGF0b3J5KV0KW3N0cmluZ10gJHF1ZXJ5LApbaGFzaHRhYmxlXSAkcGFyYW1ldGVycywKW1ZhbGlkYXRlUmFuZ2UoMSwxMDAwMDApXQpbaW50XSAkdGltZW91dFNlY3MgPSAxMjAwCikKCglfaW52b2tlU3FsIC1zZXJ2ZXIgJHNlcnZlciAtZGJOYW1lICRkYk5hbWUgLWRiQ29ubmVjdGlvblN0cmluZyAkZGJDb25uZWN0aW9uU3RyaW5nIC1jb21tYW5kICRxdWVyeSAtdGltZW91dFNlY3MgJHRpbWVvdXRTZWNzIC1xdWVyaWVzIC1mbiAkZm4gLXBhcmFtZXRlcnMgJHBhcmFtZXRlcnMKfQoKPCMKLlN5bm9wc2lzCglSZXR1cm5zIG9iamVjdHMgd2l0aCBwcm9wZXJ0aWVzIG5hbWVkIGZvciBjb2x1bW5zIGluIHF1ZXJ5CgouUGFyYW1ldGVyIHNlcnZlcgoJU1FMIFNlcnZlcgoKLlBhcmFtZXRlciBkYk5hbWUKCWRhdGFiYXNlIG5hbWUKCi5QYXJhbWV0ZXIgZGJDb25uZWN0aW9uU3RyaW5nCgl0aGUgY29ubmVjdGlvbiBzdHJpbmcKCi5QYXJhbWV0ZXIgcXVlcnkKCXF1ZXJ5IHRvIHJ1bgoKLlBhcmFtZXRlciBwYXJhbWV0ZXJzCglvcHRpb25hbCBoYXNoIHRhYmxlIG9mIHN1YnN0aXR1dGlvbiB2YWx1ZXMuICBJZiBuYW1lIG5vdCBwcmVmaXhlZCB3aXRoIEAsIHdpbGwgYWRkIGl0CgkKLlBhcmFtZXRlciB0aW1lb3V0U2VjcwoJdGltZW91dCBmb3IgY29ubmVjdGlvbiBpbiBzZWNvbmRzLCBkZWZhdWx0cyB0byAxMjAgKDIgbWludXRlcykKCQouT3V0cHV0cwoJb2JqZWN0cyBmb3IgZWFjaCByb3cKCi5FeGFtcGxlCglQUyBDOlxkXHRlbXA+IEV4ZWN1dGVPYmplY3RRdWVyeUNvbm5TdHIgIkRhdGEgU291cmNlPWM6XGRcdGVtcFxTYmMuQ2xpZW50LkFzc2VtYmx5LkRldlRydW5rLkRldi50aGVtZXMuc2RmIiAic2VsZWN0IGEubmFtZSwgdC5uYW1lIGFzIFRZUEUsIGNhc3QoYS52ZXJzaW9uX21ham9yIGFzIG52YXJjaGFyKDMwKSkrJy4nK2Nhc3QoYS52ZXJzaW9uX21pbm9yIGFzIG52YXJjaGFyKDMwKSkgYXMgVkVSU0lPTiBmcm9tIGFydGlmYWN0IGEgam9pbiBhcnRpZmFjdF90eXBlIHQgb24gYS5hcnRpZmFjdF90eXBlX2lkID0gdC5hcnRpZmFjdF90eXBlX2lkIiB8IGZ0IC1hCgoJR2V0IHRoZSBhcnRpZmFjdCBhbmQgdHlwZXMgZnJvbSBhIFNRTFNlcnZlciBDRSBmaWxlCiM+CkZ1bmN0aW9uIEdldC1EYk9iamVjdAp7CltDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lPSJTZXJ2ZXIiLFN1cHBvcnRzU2hvdWxkUHJvY2VzcyldCnBhcmFtKApbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5LFBhcmFtZXRlclNldE5hbWU9IlNlcnZlciIpXQpbc3RyaW5nXSRzZXJ2ZXIsCltQYXJhbWV0ZXIoUG9zaXRpb249MSxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iU2VydmVyIildCltzdHJpbmddICRkYk5hbWUsCltQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iQ29ublN0ciIpXQpbc3RyaW5nXSRkYkNvbm5lY3Rpb25TdHJpbmcsCltQYXJhbWV0ZXIoUG9zaXRpb249MSxNYW5kYXRvcnksUGFyYW1ldGVyU2V0TmFtZT0iQ29ublN0ciIpXQpbUGFyYW1ldGVyKFBvc2l0aW9uPTIsTWFuZGF0b3J5LFBhcmFtZXRlclNldE5hbWU9IlNlcnZlciIpXQpbc3RyaW5nXSRxdWVyeSwKW2hhc2h0YWJsZV0gJHBhcmFtZXRlcnMsCltWYWxpZGF0ZVJhbmdlKDEsMTAwMDAwKV0KW2ludF0gJHRpbWVvdXRTZWNzID0gMTIwMAopCgkKCSRzY3JpcHQ6Y291bnQgPSAwCgkKCWZ1bmN0aW9uIG1ha2VOYW1lKFtzdHJpbmddICRjb2xOYW1lKQoJewoJCSMgY2hhbmdlIG5vbi13b3JkIHZhbHVlcyB0byBfCgkJaWYgKCAkY29sTmFtZSApCgkJewoJCQlyZXR1cm4gKCRjb2xOYW1lIC1yZXBsYWNlICJcVysiLCAiXyIpCgkJfQoJCWVsc2UKCQl7CgkJCSRzY3JpcHQ6Y291bnQrKwoJCQlyZXR1cm4gIk5vQ29sTmFtZSRzY3JpcHQ6Y291bnQiCgkJfQoJfQoJCgkkc2NyaXB0OnJlc3VsdCA9IEAoKQoJX2ludm9rZVNxbCAtc2VydmVyICRzZXJ2ZXIgLWRiTmFtZSAkZGJOYW1lIC1kYkNvbm5lY3Rpb25TdHJpbmcgJGRiQ29ubmVjdGlvblN0cmluZyAtY29tbWFuZCAkcXVlcnkgLXRpbWVvdXRTZWNzICR0aW1lb3V0U2VjcyAtcXVlcmllcyAtcGFyYW1ldGVycyAkcGFyYW1ldGVycyAtZm4geyAgcGFyYW0oW1N5c3RlbS5EYXRhLkNvbW1vbi5EYkRhdGFSZWFkZXJdJHJlYWRlcikKCQkJCSRjb2xzID0gQHt9CgkJCQlmb3IgKCAkaSA9IDA7ICRpIC1sdCAkcmVhZGVyLkZpZWxkQ291bnQ7ICRpKysgKQoJCQkJewoJCQkJCSRjb2xzWyhtYWtlTmFtZSgkcmVhZGVyLkdldE5hbWUoJGkpKSldID0gJHJlYWRlclskaV0KCQkJCX0KCQkJCSRzY3JpcHQ6cmVzdWx0ICs9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5ICRjb2xzCgkJCX0gCglyZXR1cm4gJHNjcmlwdDpyZXN1bHQJCQkKfQoKPCMKLlN5bm9wc2lzCglEb2VzIHRoZSBkYXRhYmFzZSBleGlzdHMKCi5QYXJhbWV0ZXIgc2VydmVyCglTUUwgU2VydmVyCgouUGFyYW1ldGVyIGRiTmFtZQoJZGF0YWJhc2UgbmFtZQoKLk91dHB1dHMKCXRydWUgaWYgaXQgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIKIz4KRnVuY3Rpb24gVGVzdC1EYXRhYmFzZQp7CglwYXJhbSgKCVtQYXJhbWV0ZXIoUG9zaXRpb249MCwgTWFuZGF0b3J5KV0KCVtzdHJpbmddJHNlcnZlciwKCVtQYXJhbWV0ZXIoUG9zaXRpb249MSwgTWFuZGF0b3J5KV0KCVtzdHJpbmddICRkYk5hbWUKCSkKCQoJcmV0dXJuICQoSW52b2tlLURiU2NhbGFyICRzZXJ2ZXIgIm1hc3RlciIgIlNFTEVDVCAgMSBGUk9NICAgIHN5cy5kYXRhYmFzZXMgV0hFUkUgICBuYW1lID0gJyRkYk5hbWUnICIgKSAtZXEgMQp9Cgo8IwouU3lub3BzaXMKCURvZXMgdGhlIGRhdGFiYXNlIGV4aXN0cyBhbmQgaXMgb25saW5lCgouUGFyYW1ldGVyIHNlcnZlcgoJU1FMIFNlcnZlcgoKLlBhcmFtZXRlciBkYk5hbWUKCWRhdGFiYXNlIG5hbWUKCi5PdXRwdXRzCgl0cnVlIGlmIGl0IGV4aXN0cyBvbiB0aGUgc2VydmVyCiM+CkZ1bmN0aW9uIFRlc3QtRGF0YWJhc2VPbmxpbmUKewoJcGFyYW0oCglbUGFyYW1ldGVyKFBvc2l0aW9uPTAsIE1hbmRhdG9yeSldCglbc3RyaW5nXSRzZXJ2ZXIsCglbUGFyYW1ldGVyKFBvc2l0aW9uPTEsIE1hbmRhdG9yeSldCglbc3RyaW5nXSAkZGJOYW1lCgkpCgkKCXJldHVybiAkKEludm9rZS1EYlNjYWxhciAkc2VydmVyICJtYXN0ZXIiICJTRUxFQ1QgIDEgRlJPTSAgICBzeXMuZGF0YWJhc2VzIFdIRVJFICAgbmFtZSA9ICckZGJOYW1lJyBhbmQgc3RhdGUgPSAwICIgKSAtZXEgMQp9CgojIG9sZCBuYW1lcyBub3cgYWxpYXMgdG8gbW9yZSBQU2hlbGx5IG5hbWVzClNldC1BbGlhcyBHZXQtRGJPYmplY3RzIEdldC1EYk9iamVjdCAKU2V0LUFsaWFzIEdldC1EYXRhYmFzZUV4aXN0cyBUZXN0LURhdGFiYXNlIApTZXQtQWxpYXMgRXhlY3V0ZU5vblF1ZXJpZXMgSW52b2tlLURiTm9uUXVlcmllcwpTZXQtQWxpYXMgRXhlY3V0ZVF1ZXJ5IEdldC1EYlJvdwpTZXQtQWxpYXMgRXhlY3V0ZU9iamVjdFF1ZXJ5IEdldC1EYk9iamVjdApTZXQtQWxpYXMgRXhlY3V0ZU5vblF1ZXJ5IEludm9rZS1EYk5vblF1ZXJ5ClNldC1BbGlhcyBFeGVjdXRlU2NhbGFyIEludm9rZS1EYlNjYWxhcgpTZXQtQWxpYXMgSW52b2tlLURiTm9uUXVlcmllcyBJbnZva2UtRGJOb25RdWVyeQoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gJ0V4ZWN1dGUqJywnKi0qJyAtQWxpYXMgKiAtVmFyaWFibGUgJ0FET1ByaW50SGFuZGxlcion
