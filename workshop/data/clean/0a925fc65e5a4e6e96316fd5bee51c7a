Deploy-AzureResourceGroup.ps1,b68a6c33f87e3ee80387bc40859fc683,Scan result is 1. IsMalware: 0,I1JlcXVpcmVzIC1WZXJzaW9uIDMuMAojUmVxdWlyZXMgLU1vZHVsZSBBenVyZVJNLlJlc291cmNlcwojUmVxdWlyZXMgLU1vZHVsZSBBenVyZS5TdG9yYWdlCgpQYXJhbSgKICAgIFtzdHJpbmddIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0gJFJlc291cmNlR3JvdXBMb2NhdGlvbiwKICAgIFtzdHJpbmddICRSZXNvdXJjZUdyb3VwTmFtZSA9ICcxMDAtYmFzaWN2bScsCiAgICBbc3dpdGNoXSAkVXBsb2FkQXJ0aWZhY3RzLAogICAgW3N0cmluZ10gJFN0b3JhZ2VBY2NvdW50TmFtZSwKICAgIFtzdHJpbmddICRTdG9yYWdlQ29udGFpbmVyTmFtZSA9ICRSZXNvdXJjZUdyb3VwTmFtZS5Ub0xvd2VySW52YXJpYW50KCkgKyAnLXN0YWdlYXJ0aWZhY3RzJywKICAgIFtzdHJpbmddICRUZW1wbGF0ZUZpbGUgPSAnYXp1cmVkZXBsb3kuanNvbicsCiAgICBbc3RyaW5nXSAkVGVtcGxhdGVQYXJhbWV0ZXJzRmlsZSA9ICdhenVyZWRlcGxveS5wYXJhbWV0ZXJzLmpzb24nLAogICAgW3N0cmluZ10gJEFydGlmYWN0U3RhZ2luZ0RpcmVjdG9yeSA9ICcuJywKICAgIFtzdHJpbmddICREU0NTb3VyY2VGb2xkZXIgPSAnRFNDJywKICAgIFtzd2l0Y2hdICRWYWxpZGF0ZU9ubHkKKQoKdHJ5IHsKICAgIFtNaWNyb3NvZnQuQXp1cmUuQ29tbW9uLkF1dGhlbnRpY2F0aW9uLkF6dXJlU2Vzc2lvbl06OkNsaWVudEZhY3RvcnkuQWRkVXNlckFnZW50KCJWU0F6dXJlVG9vbHMtJFVJJCgkaG9zdC5uYW1lKSIucmVwbGFjZSgnICcsJ18nKSwgJzIuOS42JykKfSBjYXRjaCB7IH0KCiRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU3RvcCcKU2V0LVN0cmljdE1vZGUgLVZlcnNpb24gMwoKZnVuY3Rpb24gRm9ybWF0LVZhbGlkYXRpb25PdXRwdXQgewogICAgcGFyYW0gKCRWYWxpZGF0aW9uT3V0cHV0LCBbaW50XSAkRGVwdGggPSAwKQogICAgU2V0LVN0cmljdE1vZGUgLU9mZgogICAgcmV0dXJuIEAoJFZhbGlkYXRpb25PdXRwdXQgfCBXaGVyZS1PYmplY3QgeyAkXyAtbmUgJG51bGwgfSB8IEZvckVhY2gtT2JqZWN0IHsgQCgnICAnICogJERlcHRoICsgJzogJyArICRfLk1lc3NhZ2UpICsgQChGb3JtYXQtVmFsaWRhdGlvbk91dHB1dCBAKCRfLkRldGFpbHMpICgkRGVwdGggKyAxKSkgfSkKfQoKJE9wdGlvbmFsUGFyYW1ldGVycyA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIEhhc2h0YWJsZQokVGVtcGxhdGVGaWxlID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RnVsbFBhdGgoW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkUFNTY3JpcHRSb290LCAkVGVtcGxhdGVGaWxlKSkKJFRlbXBsYXRlUGFyYW1ldGVyc0ZpbGUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRGdWxsUGF0aChbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRQU1NjcmlwdFJvb3QsICRUZW1wbGF0ZVBhcmFtZXRlcnNGaWxlKSkKCmlmICgkVXBsb2FkQXJ0aWZhY3RzKSB7CiAgICAjIENvbnZlcnQgcmVsYXRpdmUgcGF0aHMgdG8gYWJzb2x1dGUgcGF0aHMgaWYgbmVlZGVkCiAgICAkQXJ0aWZhY3RTdGFnaW5nRGlyZWN0b3J5ID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RnVsbFBhdGgoW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkUFNTY3JpcHRSb290LCAkQXJ0aWZhY3RTdGFnaW5nRGlyZWN0b3J5KSkKICAgICREU0NTb3VyY2VGb2xkZXIgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRGdWxsUGF0aChbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRQU1NjcmlwdFJvb3QsICREU0NTb3VyY2VGb2xkZXIpKQoKICAgICMgUGFyc2UgdGhlIHBhcmFtZXRlciBmaWxlIGFuZCB1cGRhdGUgdGhlIHZhbHVlcyBvZiBhcnRpZmFjdHMgbG9jYXRpb24gYW5kIGFydGlmYWN0cyBsb2NhdGlvbiBTQVMgdG9rZW4gaWYgdGhleSBhcmUgcHJlc2VudAogICAgJEpzb25QYXJhbWV0ZXJzID0gR2V0LUNvbnRlbnQgJFRlbXBsYXRlUGFyYW1ldGVyc0ZpbGUgLVJhdyB8IENvbnZlcnRGcm9tLUpzb24KICAgIGlmICgoJEpzb25QYXJhbWV0ZXJzIHwgR2V0LU1lbWJlciAtVHlwZSBOb3RlUHJvcGVydHkgJ3BhcmFtZXRlcnMnKSAtbmUgJG51bGwpIHsKICAgICAgICAkSnNvblBhcmFtZXRlcnMgPSAkSnNvblBhcmFtZXRlcnMucGFyYW1ldGVycwogICAgfQogICAgJEFydGlmYWN0c0xvY2F0aW9uTmFtZSA9ICdfYXJ0aWZhY3RzTG9jYXRpb24nCiAgICAkQXJ0aWZhY3RzTG9jYXRpb25TYXNUb2tlbk5hbWUgPSAnX2FydGlmYWN0c0xvY2F0aW9uU2FzVG9rZW4nCiAgICAkT3B0aW9uYWxQYXJhbWV0ZXJzWyRBcnRpZmFjdHNMb2NhdGlvbk5hbWVdID0gJEpzb25QYXJhbWV0ZXJzIHwgU2VsZWN0IC1FeHBhbmQgJEFydGlmYWN0c0xvY2F0aW9uTmFtZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgU2VsZWN0IC1FeHBhbmQgJ3ZhbHVlJyAtRXJyb3JBY3Rpb24gSWdub3JlCiAgICAkT3B0aW9uYWxQYXJhbWV0ZXJzWyRBcnRpZmFjdHNMb2NhdGlvblNhc1Rva2VuTmFtZV0gPSAkSnNvblBhcmFtZXRlcnMgfCBTZWxlY3QgLUV4cGFuZCAkQXJ0aWZhY3RzTG9jYXRpb25TYXNUb2tlbk5hbWUgLUVycm9yQWN0aW9uIElnbm9yZSB8IFNlbGVjdCAtRXhwYW5kICd2YWx1ZScgLUVycm9yQWN0aW9uIElnbm9yZQoKICAgICMgQ3JlYXRlIERTQyBjb25maWd1cmF0aW9uIGFyY2hpdmUKICAgIGlmIChUZXN0LVBhdGggJERTQ1NvdXJjZUZvbGRlcikgewogICAgICAgICREU0NTb3VyY2VGaWxlUGF0aHMgPSBAKEdldC1DaGlsZEl0ZW0gJERTQ1NvdXJjZUZvbGRlciAtRmlsZSAtRmlsdGVyICcqLnBzMScgfCBGb3JFYWNoLU9iamVjdCAtUHJvY2VzcyB7JF8uRnVsbE5hbWV9KQogICAgICAgIGZvcmVhY2ggKCREU0NTb3VyY2VGaWxlUGF0aCBpbiAkRFNDU291cmNlRmlsZVBhdGhzKSB7CiAgICAgICAgICAgICREU0NBcmNoaXZlRmlsZVBhdGggPSAkRFNDU291cmNlRmlsZVBhdGguU3Vic3RyaW5nKDAsICREU0NTb3VyY2VGaWxlUGF0aC5MZW5ndGggLSA0KSArICcuemlwJwogICAgICAgICAgICBQdWJsaXNoLUF6dXJlUm1WTURzY0NvbmZpZ3VyYXRpb24gJERTQ1NvdXJjZUZpbGVQYXRoIC1PdXRwdXRBcmNoaXZlUGF0aCAkRFNDQXJjaGl2ZUZpbGVQYXRoIC1Gb3JjZSAtVmVyYm9zZQogICAgICAgIH0KICAgIH0KCiAgICAjIENyZWF0ZSBhIHN0b3JhZ2UgYWNjb3VudCBuYW1lIGlmIG5vbmUgd2FzIHByb3ZpZGVkCiAgICBpZiAoJFN0b3JhZ2VBY2NvdW50TmFtZSAtZXEgJycpIHsKICAgICAgICAkU3RvcmFnZUFjY291bnROYW1lID0gJ3N0YWdlJyArICgoR2V0LUF6dXJlUm1Db250ZXh0KS5TdWJzY3JpcHRpb24uU3Vic2NyaXB0aW9uSWQpLlJlcGxhY2UoJy0nLCAnJykuc3Vic3RyaW5nKDAsIDE5KQogICAgfQoKICAgICRTdG9yYWdlQWNjb3VudCA9IChHZXQtQXp1cmVSbVN0b3JhZ2VBY2NvdW50IHwgV2hlcmUtT2JqZWN0eyRfLlN0b3JhZ2VBY2NvdW50TmFtZSAtZXEgJFN0b3JhZ2VBY2NvdW50TmFtZX0pCgogICAgIyBDcmVhdGUgdGhlIHN0b3JhZ2UgYWNjb3VudCBpZiBpdCBkb2Vzbid0IGFscmVhZHkgZXhpc3QKICAgIGlmICgkU3RvcmFnZUFjY291bnQgLWVxICRudWxsKSB7CiAgICAgICAgJFN0b3JhZ2VSZXNvdXJjZUdyb3VwTmFtZSA9ICdBUk1fRGVwbG95X1N0YWdpbmcnCiAgICAgICAgTmV3LUF6dXJlUm1SZXNvdXJjZUdyb3VwIC1Mb2NhdGlvbiAiJFJlc291cmNlR3JvdXBMb2NhdGlvbiIgLU5hbWUgJFN0b3JhZ2VSZXNvdXJjZUdyb3VwTmFtZSAtRm9yY2UKICAgICAgICAkU3RvcmFnZUFjY291bnQgPSBOZXctQXp1cmVSbVN0b3JhZ2VBY2NvdW50IC1TdG9yYWdlQWNjb3VudE5hbWUgJFN0b3JhZ2VBY2NvdW50TmFtZSAtVHlwZSAnU3RhbmRhcmRfTFJTJyAtUmVzb3VyY2VHcm91cE5hbWUgJFN0b3JhZ2VSZXNvdXJjZUdyb3VwTmFtZSAtTG9jYXRpb24gIiRSZXNvdXJjZUdyb3VwTG9jYXRpb24iCiAgICB9CgogICAgIyBHZW5lcmF0ZSB0aGUgdmFsdWUgZm9yIGFydGlmYWN0cyBsb2NhdGlvbiBpZiBpdCBpcyBub3QgcHJvdmlkZWQgaW4gdGhlIHBhcmFtZXRlciBmaWxlCiAgICBpZiAoJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25OYW1lXSAtZXEgJG51bGwpIHsKICAgICAgICAkT3B0aW9uYWxQYXJhbWV0ZXJzWyRBcnRpZmFjdHNMb2NhdGlvbk5hbWVdID0gJFN0b3JhZ2VBY2NvdW50LkNvbnRleHQuQmxvYkVuZFBvaW50ICsgJFN0b3JhZ2VDb250YWluZXJOYW1lCiAgICB9CgogICAgIyBDb3B5IGZpbGVzIGZyb20gdGhlIGxvY2FsIHN0b3JhZ2Ugc3RhZ2luZyBsb2NhdGlvbiB0byB0aGUgc3RvcmFnZSBhY2NvdW50IGNvbnRhaW5lcgogICAgTmV3LUF6dXJlU3RvcmFnZUNvbnRhaW5lciAtTmFtZSAkU3RvcmFnZUNvbnRhaW5lck5hbWUgLUNvbnRleHQgJFN0b3JhZ2VBY2NvdW50LkNvbnRleHQgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgKj4mMQoKICAgICRBcnRpZmFjdEZpbGVQYXRocyA9IEdldC1DaGlsZEl0ZW0gJEFydGlmYWN0U3RhZ2luZ0RpcmVjdG9yeSAtUmVjdXJzZSAtRmlsZSB8IEZvckVhY2gtT2JqZWN0IC1Qcm9jZXNzIHskXy5GdWxsTmFtZX0KICAgIGZvcmVhY2ggKCRTb3VyY2VQYXRoIGluICRBcnRpZmFjdEZpbGVQYXRocykgewogICAgICAgIFNldC1BenVyZVN0b3JhZ2VCbG9iQ29udGVudCAtRmlsZSAkU291cmNlUGF0aCAtQmxvYiAkU291cmNlUGF0aC5TdWJzdHJpbmcoJEFydGlmYWN0U3RhZ2luZ0RpcmVjdG9yeS5sZW5ndGggKyAxKSBgCiAgICAgICAgICAgIC1Db250YWluZXIgJFN0b3JhZ2VDb250YWluZXJOYW1lIC1Db250ZXh0ICRTdG9yYWdlQWNjb3VudC5Db250ZXh0IC1Gb3JjZQogICAgfQoKICAgICMgR2VuZXJhdGUgYSA0IGhvdXIgU0FTIHRva2VuIGZvciB0aGUgYXJ0aWZhY3RzIGxvY2F0aW9uIGlmIG9uZSB3YXMgbm90IHByb3ZpZGVkIGluIHRoZSBwYXJhbWV0ZXJzIGZpbGUKICAgIGlmICgkT3B0aW9uYWxQYXJhbWV0ZXJzWyRBcnRpZmFjdHNMb2NhdGlvblNhc1Rva2VuTmFtZV0gLWVxICRudWxsKSB7CiAgICAgICAgJE9wdGlvbmFsUGFyYW1ldGVyc1skQXJ0aWZhY3RzTG9jYXRpb25TYXNUb2tlbk5hbWVdID0gQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgLUZvcmNlIGAKICAgICAgICAgICAgKE5ldy1BenVyZVN0b3JhZ2VDb250YWluZXJTQVNUb2tlbiAtQ29udGFpbmVyICRTdG9yYWdlQ29udGFpbmVyTmFtZSAtQ29udGV4dCAkU3RvcmFnZUFjY291bnQuQ29udGV4dCAtUGVybWlzc2lvbiByIC1FeHBpcnlUaW1lIChHZXQtRGF0ZSkuQWRkSG91cnMoNCkpCiAgICB9Cn0KCiMgQ3JlYXRlIG9yIHVwZGF0ZSB0aGUgcmVzb3VyY2UgZ3JvdXAgdXNpbmcgdGhlIHNwZWNpZmllZCB0ZW1wbGF0ZSBmaWxlIGFuZCB0ZW1wbGF0ZSBwYXJhbWV0ZXJzIGZpbGUKTmV3LUF6dXJlUm1SZXNvdXJjZUdyb3VwIC1OYW1lICRSZXNvdXJjZUdyb3VwTmFtZSAtTG9jYXRpb24gJFJlc291cmNlR3JvdXBMb2NhdGlvbiAtVmVyYm9zZSAtRm9yY2UKCmlmICgkVmFsaWRhdGVPbmx5KSB7CiAgICAkRXJyb3JNZXNzYWdlcyA9IEZvcm1hdC1WYWxpZGF0aW9uT3V0cHV0IChUZXN0LUF6dXJlUm1SZXNvdXJjZUdyb3VwRGVwbG95bWVudCAtUmVzb3VyY2VHcm91cE5hbWUgJFJlc291cmNlR3JvdXBOYW1lIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1UZW1wbGF0ZUZpbGUgJFRlbXBsYXRlRmlsZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVGVtcGxhdGVQYXJhbWV0ZXJGaWxlICRUZW1wbGF0ZVBhcmFtZXRlcnNGaWxlIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBPcHRpb25hbFBhcmFtZXRlcnMpCiAgICBpZiAoJEVycm9yTWVzc2FnZXMpIHsKICAgICAgICBXcml0ZS1PdXRwdXQgJycsICdWYWxpZGF0aW9uIHJldHVybmVkIHRoZSBmb2xsb3dpbmcgZXJyb3JzOicsIEAoJEVycm9yTWVzc2FnZXMpLCAnJywgJ1RlbXBsYXRlIGlzIGludmFsaWQuJwogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICcnLCAnVGVtcGxhdGUgaXMgdmFsaWQuJwogICAgfQp9CmVsc2UgewogICAgTmV3LUF6dXJlUm1SZXNvdXJjZUdyb3VwRGVwbG95bWVudCAtTmFtZSAoKEdldC1DaGlsZEl0ZW0gJFRlbXBsYXRlRmlsZSkuQmFzZU5hbWUgKyAnLScgKyAoKEdldC1EYXRlKS5Ub1VuaXZlcnNhbFRpbWUoKSkuVG9TdHJpbmcoJ01NZGQtSEhtbScpKSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1SZXNvdXJjZUdyb3VwTmFtZSAkUmVzb3VyY2VHcm91cE5hbWUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVGVtcGxhdGVGaWxlICRUZW1wbGF0ZUZpbGUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVGVtcGxhdGVQYXJhbWV0ZXJGaWxlICRUZW1wbGF0ZVBhcmFtZXRlcnNGaWxlIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQE9wdGlvbmFsUGFyYW1ldGVycyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Gb3JjZSAtVmVyYm9zZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1FcnJvclZhcmlhYmxlIEVycm9yTWVzc2FnZXMKICAgIGlmICgkRXJyb3JNZXNzYWdlcykgewogICAgICAgIFdyaXRlLU91dHB1dCAnJywgJ1RlbXBsYXRlIGRlcGxveW1lbnQgcmV0dXJuZWQgdGhlIGZvbGxvd2luZyBlcnJvcnM6JywgQChAKCRFcnJvck1lc3NhZ2VzKSB8IEZvckVhY2gtT2JqZWN0IHsgJF8uRXhjZXB0aW9uLk1lc3NhZ2UuVHJpbUVuZCgiYHJgbiIpIH0pCiAgICB9Cn0=
