DTAP.psm1,faaab7397cc63ab7f5b655b4e119263f,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyBBdXRob3I6IFdhcm5lciBTb2RpdHVzCiMjIE1vZGlmaWVkIGRhdGU6IDA1LTEyLTIwMTUKIyMgVmVyc2lvbiBIaXN0b3J5OiAxLjAKIyMgUHVycG9zZTogRFRBUCBjbWRsZXQgZnVuY3Rpb25zCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiNSZXF1aXJlcyAtdmVyc2lvbiAyLjAKCiRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU3RvcCI7CiRkZWxpbSA9ICJ8IgokZGVsaW1Jbm5lciA9ICJ+IgoKPCMKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKiBQcml2YXRlIG1lbWJlcnMKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIz4KCgpGdW5jdGlvbiBJbXBvcnQtVHJpZGlvblN0cnVjdHVyZUdyb3Vwc0Zyb21GaWxlCnsgICAgPCMKICAgIC5TeW5vcHNpcwogICAgaW1wb3J0cyB0aGUgc3RydWN0dXJlIGdyb3VwcyBmcm9tIENTViBmaWxlCgogICAgLkRlc2NyaXB0aW9uCiAgICBUQkQKCiAgICAuTm90ZXMKICAgIFRCRAoKICAgIC5JbnB1dHMKICAgIFRCRAoKICAgIC5PdXRwdXRzCiAgICBUQkQKCiAgICAuTGluawogICAgR2V0IHRoZSBsYXRlc3QgdmVyc2lvbiBvZiB0aGlzIHNjcmlwdCBmcm9tIHRoZSBmb2xsb3dpbmcgVVJMOgogICAgVEJECgogICAgLkV4YW1wbGUKICAgIFRCRAoKICAgICM+CgogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtUcmlkaW9uLkNvbnRlbnRNYW5hZ2VyLkNvcmVTZXJ2aWNlLkNsaWVudC5Hcm91cERhdGFbXV0kQWxsR3JvdXBzLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVGl0bGUsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRXZWJkYXYsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSREaXJlY3RvcnksCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRJc0RlZmF1bHRQYWdlVGVtcGxhdGVJbmhlcml0ZWQsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSREZWZhdWx0UGFnZVRlbXBsYXRlLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kUGFnZUJ1bmRsZVByb2Nlc3MsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRQYWdlUHJvY2VzcywKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJE1ldGFkYXRhU2NoZW1hLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kTWV0YWRhdGEsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRJc0FjdGl2ZSwKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJElzUGVybWlzc2lvbnNJbmhlcml0YW5jZVJvb3QsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRBQ0wKCiAgICApCiAgICAKICAgIFByb2Nlc3MKICAgIHsKICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFdlYmRhdikpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CgogICAgICAgICNOZWVkIHRvIHByb2Nlc3MgQUNMLi4uCiAgICAgICAgaWYgKCgkQUNMIC1uZSAkbnVsbCkgLWFuZCAoJEFDTC5MZW5ndGggLWd0IDApKQogICAgICAgIHsKICAgICAgICAgICAgJGFsbG93UGVybWlzc2lvbnMgPSBAe30KICAgICAgICAgICAgIyRhbGxHcm91cHMgPSBHZXQtVHJpZGlvbkdyb3VwcyAtSWRUaXRsZU9ubHkKICAgICAgICAgICAgJHBhcnRzID0gJEFDTC5TcGxpdCgkZGVsaW0pCiAgICAgICAgICAgIGZvcmVhY2ggKCRwYXJ0IGluICRwYXJ0cykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAicGFydDogJHBhcnQiCgogICAgICAgICAgICAgICAgJGdyb3VwID0gJHBhcnQuU3Vic3RyaW5nKDAsKCRwYXJ0LkluZGV4T2YoIigiKSkpCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJncm91cDogJGdyb3VwIgogICAgICAgICAgICAgICAgJHNjb3BlID0gJHBhcnQuU3Vic3RyaW5nKCgkcGFydC5JbmRleE9mKCIoIikgKyAxKSwoJHBhcnQuTGVuZ3RoIC0gJHBhcnQuSW5kZXhPZigiKCIpIC0yKSkKICAgICAgICAgICAgICAgICRhbGxvd1Blcm1pc3Npb25zLkFkZCgoR2V0LVRyaWRpb25Hcm91cCAtR3JvdXBOYW1lICRncm91cCAtQWxsR3JvdXBzICRBbGxHcm91cHMpLklkLCRzY29wZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJObyBBQ0wgcGFzc2VkIGluIgogICAgICAgICAgICAkYWxsb3dQZXJtaXNzaW9ucyA9ICRudWxsCiAgICAgICAgfQoKCiAgICAgICAgaWYgKCRJc0RlZmF1bHRQYWdlVGVtcGxhdGVJbmhlcml0ZWQuVG9VcHBlcigpIC1lcSAiVFJVRSIpCiAgICAgICAgewogICAgICAgICAgICAkaXNEZWZhdWx0UFRJbmhlcml0ZWQgPSAkdHJ1ZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkaXNEZWZhdWx0UFRJbmhlcml0ZWQgPSAkZmFsc2UKICAgICAgICB9CgogICAgICAgIGlmICgkSXNBY3RpdmUuVG9VcHBlcigpIC1lcSAiVFJVRSIpCiAgICAgICAgewogICAgICAgICAgICAkbWFrZUFjdGl2ZSA9ICR0cnVlCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRtYWtlQWN0aXZlID0gJGZhbHNlCiAgICAgICAgfQoKICAgICAgICBpZiAoJElzUGVybWlzc2lvbnNJbmhlcml0YW5jZVJvb3QuVG9VcHBlcigpIC1lcSAiVFJVRSIpCiAgICAgICAgewogICAgICAgICAgICAkc2V0SW5oZXJpdCA9ICRmYWxzZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkc2V0SW5oZXJpdCA9ICR0cnVlCiAgICAgICAgfQoKICAgICAgICAgICAgIyRwYXJ0cyA9ICRXZWJkYXYuU3BsaXQoIi8iKQogICAgICAgICAgICAjJHBhcmVudCA9ICRXZWJkYXYuc3Vic3RyaW5nKDAsKCRXZWJkYXYuTGVuZ3RoIC0gJERpcmVjdG9yeS5MZW5ndGggLTEpKQogICAgICAgICRwYXJ0cyA9ICRXZWJkYXYuU3BsaXQoIi8iKQogICAgICAgICRwYXJlbnQgPSAkcGFydHNbMC4uKCRwYXJ0cy5Db3VudCAtIDIpXSAtSm9pbiAiLyIKCiAgICAgICAgaWYgKChHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRXZWJkYXYgLUlnbm9yZU5vdEZvdW5kKSAtZXEgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICAjY3JlYXRlIGl0ZW0KCiAgICAgICAgICAgIE5ldy1UcmlkaW9uU3RydWN0dXJlR3JvdXAgYAogICAgICAgICAgICAgICAgLU5hbWUgJFRpdGxlIGAKICAgICAgICAgICAgICAgIC1EaXJlY3RvcnkgJERpcmVjdG9yeSBgCiAgICAgICAgICAgICAgICAtV2ViZGF2TG9jYXRpb24gJHBhcmVudCBgCiAgICAgICAgICAgICAgICAtQnVuZGxlUHJvY2Vzc05hbWUgJFBhZ2VCdW5kbGVQcm9jZXNzIGAKICAgICAgICAgICAgICAgIC1SZW1vdmVFeGlzdGluZ1Blcm1pc3Npb25zIGAKICAgICAgICAgICAgICAgIC1QZXJtaXNzaW9ucyAkYWxsb3dQZXJtaXNzaW9ucyBgCiAgICAgICAgICAgICAgICAtTWV0YWRhdGFTY2hlbWEgJE1ldGFkYXRhU2NoZW1hIGAKICAgICAgICAgICAgICAgIC1NZXRhZGF0YVhtbCAkTWV0YWRhdGEgYAogICAgICAgICAgICAgICAgLURlZmF1bHRQYWdlVGVtcGxhdGUgJERlZmF1bHRQYWdlVGVtcGxhdGUgYAogICAgICAgICAgICAgICAgLUluaGVyaXREZWZhdWx0UGFnZVRlbXBsYXRlICRpc0RlZmF1bHRQVEluaGVyaXRlZCBgCiAgICAgICAgICAgICAgICAtSXNBY3RpdmUgJG1ha2VBY3RpdmUgYAogICAgICAgICAgICAgICAgLVBhZ2VQcm9jZXNzICRQYWdlUHJvY2VzcyBgCiAgICAgICAgICAgICAgICAtVmVyYm9zZQoKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgI3RoZW4gd2UgZG8gYW4gdXBkYXRlISEhIAogICAgICAgICAgICBVcGRhdGUtVHJpZGlvblN0cnVjdHVyZUdyb3VwIGAKICAgICAgICAgICAgICAgIC1OYW1lICRUaXRsZSBgCiAgICAgICAgICAgICAgICAtRGlyZWN0b3J5ICREaXJlY3RvcnkgYAogICAgICAgICAgICAgICAgLVdlYmRhdkxvY2F0aW9uICRXZWJkYXYgYAogICAgICAgICAgICAgICAgLUJ1bmRsZVByb2Nlc3NOYW1lICRQYWdlQnVuZGxlUHJvY2VzcyBgCiAgICAgICAgICAgICAgICAtUmVtb3ZlRXhpc3RpbmdQZXJtaXNzaW9ucyBgCiAgICAgICAgICAgICAgICAtUGVybWlzc2lvbnMgJGFsbG93UGVybWlzc2lvbnMgYAogICAgICAgICAgICAgICAgLU1ldGFkYXRhU2NoZW1hICRNZXRhZGF0YVNjaGVtYSBgCiAgICAgICAgICAgICAgICAtTWV0YWRhdGFYbWwgJE1ldGFkYXRhIGAKICAgICAgICAgICAgICAgIC1EZWZhdWx0UGFnZVRlbXBsYXRlICREZWZhdWx0UGFnZVRlbXBsYXRlIGAKICAgICAgICAgICAgICAgIC1Jbmhlcml0RGVmYXVsdFBhZ2VUZW1wbGF0ZSAkaXNEZWZhdWx0UFRJbmhlcml0ZWQgYAogICAgICAgICAgICAgICAgLUlzQWN0aXZlICRtYWtlQWN0aXZlIGAKICAgICAgICAgICAgICAgIC1QYWdlUHJvY2VzcyAkUGFnZVByb2Nlc3MgYAogICAgICAgICAgICAgICAgLVNldFNlY3VyaXR5VG9Jbmhlcml0Oigkc2V0SW5oZXJpdCAtZXEgJHRydWUpIGAKICAgICAgICAgICAgICAgIC1WZXJib3NlCgogICAgICAgIH0KCiAgICB9Cn0KCgpGdW5jdGlvbiBJbXBvcnQtVHJpZGlvbkZvbGRlcnNGcm9tRmlsZQp7ICAgIDwjCiAgICAuU3lub3BzaXMKICAgIGltcG9ydHMgdGhlIEZvbGRlcnMgZnJvbSBDU1YgZmlsZQoKICAgIC5EZXNjcmlwdGlvbgogICAgVEJECgogICAgLk5vdGVzCiAgICBUQkQKCiAgICAuSW5wdXRzCiAgICBUQkQKCiAgICAuT3V0cHV0cwogICAgVEJECgogICAgLkxpbmsKICAgIEdldCB0aGUgbGF0ZXN0IHZlcnNpb24gb2YgdGhpcyBzY3JpcHQgZnJvbSB0aGUgZm9sbG93aW5nIFVSTDoKICAgIFRCRAoKICAgIC5FeGFtcGxlCiAgICBUQkQKCiAgICAjPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbVHJpZGlvbi5Db250ZW50TWFuYWdlci5Db3JlU2VydmljZS5DbGllbnQuR3JvdXBEYXRhW11dJEFsbEdyb3VwcywKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJFRpdGxlLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kV2ViZGF2LAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kTWV0YWRhdGFTY2hlbWEsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRNZXRhZGF0YSwKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJExpbmtlZFNjaGVtYSwKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJElzTGlua2VkU2NoZW1hTWFuZGF0b3J5LAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kSXNQZXJtaXNzaW9uc0luaGVyaXRhbmNlUm9vdCwKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJEFDTAogICAgKQogICAgCiAgICBQcm9jZXNzCiAgICB7CiAgICAgICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRXZWJkYXYpKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgfQoKICAgICAgICAjTmVlZCB0byBwcm9jZXNzIEFDTC4uLgogICAgICAgIGlmICgoJEFDTCAtbmUgJG51bGwpIC1hbmQgKCRBQ0wuTGVuZ3RoIC1ndCAwKSkKICAgICAgICB7CiAgICAgICAgICAgICRhbGxvd1Blcm1pc3Npb25zID0gQHt9CiAgICAgICAgICAgICMkYWxsR3JvdXBzID0gR2V0LVRyaWRpb25Hcm91cHMgLUlkVGl0bGVPbmx5CiAgICAgICAgICAgICRwYXJ0cyA9ICRBQ0wuU3BsaXQoJGRlbGltKQogICAgICAgICAgICBmb3JlYWNoICgkcGFydCBpbiAkcGFydHMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgInBhcnQ6ICRwYXJ0IgoKICAgICAgICAgICAgICAgICRncm91cCA9ICRwYXJ0LlN1YnN0cmluZygwLCgkcGFydC5JbmRleE9mKCIoIikpKQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiZ3JvdXA6ICRncm91cCIKICAgICAgICAgICAgICAgICRzY29wZSA9ICRwYXJ0LlN1YnN0cmluZygoJHBhcnQuSW5kZXhPZigiKCIpICsgMSksKCRwYXJ0Lkxlbmd0aCAtICRwYXJ0LkluZGV4T2YoIigiKSAtMikpCiAgICAgICAgICAgICAgICAkYWxsb3dQZXJtaXNzaW9ucy5BZGQoKEdldC1UcmlkaW9uR3JvdXAgLUdyb3VwTmFtZSAkZ3JvdXAgLUFsbEdyb3VwcyAkQWxsR3JvdXBzKS5JZCwkc2NvcGUpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTm8gQUNMIHBhc3NlZCBpbiIKICAgICAgICAgICAgJGFsbG93UGVybWlzc2lvbnMgPSAkbnVsbAogICAgICAgIH0KCiAgICAgICAgaWYgKCRJc0xpbmtlZFNjaGVtYU1hbmRhdG9yeS5Ub1VwcGVyKCkgLWVxICJUUlVFIikKICAgICAgICB7CiAgICAgICAgICAgICRpc0xpbmtlZFNjaGVtYVJlcXVpcmVkID0gJHRydWUKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgJGlzTGlua2VkU2NoZW1hUmVxdWlyZWQgPSAkZmFsc2UKICAgICAgICB9CgoKICAgICAgICBpZiAoKEdldC1UcmlkaW9uSXRlbSAtSWRPclBhdGggJFdlYmRhdiAtSWdub3JlTm90Rm91bmQpIC1lcSAkbnVsbCkKICAgICAgICB7CiAgICAgICAgICAgICRwYXJ0cyA9ICRXZWJkYXYuU3BsaXQoIi8iKQogICAgICAgICAgICAkcGFyZW50ID0gJHBhcnRzWzAuLigkcGFydHMuQ291bnQgLSAyKV0gLUpvaW4gIi8iCiAgICAgICAgICAgICNjcmVhdGUgaXRlbQogICAgICAgICAgICBOZXctVHJpZGlvbkZvbGRlciBgCiAgICAgICAgICAgICAgICAtTmFtZSAkVGl0bGUgYAogICAgICAgICAgICAgICAgLVdlYmRhdkxvY2F0aW9uICRwYXJlbnQgYAogICAgICAgICAgICAgICAgLVJlbW92ZUV4aXN0aW5nUGVybWlzc2lvbnMgYAogICAgICAgICAgICAgICAgLVBlcm1pc3Npb25zICRhbGxvd1Blcm1pc3Npb25zIGAKICAgICAgICAgICAgICAgIC1NZXRhZGF0YVNjaGVtYSAkTWV0YWRhdGFTY2hlbWEgYAogICAgICAgICAgICAgICAgLU1ldGFkYXRhWG1sICRNZXRhZGF0YSBgCiAgICAgICAgICAgICAgICAtTGlua2VkU2NoZW1hV2ViZGF2VXJsICRMaW5rZWRTY2hlbWEgYAogICAgICAgICAgICAgICAgLUxpbmtlZFNjaGVtYU1hbmRhdG9yeTooJGlzTGlua2VkU2NoZW1hUmVxdWlyZWQgLWVxICR0cnVlKSBgCiAgICAgICAgICAgICAgICAtVmVyYm9zZQoKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgI3RoZW4gd2UgZG8gYW4gdXBkYXRlISEhCiAgICAgICAgICAgIFVwZGF0ZS1UcmlkaW9uRm9sZGVyIGAKICAgICAgICAgICAgICAgIC1OYW1lICRUaXRsZSBgCiAgICAgICAgICAgICAgICAtV2ViZGF2TG9jYXRpb24gJFdlYmRhdiBgCiAgICAgICAgICAgICAgICAtUmVtb3ZlRXhpc3RpbmdQZXJtaXNzaW9ucyBgCiAgICAgICAgICAgICAgICAtUGVybWlzc2lvbnMgJGFsbG93UGVybWlzc2lvbnMgYAogICAgICAgICAgICAgICAgLU1ldGFkYXRhU2NoZW1hICRNZXRhZGF0YVNjaGVtYSBgCiAgICAgICAgICAgICAgICAtTWV0YWRhdGFYbWwgJE1ldGFkYXRhIGAKICAgICAgICAgICAgICAgIC1MaW5rZWRTY2hlbWFXZWJkYXZVcmwgJExpbmtlZFNjaGVtYSBgCiAgICAgICAgICAgICAgICAtTGlua2VkU2NoZW1hTWFuZGF0b3J5OigkaXNMaW5rZWRTY2hlbWFSZXF1aXJlZCAtZXEgJHRydWUpIGAKICAgICAgICAgICAgICAgIC1WZXJib3NlCiAgICAgICAgfQoKICAgIH0KfQoKRnVuY3Rpb24gR2V0LVRyaWRpb25TY29wZVNwZWNpZmljYXRpb24KewogICAgPCMKICAgIC5TeW5vcHNpcwogICAgR2V0cyB0aGUgc2NvcGUgc3BlY2lmaWNhdGlvbiBmcm9tIGEgZ3JvdXAgTWVtYmVyIE9mIHNwZWNpZmljYXRpb24KCiAgICAuRGVzY3JpcHRpb24KICAgIGxvb2tzIGZvciB0aGUgdGV4dCBpbiBwYXJlbnRoZXNpcwoKICAgIC5Ob3RlcwogICAgcHJpdmF0ZSBjbWRsZXQKICAgIAogICAgLklucHV0cwogICAgW3N0cmluZ10gR3JvdXBOYW1lCgogICAgLk91dHB1dHMKICAgIFtzdHJpbmddIG5hbWUgb2YgdGhlIFB1YmxpY2F0aW9uIHNjb3BlIChpZiBhbnkpCgogICAgLkxpbmsKICAgIEdldCB0aGUgbGF0ZXN0IHZlcnNpb24gb2YgdGhpcyBzY3JpcHQgZnJvbSB0aGUgZm9sbG93aW5nIFVSTDoKICAgIGh0dHA6Ly9pc2Rzdm4ud2VsbHNmYXJnby5jb20vc3ZuL3NtdF9zZGwvYnJhbmNoZXMvc210X3NkbF9hZG1pbi9hZG1pbmlzdHJhdGlvbi9vcHQvYXBwcy9zY3JpcHRzL3Bvd2Vyc2hlbGwvbW9kdWxlcy9UcmlkaW9uLVByb2R1Y3Rpb25TdXBwb3J0L1Byb2R1Y3Rpb25TdXBwb3J0LnBzbTEKCiAgICAuRXhhbXBsZQogICAgVEJECgogICAgIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldCiAgICAgICAgJEdyb3VwTmFtZQogICAgKQoKICAgIFByb2Nlc3MKICAgIHsKICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJEdyb3VwTmFtZSkpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJHcm91cCBOYW1lIGlzIGVtcHR5LiIKICAgICAgICAgICAgcmV0dXJuICRudWxsCiAgICAgICAgfQogICAgICAgICRwb3NMID0gJEdyb3VwTmFtZS5JbmRleE9mKCIoIikKICAgICAgICAkcG9zUiA9ICRHcm91cE5hbWUuSW5kZXhPZigiKSIpCiAgICAgICAgJHB1Yk5hbWUgPSAkbnVsbAogICAgICAgIGlmICgoJHBvc0wgLWd0IDApIC1hbmQgKCRwb3NSIC1ndCAwKSkKICAgICAgICB7CiAgICAgICAgICAgICRwdWJOYW1lID0gJEdyb3VwTmFtZS5TdWJzdHJpbmcoKCRwb3NMICsgMSksKCRwb3NSIC0gJHBvc0wgLSAxKSkKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiRm91bmQgc2NvcGUgc3BlY2lmaWNhdGlvbjogJHB1Yk5hbWUiCiAgICAgICAgICAgIHJldHVybiAkcHViTmFtZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJObyBzY29wZSBzcGVjaWZpY2F0aW9uIgogICAgICAgIH0KICAgICAgICByZXR1cm4gJHB1Yk5hbWUKCiAgICB9Cn0KCkZ1bmN0aW9uIEdldC1GaXhlZFRyaWRpb25Hcm91cE5hbWUKewogICAgPCMKICAgIC5TeW5vcHNpcwogICAgRml4ZXMgYSBncm91cCBuYW1lCgogICAgLkRlc2NyaXB0aW9uCiAgICBzdHJpcHMgb2ZmIHdoaXRlIHNwYWNlIGF0IGVuZHMsIGNvbnZlcnRzIGVtLWRhc2ggdG8gLSBhbmQgcmVtb3ZlcyBhbnkgKHNjb3BlKSBzcGVjaWZpZXIKCiAgICAuTm90ZXMKICAgIHByaXZhdGUgY21kbGV0CiAgICAKICAgIC5JbnB1dHMKICAgIFtzdHJpbmddIEdyb3VwTmFtZQoKICAgIC5PdXRwdXRzCiAgICBbc3RyaW5nXSBtb2RpZmllZCBncm91cCBuYW1lCgogICAgLkxpbmsKICAgIEdldCB0aGUgbGF0ZXN0IHZlcnNpb24gb2YgdGhpcyBzY3JpcHQgZnJvbSB0aGUgZm9sbG93aW5nIFVSTDoKICAgIGh0dHA6Ly9pc2Rzdm4ud2VsbHNmYXJnby5jb20vc3ZuL3NtdF9zZGwvYnJhbmNoZXMvc210X3NkbF9hZG1pbi9hZG1pbmlzdHJhdGlvbi9vcHQvYXBwcy9zY3JpcHRzL3Bvd2Vyc2hlbGwvbW9kdWxlcy9UcmlkaW9uLVByb2R1Y3Rpb25TdXBwb3J0L1Byb2R1Y3Rpb25TdXBwb3J0LnBzbTEKCiAgICAuRXhhbXBsZQogICAgVEJECgogICAgIz4KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlLCBWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldCiAgICAgICAgJEdyb3VwTmFtZQogICAgKQoKICAgIFByb2Nlc3MKICAgIHsKICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJEdyb3VwTmFtZSkpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJHcm91cCBOYW1lIGlzIGVtcHR5LiIKICAgICAgICAgICAgcmV0dXJuICRudWxsCiAgICAgICAgfQogICAgICAgICRwb3MgPSAkR3JvdXBOYW1lLkluZGV4T2YoIigiKQogICAgICAgIGlmICgkcG9zIC1ndCAwKQogICAgICAgIHsKICAgICAgICAgICAgJEdyb3VwTmFtZSA9ICRHcm91cE5hbWUuU3Vic3RyaW5nKDAsJHBvcykKICAgICAgICB9CgogICAgICAgICNkZWxldGUgdGhpcyBzdHVmZgogICAgICAgICMkY2hhckFycmF5ID0gW2NoYXJbXV0kR3JvdXBOYW1lCiAgICAgICAgI2ZvcmVhY2ggKCRjaGFyIGluICRjaGFyQXJyYXkpCiAgICAgICAgI3sKICAgICAgICAjICAgIFdyaXRlLVZlcmJvc2UgKCJjaGFyIHswfSAtLSB7MX0iIC1mICRjaGFyLFtpbnRdJGNoYXIpCiAgICAgICAgI30KCiAgICAgICAgJGVtRGFzaCA9IFtjaGFyXTY1NTMzCiAgICAgICAgIyRlbk9yRW1EYXNoID0gW2NoYXJdMHgyMDE0CiAgICAgICAgJEdyb3VwTmFtZSA9ICRHcm91cE5hbWUuVHJpbSgpLlJlcGxhY2UoJGVtRGFzaCwiLSIpCiAgICAgICAgcmV0dXJuICRHcm91cE5hbWUKICAgIH0KfQoKCgpGdW5jdGlvbiBJbXBvcnQtVHJpZGlvbkdyb3Vwc0Zyb21GaWxlCnsgICAgPCMKICAgIC5TeW5vcHNpcwogICAgaW1wb3J0cyB0aGUgZ3JvdXBzIGZyb20gQ1NWIGZpbGUKCiAgICAuRGVzY3JpcHRpb24KICAgIFRCRAoKICAgIC5Ob3RlcwogICAgVEJECgogICAgLklucHV0cwogICAgVEJECgogICAgLk91dHB1dHMKICAgIFRCRAoKICAgIC5MaW5rCiAgICBHZXQgdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIHRoaXMgc2NyaXB0IGZyb20gdGhlIGZvbGxvd2luZyBVUkw6CiAgICBUQkQKCiAgICAuRXhhbXBsZQogICAgVEJECgogICAgIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1RyaWRpb24uQ29udGVudE1hbmFnZXIuQ29yZVNlcnZpY2UuQ2xpZW50Lkdyb3VwRGF0YVtdXSRBbGxHcm91cHMsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtUcmlkaW9uLkNvbnRlbnRNYW5hZ2VyLkNvcmVTZXJ2aWNlLkNsaWVudC5QdWJsaWNhdGlvbkRhdGFbXV0kQWxsUHVibGljYXRpb25zLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kVGl0bGUsCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSREZXNjcmlwdGlvbiwKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUpXQogICAgICAgIFtzdHJpbmddJFNjb3BlLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kR3JvdXBNZW1iZXJzaGlwcwoKICAgICkKICAgIAogICAgUHJvY2VzcwogICAgewoKICAgICAgICAgICAgJG1lbWJlck9mV2l0aFJlc3RyaWN0aW9ucz1Ae30KICAgICAgICAgICAgJG1lbWJlck9mTm9SZXN0cmljdGlvbnM9QCgpCiAgICAgICAgICAgICNOZWVkIHRvIEdyb3VwTWVtYmVyc2hpcHMuLi4KICAgICAgICAgICAgaWYgKCgkR3JvdXBNZW1iZXJzaGlwcyAtbmUgJG51bGwpIC1hbmQgKCRHcm91cE1lbWJlcnNoaXBzLkxlbmd0aCAtZ3QgMCkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRzY29wZUxpc3QgPSAkR3JvdXBNZW1iZXJzaGlwcy5zcGxpdCgkZGVsaW0pCgoKCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkbGluZSBpbiAkc2NvcGVMaXN0KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgImFuYWx5emluZyBzY29wZSBncm91cCBtZW1iZXI6ICRsaW5lIgogICAgICAgICAgICAgICAgICAgICRzY29wZVB1YiA9IEdldC1UcmlkaW9uU2NvcGVTcGVjaWZpY2F0aW9uIC1Hcm91cE5hbWUgJGxpbmUKICAgICAgICAgICAgICAgICAgICAkc2NvcGVHcm91cE5hbWUgPSBHZXQtRml4ZWRUcmlkaW9uR3JvdXBOYW1lIC1Hcm91cE5hbWUgJGxpbmUKICAgICAgICAgICAgICAgICAgICAjV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAic2NvcGUgZ3JvdXA6ICRzY29wZUdyb3VwIgogICAgICAgICAgICAgICAgICAgICNXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJzY29wZSBwdWJsaWNhdGlvbjogJHNjb3BlUHViIgogICAgICAgICAgICAgICAgICAgICMyIGNhc2VzLCBoYXZlIHB1YmxpY2F0aW9uIHNwZWNpZmllZCBmb3Igc2NvcGUgb3Igbm90IChhbGwgcHVicykKCiAgICAgICAgICAgICAgICAgICAgJHNjb3BlR3JvdXAgPSBHZXQtVHJpZGlvbkdyb3VwIC1Hcm91cE5hbWUgJHNjb3BlR3JvdXBOYW1lIC1BbGxHcm91cHMgJEFsbEdyb3VwcwogICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGVHcm91cCAtbmUgJG51bGwpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHNjb3BlUHViKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgI2FsbCBwdWJzIGNhc2UhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWVtYmVyT2ZOb1Jlc3RyaWN0aW9ucyArPSAoJHNjb3BlR3JvdXAuSWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJBZGRpbmcgJHNjb3BlR3JvdXBOYW1lIHRvIGJlIFVucmVzdHJpY3RlZCBNZW1iZXIgT2YiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkd2hhdFB1YnMgPSBAKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRwdWJOYW1lIGluICgkc2NvcGVQdWIuc3BsaXQoJGRlbGltSW5uZXIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcHViID0gR2V0LVRyaWRpb25QdWJsaWNhdGlvbiAtTmFtZSAkcHViTmFtZSAtQWxsUHVibGljYXRpb25zICRBbGxQdWJsaWNhdGlvbnMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHB1YiAtbmUgJG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkd2hhdFB1YnMgKz0gKCRwdWIuSWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgLU1lc3NhZ2UgIlRoZXJlIGlzIG5vIHB1YmxpY2F0aW9uOiAkcHViTmFtZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWVtYmVyT2ZXaXRoUmVzdHJpY3Rpb25zLkFkZCgoJHNjb3BlR3JvdXAuSWQpLCR3aGF0UHVicykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkFkZGluZyB0byAkc2NvcGVHcm91cE5hbWUgdG8gYmUgUmVzdHJpY3RlZCBNZW1iZXJzaGlwIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgLU1lc3NhZ2UgIlRoZXJlIGlzIG5vIHN1Y2ggZ3JvdXAgYXMgJHNjb3BlR3JvdXBOYW1lIgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiTm8gR3JvdXBNZW1iZXJzaGlwcyBwYXNzZWQgaW4iCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNuZWVkIHRvIGhhbmRsZSEhISEKICAgICAgICAgICAgJHNjb3BlcyA9IEAoKQoKICAgICAgICAgICAgaWYgKCgkU2NvcGUgLW5lICRudWxsKSAtYW5kICgkU2NvcGUuTGVuZ3RoIC1ndCAwKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZm9yZWFjaCAoJGxpbmUgaW4gKCRTY29wZS5zcGxpdCgkZGVsaW0pKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkcHViID0gR2V0LVRyaWRpb25QdWJsaWNhdGlvbiAtTmFtZSAkbGluZSAtQWxsUHVibGljYXRpb25zICRBbGxQdWJsaWNhdGlvbnMKICAgICAgICAgICAgICAgICAgICAkc2NvcGVzICs9ICRwdWIuSWQKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJObyBTY29wZSBsaW1pdGF0aW9uIHBhc3NlZCBpbiIKICAgICAgICAgICAgfQoKCiAgICAgICAgaWYgKChHZXQtVHJpZGlvbkdyb3VwIC1Hcm91cE5hbWUgJFRpdGxlKSAtZXEgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICBOZXctVHJpZGlvbkdyb3VwIGAKICAgICAgICAgICAgICAgIC1OYW1lICRUaXRsZSBgCiAgICAgICAgICAgICAgICAtRGVzY3JpcHRpb24gJERlc2NyaXB0aW9uIGAKICAgICAgICAgICAgICAgIC1TY29wZSAkc2NvcGVzIGAKICAgICAgICAgICAgICAgIC1SZXN0cmljdGVkTWVtYmVyT2YgJG1lbWJlck9mV2l0aFJlc3RyaWN0aW9ucyBgCiAgICAgICAgICAgICAgICAtTWVtYmVyT2YgJG1lbWJlck9mTm9SZXN0cmljdGlvbnMgYAogICAgICAgICAgICAgICAgLVZlcmJvc2UKCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICN0aGVuIHdlIGRvIGFuIHVwZGF0ZSEhISAKICAgICAgICAgICAgVXBkYXRlLVRyaWRpb25Hcm91cCBgCiAgICAgICAgICAgICAgICAtR3JvdXBOYW1lICRUaXRsZSBgCiAgICAgICAgICAgICAgICAtRGVzY3JpcHRpb24gJERlc2NyaXB0aW9uIGAKICAgICAgICAgICAgICAgIC1TY29wZSAkc2NvcGVzIGAKICAgICAgICAgICAgICAgIC1SZXN0cmljdGVkTWVtYmVyT2YgJG1lbWJlck9mV2l0aFJlc3RyaWN0aW9ucyBgCiAgICAgICAgICAgICAgICAtTWVtYmVyT2YgJG1lbWJlck9mTm9SZXN0cmljdGlvbnMgYAogICAgICAgICAgICAgICAgLVJlbW92ZUV4aXN0aW5nU2NvcGUgYAogICAgICAgICAgICAgICAgLVJlbW92ZUV4aXN0aW5nTWVtYmVyT2YgYAogICAgICAgICAgICAgICAgLVZlcmJvc2UKICAgICAgICB9CgogICAgfQp9CgoKCmZ1bmN0aW9uIE91dC1DU1ZGaWxlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbc3RyaW5nXSREaXJlY3RvcnksCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtzdHJpbmddJEZpbGVOYW1lLAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlLFZhbHVlRnJvbVBpcGVsaW5lPSR0cnVlKV0KICAgICAgICAkRGF0YQogICAgKQogICAgUHJvY2VzcwogICAgewogICAgICAgIGlmICgtTm90IChUZXN0LVBhdGggJERpcmVjdG9yeSAtUGF0aFR5cGUgQ29udGFpbmVyKSkKICAgICAgICB7CiAgICAgICAgICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICREaXJlY3RvcnkKICAgICAgICB9CiAgICAgICREYXRhIHwgRXhwb3J0LUNTViAtUGF0aCAoJERpcmVjdG9yeSArICJcIiArICRGaWxlTmFtZSArICIuY3N2IikgLVVzZUN1bHR1cmUgLUVuY29kaW5nIFVURjggLU5vVHlwZUluZm9ybWF0aW9uCiAgICB9Cn0KCgoKCjwjCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiogUHVibGljIG1lbWJlcnMKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIz4KCkZ1bmN0aW9uIEV4cG9ydC1UcmlkaW9uRFRBUEFzc2V0cwp7ICAgIDwjCiAgICAuU3lub3BzaXMKICAgIEV4cG9ydHMgc3BlY2lmaWVkIGl0ZW1zIHRvIENTViBmaWxlIGZvciBsYXRlciBpbXBvcnQgdG8gIm5leHQiIGVudmlyb25tZW50CgogICAgLkRlc2NyaXB0aW9uCiAgICBUQkQKCiAgICAuTm90ZXMKICAgIFRCRAoKICAgIC5JbnB1dHMKICAgICAgICBbc3RyaW5nW11dVGNtSWRPcldlYkRhdlVybHMgLSBsaXN0IG9mIFRDTS1JRHMgb3IgV2ViRGF2VXJscyBvZiBpdGVtcyB0byBleHBvcnQKICAgICAgICBbc3dpdGNoXVJlY3Vyc2l2ZSAtIGZsYWcgdG8gaW5kaWNhdGUgcmVjdXJzaXZlIG9wZXJhdGlvbiBvbiBGb2xkZXJzIGFuZCBTdHJ1Y3R1cmUgR3JvdXBzCiAgICAgICAgW3N0cmluZ11EaXJlY3RvcnkgLSBmdWxsIHBhdGggdG8gd3JpdGUgQ1NWIGZpbGVzCgogICAgLk91dHB1dHMKICAgIE5vbmUsIGV4cG9ydHMgQ1NWIGZpbGVzIHRvIHNwZWNpZmllZCBkaXJlY3RvcnkKCiAgICAuTGluawogICAgR2V0IHRoZSBsYXRlc3QgdmVyc2lvbiBvZiB0aGlzIHNjcmlwdCBmcm9tIHRoZSBmb2xsb3dpbmcgVVJMOgogICAgVEJECgogICAgLkV4YW1wbGUKICAgICRhc3NldHMgPSBAKCkKICAgICRhbGxHcm91cHMgPSBHZXQtVHJpZGlvbkdyb3VwcyAtSWRUaXRsZU9ubHkKICAgICRhc3NldHMgKz0gKEdldC1UcmlkaW9uR3JvdXAgLUdyb3VwTmFtZSAiW3JpZ2h0c10gQXV0aG9yIC0gQ29udGVudCIgLUFsbEdyb3VwcyAkYWxsR3JvdXBzKS5JZAogICAgJGFzc2V0cyArPSAoR2V0LVRyaWRpb25Hcm91cCAtR3JvdXBOYW1lICJbYWNsXSBkZWZhdWx0X3NlY3VyZV9jb250ZW50X2FjbF9sIiAtQWxsR3JvdXBzICRhbGxHcm91cHMpLklkCiAgICAkYXNzZXRzICs9ICJcUzA3MCBQdWJsaWMgU2l0ZSBVUyBFbmdsaXNoXEhvbWVcdGVzdCIKICAgICRhc3NldHMgKz0gIlxDMDQwIExvY2FsIFB1YmxpYyBDb250ZW50IFVTIEVuZ2xpc2hcQnVpbGRpbmcgQmxvY2tzXENvbnRlbnRcdGVzdCIKICAgIEV4cG9ydC1UcmlkaW9uRFRBUEFzc2V0cyBgCgkgICAgLVRjbUlkT3JXZWJEYXZVcmxzICRhc3NldHMgYAoJICAgIC1SZWN1cnNpdmUgYAoJICAgIC1EaXJlY3RvcnkgIkQ6XG9wdFxhcHBzXHNjcmlwdHNccG93ZXJzaGVsbFxvdXRwdXRcZHRhcCIgYAoJICAgIC1WZXJib3NlCgogICAgCiAgICAjPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlLFZhbHVlRnJvbVBpcGVsaW5lPSR0cnVlKV0KICAgICAgICBbc3RyaW5nW11dJFRjbUlkT3JXZWJEYXZVcmxzLAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbc3dpdGNoXSRSZWN1cnNpdmUsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtzdHJpbmddJERpcmVjdG9yeQogICAgKQogICAgCiAgICBQcm9jZXNzCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiUHJlcGFyaW5nIHRvIGluc3BlY3QgYXNzZXRzIgoKICAgICAgICAkZm9sZGVycyA9IEAoKQogICAgICAgICRzZ3MgPSBAKCkKICAgICAgICAkZ3JvdXBzID0gQCgpCiAgICAgICAgZm9yZWFjaCAoJFRjbUlkT3JXZWJEYXZVcmwgaW4gJFRjbUlkT3JXZWJEYXZVcmxzKQogICAgICAgIHsKICAgICAgICAgICAgJHRyaWRpb25PYmplY3QgPSBHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRUY21JZE9yV2ViRGF2VXJsCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkxvYWRlZCBUcmlkaW9uIEl0ZW06ICQoJHRyaWRpb25PYmplY3QuVGl0bGUpIgogICAgICAgICAgICBpZiAoJHRyaWRpb25PYmplY3QgLW5lICRudWxsKQogICAgICAgICAgICB7CgogICAgICAgICAgICBpZiAoJHRyaWRpb25PYmplY3QuR2V0VHlwZSgpLkZ1bGxOYW1lIC1lcSAiVHJpZGlvbi5Db250ZW50TWFuYWdlci5Db3JlU2VydmljZS5DbGllbnQuRm9sZGVyRGF0YSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkl0ZW0gaXMgYSBGb2xkZXIiCiAgICAgICAgICAgICAgICAkZm9sZGVycyArPSAkdHJpZGlvbk9iamVjdCAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICgkUmVjdXJzaXZlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRjaGlsZEZvbGRlcnMgPSBHZXQtVHJpZGlvbkZvbGRlcnNSZWN1cnNpdmVseSAtRm9sZGVyICR0cmlkaW9uT2JqZWN0ICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkY2hpbGRGb2xkZXIgaW4gJGNoaWxkRm9sZGVycykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRmb2xkZXJzICs9ICRjaGlsZEZvbGRlcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgkdHJpZGlvbk9iamVjdC5HZXRUeXBlKCkuRnVsbE5hbWUgLWVxICJUcmlkaW9uLkNvbnRlbnRNYW5hZ2VyLkNvcmVTZXJ2aWNlLkNsaWVudC5TdHJ1Y3R1cmVHcm91cERhdGEiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJJdGVtIGlzIGEgU3RydWN0dXJlIEdyb3VwIgogICAgICAgICAgICAgICAgJHNncyArPSAkdHJpZGlvbk9iamVjdCAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICgkUmVjdXJzaXZlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRjaGlsZFNHcyA9IEdldC1UcmlkaW9uU3RydWN0dXJlR3JvdXBzUmVjdXJzaXZlbHkgLVN0cnVjdHVyZUdyb3VwICR0cmlkaW9uT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGNoaWxkU0cgaW4gJGNoaWxkU0dzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHNncyArPSAkY2hpbGRTRwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCR0cmlkaW9uT2JqZWN0LkdldFR5cGUoKS5GdWxsTmFtZSAtZXEgIlRyaWRpb24uQ29udGVudE1hbmFnZXIuQ29yZVNlcnZpY2UuQ2xpZW50Lkdyb3VwRGF0YSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkl0ZW0gaXMgYSBHcm91cCIKICAgICAgICAgICAgICAgICRncm91cHMgKz0gJHRyaWRpb25PYmplY3QgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgLU1lc3NhZ2UgIlVuYWJsZSB0byBmaW5kIGl0ZW06ICRUY21JZE9yV2ViRGF2VXJsIgogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJQcmVwYXJpbmcgdG8gZG8gZXhwb3J0cyIKICAgICAgICBpZiAoJGZvbGRlcnMuQ291bnQgLWd0IDApCiAgICAgICAgewogICAgICAgICAgICAkZm9sZGVyRGF0YSA9IEAoKQogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJUaGVyZSBhcmUgZm9sZGVycywgZ29pbmcgdG8gZXhwb3J0IGZvbGRlciBkYXRhIgogICAgICAgICAgICBmb3JlYWNoICgkZm9sZGVyIGluICRmb2xkZXJzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJQcm9jZXNzaW5nIGZvbGRlcjogJCgkZm9sZGVyLlRpdGxlKSIKICAgICAgICAgICAgICAgICRyb3dEYXRhID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QKICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiVGl0bGUiIC1WYWx1ZSAoJGZvbGRlci5UaXRsZSkKICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiV2ViZGF2IiAtVmFsdWUgKCRmb2xkZXIuTG9jYXRpb25JbmZvLldlYkRhdlVybCkKCiAgICAgICAgICAgICAgICBpZiAoJGZvbGRlci5NZXRhZGF0YVNjaGVtYSAtZXEgJG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJNZXRhZGF0YVNjaGVtYSIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJG1ldGFEYXRhU2NoZW1hID0gR2V0LVRyaWRpb25JdGVtIC1JZE9yUGF0aCAkZm9sZGVyLk1ldGFkYXRhU2NoZW1hLklkUmVmCiAgICAgICAgICAgICAgICAgICAgaWYgKCRtZXRhRGF0YVNjaGVtYSAtbmUgJG51bGwpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhU2NoZW1hIiAtVmFsdWUgKCRtZXRhRGF0YVNjaGVtYS5Mb2NhdGlvbkluZm8uV2ViRGF2VXJsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhU2NoZW1hIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAtTWVzc2FnZSAiVW5hYmxlIHRvIGZpbmQgTWV0YWRhdGEgU2NoZW1hOiAkKCRmb2xkZXIuTWV0YWRhdGFTY2hlbWEuSWRSZWYpIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgkZm9sZGVyLk1ldGFkYXRhIC1lcSAkbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhIiAtVmFsdWUgKCRmb2xkZXIuTWV0YWRhdGEpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoJGZvbGRlci5MaW5rZWRTY2hlbWEgLWVxICRudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiTGlua2VkU2NoZW1hIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkbGlua2VkU2NoZW1hID0gR2V0LVRyaWRpb25JdGVtIC1JZE9yUGF0aCAkZm9sZGVyLkxpbmtlZFNjaGVtYS5JZFJlZgogICAgICAgICAgICAgICAgICAgIGlmICgkbGlua2VkU2NoZW1hIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiTGlua2VkU2NoZW1hIiAtVmFsdWUgKCRsaW5rZWRTY2hlbWEuTG9jYXRpb25JbmZvLldlYkRhdlVybCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJMaW5rZWRTY2hlbWEiIC1WYWx1ZSAiIgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nIC1NZXNzYWdlICJVbmFibGUgdG8gZmluZCBMaW5rZWQgU2NoZW1hOiAkKCRmb2xkZXIuTGlua2VkU2NoZW1hLklkUmVmKSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoJGZvbGRlci5Jc0xpbmtlZFNjaGVtYU1hbmRhdG9yeSAtZXEgJGZhbHNlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiSXNMaW5rZWRTY2hlbWFNYW5kYXRvcnkiIC1WYWx1ZSAiZmFsc2UiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc0xpbmtlZFNjaGVtYU1hbmRhdG9yeSIgLVZhbHVlICJ0cnVlIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCRmb2xkZXIuSXNQZXJtaXNzaW9uc0luaGVyaXRhbmNlUm9vdCAtZXEgJGZhbHNlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiSXNQZXJtaXNzaW9uc0luaGVyaXRhbmNlUm9vdCIgLVZhbHVlICJmYWxzZSIKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIkFDTCIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc1Blcm1pc3Npb25zSW5oZXJpdGFuY2VSb290IiAtVmFsdWUgInRydWUiCgogICAgICAgICAgICAgICAgICAgICNuZWVkIHRvIGdldCBhbGwgaXRzIEFDTCBhbmQgZXhwb3J0CiAgICAgICAgICAgICAgICAgICAgJGFjbEVudHJpZXM9JGZvbGRlci5BY2Nlc3NDb250cm9sTGlzdC5BY2Nlc3NDb250cm9sRW50cmllcwogICAgICAgICAgICAgICAgICAgICRhY2xPdXRwdXQgPSAiIgoKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkYWNsRW50cnkgaW4gJGFjbEVudHJpZXMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkZ3JvdXAgPSBHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRhY2xFbnRyeS5UcnVzdGVlLklkUmVmCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkYWNsT3V0cHV0Lkxlbmd0aCAtZ3QgMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjbE91dHB1dCArPSAkZGVsaW0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkYWNsT3V0cHV0ICs9ICgkZ3JvdXAuVGl0bGUgKyAiKCIgKyAkYWNsRW50cnkuQWxsb3dlZFBlcm1pc3Npb25zICsgIikiKQogICAgICAgICAgICAgICAgICAgIH0KCgoKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIkFDTCIgLVZhbHVlICRhY2xPdXRwdXQKCiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgICRmb2xkZXJEYXRhICs9ICRyb3dEYXRhCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE91dC1DU1ZGaWxlIC1EaXJlY3RvcnkgJERpcmVjdG9yeSAtRmlsZU5hbWUgIkZvbGRlcnMiIC1EYXRhICRmb2xkZXJEYXRhCgogICAgICAgIH0KICAgICAgICBpZiAoJHNncy5Db3VudCAtZ3QgMCkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlRoZXJlIGFyZSBTdHJ1Y3R1cmUgR3JvdXBzLCBnb2luZyB0byBleHBvcnQgU0cgZGF0YSIKICAgICAgICAgICAgJHNnRGF0YSA9IEAoKQogICAgICAgICAgICBmb3JlYWNoICgkc2cgaW4gJHNncykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiUHJvY2Vzc2luZyBTRzogJCgkc2cuVGl0bGUpIgogICAgICAgICAgICAgICAgJHJvd0RhdGEgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdAogICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJUaXRsZSIgLVZhbHVlICgkc2cuVGl0bGUpCiAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIldlYmRhdiIgLVZhbHVlICgkc2cuTG9jYXRpb25JbmZvLldlYkRhdlVybCkKICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiRGlyZWN0b3J5IiAtVmFsdWUgKCRzZy5EaXJlY3RvcnkpCgoKICAgICAgICAgICAgICAgIGlmICgkc2cuSXNEZWZhdWx0UGFnZVRlbXBsYXRlSW5oZXJpdGVkIC1lcSAkZmFsc2UpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc0RlZmF1bHRQYWdlVGVtcGxhdGVJbmhlcml0ZWQiIC1WYWx1ZSAiZmFsc2UiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc0RlZmF1bHRQYWdlVGVtcGxhdGVJbmhlcml0ZWQiIC1WYWx1ZSAidHJ1ZSIKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJHNnLkRlZmF1bHRQYWdlVGVtcGxhdGUgLWVxICRudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiRGVmYXVsdFBhZ2VUZW1wbGF0ZSIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJGRlZmF1bHRQYWdlVGVtcGxhdGUgPSBHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRzZy5EZWZhdWx0UGFnZVRlbXBsYXRlLklkUmVmCiAgICAgICAgICAgICAgICAgICAgaWYgKCRkZWZhdWx0UGFnZVRlbXBsYXRlIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiRGVmYXVsdFBhZ2VUZW1wbGF0ZSIgLVZhbHVlICgkZGVmYXVsdFBhZ2VUZW1wbGF0ZS5Mb2NhdGlvbkluZm8uV2ViRGF2VXJsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIkRlZmF1bHRQYWdlVGVtcGxhdGUiIC1WYWx1ZSAiIgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nIC1NZXNzYWdlICJVbmFibGUgdG8gZmluZCBEZWZhdWx0IFBhZ2UgVGVtcGxhdGU6ICQoJHNnLkRlZmF1bHRQYWdlVGVtcGxhdGUuSWRSZWYpIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJHNnLlBhZ2VCdW5kbGVQcm9jZXNzIC1lcSAkbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIlBhZ2VCdW5kbGVQcm9jZXNzIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIlBhZ2VCdW5kbGVQcm9jZXNzIiAtVmFsdWUgKCRzZy5QYWdlQnVuZGxlUHJvY2Vzcy5UaXRsZSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoKCRzZy5QYWdlUHJvY2VzcyAtZXEgJG51bGwpIC1vciAoJHNnLlBhZ2VQcm9jZXNzLklkUmVmIC1lcSAidGNtOjAtMC0wIikpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJQYWdlUHJvY2VzcyIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJHBhZ2VQcm9jZXNzID0gR2V0LVRyaWRpb25JdGVtIC1JZE9yUGF0aCAkc2cuUGFnZVByb2Nlc3MuSWRSZWYKICAgICAgICAgICAgICAgICAgICBpZiAoJHBhZ2VQcm9jZXNzIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiUGFnZVByb2Nlc3MiIC1WYWx1ZSAoJHBhZ2VQcm9jZXNzLkxvY2F0aW9uSW5mby5XZWJEYXZVcmwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiUGFnZVByb2Nlc3MiIC1WYWx1ZSAiIgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nIC1NZXNzYWdlICJVbmFibGUgdG8gZmluZCBQYWdlIFByb2Nlc3M6ICQoJHNnLlBhZ2VQcm9jZXNzLklkUmVmKSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCRzZy5NZXRhZGF0YVNjaGVtYSAtZXEgJG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJNZXRhZGF0YVNjaGVtYSIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJG1ldGFEYXRhU2NoZW1hID0gR2V0LVRyaWRpb25JdGVtIC1JZE9yUGF0aCAkc2cuTWV0YWRhdGFTY2hlbWEuSWRSZWYKICAgICAgICAgICAgICAgICAgICBpZiAoJG1ldGFEYXRhU2NoZW1hIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiTWV0YWRhdGFTY2hlbWEiIC1WYWx1ZSAoJG1ldGFEYXRhU2NoZW1hLkxvY2F0aW9uSW5mby5XZWJEYXZVcmwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiTWV0YWRhdGFTY2hlbWEiIC1WYWx1ZSAiIgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nIC1NZXNzYWdlICJVbmFibGUgdG8gZmluZCBNZXRhZGF0YSBTY2hlbWE6ICQoJHNnLk1ldGFkYXRhU2NoZW1hLklkUmVmKSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoJHNnLk1ldGFkYXRhIC1lcSAkbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIk1ldGFkYXRhIiAtVmFsdWUgKCRzZy5NZXRhZGF0YSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoJHNnLklzQWN0aXZlIC1lcSAkZmFsc2UpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc0FjdGl2ZSIgLVZhbHVlICJmYWxzZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIklzQWN0aXZlIiAtVmFsdWUgInRydWUiCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCRzZy5Jc1Blcm1pc3Npb25zSW5oZXJpdGFuY2VSb290IC1lcSAkZmFsc2UpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJJc1Blcm1pc3Npb25zSW5oZXJpdGFuY2VSb290IiAtVmFsdWUgImZhbHNlIgogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiQUNMIiAtVmFsdWUgIiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIklzUGVybWlzc2lvbnNJbmhlcml0YW5jZVJvb3QiIC1WYWx1ZSAidHJ1ZSIKCiAgICAgICAgICAgICAgICAgICAgI25lZWQgdG8gZ2V0IGFsbCBpdHMgQUNMIGFuZCBleHBvcnQKICAgICAgICAgICAgICAgICAgICAkYWNsRW50cmllcz0kc2cuQWNjZXNzQ29udHJvbExpc3QuQWNjZXNzQ29udHJvbEVudHJpZXMKICAgICAgICAgICAgICAgICAgICAkYWNsT3V0cHV0ID0gIiIKCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJGFjbEVudHJ5IGluICRhY2xFbnRyaWVzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRhY2xFbnRyeS5BbGxvd2VkUGVybWlzc2lvbnMgLW5lICJOb25lIikKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGdyb3VwID0gR2V0LVRyaWRpb25JdGVtIC1JZE9yUGF0aCAkYWNsRW50cnkuVHJ1c3RlZS5JZFJlZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRhY2xPdXRwdXQuTGVuZ3RoIC1ndCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY2xPdXRwdXQgKz0gJGRlbGltCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWNsT3V0cHV0ICs9ICgkZ3JvdXAuVGl0bGUgKyAiKCIgKyAkYWNsRW50cnkuQWxsb3dlZFBlcm1pc3Npb25zICsgIikiKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKCgogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiQUNMIiAtVmFsdWUgJGFjbE91dHB1dAoKICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgJHNnRGF0YSArPSAkcm93RGF0YQogICAgICAgICAgICB9CiAgICAgICAgICAgIE91dC1DU1ZGaWxlIC1EaXJlY3RvcnkgJERpcmVjdG9yeSAtRmlsZU5hbWUgIlN0cnVjdHVyZUdyb3VwcyIgLURhdGEgJHNnRGF0YQogICAgICAgIH0KICAgICAgICBpZiAoJGdyb3Vwcy5Db3VudCAtZ3QgMCkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlRoZXJlIGFyZSBHcm91cHMsIGdvaW5nIHRvIGV4cG9ydCBHcm91cCBkYXRhIgogICAgICAgICAgICAkZ3JvdXBEYXRhID0gQCgpCiAgICAgICAgICAgIGZvcmVhY2ggKCRncm91cCBpbiAkZ3JvdXBzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjbmVlZCB0byBnZXQgdGhlIGZ1bGwgb2JqZWN0IChvbmx5IHBhcnRpYWxseSBsb2FkZWQpCiAgICAgICAgICAgICAgICAkZ3JvdXAgPSBHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRncm91cC5JZAogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiUHJvY2Vzc2luZyBncm91cDogJCgkZ3JvdXAuVGl0bGUpIgogICAgICAgICAgICAgICAgJHJvd0RhdGEgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBQU09iamVjdAogICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJUaXRsZSIgLVZhbHVlICgkZ3JvdXAuVGl0bGUpCiAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIkRlc2NyaXB0aW9uIiAtVmFsdWUgKCRncm91cC5EZXNjcmlwdGlvbikKCiAgICAgICAgICAgICAgICBpZiAoKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRncm91cC5TY29wZSkgLWVxICRudWxsKSAtb3IgKCRncm91cC5TY29wZS5jb3VudCAtZXEgMCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJTY29wZSIgLVZhbHVlICIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJHNjb3BlTGlzdCA9ICIiCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHNjb3BlRW50cnkgaW4gJGdyb3VwLlNjb3BlKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZUxpc3QuTGVuZ3RoIC1ndCAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGVMaXN0ICs9ICRkZWxpbQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZUxpc3QgKz0gJHNjb3BlRW50cnkuVGl0bGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJHJvd0RhdGEgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lICJTY29wZSIgLVZhbHVlICgkc2NvcGVMaXN0KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkZ3JvdXAuR3JvdXBNZW1iZXJzaGlwcykgLWVxICRudWxsKSAtb3IgKCRncm91cC5Hcm91cE1lbWJlcnNoaXBzLmNvdW50IC1lcSAwKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkcm93RGF0YSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgIkdyb3VwTWVtYmVyc2hpcHMiIC1WYWx1ZSAiIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRncm91cE1lbWJlcnNoaXBJbmZvID0gIiIKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkZ3JvdXBJbmZvIGluICRncm91cC5Hcm91cE1lbWJlcnNoaXBzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAibG9va2luZyBhdCBncm91cCBtZW1iZXJzaGlwOiAkZ3JvdXBJbmZvIgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGdyb3VwTWVtYmVyc2hpcEluZm8uTGVuZ3RoIC1ndCAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZ3JvdXBNZW1iZXJzaGlwSW5mbyArPSAkZGVsaW0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkZ3JvdXBNZW1iZXIgPSBHZXQtVHJpZGlvbkl0ZW0gLUlkT3JQYXRoICRncm91cEluZm8uR3JvdXAuSWRSZWYKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRncm91cE1lbWJlciAtbmUgJG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRncm91cE1lbWJlcnNoaXBJbmZvICs9ICRncm91cE1lbWJlci5UaXRsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlcyA9ICRncm91cEluZm8uU2NvcGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGVzIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGVJbmZvID0gIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkc2NvcGUgaW4gJHNjb3Blcyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGVJbmZvLkxlbmd0aCAtZ3QgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlSW5mbyArPSAkZGVsaW1Jbm5lcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwdWJsaWNhdGlvbiA9IEdldC1UcmlkaW9uSXRlbSAtSWRPclBhdGggJHNjb3BlLklkUmVmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcHVibGljYXRpb24gLW5lICRudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGVJbmZvICs9ICRwdWJsaWNhdGlvbi5UaXRsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAtTWVzc2FnZSAiVW5hYmxlIHRvIGZpbmQgcHVibGljYXRpb246ICQoJHNjb3BlLklkUmVmKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZ3JvdXBNZW1iZXJzaGlwSW5mbyArPSAiKCIgKyAkc2NvcGVJbmZvICsgIikiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nIC1NZXNzYWdlICJVbmFibGUgdG8gbG9jYXRlIGdyb3VwOiAkKCRncm91cEluZm8uR3JvdXAuSWRSZWYpIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRyb3dEYXRhIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSAiR3JvdXBNZW1iZXJzaGlwcyIgLVZhbHVlICgkZ3JvdXBNZW1iZXJzaGlwSW5mbykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgImdyb3VwIGRhdGEgbGVuZ3RoIHdhcyA6ICQoJGdyb3VwRGF0YS5jb3VudCkiCiAgICAgICAgICAgICAgICAkZ3JvdXBEYXRhICs9ICRyb3dEYXRhCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJncm91cCBkYXRhIGxlbmd0aCBub3c6ICQoJGdyb3VwRGF0YS5jb3VudCkiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE91dC1DU1ZGaWxlIC1EaXJlY3RvcnkgJERpcmVjdG9yeSAtRmlsZU5hbWUgIkdyb3VwcyIgLURhdGEgJGdyb3VwRGF0YQogICAgICAgICAgICAkR2xvYmFsOmdyb3VwRGF0YSA9ICRncm91cERhdGEKCiAgICAgICAgfQoKICAgIH0KfQoKRnVuY3Rpb24gSW1wb3J0LVRyaWRpb25EVEFQQXNzZXRzCnsgICAgPCMKICAgIC5TeW5vcHNpcwogICAgVEJECgogICAgLkRlc2NyaXB0aW9uCiAgICBUQkQKCiAgICAuTm90ZXMKICAgIFRCRAoKICAgIC5JbnB1dHMKICAgIFtzdHJpbmddRGlyZWN0b3J5IC0gdGhlIGRpcmVjdG9yeSBjb250YWluaW5nIHRoZSBleHBvcnRlZCBDU1YgZmlsZXMKCiAgICAuT3V0cHV0cwogICAgVEJECgogICAgLkxpbmsKICAgIEdldCB0aGUgbGF0ZXN0IHZlcnNpb24gb2YgdGhpcyBzY3JpcHQgZnJvbSB0aGUgZm9sbG93aW5nIFVSTDoKICAgIFRCRAoKICAgIC5FeGFtcGxlCiAgICBJbXBvcnQtVHJpZGlvbkRUQVBBc3NldHMgLURpcmVjdG9yeSAiRDpcb3B0XGFwcHNcc2NyaXB0c1xwb3dlcnNoZWxsXGRhdGFcZHRhcCIgLVZlcmJvc2UKICAgIAogICAgIz4KCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kRGlyZWN0b3J5CiAgICApCiAgICAKICAgIFByb2Nlc3MKICAgIHsKICAgICAgICAkYWxsR3JvdXBzID0gR2V0LVRyaWRpb25Hcm91cHMgLUlkVGl0bGVPbmx5CiAgICAgICAgJGFsbFB1YnMgPSBHZXQtVHJpZGlvblB1YmxpY2F0aW9ucyAtSWRUaXRsZU9ubHkKICAgICAgICBpZiAoVGVzdC1QYXRoIC1QYXRoICgkRGlyZWN0b3J5ICsgIlwiICsgIkZvbGRlcnMuY3N2IikpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJJbXBvcnRpbmcgRm9sZGVyIGRhdGEiCiAgICAgICAgICAgIEltcG9ydC1Dc3YgLVBhdGggKCREaXJlY3RvcnkgKyAiXCIgKyAiRm9sZGVycy5jc3YiKSB8IEltcG9ydC1UcmlkaW9uRm9sZGVyc0Zyb21GaWxlIC1BbGxHcm91cHMgJGFsbEdyb3VwcwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJObyBGb2xkZXIgZGF0YSBwcm92aWRlZCIKICAgICAgICB9CiAgICAgICAgaWYgKFRlc3QtUGF0aCAtUGF0aCAoJERpcmVjdG9yeSArICJcIiArICJTdHJ1Y3R1cmVHcm91cHMuY3N2IikpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJJbXBvcnRpbmcgU3RydWN0dXJlIEdyb3VwIGRhdGEiCiAgICAgICAgICAgIEltcG9ydC1Dc3YgLVBhdGggKCREaXJlY3RvcnkgKyAiXCIgKyAiU3RydWN0dXJlR3JvdXBzLmNzdiIpIHwgSW1wb3J0LVRyaWRpb25TdHJ1Y3R1cmVHcm91cHNGcm9tRmlsZSAtQWxsR3JvdXBzICRhbGxHcm91cHMKCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIk5vIFN0cnVjdHVyZSBHcm91cCBkYXRhIHByb3ZpZGVkIgogICAgICAgIH0KICAgICAgICBpZiAoVGVzdC1QYXRoIC1QYXRoICgkRGlyZWN0b3J5ICsgIlwiICsgIkdyb3Vwcy5jc3YiKSkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkltcG9ydGluZyBHcm91cCBkYXRhIgogICAgICAgICAgICBJbXBvcnQtQ3N2IC1QYXRoICgkRGlyZWN0b3J5ICsgIlwiICsgIkdyb3Vwcy5jc3YiKSB8IEltcG9ydC1UcmlkaW9uR3JvdXBzRnJvbUZpbGUgLUFsbEdyb3VwcyAkYWxsR3JvdXBzIC1BbGxQdWJsaWNhdGlvbnMgJGFsbFB1YnMKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiTm8gR3JvdXAgZGF0YSBwcm92aWRlZCIKICAgICAgICB9CiAgICB9Cn0KCjwjCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiogRXhwb3J0IHN0YXRlbWVudHMKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIz4KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uIEV4cG9ydC1UcmlkaW9uRFRBUEFzc2V0cwpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiBJbXBvcnQtVHJpZGlvbkRUQVBBc3NldHMKCg==
