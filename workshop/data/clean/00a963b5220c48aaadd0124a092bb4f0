MSFT_xSmaVariable.psm1,9f4ee390a5ff6c4dcbbe5f034e35c107,Scan result is 1. IsMalware: 0,ZGF0YSBMb2NhbGl6ZWREYXRhICAKeyAgCiAgICAjIGN1bHR1cmU9ImVuLVVTIiAgCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIC1TdHJpbmdEYXRhIEAnICAKIFZhcmlhYmxlRG9lc05vdE1hdGNoID0gdmFyaWFibGUgezB9IGhhcyB2YWx1ZSB7MX0gZXhwZWN0ZWQgezJ9LiAgCiBWYXJpYWJsZURlc2NyaXB0aW9uRG9lc05vdE1hdGNoID0gdmFyaWFibGUgezB9IGhhcyBkZXNjcmlwdGlvbiB7MX0gZXhwZWN0ZWQgezJ9LgogVmFyaWFibGVOb3RGb3VuZCA9IEZhaWxlZCB0byBmaW5kIHZhcmlhYmxlIHswfS4KJ0AgIAp9IAoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJHZhbHVlLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGVzY3JpcHRpb24sCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRXZWJTZXJ2aWNlRW5kcG9pbnQsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRQb3J0ID0gOTA5MAogICAgKQogICAgCiAgICAkU2V0ID0gJHRydWUKICAgIHRyeQogICAgewogICAgICAgICR2YXJpYWJsZSA9IEdldC1TbWFWYXJpYWJsZSAtTmFtZSAkTmFtZSAtV2ViU2VydmljZUVuZHBvaW50ICR3ZWJzZXJ2aWNlZW5kcG9pbnQgLXBvcnQgJHBvcnQgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgJEVuc3VyZSA9ICJQcmVzZW50IgoKICAgICAgICAjIGNoZWNrIHZhcmlhYmxlIHZhbHVlIG1hdGNoCiAgICAgICAgaWYoJHZhcmlhYmxlLlZhbHVlIC1uZSAkdmFsdWUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICggJCgkTG9jYWxpemVkRGF0YS5WYXJpYWJsZURvZXNOb3RNYXRjaCkgLWYgJE5hbWUsICR2YXJpYWJsZS5WYWx1ZSwgJHZhbHVlKQogICAgICAgICAgICAkU2V0ID0gJGZhbHNlCiAgICAgICAgfQoKICAgICAgICAjIGNoZWNrIGRlc2NyaXB0aW9uIG1hdGNoCiAgICAgICAgaWYoJHZhcmlhYmxlLkRlc2NyaXB0aW9uIC1uZSAkRGVzY3JpcHRpb24gKQogICAgICAgIHsKICAgICAgICAgICAgIyBjaGVjayBkZXNjcmlwdGlvbiBhcmUgbm90IHN1cHBvc2VkIHRvIGJlIGVtcHR5CiAgICAgICAgICAgIGlmKCAhKCgkdmFyaWFibGUuRGVzY3JpcHRpb24gLWVxICRudWxsKSAtYW5kICgkRGVzY3JpcHRpb24gLWVxICIiKSkgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoICQoJExvY2FsaXplZERhdGEuVmFyaWFibGVEZXNjcmlwdGlvbkRvZXNOb3RNYXRjaCkgLWYgJE5hbWUsICR2YXJpYWJsZS5EZXNjcmlwdGlvbiwgJERlc2NyaXB0aW9uKQogICAgICAgICAgICAgICAgJFNldCA9ICRmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICggJCgkTG9jYWxpemVkRGF0YS5WYXJpYWJsZU5vdEZvdW5kKSAtZiAkTmFtZSkKICAgICAgICAkU2V0ID0gJGZhbHNlCiAgICAgICAgJEVuc3VyZSA9ICJBYnNlbnQiCiAgICB9CiAgICAKICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgRW5zdXJlID0gW1N5c3RlbS5TdHJpbmddJEVuc3VyZQogICAgICAgIE5hbWUgPSBbU3lzdGVtLlN0cmluZ10kdmFyaWFibGUuTmFtZQogICAgICAgIHZhbHVlID0gW1N5c3RlbS5TdHJpbmddJHZhcmlhYmxlLlZhbHVlCiAgICAgICAgRGVzY3JpcHRpb24gPSBbU3lzdGVtLlN0cmluZ10kdmFyaWFibGUuRGVzY3JpcHRpb24KICAgICAgICBTZXQgPSBbU3lzdGVtLkJvb2xlYW5dJFNldAogICAgICAgIFdlYlNlcnZpY2VFbmRwb2ludCA9IFtTeXN0ZW0uU3RyaW5nXSRXZWJTZXJ2aWNlRW5kcG9pbnQKICAgICAgICBQb3J0ID0gW1N5c3RlbS5VSW50MzJdJFBvcnQKICAgIH0KCiAgICAkcmV0dXJuVmFsdWUKfQoKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJHZhbHVlLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGVzY3JpcHRpb24sCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRXZWJTZXJ2aWNlRW5kcG9pbnQsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRQb3J0ID0gOTA5MAogICAgKQoKICAgIElmKCRFbnN1cmUgLWVxICJQcmVzZW50IikKICAgIHsKICAgICAgICBTZXQtU21hVmFyaWFibGUgLU5hbWUgJE5hbWUgLVZhbHVlICR2YWx1ZSAtRGVzY3JpcHRpb24gJERlc2NyaXB0aW9uIC1XZWJTZXJ2aWNlRW5kcG9pbnQgJHdlYnNlcnZpY2VlbmRwb2ludCAtcG9ydCAkcG9ydCAtRXJyb3JBY3Rpb24gU3RvcAogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFJlbW92ZS1TbWFWYXJpYWJsZSAtTmFtZSAkTmFtZSAtV2ViU2VydmljZUVuZHBvaW50ICR3ZWJzZXJ2aWNlZW5kcG9pbnQgLXBvcnQgJHBvcnQgLUVycm9yQWN0aW9uIFN0b3AKICAgIH0KfQoKCmZ1bmN0aW9uIFRlc3QtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJHZhbHVlLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGVzY3JpcHRpb24sCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRXZWJTZXJ2aWNlRW5kcG9pbnQsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRQb3J0ID0gOTA5MAogICAgKQogICAgCiAgICAkcmVzdWx0ID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVycwoKICAgIGlmKCAoJEVuc3VyZSAtZXEgIlByZXNlbnQiKSAtYW5kICgkcmVzdWx0LkVuc3VyZSAtZXEgIlByZXNlbnQiKSAtYW5kICgkcmVzdWx0LnNldCAtZXEgJHRydWUpKQogICAgewogICAgICAgIHJldHVybiAkdHJ1ZQogICAgfQogICAgZWxzZWlmKCAoJHJlc3VsdC5FbnN1cmUgLWVxICJBYnNlbnQiKSAtYW5kICgkRW5zdXJlIC1lcSAiQWJzZW50IikgKQogICAgewogICAgICAgIHJldHVybiAkdHJ1ZQogICAgfQoKICAgIHJldHVybiAkZmFsc2UKfQoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uIEdldC1UYXJnZXRSZXNvdXJjZSwgU2V0LVRhcmdldFJlc291cmNlLCBUZXN0LVRhcmdldFJlc291cmNlCgo=
