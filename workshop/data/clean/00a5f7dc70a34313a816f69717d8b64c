VE_XD7Catalog.psm1,3e2a3c27440b50cacee1bffc9ffa1488,Scan result is 1. IsMalware: 0,SW1wb3J0LUxvY2FsaXplZERhdGEgLUJpbmRpbmdWYXJpYWJsZSBsb2NhbGl6ZWREYXRhIC1GaWxlTmFtZSBWRV9YRDdDYXRhbG9nLlJlc291cmNlcy5wc2QxOwoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUGVybWFuZW50JywnUmFuZG9tJywnU3RhdGljJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRBbGxvY2F0aW9uLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdNYW51YWwnLCdQVlMnLCdNQ1MnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFByb3Zpc2lvbmluZywKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnRGlzY2FyZCcsJ0xvY2FsJywnUFZEJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRQZXJzaXN0ZW5jZSwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbU3lzdGVtLkJvb2xlYW5dICRJc011bHRpU2Vzc2lvbiA9ICRmYWxzZSwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtBbGxvd051bGwoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJERlc2NyaXB0aW9uLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkUHZzQWRkcmVzcywKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtBbGxvd051bGwoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFB2c0RvbWFpbiwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkRW5zdXJlID0gJ1ByZXNlbnQnLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5DcmVkZW50aWFsQXR0cmlidXRlKCldCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKICAgIGJlZ2luIHsKCiAgICAgICAgQXNzZXJ0WERNb2R1bGUgLU5hbWUgJ0NpdHJpeC5Ccm9rZXIuQWRtaW4uVjInIC1Jc1NuYXBpbjsKCiAgICB9CiAgICBwcm9jZXNzIHsKCiAgICAgICAgJHNjcmlwdEJsb2NrID0gewoKICAgICAgICAgICAgQWRkLVBTU25hcGluIC1OYW1lICdDaXRyaXguQnJva2VyLkFkbWluLlYyJyAtRXJyb3JBY3Rpb24gU3RvcDsKICAgICAgICAgICAgJGJyb2tlckNhdGFsb2cgPSBHZXQtQnJva2VyQ2F0YWxvZyAtTmFtZSAkdXNpbmc6TmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsKCiAgICAgICAgICAgICR0YXJnZXRSZXNvdXJjZSA9IEB7CiAgICAgICAgICAgICAgICBOYW1lID0gJGJyb2tlckNhdGFsb2cuTmFtZTsKICAgICAgICAgICAgICAgIEFsbG9jYXRpb24gPSBbU3lzdGVtLlN0cmluZ10gJGJyb2tlckNhdGFsb2cuQWxsb2NhdGlvblR5cGU7CiAgICAgICAgICAgICAgICBQcm92aXNpb25pbmcgPSBbU3lzdGVtLlN0cmluZ10gJGJyb2tlckNhdGFsb2cuUHJvdmlzaW9uaW5nVHlwZTsKICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uID0gJGJyb2tlckNhdGFsb2cuRGVzY3JpcHRpb247CiAgICAgICAgICAgICAgICBQdnNBZGRyZXNzID0gJGJyb2tlckNhdGFsb2cuUHZzQWRkcmVzczsKICAgICAgICAgICAgICAgIFB2c0RvbWFpbiA9ICRicm9rZXJDYXRhbG9nLlB2c0RvbWFpbjsKICAgICAgICAgICAgICAgIElzTXVsdGlTZXNzaW9uID0gJGJyb2tlckNhdGFsb2cuU2Vzc2lvblN1cHBvcnQgLWVxICdNdWx0aVNlc3Npb24nOwogICAgICAgICAgICAgICAgRW5zdXJlID0gJHVzaW5nOkVuc3VyZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3dpdGNoICgkYnJva2VyQ2F0YWxvZy5QZXJzaXN0VXNlckNoYW5nZXMpIHsKCiAgICAgICAgICAgICAgICAnT25Mb2NhbCcgewogICAgICAgICAgICAgICAgICAgICR0YXJnZXRSZXNvdXJjZVsnUGVyc2lzdGVuY2UnXSA9ICdMb2NhbCc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAnT25QdmQnIHsKICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0UmVzb3VyY2VbJ1BlcnNpc3RlbmNlJ10gPSAnUFZEJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICdEaXNjYXJkJyB7CiAgICAgICAgICAgICAgICAgICAgJHRhcmdldFJlc291cmNlWydQZXJzaXN0ZW5jZSddID0gJ0Rpc2NhcmQnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJHRhcmdldFJlc291cmNlOwoKICAgICAgICB9ICNlbmQgc2NyaXB0QmxvY2sKCiAgICAgICAgJGludm9rZUNvbW1hbmRQYXJhbXMgPSBAewogICAgICAgICAgICBTY3JpcHRCbG9jayA9ICRzY3JpcHRCbG9jazsKICAgICAgICAgICAgRXJyb3JBY3Rpb24gPSAnU3RvcCc7CiAgICAgICAgfQoKICAgICAgICBpZiAoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgQWRkSW52b2tlU2NyaXB0QmxvY2tDcmVkZW50aWFscyAtSGFzaHRhYmxlICRpbnZva2VDb21tYW5kUGFyYW1zIC1DcmVkZW50aWFsICRDcmVkZW50aWFsOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJGludm9rZUNvbW1hbmRQYXJhbXNbJ1NjcmlwdEJsb2NrJ10gPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5TY3JpcHRCbG9ja106OkNyZWF0ZSgkc2NyaXB0QmxvY2suVG9TdHJpbmcoKS5SZXBsYWNlKCckdXNpbmc6JywnJCcpKTsKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRsb2NhbGl6ZWREYXRhLkludm9raW5nU2NyaXB0QmxvY2tXaXRoUGFyYW1zIC1mIFtTeXN0ZW0uU3RyaW5nXTo6Sm9pbigiJywnIiwgQCgkTmFtZSkpKTsKCiAgICAgICAgcmV0dXJuIEludm9rZS1Db21tYW5kIEBpbnZva2VDb21tYW5kUGFyYW1zOwoKICAgIH0gI2VuZCBwcm9jZXNzCn0gI2VuZCBmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1Blcm1hbmVudCcsJ1JhbmRvbScsJ1N0YXRpYycpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkQWxsb2NhdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnTWFudWFsJywnUFZTJywnTUNTJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRQcm92aXNpb25pbmcsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ0Rpc2NhcmQnLCdMb2NhbCcsJ1BWRCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkUGVyc2lzdGVuY2UsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5Cb29sZWFuXSAkSXNNdWx0aVNlc3Npb24gPSAkZmFsc2UsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbQWxsb3dOdWxsKCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICREZXNjcmlwdGlvbiwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtBbGxvd051bGwoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFB2c0FkZHJlc3MsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbQWxsb3dOdWxsKCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRQdnNEb21haW4sCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSA9ICdQcmVzZW50JywKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtBbGxvd051bGwoKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQ3JlZGVudGlhbEF0dHJpYnV0ZSgpXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCiAgICBwcm9jZXNzIHsKCiAgICAgICAgJFBTQm91bmRQYXJhbWV0ZXJzWydFbnN1cmUnXSA9ICRFbnN1cmU7CiAgICAgICAgJHRhcmdldFJlc291cmNlID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVyczsKICAgICAgICAkaW5Db21wbGlhbmNlID0gJHRydWU7CgogICAgICAgIGZvcmVhY2ggKCRwcm9wZXJ0eSBpbiAkUFNCb3VuZFBhcmFtZXRlcnMuS2V5cykgewoKICAgICAgICAgICAgaWYgKCR0YXJnZXRSZXNvdXJjZS5Db250YWluc0tleSgkcHJvcGVydHkpKSB7CgogICAgICAgICAgICAgICAgaWYgKCR0YXJnZXRSZXNvdXJjZVskcHJvcGVydHldIC1uZSAkUFNCb3VuZFBhcmFtZXRlcnNbJHByb3BlcnR5XSkgewoKCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJGxvY2FsaXplZERhdGEuUmVzb3VyY2VQcm9wZXJ0eU1pc21hdGNoIC1mICRwcm9wZXJ0eSwgJFBTQm91bmRQYXJhbWV0ZXJzWyRwcm9wZXJ0eV0sICR0YXJnZXRSZXNvdXJjZVskcHJvcGVydHldKTsKICAgICAgICAgICAgICAgICAgICAkaW5Db21wbGlhbmNlID0gJGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICgkaW5Db21wbGlhbmNlKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCRsb2NhbGl6ZWREYXRhLlJlc291cmNlSW5EZXNpcmVkU3RhdGUgLWYgJE5hbWUpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJGxvY2FsaXplZERhdGEuUmVzb3VyY2VOb3RJbkRlc2lyZWRTdGF0ZSAtZiAkTmFtZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGluQ29tcGxpYW5jZTsKCiAgICB9ICNlbmQgcHJvY2Vzcwp9ICNlbmQgZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQoKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW0RpYWdub3N0aWNzLkNvZGVBbmFseXNpcy5TdXBwcmVzc01lc3NhZ2VBdHRyaWJ1dGUoJ1BTVXNlU2hvdWxkUHJvY2Vzc0ZvclN0YXRlQ2hhbmdpbmdGdW5jdGlvbnMnLCAnJyldCiAgICBwYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICROYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdQZXJtYW5lbnQnLCdSYW5kb20nLCdTdGF0aWMnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJEFsbG9jYXRpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ01hbnVhbCcsJ1BWUycsJ01DUycpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkUHJvdmlzaW9uaW5nLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdEaXNjYXJkJywnTG9jYWwnLCdQVkQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFBlcnNpc3RlbmNlLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uQm9vbGVhbl0gJElzTXVsdGlTZXNzaW9uID0gJGZhbHNlLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkRGVzY3JpcHRpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbQWxsb3dOdWxsKCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRQdnNBZGRyZXNzLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW0FsbG93TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkUHZzRG9tYWluLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdQcmVzZW50JywnQWJzZW50JyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbQWxsb3dOdWxsKCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkNyZWRlbnRpYWxBdHRyaWJ1dGUoKV0KICAgICAgICAkQ3JlZGVudGlhbAogICAgKQogICAgYmVnaW4gewogICAgICAgIEFzc2VydFhETW9kdWxlIC1OYW1lICdDaXRyaXguQnJva2VyLkFkbWluLlYyJyAtSXNTbmFwaW47CiAgICB9CiAgICBwcm9jZXNzIHsKCiAgICAgICAgJHNjcmlwdEJsb2NrID0gewoKICAgICAgICAgICAgQWRkLVBTU25hcGluIC1OYW1lICdDaXRyaXguQnJva2VyLkFkbWluLlYyJyAtRXJyb3JBY3Rpb24gU3RvcDsKICAgICAgICAgICAgJGJyb2tlckNhdGFsb2cgPSBHZXQtQnJva2VyQ2F0YWxvZyAtTmFtZSAkdXNpbmc6TmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsKCiAgICAgICAgICAgIGlmICgkdXNpbmc6RW5zdXJlIC1lcSAnUHJlc2VudCcpIHsKCiAgICAgICAgICAgICAgICBpZiAoJGJyb2tlckNhdGFsb2cpIHsKCiAgICAgICAgICAgICAgICAgICAgJHJlY3JlYXRlTWFjaGluZUNhdGFsb2cgPSAkZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRicm9rZXJDYXRhbG9nLkFsbG9jYXRpb25UeXBlIC1uZSAkdXNpbmc6QWxsb2NhdGlvbikgewoKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAoJHVzaW5nOmxvY2FsaXplZERhdGEuQ2hhbmdpbmdNYWNoaW5lQ2F0YWxvZ1Vuc3VwcG9ydGVkV2FybmluZyAtZiAkdXNpbmc6TmFtZSwgJ0FsbG9jYXRpb24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHJlY3JlYXRlTWFjaGluZUNhdGFsb2cgPSAkdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICgkYnJva2VyQ2F0YWxvZy5Qcm92aXNpb25pbmdUeXBlIC1uZSAkdXNpbmc6UHJvdmlzaW9uaW5nKSB7CgogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICgkdXNpbmc6bG9jYWxpemVkRGF0YS5DaGFuZ2luZ01hY2hpbmVDYXRhbG9nVW5zdXBwb3J0ZWRXYXJuaW5nIC1mICR1c2luZzpOYW1lLCAnUHJvdmlzaW9uaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRyZWNyZWF0ZU1hY2hpbmVDYXRhbG9nID0gJHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAoKCRicm9rZXJDYXRhbG9nLlBlcnNpc3RVc2VyQ2hhbmdlcyAtcmVwbGFjZSAnT24nLCAnJykgLW5lICR1c2luZzpQZXJzaXN0ZW5jZSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAoJHVzaW5nOmxvY2FsaXplZERhdGEuQ2hhbmdpbmdNYWNoaW5lQ2F0YWxvZ1Vuc3VwcG9ydGVkV2FybmluZyAtZiAkdXNpbmc6TmFtZSwgJ1BlcnNpc3RlbmNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRyZWNyZWF0ZU1hY2hpbmVDYXRhbG9nID0gJHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAoJGJyb2tlckNhdGFsb2cuU2Vzc2lvblN1cHBvcnQgLWVxICdNdWx0aXNlc3Npb24nIC1hbmQgJHVzaW5nOklzTXVsdGlTZXNzaW9uIC1uZSAkdHJ1ZSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtV2FybmluZyAoJHVzaW5nOmxvY2FsaXplZERhdGEuQ2hhbmdpbmdNYWNoaW5lQ2F0YWxvZ1Vuc3VwcG9ydGVkV2FybmluZyAtZiAkdXNpbmc6TmFtZSwgJ1Nlc3Npb24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHJlY3JlYXRlTWFjaGluZUNhdGFsb2cgPSAkdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgkcmVjcmVhdGVNYWNoaW5lQ2F0YWxvZykgewoKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJHVzaW5nOmxvY2FsaXplZERhdGEuUmVtb3ZpbmdNYWNoaW5lQ2F0YWxvZyAtZiAkdXNpbmc6TmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIFtyZWZdICRudWxsID0gUmVtb3ZlLUJyb2tlckNhdGFsb2cgLU5hbWUgJHVzaW5nOk5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICRicm9rZXJDYXRhbG9nID0gJG51bGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJHVzaW5nOmxvY2FsaXplZERhdGEuVXBkYXRpbmdNYWNoaW5lQ2F0YWxvZyAtZiAkdXNpbmc6TmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICRzZXRCcm9rZXJDYXRhbG9nUGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWUgPSAkdXNpbmc6TmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uID0gJHVzaW5nOkRlc2NyaXB0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHVzaW5nOlB2c0RvbWFpbikgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXRCcm9rZXJDYXRhbG9nUGFyYW1zWydQdnNEb21haW4nXSA9ICR1c2luZzpQdnNEb21haW47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR1c2luZzpQdnNBZGRyZXNzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNldEJyb2tlckNhdGFsb2dQYXJhbXNbJ1B2c0FkZHJlc3MnXSA9ICR1c2luZzpQdnNBZGRyZXNzOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBbcmVmXSAkbnVsbCA9IFNldC1Ccm9rZXJDYXRhbG9nIEBzZXRCcm9rZXJDYXRhbG9nUGFyYW1zOwoKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ICNlbmQgaWYgYnJva2VyQ2F0YWxvZwoKICAgICAgICAgICAgICAgIGlmICgtbm90ICRicm9rZXJDYXRhbG9nKSB7CgogICAgICAgICAgICAgICAgICAgICRuZXdCcm9rZXJDYXRhbG9nUGFyYW1zID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgTmFtZSA9ICR1c2luZzpOYW1lOwogICAgICAgICAgICAgICAgICAgICAgICBBbGxvY2F0aW9uVHlwZSA9ICR1c2luZzpBbGxvY2F0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBTZXNzaW9uU3VwcG9ydCA9ICdTaW5nbGVTZXNzaW9uJzsKICAgICAgICAgICAgICAgICAgICAgICAgUHJvdmlzaW9uaW5nVHlwZSA9ICR1c2luZzpQcm92aXNpb25pbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIFBlcnNpc3RVc2VyQ2hhbmdlcyA9ICdEaXNjYXJkJzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgkdXNpbmc6UHJvdmlzaW9uaW5nIC1lcSAnTWFudWFsJykgewoKICAgICAgICAgICAgICAgICAgICAgICAgJG5ld0Jyb2tlckNhdGFsb2dQYXJhbXNbJ01hY2hpbmVzQXJlUGh5c2ljYWwnXSA9ICR0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJHVzaW5nOkRlc2NyaXB0aW9uKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkbmV3QnJva2VyQ2F0YWxvZ1BhcmFtc1snRGVzY3JpcHRpb24nXSA9ICR1c2luZzpEZXNjcmlwdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCR1c2luZzpQdnNBZGRyZXNzKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkbmV3QnJva2VyQ2F0YWxvZ1BhcmFtc1snUHZzQWRkcmVzcyddID0gJHVzaW5nOlB2c0FkZHJlc3M7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgkdXNpbmc6UHZzRG9tYWluKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkbmV3QnJva2VyQ2F0YWxvZ1BhcmFtc1snUHZzRG9tYWluJ10gPSAkdXNpbmc6UHZzRG9tYWluOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJHVzaW5nOklzTXVsdGlTZXNzaW9uKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkbmV3QnJva2VyQ2F0YWxvZ1BhcmFtc1snU2Vzc2lvblN1cHBvcnQnXSA9ICdNdWx0aVNlc3Npb24nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJHVzaW5nOlBlcnNpc3RlbmNlIC1lcSAnTG9jYWwnKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkbmV3QnJva2VyQ2F0YWxvZ1BhcmFtc1snUGVyc2lzdFVzZXJDaGFuZ2VzJ10gPSAnT25Mb2NhbCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAoJHVzaW5nOlBlcnNpc3RlbmNlIC1lcSAnUFZEJykgewoKICAgICAgICAgICAgICAgICAgICAgICAgJG5ld0Jyb2tlckNhdGFsb2dQYXJhbXNbJ1BlcnNpc3RVc2VyQ2hhbmdlcyddID0gJ09uUHZkJzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCR1c2luZzpsb2NhbGl6ZWREYXRhLkNyZWF0aW5nTWFjaGluZUNhdGFsb2cgLWYgJHVzaW5nOk5hbWUpOwoKICAgICAgICAgICAgICAgICAgICBbcmVmXSAkbnVsbCA9IE5ldy1Ccm9rZXJDYXRhbG9nIEBuZXdCcm9rZXJDYXRhbG9nUGFyYW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkdXNpbmc6bG9jYWxpemVkRGF0YS5SZW1vdmluZ01hY2hpbmVDYXRhbG9nIC1mICR1c2luZzpOYW1lKTsKICAgICAgICAgICAgICAgIFtyZWZdICRudWxsID0gUmVtb3ZlLUJyb2tlckNhdGFsb2cgLU5hbWUgJHVzaW5nOk5hbWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSAjZW5kIHNjcmlwdEJsb2NrCgogICAgICAgICRpbnZva2VDb21tYW5kUGFyYW1zID0gQHsKICAgICAgICAgICAgU2NyaXB0QmxvY2sgPSAkc2NyaXB0QmxvY2s7CiAgICAgICAgICAgIEVycm9yQWN0aW9uID0gJ1N0b3AnOwogICAgICAgIH0KCiAgICAgICAgaWYgKCRDcmVkZW50aWFsKSB7CiAgICAgICAgICAgIEFkZEludm9rZVNjcmlwdEJsb2NrQ3JlZGVudGlhbHMgLUhhc2h0YWJsZSAkaW52b2tlQ29tbWFuZFBhcmFtcyAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRpbnZva2VDb21tYW5kUGFyYW1zWydTY3JpcHRCbG9jayddID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uU2NyaXB0QmxvY2tdOjpDcmVhdGUoJHNjcmlwdEJsb2NrLlRvU3RyaW5nKCkuUmVwbGFjZSgnJHVzaW5nOicsJyQnKSk7CiAgICAgICAgfQoKICAgICAgICAkc2NyaXB0QmxvY2tQYXJhbXMgPSBAKCROYW1lLCAkRW5zdXJlLCAkQWxsb2NhdGlvbiwgJFByb3Zpc2lvbmluZywgJFBlcnNpc3RlbmNlLCAkSXNNdWx0aVNlc3Npb24sICREZXNjcmlwdGlvbiwgJFB2c0FkZHJlc3MsICRQdnNEb21haW4pOwogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRsb2NhbGl6ZWREYXRhLkludm9raW5nU2NyaXB0QmxvY2tXaXRoUGFyYW1zIC1mIFtTeXN0ZW0uU3RyaW5nXTo6Sm9pbigiJywnIiwgJHNjcmlwdEJsb2NrUGFyYW1zKSk7CgogICAgICAgIFtyZWZdICRudWxsID0gSW52b2tlLUNvbW1hbmQgQGludm9rZUNvbW1hbmRQYXJhbXM7CgogICAgfSAjZW5kIHByb2Nlc3MKfSAjZW5kIGZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQoKCiRtb2R1bGVSb290ID0gU3BsaXQtUGF0aCAtUGF0aCAkTXlJbnZvY2F0aW9uLk15Q29tbWFuZC5QYXRoIC1QYXJlbnQ7CgojIyBJbXBvcnQgdGhlIFhEN0NvbW1vbiBsaWJyYXJ5IGZ1bmN0aW9ucwokbW9kdWxlUGFyZW50ID0gU3BsaXQtUGF0aCAtUGF0aCAkbW9kdWxlUm9vdCAtUGFyZW50OwpJbXBvcnQtTW9kdWxlIChKb2luLVBhdGggLVBhdGggJG1vZHVsZVBhcmVudCAtQ2hpbGRQYXRoICdWRV9YRDdDb21tb24nKTsKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U7Cg==
