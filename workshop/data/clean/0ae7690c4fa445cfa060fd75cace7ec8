MSFT_xSQLServerFirewall.psm1,eb4bcbf0f6b17dde058f9a9dd66f4ea8,Scan result is 1. IsMalware: 0,JHNjcmlwdDpjdXJyZW50UGF0aCA9IFNwbGl0LVBhdGggLVBhdGggJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuUGF0aCAtUGFyZW50CkltcG9ydC1Nb2R1bGUgLU5hbWUgKEpvaW4tUGF0aCAtUGF0aCAoU3BsaXQtUGF0aCAtUGF0aCAoU3BsaXQtUGF0aCAtUGF0aCAkc2NyaXB0OmN1cnJlbnRQYXRoIC1QYXJlbnQpIC1QYXJlbnQpIC1DaGlsZFBhdGggJ3hTUUxTZXJ2ZXJIZWxwZXIucHNtMScpCgo8IwogICAgLlNZTk9QU0lTCiAgICAgICAgUmV0dXJucyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZmlyZXdhbGwgcnVsZXMuCgogICAgLlBBUkFNRVRFUiBTb3VyY2VQYXRoCiAgICAgICAgVGhlIHBhdGggdG8gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZSBmaWxlcyBmb3IgaW5zdGFsbGF0aW9uLiBJLmUgYW5kIFVOQyBwYXRoIHRvIGEgc2hhcmVkIHJlc291cmNlLiAgRW52aXJvbm1lbnQgdmFyaWFibGVzIGNhbiBiZSB1c2VkIGluIHRoZSBwYXRoLgoKICAgIC5QQVJBTUVURVIgRmVhdHVyZXMKICAgICAgICBPbmUgb3IgbW9yZSBTUUwgZmVhdHVyZSB0byBjcmVhdGUgZGVmYXVsdCBmaXJld2FsbCBydWxlcyBmb3IuIEVhY2ggZmVhdHVyZSBzaG91bGQgYmUgc2VwZXJhdGVkIHdpdGggYSBjb21tYSwgaS5lLiAnU1FMRW5naW5lLElTLFJTJy4KCiAgICAuUEFSQU1FVEVSIFNvdXJjZUNyZWRlbnRpYWwKICAgICAgICBDcmVkZW50aWFscyB1c2VkIHRvIGFjY2VzcyB0aGUgcGF0aCBzZXQgaW4gdGhlIHBhcmFtZXRlciBgU291cmNlUGF0aGAuCgogICAgLlBBUkFNRVRFUiBJbnN0YW5jZU5hbWUKICAgICAgICBOYW1lIG9mIHRoZSBpbnN0YW5jZSB0byBnZXQgZmlyZXdhbGwgcnVsZXMgZm9yLgojPgpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU291cmNlUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEZlYXR1cmVzLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRTb3VyY2VDcmVkZW50aWFsCiAgICApCgogICAgJEluc3RhbmNlTmFtZSA9ICRJbnN0YW5jZU5hbWUuVG9VcHBlcigpCgogICAgJFNvdXJjZVBhdGggPSBbRW52aXJvbm1lbnRdOjpFeHBhbmRFbnZpcm9ubWVudFZhcmlhYmxlcygkU291cmNlUGF0aCkKCiAgICBpZiAoJFNvdXJjZUNyZWRlbnRpYWwpCiAgICB7CiAgICAgICAgJG5ld1NtYk1hcHBpbmdQYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgUmVtb3RlUGF0aCA9ICRTb3VyY2VQYXRoCiAgICAgICAgICAgIFVzZXJOYW1lID0gIiQoJFNvdXJjZUNyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5Eb21haW4pXCQoJFNvdXJjZUNyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5Vc2VyTmFtZSkiCiAgICAgICAgICAgIFBhc3N3b3JkID0gJCgkU291cmNlQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlBhc3N3b3JkKQogICAgICAgIH0KCiAgICAgICAgJG51bGwgPSBOZXctU21iTWFwcGluZyBAbmV3U21iTWFwcGluZ1BhcmFtZXRlcnMKICAgIH0KCiAgICAkcGF0aFRvU2V0dXBFeGVjdXRhYmxlID0gSm9pbi1QYXRoIC1QYXRoICRTb3VyY2VQYXRoIC1DaGlsZFBhdGggJ3NldHVwLmV4ZScKCiAgICBOZXctVmVyYm9zZU1lc3NhZ2UgLU1lc3NhZ2UgIlVzaW5nIHBhdGg6ICRwYXRoVG9TZXR1cEV4ZWN1dGFibGUiCgogICAgJHNxbFZlcnNpb24gPSBHZXQtU3FsTWFqb3JWZXJzaW9uIC1QYXRoICRwYXRoVG9TZXR1cEV4ZWN1dGFibGUKCiAgICBpZiAoJFNvdXJjZUNyZWRlbnRpYWwpCiAgICB7CiAgICAgICAgUmVtb3ZlLVNtYk1hcHBpbmcgLVJlbW90ZVBhdGggJFNvdXJjZVBhdGggLUZvcmNlCiAgICB9CgogICAgaWYoJEluc3RhbmNlTmFtZSAtZXEgJ01TU1FMU0VSVkVSJykKICAgIHsKICAgICAgICAkZGF0YWJhc2VTZXJ2aWNlTmFtZSA9ICdNU1NRTFNFUlZFUicKICAgICAgICAkcmVwb3J0U2VydmljZU5hbWUgPSAnUmVwb3J0U2VydmVyJwogICAgICAgICRhbmFseXNpc1NlcnZpY2VOYW1lID0gJ01TU1FMU2VydmVyT0xBUFNlcnZpY2UnCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgJGRhdGFiYXNlU2VydmljZU5hbWUgPSAnTVNTUUwkezB9JyAtZiAkSW5zdGFuY2VOYW1lCiAgICAgICAgJHJlcG9ydFNlcnZpY2VOYW1lID0gJ1JlcG9ydFNlcnZlciR7MH0nIC1mICRJbnN0YW5jZU5hbWUKICAgICAgICAkYW5hbHlzaXNTZXJ2aWNlTmFtZSA9ICdNU09MQVAkezB9JyAtZiAkSW5zdGFuY2VOYW1lCiAgICB9CgogICAgJGludGVncmF0aW9uU2VydmljZU5hbWUgPSAnTXNEdHNTZXJ2ZXJ7MH0wJyAtZiAkc3FsVmVyc2lvbgogICAgJGJyb3dzZXJTZXJ2aWNlTmFtZSA9ICdTUUxCcm93c2VyJwoKICAgICRlbnN1cmUgPSAnQWJzZW50JwogICAgJGZlYXR1cmVzSW5zdGFsbGVkID0gJycKCiAgICAkc2VydmljZXMgPSBHZXQtU2VydmljZQoKICAgIGZvcmVhY2ggKCRjdXJyZW50RmVhdHVyZSBpbiAkRmVhdHVyZXMuU3BsaXQoJywnKSkKICAgIHsKICAgICAgICBzd2l0Y2ggKCRjdXJyZW50RmVhdHVyZSkKICAgICAgICB7CiAgICAgICAgICAgICdTUUxFTkdJTkUnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkc2VydmljZXMgfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLWVxICRkYXRhYmFzZVNlcnZpY2VOYW1lfSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkZmVhdHVyZXNJbnN0YWxsZWQgKz0gIiRfLCIKCiAgICAgICAgICAgICAgICAgICAgJHBhdGhUb0RhdGFiYXNlRW5naW5lRXhlY3V0YWJsZSA9IEpvaW4tUGF0aCAtUGF0aCAoR2V0LVNRTFBhdGggLUZlYXR1cmUgJF8gLUluc3RhbmNlTmFtZSAkSW5zdGFuY2VOYW1lKSAtQ2hpbGRQYXRoICdzcWxzZXJ2ci5leGUnCiAgICAgICAgICAgICAgICAgICAgJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUgPSAiU1FMIFNlcnZlciBEYXRhYmFzZSBFbmdpbmUgaW5zdGFuY2UgJEluc3RhbmNlTmFtZSIKCiAgICAgICAgICAgICAgICAgICAgJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvZ3JhbSA9ICRwYXRoVG9EYXRhYmFzZUVuZ2luZUV4ZWN1dGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBkYXRhYmFzZUVuZ2luZUZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkZGF0YWJhc2VFbmdpbmVGaXJld2FsbCA9ICR0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICRlbnN1cmUgPSAnUHJlc2VudCcKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGRhdGFiYXNlRW5naW5lRmlyZXdhbGwgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUgPSAnU1FMIFNlcnZlciBCcm93c2VyJwoKICAgICAgICAgICAgICAgICAgICAkYnJvd3NlckZpcmV3YWxsUnVsZVBhcmFtZXRlcnMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgU2VydmljZSA9ICRicm93c2VyU2VydmljZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBicm93c2VyRmlyZXdhbGxSdWxlUGFyYW1ldGVycykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGwgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAkZW5zdXJlID0gJ1ByZXNlbnQnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGwgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICdSUycKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRzZXJ2aWNlcyB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtZXEgJHJlcG9ydFNlcnZpY2VOYW1lfSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkZmVhdHVyZXNJbnN0YWxsZWQgKz0gIiRfLCIKCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzTm9Tc2xQcm90b2NvbCA9ICdUQ1AnCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzTm9Tc2xMb2NhbFBvcnQgPSAnODAnCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzTm9Tc2xGaXJld2FsbFJ1bGVEaXNwbGF5TmFtZSA9ICdTUUwgU2VydmVyIFJlcG9ydGluZyBTZXJ2aWNlcyA4MCcKCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzTm9Tc2xGaXJld2FsbFJ1bGVQYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZURpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIFByb3RvY29sID0gJHJlcG9ydGluZ1NlcnZpY2VzTm9Tc2xQcm90b2NvbAogICAgICAgICAgICAgICAgICAgICAgICBMb2NhbFBvcnQgPSAkcmVwb3J0aW5nU2VydmljZXNOb1NzbExvY2FsUG9ydAogICAgICAgICAgICAgICAgICAgICAgICBFbmFibGVkID0gJ1RydWUnCiAgICAgICAgICAgICAgICAgICAgICAgIFByb2ZpbGUgPSAnQW55JwogICAgICAgICAgICAgICAgICAgICAgICBEaXJlY3Rpb24gPSAnSW5ib3VuZCcKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRyZXBvcnRpbmdTZXJ2aWNlc1NzbFByb3RvY29sID0gJ1RDUCcKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNTc2xMb2NhbFBvcnQgPSAnNDQzJwogICAgICAgICAgICAgICAgICAgICRyZXBvcnRpbmdTZXJ2aWNlc1NzbEZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgUmVwb3J0aW5nIFNlcnZpY2VzIDQ0MycKCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzU3NsRmlyZXdhbGxSdWxlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJHJlcG9ydGluZ1NlcnZpY2VzU3NsRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvdG9jb2wgPSAkcmVwb3J0aW5nU2VydmljZXNTc2xQcm90b2NvbAogICAgICAgICAgICAgICAgICAgICAgICBMb2NhbFBvcnQgPSAkcmVwb3J0aW5nU2VydmljZXNTc2xMb2NhbFBvcnQKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoKFRlc3QtSXNGaXJld2FsbFJ1bGVJbkRlc2lyZWRTdGF0ZSBAcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWFuZCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEByZXBvcnRpbmdTZXJ2aWNlc1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzRmlyZXdhbGwgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAkZW5zdXJlID0gJ1ByZXNlbnQnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRyZXBvcnRpbmdTZXJ2aWNlc0ZpcmV3YWxsID0gJGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAnQVMnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgkc2VydmljZXMgfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLWVxICRhbmFseXNpc1NlcnZpY2VOYW1lfSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkZmVhdHVyZXNJbnN0YWxsZWQgKz0gIiRfLCIKCiAgICAgICAgICAgICAgICAgICAgJGFuYWx5c2lzU2VydmljZXNGaXJld2FsbFJ1bGVEaXNwbGF5TmFtZSA9ICJTUUwgU2VydmVyIEFuYWx5c2lzIFNlcnZpY2VzIGluc3RhbmNlICRJbnN0YW5jZU5hbWUiCgogICAgICAgICAgICAgICAgICAgICRhbmFseXNpc1NlcnZpY2VzRmlyZXdhbGxSdWxlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJGFuYWx5c2lzU2VydmljZXNGaXJld2FsbFJ1bGVEaXNwbGF5TmFtZQogICAgICAgICAgICAgICAgICAgICAgICBTZXJ2aWNlID0gJGFuYWx5c2lzU2VydmljZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBhbmFseXNpc1NlcnZpY2VzRmlyZXdhbGxSdWxlUGFyYW1ldGVycykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhbmFseXNpc1NlcnZpY2VzRmlyZXdhbGwgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAkZW5zdXJlID0gJ1ByZXNlbnQnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhbmFseXNpc1NlcnZpY2VzRmlyZXdhbGwgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUgPSAnU1FMIFNlcnZlciBCcm93c2VyJwoKICAgICAgICAgICAgICAgICAgICAkYnJvd3NlckZpcmV3YWxsUnVsZVBhcmFtZXRlcnMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgU2VydmljZSA9ICRicm93c2VyU2VydmljZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBicm93c2VyRmlyZXdhbGxSdWxlUGFyYW1ldGVycykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGwgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAkZW5zdXJlID0gJ1ByZXNlbnQnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGwgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICdJUycKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRzZXJ2aWNlcyB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtZXEgJGludGVncmF0aW9uU2VydmljZU5hbWV9KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRmZWF0dXJlc0luc3RhbGxlZCArPSAiJF8sIgoKICAgICAgICAgICAgICAgICAgICAkaW50ZWdyYXRpb25TZXJ2aWNlc1J1bGVBcHBsaWNhdGlvbkRpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgSW50ZWdyYXRpb24gU2VydmljZXMgQXBwbGljYXRpb24nCiAgICAgICAgICAgICAgICAgICAgJHBhdGhUb0ludGVncmF0aW9uU2VydmljZXNFeGVjdXRhYmxlID0gKEpvaW4tUGF0aCAtUGF0aCAoSm9pbi1QYXRoIC1QYXRoIChHZXQtU1FMUGF0aCAtRmVhdHVyZSAnSVMnIC1TUUxWZXJzaW9uICRzcWxWZXJzaW9uKSAtQ2hpbGRQYXRoICdCaW5uJykgLUNoaWxkUGF0aCAnTXNEdHNTcnZyLmV4ZScpCgogICAgICAgICAgICAgICAgICAgICRpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlQXBwbGljYXRpb25QYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkaW50ZWdyYXRpb25TZXJ2aWNlc1J1bGVBcHBsaWNhdGlvbkRpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIFByb2dyYW0gPSAkcGF0aFRvSW50ZWdyYXRpb25TZXJ2aWNlc0V4ZWN1dGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkaW50ZWdyYXRpb25TZXJ2aWNlc1Byb3RvY29sID0gJ1RDUCcKICAgICAgICAgICAgICAgICAgICAkaW50ZWdyYXRpb25TZXJ2aWNlc0xvY2FsUG9ydCA9ICcxMzUnCiAgICAgICAgICAgICAgICAgICAgJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbFJ1bGVEaXNwbGF5TmFtZSA9ICdTUUwgU2VydmVyIEludGVncmF0aW9uIFNlcnZpY2VzIFBvcnQnCgogICAgICAgICAgICAgICAgICAgICRpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlUG9ydFBhcmFtZXRlcnMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvdG9jb2wgPSAkaW50ZWdyYXRpb25TZXJ2aWNlc1Byb3RvY29sCiAgICAgICAgICAgICAgICAgICAgICAgIExvY2FsUG9ydCA9ICRpbnRlZ3JhdGlvblNlcnZpY2VzTG9jYWxQb3J0CiAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQgPSAnVHJ1ZScKICAgICAgICAgICAgICAgICAgICAgICAgUHJvZmlsZSA9ICdBbnknCiAgICAgICAgICAgICAgICAgICAgICAgIERpcmVjdGlvbiA9ICdJbmJvdW5kJwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKChUZXN0LUlzRmlyZXdhbGxSdWxlSW5EZXNpcmVkU3RhdGUgQGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbFJ1bGVBcHBsaWNhdGlvblBhcmFtZXRlcnMpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWFuZCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlUG9ydFBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbCA9ICR0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICRlbnN1cmUgPSAnUHJlc2VudCcKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbCA9ICRmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAkZmVhdHVyZXNJbnN0YWxsZWQgPSAkZmVhdHVyZXNJbnN0YWxsZWQuVHJpbSgnLCcpCgogICAgcmV0dXJuIEB7CiAgICAgICAgRW5zdXJlID0gJGVuc3VyZQogICAgICAgIFNvdXJjZVBhdGggPSAkU291cmNlUGF0aAogICAgICAgIEZlYXR1cmVzID0gJGZlYXR1cmVzSW5zdGFsbGVkCiAgICAgICAgSW5zdGFuY2VOYW1lID0gJEluc3RhbmNlTmFtZQogICAgICAgIERhdGFiYXNlRW5naW5lRmlyZXdhbGwgPSAkZGF0YWJhc2VFbmdpbmVGaXJld2FsbAogICAgICAgIEJyb3dzZXJGaXJld2FsbCA9ICRicm93c2VyRmlyZXdhbGwKICAgICAgICBSZXBvcnRpbmdTZXJ2aWNlc0ZpcmV3YWxsID0gJHJlcG9ydGluZ1NlcnZpY2VzRmlyZXdhbGwKICAgICAgICBBbmFseXNpc1NlcnZpY2VzRmlyZXdhbGwgPSAkYW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsCiAgICAgICAgSW50ZWdyYXRpb25TZXJ2aWNlc0ZpcmV3YWxsID0gJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbAogICAgfQp9Cgo8IwogICAgLlNZTk9QU0lTCiAgICAgICAgQ3JlYXRlcywgdXBkYXRlcyBvciByZW1vdmUgdGhlIGZpcmV3YWxsIHJ1bGVzLgoKICAgIC5QQVJBTUVURVIgRW5zdXJlCiAgICAgICAgSWYgdGhlIGZpcmV3YWxsIHJ1bGVzIHNob3VsZCBiZSBwcmVzZW50ICgnUHJlc2VudCcpIG9yIGFic2VudCAoJ0Fic2VudCcpLiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAnUHJlc2VudCcuCgogICAgLlBBUkFNRVRFUiBTb3VyY2VQYXRoCiAgICAgICAgVGhlIHBhdGggdG8gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZSBmaWxlcyBmb3IgaW5zdGFsbGF0aW9uLiBJLmUgYW5kIFVOQyBwYXRoIHRvIGEgc2hhcmVkIHJlc291cmNlLiAgRW52aXJvbm1lbnQgdmFyaWFibGVzIGNhbiBiZSB1c2VkIGluIHRoZSBwYXRoLgoKICAgIC5QQVJBTUVURVIgRmVhdHVyZXMKICAgICAgICBPbmUgb3IgbW9yZSBTUUwgZmVhdHVyZSB0byBjcmVhdGUgZGVmYXVsdCBmaXJld2FsbCBydWxlcyBmb3IuIEVhY2ggZmVhdHVyZSBzaG91bGQgYmUgc2VwZXJhdGVkIHdpdGggYSBjb21tYSwgaS5lLiAnU1FMRW5naW5lLElTLFJTJy4KCiAgICAuUEFSQU1FVEVSIFNvdXJjZUNyZWRlbnRpYWwKICAgICAgICBDcmVkZW50aWFscyB1c2VkIHRvIGFjY2VzcyB0aGUgcGF0aCBzZXQgaW4gdGhlIHBhcmFtZXRlciBgU291cmNlUGF0aGAuCgogICAgLlBBUkFNRVRFUiBJbnN0YW5jZU5hbWUKICAgICAgICBOYW1lIG9mIHRoZSBpbnN0YW5jZSB0byBnZXQgZmlyZXdhbGwgcnVsZXMgZm9yLgojPgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU291cmNlUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEZlYXR1cmVzLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRTb3VyY2VDcmVkZW50aWFsCiAgICApCgogICAgJEluc3RhbmNlTmFtZSA9ICRJbnN0YW5jZU5hbWUuVG9VcHBlcigpCgogICAgJFNvdXJjZVBhdGggPSBbRW52aXJvbm1lbnRdOjpFeHBhbmRFbnZpcm9ubWVudFZhcmlhYmxlcygkU291cmNlUGF0aCkKCiAgICBpZiAoJFNvdXJjZUNyZWRlbnRpYWwpCiAgICB7CiAgICAgICAgJG5ld1NtYk1hcHBpbmdQYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgUmVtb3RlUGF0aCA9ICRTb3VyY2VQYXRoCiAgICAgICAgICAgIFVzZXJOYW1lID0gIiQoJFNvdXJjZUNyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5Eb21haW4pXCQoJFNvdXJjZUNyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5Vc2VyTmFtZSkiCiAgICAgICAgICAgIFBhc3N3b3JkID0gJCgkU291cmNlQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlBhc3N3b3JkKQogICAgICAgIH0KCiAgICAgICAgJG51bGwgPSBOZXctU21iTWFwcGluZyBAbmV3U21iTWFwcGluZ1BhcmFtZXRlcnMKICAgIH0KCiAgICAkcGF0aCA9IEpvaW4tUGF0aCAtUGF0aCAkU291cmNlUGF0aCAtQ2hpbGRQYXRoICdzZXR1cC5leGUnCgogICAgTmV3LVZlcmJvc2VNZXNzYWdlIC1NZXNzYWdlICJVc2luZyBwYXRoOiAkcGF0aCIKCiAgICAkc3FsVmVyc2lvbiA9IEdldC1TcWxNYWpvclZlcnNpb24gLVBhdGggJHBhdGgKCiAgICBpZiAoJFNvdXJjZUNyZWRlbnRpYWwpCiAgICB7CiAgICAgICAgUmVtb3ZlLVNtYk1hcHBpbmcgLVJlbW90ZVBhdGggJFNvdXJjZVBhdGggLUZvcmNlCiAgICB9CgogICAgaWYgKCRJbnN0YW5jZU5hbWUgLWVxICdNU1NRTFNFUlZFUicpCiAgICB7CiAgICAgICAgJGFuYWx5c2lzU2VydmljZU5hbWUgPSAnTVNTUUxTZXJ2ZXJPTEFQU2VydmljZScKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkYW5hbHlzaXNTZXJ2aWNlTmFtZSA9ICdNU09MQVAkezB9JyAtZiAkSW5zdGFuY2VOYW1lCiAgICB9CgogICAgJGJyb3dzZXJTZXJ2aWNlTmFtZSA9ICdTUUxCcm93c2VyJwoKICAgICRnZXRUYXJnZXRSZXNvdXJjZVJlc3VsdCA9IEdldC1UYXJnZXRSZXNvdXJjZSAtU291cmNlUGF0aCAkU291cmNlUGF0aCAtRmVhdHVyZXMgJEZlYXR1cmVzIC1JbnN0YW5jZU5hbWUgJEluc3RhbmNlTmFtZQoKICAgIGZvcmVhY2ggKCRjdXJyZW50RmVhdHVyZSBpbiAkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQuRmVhdHVyZXMuU3BsaXQoJywnKSkKICAgIHsKICAgICAgICBzd2l0Y2ggKCRjdXJyZW50RmVhdHVyZSkKICAgICAgICB7CiAgICAgICAgICAgICdTUUxFTkdJTkUnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgtbm90ICgkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQuRGF0YWJhc2VFbmdpbmVGaXJld2FsbCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJHBhdGhUb0RhdGFiYXNlRW5naW5lRXhlY3V0YWJsZSA9IEpvaW4tUGF0aCAtUGF0aCAoR2V0LVNRTFBhdGggLUZlYXR1cmUgJF8gLUluc3RhbmNlTmFtZSAkSW5zdGFuY2VOYW1lKSAtQ2hpbGRQYXRoICdzcWxzZXJ2ci5leGUnCiAgICAgICAgICAgICAgICAgICAgJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUgPSAiU1FMIFNlcnZlciBEYXRhYmFzZSBFbmdpbmUgaW5zdGFuY2UgJEluc3RhbmNlTmFtZSIKCiAgICAgICAgICAgICAgICAgICAgJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJGRhdGFiYXNlRW5naW5lRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvZ3JhbSA9ICRwYXRoVG9EYXRhYmFzZUVuZ2luZUV4ZWN1dGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBkYXRhYmFzZUVuZ2luZUZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAZGF0YWJhc2VFbmdpbmVGaXJld2FsbFJ1bGVQYXJhbWV0ZXJzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgtbm90ICgkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQuQnJvd3NlckZpcmV3YWxsKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkYnJvd3NlckZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgQnJvd3NlcicKCiAgICAgICAgICAgICAgICAgICAgJGJyb3dzZXJGaXJld2FsbFJ1bGVQYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkYnJvd3NlckZpcmV3YWxsUnVsZURpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIFNlcnZpY2UgPSAkYnJvd3NlclNlcnZpY2VOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQgPSAnVHJ1ZScKICAgICAgICAgICAgICAgICAgICAgICAgUHJvZmlsZSA9ICdBbnknCiAgICAgICAgICAgICAgICAgICAgICAgIERpcmVjdGlvbiA9ICdJbmJvdW5kJwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKC1ub3QgKFRlc3QtSXNGaXJld2FsbFJ1bGVJbkRlc2lyZWRTdGF0ZSBAYnJvd3NlckZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAYnJvd3NlckZpcmV3YWxsUnVsZVBhcmFtZXRlcnMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICdSUycKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKC1ub3QgKCRnZXRUYXJnZXRSZXNvdXJjZVJlc3VsdC5SZXBvcnRpbmdTZXJ2aWNlc0ZpcmV3YWxsKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNOb1NzbFByb3RvY29sID0gJ1RDUCcKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNOb1NzbExvY2FsUG9ydCA9ICc4MCcKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgUmVwb3J0aW5nIFNlcnZpY2VzIDgwJwoKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRyZXBvcnRpbmdTZXJ2aWNlc05vU3NsRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvdG9jb2wgPSAkcmVwb3J0aW5nU2VydmljZXNOb1NzbFByb3RvY29sCiAgICAgICAgICAgICAgICAgICAgICAgIExvY2FsUG9ydCA9ICRyZXBvcnRpbmdTZXJ2aWNlc05vU3NsTG9jYWxQb3J0CiAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQgPSAnVHJ1ZScKICAgICAgICAgICAgICAgICAgICAgICAgUHJvZmlsZSA9ICdBbnknCiAgICAgICAgICAgICAgICAgICAgICAgIERpcmVjdGlvbiA9ICdJbmJvdW5kJwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKC1ub3QgKFRlc3QtSXNGaXJld2FsbFJ1bGVJbkRlc2lyZWRTdGF0ZSBAcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAcmVwb3J0aW5nU2VydmljZXNOb1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRyZXBvcnRpbmdTZXJ2aWNlc1NzbFByb3RvY29sID0gJ1RDUCcKICAgICAgICAgICAgICAgICAgICAkcmVwb3J0aW5nU2VydmljZXNTc2xMb2NhbFBvcnQgPSAnNDQzJwogICAgICAgICAgICAgICAgICAgICRyZXBvcnRpbmdTZXJ2aWNlc1NzbEZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgUmVwb3J0aW5nIFNlcnZpY2VzIDQ0MycKCiAgICAgICAgICAgICAgICAgICAgJHJlcG9ydGluZ1NlcnZpY2VzU3NsRmlyZXdhbGxSdWxlUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJHJlcG9ydGluZ1NlcnZpY2VzU3NsRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgUHJvdG9jb2wgPSAkcmVwb3J0aW5nU2VydmljZXNTc2xQcm90b2NvbAogICAgICAgICAgICAgICAgICAgICAgICBMb2NhbFBvcnQgPSAkcmVwb3J0aW5nU2VydmljZXNTc2xMb2NhbFBvcnQKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEByZXBvcnRpbmdTZXJ2aWNlc1NzbEZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAcmVwb3J0aW5nU2VydmljZXNTc2xGaXJld2FsbFJ1bGVQYXJhbWV0ZXJzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAnQVMnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgtbm90ICgkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQuQW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkYW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gIlNRTCBTZXJ2ZXIgQW5hbHlzaXMgU2VydmljZXMgaW5zdGFuY2UgJEluc3RhbmNlTmFtZSIKCiAgICAgICAgICAgICAgICAgICAgJGFuYWx5c2lzU2VydmljZXNGaXJld2FsbFJ1bGVQYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkYW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsUnVsZURpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIFNlcnZpY2UgPSAkYW5hbHlzaXNTZXJ2aWNlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICBFbmFibGVkID0gJ1RydWUnCiAgICAgICAgICAgICAgICAgICAgICAgIFByb2ZpbGUgPSAnQW55JwogICAgICAgICAgICAgICAgICAgICAgICBEaXJlY3Rpb24gPSAnSW5ib3VuZCcKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKC1ub3QgKFRlc3QtSXNGaXJld2FsbFJ1bGVJbkRlc2lyZWRTdGF0ZSBAYW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsUnVsZVBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAYW5hbHlzaXNTZXJ2aWNlc0ZpcmV3YWxsUnVsZVBhcmFtZXRlcnMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKC1ub3QgKCRnZXRUYXJnZXRSZXNvdXJjZVJlc3VsdC5Ccm93c2VyRmlyZXdhbGwpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUgPSAnU1FMIFNlcnZlciBCcm93c2VyJwoKICAgICAgICAgICAgICAgICAgICAkYnJvd3NlckZpcmV3YWxsUnVsZVBhcmFtZXRlcnMgPSBAewogICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRicm93c2VyRmlyZXdhbGxSdWxlRGlzcGxheU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgU2VydmljZSA9ICRicm93c2VyU2VydmljZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBicm93c2VyRmlyZXdhbGxSdWxlUGFyYW1ldGVycykpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBOZXctTmV0RmlyZXdhbGxSdWxlIEBicm93c2VyRmlyZXdhbGxSdWxlUGFyYW1ldGVycwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJ0lTJwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoISgkZ2V0VGFyZ2V0UmVzb3VyY2VSZXN1bHQuSW50ZWdyYXRpb25TZXJ2aWNlc0ZpcmV3YWxsKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkaW50ZWdyYXRpb25TZXJ2aWNlc1J1bGVBcHBsaWNhdGlvbkRpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgSW50ZWdyYXRpb24gU2VydmljZXMgQXBwbGljYXRpb24nCiAgICAgICAgICAgICAgICAgICAgJHBhdGhUb0ludGVncmF0aW9uU2VydmljZXNFeGVjdXRhYmxlID0gKEpvaW4tUGF0aCAtUGF0aCAoSm9pbi1QYXRoIC1QYXRoIChHZXQtU1FMUGF0aCAtRmVhdHVyZSAnSVMnIC1TUUxWZXJzaW9uICRzcWxWZXJzaW9uKSAtQ2hpbGRQYXRoICdCaW5uJykgLUNoaWxkUGF0aCAnTXNEdHNTcnZyLmV4ZScpCgogICAgICAgICAgICAgICAgICAgICRpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlQXBwbGljYXRpb25QYXJhbWV0ZXJzID0gQHsKICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkaW50ZWdyYXRpb25TZXJ2aWNlc1J1bGVBcHBsaWNhdGlvbkRpc3BsYXlOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIFByb2dyYW0gPSAkcGF0aFRvSW50ZWdyYXRpb25TZXJ2aWNlc0V4ZWN1dGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlQXBwbGljYXRpb25QYXJhbWV0ZXJzKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1OZXRGaXJld2FsbFJ1bGUgQGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbFJ1bGVBcHBsaWNhdGlvblBhcmFtZXRlcnMKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRpbnRlZ3JhdGlvblNlcnZpY2VzUHJvdG9jb2wgPSAnVENQJwogICAgICAgICAgICAgICAgICAgICRpbnRlZ3JhdGlvblNlcnZpY2VzTG9jYWxQb3J0ID0gJzEzNScKICAgICAgICAgICAgICAgICAgICAkaW50ZWdyYXRpb25TZXJ2aWNlc0ZpcmV3YWxsUnVsZURpc3BsYXlOYW1lID0gJ1NRTCBTZXJ2ZXIgSW50ZWdyYXRpb24gU2VydmljZXMgUG9ydCcKCiAgICAgICAgICAgICAgICAgICAgJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbFJ1bGVQb3J0UGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJGludGVncmF0aW9uU2VydmljZXNGaXJld2FsbFJ1bGVEaXNwbGF5TmFtZQogICAgICAgICAgICAgICAgICAgICAgICBQcm90b2NvbCA9ICRpbnRlZ3JhdGlvblNlcnZpY2VzUHJvdG9jb2wKICAgICAgICAgICAgICAgICAgICAgICAgTG9jYWxQb3J0ID0gJGludGVncmF0aW9uU2VydmljZXNMb2NhbFBvcnQKICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZCA9ICdUcnVlJwogICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlID0gJ0FueScKICAgICAgICAgICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gJ0luYm91bmQnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoVGVzdC1Jc0ZpcmV3YWxsUnVsZUluRGVzaXJlZFN0YXRlIEBpbnRlZ3JhdGlvblNlcnZpY2VzRmlyZXdhbGxSdWxlUG9ydFBhcmFtZXRlcnMpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LU5ldEZpcmV3YWxsUnVsZSBAaW50ZWdyYXRpb25TZXJ2aWNlc0ZpcmV3YWxsUnVsZVBvcnRQYXJhbWV0ZXJzCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGlmICgtbm90IChUZXN0LVRhcmdldFJlc291cmNlIC1Tb3VyY2VQYXRoICRTb3VyY2VQYXRoIC1GZWF0dXJlcyAkRmVhdHVyZXMgLUluc3RhbmNlTmFtZSAkSW5zdGFuY2VOYW1lKSkKICAgIHsKICAgICAgICB0aHJvdyBOZXctVGVybWluYXRpbmdFcnJvciAtRXJyb3JUeXBlIFRlc3RGYWlsZWRBZnRlclNldCAtRXJyb3JDYXRlZ29yeSBJbnZhbGlkUmVzdWx0CiAgICB9Cn0KCjwjCiAgICAuU1lOT1BTSVMKICAgICAgICBUZXN0IGlmIHRoZSBmaXJld2FsbCBydWxlcyBhcmUgaW4gZGVzaXJlZCBzdGF0ZS4KCiAgICAuUEFSQU1FVEVSIEVuc3VyZQogICAgICAgIElmIHRoZSBmaXJld2FsbCBydWxlcyBzaG91bGQgYmUgcHJlc2VudCAoJ1ByZXNlbnQnKSBvciBhYnNlbnQgKCdBYnNlbnQnKS4gVGhlIGRlZmF1bHQgdmFsdWUgaXMgJ1ByZXNlbnQnLgoKICAgIC5QQVJBTUVURVIgU291cmNlUGF0aAogICAgICAgIFRoZSBwYXRoIHRvIHRoZSByb290IG9mIHRoZSBzb3VyY2UgZmlsZXMgZm9yIGluc3RhbGxhdGlvbi4gSS5lIGFuZCBVTkMgcGF0aCB0byBhIHNoYXJlZCByZXNvdXJjZS4gIEVudmlyb25tZW50IHZhcmlhYmxlcyBjYW4gYmUgdXNlZCBpbiB0aGUgcGF0aC4KCiAgICAuUEFSQU1FVEVSIEZlYXR1cmVzCiAgICAgICAgT25lIG9yIG1vcmUgU1FMIGZlYXR1cmUgdG8gY3JlYXRlIGRlZmF1bHQgZmlyZXdhbGwgcnVsZXMgZm9yLiBFYWNoIGZlYXR1cmUgc2hvdWxkIGJlIHNlcGVyYXRlZCB3aXRoIGEgY29tbWEsIGkuZS4gJ1NRTEVuZ2luZSxJUyxSUycuCgogICAgLlBBUkFNRVRFUiBTb3VyY2VDcmVkZW50aWFsCiAgICAgICAgQ3JlZGVudGlhbHMgdXNlZCB0byBhY2Nlc3MgdGhlIHBhdGggc2V0IGluIHRoZSBwYXJhbWV0ZXIgYFNvdXJjZVBhdGhgLgoKICAgIC5QQVJBTUVURVIgSW5zdGFuY2VOYW1lCiAgICAgICAgTmFtZSBvZiB0aGUgaW5zdGFuY2UgdG8gZ2V0IGZpcmV3YWxsIHJ1bGVzIGZvci4KIz4KZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gJ1ByZXNlbnQnLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFNvdXJjZVBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRGZWF0dXJlcywKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEluc3RhbmNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkU291cmNlQ3JlZGVudGlhbAogICAgKQoKICAgICRnZXRUYXJnZXRSZXNvdXJjZVJlc3VsdCA9IEdldC1UYXJnZXRSZXNvdXJjZSAtU291cmNlUGF0aCAkU291cmNlUGF0aCAtRmVhdHVyZXMgJEZlYXR1cmVzIC1JbnN0YW5jZU5hbWUgJEluc3RhbmNlTmFtZQoKICAgIHJldHVybiAoJGdldFRhcmdldFJlc291cmNlUmVzdWx0LkVuc3VyZSAtZXEgJEVuc3VyZSkKfQoKPCMKICAgIC5TWU5PUFNJUwogICAgICAgIEdldCB0aGUgcGF0aCB0byBTUUwgU2VydmVyIGV4ZWN1dGFibGVzLgoKICAgIC5QQVJBTUVURVIgRmVhdHVyZQogICAgICAgIFN0cmluZyBjb250YWluaW5nIHRoZSBmZWF0dXJlIG5hbWUgZm9yIHdoaWNoIHRvIGdldCB0aGUgcGF0aC4KCiAgICAuUEFSQU1FVEVSIEluc3RhbmNlTmFtZQogICAgICAgIFN0cmluZyBjb250YWluaW5nIHRoZSBuYW1lIG9mIHRoZSBpbnN0YW5jZSBmb3Igd2hpY2ggdG8gZ2V0IHRoZSBwYXRoLgoKICAgIC5QQVJBTUVURVIgU1FMVmVyc2lvbgogICAgICAgIFN0cmluZyBjb250YWluaW5nIHRoZSBtYWpvciB2ZXJzaW9uIG9mIHRoZSBTUUwgc2VydmVyIHRvIGdldCB0aGUgcGF0aCBmb3IuCiAgICAgICAgVGhpcyBpcyB1c2VkIHRvIGV2YWx1YXRlIHRoZSBJbnRlZ3JhdGlvbiBTZXJ2aWNlcyB2ZXJzaW9uIG51bWJlci4KIz4KZnVuY3Rpb24gR2V0LVNRTFBhdGgKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEZlYXR1cmUsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRJbnN0YW5jZU5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRTUUxWZXJzaW9uCiAgICApCgogICAgaWYgKCgkRmVhdHVyZSAtZXEgJ1NRTEVOR0lORScpIC1vciAoJEZlYXR1cmUgLWVxICdBUycpKQogICAgewogICAgICAgIHN3aXRjaCAoJEZlYXR1cmUpCiAgICAgICAgewogICAgICAgICAgICAnU1FMRU5HSU5FJwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkcHJvZHVjdGluc3RhbmNlSWQgPSAnU1FMJwogICAgICAgICAgICB9CgogICAgICAgICAgICAnQVMnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRwcm9kdWN0aW5zdGFuY2VJZCA9ICdPTEFQJwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkaW5zdGFuY2VJZCA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcTWljcm9zb2Z0IFNRTCBTZXJ2ZXJcSW5zdGFuY2UgTmFtZXNcJCgkcHJvZHVjdGluc3RhbmNlSWQpIiAtTmFtZSAkSW5zdGFuY2VOYW1lKS4kSW5zdGFuY2VOYW1lCiAgICAgICAgJHBhdGggPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE1pY3Jvc29mdCBTUUwgU2VydmVyXCQoJGluc3RhbmNlSWQpXHNldHVwIiAtTmFtZSAnU1FMQmluUm9vdCcpLlNRTEJpblJvb3QKICAgIH0KCiAgICBpZiAoJEZlYXR1cmUgLWVxICdJUycpCiAgICB7CiAgICAgICAgJHBhdGggPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAoIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxNaWNyb3NvZnQgU1FMIFNlcnZlclwkKCRTUUxWZXJzaW9uKTBcRFRTXHNldHVwIikgLU5hbWUgJ1NRTFBhdGgnKS5TUUxQYXRoCiAgICB9CgogICAgcmV0dXJuICRwYXRoCn0KCjwjCiAgICAuU1lOT1BTSVMKICAgICAgICBFdmFsdWF0ZXMgaWYgdGhlIGZpcmV3YWxsIHJ1bGUgaXMgaW4gZGVzaXJlZCBzdGF0ZS4KCiAgICAuUEFSQU1FVEVSIERpc3BsYXlOYW1lCiAgICAgICAgU3RyaW5nIGNvbnRhaW5pbmcgdGhlIGRpc3BsYXkgbmFtZSBmb3IgdGhlIGZpcmV3YWxsIHJ1bGUuCgogICAgLlBBUkFNRVRFUiBFbmFibGVkCiAgICAgICAgU3RyaW5nIGNvbnRhaW5pbmcgZWl0aGVyICdUcnVlJyBvciAnRmFsc2UnIG1lYW5pbmcgaWYgdGhlIGZpcmV3YWxsIHJ1bGUgc2hvdWxkIGJlIGFjdGl2ZSBvciBub3QuCgogICAgLlBBUkFNRVRFUiBQcm9maWxlCiAgICAgICAgU3RyaW5nIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgcHJvZmlsZXMgdG8gd2hpY2ggdGhlIGZpcmV3YWxsIHJ1bGUgaXMgYXNzaWduZWQuCgogICAgLlBBUkFNRVRFUiBEaXJlY3Rpb24KICAgICAgICBTdHJpbmcgY29udGFpbmluZyB0aGUgZGlyZWN0aW9uIG9mIHRyYWZmaWMgZm9yIHRoZSB0aGUgZmlyZXdhbGwgcnVsZS4gSXQgY2FuIGJlIGVpdGhlciAnSW5ib3VuZCcgb3IgJ091dGJvdW5kJy4KCiAgICAuUEFSQU1FVEVSIFByb2dyYW0KICAgICAgICBTdHJpbmcgY29udGFpbmluZyB0aGUgcGF0aCB0byBhbiBleGVjdXRhYmxlLiBUaGlzIHBhcmFtYXRlciBpcyBvcHRpb25hbC4KCiAgICAuUEFSQU1FVEVSIFNlcnZpY2UKICAgICAgICBTdHJpbmcgY29udGFpbmluZyB0aGUgbmFtZSBvZiBhIHNlcnZpY2UgZm9yIHRoZSBmaXJld2FsbCBydWxlLiBUaGlzIHBhcmFtZXRlciBpcyBvcHRpb25hbC4KCiAgICAuUEFSQU1FVEVSIFByb3RvY29sCiAgICAgICAgU3RyaW5nIGNvbnRhaW5pbmcgdGhlIHByb3RvY29sIGZvciB0aGUgbG9jYWwgcG9ydCBwYXJhbWV0ZXIuIFRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLgoKICAgIC5QQVJBTUVURVIgTG9jYWxQb3J0CiAgICAgICAgU3RyaW5nIGNvbnRhaW5pbmcgdGhlIGxvY2FsIHBvcnQgZm9yIHRoZSBmaXJld2FsbCBydWxlLiBUaGlzIHBhcmFtZXRlciBpcyBvcHRpb25hbCwgd2l0aCB0aGUgZXhjZXB0aW9uIHRoYXQgaWYKICAgICAgICB0aGUgcGFyYW1ldGVyIFByb3RvY29sIGlzIHNwZWNpZmllZCB0aGlzIHBhcmFtZXRlciBtdXN0IGFsc28gYmUgc3BlY2lmaWVkLgojPgpmdW5jdGlvbiBUZXN0LUlzRmlyZXdhbGxSdWxlSW5EZXNpcmVkU3RhdGUKewogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkRGlzcGxheU5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1RydWUnLCdGYWxzZScpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEVuYWJsZWQsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdBbnknLCdEb21haW4nLCdQcml2YXRlJywnUHVibGljJywnTm90QXBwbGljYWJsZScpXQogICAgICAgICRQcm9maWxlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdJbmJvdW5kJywnT3V0Ym91bmQnKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICREaXJlY3Rpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQcm9ncmFtLAoKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkU2VydmljZSwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnVENQJywnVURQJywnSUNNUHY0JywnSUNNUHY2JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUHJvdG9jb2wsCgogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRMb2NhbFBvcnQKICAgICkKCiAgICAkaXNSdWxlSW5EZXNpcmVkU3RhdGUgPSAkZmFsc2UKCiAgICBpZiAoJGZpcmV3YWxsUnVsZSA9IEdldC1OZXRGaXJld2FsbFJ1bGUgLURpc3BsYXlOYW1lICREaXNwbGF5TmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkKICAgIHsKICAgICAgICBpZiAoKCRmaXJld2FsbFJ1bGUuRW5hYmxlZCAtZXEgJEVuYWJsZWQpIC1hbmQgKCRmaXJld2FsbFJ1bGUuUHJvZmlsZSAtZXEgJFByb2ZpbGUpIC1hbmQgKCRmaXJld2FsbFJ1bGUuRGlyZWN0aW9uIC1lcSAkRGlyZWN0aW9uKSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoJ1Byb2dyYW0nKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRmaXJld2FsbEFwcGxpY2F0aW9uRmlsdGVyID0gR2V0LU5ldEZpcmV3YWxsQXBwbGljYXRpb25GaWx0ZXIgLUFzc29jaWF0ZWROZXRGaXJld2FsbFJ1bGUgJGZpcmV3YWxsUnVsZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAoJGZpcmV3YWxsQXBwbGljYXRpb25GaWx0ZXIuUHJvZ3JhbSAtZXEgJFByb2dyYW0pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkaXNSdWxlSW5EZXNpcmVkU3RhdGUgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5Db250YWluc0tleSgnU2VydmljZScpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJGZpcmV3YWxsU2VydmljZUZpbHRlciA9IEdldC1OZXRGaXJld2FsbFNlcnZpY2VGaWx0ZXIgLUFzc29jaWF0ZWROZXRGaXJld2FsbFJ1bGUgJGZpcmV3YWxsUnVsZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAoJGZpcmV3YWxsU2VydmljZUZpbHRlci5TZXJ2aWNlIC1lcSAkU2VydmljZSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpc1J1bGVJbkRlc2lyZWRTdGF0ZSA9ICR0cnVlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzLkNvbnRhaW5zS2V5KCdQcm90b2NvbCcpIC1hbmQgJFBTQm91bmRQYXJhbWV0ZXJzLkNvbnRhaW5zS2V5KCdMb2NhbFBvcnQnKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRmaXJld2FsbFBvcnRGaWx0ZXIgPSBHZXQtTmV0RmlyZXdhbGxQb3J0RmlsdGVyIC1Bc3NvY2lhdGVkTmV0RmlyZXdhbGxSdWxlICRmaXJld2FsbFJ1bGUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRmaXJld2FsbFBvcnRGaWx0ZXIuUHJvdG9jb2wgLWVxICRQcm90b2NvbCAtYW5kICRmaXJld2FsbFBvcnRGaWx0ZXIuTG9jYWxQb3J0IC1lcSAkTG9jYWxQb3J0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGlzUnVsZUluRGVzaXJlZFN0YXRlID0gJHRydWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuICRpc1J1bGVJbkRlc2lyZWRTdGF0ZQp9Cgo8IwogICAgLlNZTk9QU0lTCiAgICAgICAgUmV0dXJucyB0aGUgU1FMIFNlcnZlciBtYWpvciB2ZXJzaW9uIGZyb20gdGhlIHNldHVwLmV4ZSBleGVjdXRhYmxlIHByb3ZpZGVkIGluIHRoZSBQYXRoIHBhcmFtZXRlci4KCiAgICAuUEFSQU1FVEVSIFBhdGgKICAgICAgICBTdHJpbmcgY29udGFpbmluZyB0aGUgcGF0aCB0byB0aGUgU1FMIFNlcnZlciBzZXR1cC5leGUgZXhlY3V0YWJsZS4KIz4KZnVuY3Rpb24gR2V0LVNxbE1ham9yVmVyc2lvbgp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkcGF0aAogICAgKQoKICAgIChHZXQtSXRlbSAtUGF0aCAkcGF0aCkuVmVyc2lvbkluZm8uUHJvZHVjdFZlcnNpb24uU3BsaXQoJy4nKVswXQp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
