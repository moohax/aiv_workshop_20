Get-ChildItem-Color.ps1,b8599eedd0a6a13ace9a6294c855f755,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LUNoaWxkSXRlbS1Db2xvciB7CiAgICBpZiAoJEFyZ3NbMF0gLWVxICR0cnVlKSB7CiAgICAgICAgJGlmd2lkZSA9ICR0cnVlCgogICAgICAgIGlmICgkQXJncy5MZW5ndGggLWd0IDEpIHsKICAgICAgICAgICAgJEFyZ3MgPSAkQXJnc1sxLi4oJEFyZ3MubGVuZ3RoIC0gMSldCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJEFyZ3MgPSBAKCkKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgICRpZndpZGUgPSAkZmFsc2UKICAgIH0KCiAgICBpZiAoKCRBcmdzWzBdIC1lcSAiLWEiKSAtb3IgKCRBcmdzWzBdIC1lcSAiLS1hbGwiKSkgewogICAgICAgICRBcmdzWzBdID0gIi1Gb3JjZSIKICAgIH0KCiAgICAkd2lkdGggPSAgJGhvc3QuVUkuUmF3VUkuV2luZG93U2l6ZS5XaWR0aAogICAgCiAgICAkaXRlbXMgPSBJbnZva2UtRXhwcmVzc2lvbiAiR2V0LUNoaWxkSXRlbSBgIiRBcmdzYCIiOwogICAgJGxuU3RyID0gJGl0ZW1zIHwgc2VsZWN0LW9iamVjdCBOYW1lIHwgc29ydC1vYmplY3QgeyAiJF8iLmxlbmd0aCB9IC1kZXNjZW5kaW5nIHwgc2VsZWN0LW9iamVjdCAtZmlyc3QgMQogICAgJGxlbiA9ICRsblN0ci5uYW1lLmxlbmd0aAogICAgJGNvbHMgPSBJZiAoJGxlbikgeygkd2lkdGgrMSkvKCRsZW4rMil9IEVsc2UgezF9OwogICAgJGNvbHMgPSBbbWF0aF06OmZsb29yKCRjb2xzKTsKICAgIGlmKCEkY29scyl7ICRjb2xzPTE7fQoKICAgICRjb2xvcl9mb3JlID0gJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yCgogICAgJGNvbXByZXNzZWRfbGlzdCA9IEAoIi43eiIsICIuZ3oiLCAiLnJhciIsICIudGFyIiwgIi56aXAiKQogICAgJGV4ZWN1dGFibGVfbGlzdCA9IEAoIi5leGUiLCAiLmJhdCIsICIuY21kIiwgIi5weSIsICIucGwiLCAiLnBzMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiLnBzbTEiLCAiLnZicyIsICIucmIiLCAiLnJlZyIsICIuZnN4IikKICAgICRkbGxfcGRiX2xpc3QgPSBAKCIuZGxsIiwgIi5wZGIiKQogICAgJHRleHRfZmlsZXNfbGlzdCA9IEAoIi5jc3YiLCAiLmxnIiwgIm1hcmtkb3duIiwgIi5yc3QiLCAiLnR4dCIpCiAgICAkY29uZmlnc19saXN0ID0gQCgiLmNmZyIsICIuY29uZmlnIiwgIi5jb25mIiwgIi5pbmkiKQoKICAgICRjb2xvcl90YWJsZSA9IEB7fQogICAgZm9yZWFjaCAoJEV4dGVuc2lvbiBpbiAkY29tcHJlc3NlZF9saXN0KSB7CiAgICAgICAgJGNvbG9yX3RhYmxlWyRFeHRlbnNpb25dID0gIlllbGxvdyIKICAgIH0KCiAgICBmb3JlYWNoICgkRXh0ZW5zaW9uIGluICRleGVjdXRhYmxlX2xpc3QpIHsKICAgICAgICAkY29sb3JfdGFibGVbJEV4dGVuc2lvbl0gPSAiQmx1ZSIKICAgIH0KCiAgICBmb3JlYWNoICgkRXh0ZW5zaW9uIGluICR0ZXh0X2ZpbGVzX2xpc3QpIHsKICAgICAgICAkY29sb3JfdGFibGVbJEV4dGVuc2lvbl0gPSAiQ3lhbiIKICAgIH0KCiAgICBmb3JlYWNoICgkRXh0ZW5zaW9uIGluICRkbGxfcGRiX2xpc3QpIHsKICAgICAgICAkY29sb3JfdGFibGVbJEV4dGVuc2lvbl0gPSAiRGFya2dyZWVuIgogICAgfQoKICAgIGZvcmVhY2ggKCRFeHRlbnNpb24gaW4gJGNvbmZpZ3NfbGlzdCkgewogICAgICAgICRjb2xvcl90YWJsZVskRXh0ZW5zaW9uXSA9ICJEYXJrWWVsbG93IgogICAgfQoKICAgICRpID0gMAogICAgJHBhZCA9IFttYXRoXTo6Y2VpbGluZygoJHdpZHRoKzIpIC8gJGNvbHMpIC0gMwogICAgJG5ubCA9ICRmYWxzZQoKICAgICRpdGVtcyB8CiAgICAlewogICAgICAgIGlmICgkXy5HZXRUeXBlKCkuTmFtZSAtZXEgJ0RpcmVjdG9yeUluZm8nKSB7CiAgICAgICAgICAgICRjID0gJ0dyZWVuJwogICAgICAgICAgICAkbGVuZ3RoID0gIiIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkYyA9ICRjb2xvcl90YWJsZVskXy5FeHRlbnNpb25dCgogICAgICAgICAgICBpZiAoJGMgLWVxICRub25lKSB7CiAgICAgICAgICAgICAgICAkYyA9ICRjb2xvcl9mb3JlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRsZW5ndGggPSAkXy5sZW5ndGgKICAgICAgICB9CgogICAgICAgICMgZ2V0IHRoZSBkaXJlY3RvcnkgbmFtZQogICAgICAgIGlmICgkXy5HZXRUeXBlKCkuTmFtZSAtZXEgIkZpbGVJbmZvIikgewogICAgICAgICAgICAkRGlyZWN0b3J5TmFtZSA9ICRfLkRpcmVjdG9yeU5hbWUKICAgICAgICB9IGVsc2VpZiAoJF8uR2V0VHlwZSgpLk5hbWUgLWVxICJEaXJlY3RvcnlJbmZvIikgewogICAgICAgICAgICAkRGlyZWN0b3J5TmFtZSA9ICRfLlBhcmVudC5GdWxsTmFtZQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoJGlmd2lkZSkgeyAgIyBXaWRlIChscykKICAgICAgICAgICAgaWYgKCRMYXN0RGlyZWN0b3J5TmFtZSAtbmUgJERpcmVjdG9yeU5hbWUpIHsgICMgY2hhbmdlIHRoaXMgdG8gYCRMYXN0RGlyZWN0b3J5TmFtZSAtbmUgJERpcmVjdG9yeU5hbWVgIHRvIHNob3cgRGlyZWN0b3J5TmFtZQogICAgICAgICAgICAgICAgaWYoJGkgLW5lIDAgLUFORCAkaG9zdC51aS5yYXd1aS5DdXJzb3JQb3NpdGlvbi5YIC1uZSAwKXsgIyBjb25kaXRpb25hbGx5IGFkZCBhbiBlbXB0eSBsaW5lCiAgICAgICAgICAgICAgICAgICAgd3JpdGUtaG9zdCAiIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAtRm9yZSAkY29sb3JfZm9yZSAoImBuICAgRGlyZWN0b3J5OiAkRGlyZWN0b3J5TmFtZWBuIikKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG5ubCA9ICsrJGkgJSAkY29scyAtbmUgMAoKICAgICAgICAgICAgIyB0cnVuY2F0ZSB0aGUgaXRlbSBuYW1lCiAgICAgICAgICAgICR0b3dyaXRlID0gJF8uTmFtZQogICAgICAgICAgICBpZiAoJHRvd3JpdGUubGVuZ3RoIC1ndCAkcGFkKSB7CiAgICAgICAgICAgICAgICAkdG93cml0ZSA9ICR0b3dyaXRlLlN1YnN0cmluZygwLCAkcGFkIC0gMykgKyAiLi4uIgogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1Ib3N0ICgiezAsLSRwYWR9IiAtZiAkdG93cml0ZSkgLUZvcmUgJGMgLU5vTmV3TGluZTokbm5sCiAgICAgICAgICAgIGlmKCRubmwpewogICAgICAgICAgICAgICAgd3JpdGUtaG9zdCAiICAiIC1Ob05ld0xpbmUKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIElmICgkTGFzdERpcmVjdG9yeU5hbWUgLW5lICREaXJlY3RvcnlOYW1lKSB7ICAjIGZpcnN0IGl0ZW0gLSBwcmludCBvdXQgdGhlIGhlYWRlcgogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiYG4gICAgRGlyZWN0b3J5OiAkRGlyZWN0b3J5TmFtZWBuIgogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiTW9kZSAgICAgICAgICAgICAgICBMYXN0V3JpdGVUaW1lICAgICBMZW5ndGggTmFtZSIKICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIi0tLS0gICAgICAgICAgICAgICAgLS0tLS0tLS0tLS0tLSAgICAgLS0tLS0tIC0tLS0iCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yID0gJGMKCiAgICAgICAgICAgIFdyaXRlLUhvc3QgKCJ7MCwtN30gezEsMjV9IHsyLDEwfSB7M30iIC1mICRfLm1vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgIChbU3RyaW5nXTo6Rm9ybWF0KCJ7MCwxMH0gIHsxLDh9IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF8uTGFzdFdyaXRlVGltZS5Ub1N0cmluZygiZCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5MYXN0V3JpdGVUaW1lLlRvU3RyaW5nKCJ0IikpKSwKICAgICAgICAgICAgICAgICAgICAgICAgJGxlbmd0aCwgJF8ubmFtZSkKICAgICAgICAgICAKICAgICAgICAgICAgJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yID0gJGNvbG9yX2ZvcmUKCiAgICAgICAgICAgICsrJGkgICMgaW5jcmVhc2UgdGhlIGNvdW50ZXIKICAgICAgICB9CiAgICAgICAgJExhc3REaXJlY3RvcnlOYW1lID0gJERpcmVjdG9yeU5hbWUKICAgIH0KCiAgICBpZiAoJG5ubCkgeyAgIyBjb25kaXRpb25hbGx5IGFkZCBhbiBlbXB0eSBsaW5lCiAgICAgICAgV3JpdGUtSG9zdCAiIgogICAgfQp9CgpmdW5jdGlvbiBHZXQtQ2hpbGRJdGVtLUZvcm1hdC1XaWRlIHsKICAgICROZXdfQXJncyA9IEAoJHRydWUpCiAgICAkTmV3X0FyZ3MgKz0gIiRBcmdzIgogICAgSW52b2tlLUV4cHJlc3Npb24gIkdldC1DaGlsZEl0ZW0tQ29sb3IgJE5ld19BcmdzIgp9Cg==
