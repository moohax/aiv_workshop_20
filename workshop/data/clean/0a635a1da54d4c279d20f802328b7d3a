Set-KSEventLogCode.ps1,1b0b8ac8af36059fd4085267149b511f,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gU2V0LUtTRXZlbnRMb2dDb2RlIHsKICAjIC5TWU5PUFNJUwogICMgICBTZXQgZXZlbnQgbG9nIGNvZGVzIGZvciB1c2UgYnkgYSBoYW5kbGUuCiAgIyAuREVTQ1JJUFRJT04KICAjICAgU2V0LUtTRXZlbnRMb2dDb2RlIGFsbG93cyB0aGUgbW9kaWZpY2F0aW9uIG9mIGV4aXN0aW5nIGNvZGVzIG9yIHRoZSBkZWZpbml0aW9uIG9mIGEgbmV3IHNldCBvZiBldmVudCBsb2cgY29kZXMgZm9yIGEgaGFuZGxlLiBUaGUgaGFuZGxlIG1heSBiZSBhIHNjcmlwdCBuYW1lLCBtb2R1bGUgbmFtZSBvciBhbiBhcmJpdHJhcnkgc3RyaW5nLgogICMKICAjICAgQ29kZXMgYXJlIGFzc2lnbmVkIGFzIGZvbGxvd3M6CiAgIwogICMgICAgKiBJbmZvcm1hdGlvbiBjb2RlcyBzdGFydCBmcm9tIDEwMDAKICAjICAgICogV2FybmluZyBjb2RlcyBzdGFydCBmcm9tIDMwMDAKICAjICAgICogRXJyb3IgY29kZXMgc3RhcnQgZnJvbSA1MDAwCiAgIwogICMgICBOZXcgY29kZXMgYXJlIGF1dG9tYXRpY2FsbHkgY3JlYXRlZCBpZiBubyB2YWx1ZXMgYXJlIHNwZWNpZmllZC4gTmV3IGNvZGVzIGFyZSBnZW5lcmF0ZWQgdXNpbmcgdGhlIGZvbGxvd2luZyBzdGVwczoKICAjCiAgIyAgICAgMS4gR2V0IGFsbCBleGlzdGluZyBjb2RlcwogICMgICAgIDIuIEZpbmQgdGhlIGhpZ2hlc3QgbnVtYmVyIGFib3ZlIHRoZSBzdGFydGluZyBwb2ludCBmb3IgZWFjaCBpbmRpdmlkdWFsIGNvZGUKICAjICAgICAzLiBHZW5lcmF0ZSBhIG5ldyBjb2RlLXNldCBiYXNlZCBvbiB0aGUgaGlnaGVzdCBudW1iZXIgcmV0dXJuZWQKICAjCiAgIyAgIEZvciBleGFtcGxlLCB0aGUgY29kZXMgMTA0MiwgMzA0MiBhbmQgNTA0MiAoZm9yIEluZm9ybWF0aW9uLCBXYXJuaW5nIGFuZCBFcnJvciByZXNwZWN0aXZlbHkpIHdpbGwgYmUgZ2VuZXJhdGVkIGlmIHRoZSBoaWdoZXN0IHByZXZpb3VzbHkgYWxsb2NhdGVkIGNvZGVzIGZvciBlYWNoIGFyZSAxMDA0LCAzMDQxIGFuZCA1MDQwLgogICMKICAjICAgRXZlbnQgbG9nIGNvZGVzIG1heSBiZSByZXVzZWQgKGlmIHJlbW92ZWQpLCBhbmQgaGFuZGxlcyBtYXkgc2hhcmUgY29kZXMuIFJldXNlIHdpbGwgbm90IGhhcHBlbiBhdXRvbWF0aWNhbGx5IHVubGVzcyB0aGUgaGlnaGVzdCBjb2RlIGlzIHJlbW92ZWQuCiAgIwogICMgICBTZXQtS1NFdmVudExvZ0NvZGUgd2lsbCBhdHRlbXB0IHRvIHJlZ2lzdGVyIEtTY3JpcHQgYXMgYW4gQXBwbGljYXRpb24gZXZlbnQgc291cmNlIGlmIGl0IGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQuCiAgIyAuUEFSQU1FVEVSIE5hbWUKICAjICAgVGhlIG5hbWUgb2YgdGhlIG5ldyBzY3JpcHQsIG1vZHVsZSBvciBhIGdlbmVyaWMgaGFuZGxlLgogICMgLlBBUkFNRVRFUiBJbmZvcm1hdGlvbgogICMgICBUaGUgbG9nIGNvZGUgdG8gdXNlIGZvciBJbmZvcm1hdGlvbiBtZXNzYWdlcy4KICAjIC5QQVJBTUVURVIgV2FybmluZwogICMgICBUaGUgbG9nIGNvZGUgdG8gdXNlIGZvciBXYXJuaW5nIG1lc3NhZ2VzLgogICMgLlBBUkFNRVRFUiBFcnJvcgogICMgICBUaGUgbG9nIGNvZGUgdG8gdXNlIGZvciBFcnJvciBtZXNzYWdlcy4KICAjIC5JTlBVVFMKICAjICAgU3lzdGVtLlN0cmluZwogICMgICBTeXN0ZW0uVUludDMyCiAgIyAuRVhBTVBMRQogICMgICBTZXQtS1NFdmVudExvZ0NvZGUgLU5hbWUgIktTY3JpcHQuQmFzZSIgLUluZm9ybWF0aW9uIDEwMjAKICAjCiAgIyAgIFJlZ2lzdGVyIGV2ZW50IGxvZyBjb2RlcyBmb3IgdXNlIHdpdGggS1NjcmlwdC5CYXNlLgogICMgLk5PVEVTCiAgIyAgIEF1dGhvcjogQ2hyaXMgRGVudAogICMgICBUZWFtOiAgIENvcmUgVGVjaG5vbG9naWVzCiAgIwogICMgICBDaGFuZ2UgbG9nOgogICMgICAgIDA5LzA3LzIwMTQgLSBDaHJpcyBEZW50IC0gRmlyc3QgcmVsZWFzZS4KICAKICBbQ21kTGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZSA9ICdBdXRvbWF0aWMnKV0KICBwYXJhbSgKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMSldCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW1N0cmluZ10kTmFtZSwKICAgIAogICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZSA9ICdNYW51YWwnKV0KICAgIFtVSW50MzJdJEluZm9ybWF0aW9uLAogICAgCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBQYXJhbWV0ZXJTZXROYW1lID0gJ01hbnVhbCcpXQogICAgW1VJbnQzMl0kV2FybmluZywKICAgIAogICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZSA9ICdNYW51YWwnKV0KICAgIFtVSW50MzJdJEVycm9yCiAgKQogIAogIGlmICgtbm90IFtEaWFnbm9zdGljcy5FdmVudExvZ106OlNvdXJjZUV4aXN0cygiS1NjcmlwdCIpKSB7CiAgICBOZXctRXZlbnRMb2cgLUxvZ05hbWUgQXBwbGljYXRpb24gLVNvdXJjZSBLU2NyaXB0IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICBpZiAoLW5vdCAkPykgewogICAgICBXcml0ZS1XYXJuaW5nICJHZXQtS1NFdmVudExvZ0NvZGU6IEtTY3JpcHQgZXZlbnQgc291cmNlIGRvZXMgbm90IGV4aXN0LiIKICAgIH0KICB9CgogICRGaWxlTmFtZSA9IEdldC1LU1NldHRpbmcgS1NFdmVudExvZ0NvZGVzIC1FeHBhbmRWYWx1ZQogIGlmICgtbm90IChUZXN0LVBhdGggJEZpbGVOYW1lIC1QYXRoVHlwZSBMZWFmKSkgewogICAgJEVycm9yUmVjb3JkID0gTmV3LU9iamVjdCBNYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JSZWNvcmQoCiAgICAgIChOZXctT2JqZWN0IEV4Y2VwdGlvbiAiVW5hYmxlIHRvIGFjY2VzcyBnbG9iYWwgc2V0dGluZ3MgZmlsZSAoJEZpbGVOYW1lKS4iKSwKICAgICAgIlJlc291cmNlVW5hdmFpbGFibGUiLAogICAgICBbTWFuYWdlbWVudC5BdXRvbWF0aW9uLkVycm9yQ2F0ZWdvcnldOjpSZXNvdXJjZVVuYXZhaWxhYmxlLAogICAgICAkcHNjbWRsZXQpCiAgICAkcHNjbWRsZXQuVGhyb3dUZXJtaW5hdGluZ0Vycm9yKCRFcnJvclJlY29yZCkKICB9CiAgCiAgaWYgKCRwc2NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAnQXV0b21hdGljJykgewogICAgIyBHZW5lcmF0ZSBJbmZvcm1hdGlvbiwgV2FybmluZyBhbmQgRXJyb3IgY29kZXMgKGFzIGFuIGluY3JlbWVudCBvZiB0aGUgaGlnaGVzdCBtb2R1bHVzKQogICAgJE9mZnNldCA9IDAKICAgIEdldC1LU0V2ZW50TG9nQ29kZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgJENvZGVTZXQgPSAkXwogICAgICAnSW5mb3JtYXRpb24nLCAnV2FybmluZycsICdFcnJvcicgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgJE1vZHVsdXMgPSAkQ29kZVNldC4kXyAlIDEwMDAKICAgICAgICBpZiAoJE1vZHVsdXMgLWd0ICRPZmZzZXQpIHsKICAgICAgICAgICRPZmZzZXQgPSAkTW9kdWx1cwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgIyBJbmNyZW1lbnQgdGhlIG9mZnNldCAKICAgICRPZmZzZXQgPSAkT2Zmc2V0KysKICAgIAogICAgJEluZm9ybWF0aW9uID0gMTAwMCArICRPZmZzZXQKICAgICRXYXJuaW5nID0gMzAwMCArICRPZmZzZXQKICAgICRFcnJvciA9IDUwMDAgKyAkT2Zmc2V0CiAgfQogIAogICRYUGF0aE5hdmlnYXRvciA9IE5ldy1LU1hQYXRoTmF2aWdhdG9yIC1GaWxlTmFtZSAkRmlsZU5hbWUgLU1vZGUgV3JpdGUKCiAgJFhQYXRoTm9kZSA9ICRYUGF0aE5hdmlnYXRvci5TZWxlY3QoIi9FdmVudExvZ0NvZGVzL0V2ZW50TG9nQ29kZVt0cmFuc2xhdGUoTmFtZSwgJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJywgJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Jyk9JyQoJE5hbWUuVG9Mb3dlcigpKSddIikKCiAgaWYgKCgkWFBhdGhOb2RlIHwgTWVhc3VyZS1PYmplY3QpLkNvdW50IC1ndCAwKSB7CiAgICAkRXZlbnRMb2dDb2RlID0gJFhQYXRoTm9kZSB8IENvbnZlcnRGcm9tLUtTWFBhdGhOb2RlCiAgICAKICAgICdJbmZvcm1hdGlvbicsICdXYXJuaW5nJywgJ0Vycm9yJyB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgaWYgKCRwc2JvdW5kcGFyYW1ldGVycy5Db250YWluc0tleSgkXykgLWFuZCAkRXZlbnRMb2dDb2RlLiRfIC1uZSAoR2V0LVZhcmlhYmxlICRfKS5WYWx1ZSkgewogICAgICAgICRYUGF0aE5vZGUuU2VsZWN0KCIuLyRfIikuU2V0VmFsdWUoKEdldC1WYXJpYWJsZSAkXykuVmFsdWUpCiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgJFhQYXRoTmF2aWdhdG9yLlNlbGVjdCgiL0V2ZW50TG9nQ29kZXMiKS5BcHBlbmRDaGlsZCgKICAgICAgIjxFdmVudExvZ0NvZGU+PE5hbWU+JE5hbWU8L05hbWU+PEluZm9ybWF0aW9uPiRJbmZvcm1hdGlvbjwvSW5mb3JtYXRpb24+PFdhcm5pbmc+JFdhcm5pbmc8L1dhcm5pbmc+PEVycm9yPiRFcnJvcjwvRXJyb3I+PC9FdmVudExvZ0NvZGU+IgogICAgKQogIH0KICAKICAkWFBhdGhOYXZpZ2F0b3IuVW5kZXJseWluZ09iamVjdC5TYXZlKCRGaWxlTmFtZSkKCiAgaWYgKCRQYXNzVGhydSkgewogICAgR2V0LUtTRXZlbnRMb2dDb2RlIC1OYW1lICROYW1lCiAgfQp9
