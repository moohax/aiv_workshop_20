TabExpansionUtil.ps1,ce81b4c545c1d470b42fff39d4d0347e,Scan result is 1. IsMalware: 0,IyBUYWJFeHBhbnNpb25VdGlsLnBzMQojCiMgCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyBQcml2YXRlIGZ1bmN0aW9ucwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpGdW5jdGlvbiBPdXQtRGF0YUdyaWRWaWV3IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKCQlbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUmV0dXJuRmllbGQKICAgICAgICAsCgkJW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZSA9ICR0cnVlKV0KICAgICAgICBbT2JqZWN0W11dCiAgICAgICAgJElucHV0T2JqZWN0CiAgICApCgogICAgYmVnaW4gewogICAgICAgIFtPYmplY3RbXV0kT2JqZWN0cyA9IEAoKQogICAgfQoKICAgIHByb2Nlc3MgewogICAgICAgICRPYmplY3RzICs9ICRJbnB1dE9iamVjdAogICAgfQoKICAgIGVuZCB7CiAgICAgICAgIyBNYWtlIERhdGFUYWJsZSBmcm9tIElucHV0CiAgICAgICAgJGR0ID0gTmV3LU9iamVjdCBTeXN0ZW0uRGF0YS5EYXRhVGFibGUKICAgICAgICAkRmlyc3QgPSAkdHJ1ZQogICAgICAgIGZvcmVhY2ggKCRJdGVtIGluICRPYmplY3RzKSB7CiAgICAgICAgICAgICRkciA9ICRkdC5OZXdSb3coKQogICAgICAgICAgICAkSXRlbS5QU09iamVjdC5nZXRfUHJvcGVydGllcygpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgaWYgKCRmaXJzdCkgewogICAgICAgICAgICAgICAgICAgICRjb2wgPSAgTmV3LU9iamVjdCBTeXN0ZW0uRGF0YS5EYXRhQ29sdW1uCiAgICAgICAgICAgICAgICAgICAgJGNvbC5Db2x1bW5OYW1lID0gJF8uTmFtZS5Ub1N0cmluZygpCiAgICAgICAgICAgICAgICAgICAgJGR0LkNvbHVtbnMuQWRkKCRjb2wpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoJF8uVmFsdWUgLWVxICRudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgJGRyLkl0ZW0oJF8uTmFtZSkgPSAiW2VtcHR5XSIKICAgICAgICAgICAgICAgIH0gZWxzZWlmICgkXy5Jc0FycmF5KSB7CiAgICAgICAgICAgICAgICAgICAgJGRyLkl0ZW0oJF8uTmFtZSkgPVtTdHJpbmddOjpKb2luKCRfLlZhbHVlICwiOyIpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICRkci5JdGVtKCRfLk5hbWUpID0gJF8uVmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkZHQuUm93cy5BZGQoJGRyKQogICAgICAgICAgICAkRmlyc3QgPSAkZmFsc2UKICAgICAgICB9CgogICAgICAgICMgU2hvdyBEYXRhdGFibGUgaW4gRm9ybQogICAgICAgICRmb3JtID0gTmV3LU9iamVjdCBTeXN0ZW0uV2luZG93cy5Gb3Jtcy5Gb3JtCiAgICAgICAgJGZvcm0uU2l6ZSA9IG5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuU2l6ZSBAKDEwMDAsNjAwKQogICAgICAgICRkZyA9IE5ldy1PYmplY3QgU3lzdGVtLldpbmRvd3MuRm9ybXMuRGF0YUdyaWRWaWV3CiAgICAgICAgJGRnLkRhdGFTb3VyY2UgPSAkZHQuUFNPYmplY3QuQmFzZU9iamVjdAogICAgICAgICRkZy5Eb2NrID0gW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkRvY2tTdHlsZV06OkZpbGwKICAgICAgICAkZGcuQ29sdW1uSGVhZGVyc0hlaWdodFNpemVNb2RlID0gW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkRhdGFHcmlkVmlld0NvbHVtbkhlYWRlcnNIZWlnaHRTaXplTW9kZV06OkF1dG9TaXplCiAgICAgICAgJGRnLlNlbGVjdGlvbk1vZGUgPSAnRnVsbFJvd1NlbGVjdCcKICAgICAgICAkZGcuYWRkX0RvdWJsZUNsaWNrKHsKICAgICAgICAgICAgJHNjcmlwdDpyZXQgPSAkdGhpcy5TZWxlY3RlZFJvd3MgfCBGb3JFYWNoLU9iamVjdCB7JF8uRGF0YUJvdW5kSXRlbVsiJFJldHVybkZpZWxkIl19CiAgICAgICAgICAgICRmb3JtLkNsb3NlKCkKICAgICAgICB9KQoKICAgICAgICAkZm9ybS5UZXh0ID0gIiQoJE15SW52b2NhdGlvbi5MaW5lKSIKICAgICAgICAkZm9ybS5LZXlQcmV2aWV3ID0gJHRydWUKICAgICAgICAkZm9ybS5hZGRfS2V5RG93bih7CiAgICAgICAgICAgIGlmICgkXy5LZXlDb2RlIC1lcSAnRW50ZXInKSB7CiAgICAgICAgICAgICAgICAkc2NyaXB0OnJldCA9ICRkZy5TZWxlY3RlZFJvd3MgfCBGb3JFYWNoLU9iamVjdCB7JF8uRGF0YUJvdW5kSXRlbVsiJFJldHVybkZpZWxkIl19CiAgICAgICAgICAgICAgICAkZm9ybS5DbG9zZSgpCiAgICAgICAgICAgIH0gZWxzZWlmICgkXy5LZXlDb2RlIC1lcSAnRXNjYXBlJykgewogICAgICAgICAgICAgICAgJGZvcm0uQ2xvc2UoKQogICAgICAgICAgICB9CiAgICAgICAgfSkKCiAgICAgICAgJGZvcm0uQ29udHJvbHMuQWRkKCRkZykKICAgICAgICAkZm9ybS5hZGRfU2hvd24oeyRmb3JtLkFjdGl2YXRlKCk7ICRkZy5BdXRvUmVzaXplQ29sdW1ucygpfSkKICAgICAgICAkc2NyaXB0OnJldCA9ICRudWxsCiAgICAgICAgW1ZvaWRdJGZvcm0uU2hvd0RpYWxvZygpCiAgICAgICAgJHNjcmlwdDpyZXQKICAgIH0KfQoKIyMjIyMjIyMjIyMjCgpGdW5jdGlvbiBSZXNvbHZlLUNvbW1hbmQgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAoJCVtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMCwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJE5hbWUKICAgICAgICAsCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkQ29tbWFuZEluZm8KICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICAkQ29tbWFuZCA9ICIiCgogICAgICAgICMjIEdldCBjb21tYW5kIGluZm8sIHRoZSB3aGVyZSBjbGF1c2UgcHJldmVudHMgcHJvYmxlbXMgd2l0aCAiPyIgd2lsZGNhcmQKICAgICAgICBpZiAoJE5hbWUgLW1hdGNoICJcXCIpIHsKICAgICAgICAgICAgIyMgRnVsbCBuYW1lIHVzYWdlCiAgICAgICAgICAgICRNb2R1bGUgPSAkTmFtZS5TdWJzdHJpbmcoMCwgJE5hbWUuSW5kZXhvZigiXCIpKQogICAgICAgICAgICAkQ29tbWFuZE5hbWUgPSAkTmFtZS5TdWJzdHJpbmcoJE5hbWUuSW5kZXhvZigiXCIpICsgMSwgJE5hbWUubGVuZ3RoIC0gKCROYW1lLkluZGV4b2YoIlwiKSArIDEpKQogICAgICAgICAgICBpZiAoJE1vZHVsZSA9IEdldC1Nb2R1bGUgJE1vZHVsZSkgewogICAgICAgICAgICAgICAgJENvbW1hbmQgPSBAKEdldC1Db21tYW5kICRDb21tYW5kTmFtZSAtTW9kdWxlICRNb2R1bGUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpWzBdCiAgICAgICAgICAgICAgICBpZiAoLW5vdCAkQ29tbWFuZCkgewogICAgICAgICAgICAgICAgICAgICMjIFRyeSB0byBsb29rIHVwIGNvbW1hbmQgd2l0aCBwcmVmaXgKICAgICAgICAgICAgICAgICAgICAkUHJlZml4ID0gR2V0LUNvbW1hbmRQcmVmaXggJE1vZHVsZQogICAgICAgICAgICAgICAgICAgICRWZXJiID0gJENvbW1hbmROYW1lLlN1YnN0cmluZygwLCAkQ29tbWFuZE5hbWUuSW5kZXhvZigiLSIpKQogICAgICAgICAgICAgICAgICAgICROb3VuID0gJENvbW1hbmROYW1lLlN1YnN0cmluZygkQ29tbWFuZE5hbWUuSW5kZXhvZigiLSIpICsgMSwgJENvbW1hbmROYW1lLmxlbmd0aCAtICgkQ29tbWFuZE5hbWUuSW5kZXhvZigiLSIpICsgMSkpCiAgICAgICAgICAgICAgICAgICAgJENvbW1hbmQgPSBAKEdldC1Db21tYW5kICIkVmVyYi0kUHJlZml4JE5vdW4iIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKVswXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKC1ub3QgJENvbW1hbmQpIHsKICAgICAgICAgICAgICAgICAgICAjIyBUcnkgbG9va2luZyBpbiB0aGUgbW9kdWxlJ3MgZXhwb3J0ZWQgY29tbWFuZCBsaXN0CiAgICAgICAgICAgICAgICAgICAgJENvbW1hbmQgPSAkTW9kdWxlLkV4cG9ydGVkQ29tbWFuZHNbJENvbW1hbmROYW1lXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICgtbm90ICRDb21tYW5kKSB7CiAgICAgICAgICAgIGlmICgkTmFtZS5Db250YWlucygiPyIpKSB7CiAgICAgICAgICAgICAgICAkQ29tbWFuZCA9IEAoR2V0LUNvbW1hbmQgJE5hbWUgfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLWVxICROYW1lfSlbMF0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRDb21tYW5kID0gQChHZXQtQ29tbWFuZCAkTmFtZSlbMF0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCRDb21tYW5kLkNvbW1hbmRUeXBlIC1lcSAiQWxpYXMiKSB7CiAgICAgICAgICAgICRDb21tYW5kID0gJENvbW1hbmQuUmVzb2x2ZWRDb21tYW5kCQogICAgICAgIH0KCiAgICAgICAgIyMgUmV0dXJuIHJlc3VsdAogICAgICAgIGlmICgkQ29tbWFuZEluZm8pIHsKICAgICAgICAgICAgJENvbW1hbmQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoJENvbW1hbmQuQ29tbWFuZFR5cGUgLWVxICJFeHRlcm5hbFNjcmlwdCIpIHsKICAgICAgICAgICAgICAgICRDb21tYW5kLlBhdGgKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRDb21tYW5kLk5hbWUKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdHJhcCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QaXBlbGluZVN0b3BwZWRFeGNlcHRpb25dIHsKICAgICAgICAgICAgIyMgUGlwZWxpbmUgd2FzIHN0b3BwZWQKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICB9Cn0KCkZ1bmN0aW9uIFJlc29sdmUtUGFyYW1ldGVyIHsKICAgIFtDbWRsZXRCaW5kaW5nKERlZmF1bHRQYXJhbWV0ZXJTZXROYW1lID0gIkNvbW1hbmQiKV0KICAgIHBhcmFtKAoJCVtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICJDb21tYW5kIiwgTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMCwgVmFsdWVGcm9tUGlwZWxpbmVCeVByb3BlcnR5TmFtZSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJENvbW1hbmQKICAgICAgICAsCgkJW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gIkNvbW1hbmRJbmZvIiwgTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkNvbW1hbmRJbmZvXQogICAgICAgICRDb21tYW5kSW5mbwogICAgICAgICwKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBQb3NpdGlvbiA9IDEsIFZhbHVlRnJvbVBpcGVsaW5lQnlQcm9wZXJ0eU5hbWUgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICROYW1lCiAgICAgICAgLAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFBhcmFtZXRlckluZm8KICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICAjIyBSZW1vdmUgbGVhZGluZyBkYXNoIGlmIGl0IGV4aXN0cwogICAgICAgICROYW1lID0gJE5hbWUgLXJlcGxhY2UgJ14tJwoKICAgICAgICAjIyBHZXQgY29tbWFuZCBpbmZvCgkJaWYgKCRQU0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAiQ29tbWFuZCIpIHsKICAgICAgICAgICAgJENvbW1hbmRJbmZvID0gUmVzb2x2ZS1Db21tYW5kICRDb21tYW5kIC1Db21tYW5kSW5mbwogICAgICAgIH0gZWxzZWlmICgkUFNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgIkNvbW1hbmRJbmZvIikgewogICAgICAgICAgICBpZiAoJENvbW1hbmRJbmZvIC1lcSAkbnVsbCkge3JldHVybn0KICAgICAgICB9CgogICAgICAgICMjIENoZWNrIGlmIHRoaXMgaXMgYSByZWFsIHBhcmFtZXRlciBuYW1lIGFuZCBub3QgYW4gYWxpYXMKICAgICAgICBpZiAoJENvbW1hbmRJbmZvLlBhcmFtZXRlcnNbIiROYW1lIl0pIHsKICAgICAgICAgICAgJFBhcmFtZXRlciA9ICRDb21tYW5kSW5mby5QYXJhbWV0ZXJzWyIkTmFtZSJdCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIyMgUG9zc2libGUgYWxpYXMKICAgICAgICAgICAgJFBhcmFtZXRlciA9IEAoJENvbW1hbmRJbmZvLlBhcmFtZXRlcnMuVmFsdWVzIHwgV2hlcmUtT2JqZWN0IHskXy5BbGlhc2VzIC1jb250YWlucyAkTmFtZX0pWzBdCiAgICAgICAgfQoKICAgICAgICAjIyBJZiBubyBwYXJhbWV0ZXIgZm91bmQsIGl0IGNvdWxkIGJlIGFuIGFicmV2aWF0ZWQgbmFtZSAoLWNvbXAgaW5zdGVhZCBvZiAtQ29tcHV0ZXJOYW1lKQogICAgICAgIGlmICgtbm90ICRQYXJhbWV0ZXIpIHsKICAgICAgICAgICAgJFBhcmFtZXRlciA9IEAoJENvbW1hbmRJbmZvLlBhcmFtZXRlcnMuVmFsdWVzIHwgV2hlcmUtT2JqZWN0IHskXy5OYW1lIC1saWtlICIkTmFtZSoifSlbMF0KICAgICAgICB9CgogICAgICAgICMjIFJldHVybiByZXN1bHQKICAgICAgICBpZiAoJFBhcmFtZXRlckluZm8pIHsKICAgICAgICAgICAgJFBhcmFtZXRlcgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRQYXJhbWV0ZXIuTmFtZQogICAgICAgIH0KCiAgICAgICAgdHJhcCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QaXBlbGluZVN0b3BwZWRFeGNlcHRpb25dIHsKICAgICAgICAgICAgIyMgUGlwZWxpbmUgd2FzIHN0b3BwZWQKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICB9Cn0KCkZ1bmN0aW9uIFJlc29sdmUtUG9zaXRpb25hbFBhcmFtZXRlciB7CiAgICBwYXJhbSgKCQlbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlLCBQb3NpdGlvbiA9IDApXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbT2JqZWN0XQogICAgICAgICRDb250ZXh0CiAgICApCiAgICAKICAgIHByb2Nlc3MgewogICAgICAgIGlmICgkVGFiRXhwYW5zaW9uQ29tbWFuZEluZm9SZWdpc3RyeVskQ29udGV4dC5Db21tYW5kXSkgewogICAgICAgICAgICAkU2NyaXB0QmxvY2sgPSAkVGFiRXhwYW5zaW9uQ29tbWFuZEluZm9SZWdpc3RyeVskQ29udGV4dC5Db21tYW5kXQogICAgICAgICAgICAkQ29tbWFuZEluZm8gPSAmICRTY3JpcHRCbG9jayAkQ29udGV4dAogICAgICAgICAgICBpZiAoLW5vdCAkQ29tbWFuZEluZm8pIHt0aHJvdyAiZm9vIn0gIyMgVE9ETwogICAgICAgIH0gZWxzZWlmICgkQ29udGV4dC5Db21tYW5kSW5mbykgewogICAgICAgICAgICAkQ29tbWFuZEluZm8gPSAkQ29udGV4dC5Db21tYW5kSW5mbwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAkQ29udGV4dAogICAgICAgIH0KCiAgICAgICAgZm9yZWFjaCAoJFBhcmFtZXRlclNldCBpbiAkQ29tbWFuZEluZm8uUGFyYW1ldGVyU2V0cykgewogICAgICAgICAgICAkUG9zaXRpb25hbFBhcmFtZXRlcnMgPSBAKCRQYXJhbWV0ZXJTZXQuUGFyYW1ldGVycyB8CiAgICAgICAgICAgICAgICBXaGVyZS1PYmplY3QgeygkXy5Qb3NpdGlvbiAtZ2UgMCkgLWFuZCAoJENvbnRleHQuT3RoZXJQYXJhbWV0ZXJzLktleXMgLW5vdGNvbnRhaW5zICRfLk5hbWUpfSB8IFNvcnQtT2JqZWN0IFBvc2l0aW9uKQoKICAgICAgICAgICAgaWYgKCgkQ29udGV4dC5Qb3NpdGlvbmFsUGFyYW1ldGVyIC1nZSAwKSAtYW5kICgkQ29udGV4dC5Qb3NpdGlvbmFsUGFyYW1ldGVyIC1sdCAkUG9zaXRpb25hbFBhcmFtZXRlcnMuQ291bnQpKSB7CiAgICAgICAgICAgICAgICAjIyBUT0RPOiBUcnkgdG8gZmlndXJlIG91dCBhIGJldHRlciBwYXJhbWV0ZXI/CiAgICAgICAgICAgICAgICAkQ29udGV4dC5QYXJhbWV0ZXIgPSAkUG9zaXRpb25hbFBhcmFtZXRlcnNbJENvbnRleHQuUG9zaXRpb25hbFBhcmFtZXRlcl0uTmFtZQogICAgICAgICAgICAgICAgIyRDb250ZXh0LlBvc2l0aW9uYWxQYXJhbWV0ZXIgLT0gMQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfSBlbHNlaWYgKCRQb3NpdGlvbmFsUGFyYW1ldGVyc1stMV0uVmFsdWVGcm9tUmVtYWluaW5nQXJndW1lbnRzKSB7CiAgICAgICAgICAgICAgICAkQ29udGV4dC5QYXJhbWV0ZXIgPSAkUG9zaXRpb25hbFBhcmFtZXRlcnNbLTFdLk5hbWUKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRDb250ZXh0CgogICAgICAgIHRyYXAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUGlwZWxpbmVTdG9wcGVkRXhjZXB0aW9uXSB7CiAgICAgICAgICAgICMjIFBpcGVsaW5lIHdhcyBzdG9wcGVkCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgfQp9CgpGdW5jdGlvbiBSZXNvbHZlLUludGVybmFsQ29tbWFuZE5hbWUgewogICAgW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWUgPSAiQ29tbWFuZCIpXQogICAgcGFyYW0oCgkJW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gIkNvbW1hbmQiLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwLCBWYWx1ZUZyb21QaXBlbGluZUJ5UHJvcGVydHlOYW1lID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tbWFuZAogICAgICAgICwKCQlbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAiQ29tbWFuZEluZm8iLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQ29tbWFuZEluZm9dCiAgICAgICAgJENvbW1hbmRJbmZvCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgIyMgR2V0IGNvbW1hbmQgaW5mbwoJCWlmICgkUFNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgIkNvbW1hbmQiKSB7CiAgICAgICAgICAgICRDb21tYW5kSW5mbyA9IFJlc29sdmUtQ29tbWFuZCAkQ29tbWFuZCAtQ29tbWFuZEluZm8KICAgICAgICB9CgogICAgICAgICMjIFJldHVybiByZXN1bHQKICAgICAgICBpZiAoJFByZWZpeCA9IEdldC1Db21tYW5kUHJlZml4ICRDb21tYW5kSW5mbykgewogICAgICAgICAgICAkVmVyYiA9ICRDb21tYW5kSW5mby5OYW1lLlN1YnN0cmluZygwLCAkQ29tbWFuZEluZm8uTmFtZS5JbmRleG9mKCItIikpCiAgICAgICAgICAgICROb3VuID0gJENvbW1hbmRJbmZvLk5hbWUuU3Vic3RyaW5nKCRDb21tYW5kSW5mby5OYW1lLkluZGV4b2YoIi0iKSArIDEsICRDb21tYW5kSW5mby5OYW1lLmxlbmd0aCAtICgkQ29tbWFuZEluZm8uTmFtZS5JbmRleG9mKCItIikgKyAxKSkKICAgICAgICAgICAgJE5vdW4gPSAkTm91biAtcmVwbGFjZSBbUmVnZXhdOjpFc2NhcGUoJFByZWZpeCkKICAgICAgICAgICAgJEludGVybmFsTmFtZSA9ICIkVmVyYi0kTm91biIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkSW50ZXJuYWxOYW1lID0gJENvbW1hbmRJbmZvLk5hbWUKICAgICAgICB9CgogICAgICAgIE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7IkludGVybmFsTmFtZSI9JEludGVybmFsTmFtZTsiTW9kdWxlIj0kQ29tbWFuZEluZm8uTW9kdWxlfQoKICAgICAgICB0cmFwIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBpcGVsaW5lU3RvcHBlZEV4Y2VwdGlvbl0gewogICAgICAgICAgICAjIyBQaXBlbGluZSB3YXMgc3RvcHBlZAogICAgICAgICAgICBicmVhawogICAgICAgIH0KICAgIH0KfQoKRnVuY3Rpb24gR2V0LUNvbW1hbmRQcmVmaXggewogICAgW0NtZGxldEJpbmRpbmcoRGVmYXVsdFBhcmFtZXRlclNldE5hbWUgPSAiQ29tbWFuZCIpXQogICAgcGFyYW0oCgkJW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lID0gIkNvbW1hbmQiLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkQ29tbWFuZAogICAgICAgICwKCQlbUGFyYW1ldGVyKFBhcmFtZXRlclNldE5hbWUgPSAiQ29tbWFuZEluZm8iLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQ29tbWFuZEluZm9dCiAgICAgICAgJENvbW1hbmRJbmZvCiAgICAgICAgLAoJCVtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZSA9ICJNb2R1bGVJbmZvIiwgTWFuZGF0b3J5ID0gJHRydWUsIFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTTW9kdWxlSW5mb10KICAgICAgICAkTW9kdWxlSW5mbwogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgICMjIEdldCBtb2R1bGUgaW5mbwoJCWlmICgkUFNDbWRsZXQuUGFyYW1ldGVyU2V0TmFtZSAtZXEgIkNvbW1hbmQiKSB7CiAgICAgICAgICAgICRNb2R1bGVJbmZvID0gIChSZXNvbHZlLUNvbW1hbmQgJENvbW1hbmQgLUNvbW1hbmRJbmZvKS5Nb2R1bGUKICAgICAgICB9IGVsc2VpZiAoKCRQU0NtZGxldC5QYXJhbWV0ZXJTZXROYW1lIC1lcSAiQ29tbWFuZEluZm8iKSAtYW5kICRDb21tYW5kSW5mby5Nb2R1bGUpIHsKICAgICAgICAgICAgJE1vZHVsZUluZm8gPSAgR2V0LU1vZHVsZSAkQ29tbWFuZEluZm8uTW9kdWxlCiAgICAgICAgfQoKICAgICAgICBpZiAoJE1vZHVsZUluZm8pIHsKICAgICAgICAgICAgJENvbW1hbmRHcm91cHMgPSAkTW9kdWxlSW5mby5FeHBvcnRlZEZ1bmN0aW9ucy5WYWx1ZXMgKwogICAgICAgICAgICAgICAgKEdldC1Db21tYW5kIC1Nb2R1bGUgJE1vZHVsZUluZm8gLUNvbW1hbmRUeXBlIEZ1bmN0aW9uLEZpbHRlcixDbWRsZXQpIHwgR3JvdXAtT2JqZWN0IHskXy5EZWZpbml0aW9ufQogICAgICAgICAgICAkUHJlZml4ZXMgPSBmb3JlYWNoICgkR3JvdXAgaW4gJENvbW1hbmRHcm91cHMpIHsKICAgICAgICAgICAgICAgICROYW1lcyA9ICRHcm91cC5Hcm91cCB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IE5hbWUKICAgICAgICAgICAgICAgICRUZW1wTm91biA9IChAKCROYW1lcylbMF0gLXNwbGl0ICItIilbMV0KICAgICAgICAgICAgCWZvcmVhY2goJE5hbWUgaW4gJE5hbWVzKSB7CiAgICAgICAgICAgIAkJaWYgKCROYW1lIC1tYXRjaCAiLSIpIHsKICAgICAgICAgICAgCQkJJFBvc3NpYmxlUHJlZml4ID0gJE5hbWUuU3ViU3RyaW5nKCROYW1lLkluZGV4T2YoIi0iKSArIDEsICROYW1lLkxhc3RJbmRleE9mKCRUZW1wTm91bikgLSAkTmFtZS5JbmRleE9mKCItIikgLSAxKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJFBvc3NpYmxlUHJlZml4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUG9zc2libGVQcmVmaXgKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRQcmVmaXhlcy5Db3VudCkgewogICAgICAgICAgICAgICAgJFByZWZpeGVzIHwgU2VsZWN0LU9iamVjdCAtVW5pcXVlCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkUHJlZml4ZXMKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdHJhcCBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QaXBlbGluZVN0b3BwZWRFeGNlcHRpb25dIHsKICAgICAgICAgICAgIyMgUGlwZWxpbmUgd2FzIHN0b3BwZWQKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICB9Cn0KCiMjIyMjIyMjIyMjIwoKRnVuY3Rpb24gUmVzb2x2ZS1UYWJFeHBhbnNpb25QYXJhbWV0ZXJWYWx1ZSB7CiAgICBwYXJhbSgKICAgICAgICBbU3RyaW5nXSRWYWx1ZQogICAgKQoKICAgIHN3aXRjaCAtcmVnZXggKCRWYWx1ZSkgewogICAgICAgICdeXCQnIHsKICAgICAgICAgICAgW1N0cmluZ10oSW52b2tlLUV4cHJlc3Npb24gJF8pCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgICdeXCguKlwpJCcgewogICAgICAgICAgICBbU3RyaW5nXShJbnZva2UtRXhwcmVzc2lvbiAkXykKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgRGVmYXVsdCB7JFZhbHVlfQogICAgfQp9CgojIyMjIyMjIyMjIyMKCiMjIFNsaWdodGx5IG1vZGlmaWVkIGZyb20gaHR0cDovL2Jsb2cuc2FwaWVuLmNvbS9pbmRleC5waHAvMjAwOS8wOC8yNC93cml0aW5nLWZvcm0tY2VudGVyZWQtc2NyaXB0cy13aXRoLXByaW1hbGZvcm1zLwpGdW5jdGlvbiBHZXQtR3VpRGF0ZSB7CiAgICBwYXJhbSgKICAgICAgIFtJbnRdJERpc3BsYXlNb2RlID0gMSwgIyBudW1iZXIgb2YgbW9udGhzIHRvIHNob3cKICAgICAgIFtJbnRdJFNlbGVjdGlvbkNvdW50ID0gMCwgIyBudW1iZXIgb2YgZGF5cyB0aGF0IGNhbiBiZSBzZWxlY3RlZAogICAgICAgW0RhdGVUaW1lXSRUb2RheURhdGUgPSAkKEdldC1EYXRlKSwgIyBzZXRzIGRlZmF1bHQgc2VsZWN0ZWQgZGF0ZQogICAgICAgW0RhdGVUaW1lXSREYXRlU2VsZWN0ZWQgPSAkVG9kYXlEYXRlLCAjIHNldHMgZGVmYXVsdCBzZWxlY3RlZCBkYXRlCiAgICAgICBbSW50XSRGaXJzdERheW9mV2VlayA9IC0xLCAjIC0xIHVzZWQgZGVmYXVsdCAtIGNhbGVuZGFyIGRheW9md2VlaywgTk9UIGRhdGV0aW1lCiAgICAgICBbRGF0ZVRpbWVbXV0kQm9sZCA9IEAoKSwgIyBBcnJheSBvZiBib2xkZWQgZGF0ZXMgdG8gYWRkCiAgICAgICBbRGF0ZVRpbWVbXV0kWUJvbGQgPSBAKCksICMgYW5udWFsIGJvbGRlZCBkYXRlcyB0byBhZGQKICAgICAgIFtEYXRlVGltZVtdXSRNQm9sZCA9IEAoKSwgIyBtb250aGx5IGJvbGRlZCBkYXRlcyB0byBhZGQKICAgICAgIFtJbnRdJFNjcm9sbEJ5ID0gJERpc3BsYXlNb2RlLCAjIG51bWJlciBvZiBtb250aHMgdG8gc2Nyb2xsIGJ5OyAwID0gc2NyZWVuZnVsbAogICAgICAgW1N3aXRjaF0kV2Vla051bWJlcnMsICMgU2hvdyBudW1lcmljIHdlZWsgb2YgeWVhciBvbiB0aGUgZGlzcGxheQogICAgICAgW1N0cmluZ10kVGl0bGUgPSAiR2V0LUd1aURhdGUiLAogICAgICAgW1N3aXRjaF0kTm9Ub2RheUNpcmNsZSwKICAgICAgIFtEYXRlVGltZV0kTWluRGF0ZSA9ICIxNzUzLTAxLTAxIiwKICAgICAgIFtEYXRlVGltZV0kTWF4RGF0ZSA9ICI5OTk4LTEyLTMxIgogICAgKQoKICAgIFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5BcHBsaWNhdGlvbl06OkVuYWJsZVZpc3VhbFN0eWxlcygpCiAgICAjIElzIHRoaXMgdm9vZG9vIGNvZGUsIG9yIG5vdD8KICAgIFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5BcHBsaWNhdGlvbl06OkRvRXZlbnRzKCkKCiAgICAkY2FsID0gTmV3LU9iamVjdCBXaW5kb3dzLkZvcm1zLk1vbnRoQ2FsZW5kYXIKICAgICRjYWwuU2V0RGF0ZSgkRGF0ZVNlbGVjdGVkKQogICAgJGNhbC5Ub2RheURhdGUgPSAkVG9kYXlEYXRlCiAgICBpZiAoJFNlbGVjdGlvbkNvdW50IC1sdCAxKSB7JFNlbGVjdGlvbkNvdW50ID0gW2ludF06Ok1heFZhbHVlfQogICAgJGNhbC5NYXhTZWxlY3Rpb25Db3VudCA9ICRTZWxlY3Rpb25Db3VudAogICAgJGNhbC5NaW5EYXRlID0gJE1pbkRhdGUKICAgICRjYWwuTWF4RGF0ZSA9ICRNYXhEYXRlCiAgICAkY2FsLlNjcm9sbENoYW5nZSA9ICRTY3JvbGxCeQogICAgJGNhbC5TaG93VG9kYXlDaXJjbGUgPSAkdHJ1ZQogICAgaWYgKCRGaXJzdERheW9mV2VlayAtZXEgLTEpIHskRmlyc3REYXlvZldlZWsgPSBbU3lzdGVtLldpbmRvd3MuRm9ybXMuRGF5XTo6RGVmYXVsdH0KICAgICRjYWwuRmlyc3REYXlvZldlZWsgPSBbU3lzdGVtLldpbmRvd3MuRm9ybXMuRGF5XSRGaXJzdERheW9mV2VlawogICAgJGNhbC5TaG93V2Vla051bWJlcnMgPSAkV2Vla051bWJlcnMKICAgIGlmICgkTm9Ub2RheUNpcmNsZSkgeyRjYWwuU2hvd1RvZGF5Q2lyY2xlID0gJEZhbHNlfQoKICAgICMgUHJvdmlkZXMgY2xlYW4gZGlzcGxheSBnZW9tZXRyeQogICAgc3dpdGNoIC1yZWdleCAoJERpc3BsYXlNb2RlKSB7CiAgICAgICAgIl4xJCIgeyRjYWwuQ2FsZW5kYXJEaW1lbnNpb25zID0gIjEsMSJ9CiAgICAgICAgIl4yJCIgeyRjYWwuQ2FsZW5kYXJEaW1lbnNpb25zID0gIjIsMSJ9CiAgICAgICAgIl4zJCIgeyAkY2FsLkNhbGVuZGFyRGltZW5zaW9ucyA9ICIzLDEifQogICAgICAgICJeNCQiIHskY2FsLkNhbGVuZGFyRGltZW5zaW9ucyA9ICIyLDIifQogICAgICAgICJeWzU2XSQiIHskY2FsLkNhbGVuZGFyRGltZW5zaW9ucyA9ICIzLDIifQogICAgICAgICJeWzc4XSQiIHskY2FsLkNhbGVuZGFyRGltZW5zaW9ucyA9ICI0LDIifQogICAgICAgICJeOSQiIHskY2FsLkNhbGVuZGFyRGltZW5zaW9ucyA9ICIzLDMifQogICAgICAgICJeMVswMTJdJCIgeyRjYWwuQ2FsZW5kYXJEaW1lbnNpb25zID0gIjQsMyJ9CiAgICAgICAgZGVmYXVsdCB7JGNhbC5DYWxlbmRhckRpbWVuc2lvbnMgPSAiNCw0In0KICAgIH0KCiAgICBpZiAoJEJvbGQpIHskY2FsLkJvbGRlZERhdGVzID0gJEJvbGR9CiAgICBpZiAoJFlCb2xkKSB7JGNhbC5Bbm51YWxseUJvbGRlZERhdGVzID0gJFlCb2xkfQogICAgaWYgKCRNQm9sZCkgeyRjYWwuTW9udGhseUJvbGRlZERhdGVzID0gJE1Cb2xkfQoKICAgICRmb3JtID0gTmV3LU9iamVjdCBXaW5kb3dzLkZvcm1zLkZvcm0KICAgICRmb3JtLkF1dG9TaXplID0gJGZvcm0uVG9wTW9zdCA9ICRmb3JtLktleVByZXZpZXcgPSAkVHJ1ZQogICAgJGZvcm0uTWF4aW1pemVCb3ggPSAkZm9ybS5NaW5pbWl6ZUJveCA9ICRGYWxzZQogICAgJGZvcm0uQXV0b1NpemVNb2RlID0gIkdyb3dBbmRTaHJpbmsiCiAgICAkZm9ybS5Db250cm9scy5BZGQoJGNhbCkKICAgICRmb3JtLkJhY2tDb2xvciA9IFtTeXN0ZW0uRHJhd2luZy5Db2xvcl06OldoaXRlCiAgICAkZm9ybS5UZXh0ID0gJFRpdGxlCgogICAgIyBXZSdsbCBoYW5kbGUgZXNjYXBlIG9yIGVudGVyIHRvIGdldCBvdXQuCiAgICAkRXNjYXBlZCA9ICRGYWxzZTsKICAgICRmb3JtLkFkZF9LZXlEb3duKFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5LZXlFdmVudEhhbmRsZXJdewogICAgICAgIGlmICgkXy5LZXlDb2RlIC1lcSAiRXNjYXBlIikgewogICAgICAgICAgICAkRXNjYXBlZCA9ICR0cnVlOyAkZm9ybS5DbG9zZSgpCiAgICAgICAgfSBlbHNlaWYgKCRfLktleUNvZGUgLWVxICJFbnRlciIpIHsKICAgICAgICAgICAgJGZvcm0uQ2xvc2UoKQogICAgICAgIH0KICAgIH0pCgogICAgIyBFbnN1cmVzIHRoZSBmb3JtIGlzIG9uIHRvcCwgaXMgYWN0aXZlLCBhbmQgdGhlbiBzaG93cyBpdC4KICAgICMgQWZ0ZXIgY2FsbGluZyBTaG93RGlhbG9nKCksIHRoZSBzY3JpcHQgaXMgYmxvY2tlZCB1bnRpbAogICAgIyB0aGUgZm9ybSBpcyBubyBsb25nZXIgdmlzaWJsZS4KICAgICRmb3JtLkFkZF9TaG93bih7JGZvcm0uQWN0aXZhdGUoKX0pIAogICAgW1ZvaWRdJGZvcm0uU2hvd0RpYWxvZygpCgogICAgIyBJZiB0aGV5IGRpZG4ndCBwcmVzcyBFc2NhcGUsIG91dHB1dCB0aGUgc2VsZWN0aW9uIHJhbmdlCiAgICAjIGFzIGEgc2VyaWVzIG9mIGRhdGVzLgogICAgaWYgKCEkRXNjYXBlZCkgewogICAgICAgIGZvcigKICAgICAgICAgICAgJGRheSA9ICRjYWwuU2VsZWN0aW9uUmFuZ2UuU3RhcnQ7CiAgICAgICAgICAgICRkYXkgLWxlICRjYWwuU2VsZWN0aW9uUmFuZ2UuRW5kOwogICAgICAgICAgICAkZGF5ID0gJGRheS5BZGREYXlzKDEpCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRkYXkKICAgICAgICB9CiAgICB9CgogICAgIyAyMDA5LTA4LTI3CiAgICAjIC1pbml0aWFsaXplZCAkRXNjYXBlZCBhbmQgcmVtb3ZlZCAkU2hvd1RvZGF5Q2lyY2xlICh0aGFua3MsIHRvam8yMDAwKSAKICAgICMgLW1vZGlmaWVkICRGaXJzdERheU9mV2VlayBzbyBjYXN0cyBkb24ndCBvY2N1ciB1bnRpbCBhZnRlciBGb3JtcyBsaWJyYXJ5IGxvYWRlZC4KfQoKRnVuY3Rpb24gVGVzdC1Jc29sYXRlZFN0b3JhZ2VQYXRoIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbQWxpYXMoIkxpdGVyYWxQYXRoIildCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkVXNlcklzb1N0b3JhZ2UgPSBbU3lzdGVtLklPLklzb2xhdGVkU3RvcmFnZS5Jc29sYXRlZFN0b3JhZ2VGaWxlXTo6R2V0VXNlclN0b3JlRm9yQXNzZW1ibHkoKQogICAgICAgICAgICBpZiAoJFVzZXJJc29TdG9yYWdlLkdldEZpbGVOYW1lcygkUGF0aCkpIHsKICAgICAgICAgICAgICAgICR0cnVlCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkZmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAkZmFsc2UKICAgICAgICB9CiAgICB9Cn0KCkZ1bmN0aW9uIE9wZW4tSXNvbGF0ZWRTdG9yYWdlRmlsZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW0FsaWFzKCJQYXRoIildCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExpdGVyYWxQYXRoCiAgICAgICAgLAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFdyaXRhYmxlCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYgKCRXcml0YWJsZSkgewogICAgICAgICAgICAkVXNlcklzb1N0b3JhZ2UgPSBbU3lzdGVtLklPLklzb2xhdGVkU3RvcmFnZS5Jc29sYXRlZFN0b3JhZ2VGaWxlXTo6R2V0VXNlclN0b3JlRm9yQXNzZW1ibHkoKQogICAgICAgICAgICBpZiAoVGVzdC1Jc29sYXRlZFN0b3JhZ2VQYXRoICRMaXRlcmFsUGF0aCkgewogICAgICAgICAgICAgICAgTmV3LU9iamVjdCBTeXN0ZW0uSU8uSXNvbGF0ZWRTdG9yYWdlLklzb2xhdGVkU3RvcmFnZUZpbGVTdHJlYW0oJExpdGVyYWxQYXRoLCBbU3lzdGVtLklPLkZpbGVNb2RlXTo6VHJ1bmNhdGUsICRVc2VySXNvU3RvcmFnZSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIE5ldy1PYmplY3QgU3lzdGVtLklPLklzb2xhdGVkU3RvcmFnZS5Jc29sYXRlZFN0b3JhZ2VGaWxlU3RyZWFtKCRMaXRlcmFsUGF0aCwgW1N5c3RlbS5JTy5GaWxlTW9kZV06OkNyZWF0ZSwgJFVzZXJJc29TdG9yYWdlKQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJFVzZXJJc29TdG9yYWdlID0gW1N5c3RlbS5JTy5Jc29sYXRlZFN0b3JhZ2UuSXNvbGF0ZWRTdG9yYWdlRmlsZV06OkdldFVzZXJTdG9yZUZvckFzc2VtYmx5KCkKICAgICAgICAgICAgTmV3LU9iamVjdCBTeXN0ZW0uSU8uSXNvbGF0ZWRTdG9yYWdlLklzb2xhdGVkU3RvcmFnZUZpbGVTdHJlYW0oJExpdGVyYWxQYXRoLCBbU3lzdGVtLklPLkZpbGVNb2RlXTo6T3BlbiwgJFVzZXJJc29TdG9yYWdlKQogICAgICAgIH0KICAgIH0KfQoKRnVuY3Rpb24gTmV3LUlzb2xhdGVkU3RvcmFnZURpcmVjdG9yeSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW0FsaWFzKCJQYXRoIildCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSwgUG9zaXRpb24gPSAwKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJExpdGVyYWxQYXRoCiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgJFVzZXJJc29TdG9yYWdlID0gW1N5c3RlbS5JTy5Jc29sYXRlZFN0b3JhZ2UuSXNvbGF0ZWRTdG9yYWdlRmlsZV06OkdldFVzZXJTdG9yZUZvckFzc2VtYmx5KCkKICAgICAgICBpZiAoLW5vdCAkVXNlcklzb1N0b3JhZ2UuR2V0RGlyZWN0b3J5TmFtZXMoJExpdGVyYWxQYXRoKSkgeyRVc2VySXNvU3RvcmFnZS5DcmVhdGVEaXJlY3RvcnkoJExpdGVyYWxQYXRoKX0KICAgIH0KfQoKRnVuY3Rpb24gR2V0LUlzb2xhdGVkU3RvcmFnZSB7Cn0KCgojIyMjIyMjIyMjCiMgSGVyZSB0aGVyZSBiZSBoYWNrcyAoZnJvbSBKYXlrdWwpCiMjIyMjIyMjIyMKCkZ1bmN0aW9uIFBhcnNlLU1hbmlmZXN0IHsKICAgICRNYW5pZmVzdCA9IEdldC1Db250ZW50ICIkUFNTY3JpcHRSb290XFBvd2VyVGFiLnBzZDEiIHwgV2hlcmUtT2JqZWN0IHskXyAtbm90bWF0Y2ggJ15ccyojJ30KICAgICRNb2R1bGVNYW5pZmVzdCA9ICJEYXRhIHtgbiIgKyAoJE1hbmlmZXN0IC1qb2luICJgcmBuIikgKyAiYG59IgogICAgJEV4ZWN1dGlvbkNvbnRleHQuU2Vzc2lvblN0YXRlLkludm9rZUNvbW1hbmQuTmV3U2NyaXB0QmxvY2soJE1vZHVsZU1hbmlmZXN0KS5JbnZva2UoKVswXQp9CgpGdW5jdGlvbiBGaW5kLU1vZHVsZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1N0cmluZ1tdXSROYW1lID0gIioiCiAgICAgICAgLAogICAgICAgIFtTd2l0Y2hdJEFsbAogICAgKQoKICAgIGZvcmVhY2ggKCRuIGluICROYW1lKSB7CiAgICAgICAgJGZvbGRlciA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldERpcmVjdG9yeU5hbWUoJG4pCiAgICAgICAgJG4gPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRGaWxlTmFtZSgkbikKICAgICAgICAkTW9kdWxlUGF0aHMgPSBHZXQtTW9kdWxlUGF0aAoKICAgICAgICBpZiAoJGZvbGRlcikgewogICAgICAgICAgICAkTW9kdWxlUGF0aHMgPSBKb2luLVBhdGggJE1vZHVsZVBhdGhzICRmb2xkZXIKICAgICAgICB9CgogICAgICAgICMjIE5vdGU6IHRoZSBvcmRlciBvZiB0aGVzZSBpcyBpbXBvcnRhbnQuIFRoZXkgbmVlZCB0byBiZSBpbiB0aGUgb3JkZXIgdGhleSdkIGJlIGxvYWRlZCBieSB0aGUgc3lzdGVtCiAgICAgICAgJEZpbGVzID0gQChHZXQtQ2hpbGRJdGVtIC1QYXRoICRNb2R1bGVQYXRocyAtUmVjdXJzZSAtRmlsdGVyICIkbi5wcz8xIiAtRUEgMDsgR2V0LUNoaWxkSXRlbSAtUGF0aCAkTW9kdWxlUGF0aHMgLVJlY3Vyc2UgLUZpbHRlciAiJG4uZGxsIiAtRUEgMCkKICAgICAgICAkRmlsZXMgfCBXaGVyZS1PYmplY3QgewogICAgICAgICAgICAgICAgJHBhcmVudCA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldEZpbGVOYW1lKCAkXy5QU1BhcmVudFBhdGggKQogICAgICAgICAgICAgICAgcmV0dXJuICRhbGwgLW9yICgkcGFyZW50IC1lcSAkXy5CYXNlTmFtZSkgLW9yICgkZm9sZGVyIC1hbmQgKCRwYXJlbnQgLWVxIChbU3lzdGVtLklPLlBhdGhdOjpHZXRGaWxlTmFtZSgkZm9sZGVyKSkpIC1hbmQgKCRuIC1lcSAkXy5CYXNlTmFtZSkpCiAgICAgICAgICAgIH0gfCBHcm91cC1PYmplY3QgUFNQYXJlbnRQYXRoIHwgRm9yRWFjaC1PYmplY3Qge0AoJF8uR3JvdXApWzBdfQogICAgfQp9CgojIHwgU29ydC1PYmplY3Qge3N3aXRjaCAoJF8uRXh0ZW5zaW9uKSB7Ii5wc2QxInsxfSAiLnBzbTEiezJ9fX0pCkZ1bmN0aW9uIEdldC1Nb2R1bGVQYXRoIHsKICAgICRFbnY6UFNNb2R1bGVQYXRoIC1zcGxpdCAiOyIgfCBGb3JFYWNoLU9iamVjdCB7InswfVwiIC1mICRfLlRyaW1FbmQoJ1wnLCcvJyl9IHwgU2VsZWN0LU9iamVjdCAtVW5pcXVlIHwgV2hlcmUtT2JqZWN0IHtUZXN0LVBhdGggJF99Cn0=
