MSFT_xDhcpServerAuthorization.psm1,d01472517e80ffe22796ed1f9b73b6dd,Scan result is 1. IsMalware: 0,SW1wb3J0LU1vZHVsZSAkUFNTY3JpcHRSb290XC4uXEhlbHBlci5wc20xIC1WZXJib3NlOiRmYWxzZQoKIyBMb2NhbGl6ZWQgbWVzc2FnZXMKZGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIEAnClJlc29sdmluZ0lQdjRBZGRyZXNzICAgICAgPSBSZXNvbHZpbmcgZmlyc3QgbG9jYWwgSVB2NCBJUCBhZGRyZXNzIC4uLgpSZXNvbHZpbmdIb3N0bmFtZSAgICAgICAgID0gUmVzb2x2aW5nIGxvY2FsIGhvc3RuYW1lIC4uLgpBdXRob3JpemluZ1NlcnZlciAgICAgICAgID0gQXV0aG9yaXppbmcgREhDUCBTZXJ2ZXIgJ3swfScgd2l0aCBJUCBhZGRyZXNzICd7MX0nClVuYXV0aG9yaXppbmdTZXJ2ZXIgICAgICAgPSBVbmF1dGhvcml6aW5nIERIQ1AgU2VydmVyICd7MH0nIHdpdGggSVAgYWRkcmVzcyAnezF9JwpTZXJ2ZXJJc0F1dGhvcml6ZWQgICAgICAgID0gREhDUCBTZXJ2ZXIgJ3swfScgd2l0aCBJUCBhZGRyZXNzICd7MX0nIElTIGF1dGhvcml6ZWQKU2VydmVyTm90QXV0aG9yaXplZCAgICAgICA9IERIQ1AgU2VydmVyICd7MH0nIHdpdGggSVAgYWRkcmVzcyAnezF9JyBpcyBOT1QgYXV0aG9yaXplZApJbmNvcnJlY3RQcm9wZXJ0eVZhbHVlICAgID0gUHJvcGVydHkgJ3swfScgaXMgaW5jb3JyZWN0LiBFeHBlY3RlZCAnezF9JywgYWN0dWFsICd7Mn0nClJlc291cmNlSW5EZXNpcmVkU3RhdGUgICAgPSBESENQIFNlcnZlciAnezB9JyBpcyBpbiB0aGUgZGVzaXJlZCBzdGF0ZQpSZXNvdXJjZU5vdEluRGVzaXJlZFN0YXRlID0gREhDUCBTZXJ2ZXIgJ3swfScgaXMgTk9UIGluIHRoZSBkZXNpcmVkIHN0YXRlCidACn0KCmZ1bmN0aW9uIEdldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkRW5zdXJlLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkRG5zTmFtZSA9ICggR2V0LUhvc3RuYW1lICksCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRJUEFkZHJlc3MgPSAoIEdldC1JUHY0QWRkcmVzcyB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDEgKQogICAgKQogICAgQXNzZXJ0LU1vZHVsZSAtTW9kdWxlTmFtZSAnREhDUFNlcnZlcic7CiAgICAkSVBBZGRyZXNzID0gR2V0LVZhbGlkSVBBZGRyZXNzIC1JUFN0cmluZyAkSVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5ICdJUHY0JyAtUGFyYW1ldGVyTmFtZSAnSVBBZGRyZXNzJwogICAgJGRoY3BTZXJ2ZXIgPSBHZXQtRGhjcFNlcnZlckluREMgfCBXaGVyZS1PYmplY3QgeyAoJF8uRG5zTmFtZSAtZXEgJERuc05hbWUpIC1hbmQgKCRfLklQQWRkcmVzcyAtZXEgJElQQWRkcmVzcykgfQogICAgJHRhcmdldFJlc291cmNlID0gQHsKICAgICAgICBEbnNOYW1lID0gJGRoY3BTZXJ2ZXIuRG5zTmFtZQogICAgICAgIElQQWRkcmVzcyA9ICRkaGNwU2VydmVyLklQQWRkcmVzcwogICAgfQogICAgaWYgKCRkaGNwU2VydmVyKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLlNlcnZlcklzQXV0aG9yaXplZCAtZiAkRG5zTmFtZSwgJElQQWRkcmVzcykKICAgICAgICAkdGFyZ2V0UmVzb3VyY2VbJ0Vuc3VyZSddID0gJ1ByZXNlbnQnCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuU2VydmVyTm90QXV0aG9yaXplZCAtZiAkRG5zTmFtZSwgJElQQWRkcmVzcykKICAgICAgICAkdGFyZ2V0UmVzb3VyY2VbJ0Vuc3VyZSddID0gJ0Fic2VudCcKICAgIH0KICAgIHJldHVybiAkdGFyZ2V0UmVzb3VyY2UKfQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJERuc05hbWUgPSAoIEdldC1Ib3N0bmFtZSApLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkSVBBZGRyZXNzID0gKCBHZXQtSVB2NEFkZHJlc3MgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxICkKICAgICkKICAgIEFzc2VydC1Nb2R1bGUgLU1vZHVsZU5hbWUgJ0RIQ1BTZXJ2ZXInCiAgICAkSVBBZGRyZXNzID0gR2V0LVZhbGlkSVBBZGRyZXNzIC1JUFN0cmluZyAkSVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5ICdJUHY0JyAtUGFyYW1ldGVyTmFtZSAnSVBBZGRyZXNzJwogICAgaWYgKCRFbnN1cmUgLWVxICdQcmVzZW50JykKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5BdXRob3JpemluZ1NlcnZlciAtZiAkRG5zTmFtZSwgJElQQWRkcmVzcykKICAgICAgICBBZGQtRGhjcFNlcnZlckluRGMgLURuc05hbWUgJERuc05hbWUgLUlQQWRkcmVzcyAkSVBBZGRyZXNzCiAgICB9CiAgICBlbHNlaWYgKCRFbnN1cmUgLWVxICdBYnNlbnQnKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLlVuYXV0aG9yaXppbmdTZXJ2ZXIgLWYgJERuc05hbWUsICRJUEFkZHJlc3MpCiAgICAgICAgR2V0LURoY3BTZXJ2ZXJJbkRDIHwgV2hlcmUtT2JqZWN0IHsgKCRfLkRuc05hbWUgLWVxICREbnNOYW1lKSAtYW5kICgkXy5JUEFkZHJlc3MgLWVxICRJUEFkZHJlc3MpIH0gfCBSZW1vdmUtRGhjcFNlcnZlckluRGMKICAgIH0KfQoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJERuc05hbWUgPSAoIEdldC1Ib3N0bmFtZSApLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkSVBBZGRyZXNzID0gKCBHZXQtSVB2NEFkZHJlc3MgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxICkKICAgICkKICAgICR0YXJnZXRSZXNvdXJjZSA9IEdldC1UYXJnZXRSZXNvdXJjZSBAUFNCb3VuZFBhcmFtZXRlcnMKICAgICRpc0NvbXBsaWFudCA9ICR0cnVlCiAgICAKICAgIGlmICgkdGFyZ2V0UmVzb3VyY2UuRW5zdXJlIC1uZSAkRW5zdXJlKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLkluY29ycmVjdFByb3BlcnR5VmFsdWUgLWYgJ0Vuc3VyZScsICRFbnN1cmUsICR0YXJnZXRSZXNvdXJjZS5FbnN1cmUpCiAgICAgICAgJGlzQ29tcGxpYW50ID0gJGZhbHNlCgogICAgfQogICAgZWxzZWlmICgkRW5zdXJlIC1lcSAnUHJlc2VudCcpCiAgICB7CiAgICAgICAgaWYgKCR0YXJnZXRSZXNvdXJjZS5EbnNOYW1lIC1uZSAkRG5zTmFtZSkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLkluY29ycmVjdFByb3BlcnR5VmFsdWUgLWYgJ0Ruc05hbWUnLCAkRG5zTmFtZSwgJHRhcmdldFJlc291cmNlLkRuc05hbWUpCiAgICAgICAgICAgICRpc0NvbXBsaWFudCA9ICRmYWxzZQogICAgICAgIH0KICAgICAgICBpZiAoJHRhcmdldFJlc291cmNlLklQQWRkcmVzcyAtbmUgJElQQWRkcmVzcykKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLkluY29ycmVjdFByb3BlcnR5VmFsdWUgLWYgJ0lQQWRkcmVzcycsICRJUEFkZHJlc3MsICR0YXJnZXRSZXNvdXJjZS5JUEFkZHJlc3MpCiAgICAgICAgICAgICRpc0NvbXBsaWFudCA9ICRmYWxzZQogICAgICAgIH0KICAgIH0KICAgIAogICAgaWYgKCRpc0NvbXBsaWFudCkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5SZXNvdXJjZUluRGVzaXJlZFN0YXRlIC1mICREbnNOYW1lKQogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuUmVzb3VyY2VOb3RJbkRlc2lyZWRTdGF0ZSAtZiAkRG5zTmFtZSkKICAgIH0KICAgIHJldHVybiAkaXNDb21wbGlhbnQKfQoKIyMgSW50ZXJuYWwgZnVuY3Rpb24gdXNlZCB0byByZXR1cm4gYWxsIElQdjQgYWRkcmVzc2VzCmZ1bmN0aW9uIEdldC1JUHY0QWRkcmVzcwp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5TdHJpbmddKV0KICAgIHBhcmFtICggKQogICAgcHJvY2VzcwogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgJExvY2FsaXplZERhdGEuUmVzb2x2aW5nSVB2NEFkZHJlc3MKICAgICAgICBHZXQtV21pT2JqZWN0IFdpbjMyX05ldHdvcmtBZGFwdGVyQ29uZmlndXJhdGlvbiAtTmFtZXNwYWNlICdyb290XENJTVYyJyB8CiAgICAgICAgICAgIFdoZXJlLU9iamVjdCBJUEVuYWJsZWQgLWVxICdUcnVlJyB8CiAgICAgICAgICAgICAgICBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICgkXy5JUEFkZHJlc3MgLW5vdG1hdGNoICc6JykKICAgICAgICAgICAgICAgIH0KICAgIH0gI2VuZCBwcm9jZXNzCn0gI2VuZCBmdW5jdGlvbiBHZXQtSVB2NEFkZHJlc3MKCiMjIEludGVybmFsIGZ1bmN0aW9uIHVzZWQgdG8gcmVzb2x2ZSB0aGUgbG9jYWwgaG9zdG5hbWUKZnVuY3Rpb24gR2V0LUhvc3RuYW1lIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLlN0cmluZ10pXQogICAgcGFyYW0gKCApCiAgICBwcm9jZXNzCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAkTG9jYWxpemVkRGF0YS5SZXNvbHZpbmdIb3N0bmFtZTsKICAgICAgICAkZ2xvYmFsSXBQcm9wZXJ0aWVzID0gW1N5c3RlbS5OZXQuTmV0d29ya0luZm9ybWF0aW9uLklQR2xvYmFsUHJvcGVydGllc106OkdldElQR2xvYmFsUHJvcGVydGllcygpOwogICAgICAgIGlmICgkZ2xvYmFsSXBQcm9wZXJ0aWVzLkRvbWFpbk5hbWUpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJ3swfS57MX0nIC1mICRnbG9iYWxJcFByb3BlcnRpZXMuSG9zdE5hbWUsICRnbG9iYWxJcFByb3BlcnRpZXMuRG9tYWluTmFtZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gJGdsb2JhbElwUHJvcGVydGllcy5Ib3N0TmFtZQogICAgICAgIH0KICAgIH0gI2VuZCBwcm9jZXNzCn0gI2VuZCBmdW5jdGlvbiBHZXQtSG9zdG5hbWUKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U7Cg==
