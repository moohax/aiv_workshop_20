MSFT_xAzureVMDscConfiguration.psm1,c64e2047a0f1b12376e59f365a9e886c,Scan result is 1. IsMalware: 0,IyBQdXJwb3NlOgojIFJlc291cmNlIHRvIFB1Ymxpc2ggYSBEc2MgQ29uZmlndXJhdGlvbiBhcmNoaXZlIHRvIEF6dXJlIHN0b3JhZ2UKCiNyZWdpb24gR0VUCgpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UgewpbQ21kbGV0QmluZGluZygpXQpbT3V0cHV0VHlwZShbSGFzaHRhYmxlXSldCnBhcmFtKAoKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbc3RyaW5nXSRTdG9yYWdlQWNjb3VudE5hbWUsCgogICAgW3N0cmluZ10kQ29udGFpbmVyTmFtZSA9ICd3aW5kb3dzLXBvd2Vyc2hlbGwtZHNjJywKCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQ29uZmlndXJhdGlvblBhdGgsCgogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtzdHJpbmddJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSwKCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoCgopIAoKICAgIGlmICgkQXp1cmVTdWJzY3JpcHRpb25OYW1lIC1hbmQgJEF6dXJlUHVibGlzaFNldHRpbmdzUGF0aCkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJBenVyZSBQdWJsaXNoIFNldHRpbmdzIHByb3ZpZGVkLiBBenVyZVN1YnNjcmlwdGlvbk5hbWUgPSAkQXp1cmVTdWJzY3JpcHRpb25OYW1lLCAgQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoID0gJEF6dXJlUHVibGlzaFNldHRpbmdzUGF0aCIKICAgICAgICBJbXBvcnQtQXp1cmVQdWJsaXNoU2V0dGluZ3NGaWxlICRBenVyZVB1Ymxpc2hTZXR0aW5nc1BhdGgKICAgICAgICBTZXQtQXp1cmVTdWJzY3JpcHRpb24gLVN1YnNjcmlwdGlvbk5hbWUgJEF6dXJlU3Vic2NyaXB0aW9uTmFtZQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgIlN0b3JhZ2UgQWNjb3VudCBOYW1lID0gJFN0b3JhZ2VBY2NvdW50TmFtZSIKICAgICRzdG9yYWdlQWNjb3VudEtleSA9IChHZXQtQXp1cmVTdG9yYWdlS2V5ICRTdG9yYWdlQWNjb3VudE5hbWUpLlByaW1hcnkKICAgICRTY3JpcHQ6U3RvcmFnZUNvbnRleHQgPSBOZXctQXp1cmVTdG9yYWdlQ29udGV4dCAtU3RvcmFnZUFjY291bnROYW1lICRTdG9yYWdlQWNjb3VudE5hbWUgLVN0b3JhZ2VBY2NvdW50S2V5ICRzdG9yYWdlQWNjb3VudEtleSAtUHJvdG9jb2wgaHR0cHMKCiAgICBXcml0ZS1WZXJib3NlICJDb25maWd1cmF0aW9uUGF0aCA9ICRDb25maWd1cmF0aW9uUGF0aCIKICAgICRTY3JpcHQ6Q29uZmlnRmlsZU5hbWUgPSBbSU8uUGF0aF06OkdldEZpbGVOYW1lKCRDb25maWd1cmF0aW9uUGF0aCkKICAgIAogICAgJHN0b3JhZ2VCbG9iQXJjaGl2ZSA9IEdldC1BenVyZVN0b3JhZ2VCbG9iIC1CbG9iICIkU2NyaXB0OkNvbmZpZ0ZpbGVOYW1lLnppcCIgLUNvbnRhaW5lciAkQ29udGFpbmVyTmFtZSAtQ29udGV4dCAgJFNjcmlwdDpTdG9yYWdlQ29udGV4dCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgJGJsb2JVcmkgPSAkKCRzdG9yYWdlQmxvYkFyY2hpdmUuSUNsb3VkQmxvYi5VcmkuQWJzb2x1dGVVcmkpCgogICAgV3JpdGUtVmVyYm9zZSAiQmxvYiBVcmkgaXMgJGJsb2JVcmkiCgogICAgJHJldHVyblZhbHVlID0gQHsKCQlCbG9iVXJpID0gJGJsb2JVcmkKCSAgICB9CgoJcmV0dXJuICRyZXR1cm5WYWx1ZSAgICAKCiAgICB9CgojZW5kcmVnaW9uCgoKI3JlZ2lvbiBTRVQKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZSB7CltDbWRsZXRCaW5kaW5nKCldCnBhcmFtKAoKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbc3RyaW5nXSRTdG9yYWdlQWNjb3VudE5hbWUsCgogICAgW1ZhbGlkYXRlU2V0KCdQcmVzZW50JywnQWJzZW50JyldCiAgICBbc3RyaW5nXSRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgW3N0cmluZ10kQ29udGFpbmVyTmFtZSA9ICd3aW5kb3dzLXBvd2Vyc2hlbGwtZHNjJywKCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQ29uZmlndXJhdGlvblBhdGgsCgogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtzdHJpbmddJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSwKCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoCgopCgogICAgc3dpdGNoICgkRW5zdXJlKSB7CiAgICAgICAgJ1ByZXNlbnQnCiAgICAgICAgICAgIHsgICAKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkVuc3VyZSBpcyBzZXQgdG8gJEVuc3VyZS4gQ2FsbGluZyBQdWJsaXNoLUF6dXJlVk1Ec2NDb25maWd1cmF0aW9uIHRvIGNyZWF0ZSB0aGUgQ29uZmlndXJhdGlvbiBhbmQgUmVzb3VyY2UgYXJjaGl2ZSBpbiBTdG9yYWdlIGAiJCgkU2NyaXB0OlN0b3JhZ2VDb250ZXh0LlN0b3JhZ2VBY2NvdW50TmFtZSlgIiIKICAgICAgICAgICAgICAgIFB1Ymxpc2gtQXp1cmVWTURzY0NvbmZpZ3VyYXRpb24gLUNvbmZpZ3VyYXRpb25QYXRoICRDb25maWd1cmF0aW9uUGF0aCAtU3RvcmFnZUNvbnRleHQgJFNjcmlwdDpTdG9yYWdlQ29udGV4dCAtRm9yY2UgLVZlcmJvc2UKICAgICAgICAgICAgfQogICAgCiAgICAgICAgJ0Fic2VudCcKICAgICAgICAgICAgeyAgIAogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRW5zdXJlIGlzIHNldCB0byAkRW5zdXJlLiBDYWxsaW5nIFJlbW92ZS1BenVyZVN0b3JhZ2VCbG9iIHRvIHJlbW92ZSB0aGUgQmxvYiBmcm9tIFN0b3JhZ2UgYCIkKCRTY3JpcHQ6U3RvcmFnZUNvbnRleHQuU3RvcmFnZUFjY291bnROYW1lKWAiIgogICAgICAgICAgICAgICAgUmVtb3ZlLUF6dXJlU3RvcmFnZUJsb2IgLUJsb2IgIiRTY3JpcHQ6Q29uZmlnRmlsZU5hbWUuemlwIiAtQ29udGFpbmVyICRDb250YWluZXJOYW1lIC1Gb3JjZQogICAgICAgICAgICB9CiAgICAgICAgfSAgIAoKICAgIH0KICAKI2VuZHJlZ2lvbgoKCiNyZWdpb24gVEVTVAoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZSB7CltDbWRsZXRCaW5kaW5nKCldCltPdXRwdXRUeXBlKFtCb29sZWFuXSldCnBhcmFtKAoKICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbc3RyaW5nXSRTdG9yYWdlQWNjb3VudE5hbWUsCgogICAgW1ZhbGlkYXRlU2V0KCdQcmVzZW50JywnQWJzZW50JyldCiAgICBbc3RyaW5nXSRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgW3N0cmluZ10kQ29udGFpbmVyTmFtZSA9ICd3aW5kb3dzLXBvd2Vyc2hlbGwtZHNjJywKCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQ29uZmlndXJhdGlvblBhdGgsCgogICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgIFtzdHJpbmddJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSwKCiAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgW3N0cmluZ10kQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoCgopCiAgICBXcml0ZS1WZXJib3NlICJJbnZva2UgR2V0LVRhcmdldFJlc291cmNlIHRvIG9idGFpbiB0aGUgQWJzb2x1dGUgVXJpIHRvIHRoZSBCbG9iIgogICAgJHBhcmFtZXRlcnMgPSBAe30KICAgICRwYXJhbWV0ZXJzWyJTdG9yYWdlQWNjb3VudE5hbWUiXSA9ICRTdG9yYWdlQWNjb3VudE5hbWUKICAgICRwYXJhbWV0ZXJzWyJDb250YWluZXJOYW1lIl0gPSAkQ29udGFpbmVyTmFtZQogICAgJHBhcmFtZXRlcnNbIkNvbmZpZ3VyYXRpb25QYXRoIl0gPSAkQ29uZmlndXJhdGlvblBhdGgKICAgIAogICAgaWYoJEF6dXJlU3Vic2NyaXB0aW9uTmFtZSkKICAgIHsKICAgICAgICAkcGFyYW1ldGVyc1siQXp1cmVTdWJzY3JpcHRpb25OYW1lIl0gPSAkQXp1cmVTdWJzY3JpcHRpb25OYW1lCiAgICB9CgogICAgaWYoJEF6dXJlUHVibGlzaFNldHRpbmdzUGF0aCkKICAgIHsKICAgICAgICAkcGFyYW1ldGVyc1siQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoIl0gPSAkQXp1cmVQdWJsaXNoU2V0dGluZ3NQYXRoCiAgICB9CgogICAgJGJsb2JVcmlPYmogPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQHBhcmFtZXRlcnMKICAgIAogICAgc3dpdGNoICgkRW5zdXJlKSB7CiAgICAgICAgJ1ByZXNlbnQnCiAgICAgICAgICAgIHsgIAogICAgICAgICAgICAgICAgaWYgKC1ub3QgJCgkYmxvYlVyaU9iai5CbG9iVXJpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFbnN1cmUgaXMgc2V0IHRvICRFbnN1cmUuIEJ1dCB0aGUgYXJjaGl2ZSBpcyBhYnNlbnQgaW4gU3RvcmFnZS4gV2UgbmVlZCB0byBQdWJsaXNoIHRoZSBhcmNoaXZlIHRvIFN0b3JhZ2UiCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgJ0Fic2VudCcKICAgICAgICAgICAgeyAgCiAgICAgICAgICAgICAgICBpZiAoJCgkYmxvYlVyaU9iai5CbG9iVXJpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFbnN1cmUgaXMgc2V0IHRvICRFbnN1cmUuIEJ1dCB0aGUgYXJjaGl2ZSBpcyBwcmVzZW50IGluIFN0b3JhZ2UuIFdlIG5lZWQgdG8gUmVtb3ZlIHRoZSBhcmNoaXZlIGZyb20gU3RvcmFnZSIKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgcmV0dXJuICR0cnVlCiAgIAogICAgfQoKI2VuZHJlZ2lvbgoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLWZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U=
