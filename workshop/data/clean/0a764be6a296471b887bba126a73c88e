MSFT_msWebAppPool.psm1,829ad8684688d3a48e14b03d77fa2f38,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZQogICAgKQoKICAgICRFbnN1cmUgPSAiQWJzZW50IgogICAgJFN0YXRlICA9ICJTdG9wcGVkIgoKICAgICNuZWVkIHRvIGltcG9ydCBleHBsaWNpdGx5IHRvIHJ1biBmb3IgSUlTOlxBcHBQb29scwogICAgSW1wb3J0LU1vZHVsZSBXZWJBZG1pbmlzdHJhdGlvbgoKICAgIGlmKCEoR2V0LU1vZHVsZSAtTGlzdEF2YWlsYWJsZSAtTmFtZSBXZWJBZG1pbmlzdHJhdGlvbikpCiAgICB7CiAgICAgICAgVGhyb3cgIlBsZWFzZSBlbnN1cmUgdGhhdCBXZWJBZG1pbmlzdHJhdGlvbiBtb2R1bGUgaXMgaW5zdGFsbGVkLiIKICAgIH0KCiAgICAkQXBwUG9vbCA9IEdldC1JdGVtIC1QYXRoIElJUzpcQXBwUG9vbHNcKiB8ID8geyRfLm5hbWUgLWVxICROYW1lfQoKICAgIGlmKCRBcHBQb29sIC1uZSAkbnVsbCkKICAgIHsKICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiCiAgICAgICAgJFN0YXRlICA9ICRBcHBQb29sLnN0YXRlCiAgICB9CgogICAgJHJldHVyblZhbHVlID0gQHsKICAgICAgICBOYW1lICAgPSAkTmFtZQogICAgICAgIEVuc3VyZSA9ICRFbnN1cmUKICAgICAgICBTdGF0ZSAgPSAkU3RhdGUKICAgIH0KCiAgICByZXR1cm4gJHJldHVyblZhbHVlCn0KCgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJE5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAiUHJlc2VudCIsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiU3RhcnRlZCIsIlN0b3BwZWQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU3RhdGUgPSAiU3RhcnRlZCIKICAgICkKCiAgICBpZigkRW5zdXJlIC1lcSAiQWJzZW50IikKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlKCJSZW1vdmluZyB0aGUgV2ViIEFwcCBQb29sIikKICAgICAgICBSZW1vdmUtV2ViQXBwUG9vbCAkTmFtZQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRBcHBQb29sID0gR2V0LVRhcmdldFJlc291cmNlIC1OYW1lICROYW1lCiAgICAgICAgaWYoJEFwcFBvb2wuRW5zdXJlIC1uZSAiUHJlc2VudCIpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlKCJDcmVhdGluZyB0aGUgV2ViIEFwcCBQb29sIikKICAgICAgICAgICAgTmV3LVdlYkFwcFBvb2wgJE5hbWUKICAgICAgICAgICAgJEFwcFBvb2wgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgLU5hbWUgJE5hbWUKICAgICAgICB9CgogICAgICAgIGlmKCRBcHBQb29sLlN0YXRlIC1uZSAkU3RhdGUpCiAgICAgICAgewogICAgICAgICAgICBFeGVjdXRlUmVxdWlyZWRTdGF0ZSAtTmFtZSAkTmFtZSAtU3RhdGUgJFN0YXRlCiAgICAgICAgfQogICAgfQp9CgoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICROYW1lLAoKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlICA9ICJQcmVzZW50IiwKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJTdGFydGVkIiwiU3RvcHBlZCIpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRTdGF0ZSA9ICJTdGFydGVkIgogICAgKQogICAgJFdlYkFwcFBvb2wgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgLU5hbWUgJE5hbWUKCiAgICBpZigkRW5zdXJlIC1lcSAiUHJlc2VudCIpCiAgICB7CiAgICAgICAgaWYoJFdlYkFwcFBvb2wuRW5zdXJlIC1lcSAkRW5zdXJlIC1hbmQgJFdlYkFwcFBvb2wuU3RhdGUgLWVxICRzdGF0ZSkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAkdHJ1ZQogICAgICAgIH0KICAgIH0KICAgIGVsc2VpZigkV2ViQXBwUG9vbC5FbnN1cmUgLWVxICRFbnN1cmUpCiAgICB7CiAgICAgICAgcmV0dXJuICR0cnVlCiAgICB9CgogICAgcmV0dXJuICRmYWxzZQp9CgoKZnVuY3Rpb24gRXhlY3V0ZVJlcXVpcmVkU3RhdGUoW3N0cmluZ10gJE5hbWUsIFtzdHJpbmddICRTdGF0ZSkKewogICAgaWYoJFN0YXRlIC1lcSAiU3RhcnRlZCIpCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSgiU3RhcnRpbmcgdGhlIFdlYiBBcHAgUG9vbCIpCiAgICAgICAgc3RhcnQtV2ViQXBwUG9vbCAtTmFtZSAkTmFtZQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UoIlN0b3BwaW5nIHRoZSBXZWIgQXBwIFBvb2wiKQogICAgICAgIFN0b3AtV2ViQXBwUG9vbCAtTmFtZSAkTmFtZQogICAgfQp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
