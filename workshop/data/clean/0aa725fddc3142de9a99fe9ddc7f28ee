powertests.ps1,8b378c36e30df7d4eb135faf4df3cf57,Scan result is 1. IsMalware: 0,I3JlcXVpcmVzIC12ZXJzaW9uIDIuMAojIHNldC1zdHJpY3Rtb2RlIC12ZXJzaW9uICcyLjAnCgouICIkKHNwbGl0LXBhdGggJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuUGF0aCAtcGFyZW50KS9taXNjLnBzMSIKCnNldC12YXJpYWJsZSBURVNUX1NUQVRVU19FUlJPUiAgLXZhbHVlIC0xIC1vcHRpb24gIkNPTlNUQU5UIgpzZXQtdmFyaWFibGUgVEVTVF9TVEFUVVNfRkFJTEVEIC12YWx1ZSAwIC1vcHRpb24gIkNPTlNUQU5UIgpzZXQtdmFyaWFibGUgVEVTVF9TVEFUVVNfUEFTU0VEIC12YWx1ZSAxIC1vcHRpb24gIkNPTlNUQU5UIgpzZXQtdmFyaWFibGUgU1RPUFdBVENIIC12YWx1ZSAobmV3LW9iamVjdCAic3lzdGVtLmRpYWdub3N0aWNzLnN0b3B3YXRjaCIpIC1vcHRpb24gIkNPTlNUQU5UIgoKCiMgQ3JlYXRlIGEgbmV3IHRlc3QgcmVzdWx0IG9iamVjdC4KZnVuY3Rpb24gTmV3X1Rlc3RSZXN1bHQgewogICAgcGFyYW0oW2ludF0kU3RhdHVzLAogICAgICAgICAgW3N0cmluZ10kU291cmNlLAogICAgICAgICAgIyBUT0RPOiB3ZSBzaG91bGQgYWNjZXB0IGFuIGVycm9yIGZpZWxkIHRvbyBmb3IgdGVzdHMgdGhyb3dpbmcgZXJyb3JzLgogICAgICAgICAgIyAkVGVzdENhc2Ugc2hvdWxkIHRoZW4gYmVjb21lIGEgW3N5c3RlbS5tYW5hZ2VtZW50LmF1dG9tYXRpb24ucHN2YXJpYWJsZV0KICAgICAgICAgIFtvYmplY3RdJFRlc3RDYXNlLAogICAgICAgICAgW3RpbWVzcGFuXSRUaW1lRWxhcHNlZCkKCiAgICBmdW5jdGlvbiBBZGROb3RlUHJvcGVydHkgewogICAgICAgIHBhcmFtKCRUYXJnZXQsICROYW1lLCAkVmFsdWUpCiAgICAgICAgJHRhcmdldCB8IGFkZC1tZW1iZXIgLW1lbWJlcnR5cGUgIk5vdGVQcm9wZXJ0eSIgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1uYW1lICAgICAgICROYW1lIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtdmFsdWUgICAgICAkVmFsdWUKICAgIH0KCiAgICAkbyA9IG5ldy1vYmplY3QgIlBTT2JqZWN0IgogICAgQWRkTm90ZVByb3BlcnR5ICRvICJTdGF0dXMiICRTdGF0dXMKICAgIEFkZE5vdGVQcm9wZXJ0eSAkbyAiU291cmNlIiAkU291cmNlCiAgICBBZGROb3RlUHJvcGVydHkgJG8gIlRlc3RDYXNlIiAkVGVzdENhc2UKICAgIEFkZE5vdGVQcm9wZXJ0eSAkbyAiVGltZUVsYXBzZWQiICRUaW1lRWxhcHNlZAogICAgJG8KfQoKCiMgRnVuY3Rpb25zIGZvciB0ZXN0IGRlZmluaXRpb24KIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiBnZXRUZXN0VmFyaWFibGVzIHsKICAgIHBhcmFtKFtzdHJpbmddJE5hbWVQYXR0ZXJuLCAkU2NvcGUpCiAgICAjIEdldHMgdGVzdCBjYXNlcyBpbiB0aGUgcGFyZW50IHNjb3BlLgogICAgJHRlc3RDYXNlcyA9IChnZXQtdmFyaWFibGUgLXNjb3BlICRTY29wZSkgfCB3aGVyZS1vYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfLnZhbHVlIC1pcyBbc2NyaXB0YmxvY2tdIC1hbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkXy5uYW1lIC1saWtlICROYW1lUGF0dGVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICR0ZXN0Q2FzZXMgfCBzb3J0LW9iamVjdCAtcHJvcGVydHkgQHtFeHByZXNzaW9uPXsgJF8udmFsdWUuc3RhcnRwb3NpdGlvbi5zdGFydCB9fQp9CgoKZnVuY3Rpb24gbWFrZVRlc3RTdWl0ZSB7CiAgICAkdGVzdEVudmlyb25tZW50ID0gZ2V0VGVzdFZhcmlhYmxlcyAic2V0VXBUZXN0U3VpdGUiIC1zY29wZSAyCiAgICAkdGVzdENhc2VzID0gZ2V0VGVzdFZhcmlhYmxlcyAiVGVzdENhc2UqIiAtc2NvcGUgMgogICAgJHRlc3RFbnZpcm9ubWVudCwgQCgkdGVzdENhc2VzKQp9CgoKZnVuY3Rpb24gbWFrZVRlc3RDYXNlIHsKICAgICR0ZXN0Q2FzZUVudmlyb25tZW50ID0gZ2V0VGVzdFZhcmlhYmxlcyAic2V0VXBUZXN0Q2FzZSIgLXNjb3BlIDIKICAgICR0ZXN0Q2FzZVRlc3RzID0gZ2V0VGVzdFZhcmlhYmxlcyAidGVzdCoiIC1zY29wZSAyCiAgICAkdGVzdENhc2VFbnZpcm9ubWVudCwgJHRlc3RDYXNlVGVzdHMKfQoKCmZ1bmN0aW9uIGRvZXNUZXN0UGFzcyB7CiAgICBwYXJhbShbbWFuYWdlbWVudC5hdXRvbWF0aW9uLnBzdmFyaWFibGVdJFRlc3QpCiAgICAkdmFsdWVzID0gJiAkVGVzdC52YWx1ZQogICAgKFtib29sXUAoJHZhbHVlcykubGVuZ3RoKSAtYW5kICgoQCgkdmFsdWVzKSAtZXEgJGZhbHNlKS5sZW5ndGggLWVxIDApCn0KIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCiMgRnVuY3Rpb25zIGZvciB0ZXN0IHJlc3VsdCBmb3JtYXR0aW5nCiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KZnVuY3Rpb24gRm9ybWF0RmFpbGVkVGVzdHMgewogICAgcGFyYW0oJGZhaWxlZFRlc3RzKQoKICAgIGZvcmVhY2ggKCRmYWlsIGluICRmYWlsZWRUZXN0cykgewogICAgICAgICRob3N0LnVpLndyaXRlbGluZSgoIkZBSUxFRDogezB9ezF9W3syfTp7M31dIiAtZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmFpbC5zb3VyY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsLnRlc3RjYXNlLk5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsLnRlc3RjYXNlLnZhbHVlLnN0YXJ0cG9zaXRpb24uc3RhcnRsaW5lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmFpbC50ZXN0Y2FzZS52YWx1ZS5zdGFydHBvc2l0aW9uLnN0YXJ0Y29sdW1uKSkKICAgICAgICAkaG9zdC51aS53cml0ZWxpbmUoJGZhaWwudGVzdGNhc2UudmFsdWUpCiAgICB9Cn0KCmZ1bmN0aW9uIEZvcm1hdFRlc3RzV2l0aEVycm9ycyB7CiAgICAjIGluIHBvd2Vyc2hlbGwsIHRoZXJlIHNlZW1zIHRvIGJlIHR3byB0eXBlcyBvZiBlcnJvciBpbmZvIG9iamVjdHM6CiAgICAjIC0gZXhjZXB0aW9ucyAodGhleSBoYXZlIGFuIEVycm9yUmVjb3JkIHByb3BlcnR5KQogICAgIyAtIEVycm9yUmVjb3JkCiAgICAjIFdlJ2xsIHRyeSB0byBhbHdheXMgdXNlIHRoZSBFcnJvclJlY29yZCBtZW1iZXIgdG8gZXh0cmFjdCBpbmZvLgogICAgcGFyYW0oJGVycm9yVGVzdHMpCgogICAgZm9yZWFjaCgkZXJyIGluICRlcnJvclRlc3RzKSB7CgogICAgICAgICRlcnJSZWNvcmQgPSAkZXJyLnRlc3RjYXNlCiAgICAgICAgaWYgKCRlcnIudGVzdGNhc2UgLWlzbm90IFtzeXN0ZW0ubWFuYWdlbWVudC5hdXRvbWF0aW9uLmVycm9ycmVjb3JkXSkgewogICAgICAgICAgICAkZXJyUmVjb3JkID0gJGVyci50ZXN0Y2FzZS5FcnJvclJlY29yZAogICAgICAgIH0KCiAgICAgICAgJGhvc3QudWkud3JpdGVlcnJvcmxpbmUoKCJFUlJPUjogezB9W3sxfTp7Mn1dIiAtZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZXJyUmVjb3JkLmludm9jYXRpb25pbmZvLnNjcmlwdG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlcnJSZWNvcmQuaW52b2NhdGlvbmluZm8uc2NyaXB0bGluZW51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGVyclJlY29yZC5pbnZvY2F0aW9uaW5mby5vZmZzZXRpbmxpbmUpKQogICAgICAgICRob3N0LnVpLndyaXRlbGluZSgkZXJyLnRlc3RjYXNlKQogICAgICAgICRob3N0LnVpLndyaXRlbGluZSgkZXJyUmVjb3JkLmludm9jYXRpb25pbmZvLmxpbmUpCiAgICB9Cn0KCmZ1bmN0aW9uIEZvcm1hdC1UZXN0UmVzdWx0IHsKICAgIHBhcmFtKFtTeXN0ZW0uT2JqZWN0W11dJFRlc3RSZXN1bHRzLAogICAgICAgICAgW3N3aXRjaF0kTm9OZXdMaW5lQXRFbmRPZlRlc3Q9JFRydWUsCiAgICAgICAgICBbc3dpdGNoXSROb05ld0xpbmVBdEVuZAogICAgKQoKICAgICRmYWlsZWRUZXN0cyA9IEAoKQogICAgJGVycm9yVGVzdHMgPSBAKCkKICAgIFt0aW1lc3Bhbl0kdG90YWxUaW1lID0gMAoKICAgICRob3N0LnVpLndyaXRlKCgiYG4iICsgIi0iKjc4KSkKCiAgICAjIEluIFBTLCAkbnVsbCB8ICV7ICJmb28iIH0gd2lsbCBwcmludCAiZm9vIi4gTWFrZSBzdXJlIHdlIGRvbid0IHRyeQogICAgIyB0byBvcGVyYXRlIG9uICRudWxsLgogICAgaWYgKCR0ZXN0UmVzdWx0cyAtZXEgJG51bGwpIHsKICAgICAgICAkdGVzdFJlc3VsdHMgPSBAKCkKICAgIH0KCiAgICBmb3JlYWNoICgkcmVzdWx0IGluICRUZXN0UmVzdWx0cykgewogICAgICAgICR0b3RhbFRpbWUgKz0gJHJlc3VsdC50aW1lZWxhcHNlZAogICAgICAgIHN3aXRjaCAoJHJlc3VsdC5zdGF0dXMpIHsKICAgICAgICAgICAgICRURVNUX1NUQVRVU19FUlJPUiAgeyAkZXJyb3JUZXN0cyAgKz0gLCRyZXN1bHQ7IGJyZWFrIH0KICAgICAgICAgICAgICRURVNUX1NUQVRVU19GQUlMRUQgeyAkZmFpbGVkVGVzdHMgKz0gLCRyZXN1bHQ7IGJyZWFrIH0KICAgICAgICAgICAgICRURVNUX1NUQVRVU19QQVNTRUQgeyBicmVhayB9CiAgICAgICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgICAgIHdyaXRlLWRlYnVnICJGb3JtYXR0aW5nIChkZWZhdWx0KTogJCgkcmVzdWx0LnN0YXR1cykiCiAgICAgICAgICAgICAgICAkaG9zdC51aS53cml0ZWVycm9ybGluZSgiWW91IHNob3VsZG4ndCBiZSBzZWVpbmcgdGhpcy4iKSB9CiAgICAgICAgfQoKICAgICAgICBpZiAoLW5vdCAkTm9OZXdMaW5lQXRFbmRPZlRlc3QpIHsKICAgICAgICAgICAgJGhvc3QudWkud3JpdGVsaW5lKCkKICAgICAgICB9CiAgICB9CgogICAgaWYgKC1ub3QgJE5vTmV3TGluZUF0RW5kKSB7CiAgICAgICAgJGhvc3QudWkud3JpdGVsaW5lKCkKICAgIH0KCiAgICBpZiAoJGZhaWxlZFRlc3RzIC1vciAkZXJyb3JUZXN0cykgewogICAgICAgIHdyaXRlLWRlYnVnICJGYWlsZWQgVGVzdHM6ICRmYWlsZWRUZXN0cyIKICAgICAgICB3cml0ZS1kZWJ1ZyAiRXJyb3IgVGVzdHM6ICRlcnJvclRlc3RzIgoKICAgICAgICBGb3JtYXRGYWlsZWRUZXN0cyAkZmFpbGVkVGVzdHMKICAgICAgICBGb3JtYXRUZXN0c1dpdGhFcnJvcnMgJGVycm9yVGVzdHMKICAgIH0KCiAgICAkaG9zdC51aS53cml0ZWxpbmUoIi0iKjc4KQogICAgJGhvc3QudWkud3JpdGUoIlRlc3RzOiAkKCRUZXN0UmVzdWx0cy5sZW5ndGgpIHwgIikKICAgICRob3N0LnVpLndyaXRlKCJGYWlsZWQ6ICQoJGZhaWxlZFRlc3RzLmxlbmd0aCkgfCAiKQogICAgJGhvc3QudWkud3JpdGUoIkVycm9yczogJCgkZXJyb3JUZXN0cy5sZW5ndGgpIHwgIikKICAgICRob3N0LnVpLndyaXRlbGluZSgiVGltZTogJCgkdG90YWxUaW1lKSIpCiAgICAkaG9zdC51aS53cml0ZWxpbmUoIj0iKjc4KQoKfQoKCiMgRnVuY3Rpb25zIGZvciB0ZXN0IHJ1bm5pbmcKIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiBJbnZva2UtVGVzdFN1aXRlIHsKICAgIHBhcmFtKCRTb3VyY2VGaWxlTmFtZSwKICAgICAgICAgICRUZXN0U3VpdGUsCiAgICAgICAgICAkRW52aXJvbj0kbnVsbCwKICAgICAgICAgICRGaWx0ZXJUZXN0TmFtZT0iKiIKICAgICkKCiAgICAkc291cmNlID0gIlskU291cmNlRmlsZU5hbWVdOjokKCRUZXN0U3VpdGUuTmFtZSk6OiIKICAgIHRyeSB7CiAgICAgICAgJHRlc3RDYXNlRW52aXJvbm1lbnQsICR0ZXN0cyA9ICYgJFRlc3RTdWl0ZS52YWx1ZQogICAgICAgICR0ZXN0Q2FzZUVudmlyb25tZW50ID0gJHRlc3RDYXNlRW52aXJvbm1lbnQuVmFsdWUKICAgIH0KICAgIGNhdGNoIHsKICAgICAgICBpZiAoJF8uRnVsbHlRdWFsaWZpZWRFcnJvcklkIC1lcSAiQmFkRXhwcmVzc2lvbiIpIHsKICAgICAgICAgICAgJGhvc3QudWkud3JpdGVlcnJvcmxpbmUoIkNhbid0IHJ1biB0ZXN0IHN1aXRlLiBNYWtlIHN1cmUgeW91IGFyZSB1c2luZyAnbWFrZVRlc3RDYXNlJyBhbmQgJ21ha2VUZXN0U3VpdGUnIGFzIGFwcHJvcHJpYXRlLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICB0aHJvdyAkXwogICAgfQoKICAgIGlmICgtbm90ICR0ZXN0Q2FzZUVudmlyb25tZW50KSB7CiAgICAgICAgJHRlc3RDYXNlRW52aXJvbm1lbnQgPSB7CiAgICAgICAgICAgIHBhcmFtKCRMb2dpYykKICAgICAgICAgICAgJiAkTG9naWMKICAgICAgICB9CiAgICB9CgogICAgZm9yZWFjaCAoJHQgaW4gQCgkdGVzdHMpKSB7CiAgICAgICAgaWYgKCR0Lm5hbWUgLW5vdGxpa2UgJEZpbHRlclRlc3ROYW1lKSB7CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQogICAgICAgICR0aGVMb2dpYyA9IHsKICAgICAgICAgICAgJFNUT1BXQVRDSC5zdGFydCgpCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoZG9lc1Rlc3RQYXNzICR0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtRGVidWcgIlRlc3QgUGFzc2VkOiAkc291cmNlIC0gJCgkdC5OYW1lKSIKICAgICAgICAgICAgICAgICAgICAkU1RPUFdBVENILnN0b3AoKQogICAgICAgICAgICAgICAgICAgIE5ld19UZXN0UmVzdWx0ICRURVNUX1NUQVRVU19QQVNTRUQgJHNvdXJjZSAkdCAkU1RPUFdBVENILmVsYXBzZWQKICAgICAgICAgICAgICAgICAgICBbdm9pZF0gKE5ldy1FdmVudCAtU291cmNlSWRlbnRpZmllciAiUG93ZXJUZXN0LlN1Y2Nlc3MiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNUT1BXQVRDSC5zdG9wKCkKICAgICAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiVGVzdCBGYWlsZWQ6ICRzb3VyY2UgLSAkKCR0Lk5hbWUpIgogICAgICAgICAgICAgICAgICAgIE5ld19UZXN0UmVzdWx0ICRURVNUX1NUQVRVU19GQUlMRUQgJHNvdXJjZSAkdCAkU1RPUFdBVENILmVsYXBzZWQKICAgICAgICAgICAgICAgICAgICBbdm9pZF0gKE5ldy1FdmVudCAtU291cmNlSWRlbnRpZmllciAiUG93ZXJUZXN0LkZhaWwiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICRTVE9QV0FUQ0guc3RvcCgpCiAgICAgICAgICAgICAgICBXcml0ZS1EZWJ1ZyAiVGVzdCBFcnJvcjogJHNvdXJjZSAtICQoJHQuTmFtZSkgLSAkXyIKICAgICAgICAgICAgICAgIE5ld19UZXN0UmVzdWx0ICRURVNUX1NUQVRVU19FUlJPUiAkc291cmNlICRfICRTVE9QV0FUQ0guZWxhcHNlZAogICAgICAgICAgICAgICAgW3ZvaWRdIChOZXctRXZlbnQgLVNvdXJjZUlkZW50aWZpZXIgIlBvd2VyVGVzdC5FcnJvciIpCiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgICYgJHRlc3RDYXNlRW52aXJvbm1lbnQgJHRoZUxvZ2ljCiAgICAgICAgJFNUT1BXQVRDSC5yZXNldCgpCiAgICB9Cn0KCgpmdW5jdGlvbiBJbnZva2UtUG93ZXJUZXN0IHsKICAgIHBhcmFtKFtTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaFRhYmxlXSRUZXN0Q29sbGVjdGlvbiwKICAgICAgICAgIFtzdHJpbmddJEZpbHRlclRlc3RDYXNlPSIqIiwKICAgICAgICAgIFtzdHJpbmddJEZpbHRlclRlc3ROYW1lPSIqIikKICAgIHByb2Nlc3MgewogICAgICAgIGZvcmVhY2ggKCRrZXlWYWx1ZVBhaXIgaW4gJFRlc3RDb2xsZWN0aW9uLkdldEVudW1lcmF0b3IoKSkgewoKICAgICAgICAgICAgaWYgKCEka2V5VmFsdWVQYWlyLnZhbHVlKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CgogICAgICAgICAgICB3cml0ZS1kZWJ1ZyAiSW52b2tpbmcgdGVzdCBjYXNlcyBpbjogJCgka2V5VmFsdWVQYWlyLktleSkgKCQoJGtleVZhbHVlUGFpci5WYWx1ZS5MZW5ndGgpKSIKICAgICAgICAgICAgZm9yZWFjaCAoJHRlc3RTdWl0ZSBpbiAka2V5VmFsdWVQYWlyLlZhbHVlWzFdKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoJHRlc3RTdWl0ZS5uYW1lIC1ub3RsaWtlICRGaWx0ZXJUZXN0Q2FzZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkdGVzdFN1aXRlRW52aXJvbm1lbnQgPSAka2V5VmFsdWVQYWlyLlZhbHVlWzBdLlZhbHVlCiAgICAgICAgICAgICAgICBpZiAoLW5vdCAkdGVzdFN1aXRlRW52aXJvbm1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAkdGVzdFN1aXRlRW52aXJvbm1lbnQgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtKCRMb2dpYykKICAgICAgICAgICAgICAgICAgICAgICAgJiAkTG9naWMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGxvZ2ljID0geyBJbnZva2UtVGVzdFN1aXRlIC1Tb3VyY2VGaWxlTmFtZSAka2V5VmFsdWVQYWlyLmtleSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVRlc3RTdWl0ZSAkdGVzdFN1aXRlIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRW52aXJvbiAka2V5VmFsdWVQYWlyLlZhbHVlWzBdLlZhbHVlIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRmlsdGVyVGVzdE5hbWUgJEZpbHRlclRlc3ROYW1lIH0KICAgICAgICAgICAgICAgICYgJHRlc3RTdWl0ZUVudmlyb25tZW50ICRsb2dpYwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgojIEZ1bmN0aW9ucyBmb3IgdGVzdCBjb2xsZWN0aW9uCiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KZnVuY3Rpb24gR2V0LVBvd2VyVGVzdCB7CiAgICAjIFRPRE86IGZpbmQgdGVzdHMgcmVjdXJzaXZlbHkgdG9vLgogICAgcGFyYW0oJFBhdGgsICRGaWx0ZXI9IlRlc3QqLnBzMSIpCiAgICB3cml0ZS1kZWJ1ZyAiQ29sbGVjdGluZyB0ZXN0cyBmcm9tOiAkUGF0aCIKCiAgICAkdGVzdENvbGxlY3Rpb24gPSBAe30KICAgIGZvcmVhY2ggKCRmaWxlIGluIChHZXQtQ2hpbGRJdGVtIC1QYXRoICRQYXRoIC1GaWx0ZXIgJEZpbHRlcikpCiAgICB7CiAgICAgICAgd3JpdGUtZGVidWcgIkNvbGxlY3RlZCB0ZXN0IG1hdGNoaW5nOiAkZmlsZSIKICAgICAgICAkdGVzdENvbGxlY3Rpb25bJGZpbGUubmFtZV0gKz0gQCgmICRmaWxlLmZ1bGxuYW1lKQogICAgfQoKICAgICR0ZXN0Q29sbGVjdGlvbgp9CiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgojIE1haW4gcHJvZ3JhbSBmb3IgdGVzdCBkaXNjb3ZlcnkKIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiBSdW4tVGVzdCB7CiAgICBwYXJhbSgkUGF0aD0oR2V0LUxvY2F0aW9uKSwgJEZpbHRlcj0iVGVzdCoucHMxIiwgJEZpbHRlclRlc3RDYXNlPSIqIiwKICAgICAgICAgICRGaWx0ZXJUZXN0TmFtZT0iKiIpCgogICAgdHJ5IHsKCiAgICAgICAgIyB1bmxvYWQgYWxsIG1vZHVsZXMgKHRvZG86IHRvbyBkcmFzdGljPykKICAgICAgICAkX19tb2R1bGVOYW1lcyA9IEAoZ2V0LW1vZHVsZSB8IHNlbGVjdC1vYmplY3QgLWV4cGFuZHByb3BlcnR5ICJuYW1lIikKICAgICAgICBnZXQtbW9kdWxlIHwgcmVtb3ZlLW1vZHVsZQoKICAgICAgICAkZ2xvYmFsOl9jYXB0dXJlZE91dHB1dCA9IEAoKQogICAgICAgIGZ1bmN0aW9uIHdyaXRlLWhvc3QgeyAkZ2xvYmFsOl9jYXB0dXJlZE91dHB1dCArPSAkYXJncyB9CiAgICAgICAgIyBUT0RPOiBjYXB0dXJpbmcgc3RkZXJyIGlzIHByb2JsZW1hdGljIHdoZW4gdGVzdHMgbmVlZCB0byBjaGVjayBmb3IKICAgICAgICAjIGVycm9ycy4KICAgICAgICAjIGZ1bmN0aW9uIHdyaXRlLWVycm9yIHsgJGdsb2JhbDpfY2FwdHVyZWRPdXRwdXQgKz0gJGFyZ3MgfQoKICAgICAgICBpZiAoISgodGVzdC1wYXRoICRwYXRoKSAtYW5kIChnZXQtaXRlbSAkcGF0aCkuUFNJc0NvbnRhaW5lcikpIHsKICAgICAgICAgICAgJGhvc3QudWkud3JpdGVlcnJvcmxpbmUoIkNhbm5vdCBmaW5kIHNwZWNpZmllZCBwYXRoIG9yIGl0IGlzbid0IGEgZGlyZWN0b3J5LiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgIyBUaGVzZSBldmVudHMgYWxsb3cgdG8gd3JpdGUgbGl2ZSBmZWVkYmFjayBhYm91dCB0ZXN0IHJlc3VsdHMuCiAgICAgICAgW3ZvaWRdIChSZWdpc3Rlci1FbmdpbmVFdmVudCAtU291cmNlSWRlbnRpZmllciAiUG93ZXJUZXN0LlN1Y2Nlc3MiIC1BY3Rpb24geyAkaG9zdC51aS53cml0ZSgiLiIpIH0pCiAgICAgICAgW3ZvaWRdIChSZWdpc3Rlci1FbmdpbmVFdmVudCAtU291cmNlSWRlbnRpZmllciAiUG93ZXJUZXN0LkZhaWwiICAgIC1BY3Rpb24geyAkaG9zdC51aS53cml0ZSgiRiIpIH0pCiAgICAgICAgW3ZvaWRdIChSZWdpc3Rlci1FbmdpbmVFdmVudCAtU291cmNlSWRlbnRpZmllciAiUG93ZXJUZXN0LkVycm9yIiAgIC1BY3Rpb24geyAkaG9zdC51aS53cml0ZSgiRSIpIH0pCgogICAgICAgICR0ZXN0Q29sbGVjdGlvbiA9IEdldC1Qb3dlclRlc3QgLVBhdGggJFBhdGggLUZpbHRlciAkRmlsdGVyCiAgICAgICAgaWYgKCR0ZXN0Q29sbGVjdGlvbi5Db3VudCAtZXEgMCkgewogICAgICAgICAgICAkaG9zdC51aS53cml0ZWVycm9ybGluZSgiQ291bGQgbm90IGZpbmQgYW55IGZpbGVzIGluICckUGF0aCcgbWF0Y2hpbmcgJyRGaWx0ZXInLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgJHRlc3RSZXN1bHRzID0gSW52b2tlLVBvd2VyVGVzdCAtVGVzdENvbGxlY3Rpb24gJHRlc3RDb2xsZWN0aW9uIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1GaWx0ZXJUZXN0Q2FzZSAkRmlsdGVyVGVzdENhc2UgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUZpbHRlclRlc3ROYW1lICRGaWx0ZXJUZXN0TmFtZQogICAgICAgIEZvcm1hdC1UZXN0UmVzdWx0IC1UZXN0UmVzdWx0ICR0ZXN0UmVzdWx0cwoKICAgICAgICBpZiAoJF9jYXB0dXJlZE91dHB1dCkgewogICAgICAgICAgICAkX2NhcHR1cmVkT3V0cHV0CiAgICAgICAgfQoKICAgIH0KICAgIGZpbmFsbHkgewogICAgICAgIFVucmVnaXN0ZXItRXZlbnQgLVNvdXJjZUlkZW50aWZpZXIgIlBvd2VyVGVzdC4qIgogICAgICAgICRfX21vZHVsZU5hbWVzIHwgaW1wb3J0LW1vZHVsZQogICAgICAgIHJlbW92ZS1pdGVtIGZ1bmN0aW9uOndyaXRlLWhvc3QKICAgICAgICByZW1vdmUtaXRlbSB2YXJpYWJsZTpfY2FwdHVyZWRPdXRwdXQKICAgIH0KfQo=
