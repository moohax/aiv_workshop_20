utils.psm1,4cd62111cbdc979984e8991fb7deec18,Scan result is 1. IsMalware: 0,I3BzMV9zeXNuYXRpdmUKCiMgQ29weXJpZ2h0IDIwMTQgQ2xvdWRiYXNlIFNvbHV0aW9ucyBTcmwKIwojICAgIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5CiMgICAgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4KIyAgICBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKIwojICAgICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiMKIyAgICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiMgICAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywgV0lUSE9VVAojICAgIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZQojICAgIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiMgICAgdW5kZXIgdGhlIExpY2Vuc2UuCgojIFVOVEVTVEFCTEUgTUVUSE9EUwoKZnVuY3Rpb24gUmVzdG9yZS1FbnZpcm9ubWVudFZhcmlhYmxlICgkdmFyaWFibGUsICRwcmV2VmFsdWUpIHsKICAgIGlmICgkcHJldlZhbHVlIC1lcSAkbnVsbCAtYW5kIChUZXN0LVBhdGggIkVudjokdmFyaWFibGUiKSkgewogICAgICAgIFJlbW92ZS1JdGVtICJFbnY6JHZhcmlhYmxlIgogICAgfSBlbHNlIHsKICAgICAgICBbRW52aXJvbm1lbnRdOjpTZXRFbnZpcm9ubWVudFZhcmlhYmxlKCR2YXJpYWJsZSwkcHJldlZhbHVlKQogICAgfQp9CgpmdW5jdGlvbiBQcmVwYXJlLU1vY2tFbnZWYXJpYWJsZSgkdmFyTmFtZSwgJHZhbHVlKSB7CiAgICAkcHJldlZhbHVlID0gW0Vudmlyb25tZW50XTo6R2V0RW52aXJvbm1lbnRWYXJpYWJsZSgkdmFyTmFtZSkKICAgIFtFbnZpcm9ubWVudF06OlNldEVudmlyb25tZW50VmFyaWFibGUoJHZhck5hbWUsJHZhbHVlKQogICAgcmV0dXJuICRwcmV2VmFsdWUKfQoKZnVuY3Rpb24gRXhpdC1CYXNpYyB7CiAgICBQYXJhbSgKICAgICAgICBbaW50XSRFeGl0Q29kZQogICAgKQoKICAgIGV4aXQgJEV4aXRDb2RlCn0KCmZ1bmN0aW9uIEludm9rZS1TdGF0aWNNZXRob2QgewogICAgUGFyYW0oCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtzdHJpbmddJFR5cGUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtzdHJpbmddJE5hbWUsCiAgICAgICAgW2FycmF5XSRQYXJhbXM9JG51bGwKICAgICkKCiAgICAkZnVsbFR5cGUgPSAiU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi4iICsgJFR5cGUKICAgICRzdGF0aWNDbGFzcyA9IFtUeXBlXSRmdWxsVHlwZQoKICAgIHJldHVybiAkc3RhdGljQ2xhc3M6OiROYW1lLkludm9rZSgkUGFyYW1zKQp9CgpmdW5jdGlvbiBFeGVjdXRlLVByb2Nlc3MgKCREZXN0aW5hdGlvbkZpbGUsICRBcmd1bWVudHMpIHsKICAgIGlmICgoJEFyZ3VtZW50cy5Db3VudCAtZXEgMCkgLW9yICgkQXJndW1lbnRzIC1lcSAkbnVsbCkpIHsKICAgICAgICAkcCA9IFN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICREZXN0aW5hdGlvbkZpbGUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAtUGFzc1RocnUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAtV2FpdAogICAgfSBlbHNlIHsKICAgICAgICAkcCA9IFN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICREZXN0aW5hdGlvbkZpbGUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRMaXN0ICRBcmd1bWVudHMgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAtUGFzc1RocnUgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAtV2FpdAogICAgfQoKICAgIHJldHVybiAkcAp9CgpmdW5jdGlvbiBHZXQtVXNlclBhdGggKCkgewogICAgcmV0dXJuIFtTeXN0ZW0uRW52aXJvbm1lbnRdOjpHZXRFbnZpcm9ubWVudFZhcmlhYmxlKCJQQVRIIiwgIlVzZXIiKQp9CgpmdW5jdGlvbiBHZXQtU3lzdGVtUGF0aCB7CiAgICByZXR1cm4gW1N5c3RlbS5FbnZpcm9ubWVudF06OkdldEVudmlyb25tZW50VmFyaWFibGUoIlBBVEgiLCAiTWFjaGluZSIpCn0KCgojIFRFU1RBQkxFIE1FVEhPRFMKCmZ1bmN0aW9uIENvbXBhcmUtT2JqZWN0cyAoJGZpcnN0LCAkbGFzdCkgewogICAgKENvbXBhcmUtT2JqZWN0ICRmaXJzdCAkbGFzdCAtU3luY1dpbmRvdyAwKS5MZW5ndGggLWVxIDAKfQoKZnVuY3Rpb24gQ29tcGFyZS1TY3JpcHRCbG9ja3MgewogICAgUGFyYW0oCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uU2NyaXB0QmxvY2tdJHNjckJsb2NrMSwKICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5TY3JpcHRCbG9ja10kc2NyQmxvY2syCiAgICApCgogICAgJHNiMSA9ICRzY3JCbG9jazEuVG9TdHJpbmcoKQogICAgJHNiMiA9ICRzY3JCbG9jazIuVG9TdHJpbmcoKQoKICAgIHJldHVybiAoJHNiMS5Db21wYXJlVG8oJHNiMikgLWVxIDApCn0KCmZ1bmN0aW9uIEFkZC1GYWtlT2JqUHJvcGVydHkgKFtyZWZdJG9iaiwgJG5hbWUsICR2YWx1ZSkgewogICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJG9iai52YWx1ZSAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgYAogICAgICAgIC1OYW1lICRuYW1lIC1WYWx1ZSAkdmFsdWUKfQoKZnVuY3Rpb24gQWRkLUZha2VPYmpQcm9wZXJ0aWVzIChbcmVmXSRvYmosICRmYWtlUHJvcGVydGllcywgJHZhbHVlKSB7CiAgICBmb3JlYWNoICgkcHJvcCBpbiAkZmFrZVByb3BlcnRpZXMpIHsKICAgICAgICBBZGQtTWVtYmVyIC1JbnB1dE9iamVjdCAkb2JqLnZhbHVlIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSBgCiAgICAgICAgICAgIC1OYW1lICRwcm9wIC1WYWx1ZSAkdmFsdWUKICAgIH0KfQoKZnVuY3Rpb24gQWRkLUZha2VPYmpNZXRob2QgKFtyZWZdJG9iaiwgJG5hbWUpIHsKICAgIEFkZC1NZW1iZXIgLUlucHV0T2JqZWN0ICRvYmoudmFsdWUgLU1lbWJlclR5cGUgU2NyaXB0TWV0aG9kIGAKICAgICAgICAtTmFtZSAkbmFtZSAtVmFsdWUgeyByZXR1cm4gMCB9Cn0KCmZ1bmN0aW9uIEFkZC1GYWtlT2JqTWV0aG9kcyAoW3JlZl0kb2JqLCAkZmFrZU1ldGhvZHMpIHsKICAgIGZvcmVhY2ggKCRtZXRob2QgaW4gJGZha2VNZXRob2RzKSB7CiAgICAgICAgQWRkLU1lbWJlciAtSW5wdXRPYmplY3QgJG9iai52YWx1ZSAtTWVtYmVyVHlwZSBTY3JpcHRNZXRob2QgYAogICAgICAgICAgICAtTmFtZSAkbWV0aG9kIC1WYWx1ZSB7IHJldHVybiAwIH0KICAgIH0KfQoKZnVuY3Rpb24gQ29tcGFyZS1BcnJheXMgKCRhcnIxLCAkYXJyMikgewogICAgcmV0dXJuICgoKENvbXBhcmUtT2JqZWN0ICRhcnIxICRhcnIyKS5JbnB1dE9iamVjdCkuTGVuZ3RoIC1lcSAwKQp9CgpmdW5jdGlvbiBDb21wYXJlLUhhc2hUYWJsZXMgKCR0YWIxLCAkdGFiMikgewogICAgaWYgKCR0YWIxLkNvdW50IC1uZSAkdGFiMi5Db3VudCkgewogICAgICAgIHJldHVybiAkZmFsc2UKICAgIH0KICAgIGZvcmVhY2ggKCRpIGluICR0YWIxLktleXMpIHsKICAgICAgICBpZiAoKCR0YWIyLkNvbnRhaW5zS2V5KCRpKSAtZXEgJGZhbHNlKSAtb3IgKCR0YWIxWyRpXSAtbmUgJHRhYjJbJGldKSkgewogICAgICAgICAgICByZXR1cm4gJGZhbHNlCiAgICAgICAgfQogICAgfQogICAgcmV0dXJuICR0cnVlCn0KCmZ1bmN0aW9uIEV4ZWN1dGUtRXh0ZXJuYWxDb21tYW5kIHsKICAgIHBhcmFtKAogICAgICAgIFtTY3JpcHRCbG9ja10kQ29tbWFuZCwKICAgICAgICBbYXJyYXldJEFyZ3VtZW50TGlzdD1AKCksCiAgICAgICAgW3N0cmluZ10kRXJyb3JNZXNzYWdlCiAgICApCgogICAgJHJlcyA9IEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayAkQ29tbWFuZCAtQXJndW1lbnRMaXN0ICRBcmd1bWVudExpc3QKICAgIGlmICgkTEFTVEVYSVRDT0RFIC1uZSAwKSB7CiAgICAgICAgdGhyb3cgJEVycm9yTWVzc2FnZQogICAgfQogICAgcmV0dXJuICRyZXMKfQoKZnVuY3Rpb24gRXhlY3V0ZVdpdGgtUmV0cnkgewogICAgcGFyYW0oCiAgICAgICAgW1NjcmlwdEJsb2NrXSRDb21tYW5kLAogICAgICAgIFtpbnRdJE1heFJldHJ5Q291bnQ9MTAsCiAgICAgICAgW2ludF0kUmV0cnlJbnRlcnZhbD0zLAogICAgICAgIFthcnJheV0kQXJndW1lbnRMaXN0PUAoKQogICAgKQoKICAgICRjdXJyZW50RXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSIKCiAgICAkcmV0cnlDb3VudCA9IDAKICAgIHdoaWxlICgkdHJ1ZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRyZXMgPSBJbnZva2UtQ29tbWFuZCAtU2NyaXB0QmxvY2sgJENvbW1hbmQgYAogICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRMaXN0ICRBcmd1bWVudExpc3QKICAgICAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICRjdXJyZW50RXJyb3JBY3Rpb25QcmVmZXJlbmNlCiAgICAgICAgICAgIHJldHVybiAkcmVzCiAgICAgICAgfSBjYXRjaCBbU3lzdGVtLkV4Y2VwdGlvbl0gewogICAgICAgICAgICAkcmV0cnlDb3VudCsrCiAgICAgICAgICAgIGlmICgkcmV0cnlDb3VudCAtZ3QgJE1heFJldHJ5Q291bnQpIHsKICAgICAgICAgICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAkY3VycmVudEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgICAgICAgICAgICAgdGhyb3cgJF8uRXhjZXB0aW9uCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAkXy5FeGNlcHRpb24KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwICRSZXRyeUludGVydmFsCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIFVuemlwLUZpbGUgKCR6aXBGaWxlLCAkZGVzdGluYXRpb24pIHsKICAgICRzaGVsbEFwcCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCBTaGVsbC5BcHBsaWNhdGlvbgogICAgJHppcEZpbGVOcyA9ICRzaGVsbEFwcC5OYW1lU3BhY2UoJHppcEZpbGUpCiAgICAkZGVzdGluYXRpb25OcyA9ICRzaGVsbEFwcC5OYW1lU3BhY2UoJGRlc3RpbmF0aW9uKQogICAgJGRlc3RpbmF0aW9uTnMuQ29weUhlcmUoJHppcEZpbGVOcy5JdGVtcygpLCAweDQpCn0KCmZ1bmN0aW9uIENoZWNrLUZpbGVJbnRlZ3JpdHlXaXRoU0hBMSB7CiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kRmlsZSwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kRXhwZWN0ZWRTSEExSGFzaAogICAgKQoKICAgICRoYXNoID0gKEdldC1GaWxlSGFzaCAtUGF0aCAkRmlsZSAtQWxnb3JpdGhtICJTSEExIikuSGFzaAogICAgaWYgKCRoYXNoIC1uZSAkRXhwZWN0ZWRTSEExSGFzaCkgewogICAgICAgICRlcnJNc2cgPSAiU0hBMSBoYXNoIG5vdCB2YWxpZCBmb3IgZmlsZTogJGZpbGVuYW1lLiAiICsKICAgICAgICAgICAgICAgICAgIkV4cGVjdGVkOiAkRXhwZWN0ZWRTSEExSGFzaCBDdXJyZW50OiAkaGFzaCIKICAgICAgICB0aHJvdyAkZXJyTXNnCiAgICB9Cn0KCmZ1bmN0aW9uIERvd25sb2FkLUZpbGUgKCREb3dubG9hZExpbmssICREZXN0aW5hdGlvbkZpbGUsICRFeHBlY3RlZFNIQTFIYXNoKSB7CiAgICAkd2ViY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgRXhlY3V0ZVdpdGgtUmV0cnkgLUNvbW1hbmQgewogICAgICAgICR3ZWJjbGllbnQuRG93bmxvYWRGaWxlKCREb3dubG9hZExpbmssICREZXN0aW5hdGlvbkZpbGUpCiAgICB9CiAgICBDaGVjay1GaWxlSW50ZWdyaXR5V2l0aFNIQTEgJERlc3RpbmF0aW9uRmlsZSAkRXhwZWN0ZWRTSEExSGFzaAp9CgpmdW5jdGlvbiBSZW1vdmUtRHVwbGljYXRlUGF0aHMgKCRQYXRoKSB7CiAgICAkYXJyYXlQYXRoID0gJFBhdGguU3BsaXQoJzsnKQogICAgJGFycmF5UGF0aCA9ICRhcnJheVBhdGggfCBTZWxlY3QtT2JqZWN0IC1VbmlxdWUKICAgICRuZXdQYXRoID0gJGFycmF5UGF0aCAtam9pbiAnOycKCiAgICByZXR1cm4gJG5ld1BhdGgKfQoKZnVuY3Rpb24gQWRkVG8tVXNlclBhdGggKCRQYXRoKSB7CiAgICAkbmV3UGF0aCA9IFJlbW92ZS1EdXBsaWNhdGVQYXRocyAiJGVudjpQYXRoOyRQYXRoIgoKICAgIEV4ZWN1dGUtRXh0ZXJuYWxDb21tYW5kIC1Db21tYW5kIHsKICAgICAgICBzZXR4IFBBVEggJG5ld1BhdGgKICAgIH0gLUVycm9yTWVzc2FnZSAiRmFpbGVkIHRvIHNldCB1c2VyIHBhdGgiCgogICAgUmVuZXctUFNTZXNzaW9uUGF0aAp9CgpmdW5jdGlvbiBSZW5ldy1QU1Nlc3Npb25QYXRoICgpIHsKICAgICR1c2VyUGF0aCA9IEdldC1Vc2VyUGF0aAogICAgJHN5c3RlbVBhdGggPSBHZXQtU3lzdGVtUGF0aAoKICAgICRuZXdQYXRoID0gJGVudjpQYXRoCiAgICBpZiAoKCR1c2VyUGF0aCAtbmUgJG51bGwpIC1hbmQgKCRzeXN0ZW1QYXRoIC1uZSAkbnVsbCkpIHsKICAgICAgICAkbmV3UGF0aCArPSAiOyR1c2VyUGF0aDskc3lzdGVtUGF0aCIKICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCR1c2VyUGF0aCAtZXEgJG51bGwpIHsKICAgICAgICAgICAgJG5ld1BhdGggKz0gIjskc3lzdGVtUGF0aCIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkbmV3UGF0aCArPSAiOyR1c2VyUGF0aCIKICAgICAgICB9CiAgICB9CgogICAgJGVudjpQYXRoID0gUmVtb3ZlLUR1cGxpY2F0ZVBhdGhzICRuZXdQYXRoCn0KCgojIEFMSUFTRVMKCmZ1bmN0aW9uIEV4ZWNSZXRyeSB7CiAgICBQYXJhbSgKICAgICAgICBbU2NyaXB0QmxvY2tdJENvbW1hbmQsCiAgICAgICAgW2ludF0kTWF4UmV0cnlDb3VudD0zLAogICAgICAgIFtpbnRdJFJldHJ5SW50ZXJ2YWw9MAogICAgKQoKICAgIEV4ZWN1dGVXaXRoLVJldHJ5ICRDb21tYW5kICRNYXhSZXRyeUNvdW50ICRSZXRyeUludGVydmFsCn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICoK
