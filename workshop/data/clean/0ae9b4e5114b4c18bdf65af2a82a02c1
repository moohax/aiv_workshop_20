common.ps1,55a89c6a7877246b6be05602780c78d8,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LUNoZWNrc3VtKCRmaWxlKSB7CiAgICAkY3J5cHRvUHJvdmlkZXIgPSBOZXctT2JqZWN0ICJTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5Lk1ENUNyeXB0b1NlcnZpY2VQcm92aWRlciIKCQogICAgJGZpbGVJbmZvID0gR2V0LUl0ZW0gJGZpbGUKCXRyYXAgeyA7Cgljb250aW51ZSB9ICRzdHJlYW0gPSAkZmlsZUluZm8uT3BlblJlYWQoKQogICAgaWYgKCQ/IC1lcSAkZmFsc2UpIHsKCQkjIENvdWxkbid0IG9wZW4gZmlsZSBmb3IgcmVhZGluZwogICAgICAgIHJldHVybiAkbnVsbAoJfQogICAgCiAgICAkYnl0ZXMgPSAkY3J5cHRvUHJvdmlkZXIuQ29tcHV0ZUhhc2goJHN0cmVhbSkKICAgICRjaGVja3N1bSA9ICcnCglmb3JlYWNoICgkYnl0ZSBpbiAkYnl0ZXMpIHsKCQkkY2hlY2tzdW0gKz0gJGJ5dGUuVG9TdHJpbmcoJ3gyJykKCX0KICAgIAoJJHN0cmVhbS5DbG9zZSgpIHwgT3V0LU51bGwKICAgIAogICAgcmV0dXJuICRjaGVja3N1bQp9CgpmdW5jdGlvbiBBZGRPclVwZGF0ZS1SZWZlcmVuY2UoJHNjcmlwdHNGb2xkZXJQcm9qZWN0SXRlbSwgJGZpbGVOYW1lUGF0dGVybiwgJG5ld0ZpbGVOYW1lKSB7CiAgICB0cnkgewogICAgICAgICRyZWZlcmVuY2VzRmlsZVByb2plY3RJdGVtID0gJHNjcmlwdHNGb2xkZXJQcm9qZWN0SXRlbS5Qcm9qZWN0SXRlbXMuSXRlbSgiX3JlZmVyZW5jZXMuanMiKQogICAgfQogICAgY2F0Y2ggewogICAgICAgICMgX3JlZmVyZW5jZXMuanMgZmlsZSBub3QgZm91bmQKICAgICAgICByZXR1cm4KICAgIH0KCiAgICBpZiAoJHJlZmVyZW5jZXNGaWxlUHJvamVjdEl0ZW0gLWVxICRudWxsKSB7CiAgICAgICAgIyBfcmVmZXJlbmNlcy5qcyBmaWxlIG5vdCBmb3VuZAogICAgICAgIHJldHVybgogICAgfQoKICAgICRyZWZlcmVuY2VzRmlsZVBhdGggPSAkcmVmZXJlbmNlc0ZpbGVQcm9qZWN0SXRlbS5GaWxlTmFtZXMoMSkKICAgICRyZWZlcmVuY2VzVGVtcEZpbGVQYXRoID0gSm9pbi1QYXRoICRlbnY6VEVNUCAiX3JlZmVyZW5jZXMudG1wLmpzIgoKICAgIGlmICgoU2VsZWN0LVN0cmluZyAkcmVmZXJlbmNlc0ZpbGVQYXRoIC1wYXR0ZXJuICRmaWxlTmFtZVBhdHRlcm4pLkxlbmd0aCAtZXEgMCkgewogICAgICAgICMgRmlsZSBoYXMgbm8gZXhpc3RpbmcgbWF0Y2hpbmcgcmVmZXJlbmNlIGxpbmUKICAgICAgICAjIEFkZCB0aGUgZnVsbCByZWZlcmVuY2UgbGluZSB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBmaWxlCiAgICAgICAgIi8vLyA8cmVmZXJlbmNlIHBhdGg9IiIkbmV3RmlsZU5hbWUiIiAvPiIgfCBBZGQtQ29udGVudCAkcmVmZXJlbmNlc1RlbXBGaWxlUGF0aCAtRW5jb2RpbmcgVVRGOAogICAgICAgICBHZXQtQ29udGVudCAkcmVmZXJlbmNlc0ZpbGVQYXRoIHwgQWRkLUNvbnRlbnQgJHJlZmVyZW5jZXNUZW1wRmlsZVBhdGgKICAgIH0KICAgIGVsc2UgewogICAgICAgICMgTG9vcCB0aHJvdWdoIGZpbGUgYW5kIHJlcGxhY2Ugb2xkIGZpbGUgbmFtZSB3aXRoIG5ldyBmaWxlIG5hbWUKICAgICAgICBHZXQtQ29udGVudCAkcmVmZXJlbmNlc0ZpbGVQYXRoIHwgRm9yRWFjaC1PYmplY3QgeyAkXyAtcmVwbGFjZSAkZmlsZU5hbWVQYXR0ZXJuLCAkbmV3RmlsZU5hbWUgfSA+ICRyZWZlcmVuY2VzVGVtcEZpbGVQYXRoCiAgICB9CgogICAgIyBDb3B5IG92ZXIgdGhlIG5ldyBfcmVmZXJlbmNlcy5qcyBmaWxlCiAgICBDb3B5LUl0ZW0gJHJlZmVyZW5jZXNUZW1wRmlsZVBhdGggJHJlZmVyZW5jZXNGaWxlUGF0aCAtRm9yY2UKICAgIFJlbW92ZS1JdGVtICRyZWZlcmVuY2VzVGVtcEZpbGVQYXRoIC1Gb3JjZQp9CgpmdW5jdGlvbiBSZW1vdmUtUmVmZXJlbmNlKCRzY3JpcHRzRm9sZGVyUHJvamVjdEl0ZW0sICRmaWxlTmFtZVBhdHRlcm4pIHsKICAgIHRyeSB7CiAgICAgICAgJHJlZmVyZW5jZXNGaWxlUHJvamVjdEl0ZW0gPSAkc2NyaXB0c0ZvbGRlclByb2plY3RJdGVtLlByb2plY3RJdGVtcy5JdGVtKCJfcmVmZXJlbmNlcy5qcyIpCiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgIyBfcmVmZXJlbmNlcy5qcyBmaWxlIG5vdCBmb3VuZAogICAgICAgIHJldHVybgogICAgfQoKICAgIGlmICgkcmVmZXJlbmNlc0ZpbGVQcm9qZWN0SXRlbSAtZXEgJG51bGwpIHsKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAkcmVmZXJlbmNlc0ZpbGVQYXRoID0gJHJlZmVyZW5jZXNGaWxlUHJvamVjdEl0ZW0uRmlsZU5hbWVzKDEpCiAgICAkcmVmZXJlbmNlc1RlbXBGaWxlUGF0aCA9IEpvaW4tUGF0aCAkZW52OlRFTVAgIl9yZWZlcmVuY2VzLnRtcC5qcyIKCiAgICBpZiAoKFNlbGVjdC1TdHJpbmcgJHJlZmVyZW5jZXNGaWxlUGF0aCAtcGF0dGVybiAkZmlsZU5hbWVQYXR0ZXJuKS5MZW5ndGggLWVxIDEpIHsKICAgICAgICAjIERlbGV0ZSB0aGUgbGluZSByZWZlcmVuY2luZyB0aGUgZmlsZQogICAgICAgIEdldC1Db250ZW50ICRyZWZlcmVuY2VzRmlsZVBhdGggfCBGb3JFYWNoLU9iamVjdCB7IGlmICgtbm90ICgkXyAtbWF0Y2ggJGZpbGVOYW1lUGF0dGVybikpIHsgJF8gfSB9ID4gJHJlZmVyZW5jZXNUZW1wRmlsZVBhdGgKCiAgICAgICAgIyBDb3B5IG92ZXIgdGhlIG5ldyBfcmVmZXJlbmNlcy5qcyBmaWxlCiAgICAgICAgQ29weS1JdGVtICRyZWZlcmVuY2VzVGVtcEZpbGVQYXRoICRyZWZlcmVuY2VzRmlsZVBhdGggLUZvcmNlCiAgICAgICAgUmVtb3ZlLUl0ZW0gJHJlZmVyZW5jZXNUZW1wRmlsZVBhdGggLUZvcmNlCiAgICB9Cn0KCmZ1bmN0aW9uIERlbGV0ZS1Qcm9qZWN0SXRlbSgkaXRlbSkgewogICAgJGl0ZW1EZWxldGVkID0gJGZhbHNlCiAgICBmb3IgKCQxPTE7ICRpIC1sZSA1OyAkaSsrKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGl0ZW0uRGVsZXRlKCkKICAgICAgICAgICAgJGl0ZW1EZWxldGVkID0gJHRydWUKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAjIFRyeSBhZ2FpbiBpbiAyMDBtcwogICAgICAgICAgICBbU3lzdGVtLlRocmVhZGluZy5UaHJlYWRdOjpTbGVlcCgyMDApCiAgICAgICAgfQogICAgfQogICAgaWYgKCRpdGVtRGVsZXRlZCAtZXEgJGZhbHNlKSB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBkZWxldGUgcHJvamVjdCBpdGVtIGFmdGVyIGZpdmUgYXR0ZW1wdHMuIgogICAgfQp9CgojIEV4dHJhY3QgdGhlIHZlcnNpb24gbnVtYmVyIGZyb20gdGhlIHNhbW15IGZpbGUgaW4gdGhlIHBhY2thZ2UncyBjb250ZW50XHNjcmlwdHMgZm9sZGVyCiRwYWNrYWdlU2NyaXB0c0ZvbGRlciA9IEpvaW4tUGF0aCAkaW5zdGFsbFBhdGggQ29udGVudFxTY3JpcHRzCiRzYW1teUZpbGVOYW1lID0gSm9pbi1QYXRoICRwYWNrYWdlU2NyaXB0c0ZvbGRlciAic2FtbXktKi5qcyIgfCBHZXQtQ2hpbGRJdGVtIC1FeGNsdWRlICIqLm1pbi5qcyIsIiotdnNkb2MuanMiIHwgU3BsaXQtUGF0aCAtTGVhZgokc2FtbXlGaWxlTmFtZVJlZ0V4ID0gInNhbW15LSgoPzpcZCtcLik/KD86XGQrXC4pPyg/OlxkK1wuKT8oPzpcZCspKS5qcyIKJHNhbW15RmlsZU5hbWUgLW1hdGNoICRzYW1teUZpbGVOYW1lUmVnRXgKJHZlciA9ICRtYXRjaGVzWzFdCgokaW50ZWxsaVNlbnNlRmlsZU5hbWUgPSAic2FtbXktJHZlci5pbnRlbGxpc2Vuc2UuanMiCgojIEdldCB0aGUgcHJvamVjdCBpdGVtIGZvciB0aGUgc2NyaXB0cyBmb2xkZXIKdHJ5IHsKICAgICRzY3JpcHRzRm9sZGVyUHJvamVjdEl0ZW0gPSAkcHJvamVjdC5Qcm9qZWN0SXRlbXMuSXRlbSgiU2NyaXB0cyIpCiAgICAkcHJvamVjdFNjcmlwdHNGb2xkZXJQYXRoID0gJHNjcmlwdHNGb2xkZXJQcm9qZWN0SXRlbS5GaWxlTmFtZXMoMSkKfQpjYXRjaCB7CiAgICAjIE5vIFNjcmlwdHMgZm9sZGVyCiAgICBXcml0ZS1Ib3N0ICJObyBzY3JpcHRzIGZvbGRlciBmb3VuZCIKfQ==
