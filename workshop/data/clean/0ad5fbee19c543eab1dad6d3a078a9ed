win_packagemanagementsource.ps1,791292b7beeeb290a436e7bd70c936ea,Scan result is 1. IsMalware: 0,IyFwb3dlcnNoZWxsCiMgPENPUFlSSUdIVD4KIyA8Q09ERUdFTk1FVEE+CiMKIyBUaGlzIGZpbGUgaXMgcGFydCBvZiBBbnNpYmxlCiMKIyBBbnNpYmxlIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQojIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiMgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KIwojIEFuc2libGUgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKIyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgojCiMgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKIyBhbG9uZyB3aXRoIEFuc2libGUuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgojIFdBTlRfSlNPTgojIFBPV0VSU0hFTExfQ09NTU9OCgokcGFyYW1zID0gUGFyc2UtQXJncyAkYXJncwokcmVzdWx0ID0gTmV3LU9iamVjdCBwc29iamVjdApTZXQtQXR0ciAkcmVzdWx0ICJjaGFuZ2VkIiAkZmFsc2UKCgoKI0FUVFJJQlVURTpOYW1lO01BTkRBVE9SWTpUcnVlO0RFRkFVTFRWQUxVRTo7REVTQ1JJUFRJT046O0NIT0lDRVM6CiROYW1lID0gR2V0LUF0dHIgLW9iaiAkcGFyYW1zIC1uYW1lIE5hbWUgLWZhaWxpZmVtcHR5ICRUcnVlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOlByb3ZpZGVyTmFtZTtNQU5EQVRPUlk6VHJ1ZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOgokUHJvdmlkZXJOYW1lID0gR2V0LUF0dHIgLW9iaiAkcGFyYW1zIC1uYW1lIFByb3ZpZGVyTmFtZSAtZmFpbGlmZW1wdHkgJFRydWUgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6RW5zdXJlO01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOkFic2VudCxQcmVzZW50CiRFbnN1cmUgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgRW5zdXJlIC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6SW5zdGFsbGF0aW9uUG9saWN5O01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOlRydXN0ZWQsVW50cnVzdGVkCiRJbnN0YWxsYXRpb25Qb2xpY3kgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgSW5zdGFsbGF0aW9uUG9saWN5IC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6UHNEc2NSdW5Bc0NyZWRlbnRpYWxfdXNlcm5hbWU7TUFOREFUT1JZOkZhbHNlO0RFRkFVTFRWQUxVRTo7REVTQ1JJUFRJT046O0NIT0lDRVM6CiRQc0RzY1J1bkFzQ3JlZGVudGlhbF91c2VybmFtZSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBQc0RzY1J1bkFzQ3JlZGVudGlhbF91c2VybmFtZSAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOlBzRHNjUnVuQXNDcmVkZW50aWFsX3Bhc3N3b3JkO01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOgokUHNEc2NSdW5Bc0NyZWRlbnRpYWxfcGFzc3dvcmQgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgUHNEc2NSdW5Bc0NyZWRlbnRpYWxfcGFzc3dvcmQgLWZhaWxpZmVtcHR5ICRGYWxzZSAtcmVzdWx0b2JqICRyZXN1bHQKI0FUVFJJQlVURTpTb3VyY2VDcmVkZW50aWFsX3VzZXJuYW1lO01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6O0RFU0NSSVBUSU9OOjtDSE9JQ0VTOgokU291cmNlQ3JlZGVudGlhbF91c2VybmFtZSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBTb3VyY2VDcmVkZW50aWFsX3VzZXJuYW1lIC1mYWlsaWZlbXB0eSAkRmFsc2UgLXJlc3VsdG9iaiAkcmVzdWx0CiNBVFRSSUJVVEU6U291cmNlQ3JlZGVudGlhbF9wYXNzd29yZDtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzoKJFNvdXJjZUNyZWRlbnRpYWxfcGFzc3dvcmQgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgU291cmNlQ3JlZGVudGlhbF9wYXNzd29yZCAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdAojQVRUUklCVVRFOlNvdXJjZVVyaTtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOjtERVNDUklQVElPTjo7Q0hPSUNFUzoKJFNvdXJjZVVyaSA9IEdldC1BdHRyIC1vYmogJHBhcmFtcyAtbmFtZSBTb3VyY2VVcmkgLWZhaWxpZmVtcHR5ICRGYWxzZSAtcmVzdWx0b2JqICRyZXN1bHQKI0FUVFJJQlVURTpBdXRvSW5zdGFsbE1vZHVsZTtNQU5EQVRPUlk6RmFsc2U7REVGQVVMVFZBTFVFOmZhbHNlO0RFU0NSSVBUSU9OOklmIHRydWUsIHRoZSByZXF1aXJlZCBkc2MgcmVzb3VyY2UvbW9kdWxlIHdpbGwgYmUgYXV0by1pbnN0YWxsZWQgdXNpbmcgdGhlIFBvd2Vyc2hlbGwgcGFja2FnZSBtYW5hZ2VyO0NIT0lDRVM6dHJ1ZSxmYWxzZQokQXV0b0luc3RhbGxNb2R1bGUgPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgQXV0b0luc3RhbGxNb2R1bGUgLWZhaWxpZmVtcHR5ICRGYWxzZSAtcmVzdWx0b2JqICRyZXN1bHQgLWRlZmF1bHQgZmFsc2UKI0FUVFJJQlVURTpBdXRvQ29uZmlndXJlTGNtO01BTkRBVE9SWTpGYWxzZTtERUZBVUxUVkFMVUU6ZmFsc2U7REVTQ1JJUFRJT046SWYgdHJ1ZSwgTENNIHdpbGwgYmUgYXV0by1jb25maWd1cmVkIGZvciBkaXJlY3RseSBpbnZva2luZyBEU0MgcmVzb3VyY2VzICh3aGljaCBpcyBhIG9uZS10aW1lIHJlcXVpcmVtZW50IGZvciBBbnNpYmxlIERTQyBtb2R1bGVzKTtDSE9JQ0VTOnRydWUsZmFsc2UKJEF1dG9Db25maWd1cmVMY20gPSBHZXQtQXR0ciAtb2JqICRwYXJhbXMgLW5hbWUgQXV0b0NvbmZpZ3VyZUxjbSAtZmFpbGlmZW1wdHkgJEZhbHNlIC1yZXN1bHRvYmogJHJlc3VsdCAtZGVmYXVsdCBmYWxzZQpJZiAoJEVuc3VyZSkKewogICAgSWYgKCgnQWJzZW50JywnUHJlc2VudCcpIC1jb250YWlucyAkRW5zdXJlICkgewogICAgfQogICAgRWxzZQogICAgewogICAgICAgIEZhaWwtSnNvbiAkcmVzdWx0ICJPcHRpb24gRW5zdXJlIGhhcyBpbnZhbGlkIHZhbHVlICRFbnN1cmUuIFZhbGlkIHZhbHVlcyBhcmUgJ0Fic2VudCcsJ1ByZXNlbnQnIgogICAgfQp9CgoKSWYgKCRJbnN0YWxsYXRpb25Qb2xpY3kpCnsKICAgIElmICgoJ1RydXN0ZWQnLCdVbnRydXN0ZWQnKSAtY29udGFpbnMgJEluc3RhbGxhdGlvblBvbGljeSApIHsKICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICBGYWlsLUpzb24gJHJlc3VsdCAiT3B0aW9uIEluc3RhbGxhdGlvblBvbGljeSBoYXMgaW52YWxpZCB2YWx1ZSAkSW5zdGFsbGF0aW9uUG9saWN5LiBWYWxpZCB2YWx1ZXMgYXJlICdUcnVzdGVkJywnVW50cnVzdGVkJyIKICAgIH0KfQoKCklmICgkQXV0b0luc3RhbGxNb2R1bGUpCnsKICAgIElmICgoJ3RydWUnLCdmYWxzZScpIC1jb250YWlucyAkQXV0b0luc3RhbGxNb2R1bGUgKSB7CiAgICB9CiAgICBFbHNlCiAgICB7CiAgICAgICAgRmFpbC1Kc29uICRyZXN1bHQgIk9wdGlvbiBBdXRvSW5zdGFsbE1vZHVsZSBoYXMgaW52YWxpZCB2YWx1ZSAkQXV0b0luc3RhbGxNb2R1bGUuIFZhbGlkIHZhbHVlcyBhcmUgJ3RydWUnLCdmYWxzZSciCiAgICB9Cn0KCgpJZiAoJEF1dG9Db25maWd1cmVMY20pCnsKICAgIElmICgoJ3RydWUnLCdmYWxzZScpIC1jb250YWlucyAkQXV0b0NvbmZpZ3VyZUxjbSApIHsKICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICBGYWlsLUpzb24gJHJlc3VsdCAiT3B0aW9uIEF1dG9Db25maWd1cmVMY20gaGFzIGludmFsaWQgdmFsdWUgJEF1dG9Db25maWd1cmVMY20uIFZhbGlkIHZhbHVlcyBhcmUgJ3RydWUnLCdmYWxzZSciCiAgICB9Cn0KCgppZiAoJFBzRHNjUnVuQXNDcmVkZW50aWFsX3VzZXJuYW1lKQp7CiRQc0RzY1J1bkFzQ3JlZGVudGlhbF9zZWN1cmVwYXNzd29yZCA9ICRQc0RzY1J1bkFzQ3JlZGVudGlhbF9wYXNzd29yZCB8IENvbnZlcnRUby1TZWN1cmVTdHJpbmcgLWFzUGxhaW5UZXh0IC1Gb3JjZQokUHNEc2NSdW5Bc0NyZWRlbnRpYWwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsKCRQc0RzY1J1bkFzQ3JlZGVudGlhbF91c2VybmFtZSwkUHNEc2NSdW5Bc0NyZWRlbnRpYWxfc2VjdXJlcGFzc3dvcmQpCn0KCmlmICgkU291cmNlQ3JlZGVudGlhbF91c2VybmFtZSkKewokU291cmNlQ3JlZGVudGlhbF9zZWN1cmVwYXNzd29yZCA9ICRTb3VyY2VDcmVkZW50aWFsX3Bhc3N3b3JkIHwgQ29udmVydFRvLVNlY3VyZVN0cmluZyAtYXNQbGFpblRleHQgLUZvcmNlCiRTb3VyY2VDcmVkZW50aWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCgkU291cmNlQ3JlZGVudGlhbF91c2VybmFtZSwkU291cmNlQ3JlZGVudGlhbF9zZWN1cmVwYXNzd29yZCkKfQoKJERzY1Jlc291cmNlTmFtZSA9ICJQYWNrYWdlTWFuYWdlbWVudFNvdXJjZSIKCiNUaGlzIGNvZGUgY29tZXMgZnJvbSBwb3dlcnNoZWxsMl9kc2NyZXNvdXJjZXZlcmlmeS5wczEgaW4gdGhlIERTQy0tPkFuc2libGUgY29kZWdlbiB0b29sCgojVmVyaWZ5IHBvd2Vyc2hlbGwgdmVyc2lvbgppZiAoKCRwc3ZlcnNpb250YWJsZS5wc3ZlcnNpb24ubWFqb3IgLWdlIDUpIC1hbmQgKCRwc3ZlcnNpb250YWJsZS5wc3ZlcnNpb24uYnVpbGQgLWdlIDEwMDE4KSkKewoJI0RvIG5vdGhpbmcKfQpFbHNlCnsKCUZhaWwtSnNvbiAkcmVzdWx0ICJMb2NhbCBwb3dlcnNoZWxsIHZlcnNpb24gaXMgbm90IGF0IHRoZSByZXVpcmVkIHZlcnNpb24gKGZvdW5kIHZlcnNpb24gJCgkUHN2ZXJzaW9udGFibGUucHN2ZXJzaW9uLnRvc3RyaW5nKCkpICkiCn0KCmlmICgkQXV0b0luc3RhbGxNb2R1bGUpCnsKICAgICRBdXRvSW5zdGFsbE1vZHVsZSA9ICRBdXRvSW5zdGFsbE1vZHVsZSB8IGNvbnZlcnR0by1ib29sCn0KCgokUmVzb3VyY2VFeGlzdHMgPSBHZXQtRHNjUmVzb3VyY2UgJGRzY3Jlc291cmNlbmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQoKaWYgKCEkUmVzb3VyY2VFeGlzdHMpCnsKICAgICNEb3dubG9hZCB0aGUgbW9kdWxlIGNvbnRhaW5pbmcgdGhlIHJlc291cmNlIGlmIHRoYXQncyBhbGxvd2VkCiAgICBpZiAoJEF1dG9JbnN0YWxsTW9kdWxlIHwgY29udmVydHRvLWJvb2wpCiAgICB7CiAgICAgICAgI1VTZSBmaW5kLXBhY2thZ2UgdG8gYXV0by1pbnN0YWxsIHRoZSBudWdldCBiaW5hcmllcwogICAgICAgIEZpbmQtUGFja2FnZSBzb21ldGhpbmcgLUZvcmNlQm9vdHN0cmFwIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgb3V0LW51bGwKICAgICAgICAkcmVzID0gRmluZC1kc2NyZXNvdXJjZSAkZHNjcmVzb3VyY2VuYW1lCiAgICAgICAgaW5zdGFsbC1tb2R1bGUgJHJlcy5tb2R1bGVuYW1lIC1mb3JjZQogICAgICAgIFNldC1BdHRyICRyZXN1bHQgIkF1dG9JbnN0YWxsZWRNb2R1bGUiICRyZXMubW9kdWxlbmFtZQogICAgfQogICAgCiAgICAkUmVzb3VyY2VFeGlzdHMgPSBHZXQtRHNjUmVzb3VyY2UgJGRzY3Jlc291cmNlbmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQp9CgppZiAoISRSZXNvdXJjZUV4aXN0cykKewogICAgRmFpbC1Kc29uICRyZXN1bHQgIlVuYWJsZSB0byBsb2NhdGUgRFNDIG1vZHVsZSAkZHNjbW9kdWxlbmFtZSBhbmQvb3IgRFNDIHJlc291cmNlICRkc2NyZXNvdXJjZW5hbWUiCn0KCiNDaGVjayB0aGF0IExDTSBpcyBpbiB0aGUgcmlnaHQgc3RhdHVzCiRMY20gPSBHZXQtRHNjTG9jYWxDb25maWd1cmF0aW9uTWFuYWdlcgppZiAoKCRsY20uUmVmcmVzaE1vZGUpIC1lcSAiRGlzYWJsZWQiKQp7CiAgICAjQWxsIGdvb2QKfQpFbHNlCnsKICAgIGlmICgoJGF1dG9jb25maWd1cmVMY20gfCBjb252ZXJ0dG8tYm9vbCkgLWVxICR0cnVlKQogICAgewogICAgICAgICRyZWZyZXNobW9kZSA9ICJEaXNhYmxlZCIKICAgICAgICAjUmVjb25maWd1cmUgTENNCiAgICAgICAgW0RzY0xvY2FsQ29uZmlndXJhdGlvbk1hbmFnZXIoKV0KICAgICAgICBDb25maWd1cmF0aW9uIE1ldGEgewogICAgICAgICAgICAgICBTZXR0aW5ncyB7CiAgICAgICAgICAgICAgICAgICBSZWZyZXNoTW9kZSA9ICRSZWZyZXNoTW9kZQogICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgJiBtZXRhCiAgICAgICAgICAgIFNldC1Ec2NMb2NhbENvbmZpZ3VyYXRpb25NYW5hZ2VyIC1QYXRoIC5cTWV0YSAgLUVycm9yQWN0aW9uIFN0b3AgLUVycm9yVmFyaWFibGUgbGNtZXJyb3IKICAgIAogICAgICAgIH0KICAgICAgICBDYXRjaAogICAgICAgIHsKICAgICAgICAgICAgRmFpbC1qc29uICRyZXN1bHQgIkVycm9yIHJlY29uZmlndXJpbmcgTENNIiAKICAgICAgICB9CiAgICB9CiAgICBFbHNlCiAgICB7CiAgICAgICAgRmFpbC1qc29uICRyZXN1bHQgIkRTQyBMb2NhbCBDb25maWd1cmF0aW9uIE1hbmFnZXIgaXMgbm90IHNldCB0byBkaXNhYmxlZC4gU2V0IHRoZSBtb2R1bGUgb3B0aW9uIEF1dG9Db25maWd1cmVMY20gdG8gRGlzYWJsZWQgaW4gb3JkZXIgdG8gYXV0by1jb25maWd1cmUgTENNIiAKICAgIH0KCn0KCiRBdHRyaWJ1dGVzID0gJHBhcmFtcyB8IGdldC1tZW1iZXIgfCB3aGVyZSB7JF8uTWVtYmVyVFlwZSAtZXEgIm5vdGVwcm9wZXJ0eSJ9ICB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQokQXR0cmlidXRlcyA9ICRhdHRyaWJ1dGVzIHwgd2hlcmUgeyRfIC1uZSAiYXV0b2luc3RhbGxtb2R1bGUifQokQXR0cmlidXRlcyA9ICRhdHRyaWJ1dGVzIHwgd2hlcmUgeyRfIC1uZSAiQXV0b0NvbmZpZ3VyZUxjbSJ9CgoKaWYgKCEoJEF0dHJpYnV0ZXMpKQp7CiAgICBGYWlsLUpzb24gLW9iaiAkcmVzdWx0IC1tZXNzYWdlICJObyBhdHRyaWJ1dGVzIHNwZWNpZmllZCIKfQoKI0Fsd2F5cyByZXR1cm4gdGhlIG5hbWUKc2V0LWF0dHIgLW9iaiAkcmVzdWx0IC1uYW1lICJyZXNvdXJjZV9uYW1lIiAtdmFsdWUgJGRzY3Jlc291cmNlbmFtZQpzZXQtYXR0ciAtb2JqICRyZXN1bHQgLW5hbWUgIkF0dHJpYnV0ZXMiIC12YWx1ZSAkQXR0cmlidXRlcwoKJEF0dHJpYiA9IEB7fQoKPCMKJHBhcmFtcy5LZXlzIHwgZm9yZWFjaC1vYmplY3QgewogICAgJEF0dHJpYi5BZGQoJF8sJHBhcmFtcy5JdGVtKCRfKSkKICAgIHNldC1hdHRyIC1vYmogJHJlc3VsdCAtbmFtZSAkXyAtdmFsdWUgJHBhcmFtcy5JdGVtKCRfKQogICAgfQojPgoKJEtleXMgPSAkcGFyYW1zLnBzb2JqZWN0LlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTWVtYmVyVFlwZSAtZXEgIk5vdGVwcm9wZXJ0eSJ9IHwgd2hlcmUgeyRfLk5hbWUgLW5lICJyZXNvdXJjZV9uYW1lIn0gfHdoZXJlIHskXy5OYW1lIC1uZSAiYXV0b2luc3RhbGxtb2R1bGUifSB8d2hlcmUgeyRfLk5hbWUgLW5lICJhdXRvY29uZmlndXJlbGNtIn0gfCAgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCmZvcmVhY2ggKCRrZXkgaW4gJGtleXMpCnsKICAgICRBdHRyaWIuYWRkKCRrZXksICgkcGFyYW1zLiRrZXkpKQogICAgc2V0LWF0dHIgLW9iaiAkcmVzdWx0IC1uYW1lICRrZXkgLXZhbHVlICgkcGFyYW1zLiRrZXkpCn0KCiRDb25maWcgPSBAewogICBOYW1lID0gKCRkc2NyZXNvdXJjZW5hbWUpCiAgIFByb3BlcnR5ID0gQHsKICAgICAgICB9CiAgICB9CgoKJFJlc291cmNlID0gR2V0LURzY1Jlc291cmNlIC1OYW1lICRkc2NyZXNvdXJjZW5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKaWYgKCEkUmVzb3VyY2UpCnsKICAgIEZhaWwtSnNvbiAtb2JqICRyZXN1bHQgLW1lc3NhZ2UgIlJlc291cmNlICRkc2NyZXNvdXJjZW5hbWUgbm90IGZvdW5kIgp9CgojQ29udmVydCBwYXJhbXMgdG8gY29ycmVjdCBkYXRhdHlwZSBhbmQgaW5qZWN0CiNDb252ZXJ0IHBhcmFtcyB0byBjb3JyZWN0IGRhdGF0eXBlIGFuZCBpbmplY3QKJGF0dHJpYi5LZXlzIHwgZm9yZWFjaC1vYmplY3QgewogICAgJEtleSA9ICRfLnJlcGxhY2UoIml0ZW1fbmFtZSIsICJuYW1lIikKICAgICRwcm9wID0gJHJlc291cmNlLlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTmFtZSAtZXEgJGtleX0KICAgIGlmICghJHByb3ApCiAgICB7CiAgICAgICAgI0lmIGl0cyBhIGNyZWRlbnRpYWwgc3BlY2lmaWVkIGFzICJjcmVkZW50aWFsIiwgQW5zaWJsZSB3aWxsIHN1cHBvcnQgY3JlZGVudGlhbF91c2VybmFtZSBhbmQgY3JlZGVudGlhbF9wYXNzd29yZC4gTmVlZCB0byBjaGVjayBmb3IgdGhhdAogICAgICAgICRwcm9wID0gJHJlc291cmNlLlByb3BlcnRpZXMgfCB3aGVyZSB7JF8uTmFtZSAtZXEgJGtleS5SZXBsYWNlKCJfdXNlcm5hbWUiLCIiKX0KICAgICAgICBpZiAoJHByb3ApCiAgICAgICAgewogICAgICAgICAgICAjV2UgbmVlZCB0byBjb25zdHJ1Y3QgYSBjcmVkIG9iamVjdC4gQXQgdGhpcyBwb2ludCBrZXl2YWx1ZSBpcyB0aGUgdXNlcm5hbWUsIHNvIGdyYWIgdGhlIHBhc3N3b3JkCiAgICAgICAgICAgICRQcm9wVXNlck5hbWVWYWx1ZSA9ICRhdHRyaWIuSXRlbSgkXykKICAgICAgICAgICAgJFByb3BQYXNzd29yZCA9ICRrZXkuUmVwbGFjZSgiX3VzZXJuYW1lIiwiX3Bhc3N3b3JkIikKICAgICAgICAgICAgJFByb3BQYXNzd29yZFZhbHVlID0gJGF0dHJpYi4kUHJvcFBhc3N3b3JkCgogICAgICAgICAgICAkY3JlZCA9IE5ldy1PYmplY3QgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWwgKCRQcm9wVXNlck5hbWVWYWx1ZSwgKCRQcm9wUGFzc3dvcmRWYWx1ZSB8IENvbnZlcnRUby1TZWN1cmVTdHJpbmcgLUFzUGxhaW5UZXh0IC1Gb3JjZSkpCiAgICAgICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0kS2V5VmFsdWUgPSAkY3JlZAogICAgICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LlJlcGxhY2UoIl91c2VybmFtZSIsIiIpLCRLZXlWYWx1ZSkKICAgICAgICB9CiAgICAgICAgRWxzZUlmICgka2V5LkNvbnRhaW5zKCJfcGFzc3dvcmQiKSkKICAgICAgICB7CiAgICAgICAgICAgICNEbyBub3RoaW5nLiBXZSBzdWNrIGluIHRoZSBwYXNzd29yZCBpbiB0aGUgaGFuZGxlciBmb3IgX3VzZXJuYW1lLCBzbyB3ZSBjYW4ganVzdCBza2lwIGl0LgogICAgICAgIH0KICAgICAgICBFbHNlCiAgICAgICAgewogICAgICAgICAgICBGYWlsLUpzb24gLW9iaiAkcmVzdWx0IC1tZXNzYWdlICJQcm9wZXJ0eSAka2V5IGluIHJlc291cmNlICRkc2NyZXNvdXJjZW5hbWUgaXMgbm90IGEgdmFsaWQgcHJvcGVydHkiCiAgICAgICAgfQogICAgICAgIAogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbc3RyaW5nXSIpCiAgICB7CiAgICAgICAgW1N0cmluZ10kS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICAgJGNvbmZpZy5Qcm9wZXJ0eS5BZGQoJGtleSwkS2V5VmFsdWUpCiAgICB9CiAgICBFbHNlSWYgKCRwcm9wLlByb3BlcnR5VHlwZSAtZXEgIltzdHJpbmdbXV0iKQogICAgewogICAgICAgICNLZXlWYWx1ZSBpcyBhbiBhcnJheSBvZiBzdHJpbmdzCiAgICAgICAgW1N0cmluZ10kVGVtcEtleVZhbHVlID0gJGF0dHJpYi5JdGVtKCRfKQogICAgICAgIFtTdHJpbmdbXV0kS2V5VmFsdWUgPSAkVGVtcEtleVZhbHVlLlNwbGl0KCIsIikuVHJpbSgpCgogICAgICAgICRjb25maWcuUHJvcGVydHkuQWRkKCRrZXksJEtleVZhbHVlKQogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbVUludDMyW11dIikKICAgIHsKICAgICAgICAjS2V5VmFsdWUgaXMgYW4gYXJyYXkgb2YgaW50ZWdlcnMKICAgICAgICBbU3RyaW5nXSRUZW1wS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICAgW1VJbnQzMltdXSRLZXlWYWx1ZSA9ICRhdHRyaWIuSXRlbSgkXy5zcGxpdCgiLCIpLlRyaW0oKSkKICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LCRLZXlWYWx1ZSkKICAgIH0KICAgIEVsc2VJZiAoJHByb3AuUHJvcGVydHlUeXBlIC1lcSAiW2Jvb2xdIikKICAgIHsKICAgICAgICBpZiAoJGF0dHJpYi5JdGVtKCRfKSAtbGlrZSAidHJ1ZSIpCiAgICAgICAgewogICAgICAgICAgICBbYm9vbF0kS2V5VmFsdWUgPSAkdHJ1ZQogICAgICAgIH0KICAgICAgICBFbHNlSWYgKCRhdHRyaWIuSXRlbSgkXykgLWxpa2UgImZhbHNlIikKICAgICAgICB7CiAgICAgICAgICAgIFtib29sXSRLZXlWYWx1ZSA9ICRmYWxzZQogICAgICAgIH0KICAgICAgICAkY29uZmlnLlByb3BlcnR5LkFkZCgka2V5LCRLZXlWYWx1ZSkKICAgIH0KICAgIEVsc2VJZiAoJHByb3AuUHJvcGVydHlUeXBlIC1lcSAiW2ludF0iKQogICAgewogICAgICAgIFtpbnRdJEtleVZhbHVlID0gJGF0dHJpYi5JdGVtKCRfKQogICAgICAgICRjb25maWcuUHJvcGVydHkuQWRkKCRrZXksJEtleVZhbHVlKQogICAgfQogICAgRWxzZUlmICgkcHJvcC5Qcm9wZXJ0eVR5cGUgLWVxICJbQ2ltSW5zdGFuY2VbXV0iKQogICAgewogICAgICAjS2V5VmFsdWUgaXMgYW4gYXJyYXkgb2YgQ2ltSW5zdGFuY2UKICAgICAgW0NpbUluc3RhbmNlW11dJEtleVZhbCA9IEAoKQogICAgICBbU3RyaW5nXSRUZW1wS2V5VmFsdWUgPSAkYXR0cmliLkl0ZW0oJF8pCiAgICAgICNOZWVkIHRvIHNwbGl0IG9uIHRoZSBzdHJpbmcgfSwgYmVjYXVzZSBzb21lIHByb3BlcnR5IHZhbHVlcyBoYXZlIGNvbW1hcyBpbiB0aGVtCiAgICAgIFtTdHJpbmdbXV0kS2V5VmFsdWVTdHIgPSAkVGVtcEtleVZhbHVlIC1zcGxpdCgifSwiKQogICAgICAjR28gdGhyb3VnaCBlYWNoIHN0cmluZyBvZiBwcm9wZXJ0aWVzIGFuZCBjcmVhdGUgYSBoYXNoIG9mIHRoZW0KICAgICAgZm9yZWFjaCgkc3RyIGluICRLZXlWYWx1ZVN0cikKICAgICAgewogICAgICAgIFtzdHJpbmdbXV0kcHJvcGVydGllcyA9ICRzdHIuU3BsaXQoInsiKVsxXS5SZXBsYWNlKCJ9IiwiIikuVHJpbSgpLlNwbGl0KFtlbnZpcm9ubWVudF06Ok5ld0xpbmUpLlRyaW0oKQogICAgICAgICRwcnBoID0gQHt9CiAgICAgICAgZm9yZWFjaCgkcCBpbiAkcHJvcGVydGllcykKICAgICAgICB7CiAgICAgICAgICAkcEFyciA9ICRwIC1zcGxpdCAiPSIKICAgICAgICAgICNpZiB0aGUgdmFsdWUgY2FuIGJlIGFuIGludCB3ZSBtdXN0IGNvbnZlcnQgaXQgdG8gYW4gaW50CiAgICAgICAgICBpZihbYm9vbF0oJHBBcnJbMV0gLWFzIFtpbnRdIC1pcyBbaW50XSkpCiAgICAgICAgICB7CiAgICAgICAgICAgICAgJHBycGguQWRkKCRwQXJyWzBdLlRyaW0oKSwkcEFyclsxXS5UcmltKCkgLWFzIFtpbnRdKQogICAgICAgICAgfQogICAgICAgICAgZWxzZQogICAgICAgICAgewogICAgICAgICAgICAgICRwcnBoLkFkZCgkcEFyclswXS5UcmltKCksJHBBcnJbMV0uVHJpbSgpKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjY3JlYXRlIHRoZSBuZXcgQ2ltSW5zdGFuY2UKICAgICAgICAkY2ltID0gTmV3LUNpbUluc3RhbmNlIC1DbGFzc05hbWUgJHN0ci5TcGxpdCgieyIpWzBdLlRyaW0oKSAtUHJvcGVydHkgJHBycGggLUNsaWVudE9ubHkKICAgICAgICAjYWRkIHRoZSBuZXcgQ2ltSW5zdGFuY2UgdG8gdGhlIGFycmF5CiAgICAgICAgJEtleVZhbCArPSAkY2ltCiAgICAgIH0KICAgICAgJGNvbmZpZy5Qcm9wZXJ0eS5BZGQoJGtleSwkS2V5VmFsKQogICAgfQogIH0KCnRyeQp7CiAgICAjSW52b2tlIFdNRjUgcHJvZHVjdGlvbiBwcmV2aWV3IGRpZmZlcmVudGx5IHRoYW4gZmViIHByZXZpZXcKICAgICRUYXJnZXRWZXJzaW9uID0gW3ZlcnNpb25dOjpuZXcoIjUuMC4xMDUxNC42IikKICAgIGlmICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLkNvbXBhcmVUbygkVGFyZ2V0VmVyc2lvbikgLWdlIDApCiAgICB7CiAgICAgICAgI0N1cnJlbnQgaG9zdHMgdmVyc2lvbiBpcyBwcm9kdWN0aW9uIHByZXZvZXcgb3IgaGlnaGVyLiBVc2UgbW9kdWxlbmFtZSB3aGVuIGludm9raW5nLgogICAgICAgICRQYXJhbXMgPSBAeyJNb2R1bGVuYW1lIj0kcmVzb3VyY2UuTW9kdWxlbmFtZX0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkUGFyYW1zID0gQHt9CiAgICB9CgogICAgJFRlc3RSZXN1bHQgPSBJbnZva2UtRHNjUmVzb3VyY2UgQENvbmZpZyAtTWV0aG9kIFRlc3QgQHBhcmFtcyAtRXJyb3JWYXJpYWJsZSBUZXN0RXJyb3IgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgIGlmICgkVGVzdEVycm9yKQogICAgewogICAgICAgdGhyb3cgKCRUZXN0RXJyb3JbMF0uRXhjZXB0aW9uLk1lc3NhZ2UpCiAgICB9CiAgICBFbHNlSWYgKCgkdGVzdFJlc3VsdC5JbkRlc2lyZWRTdGF0ZSkgLW5lICR0cnVlKSAKICAgIHsKICAgICAgICBJbnZva2UtRHNjUmVzb3VyY2UgLU1ldGhvZCBTZXQgQENvbmZpZyAgQHBhcmFtcyAtRXJyb3JWYXJpYWJsZSBTZXRFcnJvciAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgIFNldC1BdHRyICRyZXN1bHQgImNoYW5nZWQiICR0cnVlCiAgICAgICAgaWYgKCRTZXRFcnJvcikKICAgICAgICB7CiAgICAgICAgICAgdGhyb3cgKCRTZXRFcnJvclswXS5FeGNlcHRpb24uTWVzc2FnZSkKICAgICAgICB9CiAgICB9Cgp9CkNhdGNoCnsKICAgIEZhaWwtSnNvbiAtb2JqICRyZXN1bHQgLW1lc3NhZ2UgJF9bMF0uRXhjZXB0aW9uLk1lc3NhZ2UKfQoKCiNzZXQtYXR0ciAtb2JqICRyZXN1bHQgLW5hbWUgInByb3BlcnR5IiAtdmFsdWUgJHByb3BlcnR5CkV4aXQtSnNvbiAtb2JqICRyZXN1bHQKCgoKCg==
