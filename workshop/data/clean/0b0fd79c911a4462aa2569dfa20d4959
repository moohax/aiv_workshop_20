MSFT_xADOrganizationalUnit.psm1,d5fecac3fc63376158d5296d02c360dd,Scan result is 1. IsMalware: 0,IyBMb2NhbGl6ZWQgbWVzc2FnZXMKZGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIEAnCiAgICAgICAgUm9sZU5vdEZvdW5kRXJyb3IgICAgICAgID0gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSBQb3dlclNoZWxsIG1vZHVsZSBmb3Igcm9sZSAnezB9JyBpcyBpbnN0YWxsZWQKICAgICAgICBSZXRyaWV2aW5nT1UgICAgICAgICAgICAgPSBSZXRyaWV2aW5nIE9VICd7MH0nLgogICAgICAgIFVwZGF0aW5nT1UgICAgICAgICAgICAgICA9IFVwZGF0aW5nIE9VICd7MH0nCiAgICAgICAgRGVsZXRpbmdPVSAgICAgICAgICAgICAgID0gRGVsZXRpbmcgT1UgJ3swfScKICAgICAgICBDcmVhdGluZ09VICAgICAgICAgICAgICAgPSBDcmVhdGluZyBPVSAnezB9JwogICAgICAgIE9VSW5EZXNpcmVkU3RhdGUgICAgICAgICA9IE9VICd7MH0nIGV4aXN0cyBhbmQgaXMgaW4gdGhlIGRlc2lyZWQgc3RhdGUKICAgICAgICBPVU5vdEluRGVzaXJlZFN0YXRlICAgICAgPSBPVSAnezB9JyBleGlzdHMgYnV0IGlzIG5vdCBpbiB0aGUgZGVzaXJlZCBzdGF0ZQogICAgICAgIE9VRXhpc3RzQnV0U2hvdWxkTm90ICAgICA9IE9VICd7MH0nIGV4aXN0cyB3aGVuIGl0IHNob3VsZCBub3QgZXhpc3QKICAgICAgICBPVURvZXNOb3RFeGlzdEJ1dFNob3VsZCAgPSBPVSAnezB9JyBkb2VzIG5vdCBleGlzdCB3aGVuIGl0IHNob3VsZCBleGlzdAonQAp9CgpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlXSldCiAgICBwYXJhbQogICAgKCAgICAKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkpXSAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFBhdGgKICAgICkKICAgIAogICAgQXNzZXJ0LU1vZHVsZSAtTW9kdWxlTmFtZSAnQWN0aXZlRGlyZWN0b3J5JzsKICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLlJldHJpZXZpbmdPVSAtZiAkTmFtZSkKICAgICRvdSA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtRmlsdGVyIHsgTmFtZSAtZXEgJE5hbWUgfSAtU2VhcmNoQmFzZSAkUGF0aCAtU2VhcmNoU2NvcGUgT25lTGV2ZWwgLVByb3BlcnRpZXMgUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbiwgRGVzY3JpcHRpb24KCiAgICAkdGFyZ2V0UmVzb3VyY2UgPSBAewogICAgICAgIE5hbWUgPSAkTmFtZQogICAgICAgIFBhdGggPSAkUGF0aAogICAgICAgIEVuc3VyZSA9IGlmICgkbnVsbCAtZXEgJG91KSB7ICdBYnNlbnQnIH0gZWxzZSB7ICdQcmVzZW50JyB9CiAgICAgICAgUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbiA9ICRvdS5Qcm90ZWN0ZWRGcm9tQWNjaWRlbnRhbERlbGV0aW9uCiAgICAgICAgRGVzY3JpcHRpb24gPSAkb3UuRGVzY3JpcHRpb24KICAgIH0KICAgIHJldHVybiAkdGFyZ2V0UmVzb3VyY2UKCn0gIyBlbmQgZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoICAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0gCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICROYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkUGF0aCwKICAgICAgICAKICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCAnQWJzZW50JyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEVuc3VyZSA9ICdQcmVzZW50JywKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbCgpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5DcmVkZW50aWFsQXR0cmlidXRlKCldCiAgICAgICAgJENyZWRlbnRpYWwsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbU3lzdGVtLkJvb2xlYW5dICRQcm90ZWN0ZWRGcm9tQWNjaWRlbnRhbERlbGV0aW9uID0gJHRydWUsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10gJERlc2NyaXB0aW9uID0gJycKICAgICkKCiAgICAkdGFyZ2V0UmVzb3VyY2UgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgLU5hbWUgJE5hbWUgLVBhdGggJFBhdGgKICAgIAogICAgaWYgKCR0YXJnZXRSZXNvdXJjZS5FbnN1cmUgLWVxICdQcmVzZW50JykKICAgIHsKICAgICAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgICAgIHsKICAgICAgICAgICAgIyMgT3JnYW5pemF0aW9uYWwgdW5pdCBleGlzdHMKICAgICAgICAgICAgaWYgKFtTeXN0ZW0uU3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkRGVzY3JpcHRpb24pKSB7CiAgICAgICAgICAgICAgICAkaXNDb21wbGlhbnQgPSAoKCR0YXJnZXRSZXNvdXJjZS5OYW1lIC1lcSAkTmFtZSkgLWFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJHRhcmdldFJlc291cmNlLlBhdGggLWVxICRQYXRoKSAtYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJHRhcmdldFJlc291cmNlLlByb3RlY3RlZEZyb21BY2NpZGVudGFsRGVsZXRpb24gLWVxICRQcm90ZWN0ZWRGcm9tQWNjaWRlbnRhbERlbGV0aW9uKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRpc0NvbXBsaWFudCA9ICgoJHRhcmdldFJlc291cmNlLk5hbWUgLWVxICROYW1lKSAtYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgkdGFyZ2V0UmVzb3VyY2UuUGF0aCAtZXEgJFBhdGgpIC1hbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgkdGFyZ2V0UmVzb3VyY2UuUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbiAtZXEgJFByb3RlY3RlZEZyb21BY2NpZGVudGFsRGVsZXRpb24pIC1hbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJHRhcmdldFJlc291cmNlLkRlc2NyaXB0aW9uIC1lcSAkRGVzY3JpcHRpb24pKQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJGlzQ29tcGxpYW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5PVUluRGVzaXJlZFN0YXRlIC1mICR0YXJnZXRSZXNvdXJjZS5OYW1lKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuT1VOb3RJbkRlc2lyZWRTdGF0ZSAtZiAkdGFyZ2V0UmVzb3VyY2UuTmFtZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkaXNDb21wbGlhbnQgPSAkZmFsc2UKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuT1VFeGlzdHNCdXRTaG91bGROb3QgLWYgJHRhcmdldFJlc291cmNlLk5hbWUpCiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICMjIE9yZ2FuaXphdGlvbmFsIHVuaXQgZG9lcyBub3QgZXhpc3QKICAgICAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgICAgIHsKICAgICAgICAgICAgJGlzQ29tcGxpYW50ID0gJGZhbHNlCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLk9VRG9lc05vdEV4aXN0QnV0U2hvdWxkIC1mICR0YXJnZXRSZXNvdXJjZS5OYW1lKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAkaXNDb21wbGlhbnQgPSAkdHJ1ZQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5PVUluRGVzaXJlZFN0YXRlIC1mICR0YXJnZXRSZXNvdXJjZS5OYW1lKQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJGlzQ29tcGxpYW50Cgp9ICNlbmQgZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKCAgICAKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXSAkTmFtZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkpXSAKICAgICAgICBbU3lzdGVtLlN0cmluZ10gJFBhdGgsCiAgICAgICAgCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdQcmVzZW50JywgJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGwoKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uQ3JlZGVudGlhbEF0dHJpYnV0ZSgpXQogICAgICAgICRDcmVkZW50aWFsLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5Cb29sZWFuXSAkUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbiA9ICR0cnVlLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsKCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICREZXNjcmlwdGlvbiA9ICcnCiAgICApCgogICAgQXNzZXJ0LU1vZHVsZSAtTW9kdWxlTmFtZSAnQWN0aXZlRGlyZWN0b3J5JzsKICAgICR0YXJnZXRSZXNvdXJjZSA9IEdldC1UYXJnZXRSZXNvdXJjZSAtTmFtZSAkTmFtZSAtUGF0aCAkUGF0aAogICAgCiAgICBpZiAoJHRhcmdldFJlc291cmNlLkVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgewogICAgICAgICRvdSA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtRmlsdGVyIHsgTmFtZSAtZXEgJE5hbWUgfSAtU2VhcmNoQmFzZSAkUGF0aCAtU2VhcmNoU2NvcGUgT25lTGV2ZWwKICAgICAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuVXBkYXRpbmdPVSAtZiAkdGFyZ2V0UmVzb3VyY2UuTmFtZSkKICAgICAgICAgICAgJHNldEFET3JnYW5pemF0aW9uYWxVbml0UGFyYW1zID0gQHsKICAgICAgICAgICAgICAgIElkZW50aXR5ID0gJG91CiAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbiA9ICREZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbiA9ICRQcm90ZWN0ZWRGcm9tQWNjaWRlbnRhbERlbGV0aW9uCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRDcmVkZW50aWFsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkc2V0QURPcmdhbml6YXRpb25hbFVuaXRQYXJhbXNbJ0NyZWRlbnRpYWwnXSA9ICRDcmVkZW50aWFsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgU2V0LUFET3JnYW5pemF0aW9uYWxVbml0IEBzZXRBRE9yZ2FuaXphdGlvbmFsVW5pdFBhcmFtcwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5EZWxldGluZ09VIC1mICR0YXJnZXRSZXNvdXJjZS5OYW1lKQogICAgICAgICAgICBpZiAoJHRhcmdldFJlc291cmNlLlByb3RlY3RlZEZyb21BY2NpZGVudGFsRGVsZXRpb24pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRzZXRBRE9yZ2FuaXphdGlvbmFsVW5pdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICAgICAgSWRlbnRpdHkgPSAkb3UKICAgICAgICAgICAgICAgICAgICBQcm90ZWN0ZWRGcm9tQWNjaWRlbnRhbERlbGV0aW9uID0gJFByb3RlY3RlZEZyb21BY2NpZGVudGFsRGVsZXRpb24KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgkQ3JlZGVudGlhbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkc2V0QURPcmdhbml6YXRpb25hbFVuaXRQYXJhbXNbJ0NyZWRlbnRpYWwnXSA9ICRDcmVkZW50aWFsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTZXQtQURPcmdhbml6YXRpb25hbFVuaXQgQHNldEFET3JnYW5pemF0aW9uYWxVbml0UGFyYW1zCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRyZW1vdmVBRE9yZ2FuaXphdGlvbmFsVW5pdFBhcmFtcyA9IEB7CiAgICAgICAgICAgICAgICBJZGVudGl0eSA9ICRvdQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkQ3JlZGVudGlhbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJHJlbW92ZUFET3JnYW5pemF0aW9uYWxVbml0UGFyYW1zWydDcmVkZW50aWFsJ10gPSAkQ3JlZGVudGlhbAogICAgICAgICAgICB9CiAgICAgICAgICAgIFJlbW92ZS1BRE9yZ2FuaXphdGlvbmFsVW5pdCBAcmVtb3ZlQURPcmdhbml6YXRpb25hbFVuaXRQYXJhbXMKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuQ3JlYXRpbmdPVSAtZiAkdGFyZ2V0UmVzb3VyY2UuTmFtZSkKICAgICAgICAkbmV3QURPcmdhbml6YXRpb25hbFVuaXRQYXJhbXMgPSBAewogICAgICAgICAgICBOYW1lID0gJE5hbWUKICAgICAgICAgICAgUGF0aCA9ICRQYXRoCiAgICAgICAgICAgIERlc2NyaXB0aW9uID0gJERlc2NyaXB0aW9uCiAgICAgICAgICAgIFByb3RlY3RlZEZyb21BY2NpZGVudGFsRGVsZXRpb24gPSAkUHJvdGVjdGVkRnJvbUFjY2lkZW50YWxEZWxldGlvbgogICAgICAgIH0KICAgICAgICBpZiAoJENyZWRlbnRpYWwpIHsKICAgICAgICAgICAgJG5ld0FET3JnYW5pemF0aW9uYWxVbml0UGFyYW1zWydDcmVkZW50aWFsJ10gPSAkQ3JlZGVudGlhbAogICAgICAgIH0KICAgICAgICBOZXctQURPcmdhbml6YXRpb25hbFVuaXQgQG5ld0FET3JnYW5pemF0aW9uYWxVbml0UGFyYW1zCiAgICB9Cgp9ICNlbmQgZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCgojIyBJbXBvcnQgdGhlIGNvbW1vbiBBRCBmdW5jdGlvbnMKJGFkQ29tbW9uRnVuY3Rpb25zID0gSm9pbi1QYXRoIC1QYXRoIChTcGxpdC1QYXRoIC1QYXRoICRQU1NjcmlwdFJvb3QgLVBhcmVudCkgLUNoaWxkUGF0aCAnXE1TRlRfeEFEQ29tbW9uXE1TRlRfeEFEQ29tbW9uLnBzMSc7Ci4gJGFkQ29tbW9uRnVuY3Rpb25zOwoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKi1UYXJnZXRSZXNvdXJjZQo=
