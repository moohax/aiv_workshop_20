FindFunctions.ps1,4a37d6b9c8ec2db72ffd030243997255,Scan result is 1. IsMalware: 0,PCMKLlNZTk9QU0lTCkZpbmRzIGZpbGVzIHVzaW5nIG1hdGNoIHBhdHRlcm5zLgoKLkRFU0NSSVBUSU9OCkRldGVybWluZXMgdGhlIGZpbmQgcm9vdCBmcm9tIGEgbGlzdCBvZiBwYXR0ZXJucy4gUGVyZm9ybXMgdGhlIGZpbmQgYW5kIHRoZW4gYXBwbGllcyB0aGUgZ2xvYiBwYXR0ZXJucy4gU3VwcG9ydHMgaW50ZXJsZWF2ZWQgZXhjbHVkZSBwYXR0ZXJucy4gVW5yb290ZWQgcGF0dGVybnMgYXJlIHJvb3RlZCB1c2luZyBkZWZhdWx0Um9vdCwgdW5sZXNzIG1hdGNoT3B0aW9ucy5tYXRjaEJhc2UgaXMgc3BlY2lmaWVkIGFuZCB0aGUgcGF0dGVybiBpcyBhIGJhc2VuYW1lIG9ubHkuIEZvciBtYXRjaEJhc2UgY2FzZXMsIHRoZSBkZWZhdWx0Um9vdCBpcyB1c2VkIGFzIHRoZSBmaW5kIHJvb3QuCgouUEFSQU1FVEVSIERlZmF1bHRSb290CkRlZmF1bHQgcGF0aCB0byByb290IHVucm9vdGVkIHBhdHRlcm5zLiBGYWxscyBiYWNrIHRvIFN5c3RlbS5EZWZhdWx0V29ya2luZ0RpcmVjdG9yeSBvciBjdXJyZW50IGxvY2F0aW9uLgoKLlBBUkFNRVRFUiBQYXR0ZXJuClBhdHRlcm5zIHRvIGFwcGx5LiBTdXBwb3J0cyBpbnRlcmxlYXZlZCBleGNsdWRlIHBhdHRlcm5zLgoKLlBBUkFNRVRFUiBGaW5kT3B0aW9ucwpXaGVuIHRoZSBGaW5kT3B0aW9ucyBwYXJhbWV0ZXIgaXMgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gKE5ldy1Wc3RzRmluZE9wdGlvbnMgLUZvbGxvd1N5bWJvbGljTGlua3NUcnVlKS4gRm9sbG93aW5nIHNvZnQgbGlua3MgaXMgZ2VuZXJhbGx5IGFwcHJvcHJpYXRlIHVubGVzcyBkZWxldGluZyBmaWxlcy4KCi5QQVJBTUVURVIgTWF0Y2hPcHRpb25zCldoZW4gdGhlIE1hdGNoT3B0aW9ucyBwYXJhbWV0ZXIgaXMgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gKE5ldy1Wc3RzTWF0Y2hPcHRpb25zIC1Eb3QgLU5vQnJhY2UgLU5vQ2FzZSkuCiM+CmZ1bmN0aW9uIEZpbmQtTWF0Y2ggewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbc3RyaW5nXSREZWZhdWx0Um9vdCwKICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgW3N0cmluZ1tdXSRQYXR0ZXJuLAogICAgICAgICRGaW5kT3B0aW9ucywKICAgICAgICAkTWF0Y2hPcHRpb25zKQoKICAgIFRyYWNlLUVudGVyaW5nSW52b2NhdGlvbiAkTXlJbnZvY2F0aW9uIC1QYXJhbWV0ZXIgTm9uZQogICAgJG9yaWdpbmFsRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgdHJ5IHsKICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCgogICAgICAgICMgQXBwbHkgZGVmYXVsdHMgZm9yIHBhcmFtZXRlcnMgYW5kIHRyYWNlLgogICAgICAgIGlmICghJERlZmF1bHRSb290KSB7CiAgICAgICAgICAgICREZWZhdWx0Um9vdCA9IEdldC1UYXNrVmFyaWFibGUgLU5hbWUgJ1N5c3RlbS5EZWZhdWx0V29ya2luZ0RpcmVjdG9yeScgLURlZmF1bHQgKEdldC1Mb2NhdGlvbikuUGF0aAogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRGVmYXVsdFJvb3Q6ICckRGVmYXVsdFJvb3QnIgogICAgICAgIGlmICghJEZpbmRPcHRpb25zKSB7CiAgICAgICAgICAgICRGaW5kT3B0aW9ucyA9IE5ldy1GaW5kT3B0aW9ucyAtRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rIC1Gb2xsb3dTeW1ib2xpY0xpbmtzCiAgICAgICAgfQoKICAgICAgICBUcmFjZS1GaW5kT3B0aW9ucyAtT3B0aW9ucyAkRmluZE9wdGlvbnMKICAgICAgICBpZiAoISRNYXRjaE9wdGlvbnMpIHsKICAgICAgICAgICAgJE1hdGNoT3B0aW9ucyA9IE5ldy1NYXRjaE9wdGlvbnMgLURvdCAtTm9CcmFjZSAtTm9DYXNlCiAgICAgICAgfQoKICAgICAgICBUcmFjZS1NYXRjaE9wdGlvbnMgLU9wdGlvbnMgJE1hdGNoT3B0aW9ucwogICAgICAgIEFkZC1UeXBlIC1MaXRlcmFsUGF0aCAkUFNTY3JpcHRSb290XE1pbmltYXRjaC5kbGwKCiAgICAgICAgIyBOb3JtYWxpemUgc2xhc2hlcyBmb3Igcm9vdCBkaXIuCiAgICAgICAgJERlZmF1bHRSb290ID0gQ29udmVydFRvLU5vcm1hbGl6ZWRTZXBhcmF0b3JzIC1QYXRoICREZWZhdWx0Um9vdAoKICAgICAgICAkcmVzdWx0cyA9IEB7IH0KICAgICAgICAkb3JpZ2luYWxNYXRjaE9wdGlvbnMgPSAkTWF0Y2hPcHRpb25zCiAgICAgICAgZm9yZWFjaCAoJHBhdCBpbiAkUGF0dGVybikgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJQYXR0ZXJuOiAnJHBhdCciCgogICAgICAgICAgICAjIFRyaW0gYW5kIHNraXAgZW1wdHkuCiAgICAgICAgICAgICRwYXQgPSAiJHBhdCIuVHJpbSgpCiAgICAgICAgICAgIGlmICghJHBhdCkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnU2tpcHBpbmcgZW1wdHkgcGF0dGVybi4nCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIENsb25lIG1hdGNoIG9wdGlvbnMuCiAgICAgICAgICAgICRNYXRjaE9wdGlvbnMgPSBDb3B5LU1hdGNoT3B0aW9ucyAtT3B0aW9ucyAkb3JpZ2luYWxNYXRjaE9wdGlvbnMKCiAgICAgICAgICAgICMgU2tpcCBjb21tZW50cy4KICAgICAgICAgICAgaWYgKCEkTWF0Y2hPcHRpb25zLk5vQ29tbWVudCAtYW5kICRwYXQuU3RhcnRzV2l0aCgnIycpKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdTa2lwcGluZyBjb21tZW50LicKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgU2V0IE5vQ29tbWVudC4gQnJhY2UgZXhwYW5zaW9uIGNvdWxkIHJlc3VsdCBpbiBhIGxlYWRpbmcgJyMnLgogICAgICAgICAgICAkTWF0Y2hPcHRpb25zLk5vQ29tbWVudCA9ICR0cnVlCgogICAgICAgICAgICAjIERldGVybWluZSB3aGV0aGVyIHBhdHRlcm4gaXMgaW5jbHVkZSBvciBleGNsdWRlLgogICAgICAgICAgICAkbmVnYXRlQ291bnQgPSAwCiAgICAgICAgICAgIGlmICghJE1hdGNoT3B0aW9ucy5Ob05lZ2F0ZSkgewogICAgICAgICAgICAgICAgd2hpbGUgKCRuZWdhdGVDb3VudCAtbHQgJHBhdC5MZW5ndGggLWFuZCAkcGF0WyRuZWdhdGVDb3VudF0gLWVxICchJykgewogICAgICAgICAgICAgICAgICAgICRuZWdhdGVDb3VudCsrCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJHBhdCA9ICRwYXQuU3Vic3RyaW5nKCRuZWdhdGVDb3VudCkgIyB0cmltIGxlYWRpbmcgJyEnCiAgICAgICAgICAgICAgICBpZiAoJG5lZ2F0ZUNvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVHJpbW1lZCBsZWFkaW5nICchJy4gUGF0dGVybjogJyRwYXQnIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkaXNJbmNsdWRlUGF0dGVybiA9ICRuZWdhdGVDb3VudCAtZXEgMCAtb3IKICAgICAgICAgICAgICAgICgkbmVnYXRlQ291bnQgJSAyIC1lcSAwIC1hbmQgISRNYXRjaE9wdGlvbnMuRmxpcE5lZ2F0ZSkgLW9yCiAgICAgICAgICAgICAgICAoJG5lZ2F0ZUNvdW50ICUgMiAtZXEgMSAtYW5kICRNYXRjaE9wdGlvbnMuRmxpcE5lZ2F0ZSkKCiAgICAgICAgICAgICMgU2V0IE5vTmVnYXRlLiBCcmFjZSBleHBhbnNpb24gY291bGQgcmVzdWx0IGluIGEgbGVhZGluZyAnIScuCiAgICAgICAgICAgICRNYXRjaE9wdGlvbnMuTm9OZWdhdGUgPSAkdHJ1ZQogICAgICAgICAgICAkTWF0Y2hPcHRpb25zLkZsaXBOZWdhdGUgPSAkZmFsc2UKCiAgICAgICAgICAgICMgVHJpbSBhbmQgc2tpcCBlbXB0eS4KICAgICAgICAgICAgJHBhdCA9ICIkcGF0Ii5UcmltKCkKICAgICAgICAgICAgaWYgKCEkcGF0KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdTa2lwcGluZyBlbXB0eSBwYXR0ZXJuLicKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgRXhwYW5kIGJyYWNlcyAtIHJlcXVpcmVkIHRvIGFjY3VyYXRlbHkgaW50ZXJwcmV0IGZpbmRQYXRoLgogICAgICAgICAgICAkZXhwYW5kZWQgPSAkbnVsbAogICAgICAgICAgICAkcHJlRXhwYW5kZWQgPSAkcGF0CiAgICAgICAgICAgIGlmICgkTWF0Y2hPcHRpb25zLk5vQnJhY2UpIHsKICAgICAgICAgICAgICAgICRleHBhbmRlZCA9IEAoICRwYXQgKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgIyBDb252ZXJ0IHNsYXNoZXMgb24gV2luZG93cyBiZWZvcmUgY2FsbGluZyBicmFjZUV4cGFuZCgpLiBVbmZvcnR1bmF0ZWx5IHRoaXMgbWVhbnMgYnJhY2VzIGNhbm5vdAogICAgICAgICAgICAgICAgIyBiZSBlc2NhcGVkIG9uIFdpbmRvd3MsIHRoaXMgbGltaXRhdGlvbiBpcyBjb25zaXN0ZW50IHdpdGggY3VycmVudCBsaW1pdGF0aW9ucyBvZiBtaW5pbWF0Y2ggKDMuMC4zKS4KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4cGFuZGluZyBicmFjZXMuIgogICAgICAgICAgICAgICAgJGNvbnZlcnRlZFBhdHRlcm4gPSAkcGF0IC1yZXBsYWNlICdcXCcsICcvJwogICAgICAgICAgICAgICAgJGV4cGFuZGVkID0gW01pbmltYXRjaC5NaW5pbWF0Y2hlcl06OkJyYWNlRXhwYW5kKAogICAgICAgICAgICAgICAgICAgICRjb252ZXJ0ZWRQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIChDb252ZXJ0VG8tTWluaW1hdGNoT3B0aW9ucyAtT3B0aW9ucyAkTWF0Y2hPcHRpb25zKSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBTZXQgTm9CcmFjZS4KICAgICAgICAgICAgJE1hdGNoT3B0aW9ucy5Ob0JyYWNlID0gJHRydWUKCiAgICAgICAgICAgIGZvcmVhY2ggKCRwYXQgaW4gJGV4cGFuZGVkKSB7CiAgICAgICAgICAgICAgICBpZiAoJHBhdCAtbmUgJHByZUV4cGFuZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUGF0dGVybjogJyRwYXQnIgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICMgVHJpbSBhbmQgc2tpcCBlbXB0eS4KICAgICAgICAgICAgICAgICRwYXQgPSAiJHBhdCIuVHJpbSgpCiAgICAgICAgICAgICAgICBpZiAoISRwYXQpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTa2lwcGluZyBlbXB0eSBwYXR0ZXJuLiIKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgkaXNJbmNsdWRlUGF0dGVybikgewogICAgICAgICAgICAgICAgICAgICMgRGV0ZXJtaW5lIHRoZSBmaW5kUGF0aC4KICAgICAgICAgICAgICAgICAgICAkZmluZEluZm8gPSBHZXQtRmluZEluZm9Gcm9tUGF0dGVybiAtRGVmYXVsdFJvb3QgJERlZmF1bHRSb290IC1QYXR0ZXJuICRwYXQgLU1hdGNoT3B0aW9ucyAkTWF0Y2hPcHRpb25zCiAgICAgICAgICAgICAgICAgICAgJGZpbmRQYXRoID0gJGZpbmRJbmZvLkZpbmRQYXRoCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmluZFBhdGg6ICckZmluZFBhdGgnIgoKICAgICAgICAgICAgICAgICAgICBpZiAoISRmaW5kUGF0aCkgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTa2lwcGluZyBlbXB0eSBwYXRoLiIKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICMgUGVyZm9ybSB0aGUgZmluZC4KICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTdGF0T25seTogJyQoJGZpbmRJbmZvLlN0YXRPbmx5KSciCiAgICAgICAgICAgICAgICAgICAgW3N0cmluZ1tdXSRmaW5kUmVzdWx0cyA9IEAoICkKICAgICAgICAgICAgICAgICAgICBpZiAoJGZpbmRJbmZvLlN0YXRPbmx5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICMgU2ltcGx5IHN0YXQgdGhlIHBhdGggLSBhbGwgcGF0aCBzZWdtZW50cyB3ZXJlIHVzZWQgdG8gYnVpbGQgdGhlIHBhdGguCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAkZmluZFBhdGgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZmluZFJlc3VsdHMgKz0gJGZpbmRQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkZmluZFJlc3VsdHMgPSBHZXQtRmluZFJlc3VsdCAtUGF0aCAkZmluZFBhdGggLU9wdGlvbnMgJEZpbmRPcHRpb25zCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGb3VuZCAkKCRmaW5kUmVzdWx0cy5Db3VudCkgcGF0aHMuIgoKICAgICAgICAgICAgICAgICAgICAjIEFwcGx5IHRoZSBwYXR0ZXJuLgogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkFwcGx5aW5nIGluY2x1ZGUgcGF0dGVybi4iCiAgICAgICAgICAgICAgICAgICAgaWYgKCRmaW5kSW5mby5BZGp1c3RlZFBhdHRlcm4gLW5lICRwYXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWRqdXN0ZWRQYXR0ZXJuOiAnJCgkZmluZEluZm8uQWRqdXN0ZWRQYXR0ZXJuKSciCiAgICAgICAgICAgICAgICAgICAgICAgICRwYXQgPSAkZmluZEluZm8uQWRqdXN0ZWRQYXR0ZXJuCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkbWF0Y2hSZXN1bHRzID0gW01pbmltYXRjaC5NaW5pbWF0Y2hlcl06OkZpbHRlcigKICAgICAgICAgICAgICAgICAgICAgICAgJGZpbmRSZXN1bHRzLAogICAgICAgICAgICAgICAgICAgICAgICAkcGF0LAogICAgICAgICAgICAgICAgICAgICAgICAoQ29udmVydFRvLU1pbmltYXRjaE9wdGlvbnMgLU9wdGlvbnMgJE1hdGNoT3B0aW9ucykpCgogICAgICAgICAgICAgICAgICAgICMgVW5pb24gdGhlIHJlc3VsdHMuCiAgICAgICAgICAgICAgICAgICAgJG1hdGNoQ291bnQgPSAwCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJG1hdGNoUmVzdWx0IGluICRtYXRjaFJlc3VsdHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJG1hdGNoQ291bnQrKwogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0c1skbWF0Y2hSZXN1bHQuVG9VcHBlckludmFyaWFudCgpXSA9ICRtYXRjaFJlc3VsdAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiJG1hdGNoQ291bnQgbWF0Y2hlcyIKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgIyBDaGVjayBpZiBiYXNlbmFtZSBvbmx5IGFuZCBNYXRjaEJhc2U9dHJ1ZS4KICAgICAgICAgICAgICAgICAgICBpZiAoJE1hdGNoT3B0aW9ucy5NYXRjaEJhc2UgLWFuZAogICAgICAgICAgICAgICAgICAgICAgICAhKFRlc3QtUm9vdGVkIC1QYXRoICRwYXQpIC1hbmQKICAgICAgICAgICAgICAgICAgICAgICAgKCRwYXQgLXJlcGxhY2UgJ1xcJywgJy8nKS5JbmRleE9mKCcvJykgLWx0IDApIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICMgRG8gbm90IHJvb3QgdGhlIHBhdHRlcm4uCiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoQmFzZSBhbmQgYmFzZW5hbWUgb25seS4iCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyBSb290IHRoZSBleGNsdWRlIHBhdHRlcm4uCiAgICAgICAgICAgICAgICAgICAgICAgICRwYXQgPSBHZXQtUm9vdGVkUGF0dGVybiAtRGVmYXVsdFJvb3QgJERlZmF1bHRSb290IC1QYXR0ZXJuICRwYXQKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWZ0ZXIgR2V0LVJvb3RlZFBhdHRlcm4sIHBhdHRlcm46ICckcGF0JyIKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICMgQXBwbHkgdGhlIHBhdHRlcm4uCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAnQXBwbHlpbmcgZXhjbHVkZSBwYXR0ZXJuLicKICAgICAgICAgICAgICAgICAgICAkbWF0Y2hSZXN1bHRzID0gW01pbmltYXRjaC5NaW5pbWF0Y2hlcl06OkZpbHRlcigKICAgICAgICAgICAgICAgICAgICAgICAgW3N0cmluZ1tdXSRyZXN1bHRzLlZhbHVlcywKICAgICAgICAgICAgICAgICAgICAgICAgJHBhdCwKICAgICAgICAgICAgICAgICAgICAgICAgKENvbnZlcnRUby1NaW5pbWF0Y2hPcHRpb25zIC1PcHRpb25zICRNYXRjaE9wdGlvbnMpKQoKICAgICAgICAgICAgICAgICAgICAjIFN1YnRyYWN0IHRoZSByZXN1bHRzLgogICAgICAgICAgICAgICAgICAgICRtYXRjaENvdW50ID0gMAogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRtYXRjaFJlc3VsdCBpbiAkbWF0Y2hSZXN1bHRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRtYXRjaENvdW50KysKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdHMuUmVtb3ZlKCRtYXRjaFJlc3VsdC5Ub1VwcGVySW52YXJpYW50KCkpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICIkbWF0Y2hDb3VudCBtYXRjaGVzIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkZmluYWxSZXN1bHQgPSBAKCAkcmVzdWx0cy5WYWx1ZXMgfCBTb3J0LU9iamVjdCApCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiJCgkZmluYWxSZXN1bHQuQ291bnQpIGZpbmFsIHJlc3VsdHMiCiAgICAgICAgcmV0dXJuICRmaW5hbFJlc3VsdAogICAgfSBjYXRjaCB7CiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICRvcmlnaW5hbEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgICAgIFdyaXRlLUVycm9yICRfCiAgICB9IGZpbmFsbHkgewogICAgICAgIFRyYWNlLUxlYXZpbmdJbnZvY2F0aW9uIC1JbnZvY2F0aW9uSW5mbyAkTXlJbnZvY2F0aW9uCiAgICB9Cn0KCjwjCi5TWU5PUFNJUwpDcmVhdGVzIEZpbmRPcHRpb25zIGZvciB1c2Ugd2l0aCBGaW5kLVZzdHNNYXRjaC4KCi5ERVNDUklQVElPTgpDcmVhdGVzIEZpbmRPcHRpb25zIGZvciB1c2Ugd2l0aCBGaW5kLVZzdHNNYXRjaC4gQ29udGFpbnMgc3dpdGNoZXMgdG8gY29udHJvbCB3aGV0aGVyIHRvIGZvbGxvdyBzeW1saW5rcy4KCi5QQVJBTUVURVIgRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rCkluZGljYXRlcyB3aGV0aGVyIHRvIHRyYXZlcnNlIGRlc2NlbmRhbnRzIGlmIHRoZSBzcGVjaWZpZWQgcGF0aCBpcyBhIHN5bWJvbGljIGxpbmsgZGlyZWN0b3J5LiBEb2VzIG5vdCBjYXVzZSBuZXN0ZWQgc3ltYm9saWMgbGluayBkaXJlY3RvcmllcyB0byBiZSB0cmF2ZXJzZWQuCgouUEFSQU1FVEVSIEZvbGxvd1N5bWJvbGljTGlua3MKSW5kaWNhdGVzIHdoZXRoZXIgdG8gdHJhdmVyc2UgZGVzY2VuZGFudHMgb2Ygc3ltYm9saWMgbGluayBkaXJlY3Rvcmllcy4KIz4KZnVuY3Rpb24gTmV3LUZpbmRPcHRpb25zIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbc3dpdGNoXSRGb2xsb3dTcGVjaWZpZWRTeW1ib2xpY0xpbmssCiAgICAgICAgW3N3aXRjaF0kRm9sbG93U3ltYm9saWNMaW5rcykKCiAgICByZXR1cm4gTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgQHsKICAgICAgICBGb2xsb3dTcGVjaWZpZWRTeW1ib2xpY0xpbmsgPSAkRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rLklzUHJlc2VudAogICAgICAgIEZvbGxvd1N5bWJvbGljTGlua3MgPSAkRm9sbG93U3ltYm9saWNMaW5rcy5Jc1ByZXNlbnQKICAgIH0KfQoKPCMKLlNZTk9QU0lTCkNyZWF0ZXMgTWF0Y2hPcHRpb25zIGZvciB1c2Ugd2l0aCBGaW5kLVZzdHNNYXRjaCBhbmQgU2VsZWN0LVZzdHNNYXRjaC4KCi5ERVNDUklQVElPTgpDcmVhdGVzIE1hdGNoT3B0aW9ucyBmb3IgdXNlIHdpdGggRmluZC1Wc3RzTWF0Y2ggYW5kIFNlbGVjdC1Wc3RzTWF0Y2guIENvbnRhaW5zIHN3aXRjaGVzIHRvIGNvbnRyb2wgd2hpY2ggcGF0dGVybiBtYXRjaGluZyBvcHRpb25zIGFyZSBhcHBsaWVkLgojPgpmdW5jdGlvbiBOZXctTWF0Y2hPcHRpb25zIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbc3dpdGNoXSREb3QsCiAgICAgICAgW3N3aXRjaF0kRmxpcE5lZ2F0ZSwKICAgICAgICBbc3dpdGNoXSRNYXRjaEJhc2UsCiAgICAgICAgW3N3aXRjaF0kTm9CcmFjZSwKICAgICAgICBbc3dpdGNoXSROb0Nhc2UsCiAgICAgICAgW3N3aXRjaF0kTm9Db21tZW50LAogICAgICAgIFtzd2l0Y2hdJE5vRXh0LAogICAgICAgIFtzd2l0Y2hdJE5vR2xvYlN0YXIsCiAgICAgICAgW3N3aXRjaF0kTm9OZWdhdGUsCiAgICAgICAgW3N3aXRjaF0kTm9OdWxsKQoKICAgIHJldHVybiBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgIERvdCA9ICREb3QuSXNQcmVzZW50CiAgICAgICAgRmxpcE5lZ2F0ZSA9ICRGbGlwTmVnYXRlLklzUHJlc2VudAogICAgICAgIE1hdGNoQmFzZSA9ICRNYXRjaEJhc2UuSXNQcmVzZW50CiAgICAgICAgTm9CcmFjZSA9ICROb0JyYWNlLklzUHJlc2VudAogICAgICAgIE5vQ2FzZSA9ICROb0Nhc2UuSXNQcmVzZW50CiAgICAgICAgTm9Db21tZW50ID0gJE5vQ29tbWVudC5Jc1ByZXNlbnQKICAgICAgICBOb0V4dCA9ICROb0V4dC5Jc1ByZXNlbnQKICAgICAgICBOb0dsb2JTdGFyID0gJE5vR2xvYlN0YXIuSXNQcmVzZW50CiAgICAgICAgTm9OZWdhdGUgPSAkTm9OZWdhdGUuSXNQcmVzZW50CiAgICAgICAgTm9OdWxsID0gJE5vTnVsbC5Jc1ByZXNlbnQKICAgIH0KfQoKPCMKLlNZTk9QU0lTCkFwcGxpZXMgbWF0Y2ggcGF0dGVybnMgYWdhaW5zdCBhIGxpc3Qgb2YgZmlsZXMuCgouREVTQ1JJUFRJT04KQXBwbGllcyBtYXRjaCBwYXR0ZXJucyB0byBhIGxpc3Qgb2YgcGF0aHMuIFN1cHBvcnRzIGludGVybGVhdmVkIGV4Y2x1ZGUgcGF0dGVybnMuCgouUEFSQU1FVEVSIEl0ZW1QYXRoCkFycmF5IG9mIHBhdGhzLgoKLlBBUkFNRVRFUiBQYXR0ZXJuClBhdHRlcm5zIHRvIGFwcGx5LiBTdXBwb3J0cyBpbnRlcmxlYXZlZCBleGNsdWRlIHBhdHRlcm5zLgoKLlBBUkFNRVRFUiBPcHRpb25zCldoZW4gdGhlIE9wdGlvbnMgcGFyYW1ldGVyIGlzIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIChOZXctVnN0c01hdGNoT3B0aW9ucyAtRG90IC1Ob0JyYWNlIC1Ob0Nhc2UpLgojPgpmdW5jdGlvbiBTZWxlY3QtTWF0Y2ggewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbc3RyaW5nW11dJEl0ZW1QYXRoLAogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbc3RyaW5nW11dJFBhdHRlcm4sCiAgICAgICAgJE9wdGlvbnMpCgoKICAgIFRyYWNlLUVudGVyaW5nSW52b2NhdGlvbiAkTXlJbnZvY2F0aW9uIC1QYXJhbWV0ZXIgTm9uZQogICAgJG9yaWdpbmFsRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgdHJ5IHsKICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCiAgICAgICAgaWYgKCEkT3B0aW9ucykgewogICAgICAgICAgICAkT3B0aW9ucyA9IE5ldy1NYXRjaE9wdGlvbnMgLURvdCAtTm9CcmFjZSAtTm9DYXNlCiAgICAgICAgfQoKICAgICAgICBUcmFjZS1NYXRjaE9wdGlvbnMgLU9wdGlvbnMgJE9wdGlvbnMKICAgICAgICBBZGQtVHlwZSAtTGl0ZXJhbFBhdGggJFBTU2NyaXB0Um9vdFxNaW5pbWF0Y2guZGxsCgogICAgICAgICMgSGFzaHRhYmxlIHRvIGtlZXAgdHJhY2sgb2YgbWF0Y2hlcy4KICAgICAgICAkbWFwID0gQHsgfQoKICAgICAgICAkb3JpZ2luYWxPcHRpb25zID0gJE9wdGlvbnMKICAgICAgICBmb3JlYWNoICgkcGF0IGluICRQYXR0ZXJuKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlBhdHRlcm46ICckcGF0JyIKCiAgICAgICAgICAgICMgVHJpbSBhbmQgc2tpcCBlbXB0eS4KICAgICAgICAgICAgJHBhdCA9ICIkcGF0Ii5UcmltKCkKICAgICAgICAgICAgaWYgKCEkcGF0KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdTa2lwcGluZyBlbXB0eSBwYXR0ZXJuLicKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgQ2xvbmUgbWF0Y2ggb3B0aW9ucy4KICAgICAgICAgICAgJE9wdGlvbnMgPSBDb3B5LU1hdGNoT3B0aW9ucyAtT3B0aW9ucyAkb3JpZ2luYWxPcHRpb25zCgogICAgICAgICAgICAjIFNraXAgY29tbWVudHMuCiAgICAgICAgICAgIGlmICghJE9wdGlvbnMuTm9Db21tZW50IC1hbmQgJHBhdC5TdGFydHNXaXRoKCcjJykpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ1NraXBwaW5nIGNvbW1lbnQuJwogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBTZXQgTm9Db21tZW50LgogICAgICAgICAgICAkT3B0aW9ucy5Ob0NvbW1lbnQgPSAkdHJ1ZQoKICAgICAgICAgICAgIyBEZXRlcm1pbmUgd2hldGhlciBwYXR0ZXJuIGlzIGluY2x1ZGUgb3IgZXhjbHVkZS4KICAgICAgICAgICAgJG5lZ2F0ZUNvdW50ID0gMAogICAgICAgICAgICBpZiAoISRPcHRpb25zLk5vTmVnYXRlKSB7CiAgICAgICAgICAgICAgICB3aGlsZSAoJG5lZ2F0ZUNvdW50IC1sdCAkcGF0Lkxlbmd0aCAtYW5kICRwYXRbJG5lZ2F0ZUNvdW50XSAtZXEgJyEnKSB7CiAgICAgICAgICAgICAgICAgICAgJG5lZ2F0ZUNvdW50KysKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkcGF0ID0gJHBhdC5TdWJzdHJpbmcoJG5lZ2F0ZUNvdW50KSAjIHRyaW0gbGVhZGluZyAnIScKICAgICAgICAgICAgICAgIGlmICgkbmVnYXRlQ291bnQpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJUcmltbWVkIGxlYWRpbmcgJyEnLiBQYXR0ZXJuOiAnJHBhdCciCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRpc0luY2x1ZGVQYXR0ZXJuID0gJG5lZ2F0ZUNvdW50IC1lcSAwIC1vcgogICAgICAgICAgICAgICAgKCRuZWdhdGVDb3VudCAlIDIgLWVxIDAgLWFuZCAhJE9wdGlvbnMuRmxpcE5lZ2F0ZSkgLW9yCiAgICAgICAgICAgICAgICAoJG5lZ2F0ZUNvdW50ICUgMiAtZXEgMSAtYW5kICRPcHRpb25zLkZsaXBOZWdhdGUpCgogICAgICAgICAgICAjIFNldCBOb05lZ2F0ZS4gQnJhY2UgZXhwYW5zaW9uIGNvdWxkIHJlc3VsdCBpbiBhIGxlYWRpbmcgJyEnLgogICAgICAgICAgICAkT3B0aW9ucy5Ob05lZ2F0ZSA9ICR0cnVlCiAgICAgICAgICAgICRPcHRpb25zLkZsaXBOZWdhdGUgPSAkZmFsc2UKCiAgICAgICAgICAgICMgVHJpbSBhbmQgc2tpcCBlbXB0eS4KICAgICAgICAgICAgJHBhdCA9ICIkcGF0Ii5UcmltKCkKICAgICAgICAgICAgaWYgKCEkcGF0KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdTa2lwcGluZyBlbXB0eSBwYXR0ZXJuLicKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkaXNJbmNsdWRlUGF0dGVybikgewogICAgICAgICAgICAgICAgIyBBcHBseSB0aGUgcGF0dGVybi4KICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgJ0FwcGx5aW5nIGluY2x1ZGUgcGF0dGVybiBhZ2FpbnN0IG9yaWdpbmFsIGxpc3QnCiAgICAgICAgICAgICAgICAkbWF0Y2hSZXN1bHRzID0gW01pbmltYXRjaC5NaW5pbWF0Y2hlcl06OkZpbHRlcigKICAgICAgICAgICAgICAgICAgICAkSXRlbVBhdGgsCiAgICAgICAgICAgICAgICAgICAgJHBhdCwKICAgICAgICAgICAgICAgICAgICAoQ29udmVydFRvLU1pbmltYXRjaE9wdGlvbnMgLU9wdGlvbnMgJE9wdGlvbnMpKQoKICAgICAgICAgICAgICAgICMgVW5pb24gdGhlIHJlc3VsdHMuCiAgICAgICAgICAgICAgICAkbWF0Y2hDb3VudCA9IDAKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRtYXRjaFJlc3VsdCBpbiAkbWF0Y2hSZXN1bHRzKSB7CiAgICAgICAgICAgICAgICAgICAgJG1hdGNoQ291bnQrKwogICAgICAgICAgICAgICAgICAgICRtYXBbJG1hdGNoUmVzdWx0XSA9ICR0cnVlCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiJG1hdGNoQ291bnQgbWF0Y2hlcyIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICMgQXBwbHkgdGhlIHBhdHRlcm4uCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICdBcHBseWluZyBleGNsdWRlIHBhdHRlcm4gYWdhaW5zdCBvcmlnaW5hbCBsaXN0JwogICAgICAgICAgICAgICAgJG1hdGNoUmVzdWx0cyA9IFtNaW5pbWF0Y2guTWluaW1hdGNoZXJdOjpGaWx0ZXIoCiAgICAgICAgICAgICAgICAgICAgJEl0ZW1QYXRoLAogICAgICAgICAgICAgICAgICAgICRwYXQsCiAgICAgICAgICAgICAgICAgICAgKENvbnZlcnRUby1NaW5pbWF0Y2hPcHRpb25zIC1PcHRpb25zICRPcHRpb25zKSkKCiAgICAgICAgICAgICAgICAjIFN1YnRyYWN0IHRoZSByZXN1bHRzLgogICAgICAgICAgICAgICAgJG1hdGNoQ291bnQgPSAwCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkbWF0Y2hSZXN1bHQgaW4gJG1hdGNoUmVzdWx0cykgewogICAgICAgICAgICAgICAgICAgICRtYXRjaENvdW50KysKICAgICAgICAgICAgICAgICAgICAkbWFwLlJlbW92ZSgkbWF0Y2hSZXN1bHQpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiJG1hdGNoQ291bnQgbWF0Y2hlcyIKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyByZXR1cm4gYSBmaWx0ZXJlZCB2ZXJzaW9uIG9mIHRoZSBvcmlnaW5hbCBsaXN0IChwcmVzZXJ2ZXMgb3JkZXIgYW5kIHByZXZlbnRzIGR1cGxpY2F0aW9uKQogICAgICAgICRyZXN1bHQgPSAkSXRlbVBhdGggfCBXaGVyZS1PYmplY3QgeyAkbWFwWyRfXSB9CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiJCgkcmVzdWx0LkNvdW50KSBmaW5hbCByZXN1bHRzIgogICAgICAgICRyZXN1bHQKICAgIH0gY2F0Y2ggewogICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAkb3JpZ2luYWxFcnJvckFjdGlvblByZWZlcmVuY2UKICAgICAgICBXcml0ZS1FcnJvciAkXwogICAgfSBmaW5hbGx5IHsKICAgICAgICBUcmFjZS1MZWF2aW5nSW52b2NhdGlvbiAtSW52b2NhdGlvbkluZm8gJE15SW52b2NhdGlvbgogICAgfQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFByaXZhdGUgZnVuY3Rpb25zLgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZnVuY3Rpb24gQ29weS1NYXRjaE9wdGlvbnMgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKCRPcHRpb25zKQoKICAgIHJldHVybiBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgIERvdCA9ICRPcHRpb25zLkRvdCAtZXEgJHRydWUKICAgICAgICBGbGlwTmVnYXRlID0gJE9wdGlvbnMuRmxpcE5lZ2F0ZSAtZXEgJHRydWUKICAgICAgICBNYXRjaEJhc2UgPSAkT3B0aW9ucy5NYXRjaEJhc2UgLWVxICR0cnVlCiAgICAgICAgTm9CcmFjZSA9ICRPcHRpb25zLk5vQnJhY2UgLWVxICR0cnVlCiAgICAgICAgTm9DYXNlID0gJE9wdGlvbnMuTm9DYXNlIC1lcSAkdHJ1ZQogICAgICAgIE5vQ29tbWVudCA9ICRPcHRpb25zLk5vQ29tbWVudCAtZXEgJHRydWUKICAgICAgICBOb0V4dCA9ICRPcHRpb25zLk5vRXh0IC1lcSAkdHJ1ZQogICAgICAgIE5vR2xvYlN0YXIgPSAkT3B0aW9ucy5Ob0dsb2JTdGFyIC1lcSAkdHJ1ZQogICAgICAgIE5vTmVnYXRlID0gJE9wdGlvbnMuTm9OZWdhdGUgLWVxICR0cnVlCiAgICAgICAgTm9OdWxsID0gJE9wdGlvbnMuTm9OdWxsIC1lcSAkdHJ1ZQogICAgfQp9CgpmdW5jdGlvbiBDb252ZXJ0VG8tTWluaW1hdGNoT3B0aW9ucyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oJE9wdGlvbnMpCgogICAgJG9wdCA9IE5ldy1PYmplY3QgTWluaW1hdGNoLk9wdGlvbnMKICAgICRvcHQuQWxsb3dXaW5kb3dzUGF0aHMgPSAkdHJ1ZQogICAgJG9wdC5Eb3QgPSAkT3B0aW9ucy5Eb3QgLWVxICR0cnVlCiAgICAkb3B0LkZsaXBOZWdhdGUgPSAkT3B0aW9ucy5GbGlwTmVnYXRlIC1lcSAkdHJ1ZQogICAgJG9wdC5NYXRjaEJhc2UgPSAkT3B0aW9ucy5NYXRjaEJhc2UgLWVxICR0cnVlCiAgICAkb3B0Lk5vQnJhY2UgPSAkT3B0aW9ucy5Ob0JyYWNlIC1lcSAkdHJ1ZQogICAgJG9wdC5Ob0Nhc2UgPSAkT3B0aW9ucy5Ob0Nhc2UgLWVxICR0cnVlCiAgICAkb3B0Lk5vQ29tbWVudCA9ICRPcHRpb25zLk5vQ29tbWVudCAtZXEgJHRydWUKICAgICRvcHQuTm9FeHQgPSAkT3B0aW9ucy5Ob0V4dCAtZXEgJHRydWUKICAgICRvcHQuTm9HbG9iU3RhciA9ICRPcHRpb25zLk5vR2xvYlN0YXIgLWVxICR0cnVlCiAgICAkb3B0Lk5vTmVnYXRlID0gJE9wdGlvbnMuTm9OZWdhdGUgLWVxICR0cnVlCiAgICAkb3B0Lk5vTnVsbCA9ICRPcHRpb25zLk5vTnVsbCAtZXEgJHRydWUKICAgIHJldHVybiAkb3B0Cn0KCmZ1bmN0aW9uIENvbnZlcnRUby1Ob3JtYWxpemVkU2VwYXJhdG9ycyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oW3N0cmluZ10kUGF0aCkKCiAgICAjIENvbnZlcnQgc2xhc2hlcy4KICAgICRQYXRoID0gIiRQYXRoIi5SZXBsYWNlKCcvJywgJ1wnKQoKICAgICMgUmVtb3ZlIHJlZHVuZGFudCBzbGFzaGVzLgogICAgJGlzVW5jID0gJFBhdGggLW1hdGNoICdeXFxcXCtbXlxcXScKICAgICRQYXRoID0gJFBhdGggLXJlcGxhY2UgJ1xcXFwrJywgJ1wnCiAgICBpZiAoJGlzVW5jKSB7CiAgICAgICAgJFBhdGggPSAnXCcgKyAkUGF0aAogICAgfQoKICAgIHJldHVybiAkUGF0aAp9CgpmdW5jdGlvbiBHZXQtRmluZEluZm9Gcm9tUGF0dGVybiB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kRGVmYXVsdFJvb3QsCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW3N0cmluZ10kUGF0dGVybiwKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICAkTWF0Y2hPcHRpb25zKQoKICAgIGlmICghJE1hdGNoT3B0aW9ucy5Ob0JyYWNlKSB7CiAgICAgICAgdGhyb3cgIkdldC1GaW5kSW5mb0Zyb21QYXR0ZXJuIGV4cGVjdGVkIE1hdGNoT3B0aW9ucy5Ob0JyYWNlIHRvIGJlIHRydWUuIgogICAgfQoKICAgICMgRm9yIHRoZSBzYWtlIG9mIGRldGVybWluaW5nIHRoZSBmaW5kIHBhdGgsIHByZXRlbmQgTm9DYXNlPWZhbHNlLgogICAgJE1hdGNoT3B0aW9ucyA9IENvcHktTWF0Y2hPcHRpb25zIC1PcHRpb25zICRNYXRjaE9wdGlvbnMKICAgICRNYXRjaE9wdGlvbnMuTm9DYXNlID0gJGZhbHNlCgogICAgIyBDaGVjayBpZiBiYXNlbmFtZSBvbmx5IGFuZCBNYXRjaEJhc2U9dHJ1ZQogICAgaWYgKCRNYXRjaE9wdGlvbnMuTWF0Y2hCYXNlIC1hbmQKICAgICAgICAhKFRlc3QtUm9vdGVkIC1QYXRoICRQYXR0ZXJuKSAtYW5kCiAgICAgICAgKCRQYXR0ZXJuIC1yZXBsYWNlICdcXCcsICcvJykuSW5kZXhPZignLycpIC1sdCAwKSB7CgogICAgICAgIHJldHVybiBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgICAgICBBZGp1c3RlZFBhdHRlcm4gPSAkUGF0dGVybgogICAgICAgICAgICBGaW5kUGF0aCA9ICREZWZhdWx0Um9vdAogICAgICAgICAgICBTdGF0T25seSA9ICRmYWxzZQogICAgICAgIH0KICAgIH0KCiAgICAjIFRoZSB0ZWNobmlxdWUgYXBwbGllZCBieSB0aGlzIGZ1bmN0aW9uIGlzIHRvIHVzZSB0aGUgaW5mb3JtYXRpb24gb24gdGhlIE1pbmltYXRjaCBvYmplY3QgZGV0ZXJtaW5lCiAgICAjIHRoZSBmaW5kUGF0aC4gTWluaW1hdGNoIGJyZWFrcyB0aGUgcGF0dGVybiBpbnRvIHBhdGggc2VnbWVudHMsIGFuZCBleHBvc2VzIGluZm9ybWF0aW9uIGFib3V0IHdoaWNoCiAgICAjIHNlZ21lbnRzIGFyZSBsaXRlcmFsIHZzIHBhdHRlcm5zLgogICAgIwogICAgIyBOb3RlLCB0aGUgdGVjaG5pcXVlIGN1cnJlbnRseSBpbXBvc2VzIGEgbGltaXRhdGlvbiBmb3IgZHJpdmUtcmVsYXRpdmUgcGF0aHMgd2l0aCBhIGdsb2IgaW4gdGhlCiAgICAjIGZpcnN0IHNlZ21lbnQsIGUuZy4gQzpoZWxsbyovd29ybGQuIEl0J3MgZmVhc2libGUgdG8gb3ZlcmNvbWUgdGhpcyBsaW1pdGF0aW9uLCBidXQgaXMgbGVmdCB1bnNvbHZlZAogICAgIyBmb3Igbm93LgogICAgJG1pbmltYXRjaE9iaiA9IE5ldy1PYmplY3QgTWluaW1hdGNoLk1pbmltYXRjaGVyKCRQYXR0ZXJuLCAoQ29udmVydFRvLU1pbmltYXRjaE9wdGlvbnMgLU9wdGlvbnMgJE1hdGNoT3B0aW9ucykpCgogICAgIyBUaGUgInNldCIgZmllbGQgaXMgYSB0d28tZGltZW5zaW9uYWwgZW51bWVyYWJsZSBvZiBwYXJzZWQgcGF0aCBzZWdtZW50IGluZm8uIFRoZSBvdXRlciBlbnVtZXJhYmxlIHNob3VsZCBvbmx5CiAgICAjIGNvbnRhaW4gb25lIGl0ZW0sIG90aGVyd2lzZSBzb21ldGhpbmcgd2VudCB3cm9uZy4gQnJhY2UgZXhwYW5zaW9uIGNhbiByZXN1bHQgaW4gbXVsdGlwbGUgaXRlbXMgaW4gdGhlIG91dGVyCiAgICAjIGVudW1lcmFibGUsIGJ1dCB0aGF0IHNob3VsZCBiZSB0dXJuZWQgb2ZmIGJ5IHRoZSB0aW1lIHRoaXMgZnVuY3Rpb24gaXMgcmVhY2hlZC4KICAgICMKICAgICMgTm90ZSwgInNldCIgaXMgYSBwcml2YXRlIGZpZWxkIGluIHRoZSAuTkVUIGltcGxlbWVudGF0aW9uIGJ1dCBpcyBkb2N1bWVudGVkIGFzIGEgZmVhdHVyZSBpbiB0aGUgbm9kZWpzCiAgICAjIGltcGxlbWVudGF0aW9uLiBUaGUgLk5FVCBpbXBsZW1lbnRhdGlvbiBpcyBhIHBvcnQgYW5kIGlzIGJ5IGEgZGlmZmVyZW50IGF1dGhvci4KICAgICRzZXRGaWVsZEluZm8gPSAkbWluaW1hdGNoT2JqLkdldFR5cGUoKS5HZXRGaWVsZCgnc2V0JywgJ0luc3RhbmNlLE5vblB1YmxpYycpCiAgICBbb2JqZWN0W11dJHNldCA9ICRzZXRGaWVsZEluZm8uR2V0VmFsdWUoJG1pbmltYXRjaE9iaikKICAgIGlmICgkc2V0LkNvdW50IC1uZSAxKSB7CiAgICAgICAgdGhyb3cgIkdldC1GaW5kSW5mb0Zyb21QYXR0ZXJuIGV4cGVjdGVkIE1pbmltYXRjaC5NaW5pbWF0Y2hlciguLi4pLnNldC5Db3VudCB0byBiZSAxLiBBY3R1YWw6ICckKCRzZXQuQ291bnQpJyIKICAgIH0KCiAgICBbc3RyaW5nW11dJGxpdGVyYWxTZWdtZW50cyA9IEAoICkKICAgIFtvYmplY3RbXV0kcGFyc2VkU2VnbWVudHMgPSAkc2V0WzBdCiAgICBmb3JlYWNoICgkcGFyc2VkU2VnbWVudCBpbiAkcGFyc2VkU2VnbWVudHMpIHsKICAgICAgICBpZiAoJHBhcnNlZFNlZ21lbnQuR2V0VHlwZSgpLk5hbWUgLWVxICdMaXRlcmFsSXRlbScpIHsKICAgICAgICAgICAgIyBUaGUgaXRlbSBpcyBhIExpdGVyYWxJdGVtIHdoZW4gdGhlIG9yaWdpbmFsIGlucHV0IGZvciB0aGUgcGF0aCBzZWdtZW50IGRvZXMgbm90IGNvbnRhaW4gYW55CiAgICAgICAgICAgICMgdW5lc2NhcGVkIGdsb2IgY2hhcmFjdGVycy4KICAgICAgICAgICAgJGxpdGVyYWxTZWdtZW50cyArPSAkcGFyc2VkU2VnbWVudC5Tb3VyY2U7CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgIH0KCiAgICAjIEpvaW4gdGhlIGxpdGVyYWwgc2VnbWVudHMgYmFjayB0b2dldGhlci4gTWluaW1hdGNoIGNvbnZlcnRzICdcJyB0byAnLycgb24gV2luZG93cywgdGhlbiBzcXVhc2hlcwogICAgIyBjb25zZXF1ZXRpdmUgc2xhc2hlcywgYW5kIGZpbmFsbHkgc3BsaXRzIG9uIHNsYXNoLiBUaGlzIG1lYW5zIHRoYXQgVU5DIGZvcm1hdCBpcyBsb3N0LCBidXQgY2FuCiAgICAjIGJlIGRldGVjdGVkIGZyb20gdGhlIG9yaWdpbmFsIHBhdHRlcm4uCiAgICAkam9pbmVkU2VnbWVudHMgPSBbc3RyaW5nXTo6Sm9pbignLycsICRsaXRlcmFsU2VnbWVudHMpCiAgICBpZiAoJGpvaW5lZFNlZ21lbnRzIC1hbmQgKCRQYXR0ZXJuIC1yZXBsYWNlICdcXCcsICcvJykuU3RhcnRzV2l0aCgnLy8nKSkgewogICAgICAgICRqb2luZWRTZWdtZW50cyA9ICcvJyArICRqb2luZWRTZWdtZW50cyAjIHJlc3RvcmUgVU5DIGZvcm1hdAogICAgfQoKICAgICMgRGV0ZXJtaW5lIHRoZSBmaW5kIHBhdGguCiAgICAkZmluZFBhdGggPSAnJwogICAgaWYgKChUZXN0LVJvb3RlZCAtUGF0aCAkUGF0dGVybikpIHsgIyBUaGUgcGF0dGVybiBpcyByb290ZWQuCiAgICAgICAgJGZpbmRQYXRoID0gJGpvaW5lZFNlZ21lbnRzCiAgICB9IGVsc2VpZiAoJGpvaW5lZFNlZ21lbnRzKSB7ICMgVGhlIHBhdHRlcm4gaXMgbm90IHJvb3RlZCwgYW5kIGxpdGVyYWwgc2VnZW1lbnRzIHdlcmUgZm91bmQuCiAgICAgICAgJGZpbmRQYXRoID0gW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkRGVmYXVsdFJvb3QsICRqb2luZWRTZWdtZW50cykKICAgIH0gZWxzZSB7ICMgVGhlIHBhdHRlcm4gaXMgbm90IHJvb3RlZCwgYW5kIG5vIGxpdGVyYWwgc2VnZW1lbnRzIHdlcmUgZm91bmQuCiAgICAgICAgJGZpbmRQYXRoID0gJERlZmF1bHRSb290CiAgICB9CgogICAgIyBDbGVhbiB1cCB0aGUgcGF0aC4KICAgIGlmICgkZmluZFBhdGgpIHsKICAgICAgICAkZmluZFBhdGggPSBbU3lzdGVtLklPLlBhdGhdOjpHZXREaXJlY3RvcnlOYW1lKChbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRmaW5kUGF0aCwgJ18nKSkpICMgSGFjayB0byByZW1vdmUgdW5uZWNlc3NhcnkgdHJhaWxpbmcgc2xhc2guCiAgICAgICAgJGZpbmRQYXRoID0gQ29udmVydFRvLU5vcm1hbGl6ZWRTZXBhcmF0b3JzIC1QYXRoICRmaW5kUGF0aAogICAgfQoKICAgIHJldHVybiBOZXctT2JqZWN0IHBzb2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgIEFkanVzdGVkUGF0dGVybiA9IEdldC1Sb290ZWRQYXR0ZXJuIC1EZWZhdWx0Um9vdCAkRGVmYXVsdFJvb3QgLVBhdHRlcm4gJFBhdHRlcm4KICAgICAgICBGaW5kUGF0aCA9ICRmaW5kUGF0aAogICAgICAgIFN0YXRPbmx5ID0gJGxpdGVyYWxTZWdtZW50cy5Db3VudCAtZXEgJHBhcnNlZFNlZ21lbnRzLkNvdW50CiAgICB9Cn0KCmZ1bmN0aW9uIEdldC1GaW5kUmVzdWx0IHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbc3RyaW5nXSRQYXRoLAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgICRPcHRpb25zKQoKICAgIGlmICghKFRlc3QtUGF0aCAtTGl0ZXJhbFBhdGggJFBhdGgpKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAnUGF0aCBub3QgZm91bmQuJwogICAgICAgIHJldHVybgogICAgfQoKICAgICRQYXRoID0gQ29udmVydFRvLU5vcm1hbGl6ZWRTZXBhcmF0b3JzIC1QYXRoICRQYXRoCgogICAgIyBQdXNoIHRoZSBmaXJzdCBpdGVtLgogICAgW1N5c3RlbS5Db2xsZWN0aW9ucy5TdGFja10kc3RhY2sgPSBOZXctT2JqZWN0IFN5c3RlbS5Db2xsZWN0aW9ucy5TdGFjawogICAgJHN0YWNrLlB1c2goKEdldC1JdGVtIC1MaXRlcmFsUGF0aCAkUGF0aCkpCgogICAgJGNvdW50ID0gMAogICAgd2hpbGUgKCRzdGFjay5Db3VudCkgewogICAgICAgICMgUG9wIHRoZSBuZXh0IGl0ZW0gYW5kIHlpZWxkIHRoZSByZXN1bHQuCiAgICAgICAgJGl0ZW0gPSAkc3RhY2suUG9wKCkKICAgICAgICAkY291bnQrKwogICAgICAgICRpdGVtLkZ1bGxOYW1lCgogICAgICAgICMgVHJhdmVyc2UuCiAgICAgICAgaWYgKCgkaXRlbS5BdHRyaWJ1dGVzIC1iYW5kIDB4MDAwMDAwMTApIC1lcSAweDAwMDAwMDEwKSB7ICMgRGlyZWN0b3J5CiAgICAgICAgICAgIGlmICgoJGl0ZW0uQXR0cmlidXRlcyAtYmFuZCAweDAwMDAwNDAwKSAtbmUgMHgwMDAwMDQwMCAtb3IgIyBSZXBhcnNlUG9pbnQKICAgICAgICAgICAgICAgICRPcHRpb25zLkZvbGxvd1N5bWJvbGljTGlua3MgLW9yCiAgICAgICAgICAgICAgICAoJGNvdW50IC1lcSAxIC1hbmQgJE9wdGlvbnMuRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rKSkgewoKICAgICAgICAgICAgICAgICRjaGlsZEl0ZW1zID0gQCggR2V0LURpcmVjdG9yeUNoaWxkSXRlbSAtUGF0aCAkSXRlbS5GdWxsTmFtZSAtRm9yY2UgKQogICAgICAgICAgICAgICAgW1N5c3RlbS5BcnJheV06OlJldmVyc2UoJGNoaWxkSXRlbXMpCiAgICAgICAgICAgICAgICBmb3JlYWNoICgkY2hpbGRJdGVtIGluICRjaGlsZEl0ZW1zKSB7CiAgICAgICAgICAgICAgICAgICAgJHN0YWNrLlB1c2goJGNoaWxkSXRlbSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gR2V0LVJvb3RlZFBhdHRlcm4gewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJERlZmF1bHRSb290LAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJFBhdHRlcm4pCgogICAgaWYgKChUZXN0LVJvb3RlZCAtUGF0aCAkUGF0dGVybikpIHsKICAgICAgICByZXR1cm4gJFBhdHRlcm4KICAgIH0KCiAgICAjIE5vcm1hbGl6ZSByb290LgogICAgJERlZmF1bHRSb290ID0gQ29udmVydFRvLU5vcm1hbGl6ZWRTZXBhcmF0b3JzIC1QYXRoICREZWZhdWx0Um9vdAoKICAgICMgRXNjYXBlIHNwZWNpYWwgZ2xvYiBjaGFyYWN0ZXJzLgogICAgJERlZmF1bHRSb290ID0gJERlZmF1bHRSb290IC1yZXBsYWNlICcoXFspKD89W15cL10rXF0pJywgJ1tbXScgIyBFc2NhcGUgJ1snIHdoZW4gJ10nIGZvbGxvd3Mgd2l0aGluIHRoZSBwYXRoIHNlZ21lbnQKICAgICREZWZhdWx0Um9vdCA9ICREZWZhdWx0Um9vdC5SZXBsYWNlKCc/JywgJ1s/XScpICAgICAjIEVzY2FwZSAnPycKICAgICREZWZhdWx0Um9vdCA9ICREZWZhdWx0Um9vdC5SZXBsYWNlKCcqJywgJ1sqXScpICAgICAjIEVzY2FwZSAnKicKICAgICREZWZhdWx0Um9vdCA9ICREZWZhdWx0Um9vdCAtcmVwbGFjZSAnXCtcKCcsICdbK10oJyAjIEVzY2FwZSAnKygnCiAgICAkRGVmYXVsdFJvb3QgPSAkRGVmYXVsdFJvb3QgLXJlcGxhY2UgJ0BcKCcsICdbQF0oJyAgIyBFc2NhcGUgJ0AoJwogICAgJERlZmF1bHRSb290ID0gJERlZmF1bHRSb290IC1yZXBsYWNlICchXCgnLCAnWyFdKCcgICMgRXNjYXBlICchKCcKCiAgICBpZiAoJERlZmF1bHRSb290IC1saWtlICdbQS1aXTonKSB7ICMgZS5nLiBDOgogICAgICAgIHJldHVybiAiJERlZmF1bHRSb290JFBhdHRlcm4iCiAgICB9CgogICAgIyBFbnN1cmUgcm9vdCBlbmRzIHdpdGggYSBzZXBhcmF0b3IuCiAgICBpZiAoISREZWZhdWx0Um9vdC5FbmRzV2l0aCgnXCcpKSB7CiAgICAgICAgJERlZmF1bHRSb290ID0gIiREZWZhdWx0Um9vdFwiCiAgICB9CgogICAgcmV0dXJuICIkRGVmYXVsdFJvb3QkUGF0dGVybiIKfQoKZnVuY3Rpb24gVGVzdC1Sb290ZWQgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJFBhdGgpCgogICAgJFBhdGggPSBDb252ZXJ0VG8tTm9ybWFsaXplZFNlcGFyYXRvcnMgLVBhdGggJFBhdGgKICAgIHJldHVybiAkUGF0aC5TdGFydHNXaXRoKCdcJykgLW9yICMgZS5nLiBcIG9yIFxoZWxsbyBvciBcXGhlbGxvCiAgICAgICAgJFBhdGggLWxpa2UgJ1tBLVpdOionICAgICAgICAjIGUuZy4gQzogb3IgQzpcaGVsbG8KfQoKZnVuY3Rpb24gVHJhY2UtTWF0Y2hPcHRpb25zIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgkT3B0aW9ucykKCiAgICBXcml0ZS1WZXJib3NlICJNYXRjaE9wdGlvbnMuRG90OiAnJCgkT3B0aW9ucy5Eb3QpJyIKICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoT3B0aW9ucy5GbGlwTmVnYXRlOiAnJCgkT3B0aW9ucy5GbGlwTmVnYXRlKSciCiAgICBXcml0ZS1WZXJib3NlICJNYXRjaE9wdGlvbnMuTWF0Y2hCYXNlOiAnJCgkT3B0aW9ucy5NYXRjaEJhc2UpJyIKICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoT3B0aW9ucy5Ob0JyYWNlOiAnJCgkT3B0aW9ucy5Ob0JyYWNlKSciCiAgICBXcml0ZS1WZXJib3NlICJNYXRjaE9wdGlvbnMuTm9DYXNlOiAnJCgkT3B0aW9ucy5Ob0Nhc2UpJyIKICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoT3B0aW9ucy5Ob0NvbW1lbnQ6ICckKCRPcHRpb25zLk5vQ29tbWVudCknIgogICAgV3JpdGUtVmVyYm9zZSAiTWF0Y2hPcHRpb25zLk5vRXh0OiAnJCgkT3B0aW9ucy5Ob0V4dCknIgogICAgV3JpdGUtVmVyYm9zZSAiTWF0Y2hPcHRpb25zLk5vR2xvYlN0YXI6ICckKCRPcHRpb25zLk5vR2xvYlN0YXIpJyIKICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoT3B0aW9ucy5Ob05lZ2F0ZTogJyQoJE9wdGlvbnMuTm9OZWdhdGUpJyIKICAgIFdyaXRlLVZlcmJvc2UgIk1hdGNoT3B0aW9ucy5Ob051bGw6ICckKCRPcHRpb25zLk5vTnVsbCknIgp9CgpmdW5jdGlvbiBUcmFjZS1GaW5kT3B0aW9ucyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oJE9wdGlvbnMpCgogICAgV3JpdGUtVmVyYm9zZSAiRmluZE9wdGlvbnMuRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rOiAnJCgkRmluZE9wdGlvbnMuRm9sbG93U3BlY2lmaWVkU3ltYm9saWNMaW5rKSciCiAgICBXcml0ZS1WZXJib3NlICJGaW5kT3B0aW9ucy5Gb2xsb3dTeW1ib2xpY0xpbmtzOiAnJCgkRmluZE9wdGlvbnMuRm9sbG93U3ltYm9saWNMaW5rcyknIgp9Cg==
