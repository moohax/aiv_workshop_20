MSFT_xDFSNamespaceFolder.psm1,51b4415b5ab66916ffba6c95f2552b87,Scan result is 1. IsMalware: 0,ZGF0YSBMb2NhbGl6ZWREYXRhCnsKIyBjdWx0dXJlPSJlbi1VUyIKQ29udmVydEZyb20tU3RyaW5nRGF0YSAtU3RyaW5nRGF0YSBAJwpHZXR0aW5nTmFtZXNwYWNlRm9sZGVyTWVzc2FnZT1HZXR0aW5nIERGUyBOYW1lc3BhY2UgRm9sZGVyICJ7MH0iIFRhcmdldCAiezF9Ii4KTmFtZXNwYWNlRm9sZGVyRXhpc3RzTWVzc2FnZT1ERlMgTmFtZXNwYWNlIEZvbGRlciAiezB9IiBleGlzdHMuCk5hbWVzcGFjZUZvbGRlckRvZXNOb3RFeGlzdE1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgZG9lcyBub3QgZXhpc3QuCk5hbWVzcGFjZUZvbGRlclRhcmdldEV4aXN0c01lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgdGFyZ2V0ICJ7MX0iIGV4aXN0cy4KTmFtZXNwYWNlRm9sZGVyVGFyZ2V0RG9lc05vdEV4aXN0TWVzc2FnZT1ERlMgTmFtZXNwYWNlIEZvbGRlciAiezB9IiB0YXJnZXQgInsxfSIgZG9lcyBub3QgZXhpc3QuClNldHRpbmdOYW1lc3BhY2VGb2xkZXJNZXNzYWdlPVNldHRpbmcgREZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iLgpOYW1lc3BhY2VGb2xkZXJVcGRhdGVQYXJhbWV0ZXJNZXNzYWdlPVNldHRpbmcgREZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgcGFyYW1ldGVyIHsyfSB0byAiezN9Ii4KTmFtZXNwYWNlRm9sZGVyVGFyZ2V0VXBkYXRlUGFyYW1ldGVyTWVzc2FnZT1TZXR0aW5nIERGUyBOYW1lc3BhY2UgRm9sZGVyICJ7MH0iIFRhcmdldCAiezF9IiBwYXJhbWV0ZXIgezJ9IHRvICJ7M30iLgpOYW1lc3BhY2VGb2xkZXJDcmVhdGVkTWVzc2FnZT1ERlMgTmFtZXNwYWNlIEZvbGRlciAiezB9IiBUYXJnZXQgInsxfSIgY3JlYXRlZC4KTmFtZXNwYWNlRm9sZGVyVGFyZ2V0UmVtb3ZlZE1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iIHJlbW92ZWQuClRlc3RpbmdOYW1lc3BhY2VGb2xkZXJNZXNzYWdlPVRlc3RpbmcgREZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iLgpOYW1lc3BhY2VGb2xkZXJQYXJhbWV0ZXJOZWVkc1VwZGF0ZU1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgezJ9IGlzIGRpZmZlcmVudC4gQ2hhbmdlIHJlcXVpcmVkLgpOYW1lc3BhY2VGb2xkZXJUYXJnZXRQYXJhbWV0ZXJOZWVkc1VwZGF0ZU1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iIHsyfSBpcyBkaWZmZXJlbnQuIENoYW5nZSByZXF1aXJlZC4KTmFtZXNwYWNlRm9sZGVyRG9lc05vdEV4aXN0QnV0U2hvdWxkTWVzc2FnZT1ERlMgTmFtZXNwYWNlIEZvbGRlciAiezB9IiBkb2VzIG5vdCBleGlzdCBidXQgc2hvdWxkLiBDaGFuZ2UgcmVxdWlyZWQuCk5hbWVzcGFjZUZvbGRlclRhcmdldEV4aXN0c0J1dFNob3VsZE5vdE1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iIGV4aXN0cyBidXQgc2hvdWxkIG5vdC4gQ2hhbmdlIHJlcXVpcmVkLgpOYW1lc3BhY2VGb2xkZXJUYXJnZXREb2VzTm90RXhpc3RCdXRTaG91bGRNZXNzYWdlPURGUyBOYW1lc3BhY2UgRm9sZGVyICJ7MH0iIFRhcmdldCAiezF9IiBkb2VzIG5vdCBleGlzdCBidXQgc2hvdWxkLiBDaGFuZ2UgcmVxdWlyZWQuCk5hbWVzcGFjZUZvbGRlckRvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgZG9lcyBub3QgZXhpc3QgYW5kIHNob3VsZCBub3QuIENoYW5nZSBub3QgcmVxdWlyZWQuCk5hbWVzcGFjZUZvbGRlclRhcmdldERvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2U9REZTIE5hbWVzcGFjZSBGb2xkZXIgInswfSIgVGFyZ2V0ICJ7MX0iIGRvZXMgbm90IGV4aXN0IGFuZCBzaG91bGQgbm90LiBDaGFuZ2Ugbm90IHJlcXVpcmVkLgonQAp9CgpmdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UgCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbSGFzaHRhYmxlXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEVuc3VyZQogICAgKSAgICAgICAKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuR2V0dGluZ05hbWVzcGFjZUZvbGRlck1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoCiAgICAgICAgKSAtam9pbiAnJyApCgogICAgIyBHZW5lcmF0ZSB0aGUgcmV0dXJuIG9iamVjdCBhc3N1bWluZyBhYnNlbnQuCiAgICAkUmV0dXJuVmFsdWUgPSBAewogICAgICAgIFBhdGggPSAkUGF0aAogICAgICAgIFRhcmdldFBhdGggPSAkVGFyZ2V0UGF0aAogICAgICAgIEVuc3VyZSA9ICdBYnNlbnQnCiAgICB9CiAgICAKICAgICMgUmVtb3ZlIHRoZSBFbnN1ZSBwYXJtZXRlciBmcm9tIHRoZSBib3VuZCBwYXJhbWV0ZXJzCiAgICAkbnVsbCA9ICRQU0JvdW5kUGFyYW1ldGVycy5SZW1vdmUoJ0Vuc3VyZScpCiAgICAgICAgCiAgICAjIExvb2t1cCB0aGUgZXhpc3RpbmcgTmFtZXNwYWNlIEZvbGRlciAgICAKICAgICRGb2xkZXIgPSBHZXQtRm9sZGVyIGAKICAgICAgICAtUGF0aCAkUGF0aAogICAgCiAgICBpZiAoJEZvbGRlcikKICAgIHsKICAgICAgICAjIFRoZSBuYW1lc3BhY2UgZm9sZGVyIGV4aXN0cwogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlckV4aXN0c01lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aAogICAgICAgICAgICApIC1qb2luICcnICkKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAjIFRoZSBuYW1lc3BhY2UgZm9sZGVyIGRvZXMgbm90IGV4aXN0CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuTmFtZXNwYWNlRm9sZGVyRG9lc05vdEV4aXN0TWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoIAogICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICByZXR1cm4gJFJldHVyblZhbHVlCiAgICB9CgogICAgJFJldHVyblZhbHVlICs9IEB7CiAgICAgICAgVGltZVRvTGl2ZVNlYyAgICAgICAgICAgICAgICA9ICRGb2xkZXIuVGltZVRvTGl2ZVNlYwogICAgICAgIFN0YXRlICAgICAgICAgICAgICAgICAgICAgICAgPSAkRm9sZGVyLlN0YXRlCiAgICAgICAgRGVzY3JpcHRpb24gICAgICAgICAgICAgICAgICA9ICRGb2xkZXIuRGVzY3JpcHRpb24KICAgICAgICBFbmFibGVJbnNpdGVSZWZlcnJhbHMgICAgICAgID0gKCRGb2xkZXIuRmxhZ3MgLWNvbnRhaW5zICdJbnNpdGUgUmVmZXJyYWxzJykKICAgICAgICBFbmFibGVUYXJnZXRGYWlsYmFjayAgICAgICAgID0gKCRGb2xkZXIuRmxhZ3MgLWNvbnRhaW5zICdUYXJnZXQgRmFpbGJhY2snKQogICAgfQogICAgCiAgICAjIERGUyBGb2xkZXIgZXhpc3RzIGJ1dCBkb2VzIHRhcmdldCBleGlzdD8gICAgICAgICAgICAgICAKICAgICRUYXJnZXQgPSBHZXQtRm9sZGVyVGFyZ2V0IGAKICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgLVRhcmdldFBhdGggJFRhcmdldFBhdGgKCiAgICBpZiAoJFRhcmdldCkKICAgIHsKICAgICAgICAjIFRoZSB0YXJnZXQgZXhpc3RzIGluIHRoaXMgbmFtZXNwYWNlCiAgICAgICAgJFJldHVyblZhbHVlLkVuc3VyZSA9ICdQcmVzZW50JwogICAgICAgICRSZXR1cm5WYWx1ZSArPSBAewogICAgICAgICAgICBSZWZlcnJhbFByaW9yaXR5Q2xhc3MgICAgICAgID0gJFRhcmdldC5SZWZlcnJhbFByaW9yaXR5Q2xhc3MKICAgICAgICAgICAgUmVmZXJyYWxQcmlvcml0eVJhbmsgICAgICAgICA9ICRUYXJnZXQuUmVmZXJyYWxQcmlvcml0eVJhbmsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuTmFtZXNwYWNlRm9sZGVyVGFyZ2V0RXhpc3RzTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoCiAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgfQogICAgZWxzZQogICAgeyAgICAgICAgICAgICAgIAogICAgICAgICMgVGhlIHRhcmdldCBkb2VzIG5vdCBleGlzdCBpbiB0aGlzIG5hbWVzcGFjZQogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclRhcmdldERvZXNOb3RFeGlzdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aAogICAgICAgICAgICApIC1qb2luICcnICkKICAgIH0gICAgCiAgICAKICAgIHJldHVybiAkUmV0dXJuVmFsdWUKfSAjIEdldC1UYXJnZXRSZXNvdXJjZQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEVuc3VyZSwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICREZXNjcmlwdGlvbiwKICAgICAgICAKICAgICAgICBbVWludDMyXQogICAgICAgICRUaW1lVG9MaXZlU2VjLAoKICAgICAgICBbQm9vbGVhbl0KICAgICAgICAkRW5hYmxlSW5zaXRlUmVmZXJyYWxzLAogICAgICAgICAgIAogICAgICAgIFtCb29sZWFuXQogICAgICAgICRFbmFibGVUYXJnZXRGYWlsYmFjaywKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdHbG9iYWwtSGlnaCcsJ1NpdGVDb3N0LUhpZ2gnLCdTaXRlQ29zdC1Ob3JtYWwnLCdTaXRlQ29zdC1Mb3cnLCdHbG9iYWwtTG93JyldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUmVmZXJyYWxQcmlvcml0eUNsYXNzLAogICAgICAgIAogICAgICAgIFtVaW50MzJdCiAgICAgICAgJFJlZmVycmFsUHJpb3JpdHlSYW5rICAgICAgICAKICAgICkKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuU2V0dGluZ05hbWVzcGFjZUZvbGRlck1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoCiAgICAgICAgKSAtam9pbiAnJyApCgogICAgIyBMb29rdXAgdGhlIGV4aXN0aW5nIE5hbWVzcGFjZSBGb2xkZXIgICAgCiAgICAkRm9sZGVyID0gR2V0LUZvbGRlciBgCiAgICAgICAgLVBhdGggJFBhdGgKCiAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgewogICAgICAgICMgU2V0IGRlc2lyZWQgQ29uZmlndXJhdGlvbgogICAgICAgIGlmICgkRm9sZGVyKQogICAgICAgIHsKICAgICAgICAgICAgIyBEb2VzIHRoZSBGb2xkZXIgbmVlZCB0byBiZSB1cGRhdGVkPwogICAgICAgICAgICBbYm9vbGVhbl0gJEZvbGRlckNoYW5nZSA9ICRmYWxzZQogICAgICAgICAgICAKICAgICAgICAgICAgIyBUaGUgRm9sZGVyIHByb3BlcnRpZXMgdGhhdCB3aWxsIGJlIHVwZGF0ZWQKICAgICAgICAgICAgJEZvbGRlclByb3BlcnRpZXMgPSBAewogICAgICAgICAgICAgICAgU3RhdGUgPSAnb25saW5lJwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCREZXNjcmlwdGlvbikgYAogICAgICAgICAgICAgICAgLWFuZCAoJEZvbGRlci5EZXNjcmlwdGlvbiAtbmUgJERlc2NyaXB0aW9uKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJEZvbGRlclByb3BlcnRpZXMgKz0gQHsKICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbiA9ICREZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJEZvbGRlckNoYW5nZSA9ICR0cnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJFRpbWVUb0xpdmVTZWMpIGAKICAgICAgICAgICAgICAgIC1hbmQgKCRGb2xkZXIuVGltZVRvTGl2ZVNlYyAtbmUgJFRpbWVUb0xpdmVTZWMpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkRm9sZGVyUHJvcGVydGllcyArPSBAewogICAgICAgICAgICAgICAgICAgIFRpbWVUb0xpdmVTZWMgPSAkVGltZVRvTGl2ZVNlYwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJEZvbGRlckNoYW5nZSA9ICR0cnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJEVuYWJsZUluc2l0ZVJlZmVycmFscyAtbmUgJG51bGwpIGAKICAgICAgICAgICAgICAgIC1hbmQgKCgkRm9sZGVyLkZsYWdzIC1jb250YWlucyAnSW5zaXRlIFJlZmVycmFscycpIC1uZSAkRW5hYmxlSW5zaXRlUmVmZXJyYWxzKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJEZvbGRlclByb3BlcnRpZXMgKz0gQHsgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEVuYWJsZUluc2l0ZVJlZmVycmFscyA9ICRFbmFibGVJbnNpdGVSZWZlcnJhbHMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRGb2xkZXJDaGFuZ2UgPSAkdHJ1ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRFbmFibGVUYXJnZXRGYWlsYmFjayAtbmUgJG51bGwpIGAKICAgICAgICAgICAgICAgIC1hbmQgKCgkRm9sZGVyLkZsYWdzIC1jb250YWlucyAnVGFyZ2V0IEZhaWxiYWNrJykgLW5lICRFbmFibGVUYXJnZXRGYWlsYmFjaykpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRGb2xkZXJQcm9wZXJ0aWVzICs9IEB7ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBFbmFibGVUYXJnZXRGYWlsYmFjayA9ICRFbmFibGVUYXJnZXRGYWlsYmFjawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJEZvbGRlckNoYW5nZSA9ICR0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICgkRm9sZGVyQ2hhbmdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjIFVwZGF0ZSBGb2xkZXIgc2V0dGluZ3MKICAgICAgICAgICAgICAgICRudWxsID0gU2V0LURmc25Gb2xkZXIgYAogICAgICAgICAgICAgICAgICAgIC1QYXRoICRQYXRoIGAKICAgICAgICAgICAgICAgICAgICBARm9sZGVyUHJvcGVydGllcyBgCiAgICAgICAgICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgICAgICAgICAkRm9sZGVyUHJvcGVydGllcy5HZXRFbnVtZXJhdG9yKCkgfCBGb3JFYWNoLU9iamVjdCAtUHJvY2VzcyB7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5OYW1lc3BhY2VGb2xkZXJVcGRhdGVQYXJhbWV0ZXJNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aCwkXy5uYW1lLCAkXy52YWx1ZQogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKSAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICMgR2V0IHRhcmdldAogICAgICAgICAgICAkVGFyZ2V0ID0gR2V0LUZvbGRlclRhcmdldCBgCiAgICAgICAgICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgICAgICAgICAtVGFyZ2V0UGF0aCAkVGFyZ2V0UGF0aAogICAgICAgICAgICAKICAgICAgICAgICAgIyBEb2VzIHRoZSB0YXJnZXQgbmVlZCB0byBiZSB1cGRhdGVkPwogICAgICAgICAgICBbYm9vbGVhbl0gJFRhcmdldENoYW5nZSA9ICRmYWxzZQoKICAgICAgICAgICAgIyBUaGUgVGFyZ2V0IHByb3BlcnRpZXMgdGhhdCB3aWxsIGJlIHVwZGF0ZWQKICAgICAgICAgICAgJFRhcmdldFByb3BlcnRpZXMgPSBAe30KCiAgICAgICAgICAgICMgQ2hlY2sgdGhlIHRhcmdldCBwcm9wZXJ0aWVzCiAgICAgICAgICAgIGlmICgoJFJlZmVycmFsUHJpb3JpdHlDbGFzcykgYAogICAgICAgICAgICAgICAgLWFuZCAoJFRhcmdldC5SZWZlcnJhbFByaW9yaXR5Q2xhc3MgLW5lICRSZWZlcnJhbFByaW9yaXR5Q2xhc3MpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkVGFyZ2V0UHJvcGVydGllcyArPSBAewogICAgICAgICAgICAgICAgICAgIFJlZmVycmFsUHJpb3JpdHlDbGFzcyA9ICgkUmVmZXJyYWxQcmlvcml0eUNsYXNzIC1yZXBsYWNlICctJywnJykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRUYXJnZXRDaGFuZ2UgPSAkdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoKCRSZWZlcnJhbFByaW9yaXR5UmFuaykgYAogICAgICAgICAgICAgICAgLWFuZCAoJFRhcmdldC5SZWZlcnJhbFByaW9yaXR5UmFuayAtbmUgJFJlZmVycmFsUHJpb3JpdHlSYW5rKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFRhcmdldFByb3BlcnRpZXMgKz0gQHsgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIFJlZmVycmFsUHJpb3JpdHlSYW5rID0gJFJlZmVycmFsUHJpb3JpdHlSYW5rCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkVGFyZ2V0Q2hhbmdlID0gJHRydWUKICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICMgSXMgdGhlIHRhcmdldCBhIG1lbWJlciBvZiB0aGUgbmFtZXNwYWNlPwogICAgICAgICAgICBpZiAoJFRhcmdldCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyBEb2VzIHRoZSB0YXJnZXQgbmVlZCB0byBiZSBjaGFuZ2VkPwogICAgICAgICAgICAgICAgaWYgKCRUYXJnZXRDaGFuZ2UpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIyBVcGRhdGUgdGFyZ2V0IHNldHRpbmdzCiAgICAgICAgICAgICAgICAgICAgJG51bGwgPSBTZXQtRGZzbkZvbGRlclRhcmdldCBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1QYXRoICRQYXRoIGAKICAgICAgICAgICAgICAgICAgICAgICAgLVRhcmdldFBhdGggJFRhcmdldFBhdGggYAogICAgICAgICAgICAgICAgICAgICAgICBAVGFyZ2V0UHJvcGVydGllcyBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1FcnJvckFjdGlvbiBTdG9wCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjIEFkZCB0YXJnZXQgdG8gTmFtZXNwYWNlCiAgICAgICAgICAgICAgICAkbnVsbCA9IE5ldy1EZnNuRm9sZGVyVGFyZ2V0IGAKICAgICAgICAgICAgICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgICAgICAgICAgICAgLVRhcmdldFBhdGggJFRhcmdldFBhdGggYAogICAgICAgICAgICAgICAgICAgIEBUYXJnZXRQcm9wZXJ0aWVzIGAKICAgICAgICAgICAgICAgICAgICAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICB9CgogICAgICAgICAgICAjIE91dHB1dCB0aGUgdGFyZ2V0IHBhcmFtZXRlcnMgdGhhdCB3ZXJlIGNoYW5nZWQvc2V0CiAgICAgICAgICAgICRUYXJnZXRQcm9wZXJ0aWVzLkdldEVudW1lcmF0b3IoKSB8IEZvckVhY2gtT2JqZWN0IC1Qcm9jZXNzIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuTmFtZXNwYWNlRm9sZGVyVGFyZ2V0VXBkYXRlUGFyYW1ldGVyTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aCwkXy5uYW1lLCAkXy52YWx1ZQogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgIyBQcmVwYXJlIHRvIHVzZSB0aGUgUFNCb3VuZFBhcmFtZXRlcnMgYXMgYSBzcGxhdCB0byBjcmVhdGVkCiAgICAgICAgICAgICMgVGhlIG5ldyBERlMgTmFtZXNwYWNlIEZvbGRlci4KICAgICAgICAgICAgJG51bGwgPSAkUFNCb3VuZFBhcmFtZXRlcnMuUmVtb3ZlKCdFbnN1cmUnKQoKICAgICAgICAgICAgIyBDb3JyZWN0IHRoZSBSZWZlcnJhbFByaW9yaXR5Q2xhc3MgZmllbGQKICAgICAgICAgICAgaWYgKCRSZWZlcnJhbFByaW9yaXR5Q2xhc3MpCiAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICAkUFNCb3VuZFBhcmFtZXRlcnMuUmVmZXJyYWxQcmlvcml0eUNsYXNzID0gKCRSZWZlcnJhbFByaW9yaXR5Q2xhc3MgLXJlcGxhY2UgJy0nLCcnKQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIENyZWF0ZSBOZXctRGZzbkZvbGRlcgogICAgICAgICAgICAkbnVsbCA9IE5ldy1EZnNuRm9sZGVyIGAKICAgICAgICAgICAgICAgIEBQU0JvdW5kUGFyYW1ldGVycyBgCiAgICAgICAgICAgICAgICAtRXJyb3JBY3Rpb24gU3RvcAoKICAgICAgICAgICAgJFBTQm91bmRQYXJhbWV0ZXJzLkdldEVudW1lcmF0b3IoKSB8IEZvckVhY2gtT2JqZWN0IC1Qcm9jZXNzIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuTmFtZXNwYWNlRm9sZGVyVXBkYXRlUGFyYW1ldGVyTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aCwkXy5uYW1lLCAkXy52YWx1ZQogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgIyBUaGUgTmFtZXNwYWNlIEZvbGRlciBUYXJnZXQgc2hvdWxkIG5vdCBleGlzdAoKICAgICAgICAjIEdldCBGb2xkZXIgdGFyZ2V0CiAgICAgICAgJFRhcmdldCA9IEdldC1Gb2xkZXJUYXJnZXQgYAogICAgICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgICAgIC1UYXJnZXRQYXRoICRUYXJnZXRQYXRoCgogICAgICAgIGlmICgkVGFyZ2V0KQogICAgICAgIHsKICAgICAgICAgICAgIyBSZW1vdmUgdGhlIHRhcmdldCBmcm9tIHRoZSBOYW1lc3BhY2UgRm9sZGVyCiAgICAgICAgICAgICRudWxsID0gUmVtb3ZlLURmc25Gb2xkZXJUYXJnZXQgYAogICAgICAgICAgICAgICAgLVBhdGggJFBhdGggYAogICAgICAgICAgICAgICAgLVRhcmdldFBhdGggJFRhcmdldFBhdGggYAogICAgICAgICAgICAgICAgLUNvbmZpcm06JGZhbHNlIGAKICAgICAgICAgICAgICAgIC1FcnJvckFjdGlvbiBTdG9wCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5OYW1lc3BhY2VGb2xkZXJUYXJnZXRSZW1vdmVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoCiAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgIH0KICAgIH0KfSAjIFNldC1UYXJnZXRSZXNvdXJjZQoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFBhdGgsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJEVuc3VyZSwKICAgICAgICAKICAgICAgICBbU3RyaW5nXQogICAgICAgICREZXNjcmlwdGlvbiwKICAgICAgICAKICAgICAgICBbVWludDMyXQogICAgICAgICRUaW1lVG9MaXZlU2VjLAoKICAgICAgICBbQm9vbGVhbl0KICAgICAgICAkRW5hYmxlSW5zaXRlUmVmZXJyYWxzLAogICAgICAgICAgICAKICAgICAgICBbQm9vbGVhbl0KICAgICAgICAkRW5hYmxlVGFyZ2V0RmFpbGJhY2ssCgogICAgICAgIFtWYWxpZGF0ZVNldCgnR2xvYmFsLUhpZ2gnLCdTaXRlQ29zdC1IaWdoJywnU2l0ZUNvc3QtTm9ybWFsJywnU2l0ZUNvc3QtTG93JywnR2xvYmFsLUxvdycpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFJlZmVycmFsUHJpb3JpdHlDbGFzcywKICAgICAgICAKICAgICAgICBbVWludDMyXQogICAgICAgICRSZWZlcnJhbFByaW9yaXR5UmFuayAgICAgICAgICAKICAgICkKICAgCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuVGVzdGluZ05hbWVzcGFjZUZvbGRlck1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoIAogICAgICAgICkgLWpvaW4gJycgKQoKICAgICMgRmxhZyB0byBzaWduYWwgd2hldGhlciBzZXR0aW5ncyBhcmUgY29ycmVjdAogICAgW0Jvb2xlYW5dICREZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJHRydWUgICAgCgogICAgIyBMb29rdXAgdGhlIGV4aXN0aW5nIE5hbWVzcGFjZSBGb2xkZXIgICAgCiAgICAkRm9sZGVyID0gR2V0LUZvbGRlciBgCiAgICAgICAgLVBhdGggJFBhdGgKICAgICAgICAgICAgCiAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgewogICAgICAgICMgVGhlIE5hbWVzcGFjZSBGb2xkZXIgc2hvdWxkIGV4aXN0CiAgICAgICAgaWYgKCRGb2xkZXIpCiAgICAgICAgewogICAgICAgICAgICAjIFRoZSBOYW1lc3BhY2UgRm9sZGVyIGV4aXN0cyBhbmQgc2hvdWxkCgogICAgICAgICAgICAjIENoZWNrIHRoZSBOYW1lc3BhY2UgcGFyYW1ldGVycwogICAgICAgICAgICBpZiAoKCREZXNjcmlwdGlvbikgYAogICAgICAgICAgICAgICAgLWFuZCAoJEZvbGRlci5EZXNjcmlwdGlvbiAtbmUgJERlc2NyaXB0aW9uKSkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5OYW1lc3BhY2VGb2xkZXJQYXJhbWV0ZXJOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgsJ0Rlc2NyaXB0aW9uJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCgkVGltZVRvTGl2ZVNlYykgYAogICAgICAgICAgICAgICAgLWFuZCAoJEZvbGRlci5UaW1lVG9MaXZlU2VjIC1uZSAkVGltZVRvTGl2ZVNlYykpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuTmFtZXNwYWNlRm9sZGVyUGFyYW1ldGVyTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoLCdUaW1lVG9MaXZlU2VjJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkRW5hYmxlSW5zaXRlUmVmZXJyYWxzIC1uZSAkbnVsbCkgYAogICAgICAgICAgICAgICAgLWFuZCAoKCRGb2xkZXIuRmxhZ3MgLWNvbnRhaW5zICdJbnNpdGUgUmVmZXJyYWxzJykgLW5lICRFbmFibGVJbnNpdGVSZWZlcnJhbHMpKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclBhcmFtZXRlck5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aCwnRW5hYmxlSW5zaXRlUmVmZXJyYWxzJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkRW5hYmxlVGFyZ2V0RmFpbGJhY2sgLW5lICRudWxsKSBgCiAgICAgICAgICAgICAgICAtYW5kICgoJEZvbGRlci5GbGFncyAtY29udGFpbnMgJ1RhcmdldCBGYWlsYmFjaycpIC1uZSAkRW5hYmxlVGFyZ2V0RmFpbGJhY2spKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclBhcmFtZXRlck5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aCwnRW5hYmxlVGFyZ2V0RmFpbGJhY2snCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVGFyZ2V0ID0gR2V0LUZvbGRlclRhcmdldCBgCiAgICAgICAgICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgICAgICAgICAtVGFyZ2V0UGF0aCAkVGFyZ2V0UGF0aAoKICAgICAgICAgICAgaWYgKCRUYXJnZXQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgoJFJlZmVycmFsUHJpb3JpdHlDbGFzcykgYAogICAgICAgICAgICAgICAgICAgIC1hbmQgKCRUYXJnZXQuUmVmZXJyYWxQcmlvcml0eUNsYXNzIC1uZSAkUmVmZXJyYWxQcmlvcml0eUNsYXNzKSkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5OYW1lc3BhY2VGb2xkZXJUYXJnZXRQYXJhbWV0ZXJOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCRUYXJnZXRQYXRoLCdSZWZlcnJhbFByaW9yaXR5Q2xhc3MnCiAgICAgICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCgkUmVmZXJyYWxQcmlvcml0eVJhbmspIGAKICAgICAgICAgICAgICAgICAgICAtYW5kICgkVGFyZ2V0LlJlZmVycmFsUHJpb3JpdHlSYW5rIC1uZSAkUmVmZXJyYWxQcmlvcml0eVJhbmspKSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclRhcmdldFBhcmFtZXRlck5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgsJ1JlZmVycmFsUHJpb3JpdHlSYW5rJwogICAgICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyBUaGUgRm9sZGVyIHRhcmdldCBkb2VzIG5vdCBleGlzdCBidXQgc2hvdWxkIC0gY2hhbmdlIHJlcXVpcmVkCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclRhcmdldERvZXNOb3RFeGlzdEJ1dFNob3VsZE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICMgVGhzIE5hbWVzcGFjZSBGb2xkZXIgZG9lc24ndCBleGlzdCBidXQgc2hvdWxkIC0gY2hhbmdlIHJlcXVpcmVkCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5OYW1lc3BhY2VGb2xkZXJEb2VzTm90RXhpc3RCdXRTaG91bGRNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgKICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAjIFRoZSBOYW1lc3BhY2UgdGFyZ2V0IHNob3VsZCBub3QgZXhpc3QKICAgICAgICBpZiAoJEZvbGRlcikKICAgICAgICB7CiAgICAgICAgICAgICRUYXJnZXQgPSBHZXQtRm9sZGVyVGFyZ2V0IGAKICAgICAgICAgICAgICAgIC1QYXRoICRQYXRoIGAKICAgICAgICAgICAgICAgIC1UYXJnZXRQYXRoICRUYXJnZXRQYXRoCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCRUYXJnZXQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICMgVGhlIEZvbGRlciB0YXJnZXQgZXhpc3RzIGJ1dCBzaG91bGQgbm90IC0gY2hhbmdlIHJlcXVpcmVkCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclRhcmdldEV4aXN0c0J1dFNob3VsZE5vdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAjIFRoZSBOYW1lc3BhY2UgZXhpc3RzIGJ1dCB0aGUgdGFyZ2V0IGRvZXNuJ3QgLSBjaGFuZ2Ugbm90IHJlcXVpcmVkCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlclRhcmdldERvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgsJFRhcmdldFBhdGgKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIFRoZSBOYW1lc3BhY2UgZG9lcyBub3QgZXhpc3QgKHNvIG5laXRoZXIgZG9lcyB0aGUgdGFyZ2V0KSAtIGNoYW5nZSBub3QgcmVxdWlyZWQKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLk5hbWVzcGFjZUZvbGRlckRvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwkVGFyZ2V0UGF0aAogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgfQogICAgfSAjIGlmCiAgICAgICAgICAgICAgIAogICAgcmV0dXJuICREZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoIAoKfSAjIFRlc3QtVGFyZ2V0UmVzb3VyY2UKCiMgSGVscGVyIEZ1bmN0aW9ucwpGdW5jdGlvbiBHZXQtRm9sZGVyIHsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUGF0aAogICAgKQogICAgIyBMb29rdXAgdGhlIERGU04gRm9sZGVyLgogICAgIyBSZXR1cm4gbnVsbCBpZiBkb2Vzbid0IGV4aXN0LgogICAgdHJ5CiAgICB7CiAgICAgICAgJERmc25Gb2xkZXIgPSBHZXQtRGZzbkZvbGRlciBgCiAgICAgICAgICAgIC1QYXRoICRQYXRoIGAKICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKICAgIH0KICAgIGNhdGNoIFtNaWNyb3NvZnQuTWFuYWdlbWVudC5JbmZyYXN0cnVjdHVyZS5DaW1FeGNlcHRpb25dCiAgICB7CiAgICAgICAgJERmc25Gb2xkZXIgPSAkbnVsbAogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICBUaHJvdyAkXwogICAgfQogICAgUmV0dXJuICREZnNuRm9sZGVyCn0KCkZ1bmN0aW9uIEdldC1Gb2xkZXJUYXJnZXQgewogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQYXRoLAogICAgICAgIAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFRhcmdldFBhdGggICAgICAgIAogICAgKQogICAgIyBMb29rdXAgdGhlIERGU04gRm9sZGVyIFRhcmdldCBpbiBhIG5hbWVzcGFjZS4KICAgICMgUmV0dXJuIG51bGwgaWYgZG9lc24ndCBleGlzdC4KICAgIHRyeQogICAgewogICAgICAgICREZnNuVGFyZ2V0ID0gR2V0LURmc25Gb2xkZXJUYXJnZXQgYAogICAgICAgICAgICAtUGF0aCAkUGF0aCBgCiAgICAgICAgICAgIC1UYXJnZXRQYXRoICRUYXJnZXRQYXRoIGAKICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKICAgIH0KICAgIGNhdGNoIFtNaWNyb3NvZnQuTWFuYWdlbWVudC5JbmZyYXN0cnVjdHVyZS5DaW1FeGNlcHRpb25dCiAgICB7CiAgICAgICAgJERmc25UYXJnZXQgPSAkbnVsbAogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICBUaHJvdyAkXwogICAgfQogICAgUmV0dXJuICREZnNuVGFyZ2V0Cn0KCmZ1bmN0aW9uIE5ldy1UZXJtaW5hdGluZ0Vycm9yCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbU3RyaW5nXSAkRXJyb3JJZCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtTdHJpbmddICRFcnJvck1lc3NhZ2UsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5FcnJvckNhdGVnb3J5XSAkRXJyb3JDYXRlZ29yeQogICAgKQoKICAgICRleGNlcHRpb24gPSBOZXctT2JqZWN0IGAKICAgICAgICAtVHlwZU5hbWUgU3lzdGVtLkludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gYAogICAgICAgIC1Bcmd1bWVudExpc3QgJGVycm9yTWVzc2FnZQogICAgJGVycm9yUmVjb3JkID0gTmV3LU9iamVjdCBgCiAgICAgICAgLVR5cGVOYW1lIFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JSZWNvcmQgYAogICAgICAgIC1Bcmd1bWVudExpc3QgJGV4Y2VwdGlvbiwgJGVycm9ySWQsICRlcnJvckNhdGVnb3J5LCAkbnVsbAogICAgJFBTQ21kbGV0LlRocm93VGVybWluYXRpbmdFcnJvcigkZXJyb3JSZWNvcmQpCn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UK
