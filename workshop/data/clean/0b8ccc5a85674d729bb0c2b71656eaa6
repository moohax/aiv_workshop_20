ModuleDescriptions.ps1,ad176e12c74a74f8a4105520e1b005bb,Scan result is 1. IsMalware: 0,UGFyYW0oJGluX2xvZ19maWxlX25hbWUsJGlzVGVzdD0kZmFsc2UpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2hhbmdlIGhpc3RvcnkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBKYW4gMjAxNDogQWRkZWQgY29kZSBzbyB0aGF0IHRoaXMgdGFzayByZWNvcmRzIGxhc3QgcnVuIHN1Y2Nlc3MvZmFpbHVyZSBzdGF0dXMgZGV0YWlscyB0byBHdXIgCiMgICAgICAgICAgIHNvIHRoYXQgaXRzIHN1Y2Nlc3MvZmFpbHVyZSBzdGF0dXMgaXMgZGlzcGxheWVkIG9uIHRoZSBzdGF0dXMgcGFnZSAtIGh0dHA6Ly9sZWFybi5xb2wucXViLmFjLnVrL3N0YXR1cy8gIAojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi4gQzpcUU9MXExvY2FsU2V0dGluZ3MucHMxCgpbU3lzdGVtLlN0cmluZ10gJGxvZ19maWxlX25hbWUgfCBPdXQtTnVsbAoKW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgiTWljcm9zb2Z0LlNoYXJlUG9pbnQiKSB8IG91dC1udWxsCltTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoIlN5c3RlbS5EYXRhIikgfCBvdXQtbnVsbAoKW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQU2l0ZV0gJHNpdGUgfCBvdXQtbnVsbApbTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BXZWJdICR3ZWIgfCBvdXQtbnVsbApbU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbENvbm5lY3Rpb25dICRjb25uZWN0aW9uIHwgb3V0LW51bGwKW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdICRNb2REZXNjSGFzaCB8IG91dC1udWxsCgokR2xvYmFsOnNfdSA9ICJodHRwOiIKJEdsb2JhbDpzaXRlX3VybCA9ICRsZWFybmluZ191cmwKJEdsb2JhbDpsaXN0X25hbWUgPSAiIgokR2xvYmFsOmxvZ19maWxlX25hbWUgPSAkaW5fbG9nX2ZpbGVfbmFtZQokR2xvYmFsOmdsb2JhbE1vY2tUZXN0ID0gJGZhbHNlICMgU2V0IHRvICR0cnVlIHRvIHRlc3Qgc2NyaXB0IHdpdGhvdXQgY2hhbmdpbmcgYW55IGxpdmUgZGF0YS4gCgokc3RhdHVzUmVwb3J0aW5nRm9sZGVyID0gIkxlYXJuaW5nIjsKJHRhc2tOYW1lID0gIkltcG9ydC1Nb2R1bGVEZXNjcmlwdGlvbnMiOwokc3RhdHVzUGFnZVRvb2x0aXAgPSAiSW1wb3J0cyBNb2R1bGUgRGVzY3JpcHRpb25zIGZyb20gcXNpcy5gbkltcGFjdCBpZiBkb2Vzbid0IHJ1bjogYHRNb2R1bGUgRGVzY3JpcHRpb25zIGluIFZMRSBtaXNzaW5nIG9yIG91dCBvZiBkYXRlLiIKJHN0YXR1cyA9ICJTdWNjZWVkZWQiOyAjIHdpbGwgYmUgY2hhbmdlZCB0byBGYWlsZWQgaWYgZXJyb3Igb2NjdXJzLgoKJHRpbWVTY3JpcHRSdW5BdCA9IEdldC1EYXRlIC1mICJ5eXl5LU1NLWRkIEhILW1tIgoKJExvZ1Jvb3RQYXRoID0gIlxcZ3VyXExvZ3NcIgokTG9nUGF0aCA9ICIkKCRMb2dSb290UGF0aCkkKCRzdGF0dXNSZXBvcnRpbmdGb2xkZXIpXCQoJGluX2xvZ19maWxlX25hbWUpIgoKLiBjOlxRT0xcUHJkXEltcG9ydFxTY3JpcHRzXFdyaXRlLURhdGFUYWJsZS5wczEKCmZ1bmN0aW9uIEluaXRXZWIgewogIFtTeXN0ZW0uSW50MzJdICRlcnJvcgogICRlcnJvciA9IDAKICB0cmFwIFtTeXN0ZW0uRXhjZXB0aW9uXSB7CiAgICBTZXQtVmFyaWFibGUgLW5hbWUgZXJyb3IgLXZhbHVlIDEgLXNjb3BlIDEKICAgIGNvbnRpbnVlCiAgfQogICRHbG9iYWw6c2l0ZSA9IE5ldy1PYmplY3QgTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BTaXRlKCRHbG9iYWw6c2l0ZV91cmwpCiAgJEdsb2JhbDp3ZWIgPSAkc2l0ZS5PcGVuV2ViKCkKICBpZiAoJGVycm9yIC1lcSAxKSB7CiAgICBXcml0ZS1Ib3N0ICJFcnJvcnMgb3BlbmluZyB3ZWIgZm9yICckR2xvYmFsOnNpdGVfdXJsJyIKICAgIHJldHVybiAwCiAgfQogIHJldHVybiAxCn0gIyBlbmQgb2YgZnVuY3Rpb24KCmZ1bmN0aW9uIEluaXRMaXN0TmFtZSB7CgogIGlmICgkR2xvYmFsOmdsb2JhbE1vY2tUZXN0KSB7IFdyaXRlLUhvc3QgIk1vY2tpbmcgdGVzdCBzbyByZXBvcnRpbmcgYmFjayBTdWNjZXNzIGJ1dCBTaGFyZVBvaW50IGRhdGEgbm90IGNoYW5nZWQiOyAkbW9ja3Rlc3QgPSAkbnVsbDsgcmV0dXJuIDEgfQoKICBbTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BMaXN0XSAkbGlzdAogIHRyYXAgW1N5c3RlbS5FeGNlcHRpb25dIHsKICAgIGNvbnRpbnVlCiAgfSAKICAkR2xvYmFsOmxpc3RfbmFtZSA9ICJNb2R1bGUgRGVzY3JpcHRpb25zIDEiCiAgJGxpc3QgPSAkR2xvYmFsOndlYi5MaXN0c1siTW9kdWxlIERlc2NyaXB0aW9ucyJdCiAgc3dpdGNoICgkbGlzdC5Sb290Rm9sZGVyLk5hbWUpIHsKICAgICJNb2R1bGUgRGVzY3JpcHRpb25zIDEiIHsKICAgICAgJEdsb2JhbDpsaXN0X25hbWUgPSAiTW9kdWxlIERlc2NyaXB0aW9ucyAyIgogICAgICBEZWxldGVMaXN0IC1MaXN0TmFtZVRvRGVsZXRlICJNb2R1bGUgRGVzY3JpcHRpb25zIDIiIHwgT3V0LU51bGwKICAgICAgYnJlYWs7CiAgICB9CiAgICAiTW9kdWxlIERlc2NyaXB0aW9ucyAyIiB7CiAgICAgICRHbG9iYWw6bGlzdF9uYW1lID0gIk1vZHVsZSBEZXNjcmlwdGlvbnMgMSIKICAgICAgRGVsZXRlTGlzdCAtTGlzdE5hbWVUb0RlbGV0ZSAiTW9kdWxlIERlc2NyaXB0aW9ucyAxIiB8IE91dC1OdWxsCiAgICAgIGJyZWFrOwogICAgfQogIH0KfSAjIGVuZCBvZiBmdW5jdGlvbgoKZnVuY3Rpb24gSW5pdExpc3QgewoKICBpZiAoJEdsb2JhbDpnbG9iYWxNb2NrVGVzdCkgeyBXcml0ZS1Ib3N0ICJNb2NraW5nIHRlc3Qgc28gcmVwb3J0aW5nIGJhY2sgU3VjY2VzcyBidXQgU2hhcmVQb2ludCBkYXRhIG5vdCBjaGFuZ2VkIjsgJG1vY2t0ZXN0ID0gJG51bGw7IHJldHVybiAxIH0KCiAgW1N5c3RlbS5JbnQzMl0gJGVycm9yLCAkaSwgJGNvdW50CiAgW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQTGlzdF0gJGxpc3QKICBbTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BGaWVsZF0gJGZpZWxkCiAgW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQR3JvdXBdICRncm91cAogICRlcnJvciA9IDAKICB0cmFwIFtTeXN0ZW0uRXhjZXB0aW9uXSB7CiAgICBTZXQtVmFyaWFibGUgLW5hbWUgZXJyb3IgLXZhbHVlIDEgLXNjb3BlIDEKICAgICRfLkV4Y2VwdGlvbi5NZXNzYWdlCiAgICBjb250aW51ZQogIH0KICAkR2xvYmFsOndlYi5MaXN0cy5BZGQoJEdsb2JhbDpsaXN0X25hbWUsIk1vZHVsZSBEZXNjcmlwdGlvbnMgbGlzdCIsW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQTGlzdFRlbXBsYXRlVHlwZV06OkdlbmVyaWNMaXN0KQogIGlmICgkZXJyb3IgLWVxIDEpIHsKICAgIFdyaXRlLUhvc3QgIkVycm9yIGFkZGluZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgbGlzdCIgICAgCiAgICByZXR1cm4gMAogIH0gIAogICRsaXN0ID0gJEdsb2JhbDp3ZWIuTGlzdHNbJEdsb2JhbDpsaXN0X25hbWVdCiAgJGZpZWxkID0gJGxpc3QuRmllbGRzWyJUaXRsZSJdICAgCiAgJGZpZWxkLlVwZGF0ZSgpCiAgJGxpc3QuRmllbGRzLkFkZCgiTW9kdWxlQ29kZSIsIFtNaWNyb3NvZnQuU2hhcmVQb2ludC5TUEZpZWxkVHlwZV06OlRleHQsICR0cnVlKQogICRmaWVsZCA9ICRsaXN0LkZpZWxkc1siTW9kdWxlQ29kZSJdCiAgJGZpZWxkLkluZGV4ZWQgPSAkdHJ1ZSAgICAgIAogICRmaWVsZC5VcGRhdGUoKQogICRsaXN0LkZpZWxkcy5BZGQoIk1vZHVsZVRpdGxlIiwgW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQRmllbGRUeXBlXTo6VGV4dCwgJHRydWUpCiAgJGZpZWxkID0gJGxpc3QuRmllbGRzWyJNb2R1bGVUaXRsZSJdCiAgIyRmaWVsZC5JbmRleGVkID0gJHRydWUgICAgICAKICAkZmllbGQuVXBkYXRlKCkKICAkbGlzdC5GaWVsZHMuQWRkKCJEZXNjcmlwdGlvbiIsIFtNaWNyb3NvZnQuU2hhcmVQb2ludC5TUEZpZWxkVHlwZV06Ok5vdGUsICR0cnVlKQogICRmaWVsZCA9ICRsaXN0LkZpZWxkc1siRGVzY3JpcHRpb24iXSAgICAgIAogICRmaWVsZC5VcGRhdGUoKSAgICAgICAKICAkbGlzdC5VcGRhdGUoKQogIGlmICgkZXJyb3IgLWVxIDEpIHsKICAgIFdyaXRlLUhvc3QgIkVycm9yIGFkZGluZyBmaWVsZHMgdG8gJ01vZHVsZSBEZXNjcmlwdGlvbnMnIGxpc3QiCiAgICByZXR1cm4gMAogIH0KICAKICByZXR1cm4gMQp9ICMgZW5kIG9mIGZ1bmN0aW9uCgoKZnVuY3Rpb24gSW5pdENvbm5lY3Rpb24gewogIFtTeXN0ZW0uSW50MzJdICRlcnJvcgogICRlcnJvciA9IDAKICB0cmFwIFtTeXN0ZW0uRXhjZXB0aW9uXSB7CiAgICBTZXQtVmFyaWFibGUgLW5hbWUgZXJyb3IgLXZhbHVlIDEgLXNjb3BlIDEKICAgIGNvbnRpbnVlCiAgfQogICRHbG9iYWw6Y29ubmVjdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbENvbm5lY3Rpb24gCiAgJEdsb2JhbDpjb25uZWN0aW9uLkNvbm5lY3Rpb25TdHJpbmcgPSAkY29ubmVjdGlvbl9zdHJpbmcKICAkR2xvYmFsOmNvbm5lY3Rpb24uT3BlbigpIHwgb3V0LW51bGwKICBpZiAoJGVycm9yIC1lcSAxKSB7CiAgICByZXR1cm4gMAogIH0KICAiWyQoR2V0LURhdGUg4oCTZiAnSEg6bW06c3MnKV0gZW5kIG9mIGluaXQgbWV0aG9kIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJExvZ1BhdGgiIC1BcHBlbmQKICAKICByZXR1cm4gMQp9ICMgZW5kIG9mIGZ1bmN0aW9uCgpmdW5jdGlvbiBQb3B1bGF0ZUhhc2ggewoKICBpZiAoJEdsb2JhbDpnbG9iYWxNb2NrVGVzdCkgeyBXcml0ZS1Ib3N0ICJNb2NraW5nIHRlc3Qgc28gcmVwb3J0aW5nIGJhY2sgU3VjY2VzcyBidXQgU2hhcmVQb2ludCBkYXRhIG5vdCBjaGFuZ2VkIjsgJG1vY2t0ZXN0ID0gJG51bGw7IHJldHVybiAxIH0KCiAgI1tTeXN0ZW0uSW50MzJdICRlcnJvcgogIFtTeXN0ZW0uU3RyaW5nXSAkc3FsLCAkdGl0bGUsICRkZXNjcmlwdGlvbgogIFtTeXN0ZW0uRGF0YS5TcWxDbGllbnQuU3FsQ29tbWFuZF0gJGNvbW1hbmQKICBbU3lzdGVtLkRhdGEuU3FsQ2xpZW50LlNxbERhdGFSZWFkZXJdICRyZWFkZXIKICAkR2xvYmFsOk1vZERlc2NIYXNoID0gQHt9CiAgJHNxbCA9ICJTRUxFQ1QgKiBGUk9NIFtxc2lzXS5bZGJvXS5bTGVhcm5pbmdfTW9kdWxlX0Rlc2NyaXB0aW9uc10iCiAgJGNvbW1hbmQgPSBOZXctT2JqZWN0IFN5c3RlbS5EYXRhLlNxbENsaWVudC5TcWxDb21tYW5kCiAgJGNvbW1hbmQuQ29ubmVjdGlvbiA9ICRHbG9iYWw6Y29ubmVjdGlvbgogICRjb21tYW5kLkNvbW1hbmRUZXh0ID0gJHNxbCAKICAkcmVhZGVyID0gJGNvbW1hbmQuRXhlY3V0ZVJlYWRlcigpCiAgd2hpbGUoJHJlYWRlci5SZWFkKCkpIHsKICAgICRNb2REZXNjID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgQWRkLU1lbWJlciAtaW5wdXRPYmplY3QgJE1vZERlc2MgTm90ZVByb3BlcnR5IE1vZHVsZUNvZGUgKCRyZWFkZXJbIlRlcm0iXS5Ub1N0cmluZygpKyItIiskcmVhZGVyWyJGdWxsTW9kdWxlQ29kZSJdLlRvU3RyaW5nKCkpCiAgICBBZGQtTWVtYmVyIC1pbnB1dE9iamVjdCAkTW9kRGVzYyBOb3RlUHJvcGVydHkgTW9kdWxlVGl0bGUgJHJlYWRlclsiRGVzY3JpcHRpb24iXS5Ub1N0cmluZygpCiAgICBBZGQtTWVtYmVyIC1pbnB1dE9iamVjdCAkTW9kRGVzYyBOb3RlUHJvcGVydHkgRGVzY3JpcHRpb24gJHJlYWRlclsiRnVsbERlc2NyaXB0aW9uIl0uVG9TdHJpbmcoKQogICAgSWYgKCRHbG9iYWw6TW9kRGVzY0hhc2guQ29udGFpbnNLZXkoJE1vZERlc2MuTW9kdWxlQ29kZSkgLWVxICRmYWxzZSkgewogICAgICAkR2xvYmFsOk1vZERlc2NIYXNoLkFkZCgkTW9kRGVzYy5Nb2R1bGVDb2RlLCRNb2REZXNjKQogICAgfQogIH0gIAogICRyZWFkZXIuQ2xvc2UoKSAgICAgCiAgcmV0dXJuIDEKfSAjIGVuZCBvZiBmdW5jdGlvbgoKZnVuY3Rpb24gUG9wdWxhdGVMaXN0IHsKCiAgaWYgKCRHbG9iYWw6Z2xvYmFsTW9ja1Rlc3QpIHsgV3JpdGUtSG9zdCAiTW9ja2luZyB0ZXN0IHNvIHJlcG9ydGluZyBiYWNrIFN1Y2Nlc3MgYnV0IFNoYXJlUG9pbnQgZGF0YSBub3QgY2hhbmdlZCI7ICRtb2NrdGVzdCA9ICRudWxsOyByZXR1cm4gMSB9CgogIFtNaWNyb3NvZnQuU2hhcmVQb2ludC5TUExpc3RdICRsaXN0CiAgW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQTGlzdEl0ZW1dICRpdGVtIAogICRlcnJvciA9IDAKICB0cmFwIFtTeXN0ZW0uRXhjZXB0aW9uXSB7CiAgICBTZXQtVmFyaWFibGUgLW5hbWUgZXJyb3IgLXZhbHVlIDEgLXNjb3BlIDEKICAgICRfLkV4Y2VwdGlvbi5NZXNzYWdlCiAgICBjb250aW51ZQogIH0KICAkbGlzdCA9ICRHbG9iYWw6d2ViLkxpc3RzWyRHbG9iYWw6bGlzdF9uYW1lXQogIGlmICgkZXJyb3IgLWVxIDEpIHsKICAgIHJldHVybiAwCiAgfQogICRHbG9iYWw6TW9kRGVzY0hhc2gua2V5cyB8IGZvcmVhY2ggewogICAgJGl0ZW0gPSAkbGlzdC5JdGVtcy5BZGQoKQogICAgJGl0ZW1bIlRpdGxlIl0gPSAkR2xvYmFsOk1vZERlc2NIYXNoLml0ZW0oJF8pLk1vZHVsZUNvZGUgIAogICAgJGl0ZW1bIk1vZHVsZUNvZGUiXSA9ICRHbG9iYWw6TW9kRGVzY0hhc2guaXRlbSgkXykuTW9kdWxlQ29kZQogICAgJGl0ZW1bIk1vZHVsZVRpdGxlIl0gPSAkR2xvYmFsOk1vZERlc2NIYXNoLml0ZW0oJF8pLk1vZHVsZVRpdGxlIAogICAgJGl0ZW1bIkRlc2NyaXB0aW9uIl0gPSAkR2xvYmFsOk1vZERlc2NIYXNoLml0ZW0oJF8pLkRlc2NyaXB0aW9uICAgICAgICAgICAgIAogICAgJGl0ZW0uVXBkYXRlKCkKICAgIyRHbG9iYWw6TW9kRGVzY0hhc2guaXRlbSgkXykuTW9kdWxlQ29kZQogICB9CiAgJGxpc3QuVXBkYXRlKCkKICByZXR1cm4gMQp9ICMgZW5kIG9mIGZ1bmN0aW9uCgpmdW5jdGlvbiBEZWxldGVMaXN0IHsKICBQYXJhbSgKICAgICAgICAjTmFtZSBvZiBsaXN0IHRvIGRlbGV0ZQogICAgICAgIFtTdHJpbmddJExpc3ROYW1lVG9EZWxldGUgPSAnTW9kdWxlIERlc2NyaXB0aW9ucycKICAgICkKCiAgaWYgKCRHbG9iYWw6Z2xvYmFsTW9ja1Rlc3QpIHsgV3JpdGUtSG9zdCAiTW9ja2luZyB0ZXN0IHNvIHJlcG9ydGluZyBiYWNrIFN1Y2Nlc3MgYnV0IFNoYXJlUG9pbnQgZGF0YSBub3QgY2hhbmdlZCI7ICRtb2NrdGVzdCA9ICRudWxsOyByZXR1cm4gMSB9CgogIFtTeXN0ZW0uSW50MzJdICRlcnJvcgogICNbTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BMaXN0XSAkbGlzdAogICRlcnJvciA9IDAKICB0cmFwIFtTeXN0ZW0uRXhjZXB0aW9uXSB7CiAgICBTZXQtVmFyaWFibGUgLW5hbWUgZXJyb3IgLXZhbHVlIDEgLXNjb3BlIDEgCiAgICBjb250aW51ZQogIH0KICAkbGlzdCA9ICRHbG9iYWw6d2ViLkxpc3RzWyRMaXN0TmFtZVRvRGVsZXRlXQogIGlmICgkbGlzdCAtZXEgJG51bGwpIHsKICB9CiAgZWxzZSB7CiAgICAkbGlzdC5EZWxldGUoKQogICAgJEdsb2JhbDp3ZWIuVXBkYXRlKCkKICB9Cn0gIyBlbmQgb2YgZnVuY3Rpb24KCmZ1bmN0aW9uIFJlbmFtZUxpc3QgewoKICBpZiAoJEdsb2JhbDpnbG9iYWxNb2NrVGVzdCkgeyBXcml0ZS1Ib3N0ICJNb2NraW5nIHRlc3Qgc28gcmVwb3J0aW5nIGJhY2sgU3VjY2VzcyBidXQgU2hhcmVQb2ludCBkYXRhIG5vdCBjaGFuZ2VkIjsgJG1vY2t0ZXN0ID0gJG51bGw7IHJldHVybiAxIH0KCiAgW1N5c3RlbS5JbnQzMl0gJGVycm9yCiAgW01pY3Jvc29mdC5TaGFyZVBvaW50LlNQTGlzdF0gJGxpc3QKICAkZXJyb3IgPSAwCiAgdHJhcCBbU3lzdGVtLkV4Y2VwdGlvbl0gewogICAgU2V0LVZhcmlhYmxlIC1uYW1lIGVycm9yIC12YWx1ZSAxIC1zY29wZSAxIAogICAgY29udGludWUKICB9CiAgJGxpc3QgPSAkR2xvYmFsOndlYi5MaXN0c1skR2xvYmFsOmxpc3RfbmFtZV0KICBpZiAoJGVycm9yIC1lcSAxKSB7CiAgfQogIGVsc2UgewogICAgJGxpc3QuVGl0bGUgPSAiTW9kdWxlIERlc2NyaXB0aW9ucyIKICAgICRsaXN0LlVwZGF0ZSgpCiAgICAkR2xvYmFsOndlYi5VcGRhdGUoKQogIH0KICBpZiAoJGVycm9yIC1lcSAxKSB7CiAgICByZXR1cm4gMAogIH0KICByZXR1cm4gMQp9ICMgZW5kIG9mIGZ1bmN0aW9uCgokcmV0dXJuID0gMAppZiAoJGlzVGVzdC5Ub1VwcGVyKCkgLWVxICJGQUxTRSIpCnsKICAgICRyZXR1cm4gPSBJbml0V2ViICAjIGFkZCAtbW9ja2ZhaWwgc3dpdGNoIHRvIG1vY2sgYSBmYXVsdXJlIHRvIG9wZW4gd2ViIHNpdGUKfQoKaWYgKCRyZXR1cm4gLWVxIDEpIHsKICAiWyQoR2V0LURhdGUg4oCTZiAnSEg6bW06c3MnKV0gU3VjY2VzcyBvcGVuaW5nIHdlYiBmb3IgJyRHbG9iYWw6c2l0ZV91cmwnIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJExvZ1BhdGgiIC1BcHBlbmQKICAkcmV0dXJuID0gSW5pdENvbm5lY3Rpb24KICBpZiAoJHJldHVybiAtZXEgMSkgewogICAgIlskKEdldC1EYXRlIOKAk2YgJ0hIOm1tOnNzJyldIFN1Y2Nlc3Mgb3BlbmluZyBjb25uZWN0aW9uICckY29ubmVjdGlvbl9zdHJpbmcnIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJExvZ1BhdGgiIC1BcHBlbmQKCiAgICBJbml0TGlzdE5hbWUKCSAgJHJldHVybiA9IEluaXRMaXN0CiAgICBpZiAoJHJldHVybiAtZXEgMSkgewogICAgICAkcmV0dXJuID0gUG9wdWxhdGVIYXNoCiAgICAgIGlmICgkcmV0dXJuIC1lcSAxKSB7IAogICAgICAgICJbJChHZXQtRGF0ZSDigJNmICdISDptbTpzcycpXSBTdWNjZXNzIGluaXRpYWxpc2luZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgbGlzdCIgfCBPdXQtRmlsZSAtRmlsZVBhdGggIiRMb2dQYXRoIiAtQXBwZW5kCiAgICAgICAgJHJldHVybiA9IFBvcHVsYXRlTGlzdAogICAgICAgIGlmICgkcmV0dXJuIC1lcSAxKSB7CiAgICAgICAgICAiWyQoR2V0LURhdGUg4oCTZiAnSEg6bW06c3MnKV0gU3VjY2VzcyBwb3B1bGF0aW5nICdNb2R1bGUgRGVzY3JpcHRpb25zJyBsaXN0IiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJExvZ1BhdGgiIC1BcHBlbmQKICAgICAgICAgIERlbGV0ZUxpc3QKICAgICAgICAgICRyZXR1cm4gPSBSZW5hbWVMaXN0CiAgICAgICAgICBpZiAoJHJldHVybiAtZXEgMSkgewogICAgICAgICAgICAiWyQoR2V0LURhdGUg4oCTZiAnSEg6bW06c3MnKV0gU3VjY2VzcyByZW5hbWluZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgbGlzdCIgfCBPdXQtRmlsZSAtRmlsZVBhdGggIiRMb2dQYXRoIiAtQXBwZW5kCiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHN0YXR1cyA9ICJGYWlsZWQiCiAgICAgICAgICAgICJbJChHZXQtRGF0ZSDigJNmICdISDptbTpzcycpXSBFcnJvciByZW5hbWluZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgbGlzdCIgfCBPdXQtRmlsZSAtRmlsZVBhdGggIiRMb2dQYXRoIiAtQXBwZW5kCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkc3RhdHVzID0gIkZhaWxlZCIKICAgICAgICAgICAgIlskKEdldC1EYXRlIOKAk2YgJ0hIOm1tOnNzJyldIEVycm9yIHBvcHVsYXRpbmcgJ01vZHVsZSBEZXNjcmlwdGlvbnMnIGxpc3QiIHwgT3V0LUZpbGUgLUZpbGVQYXRoICIkTG9nUGF0aCIgLUFwcGVuZAogICAgICAgIH0KICAgICAgfQogICAgICBlbHNlIHsKICAgICAgICAkc3RhdHVzID0gIkZhaWxlZCIKICAgICAgICAiWyQoR2V0LURhdGUg4oCTZiAnSEg6bW06c3MnKV0gRXJyb3IgcG9wdWxhdGluZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgaGFzaCIgfCBPdXQtRmlsZSAtRmlsZVBhdGggIiRMb2dQYXRoIiAtQXBwZW5kCiAgICAgIH0gCiAgICAgICMkR2xvYmFsOk1vZERlc2NIYXNoLkRpc3Bvc2UoKQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJHN0YXR1cyA9ICJGYWlsZWQiCiAgICAgICAgIlskKEdldC1EYXRlIOKAk2YgJ0hIOm1tOnNzJyldIEVycm9yIGluaXRpYWxpc2luZyAnTW9kdWxlIERlc2NyaXB0aW9ucycgbGlzdCIgfCBPdXQtRmlsZSAtRmlsZVBhdGggIiRMb2dQYXRoIiAtQXBwZW5kCiAgICB9CiAgICAkR2xvYmFsOmNvbm5lY3Rpb24uQ2xvc2UoKQogIH0KICBlbHNlIHsKICAgICRzdGF0dXMgPSAiRmFpbGVkIgogICAgIlskKEdldC1EYXRlIOKAk2YgJ0hIOm1tOnNzJyldIEVycm9yIG9wZW5pbmcgY29ubmVjdGlvbiAnJEdsb2JhbDpjb25uZWN0aW9uX3N0cmluZyciIHwgT3V0LUZpbGUgLUZpbGVQYXRoICIkTG9nUGF0aCIgLUFwcGVuZAogIH0KICAkR2xvYmFsOndlYi5EaXNwb3NlKCkKICAkR2xvYmFsOnNpdGUuRGlzcG9zZSgpCn0KZWxzZSB7CiAgICAkc3RhdHVzID0gIkZhaWxlZCIKICAgICJbJChHZXQtRGF0ZSDigJNmICdISDptbTpzcycpXSBFcnJvciBvcGVuaW5nIHdlYiBmb3IgJyRHbG9iYWw6c2l0ZV91cmwnIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJExvZ1BhdGgiIC1BcHBlbmQKfQoKIyBVcGRhdGUgU3RhdHVzIG9uIHN0YXR1cyByZXBvcnRpbmcgcGFnZQppZiAoJHBzdmVyc2lvbnRhYmxlLlBTVmVyc2lvbi5NYWpvciAtZXEgMikgeyBpbXBvcnQtbW9kdWxlIFVwZGF0ZS1RdWJUYXNrU3RhdHVzUmVwb3J0IH0KVXBkYXRlLVF1YlRhc2tTdGF0dXNSZXBvcnQgLWFjdGl2aXR5ICJTY2hUYXNrIiAtc2NoVGFza05hbWVSZXBvcnRlZCAkdGFza05hbWUgLWxhc3RSdW5EYXRlUmVwb3J0ZWQgJHRpbWVTY3JpcHRSdW5BdCAtc3RhdHVzUmVwb3J0ZWQgICRzdGF0dXMgLWRldGFpbHNSZXBvcnRlZCAkTG9nUGF0aCAtbG9nRm9sZGVyUmVwb3J0ZWQgJHN0YXR1c1JlcG9ydGluZ0ZvbGRlciAtdG9vbHRpcCAkc3RhdHVzUGFnZVRvb2x0aXAgLW1vdmVEZXRhaWxzTG9nRmlsZSAkZmFsc2U=
