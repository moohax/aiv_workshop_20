MSFT_SPWeb.psm1,8be48d798dc689c18703f39badb434df,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gICAgW1N5c3RlbS5TdHJpbmddICAkVXJsLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0gW1N5c3RlbS5TdHJpbmddICAkRW5zdXJlID0gIlByZXNlbnQiLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLlN0cmluZ10gICREZXNjcmlwdGlvbiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5TdHJpbmddICAkTmFtZSwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5VSW50MzJdICAkTGFuZ3VhZ2UsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uU3RyaW5nXSAgJFRlbXBsYXRlLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLkJvb2xlYW5dICRVbmlxdWVQZXJtaXNzaW9ucywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkVXNlUGFyZW50VG9wTmF2LAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLkJvb2xlYW5dICRBZGRUb1F1aWNrTGF1bmNoLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLkJvb2xlYW5dICRBZGRUb1RvcE5hdiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXSAkSW5zdGFsbEFjY291bnQKICAgICkKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJHZXR0aW5nIFNQV2ViICckVXJsJyIKCiAgICAkcmVzdWx0ID0gSW52b2tlLVNQRFNDQ29tbWFuZCAtQ3JlZGVudGlhbCAkSW5zdGFsbEFjY291bnQgLUFyZ3VtZW50cyAkUFNCb3VuZFBhcmFtZXRlcnMgLVNjcmlwdEJsb2NrIHsKICAgICAgICAkcGFyYW1zID0gJGFyZ3NbMF0KICAgICAgICAKICAgICAgICAkd2ViID0gR2V0LVNQV2ViIC1JZGVudGl0eSAkcGFyYW1zLlVybCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQoKICAgICAgICBpZiAoJHdlYikgeyAKICAgICAgICAKICAgICAgICAgICAgJGVuc3VyZVJlc3VsdCAgID0gIlByZXNlbnQiIAogICAgICAgICAgICAkdGVtcGxhdGVSZXN1bHQgPSAiJCgkd2ViLldlYlRlbXBsYXRlKSMkKCR3ZWIuV2ViVGVtcGxhdGVJZCkiCiAgICAgICAgICAgICRwYXJlbnRUb3BOYXYgICA9ICR3ZWIuTmF2aWdhdGlvbi5Vc2VTaGFyZWQKCiAgICAgICAgfSBlbHNlIHsgCiAgICAgICAgCiAgICAgICAgICAgICRlbnN1cmVSZXN1bHQgPSAiQWJzZW50IiAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgICAgICBVcmwgICAgICAgICAgICAgICA9ICR3ZWIuVXJsCiAgICAgICAgICAgICAgICBFbnN1cmUgICAgICAgICAgICA9ICRlbnN1cmVSZXN1bHQKICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uICAgICAgID0gJHdlYi5EZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgTmFtZSAgICAgICAgICAgICAgPSAkd2ViLlRpdGxlCiAgICAgICAgICAgICAgICBMYW5ndWFnZSAgICAgICAgICA9ICR3ZWIuTGFuZ3VhZ2UKICAgICAgICAgICAgICAgIFRlbXBsYXRlICAgICAgICAgID0gJHRlbXBsYXRlUmVzdWx0CiAgICAgICAgICAgICAgICBVbmlxdWVQZXJtaXNzaW9ucyA9ICR3ZWIuSGFzVW5pcXVlUGVybQogICAgICAgICAgICAgICAgVXNlUGFyZW50VG9wTmF2ICAgPSAkcGFyZW50VG9wTmF2CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkcmVzdWx0Cn0KCgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAgIFtTeXN0ZW0uU3RyaW5nXSAgJFVybCwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildIFtTeXN0ZW0uU3RyaW5nXSAgJEVuc3VyZSA9ICJQcmVzZW50IiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5TdHJpbmddICAkRGVzY3JpcHRpb24sCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uU3RyaW5nXSAgJE5hbWUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uVUludDMyXSAgJExhbmd1YWdlLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLlN0cmluZ10gICRUZW1wbGF0ZSwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkVW5pcXVlUGVybWlzc2lvbnMsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uQm9vbGVhbl0gJFVzZVBhcmVudFRvcE5hdiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkQWRkVG9RdWlja0xhdW5jaCwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkQWRkVG9Ub3BOYXYsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiQ3JlYXRpbmcgU1BXZWIgJyRVcmwnIgogICAgCiAgICAkUFNCb3VuZFBhcmFtZXRlcnMuRW5zdXJlID0gJEVuc3VyZQoKICAgIEludm9rZS1TUERTQ0NvbW1hbmQgLUNyZWRlbnRpYWwgJEluc3RhbGxBY2NvdW50IC1Bcmd1bWVudHMgJFBTQm91bmRQYXJhbWV0ZXJzIC1TY3JpcHRCbG9jayB7CiAgICAgICAgJHBhcmFtcyA9ICRhcmdzWzBdCiAgICAgICAgCiAgICAgICAgaWYgKCRudWxsIC1lcSAkcGFyYW1zLkluc3RhbGxBY2NvdW50KSAKICAgICAgICB7ICAgIAogICAgICAgICAgICAkY3VycmVudFVzZXJOYW1lID0gIiRlbnY6VVNFUkRPTUFJTlwkZW52OlVTRVJOQU1FIgogICAgICAgIH0gCiAgICAgICAgZWxzZQogICAgICAgIHsgICAgCiAgICAgICAgICAgICRjdXJyZW50VXNlck5hbWUgPSAkcGFyYW1zLkluc3RhbGxBY2NvdW50LlVzZXJOYW1lCiAgICAgICAgfQogICAgICAgIAogICAgICAgIFdyaXRlLVZlcmJvc2UgIkdyYW50IHVzZXIgJyRjdXJyZW50VXNlck5hbWUnIEFjY2VzcyBUbyBQcm9jZXNzIElkZW50aXR5IGZvciAnJCgkcGFyYW1zLlVybCknLi4uIiAgCiAgICAgICAgKE5ldy1PYmplY3QgLVR5cGUgTWljcm9zb2Z0LlNoYXJlUG9pbnQuU1BTaXRlIC1Bcmd1bWVudExpc3QgJHBhcmFtcy5VcmwpLldlYkFwcGxpY2F0aW9uLkdyYW50QWNjZXNzVG9Qcm9jZXNzSWRlbnRpdHkoJGN1cnJlbnRVc2VyTmFtZSkgIAogICAgICAgIAogICAgICAgICR3ZWIgPSBHZXQtU1BXZWIgLUlkZW50aXR5ICRwYXJhbXMuVXJsIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgogICAgICAgIGlmICgkbnVsbCAtZXEgJHdlYikgCiAgICAgICAgewogICAgICAgICAgICAkcGFyYW1zLlJlbW92ZSgiSW5zdGFsbEFjY291bnQiKSB8IE91dC1OdWxsCiAgICAgICAgICAgICRwYXJhbXMuUmVtb3ZlKCJFbnN1cmUiKSB8IE91dC1OdWxsCgogICAgICAgICAgICBOZXctU1BXZWIgQHBhcmFtcyB8IE91dC1OdWxsCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkcGFyYW1zLkVuc3VyZSAtZXEgIkFic2VudCIpIHsKICAgICAgICAgICAgICAgIFJlbW92ZS1TUHdlYiAkcGFyYW1zLlVybCAtY29uZmlybTokZmFsc2UKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICRjaGFuZ2VkV2ViID0gJGZhbHNlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICgkd2ViLlRpdGxlIC1uZSAkcGFyYW1zLk5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAkd2ViLlRpdGxlID0gJHBhcmFtcy5OYW1lCiAgICAgICAgICAgICAgICAgICAgJGNoYW5nZWRXZWIgPSAkdHJ1ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgkd2ViLkRlc2NyaXB0aW9uIC1uZSAkcGFyYW1zLkRlc2NyaXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgJHdlYi5EZXNjcmlwdGlvbiA9ICRwYXJhbXMuRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAkY2hhbmdlZFdlYiA9ICR0cnVlCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCR3ZWIuTmF2aWdhdGlvbi5Vc2VTaGFyZWQgLW5lICRwYXJhbXMuVXNlUGFyZW50VG9wTmF2KSB7CiAgICAgICAgICAgICAgICAgICAgJHdlYi5OYXZpZ2F0aW9uLlVzZVNoYXJlZCA9ICRwYXJhbXMuVXNlUGFyZW50VG9wTmF2CiAgICAgICAgICAgICAgICAgICAgJGNoYW5nZWRXZWIgPSAkdHJ1ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgkd2ViLkhhc1VuaXF1ZVBlcm0gLW5lICRwYXJhbXMuVW5pcXVlUGVybWlzc2lvbnMpIHsKICAgICAgICAgICAgICAgICAgICAkd2ViLkhhc1VuaXF1ZVBlcm0gPSAkcGFyYW1zLlVuaXF1ZVBlcm1pc3Npb25zCiAgICAgICAgICAgICAgICAgICAgJGNoYW5nZWRXZWIgPSAkdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoJGNoYW5nZWRXZWIpIHsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAkd2ViLlVwZGF0ZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICAgIFtTeXN0ZW0uU3RyaW5nXSAgJFVybCwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildIFtTeXN0ZW0uU3RyaW5nXSAgJEVuc3VyZSA9ICJQcmVzZW50IiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5TdHJpbmddICAkRGVzY3JpcHRpb24sCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uU3RyaW5nXSAgJE5hbWUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uVUludDMyXSAgJExhbmd1YWdlLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gICBbU3lzdGVtLlN0cmluZ10gICRUZW1wbGF0ZSwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkVW5pcXVlUGVybWlzc2lvbnMsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uQm9vbGVhbl0gJFVzZVBhcmVudFRvcE5hdiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkQWRkVG9RdWlja0xhdW5jaCwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldICAgW1N5c3RlbS5Cb29sZWFuXSAkQWRkVG9Ub3BOYXYsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCgogICAgJFBTQm91bmRQYXJhbWV0ZXJzLkVuc3VyZSA9ICRFbnN1cmUKCiAgICAkQ3VycmVudFZhbHVlcyA9IEdldC1UYXJnZXRSZXNvdXJjZSBAUFNCb3VuZFBhcmFtZXRlcnMKCiAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJUZXN0aW5nIFNQV2ViICckVXJsJyIKCiAgICAkdmFsdWVzVG9DaGVjayA9IEAoIlVybCIsICJOYW1lIiwgIkRlc2NyaXB0aW9uIiwgIlVuaXF1ZVBlcm1pc3Npb25zIiwgIlVzZVBhcmVudFRvcE5hdiIsICJFbnN1cmUiKQoKICAgIHJldHVybiBUZXN0LVNQRFNDU3BlY2lmaWNQYXJhbWV0ZXJzIC1DdXJyZW50VmFsdWVzICRDdXJyZW50VmFsdWVzIC1EZXNpcmVkVmFsdWVzICRQU0JvdW5kUGFyYW1ldGVycyAtVmFsdWVzVG9DaGVjayAkdmFsdWVzVG9DaGVjawp9CgoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKi1UYXJnZXRSZXNvdXJjZQo=
