MSFT_xADUser.Tests.ps1,1d078c02dc1c0058e1540a31b5365a41,Scan result is 1. IsMalware: 0,JEdsb2JhbDpEU0NNb2R1bGVOYW1lICAgICAgPSAneEFjdGl2ZURpcmVjdG9yeScKJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUgICAgPSAnTVNGVF94QURVc2VyJwoKI3JlZ2lvbiBIRUFERVIKW1N0cmluZ10gJG1vZHVsZVJvb3QgPSBTcGxpdC1QYXRoIC1QYXJlbnQgKFNwbGl0LVBhdGggLVBhcmVudCAoU3BsaXQtUGF0aCAtUGFyZW50ICRTY3JpcHQ6TXlJbnZvY2F0aW9uLk15Q29tbWFuZC5QYXRoKSkKaWYgKCAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoIChKb2luLVBhdGggLVBhdGggJG1vZHVsZVJvb3QgLUNoaWxkUGF0aCAnRFNDUmVzb3VyY2UuVGVzdHMnKSkpIC1vciBgCiAgICAgKC1ub3QgKFRlc3QtUGF0aCAtUGF0aCAoSm9pbi1QYXRoIC1QYXRoICRtb2R1bGVSb290IC1DaGlsZFBhdGggJ0RTQ1Jlc291cmNlLlRlc3RzXFRlc3RIZWxwZXIucHNtMScpKSkgKQp7CiAgICAmIGdpdCBAKCdjbG9uZScsJ2h0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL0RzY1Jlc291cmNlLlRlc3RzLmdpdCcsKEpvaW4tUGF0aCAtUGF0aCAkbW9kdWxlUm9vdCAtQ2hpbGRQYXRoICdcRFNDUmVzb3VyY2UuVGVzdHNcJykpCn0KCkltcG9ydC1Nb2R1bGUgKEpvaW4tUGF0aCAtUGF0aCAkbW9kdWxlUm9vdCAtQ2hpbGRQYXRoICdEU0NSZXNvdXJjZS5UZXN0c1xUZXN0SGVscGVyLnBzbTEnKSAtRm9yY2UKJFRlc3RFbnZpcm9ubWVudCA9IEluaXRpYWxpemUtVGVzdEVudmlyb25tZW50IGAKICAgIC1EU0NNb2R1bGVOYW1lICRHbG9iYWw6RFNDTW9kdWxlTmFtZSBgCiAgICAtRFNDUmVzb3VyY2VOYW1lICRHbG9iYWw6RFNDUmVzb3VyY2VOYW1lIGAKICAgIC1UZXN0VHlwZSBVbml0CiNlbmRyZWdpb24gSEVBREVSCgoKIyBCZWdpbiBUZXN0aW5nCnRyeQp7CgogICAgI3JlZ2lvbiBQZXN0ZXIgVGVzdHMKCiAgICBJbk1vZHVsZVNjb3BlICRHbG9iYWw6RFNDUmVzb3VyY2VOYW1lIHsKCiAgICAgICAgJHRlc3RQcmVzZW50UGFyYW1zID0gQHsKICAgICAgICAgICAgRG9tYWluTmFtZSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgIFVzZXJOYW1lID0gJ1Rlc3RVc2VyJzsKICAgICAgICAgICAgRW5zdXJlID0gJ1ByZXNlbnQnOwogICAgICAgIH0KCiAgICAgICAgJHRlc3RBYnNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAkdGVzdEFic2VudFBhcmFtc1snRW5zdXJlJ10gPSAnQWJzZW50JzsKCiAgICAgICAgJGZha2VBRFVzZXIgPSBAewogICAgICAgICAgICBEaXN0aW5ndWlzaGVkTmFtZSA9ICJDTj0kKCR0ZXN0UHJlc2VudFBhcmFtcy5Vc2VyTmFtZSksQ049VXNlcnMsREM9Y29udG9zbyxEQz1jb20iOwogICAgICAgICAgICBFbmFibGVkID0gJHRydWU7CiAgICAgICAgICAgIEdpdmVuTmFtZSA9ICcnOwogICAgICAgICAgICBOYW1lID0gJHRlc3RQcmVzZW50UGFyYW1zLlVzZXJOYW1lOwogICAgICAgICAgICBTYW1BY2NvdW50TmFtZSA9ICR0ZXN0UHJlc2VudFBhcmFtcy5Vc2VyTmFtZTsKICAgICAgICAgICAgU3VybmFtZSA9ICcnOwogICAgICAgICAgICBVc2VyUHJpbmNpcGFsTmFtZSA9ICcnOwogICAgICAgIH0KCiAgICAgICAgJHRlc3REb21haW5Db250cm9sbGVyID0gJ1RFU1REQyc7CiAgICAgICAgJHRlc3RDcmVkZW50aWFsID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXTo6RW1wdHk7CgogICAgICAgICR0ZXN0U3RyaW5nUHJvcGVydGllcyA9IEAoCiAgICAgICAgICAgICdVc2VyUHJpbmNpcGFsTmFtZScsICdEaXNwbGF5TmFtZScsICdQYXRoJywgICdHaXZlbk5hbWUnLCAnSW5pdGlhbHMnLCAnU3VybmFtZScsICdEZXNjcmlwdGlvbicsICdTdHJlZXRBZGRyZXNzJywKICAgICAgICAgICAgJ1BPQm94JywgJ0NpdHknLCAnU3RhdGUnLCAnUG9zdGFsQ29kZScsICdDb3VudHJ5JywgJ0RlcGFydG1lbnQnLCAnRGl2aXNpb24nLCAnQ29tcGFueScsICdPZmZpY2UnLCAnSm9iVGl0bGUnLAogICAgICAgICAgICAnRW1haWxBZGRyZXNzJywgJ0VtcGxveWVlSUQnLCAnRW1wbG95ZWVOdW1iZXInLCAnSG9tZURpcmVjdG9yeScsICdIb21lRHJpdmUnLCAnSG9tZVBhZ2UnLCAnUHJvZmlsZVBhdGgnLAogICAgICAgICAgICAnTG9nb25TY3JpcHQnLCAnTm90ZXMnLCAnT2ZmaWNlUGhvbmUnLCAnTW9iaWxlUGhvbmUnLCAnRmF4JywgJ1BhZ2VyJywgJ0lQUGhvbmUnLCAnSG9tZVBob25lJywnQ29tbW9uTmFtZScKICAgICAgICApOwogICAgICAgICR0ZXN0Qm9vbGVhblByb3BlcnRpZXMgPSBAKCdQYXNzd29yZE5ldmVyRXhwaXJlcycsICdDYW5ub3RDaGFuZ2VQYXNzd29yZCcsJ0VuYWJsZWQnKTsKCiAgICAgICAgI3JlZ2lvbiBGdW5jdGlvbiBHZXQtVGFyZ2V0UmVzb3VyY2UKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcR2V0LVRhcmdldFJlc291cmNlIiB7CgogICAgICAgICAgICBJdCAiUmV0dXJucyBhICdTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlJyBvYmplY3QgdHlwZSIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtQURVc2VyIHsgcmV0dXJuIFtQU0N1c3RvbU9iamVjdF0gJGZha2VBRFVzZXI7IH0KCiAgICAgICAgICAgICAgICAkYWRVc2VyID0gR2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtczsKCiAgICAgICAgICAgICAgICAkYWRVc2VyIC1pcyBbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0gfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJSZXR1cm5zICdFbnN1cmUnIGlzICdQcmVzZW50JyB3aGVuIHVzZXIgYWNjb3VudCBleGlzdHMiIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciB7IHJldHVybiBbUFNDdXN0b21PYmplY3RdICRmYWtlQURVc2VyOyB9CgogICAgICAgICAgICAgICAgJGFkVXNlciA9IEdldC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXM7CgogICAgICAgICAgICAgICAgJGFkVXNlci5FbnN1cmUgfCBTaG91bGQgQmUgJ1ByZXNlbnQnOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiUmV0dXJucyAnRW5zdXJlJyBpcyAnQWJzZW50JyB3aGVuIHVzZXIgYWNjb3VudCBkb2VzIG5vdCBleGlzdCIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtQURVc2VyIHsgdGhyb3cgTmV3LU9iamVjdCBNaWNyb3NvZnQuQWN0aXZlRGlyZWN0b3J5Lk1hbmFnZW1lbnQuQURJZGVudGl0eU5vdEZvdW5kRXhjZXB0aW9uIH0KCiAgICAgICAgICAgICAgICAkYWRVc2VyID0gR2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtczsKCiAgICAgICAgICAgICAgICAkYWRVc2VyLkVuc3VyZSB8IFNob3VsZCBCZSAnQWJzZW50JzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNhbGxzICdHZXQtQURVc2VyJyB3aXRoICdTZXJ2ZXInIHBhcmFtZXRlciB3aGVuICdEb21haW5Db250cm9sbGVyJyBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFNlcnZlciAtZXEgJHRlc3REb21haW5Db250cm9sbGVyIH0gLU1vY2tXaXRoIHsgcmV0dXJuIFtQU0N1c3RvbU9iamVjdF0gJGZha2VBRFVzZXI7IH0KCiAgICAgICAgICAgICAgICBHZXQtVGFyZ2V0UmVzb3VyY2UgQHRlc3RQcmVzZW50UGFyYW1zIC1Eb21haW5Db250cm9sbGVyICR0ZXN0RG9tYWluQ29udHJvbGxlcjsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBHZXQtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkU2VydmVyIC1lcSAkdGVzdERvbWFpbkNvbnRyb2xsZXIgfSAtU2NvcGUgSXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDYWxscyAnR2V0LUFEVXNlcicgd2l0aCAnQ3JlZGVudGlhbCcgcGFyYW1ldGVyIHdoZW4gJ0RvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsJyBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJENyZWRlbnRpYWwgLWVxICR0ZXN0Q3JlZGVudGlhbCB9IC1Nb2NrV2l0aCB7IHJldHVybiBbUFNDdXN0b21PYmplY3RdICRmYWtlQURVc2VyOyB9CgogICAgICAgICAgICAgICAgR2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyAtRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwgJHRlc3RDcmVkZW50aWFsOwoKICAgICAgICAgICAgICAgIEFzc2VydC1Nb2NrQ2FsbGVkIEdldC1BRFVzZXIgLVBhcmFtZXRlckZpbHRlciB7ICRDcmVkZW50aWFsIC1lcSAkdGVzdENyZWRlbnRpYWwgfSAtU2NvcGUgSXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgICNlbmRyZWdpb24KCiAgICAgICAgI3JlZ2lvbiBGdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCiAgICAgICAgRGVzY3JpYmUgIiQoJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUpXFRlc3QtVGFyZ2V0UmVzb3VyY2UiIHsKCiAgICAgICAgICAgIEl0ICJQYXNzZXMgd2hlbiB1c2VyIGFjY291bnQgZG9lcyBub3QgZXhpc3QgYW5kICdFbnN1cmUnIGlzICdBYnNlbnQnIiB7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1UYXJnZXRSZXNvdXJjZSB7IHJldHVybiAkdGVzdEFic2VudFBhcmFtcyB9CgogICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdEFic2VudFBhcmFtcyB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlBhc3NlcyB3aGVuIHVzZXIgYWNjb3VudCBleGlzdHMgYW5kICdFbnN1cmUnIGlzICdQcmVzZW50JyIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgeyByZXR1cm4gJHRlc3RQcmVzZW50UGFyYW1zIH0KCiAgICAgICAgICAgICAgICBUZXN0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlBhc3NlcyB3aGVuIHVzZXIgYWNjb3VudCBwYXNzd29yZCBtYXRjaGVzIGFuZCAnUGFzc3dvcmQnIGlzIHNwZWNpZmllZCIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgeyByZXR1cm4gJHRlc3RQcmVzZW50UGFyYW1zIH0KICAgICAgICAgICAgICAgIE1vY2sgVGVzdC1QYXNzd29yZCB7IHJldHVybiAkdHJ1ZTsgfQoKICAgICAgICAgICAgICAgIFRlc3QtVGFyZ2V0UmVzb3VyY2UgQHRlc3RQcmVzZW50UGFyYW1zIC1QYXNzd29yZCAkdGVzdENyZWRlbnRpYWwgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJGYWlscyB3aGVuIHVzZXIgYWNjb3VudCBkb2VzIG5vdCBleGlzdCBhbmQgJ0Vuc3VyZScgaXMgJ1ByZXNlbnQnIiB7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1UYXJnZXRSZXNvdXJjZSB7IHJldHVybiAkdGVzdEFic2VudFBhcmFtcyB9CgogICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiRmFpbHMgd2hlbiB1c2VyIGFjY291bnQgZXhpc3RzLCBhbmQgJ0Vuc3VyZScgaXMgJ0Fic2VudCciIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LVRhcmdldFJlc291cmNlIHsgcmV0dXJuICR0ZXN0UHJlc2VudFBhcmFtcyB9CgogICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdEFic2VudFBhcmFtcyB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJGYWlscyB3aGVuIHVzZXIgYWNjb3VudCBwYXNzd29yZCBpcyBpbmNvcnJlY3QgYW5kICdQYXNzd29yZCcgaXMgc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1UYXJnZXRSZXNvdXJjZSB7IHJldHVybiAkdGVzdFByZXNlbnRQYXJhbXMgfQogICAgICAgICAgICAgICAgTW9jayBUZXN0LVBhc3N3b3JkIHsgcmV0dXJuICRmYWxzZTsgfQoKICAgICAgICAgICAgICAgIFRlc3QtVGFyZ2V0UmVzb3VyY2UgQHRlc3RQcmVzZW50UGFyYW1zIC1QYXNzd29yZCAkdGVzdENyZWRlbnRpYWwgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ2FsbHMgJ1Rlc3QtUGFzc3dvcmQnIHdpdGggJ0RlZmF1bHQnIFBhc3N3b3JkQXV0aGVudGljYXRpb24gYnkgZGVmYXVsdCIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgeyByZXR1cm4gJHRlc3RQcmVzZW50UGFyYW1zIH0KICAgICAgICAgICAgICAgIE1vY2sgVGVzdC1QYXNzd29yZCAtUGFyYW1ldGVyRmlsdGVyIHsgJFBhc3N3b3JkQXV0aGVudGljYXRpb24gLWVxICdEZWZhdWx0JyB9IHsgcmV0dXJuICR0cnVlOyB9CgogICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgLVBhc3N3b3JkICR0ZXN0Q3JlZGVudGlhbDsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBUZXN0LVBhc3N3b3JkIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUGFzc3dvcmRBdXRoZW50aWNhdGlvbiAtZXEgJ0RlZmF1bHQnIH0gLVNjb3BlIEl0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ2FsbHMgJ1Rlc3QtUGFzc3dvcmQnIHdpdGggJ05lZ290aWF0ZScgUGFzc3dvcmRBdXRoZW50aWNhdGlvbiB3aGVuIHNwZWNpZmllZCIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgeyByZXR1cm4gJHRlc3RQcmVzZW50UGFyYW1zIH0KICAgICAgICAgICAgICAgIE1vY2sgVGVzdC1QYXNzd29yZCAtUGFyYW1ldGVyRmlsdGVyIHsgJFBhc3N3b3JkQXV0aGVudGljYXRpb24gLWVxICdOZWdvdGlhdGUnIH0geyByZXR1cm4gJGZhbHNlOyB9CgogICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgLVBhc3N3b3JkICR0ZXN0Q3JlZGVudGlhbCAtUGFzc3dvcmRBdXRoZW50aWNhdGlvbiAnTmVnb3RpYXRlJzsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBUZXN0LVBhc3N3b3JkIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUGFzc3dvcmRBdXRoZW50aWNhdGlvbiAtZXEgJ05lZ290aWF0ZScgfSAtU2NvcGUgSXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvcmVhY2ggKCR0ZXN0UGFyYW1ldGVyIGluICR0ZXN0U3RyaW5nUHJvcGVydGllcykgewoKICAgICAgICAgICAgICAgIEl0ICJQYXNzZXMgd2hlbiB1c2VyIGFjY291bnQgJyR0ZXN0UGFyYW1ldGVyJyBtYXRjaGVzIEFEIGFjY291bnQgcHJvcGVydHkiIHsKICAgICAgICAgICAgICAgICAgICAkdGVzdFBhcmFtZXRlclZhbHVlID0gJ1Rlc3QgUGFyYW1ldGVyIFN0cmluZyBWYWx1ZSc7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtc1skdGVzdFBhcmFtZXRlcl0gPSAkdGVzdFBhcmFtZXRlclZhbHVlOwogICAgICAgICAgICAgICAgICAgICR2YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICRpbnZhbGlkQURVc2VyID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgewogICAgICAgICAgICAgICAgICAgICAgICAkdmFsaWRBRFVzZXJbJHRlc3RQYXJhbWV0ZXJdID0gJHRlc3RQYXJhbWV0ZXJWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR2YWxpZEFEVXNlcjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFRlc3QtVGFyZ2V0UmVzb3VyY2UgQHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgSXQgIkZhaWxzIHdoZW4gdXNlciBhY2NvdW50ICckdGVzdFBhcmFtZXRlcicgZG9lcyBub3QgbWF0Y2ggaW5jb3JyZWN0IEFEIGFjY291bnQgcHJvcGVydHkgdmFsdWUiIHsKICAgICAgICAgICAgICAgICAgICAkdGVzdFBhcmFtZXRlclZhbHVlID0gJ1Rlc3QgUGFyYW1ldGVyIFN0cmluZyBWYWx1ZSc7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtc1skdGVzdFBhcmFtZXRlcl0gPSAkdGVzdFBhcmFtZXRlclZhbHVlOwogICAgICAgICAgICAgICAgICAgICR2YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICRpbnZhbGlkQURVc2VyID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgewogICAgICAgICAgICAgICAgICAgICAgICAkaW52YWxpZEFEVXNlclskdGVzdFBhcmFtZXRlcl0gPSAkdGVzdFBhcmFtZXRlclZhbHVlLlN1YnN0cmluZygwLCAoW1N5c3RlbS5JbnQzMl0gJHRlc3RQYXJhbWV0ZXJWYWx1ZS5MZW5ndGgvMikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGludmFsaWRBRFVzZXI7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBUZXN0LVRhcmdldFJlc291cmNlIEB0ZXN0VmFsaWRQcmVzZW50UGFyYW1zIHwgU2hvdWxkIEJlICRmYWxzZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBJdCAiRmFpbHMgd2hlbiB1c2VyIGFjY291bnQgJyR0ZXN0UGFyYW1ldGVyJyBkb2VzIG5vdCBtYXRjaCBlbXB0eSBBRCBhY2NvdW50IHByb3BlcnR5IHZhbHVlIiB7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RQYXJhbWV0ZXJWYWx1ZSA9ICdUZXN0IFBhcmFtZXRlciBTdHJpbmcgVmFsdWUnOwogICAgICAgICAgICAgICAgICAgICR0ZXN0VmFsaWRQcmVzZW50UGFyYW1zID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXNbJHRlc3RQYXJhbWV0ZXJdID0gJHRlc3RQYXJhbWV0ZXJWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAkdmFsaWRBRFVzZXIgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkaW52YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgIE1vY2sgR2V0LVRhcmdldFJlc291cmNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGludmFsaWRBRFVzZXJbJHRlc3RQYXJhbWV0ZXJdID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaW52YWxpZEFEVXNlcjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFRlc3QtVGFyZ2V0UmVzb3VyY2UgQHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEl0ICJGYWlscyB3aGVuIHVzZXIgYWNjb3VudCAnJHRlc3RQYXJhbWV0ZXInIGRvZXMgbm90IG1hdGNoIG51bGwgQUQgYWNjb3VudCBwcm9wZXJ0eSB2YWx1ZSIgewogICAgICAgICAgICAgICAgICAgICR0ZXN0UGFyYW1ldGVyVmFsdWUgPSAnVGVzdCBQYXJhbWV0ZXIgU3RyaW5nIFZhbHVlJzsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtcyA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICR0ZXN0VmFsaWRQcmVzZW50UGFyYW1zWyR0ZXN0UGFyYW1ldGVyXSA9ICR0ZXN0UGFyYW1ldGVyVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgJHZhbGlkQURVc2VyID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJGludmFsaWRBRFVzZXIgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICBNb2NrIEdldC1UYXJnZXRSZXNvdXJjZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpbnZhbGlkQURVc2VyWyR0ZXN0UGFyYW1ldGVyXSA9ICRudWxsOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGludmFsaWRBRFVzZXI7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBUZXN0LVRhcmdldFJlc291cmNlIEB0ZXN0VmFsaWRQcmVzZW50UGFyYW1zIHwgU2hvdWxkIEJlICRmYWxzZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBJdCAiUGFzc2VzIHdoZW4gZW1wdHkgdXNlciBhY2NvdW50ICckdGVzdFBhcmFtZXRlcicgbWF0Y2hlcyBlbXB0eSBBRCBhY2NvdW50IHByb3BlcnR5IiB7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtc1skdGVzdFBhcmFtZXRlcl0gPSAkdGVzdFBhcmFtZXRlclZhbHVlOwogICAgICAgICAgICAgICAgICAgICR2YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgIE1vY2sgR2V0LVRhcmdldFJlc291cmNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhbGlkQURVc2VyWyR0ZXN0UGFyYW1ldGVyXSA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHZhbGlkQURVc2VyOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgVGVzdC1UYXJnZXRSZXNvdXJjZSBAdGVzdFZhbGlkUHJlc2VudFBhcmFtcyB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBJdCAiUGFzc2VzIHdoZW4gZW1wdHkgdXNlciBhY2NvdW50ICckdGVzdFBhcmFtZXRlcicgbWF0Y2hlcyBudWxsIEFEIGFjY291bnQgcHJvcGVydHkiIHsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtcyA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICR0ZXN0VmFsaWRQcmVzZW50UGFyYW1zWyR0ZXN0UGFyYW1ldGVyXSA9ICR0ZXN0UGFyYW1ldGVyVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgJHZhbGlkQURVc2VyID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgewogICAgICAgICAgICAgICAgICAgICAgICAkdmFsaWRBRFVzZXJbJHRlc3RQYXJhbWV0ZXJdID0gJG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsaWRBRFVzZXI7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBUZXN0LVRhcmdldFJlc291cmNlIEB0ZXN0VmFsaWRQcmVzZW50UGFyYW1zIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSAjZW5kIGZvcmVhY2ggdGVzdCBzdHJpbmcgcHJvcGVydHkKCiAgICAgICAgICAgIGZvcmVhY2ggKCR0ZXN0UGFyYW1ldGVyIGluICR0ZXN0Qm9vbGVhblByb3BlcnRpZXMpIHsKCiAgICAgICAgICAgICAgICBJdCAiUGFzc2VzIHdoZW4gdXNlciBhY2NvdW50ICckdGVzdFBhcmFtZXRlcicgbWF0Y2hlcyBBRCBhY2NvdW50IHByb3BlcnR5IiB7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RQYXJhbWV0ZXJWYWx1ZSA9ICR0cnVlOwogICAgICAgICAgICAgICAgICAgICR0ZXN0VmFsaWRQcmVzZW50UGFyYW1zID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXNbJHRlc3RQYXJhbWV0ZXJdID0gJHRlc3RQYXJhbWV0ZXJWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAkdmFsaWRBRFVzZXIgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkaW52YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgIE1vY2sgR2V0LVRhcmdldFJlc291cmNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhbGlkQURVc2VyWyR0ZXN0UGFyYW1ldGVyXSA9ICR0ZXN0UGFyYW1ldGVyVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkdmFsaWRBRFVzZXI7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBUZXN0LVRhcmdldFJlc291cmNlIEB0ZXN0VmFsaWRQcmVzZW50UGFyYW1zIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEl0ICJGYWlscyB3aGVuIHVzZXIgYWNjb3VudCAnJHRlc3RQYXJhbWV0ZXInIGRvZXMgbm90IG1hdGNoIEFEIGFjY291bnQgcHJvcGVydHkgdmFsdWUiIHsKICAgICAgICAgICAgICAgICAgICAkdGVzdFBhcmFtZXRlclZhbHVlID0gJHRydWU7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkdGVzdFZhbGlkUHJlc2VudFBhcmFtc1skdGVzdFBhcmFtZXRlcl0gPSAkdGVzdFBhcmFtZXRlclZhbHVlOwogICAgICAgICAgICAgICAgICAgICR2YWxpZEFEVXNlciA9ICR0ZXN0UHJlc2VudFBhcmFtcy5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICRpbnZhbGlkQURVc2VyID0gJHRlc3RQcmVzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgTW9jayBHZXQtVGFyZ2V0UmVzb3VyY2UgewogICAgICAgICAgICAgICAgICAgICAgICAkaW52YWxpZEFEVXNlclskdGVzdFBhcmFtZXRlcl0gPSAtbm90ICR0ZXN0UGFyYW1ldGVyVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaW52YWxpZEFEVXNlcjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFRlc3QtVGFyZ2V0UmVzb3VyY2UgQHRlc3RWYWxpZFByZXNlbnRQYXJhbXMgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSAjZW5kIGZvcmVhY2ggdGVzdCBib29sZWFuIHByb3BlcnR5CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCiAgICAgICAgRGVzY3JpYmUgIiQoJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUpXFNldC1UYXJnZXRSZXNvdXJjZSIgewoKICAgICAgICAgICAgSXQgIkNhbGxzICdOZXctQURVc2VyJyB3aGVuICdFbnN1cmUnIGlzICdQcmVzZW50JyBhbmQgdGhlIGFjY291bnQgZG9lcyBub3QgZXhpc3QiIHsKICAgICAgICAgICAgICAgICRuZXdVc2VyTmFtZSA9ICdOZXdVc2VyJwogICAgICAgICAgICAgICAgJG5ld0Fic2VudFBhcmFtcyA9ICR0ZXN0QWJzZW50UGFyYW1zLkNsb25lKCk7CiAgICAgICAgICAgICAgICAkbmV3QWJzZW50UGFyYW1zWydVc2VyTmFtZSddID0gJG5ld1VzZXJOYW1lOwogICAgICAgICAgICAgICAgJG5ld1ByZXNlbnRQYXJhbXMgPSAkdGVzdFByZXNlbnRQYXJhbXMuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICRuZXdQcmVzZW50UGFyYW1zWydVc2VyTmFtZSddID0gJG5ld1VzZXJOYW1lOwogICAgICAgICAgICAgICAgTW9jayBOZXctQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkTmFtZSAtZXEgJG5ld1VzZXJOYW1lIH0geyB9CiAgICAgICAgICAgICAgICBNb2NrIFNldC1BRFVzZXIgeyB9CiAgICAgICAgICAgICAgICBNb2NrIEdldC1UYXJnZXRSZXNvdXJjZSAtUGFyYW1ldGVyRmlsdGVyIHsgJFVzZXJuYW1lIC1lcSAkbmV3VXNlck5hbWUgfSB7IHJldHVybiAkbmV3QWJzZW50UGFyYW1zOyB9CgogICAgICAgICAgICAgICAgU2V0LVRhcmdldFJlc291cmNlIEBuZXdQcmVzZW50UGFyYW1zOwoKICAgICAgICAgICAgICAgIEFzc2VydC1Nb2NrQ2FsbGVkIE5ldy1BRFVzZXIgLVBhcmFtZXRlckZpbHRlciB7ICROYW1lIC1lcSAkbmV3VXNlck5hbWUgfSAtU2NvcGUgSXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDYWxscyAnTW92ZS1BRE9iamVjdCcgd2hlbiAnRW5zdXJlJyBpcyAnUHJlc2VudCcsIHRoZSBhY2NvdW50IGV4aXN0cyBidXQgUGF0aCBpcyBpbmNvcnJlY3QiIHsKICAgICAgICAgICAgICAgICR0ZXN0VGFyZ2V0UGF0aCA9ICdDTj1Vc2VycyxEQz1jb250b3NvLERDPWNvbSc7CiAgICAgICAgICAgICAgICBNb2NrIFNldC1BRFVzZXIgeyB9CiAgICAgICAgICAgICAgICBNb2NrIEdldC1BRFVzZXIgewogICAgICAgICAgICAgICAgICAgICRkdWZmQURVc2VyID0gJGZha2VBRFVzZXIuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkZHVmZkFEVXNlclsnRGlzdGluZ3Vpc2hlZE5hbWUnXSA9ICJDTj0kKCR0ZXN0UHJlc2VudFBhcmFtcy5Vc2VyTmFtZSksT1U9V3JvbmdQYXRoLERDPWNvbnRvc28sREM9Y29tIjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGR1ZmZBRFVzZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBNb2NrIE1vdmUtQURPYmplY3QgLVBhcmFtZXRlckZpbHRlciB7ICRUYXJnZXRQYXRoIC1lcSAkdGVzdFRhcmdldFBhdGggfSAtTW9ja1dpdGggeyB9CgogICAgICAgICAgICAgICAgU2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyAtUGF0aCAkdGVzdFRhcmdldFBhdGggLUVuYWJsZWQgJHRydWU7CgogICAgICAgICAgICAgICAgQXNzZXJ0LU1vY2tDYWxsZWQgTW92ZS1BRE9iamVjdCAtUGFyYW1ldGVyRmlsdGVyIHsgJFRhcmdldFBhdGggLWVxICR0ZXN0VGFyZ2V0UGF0aCB9IC1TY29wZSBJdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNhbGxzICdSZW5hbWUtQURPYmplY3QnIHdoZW4gJ0Vuc3VyZScgaXMgJ1ByZXNlbnQnLCB0aGUgYWNjb3VudCBleGlzdHMgYnV0ICdDb21tb25OYW1lJyBpcyBpbmNvcnJlY3QiIHsKICAgICAgICAgICAgICAgICR0ZXN0Q29tbW9uTmFtZSA9ICdUZXN0IENvbW1vbiBOYW1lJzsKICAgICAgICAgICAgICAgIE1vY2sgU2V0LUFEVXNlciB7IH0KICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciB7IHJldHVybiAkZmFrZUFEVXNlcjsgfQogICAgICAgICAgICAgICAgTW9jayBSZW5hbWUtQURPYmplY3QgLVBhcmFtZXRlckZpbHRlciB7ICROZXdOYW1lIC1lcSAkdGVzdENvbW1vbk5hbWUgfSAtTW9ja1dpdGggeyB9CgogICAgICAgICAgICAgICAgU2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyAtQ29tbW9uTmFtZSAkdGVzdENvbW1vbk5hbWUgLUVuYWJsZWQgJHRydWU7CgogICAgICAgICAgICAgICAgQXNzZXJ0LU1vY2tDYWxsZWQgUmVuYW1lLUFET2JqZWN0IC1QYXJhbWV0ZXJGaWx0ZXIgeyAkTmV3TmFtZSAtZXEgJHRlc3RDb21tb25OYW1lIH0gLVNjb3BlIEl0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ2FsbHMgJ1NldC1BREFjY291bnRQYXNzd29yZCcgd2hlbiAnUGFzc3dvcmQnIHBhcmFtZXRlciBpcyBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciB7IHJldHVybiAkZmFrZUFEVXNlcjsgfQogICAgICAgICAgICAgICAgTW9jayBTZXQtQURVc2VyIHsgfQogICAgICAgICAgICAgICAgTW9jayBTZXQtQURBY2NvdW50UGFzc3dvcmQgLVBhcmFtZXRlckZpbHRlciB7ICROZXdQYXNzd29yZCAtZXEgJHRlc3RDcmVkZW50aWFsLlBhc3N3b3JkIH0gLU1vY2tXaXRoIHsgfQoKICAgICAgICAgICAgICAgIFNldC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgLVBhc3N3b3JkICR0ZXN0Q3JlZGVudGlhbDsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBTZXQtQURBY2NvdW50UGFzc3dvcmQgLVBhcmFtZXRlckZpbHRlciB7ICROZXdQYXNzd29yZCAtZXEgJHRlc3RDcmVkZW50aWFsLlBhc3N3b3JkIH0gLVNjb3BlIEl0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ2FsbHMgJ1NldC1BRFVzZXInIHdpdGggJ1JlcGxhY2UnIHdoZW4gZXhpc3RpbmcgbWF0Y2hpbmcgQUQgcHJvcGVydHkgaXMgbnVsbCIgewogICAgICAgICAgICAgICAgJHRlc3RBRFByb3BlcnR5TmFtZSA9ICdEZXNjcmlwdGlvbic7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1BRFVzZXIgewogICAgICAgICAgICAgICAgICAgICRkdWZmQURVc2VyID0gJGZha2VBRFVzZXIuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkZHVmZkFEVXNlclskdGVzdEFEUHJvcGVydHlOYW1lXSA9ICRudWxsOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAkZHVmZkFEVXNlcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1vY2sgU2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFJlcGxhY2UuQ29udGFpbnNLZXkoJHRlc3RBRFByb3BlcnR5TmFtZSkgfSAtTW9ja1dpdGggeyB9CgogICAgICAgICAgICAgICAgU2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyAtRGVzY3JpcHRpb24gJ015IGN1c3RvbSBkZXNjcmlwdGlvbic7CgogICAgICAgICAgICAgICAgQXNzZXJ0LU1vY2tDYWxsZWQgU2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFJlcGxhY2UuQ29udGFpbnNLZXkoJHRlc3RBRFByb3BlcnR5TmFtZSkgfSAtU2NvcGUgSXQgLUV4YWN0bHkgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNhbGxzICdTZXQtQURVc2VyJyB3aXRoICdSZXBsYWNlJyB3aGVuIGV4aXN0aW5nIG1hdGNoaW5nIEFEIHByb3BlcnR5IGlzIGVtcHR5IiB7CiAgICAgICAgICAgICAgICAkdGVzdEFEUHJvcGVydHlOYW1lID0gJ0Rlc2NyaXB0aW9uJzsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciB7CiAgICAgICAgICAgICAgICAgICAgJGR1ZmZBRFVzZXIgPSAkZmFrZUFEVXNlci5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICRkdWZmQURVc2VyWyR0ZXN0QURQcm9wZXJ0eU5hbWVdID0gJyc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRkdWZmQURVc2VyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTW9jayBTZXQtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUmVwbGFjZS5Db250YWluc0tleSgkdGVzdEFEUHJvcGVydHlOYW1lKSB9IC1Nb2NrV2l0aCB7IH0KCiAgICAgICAgICAgICAgICBTZXQtVGFyZ2V0UmVzb3VyY2UgQHRlc3RQcmVzZW50UGFyYW1zIC1EZXNjcmlwdGlvbiAnTXkgY3VzdG9tIGRlc2NyaXB0aW9uJzsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBTZXQtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUmVwbGFjZS5Db250YWluc0tleSgkdGVzdEFEUHJvcGVydHlOYW1lKSB9IC1TY29wZSBJdCAtRXhhY3RseSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ2FsbHMgJ1NldC1BRFVzZXInIHdpdGggJ1JlbW92ZScgd2hlbiBuZXcgbWF0Y2hpbmcgQUQgcHJvcGVydHkgaXMgZW1wdHkiIHsKICAgICAgICAgICAgICAgICR0ZXN0QURQcm9wZXJ0eU5hbWUgPSAnRGVzY3JpcHRpb24nOwogICAgICAgICAgICAgICAgTW9jayBHZXQtQURVc2VyIHsKICAgICAgICAgICAgICAgICAgICAkZHVmZkFEVXNlciA9ICRmYWtlQURVc2VyLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJGR1ZmZBRFVzZXJbJHRlc3RBRFByb3BlcnR5TmFtZV0gPSAnSW5jb3JyZWN0IHBhcmFtZXRlciB2YWx1ZSc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRkdWZmQURVc2VyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTW9jayBTZXQtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUmVtb3ZlLkNvbnRhaW5zS2V5KCR0ZXN0QURQcm9wZXJ0eU5hbWUpIH0gLU1vY2tXaXRoIHsgfQoKICAgICAgICAgICAgICAgIFNldC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgLURlc2NyaXB0aW9uICcnOwoKICAgICAgICAgICAgICAgIEFzc2VydC1Nb2NrQ2FsbGVkIFNldC1BRFVzZXIgLVBhcmFtZXRlckZpbHRlciB7ICRSZW1vdmUuQ29udGFpbnNLZXkoJHRlc3RBRFByb3BlcnR5TmFtZSkgfSAtU2NvcGUgSXQgLUV4YWN0bHkgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNhbGxzICdTZXQtQURVc2VyJyB3aXRoICdSZXBsYWNlJyB3aGVuIGV4aXN0aW5nIG1pc21hdGNoZWQgQUQgcHJvcGVydHkgaXMgbnVsbCIgewogICAgICAgICAgICAgICAgJHRlc3RBRFByb3BlcnR5TmFtZSA9ICdUaXRsZSc7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1BRFVzZXIgewogICAgICAgICAgICAgICAgICAgICRkdWZmQURVc2VyID0gJGZha2VBRFVzZXIuQ2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkZHVmZkFEVXNlclskdGVzdEFEUHJvcGVydHlOYW1lXSA9ICRudWxsOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAkZHVmZkFEVXNlcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1vY2sgU2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFJlcGxhY2UuQ29udGFpbnNLZXkoJHRlc3RBRFByb3BlcnR5TmFtZSkgfSAtTW9ja1dpdGggeyB9CgogICAgICAgICAgICAgICAgU2V0LVRhcmdldFJlc291cmNlIEB0ZXN0UHJlc2VudFBhcmFtcyAtSm9iVGl0bGUgJ0dhZmZlcic7CgogICAgICAgICAgICAgICAgQXNzZXJ0LU1vY2tDYWxsZWQgU2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFJlcGxhY2UuQ29udGFpbnNLZXkoJHRlc3RBRFByb3BlcnR5TmFtZSkgfSAtU2NvcGUgSXQgLUV4YWN0bHkgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNhbGxzICdTZXQtQURVc2VyJyB3aXRoICdSZXBsYWNlJyB3aGVuIGV4aXN0aW5nIG1pc21hdGNoZWQgQUQgcHJvcGVydHkgaXMgZW1wdHkiIHsKICAgICAgICAgICAgICAgICR0ZXN0QURQcm9wZXJ0eU5hbWUgPSAnVGl0bGUnOwogICAgICAgICAgICAgICAgTW9jayBHZXQtQURVc2VyIHsKICAgICAgICAgICAgICAgICAgICAkZHVmZkFEVXNlciA9ICRmYWtlQURVc2VyLkNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJGR1ZmZBRFVzZXJbJHRlc3RBRFByb3BlcnR5TmFtZV0gPSAnJzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGR1ZmZBRFVzZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBNb2NrIFNldC1BRFVzZXIgLVBhcmFtZXRlckZpbHRlciB7ICRSZXBsYWNlLkNvbnRhaW5zS2V5KCR0ZXN0QURQcm9wZXJ0eU5hbWUpIH0gLU1vY2tXaXRoIHsgfQoKICAgICAgICAgICAgICAgIFNldC1UYXJnZXRSZXNvdXJjZSBAdGVzdFByZXNlbnRQYXJhbXMgLUpvYlRpdGxlICdHYWZmZXInOwoKICAgICAgICAgICAgICAgIEFzc2VydC1Nb2NrQ2FsbGVkIFNldC1BRFVzZXIgLVBhcmFtZXRlckZpbHRlciB7ICRSZXBsYWNlLkNvbnRhaW5zS2V5KCR0ZXN0QURQcm9wZXJ0eU5hbWUpIH0gLVNjb3BlIEl0IC1FeGFjdGx5IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDYWxscyAnU2V0LUFEVXNlcicgd2l0aCAnUmVtb3ZlJyB3aGVuIG5ldyBtaXNtYXRjaGVkIEFEIHByb3BlcnR5IGlzIGVtcHR5IiB7CiAgICAgICAgICAgICAgICAkdGVzdEFEUHJvcGVydHlOYW1lID0gJ1RpdGxlJzsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUFEVXNlciB7CiAgICAgICAgICAgICAgICAgICAgJGR1ZmZBRFVzZXIgPSAkZmFrZUFEVXNlci5DbG9uZSgpOwogICAgICAgICAgICAgICAgICAgICRkdWZmQURVc2VyWyR0ZXN0QURQcm9wZXJ0eU5hbWVdID0gJ0luY29ycmVjdCBqb2IgdGl0bGUnOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAkZHVmZkFEVXNlcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1vY2sgU2V0LUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJFJlbW92ZS5Db250YWluc0tleSgkdGVzdEFEUHJvcGVydHlOYW1lKSB9IC1Nb2NrV2l0aCB7IH0KCiAgICAgICAgICAgICAgICBTZXQtVGFyZ2V0UmVzb3VyY2UgQHRlc3RQcmVzZW50UGFyYW1zIC1Kb2JUaXRsZSAnJzsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBTZXQtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkUmVtb3ZlLkNvbnRhaW5zS2V5KCR0ZXN0QURQcm9wZXJ0eU5hbWUpIH0gLVNjb3BlIEl0IC1FeGFjdGx5IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDYWxscyAnUmVtb3ZlLUFEVXNlcicgd2hlbiAnRW5zdXJlJyBpcyAnQWJzZW50JyBhbmQgdXNlciBhY2NvdW50IGV4aXN0cyIgewogICAgICAgICAgICAgICAgTW9jayBHZXQtQURVc2VyIHsgcmV0dXJuIFtQU0N1c3RvbU9iamVjdF0gJGZha2VBRFVzZXI7IH0KICAgICAgICAgICAgICAgIE1vY2sgUmVtb3ZlLUFEVXNlciAtUGFyYW1ldGVyRmlsdGVyIHsgJElkZW50aXR5LlRvU3RyaW5nKCkgLWVxICR0ZXN0QWJzZW50UGFyYW1zLlVzZXJOYW1lIH0gLU1vY2tXaXRoIHsgfQoKICAgICAgICAgICAgICAgIFNldC1UYXJnZXRSZXNvdXJjZSBAdGVzdEFic2VudFBhcmFtczsKCiAgICAgICAgICAgICAgICBBc3NlcnQtTW9ja0NhbGxlZCBSZW1vdmUtQURVc2VyIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkSWRlbnRpdHkuVG9TdHJpbmcoKSAtZXEgJHRlc3RBYnNlbnRQYXJhbXMuVXNlck5hbWUgfSAtU2NvcGUgSXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgICNlbmRyZWdpb24KCiAgICAgICAgI3JlZ2lvbiBGdW5jdGlvbiBBc3NlcnQtVGFyZ2V0UmVzb3VyY2UKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcQXNzZXJ0LVBhcmFtZXRlcnMiIHsKCiAgICAgICAgICAgIEl0ICJEb2VzIG5vdCB0aHJvdyB3aGVuICdQYXNzd29yZE5ldmVyRXhwaXJlcycgYW5kICdDYW5ub3RDaGFuZ2VQYXNzd29yZCcgYXJlIHNwZWNpZmllZCIgewogICAgICAgICAgICAgICAgeyBBc3NlcnQtUGFyYW1ldGVycyAtUGFzc3dvcmROZXZlckV4cGlyZXMgJHRydWUgLUNhbm5vdENoYW5nZVBhc3N3b3JkICR0cnVlIH0gfCBTaG91bGQgTm90IFRocm93OwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiVGhyb3dzIHdoZW4gYWNjb3VudCBpcyBkaXNhYmxlZCBhbmQgJ1Bhc3N3b3JkJyBpcyBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgIHsgQXNzZXJ0LVBhcmFtZXRlcnMgLVBhc3N3b3JkICR0ZXN0Q3JlZGVudGlhbCAtRW5hYmxlZCAkZmFsc2UgfSB8IFNob3VsZCBUaHJvdzsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAgICAgI2VuZHJlZ2lvbgoKICAgIH0KICAgICNlbmRyZWdpb24KfQpmaW5hbGx5CnsKICAgICNyZWdpb24gRk9PVEVSCiAgICBSZXN0b3JlLVRlc3RFbnZpcm9ubWVudCAtVGVzdEVudmlyb25tZW50ICRUZXN0RW52aXJvbm1lbnQKICAgICNlbmRyZWdpb24KfQoK
