MSFT_FSRMClassificationRule.psm1,885d3f9cd7935077fa673a1d553a3ccc,Scan result is 1. IsMalware: 0,ZGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIC1TdHJpbmdEYXRhIEAnCkdldHRpbmdDbGFzc2lmaWNhdGlvblJ1bGVNZXNzYWdlPUdldHRpbmcgRlNSTSBDbGFzc2lmaWNhdGlvbiBSdWxlICJ7MH0iLgpDbGFzc2lmaWNhdGlvblJ1bGVFeGlzdHNNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBleGlzdHMuCkNsYXNzaWZpY2F0aW9uUnVsZURvZXNOb3RFeGlzdE1lc3NhZ2U9RlNSTSBDbGFzc2lmaWNhdGlvbiBSdWxlICJ7MH0iIGRvZXMgbm90IGV4aXN0LgpTZXR0aW5nQ2xhc3NpZmljYXRpb25SdWxlTWVzc2FnZT1TZXR0aW5nIEZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9Ii4KRW5zdXJlQ2xhc3NpZmljYXRpb25SdWxlRXhpc3RzTWVzc2FnZT1FbnN1cmluZyBGU1JNIENsYXNzaWZpY2F0aW9uIFJ1bGUgInswfSIgZXhpc3RzLgpFbnN1cmVDbGFzc2lmaWNhdGlvblJ1bGVEb2VzTm90RXhpc3RNZXNzYWdlPUVuc3VyaW5nIEZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBkb2VzIG5vdCBleGlzdC4KQ2xhc3NpZmljYXRpb25SdWxlQ3JlYXRlZE1lc3NhZ2U9RlNSTSBDbGFzc2lmaWNhdGlvbiBSdWxlICJ7MH0iIGhhcyBiZWVuIGNyZWF0ZWQuCkNsYXNzaWZpY2F0aW9uUnVsZVVwZGF0ZWRNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBoYXMgYmVlbiB1cGRhdGVkLgpDbGFzc2lmaWNhdGlvblJ1bGVSZWNyZWF0ZWRNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBoYXMgYmVlbiByZWNyZWF0ZWQuCkNsYXNzaWZpY2F0aW9uUnVsZVJlbW92ZWRNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBoYXMgYmVlbiByZW1vdmVkLgpUZXN0aW5nQ2xhc3NpZmljYXRpb25SdWxlTWVzc2FnZT1UZXN0aW5nIEZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9Ii4KQ2xhc3NpZmljYXRpb25SdWxlRXhpc3RzQW5kU2hvdWxkTWVzc2FnZT1GU1JNIENsYXNzaWZpY2F0aW9uIFJ1bGUgInswfSIgZXhpc3RzIGFuZCBzaG91bGQuCkNsYXNzaWZpY2F0aW9uUnVsZU5lZWRzVXBkYXRlTWVzc2FnZT1GU1JNIENsYXNzaWZpY2F0aW9uIFJ1bGUgInswfSIgezF9IGlzIGRpZmZlcmVudC4gQ2hhbmdlIHJlcXVpcmVkLgpDbGFzc2lmaWNhdGlvblJ1bGVEb2VzTm90RXhpc3RCdXRTaG91bGRNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBkb2VzIG5vdCBleGlzdCBidXQgc2hvdWxkLiBDaGFuZ2UgcmVxdWlyZWQuCkNsYXNzaWZpY2F0aW9uUnVsZUV4aXN0c0J1dFNob3VsZE5vdE1lc3NhZ2U9RlNSTSBDbGFzc2lmaWNhdGlvbiBSdWxlICJ7MH0iIGV4aXN0cyBidXQgc2hvdWxkIG5vdC4gQ2hhbmdlIHJlcXVpcmVkLgpDbGFzc2lmaWNhdGlvblJ1bGVEb2VzTm90RXhpc3RBbmRTaG91bGROb3RNZXNzYWdlPUZTUk0gQ2xhc3NpZmljYXRpb24gUnVsZSAiezB9IiBkb2VzIG5vdCBleGlzdCBhbmQgc2hvdWxkIG5vdC4gQ2hhbmdlIG5vdCByZXF1aXJlZC4KJ0AKfQoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZQogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICQoJExvY2FsaXplZERhdGEuR2V0dGluZ0NsYXNzaWZpY2F0aW9uUnVsZU1lc3NhZ2UpIGAKICAgICAgICAgICAgLWYgJE5hbWUKICAgICAgICApIC1qb2luICcnICkKCiAgICAkQ2xhc3NpZmljYXRpb25SdWxlID0gR2V0LUNsYXNzaWZpY2F0aW9uUnVsZSAtTmFtZSAkTmFtZQoKICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgTmFtZSA9ICROYW1lCiAgICB9CiAgICBpZiAoJENsYXNzaWZpY2F0aW9uUnVsZSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlRXhpc3RzTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgLWYgJE5hbWUKICAgICAgICAgICAgKSAtam9pbiAnJyApCgogICAgICAgICRyZXR1cm5WYWx1ZSArPSBAewogICAgICAgICAgICBFbnN1cmUgPSAnUHJlc2VudCcKICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAkQ2xhc3NpZmljYXRpb25SdWxlLkRlc2NyaXB0aW9uCiAgICAgICAgICAgIFByb3BlcnR5ID0gJENsYXNzaWZpY2F0aW9uUnVsZS5Qcm9wZXJ0eQogICAgICAgICAgICBQcm9wZXJ0eVZhbHVlID0gJENsYXNzaWZpY2F0aW9uUnVsZS5Qcm9wZXJ0eVZhbHVlCiAgICAgICAgICAgIENsYXNzaWZpY2F0aW9uTWVjaGFuaXNtID0gJENsYXNzaWZpY2F0aW9uUnVsZS5DbGFzc2lmaWNhdGlvbk1lY2hhbmlzbQogICAgICAgICAgICBDb250ZW50UmVndWxhckV4cHJlc3Npb24gPSAkQ2xhc3NpZmljYXRpb25SdWxlLkNvbnRlbnRSZWd1bGFyRXhwcmVzc2lvbgogICAgICAgICAgICBDb250ZW50U3RyaW5nID0gJENsYXNzaWZpY2F0aW9uUnVsZS5Db250ZW50U3RyaW5nCiAgICAgICAgICAgIENvbnRlbnRTdHJpbmdDYXNlU2Vuc2l0aXZlID0gJENsYXNzaWZpY2F0aW9uUnVsZS5Db250ZW50U3RyaW5nQ2FzZVNlbnNpdGl2ZQogICAgICAgICAgICBEaXNhYmxlZCA9ICRDbGFzc2lmaWNhdGlvblJ1bGUuRGlzYWJsZWQKICAgICAgICAgICAgRmxhZ3MgPSAkQ2xhc3NpZmljYXRpb25SdWxlLkZsYWdzCiAgICAgICAgICAgIFBhcmFtZXRlcnMgPSAkQ2xhc3NpZmljYXRpb25SdWxlLlBhcmFtZXRlcnMKICAgICAgICAgICAgTmFtZXNwYWNlID0gJENsYXNzaWZpY2F0aW9uUnVsZS5OYW1lc3BhY2UKICAgICAgICAgICAgUmVldmFsdWF0ZVByb3BlcnR5ID0gJENsYXNzaWZpY2F0aW9uUnVsZS5SZWV2YWx1YXRlUHJvcGVydHkKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkNsYXNzaWZpY2F0aW9uUnVsZURvZXNOb3RFeGlzdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICROYW1lCiAgICAgICAgICAgICkgLWpvaW4gJycgKQoKICAgICAgICAkcmV0dXJuVmFsdWUgKz0gQHsKICAgICAgICAgICAgRW5zdXJlID0gJ0Fic2VudCcKICAgICAgICB9CiAgICB9CgogICAgJHJldHVyblZhbHVlCn0gIyBHZXQtVGFyZ2V0UmVzb3VyY2UKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERlc2NyaXB0aW9uLAoKICAgICAgICBbVmFsaWRhdGVTZXQoJ1ByZXNlbnQnLCdBYnNlbnQnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gJ1ByZXNlbnQnLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUHJvcGVydHksCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRQcm9wZXJ0eVZhbHVlLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkQ2xhc3NpZmljYXRpb25NZWNoYW5pc20sCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nW11dCiAgICAgICAgJENvbnRlbnRSZWd1bGFyRXhwcmVzc2lvbiwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmdbXV0KICAgICAgICAkQ29udGVudFN0cmluZywKCiAgICAgICAgW1N5c3RlbS5TdHJpbmdbXV0KICAgICAgICAkQ29udGVudFN0cmluZ0Nhc2VTZW5zaXRpdmUsCgogICAgICAgIFtTeXN0ZW0uQm9vbGVhbl0KICAgICAgICAkRGlzYWJsZWQsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nW11dCiAgICAgICAgJEZsYWdzLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ1tdXQogICAgICAgICRQYXJhbWV0ZXJzLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ1tdXQogICAgICAgICROYW1lc3BhY2UsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnTmV2ZXInLCdPdmVyd3JpdGUnLCdBZ2dyZWdhdGUnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUmVldmFsdWF0ZVByb3BlcnR5CiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5TZXR0aW5nQ2xhc3NpZmljYXRpb25SdWxlTWVzc2FnZSkgYAogICAgICAgICAgICAtZiAkTmFtZQogICAgICAgICkgLWpvaW4gJycgKQoKICAgICMgUmVtb3ZlIGFueSBwYXJhbWV0ZXJzIHRoYXQgY2FuJ3QgYmUgc3BsYXR0ZWQuCiAgICAkbnVsbCA9ICRQU0JvdW5kUGFyYW1ldGVycy5SZW1vdmUoJ0Vuc3VyZScpCgogICAgIyBMb29rdXAgdGhlIGV4aXN0aW5nIENsYXNzaWZpY2F0aW9uIFJ1bGUKICAgICRDbGFzc2lmaWNhdGlvblJ1bGUgPSBHZXQtQ2xhc3NpZmljYXRpb25SdWxlIC1OYW1lICROYW1lCgogICAgaWYgKCRFbnN1cmUgLWVxICdQcmVzZW50JykKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuRW5zdXJlQ2xhc3NpZmljYXRpb25SdWxlRXhpc3RzTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgLWYgJE5hbWUKICAgICAgICAgICAgKSAtam9pbiAnJyApCgogICAgICAgIGlmICgkQ2xhc3NpZmljYXRpb25SdWxlKQogICAgICAgIHsKICAgICAgICAgICAgIyBUaGUgQ2xhc3NpZmljYXRpb24gUnVsZSBleGlzdHMKICAgICAgICAgICAgU2V0LUZTUk1DbGFzc2lmaWNhdGlvblJ1bGUgQFBTQm91bmRQYXJhbWV0ZXJzIC1FcnJvckFjdGlvbiBTdG9wCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVVcGRhdGVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICROYW1lCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgIyBDcmVhdGUgdGhlIENsYXNzaWZpY2F0aW9uIFJ1bGUKICAgICAgICAgICAgTmV3LUZTUk1DbGFzc2lmaWNhdGlvblJ1bGUgQFBTQm91bmRQYXJhbWV0ZXJzIC1FcnJvckFjdGlvbiBTdG9wCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVDcmVhdGVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICROYW1lCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkVuc3VyZUNsYXNzaWZpY2F0aW9uUnVsZURvZXNOb3RFeGlzdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICROYW1lCiAgICAgICAgICAgICkgLWpvaW4gJycgKQoKICAgICAgICBpZiAoJENsYXNzaWZpY2F0aW9uUnVsZSkKICAgICAgICB7CiAgICAgICAgICAgICMgVGhlIENsYXNzaWZpY2F0aW9uIFJ1bGUgc2hvdWxkbid0IGV4aXN0IC0gcmVtb3ZlIGl0CiAgICAgICAgICAgIFJlbW92ZS1GU1JNQ2xhc3NpZmljYXRpb25SdWxlIC1OYW1lICROYW1lIC1FcnJvckFjdGlvbiBTdG9wCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVSZW1vdmVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICROYW1lCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICB9ICMgaWYKICAgIH0gIyBpZgp9ICMgU2V0LVRhcmdldFJlc291cmNlCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJE5hbWUsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREZXNjcmlwdGlvbiwKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdQcmVzZW50JywnQWJzZW50JyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEVuc3VyZSA9ICdQcmVzZW50JywKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFByb3BlcnR5LAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUHJvcGVydHlWYWx1ZSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJENsYXNzaWZpY2F0aW9uTWVjaGFuaXNtLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ1tdXQogICAgICAgICRDb250ZW50UmVndWxhckV4cHJlc3Npb24sCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nW11dCiAgICAgICAgJENvbnRlbnRTdHJpbmcsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nW11dCiAgICAgICAgJENvbnRlbnRTdHJpbmdDYXNlU2Vuc2l0aXZlLAoKICAgICAgICBbU3lzdGVtLkJvb2xlYW5dCiAgICAgICAgJERpc2FibGVkLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ1tdXQogICAgICAgICRGbGFncywKCiAgICAgICAgW1N5c3RlbS5TdHJpbmdbXV0KICAgICAgICAkUGFyYW1ldGVycywKCiAgICAgICAgW1N5c3RlbS5TdHJpbmdbXV0KICAgICAgICAkTmFtZXNwYWNlLAoKICAgICAgICBbVmFsaWRhdGVTZXQoJ05ldmVyJywnT3ZlcndyaXRlJywnQWdncmVnYXRlJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFJlZXZhbHVhdGVQcm9wZXJ0eQogICAgKQogICAgIyBGbGFnIHRvIHNpZ25hbCB3aGV0aGVyIHNldHRpbmdzIGFyZSBjb3JyZWN0CiAgICBbQm9vbGVhbl0gJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkdHJ1ZQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICQoJExvY2FsaXplZERhdGEuVGVzdGluZ0NsYXNzaWZpY2F0aW9uUnVsZU1lc3NhZ2UpIGAKICAgICAgICAgICAgLWYgJE5hbWUKICAgICAgICApIC1qb2luICcnICkKCiAgICAjIExvb2t1cCB0aGUgZXhpc3RpbmcgQ2xhc3NpZmljYXRpb24gUnVsZQogICAgJENsYXNzaWZpY2F0aW9uUnVsZSA9IEdldC1DbGFzc2lmaWNhdGlvblJ1bGUgLU5hbWUgJE5hbWUKCiAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgewogICAgICAgICMgVGhlIENsYXNzaWZpY2F0aW9uIFJ1bGUgc2hvdWxkIGV4aXN0CiAgICAgICAgaWYgKCRDbGFzc2lmaWNhdGlvblJ1bGUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVFeGlzdHNBbmRTaG91bGRNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUKICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQoKICAgICAgICAgICAgIyBUaGUgQ2xhc3NpZmljYXRpb24gUnVsZSBleGlzdHMgYWxyZWFkeSAtIGNoZWNrIHRoZSBwYXJhbWV0ZXJzCiAgICAgICAgICAgIGlmICgoJERlc2NyaXB0aW9uKSAtYW5kICgkQ2xhc3NpZmljYXRpb25SdWxlLkRlc2NyaXB0aW9uIC1uZSAkRGVzY3JpcHRpb24pKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkNsYXNzaWZpY2F0aW9uUnVsZU5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkTmFtZSwnRGVzY3JpcHRpb24nCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRQcm9wZXJ0eSkgLWFuZCAoJENsYXNzaWZpY2F0aW9uUnVsZS5Qcm9wZXJ0eSAtbmUgJFByb3BlcnR5KSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUsJ1Byb3BlcnR5JwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkUHJvcGVydHlWYWx1ZSkgLWFuZCAoJENsYXNzaWZpY2F0aW9uUnVsZS5Qcm9wZXJ0eVZhbHVlIC1uZSAkUHJvcGVydHlWYWx1ZSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICROYW1lLCdQcm9wZXJ0eVZhbHVlJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkQ2xhc3NpZmljYXRpb25NZWNoYW5pc20pIGAKICAgICAgICAgICAgICAgIC1hbmQgKCRDbGFzc2lmaWNhdGlvblJ1bGUuQ2xhc3NpZmljYXRpb25NZWNoYW5pc20gLW5lICRDbGFzc2lmaWNhdGlvbk1lY2hhbmlzbSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICROYW1lLCdDbGFzc2lmaWNhdGlvbk1lY2hhbmlzbScKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJENvbnRlbnRSZWd1bGFyRXhwcmVzc2lvbikgYAogICAgICAgICAgICAgICAgLWFuZCAoQ29tcGFyZS1PYmplY3QgYAogICAgICAgICAgICAgICAgLVJlZmVyZW5jZU9iamVjdCAkQ29udGVudFJlZ3VsYXJFeHByZXNzaW9uIGAKICAgICAgICAgICAgICAgIC1EaWZmZXJlbmNlT2JqZWN0ICRDbGFzc2lmaWNhdGlvblJ1bGUuQ29udGVudFJlZ3VsYXJFeHByZXNzaW9uKS5Db3VudCAtbmUgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUsJ0NvbnRlbnRSZWd1bGFyRXhwcmVzc2lvbicKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJENvbnRlbnRTdHJpbmcpIGAKICAgICAgICAgICAgICAgIC1hbmQgKENvbXBhcmUtT2JqZWN0IGAKICAgICAgICAgICAgICAgIC1SZWZlcmVuY2VPYmplY3QgJENvbnRlbnRTdHJpbmcgYAogICAgICAgICAgICAgICAgLURpZmZlcmVuY2VPYmplY3QgJENsYXNzaWZpY2F0aW9uUnVsZS5Db250ZW50U3RyaW5nKS5Db3VudCAtbmUgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUsJ0NvbnRlbnRTdHJpbmcnCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRDb250ZW50U3RyaW5nQ2FzZVNlbnNpdGl2ZSkgYAogICAgICAgICAgICAgICAgLWFuZCAoQ29tcGFyZS1PYmplY3QgYAogICAgICAgICAgICAgICAgLVJlZmVyZW5jZU9iamVjdCAkQ29udGVudFN0cmluZ0Nhc2VTZW5zaXRpdmUgYAogICAgICAgICAgICAgICAgLURpZmZlcmVuY2VPYmplY3QgJENsYXNzaWZpY2F0aW9uUnVsZS5Db250ZW50U3RyaW5nQ2FzZVNlbnNpdGl2ZSkuQ291bnQgLW5lIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICROYW1lLCdDb250ZW50U3RyaW5nQ2FzZVNlbnNpdGl2ZScKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJERpc2FibGVkKSAtYW5kICgkQ2xhc3NpZmljYXRpb25SdWxlLkRpc2FibGVkIC1uZSAkRGlzYWJsZWQpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkNsYXNzaWZpY2F0aW9uUnVsZU5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkTmFtZSwnRGlzYWJsZWQnCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRGbGFncykgYAogICAgICAgICAgICAgICAgLWFuZCAoQ29tcGFyZS1PYmplY3QgYAogICAgICAgICAgICAgICAgLVJlZmVyZW5jZU9iamVjdCAkRmxhZ3MgYAogICAgICAgICAgICAgICAgLURpZmZlcmVuY2VPYmplY3QgKCRDbGFzc2lmaWNhdGlvblJ1bGUuRmxhZ3MsQCgpLDEgLW5lICRudWxsKVswXSkuQ291bnQgLW5lIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICROYW1lLCdGbGFncycKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJFBhcmFtZXRlcnMpIGAKICAgICAgICAgICAgICAgIC1hbmQgKENvbXBhcmUtT2JqZWN0IGAKICAgICAgICAgICAgICAgIC1SZWZlcmVuY2VPYmplY3QgJFBhcmFtZXRlcnMgYAogICAgICAgICAgICAgICAgLURpZmZlcmVuY2VPYmplY3QgKCRDbGFzc2lmaWNhdGlvblJ1bGUuUGFyYW1ldGVycyxAKCksMSAtbmUgJG51bGwpWzBdKS5Db3VudCAtbmUgMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUsJ1BhcmFtZXRlcnMnCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCROYW1lc3BhY2UpIGAKICAgICAgICAgICAgICAgIC1hbmQgKENvbXBhcmUtT2JqZWN0IGAKICAgICAgICAgICAgICAgIC1SZWZlcmVuY2VPYmplY3QgJE5hbWVzcGFjZSBgCiAgICAgICAgICAgICAgICAtRGlmZmVyZW5jZU9iamVjdCAkQ2xhc3NpZmljYXRpb25SdWxlLk5hbWVzcGFjZSkuQ291bnQgLW5lIDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICROYW1lLCdOYW1lc3BhY2UnCiAgICAgICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRSZWV2YWx1YXRlUHJvcGVydHkpIGAKICAgICAgICAgICAgICAgIC1hbmQgKCRDbGFzc2lmaWNhdGlvblJ1bGUuUmVldmFsdWF0ZVByb3BlcnR5IC1uZSAkUmVldmFsdWF0ZVByb3BlcnR5KSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVOZWVkc1VwZGF0ZU1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAgICAgLWYgJE5hbWUsJ1JlZXZhbHVhdGVQcm9wZXJ0eScKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgIyBUaHMgQ2xhc3NpZmljYXRpb24gUnVsZSBkb2Vzbid0IGV4aXN0IGJ1dCBzaG91bGQKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkNsYXNzaWZpY2F0aW9uUnVsZURvZXNOb3RFeGlzdEJ1dFNob3VsZE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAgJE5hbWUKICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICRmYWxzZQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAjIFRoZSBDbGFzc2lmaWNhdGlvbiBSdWxlIHNob3VsZCBub3QgZXhpc3QKICAgICAgICBpZiAoJENsYXNzaWZpY2F0aW9uUnVsZSkKICAgICAgICB7CiAgICAgICAgICAgICMgVGhlIENsYXNzaWZpY2F0aW9uIFJ1bGUgZXhpc3RzIGJ1dCBzaG91bGQgbm90CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5DbGFzc2lmaWNhdGlvblJ1bGVFeGlzdHNCdXRTaG91bGROb3RNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgLWYgICROYW1lCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgIyBUaGUgQ2xhc3NpZmljYXRpb24gUnVsZSBkb2VzIG5vdCBleGlzdCBhbmQgc2hvdWxkIG5vdAogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuQ2xhc3NpZmljYXRpb25SdWxlRG9lc05vdEV4aXN0QW5kU2hvdWxkTm90TWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICAkTmFtZQogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgfQogICAgfSAjIGlmCiAgICByZXR1cm4gJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2gKfSAjIFRlc3QtVGFyZ2V0UmVzb3VyY2UKCiMgSGVscGVyIEZ1bmN0aW9ucwoKRnVuY3Rpb24gR2V0LUNsYXNzaWZpY2F0aW9uUnVsZSB7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICROYW1lCiAgICApCiAgICB0cnkKICAgIHsKICAgICAgICAkQ2xhc3NpZmljYXRpb25SdWxlID0gR2V0LUZTUk1DbGFzc2lmaWNhdGlvblJ1bGUgLU5hbWUgJE5hbWUgLUVycm9yQWN0aW9uIFN0b3AKICAgIH0KICAgIGNhdGNoIFtNaWNyb3NvZnQuUG93ZXJTaGVsbC5DbWRsZXRpemF0aW9uLkNpbS5DaW1Kb2JFeGNlcHRpb25dCiAgICB7CiAgICAgICAgJENsYXNzaWZpY2F0aW9uUnVsZSA9ICRudWxsCiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIFRocm93ICRfCiAgICB9CiAgICBSZXR1cm4gJENsYXNzaWZpY2F0aW9uUnVsZQp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
