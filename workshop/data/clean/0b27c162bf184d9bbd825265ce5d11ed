Classes.ps1,2fcde2fc343672a9cf26fac1fbe539c5,Scan result is 1. IsMalware: 0,Y2xhc3MgTGFiT2JqZWN0IHsKfQoKY2xhc3MgTGFiT3BlcmF0aW9uU3lzdGVtIDogTGFiT2JqZWN0IHsKICAgIFtzdHJpbmddJE5hbWUKICAgIFtzdHJpbmddJEZpbGVQYXRoCiAgICBbc3RyaW5nXSRVbmF0dGVuZEZpbGVQYXRoCiAgICBbc3RyaW5nXSRQcm9kdWN0S2V5CiAgICBbTGFiRW52aXJvbm1lbnRdJEVudmlyb25tZW50CgogICAgW3N0cmluZ10gVG9TdHJpbmcoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy5OYW1lCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9NYWNoaW5lQ29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gQHsKICAgICAgICAgICAgTmFtZSA9ICR0aGlzLk5hbWUKICAgICAgICAgICAgRmlsZVBhdGggPSAkdGhpcy5GaWxlUGF0aAogICAgICAgICAgICBVbmF0dGVuZEZpbGVQYXRoID0gJHRoaXMuVW5hdHRlbmRGaWxlUGF0aAogICAgICAgICAgICAjUHJvZHVjdEtleSA9ICR0aGlzLlByb2R1Y3RLZXkKICAgICAgICB9CiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9IYXNodGFibGUoKSB7CiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgIE5hbWUgPSAkdGhpcy5OYW1lCiAgICAgICAgICAgIEZpbGVQYXRoID0gJHRoaXMuRmlsZVBhdGgKICAgICAgICAgICAgVW5hdHRlbmRGaWxlUGF0aCA9ICR0aGlzLlVuYXR0ZW5kRmlsZVBhdGgKICAgICAgICAgICAgUHJvZHVjdEtleSA9ICR0aGlzLlByb2R1Y3RLZXkKICAgICAgICB9CiAgICB9Cn0KCmNsYXNzIExhYkhhcmR3YXJlIDogTGFiT2JqZWN0IHsKICAgIFtzdHJpbmddJE5hbWUKICAgIFtpbnRdJFByb2Nlc3NvckNvdW50CiAgICBbbG9uZ10kU3RhcnR1cE1lbW9yeQogICAgW2xvbmddJE1pbmltdW1NZW1vcnkKICAgIFtsb25nXSRNYXhpbXVtTWVtb3J5CiAgICBbTGFiRW52aXJvbm1lbnRdJEVudmlyb25tZW50CgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLk5hbWUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVybiAkdGhpcy5Ub0hhc2h0YWJsZSgpCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9IYXNodGFibGUoKSB7CiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgIE5hbWUgPSAkdGhpcy5OYW1lCiAgICAgICAgICAgIFByb2Nlc3NvckNvdW50ID0gJHRoaXMuUHJvY2Vzc29yQ291bnQKICAgICAgICAgICAgU3RhcnR1cE1lbW9yeSA9ICR0aGlzLlN0YXJ0dXBNZW1vcnkKICAgICAgICAgICAgTWluaW11bU1lbW9yeSA9ICR0aGlzLk1pbmltdW1NZW1vcnkKICAgICAgICAgICAgTWF4aW11bU1lbW9yeSA9ICR0aGlzLk1heGltdW1NZW1vcnkKICAgICAgICB9CiAgICB9Cn0KCmNsYXNzIExhYkRvbWFpbiA6IExhYk9iamVjdCB7CiAgICBbc3RyaW5nXSROYW1lCiAgICBbc3RyaW5nXSROZXRiaW9zTmFtZQogICAgW1NlY3VyZVN0cmluZ10kQWRtaW5pc3RyYXRvclBhc3N3b3JkCiAgICBbTGFiRW52aXJvbm1lbnRdJEVudmlyb25tZW50CgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLk5hbWUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVybiBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgICAgICBOZXRiaW9zTmFtZSA9ICR0aGlzLk5ldGJpb3NOYW1lCiAgICAgICAgICAgIEFkbWluaXN0cmF0b3JQYXNzd29yZCA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlB0clRvU3RyaW5nQXV0byhbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTZWN1cmVTdHJpbmdUb0JTVFIoJHRoaXMuQWRtaW5pc3RyYXRvclBhc3N3b3JkKSkKICAgICAgICB9CiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9IYXNodGFibGUoKSB7CiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgIE5hbWUgPSAkdGhpcy5OYW1lCiAgICAgICAgICAgIE5ldGJpb3NOYW1lID0gJHRoaXMuTmV0Ymlvc05hbWUKICAgICAgICAgICAgQWRtaW5pc3RyYXRvclBhc3N3b3JkID0gJHRoaXMuQWRtaW5pc3RyYXRvclBhc3N3b3JkCiAgICAgICAgfQogICAgfQp9CgpjbGFzcyBMYWJEbnNTZXJ2ZXIgOiBMYWJPYmplY3QgewogICAgW3N0cmluZ10kSVBBZGRyZXNzCgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLklQQWRkcmVzcwogICAgfQoKICAgIFtIYXNodGFibGVdIFRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLlRvSGFzaHRhYmxlKCkKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb0hhc2h0YWJsZSgpIHsKICAgICAgICByZXR1cm4gQHsKICAgICAgICAgICAgSVBBZGRyZXNzID0gJHRoaXMuSVBBZGRyZXNzCiAgICAgICAgfQogICAgfQp9CgpjbGFzcyBMYWJEaGNwU2VydmVyIDogTGFiT2JqZWN0IHsKICAgIFtzdHJpbmddJElQQWRkcmVzcwogICAgW3N0cmluZ10kU2NvcGVOYW1lCiAgICBbc3RyaW5nXSRTY29wZUlkCiAgICBbc3RyaW5nXSRTdGFydFJhbmdlCiAgICBbc3RyaW5nXSRFbmRSYW5nZQogICAgW3N0cmluZ10kU3VibmV0TWFzawogICAgW2ludF0kTGVhc2VEdXJhdGlvbkRheXMKICAgIFtzdHJpbmddJERlZmF1bHRHYXRld2F5CgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLklQQWRkcmVzcwogICAgfQoKICAgIFtIYXNodGFibGVdIFRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLlRvSGFzaHRhYmxlKCkKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb0hhc2h0YWJsZSgpIHsKICAgICAgICByZXR1cm4gQHsKICAgICAgICAgICAgSVBBZGRyZXNzID0gJHRoaXMuSVBBZGRyZXNzCiAgICAgICAgICAgIFNjb3BlTmFtZSA9ICR0aGlzLlNjb3BlTmFtZQogICAgICAgICAgICBTY29wZUlkID0gJHRoaXMuU2NvcGVJZAogICAgICAgICAgICBTdGFydFJhbmdlID0gJHRoaXMuU3RhcnRSYW5nZQogICAgICAgICAgICBFbmRSYW5nZSA9ICR0aGlzLkVuZFJhbmdlCiAgICAgICAgICAgIFN1Ym5ldE1hc2sgPSAkdGhpcy5TdWJuZXRNYXNrCiAgICAgICAgICAgIExlYXNlRHVyYXRpb25EYXlzID0gJHRoaXMuTGVhc2VEdXJhdGlvbkRheXMKICAgICAgICAgICAgRGVmYXVsdEdhdGV3YXkgPSAkdGhpcy5EZWZhdWx0R2F0ZXdheQogICAgICAgIH0KICAgIH0KfQoKY2xhc3MgTGFiTmV0d29yayA6IExhYk9iamVjdCB7CiAgICBbc3RyaW5nXSROYW1lCiAgICBbc3RyaW5nXSRTd2l0Y2hOYW1lCiAgICBbc3RyaW5nXSRTd2l0Y2hUeXBlICAgICAgICAgICAgICAgICMgSW50ZXJuYWwsIEV4dGVybmFsCiAgICBbc3RyaW5nXSRTd2l0Y2hOZXRBZGFwdGVyTmFtZQogICAgW3N0cmluZ10kQWRkcmVzc0ZhbWlseSAgICAgICAgICAgICAjIElQVjQKICAgIFtpbnRdJFByZWZpeExlbmd0aAogICAgW3N0cmluZ10kSG9zdElQQWRkcmVzcwogICAgW0xhYkRvbWFpbl0kRG9tYWluCiAgICBbTGFiRG5zU2VydmVyXSREbnNTZXJ2ZXIKICAgIFtMYWJEaGNwU2VydmVyXSREaGNwU2VydmVyCiAgICBbTGFiRW52aXJvbm1lbnRdJEVudmlyb25tZW50CgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLk5hbWUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgICRoYXNodGFibGUgPSBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgICAgICBTd2l0Y2hOYW1lID0gJHRoaXMuU3dpdGNoTmFtZQogICAgICAgICAgICBTd2l0Y2hUeXBlID0gJHRoaXMuU3dpdGNoVHlwZQogICAgICAgICAgICBTd2l0Y2hOZXRBZGFwdGVyTmFtZSA9ICR0aGlzLlN3aXRjaE5ldEFkYXB0ZXJOYW1lCiAgICAgICAgICAgIEFkZHJlc3NGYW1pbHkgPSAkdGhpcy5BZGRyZXNzRmFtaWx5CiAgICAgICAgICAgIFByZWZpeExlbmd0aCA9ICR0aGlzLlByZWZpeExlbmd0aAogICAgICAgICAgICBIb3N0SVBBZGRyZXNzID0gJHRoaXMuSG9zdElQQWRkcmVzcwogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLkRvbWFpbikgewogICAgICAgICAgICAkaGFzaHRhYmxlLkRvbWFpbiA9ICR0aGlzLkRvbWFpbi5Ub01hY2hpbmVDb25maWd1cmF0aW9uKCkKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkRuc1NlcnZlcikgewogICAgICAgICAgICAkaGFzaHRhYmxlLkRuc1NlcnZlciA9ICR0aGlzLkRuc1NlcnZlci5Ub01hY2hpbmVDb25maWd1cmF0aW9uKCkKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkRoY3BTZXJ2ZXIpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5EaGNwU2VydmVyID0gJHRoaXMuRGhjcFNlcnZlci5Ub01hY2hpbmVDb25maWd1cmF0aW9uKCkKICAgICAgICB9CgogICAgICAgIHJldHVybiAkaGFzaHRhYmxlCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9IYXNodGFibGUoKSB7CiAgICAgICAgJGhhc2h0YWJsZSA9IEB7CiAgICAgICAgICAgIE5hbWUgPSAkdGhpcy5OYW1lCiAgICAgICAgICAgIFN3aXRjaE5hbWUgPSAkdGhpcy5Td2l0Y2hOYW1lCiAgICAgICAgICAgIFN3aXRjaFR5cGUgPSAkdGhpcy5Td2l0Y2hUeXBlCiAgICAgICAgICAgIFN3aXRjaE5ldEFkYXB0ZXJOYW1lID0gJHRoaXMuU3dpdGNoTmV0QWRhcHRlck5hbWUKICAgICAgICAgICAgQWRkcmVzc0ZhbWlseSA9ICR0aGlzLkFkZHJlc3NGYW1pbHkKICAgICAgICAgICAgUHJlZml4TGVuZ3RoID0gJHRoaXMuUHJlZml4TGVuZ3RoCiAgICAgICAgICAgIEhvc3RJUEFkZHJlc3MgPSAkdGhpcy5Ib3N0SVBBZGRyZXNzCiAgICAgICAgfQoKICAgICAgICBpZiAoJHRoaXMuRG9tYWluKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuRG9tYWluID0gJHRoaXMuRG9tYWluLlRvSGFzaHRhYmxlKCkKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkRuc1NlcnZlcikgewogICAgICAgICAgICAkaGFzaHRhYmxlLkRuc1NlcnZlciA9ICR0aGlzLkRuc1NlcnZlci5Ub0hhc2h0YWJsZSgpCiAgICAgICAgfQogICAgICAgIGlmICgkdGhpcy5EaGNwU2VydmVyKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuRGhjcFNlcnZlciA9ICR0aGlzLkRoY3BTZXJ2ZXIuVG9IYXNodGFibGUoKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRoYXNodGFibGUKICAgIH0KfQoKY2xhc3MgTGFiTmV0d29ya0FkYXB0ZXIgOiBMYWJPYmplY3QgewogICAgW0xhYk5ldHdvcmtdJE5ldHdvcmsKICAgIFtzdHJpbmddJFN0YXRpY01hY0FkZHJlc3MKICAgIFtzdHJpbmddJFN0YXRpY0lQQWRkcmVzcwoKICAgIFtIYXNodGFibGVdIFRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgJGhhc2h0YWJsZSA9IEB7CiAgICAgICAgICAgIFN0YXRpY01hY0FkZHJlc3MgPSAkdGhpcy5TdGF0aWNNYWNBZGRyZXNzCiAgICAgICAgICAgIFN0YXRpY0lQQWRkcmVzcyA9ICR0aGlzLlN0YXRpY0lQQWRkcmVzcwogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLk5ldHdvcmspIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5OZXR3b3JrID0gJHRoaXMuTmV0d29yay5Ub01hY2hpbmVDb25maWd1cmF0aW9uKCkKICAgICAgICB9CgogICAgICAgIHJldHVybiAkaGFzaHRhYmxlCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9IYXNodGFibGUoKSB7CiAgICAgICAgJGhhc2h0YWJsZSA9IEB7CiAgICAgICAgICAgIFN0YXRpY01hY0FkZHJlc3MgPSAkdGhpcy5TdGF0aWNNYWNBZGRyZXNzCiAgICAgICAgICAgIFN0YXRpY0lQQWRkcmVzcyA9ICR0aGlzLlN0YXRpY0lQQWRkcmVzcwogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLk5ldHdvcmspIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5OZXR3b3JrID0gJHRoaXMuTmV0d29yay5Ub0hhc2h0YWJsZSgpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGhhc2h0YWJsZQogICAgfQp9CgplbnVtIExhYkRpc2tUeXBlIHsKICAgIE9wZXJhdGluZ1N5c3RlbQogICAgSGFyZERpc2sKICAgIERWRERyaXZlCn0KCmNsYXNzIExhYkRpc2sgOiBMYWJPYmplY3QgewogICAgW0xhYkRpc2tUeXBlXSRUeXBlICAgICAgICAgICAgICAgICAgICAgICAgICMgb3B0aW9uYWw7IGF1dG9tYXRpY2FsbHkgc2V0IHdoZW4gT3BlcmF0aW5nU3lzdGVtLCBTaXplIChIYXJkRGlzaykgb3IgSW1hZ2VGaWxlUGF0aCAoRFZERHJpdmUpIGlzIHByb3ZpZGVkCiAgICBbTGFiT3BlcmF0aW9uU3lzdGVtXSRPcGVyYXRpbmdTeXN0ZW0gICAgICAgIyBvcHRpb25hbAogICAgW2Jvb2xdJERpZmZlcmVuY2luZ0Rpc2sgICAgICAgICAgICAgICAgICAgICMgb3B0aW9uYWw7IG9ubHkgdmFsaWQgZm9yIHR5cGUgT3BlcmF0aW5nU3lzdGVtLCBvdGhlcndpc2UgaWdub3JlZAogICAgW2Jvb2xdJFVzZUVudmlyb25tZW50Q29weSAgICAgICAgICAgICAgICAgICMgb3B0aW9uYWw7IG9ubHkgdmFsaWQgZm9yIHR5cGUgT3BlcmF0aW5nU3lzdGVtLCBvdGhlcndpc2UgaWdub3JlZAogICAgW2xvbmddJFNpemUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgbWFuZGF0b3J5IGZvciBUeXBlIEhhcmREaXNrLCBvdGhlcndpc2UgaWdub3JlZAogICAgW2Jvb2xdJFNoYXJlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3B0aW9uYWw7IG9ubHkgdmFsaWQgZm9yIHR5cGUgSGFyZERpc2ssIG90aGVyd2lzZSBpZ25vcmVkCiAgICBbc3RyaW5nXSRJbWFnZUZpbGVQYXRoICAgICAgICAgICAgICAgICAgICAgIyBvcHRpb25hbDsgb25seSB2YWxpZCBmb3IgdHlwZSBEVkREcml2ZSwgb3RoZXJ3aXNlIGlnbm9yZWQKCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgICRoYXNodGFibGUgPSBAewogICAgICAgICAgICBUeXBlID0gJHRoaXMuVHlwZQogICAgICAgICAgICBEaWZmZXJlbmNpbmdEaXNrID0gJHRoaXMuRGlmZmVyZW5jaW5nRGlzawogICAgICAgICAgICBVc2VFbnZpcm9ubWVudENvcHkgPSAkdGhpcy5Vc2VFbnZpcm9ubWVudENvcHkKICAgICAgICAgICAgU2l6ZSA9ICR0aGlzLlNpemUKICAgICAgICAgICAgU2hhcmVkID0gJHRoaXMuU2hhcmVkCiAgICAgICAgICAgIEltYWdlRmlsZVBhdGggPSAkdGhpcy5JbWFnZUZpbGVQYXRoCiAgICAgICAgfQoKICAgICAgICBpZiAoJHRoaXMuT3BlcmF0aW5nU3lzdGVtKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuT3BlcmF0aW5nU3lzdGVtID0gJHRoaXMuT3BlcmF0aW5nU3lzdGVtLlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRoYXNodGFibGUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb0hhc2h0YWJsZSgpIHsKICAgICAgICAkaGFzaHRhYmxlID0gQHsKICAgICAgICAgICAgVHlwZSA9ICR0aGlzLlR5cGUKICAgICAgICAgICAgRGlmZmVyZW5jaW5nRGlzayA9ICR0aGlzLkRpZmZlcmVuY2luZ0Rpc2sKICAgICAgICAgICAgVXNlRW52aXJvbm1lbnRDb3B5ID0gJHRoaXMuVXNlRW52aXJvbm1lbnRDb3B5CiAgICAgICAgICAgIFNpemUgPSAkdGhpcy5TaXplCiAgICAgICAgICAgIFNoYXJlZCA9ICR0aGlzLlNoYXJlZAogICAgICAgICAgICBJbWFnZUZpbGVQYXRoID0gJHRoaXMuSW1hZ2VGaWxlUGF0aAogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLk9wZXJhdGluZ1N5c3RlbSkgewogICAgICAgICAgICAkaGFzaHRhYmxlLk9wZXJhdGluZ1N5c3RlbSA9ICR0aGlzLk9wZXJhdGluZ1N5c3RlbS5Ub0hhc2h0YWJsZSgpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGhhc2h0YWJsZQogICAgfQp9CgpjbGFzcyBMYWJNYWNoaW5lIDogTGFiT2JqZWN0IHsKICAgIFtzdHJpbmddJE5hbWUKICAgIFtTZWN1cmVTdHJpbmddJEFkbWluaXN0cmF0b3JQYXNzd29yZAogICAgW3N0cmluZ10kVGltZVpvbmUKICAgIFtzdHJpbmdbXV0kUm9sZQogICAgW3N0cmluZ10kRmlsZXNQYXRoCiAgICBbSGFzaHRhYmxlXSRQcm9wZXJ0aWVzCiAgICBbSGFzaHRhYmxlXSRBbGxQcm9wZXJ0aWVzCiAgICBbTGFiSGFyZHdhcmVdJEhhcmR3YXJlCiAgICBbTGFiRGlza1tdXSREaXNrcwogICAgW0xhYk5ldHdvcmtBZGFwdGVyW11dJE5ldHdvcmtBZGFwdGVycwogICAgW0xhYkVudmlyb25tZW50XSRFbnZpcm9ubWVudAoKICAgIFtzdHJpbmddIFRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiAkdGhpcy5OYW1lCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9NYWNoaW5lQ29uZmlndXJhdGlvbigpIHsKICAgICAgICAkaGFzaHRhYmxlID0gQHsKICAgICAgICAgICAgTmFtZSA9ICR0aGlzLk5hbWUKICAgICAgICAgICAgQWRtaW5pc3RyYXRvclBhc3N3b3JkID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJpbmdBdXRvKFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlNlY3VyZVN0cmluZ1RvQlNUUigkdGhpcy5BZG1pbmlzdHJhdG9yUGFzc3dvcmQpKQogICAgICAgICAgICBUaW1lWm9uZSA9ICR0aGlzLlRpbWVab25lCiAgICAgICAgfQoKICAgICAgICBpZiAoJHRoaXMuUm9sZSkgewogICAgICAgICAgICAkaGFzaHRhYmxlLlJvbGUgPSBAKCR0aGlzLlJvbGUpCiAgICAgICAgfQogICAgICAgIGlmICgkdGhpcy5Qcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuUHJvcGVydGllcyA9ICR0aGlzLlByb3BlcnRpZXMKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkFsbFByb3BlcnRpZXMpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5BbGxQcm9wZXJ0aWVzID0gJHRoaXMuQWxsUHJvcGVydGllcwogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuSGFyZHdhcmUpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5IYXJkd2FyZSA9ICR0aGlzLkhhcmR3YXJlLlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKQogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuRGlza3MpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5EaXNrcyA9IEAoJHRoaXMuRGlza3MgfCBGb3JFYWNoLU9iamVjdCB7ICRfLlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKSB9KQogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuTmV0d29ya0FkYXB0ZXJzKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuTmV0d29ya0FkYXB0ZXJzID0gQCgkdGhpcy5OZXR3b3JrQWRhcHRlcnMgfCBGb3JFYWNoLU9iamVjdCB7ICRfLlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKSB9KQogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuRW52aXJvbm1lbnQpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5FbnZpcm9ubWVudCA9ICR0aGlzLkVudmlyb25tZW50LlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRoYXNodGFibGUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb0hhc2h0YWJsZSgpIHsKICAgICAgICA8IyRoYXNodGFibGUgPSBAe30KICAgICAgICAjIFZhbHVlVHlwZSAgICAgOiBhZGQga2V5L3ZhbHVlCiAgICAgICAgIyBIYXNodGFibGUgICAgIDogYWRkIGtleS92YWx1ZQogICAgICAgICMgY3VzdG9tLW9iamVjdCA6IGFkZCBrZXkvdmFsdWUuVG9IYXNodGFibGUoKQoKICAgICAgICAjIGV4Y2x1ZGUgcmVjdXJzaXZlIHByb3BlcnRpZXMKICAgICAgICBmb3JlYWNoICgkcHJvcGVydHkgaW4gJHRoaXMuUFNPYmplY3QuUHJvcGVydGllcykgewogICAgICAgICAgICAkdHlwZSA9IFtUeXBlXTo6R2V0VHlwZSgkcHJvcGVydHkuVHlwZU5hbWVPZlZhbHVlKQogICAgICAgICAgICBpZiAoJHR5cGUuSXNWYWx1ZVR5cGUgLW9yICR0eXBlLkZ1bGxOYW1lIC1lcSAnU3lzdGVtLlN0cmluZycpIHsKICAgICAgICAgICAgICAgICRoYXNodGFibGUuKCRwcm9wZXJ0eS5OYW1lKSA9ICQoJHRoaXMuKCRwcm9wZXJ0eS5OYW1lKSkKICAgICAgICAgICAgfQogICAgICAgIH0jPgoKICAgICAgICAkaGFzaHRhYmxlID0gQHsKICAgICAgICAgICAgTmFtZSA9ICR0aGlzLk5hbWUKICAgICAgICAgICAgQWRtaW5pc3RyYXRvclBhc3N3b3JkID0gJHRoaXMuQWRtaW5pc3RyYXRvclBhc3N3b3JkCiAgICAgICAgICAgIFRpbWVab25lID0gJHRoaXMuVGltZVpvbmUKICAgICAgICAgICAgRmlsZXNQYXRoID0gJHRoaXMuRmlsZXNQYXRoCiAgICAgICAgfQoKICAgICAgICBpZiAoJHRoaXMuUm9sZSkgewogICAgICAgICAgICAkaGFzaHRhYmxlLlJvbGUgPSBAKCR0aGlzLlJvbGUpCiAgICAgICAgfQogICAgICAgIGlmICgkdGhpcy5Qcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuUHJvcGVydGllcyA9ICR0aGlzLlByb3BlcnRpZXMKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkFsbFByb3BlcnRpZXMpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5BbGxQcm9wZXJ0aWVzID0gJHRoaXMuQWxsUHJvcGVydGllcwogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuSGFyZHdhcmUpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5IYXJkd2FyZSA9ICR0aGlzLkhhcmR3YXJlLlRvSGFzaHRhYmxlKCkKICAgICAgICB9CiAgICAgICAgaWYgKCR0aGlzLkRpc2tzKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuRGlza3MgPSBAKCR0aGlzLkRpc2tzIHwgRm9yRWFjaC1PYmplY3QgeyAkXy5Ub0hhc2h0YWJsZSgpIH0pCiAgICAgICAgfQogICAgICAgIGlmICgkdGhpcy5OZXR3b3JrQWRhcHRlcnMpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5OZXR3b3JrQWRhcHRlcnMgPSBAKCR0aGlzLk5ldHdvcmtBZGFwdGVycyB8IEZvckVhY2gtT2JqZWN0IHsgJF8uVG9IYXNodGFibGUoKSB9KQogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuRW52aXJvbm1lbnQpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5FbnZpcm9ubWVudCA9ICR0aGlzLkVudmlyb25tZW50LlRvSGFzaHRhYmxlKCkKICAgICAgICB9CgogICAgICAgIHJldHVybiAkaGFzaHRhYmxlCiAgICB9Cn0KCiNjbGFzcyBMYWJNYWNoaW5lVGVtcGxhdGUgOiBMYWJNYWNoaW5lIHsKI30KCmNsYXNzIExhYkhvc3RTaGFyZSA6IExhYk9iamVjdCB7CiAgICBbc3RyaW5nXSROYW1lCiAgICBbc3RyaW5nXSRQYXRoCiAgICBbc3RyaW5nXSREcml2ZUxldHRlcgogICAgW3N0cmluZ10kVXNlck5hbWUKICAgIFtTZWN1cmVTdHJpbmddJFBhc3N3b3JkCgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLk5hbWUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgICRoYXNodGFibGUgPSBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgICAgICBQYXRoID0gJHRoaXMuUGF0aAogICAgICAgICAgICBEcml2ZUxldHRlciA9ICR0aGlzLkRyaXZlTGV0dGVyCiAgICAgICAgICAgIFVzZXJOYW1lID0gJHRoaXMuVXNlck5hbWUKICAgICAgICB9CgogICAgICAgIGlmICgkdGhpcy5QYXNzd29yZCkgewogICAgICAgICAgICAkaGFzaHRhYmxlLlBhc3N3b3JkID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UHRyVG9TdHJpbmdBdXRvKFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OlNlY3VyZVN0cmluZ1RvQlNUUigkdGhpcy5QYXNzd29yZCkpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGhhc2h0YWJsZQogICAgfQoKICAgIFtIYXNodGFibGVdIFRvSGFzaHRhYmxlKCkgewogICAgICAgIHJldHVybiBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgICAgICBQYXRoID0gJHRoaXMuUGF0aAogICAgICAgICAgICBEcml2ZUxldHRlciA9ICR0aGlzLkRyaXZlTGV0dGVyCiAgICAgICAgICAgIFVzZXJOYW1lID0gJHRoaXMuVXNlck5hbWUKICAgICAgICAgICAgUGFzc3dvcmQgPSAkdGhpcy5QYXNzd29yZAogICAgICAgIH0KICAgIH0KfQoKY2xhc3MgTGFiSG9zdCA6IExhYk9iamVjdCB7CiAgICBbc3RyaW5nXSROYW1lCiAgICBbTGFiSG9zdFNoYXJlXSRTaGFyZQoKICAgIFtzdHJpbmddIFRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiAkdGhpcy5OYW1lCiAgICB9CgogICAgW0hhc2h0YWJsZV0gVG9NYWNoaW5lQ29uZmlndXJhdGlvbigpIHsKICAgICAgICAkaGFzaHRhYmxlID0gQHsKICAgICAgICAgICAgTmFtZSA9ICR0aGlzLk5hbWUKICAgICAgICB9CgogICAgICAgIGlmICgkdGhpcy5TaGFyZSkgewogICAgICAgICAgICAkaGFzaHRhYmxlLlNoYXJlID0gJHRoaXMuU2hhcmUuVG9NYWNoaW5lQ29uZmlndXJhdGlvbigpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGhhc2h0YWJsZQogICAgfQoKICAgIFtIYXNodGFibGVdIFRvSGFzaHRhYmxlKCkgewogICAgICAgICRoYXNodGFibGUgPSBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLlNoYXJlKSB7CiAgICAgICAgICAgICRoYXNodGFibGUuU2hhcmUgPSAkdGhpcy5TaGFyZS5Ub0hhc2h0YWJsZSgpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGhhc2h0YWJsZQogICAgfQp9CgpjbGFzcyBMYWJFbnZpcm9ubWVudCA6IExhYk9iamVjdCB7CiAgICBbc3RyaW5nXSROYW1lCiAgICBbc3RyaW5nXSRQYXRoCiAgICBbc3RyaW5nXSRNYWNoaW5lc1BhdGgKICAgIFtzdHJpbmddJEZpbGVzUGF0aAogICAgW3N0cmluZ10kQ29uZmlndXJhdGlvbkZpbGVQYXRoCiAgICBbc3RyaW5nXSRDb25maWd1cmF0aW9uTmFtZQogICAgW3N0cmluZ10kQ2VydGlmaWNhdGVGaWxlUGF0aAogICAgW3N0cmluZ10kQ2VydGlmaWNhdGVUaHVtYnByaW50CiAgICBbSGFzaHRhYmxlXSRQcm9wZXJ0aWVzCiAgICBbTGFiSG9zdF0kSG9zdAogICAgW0xhYkhhcmR3YXJlW11dJEhhcmR3YXJlCiAgICBbTGFiT3BlcmF0aW9uU3lzdGVtW11dJE9wZXJhdGluZ1N5c3RlbXMKICAgIFtMYWJEb21haW5bXV0kRG9tYWlucwogICAgW0xhYk5ldHdvcmtbXV0kTmV0d29ya3MKICAgIFtMYWJNYWNoaW5lW11dJE1hY2hpbmVzCgogICAgW3N0cmluZ10gVG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLk5hbWUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb01hY2hpbmVDb25maWd1cmF0aW9uKCkgewogICAgICAgICRoYXNodGFibGUgPSBAewogICAgICAgICAgICBOYW1lID0gJHRoaXMuTmFtZQogICAgICAgIH0KCiAgICAgICAgaWYgKCR0aGlzLlByb3BlcnRpZXMpIHsKICAgICAgICAgICAgJGhhc2h0YWJsZS5Qcm9wZXJ0aWVzID0gJHRoaXMuUHJvcGVydGllcwogICAgICAgIH0KICAgICAgICBpZiAoJHRoaXMuSG9zdCkgewogICAgICAgICAgICAkaGFzaHRhYmxlLkhvc3QgPSAkdGhpcy5Ib3N0LlRvTWFjaGluZUNvbmZpZ3VyYXRpb24oKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRoYXNodGFibGUKICAgIH0KCiAgICBbSGFzaHRhYmxlXSBUb0hhc2h0YWJsZSgpIHsKICAgICAgICAkaGFzaHRhYmxlID0gQHsKICAgICAgICAgICAgTmFtZSA9ICR0aGlzLk5hbWUKICAgICAgICAgICAgUGF0aCA9ICR0aGlzLlBhdGgKICAgICAgICAgICAgTWFjaGluZXNQYXRoID0gJHRoaXMuTWFjaGluZXNQYXRoCiAgICAgICAgICAgIEZpbGVzUGF0aCA9ICR0aGlzLkZpbGVzUGF0aAogICAgICAgICAgICBDb25maWd1cmF0aW9uRmlsZVBhdGggPSAkdGhpcy5Db25maWd1cmF0aW9uRmlsZVBhdGgKICAgICAgICAgICAgQ29uZmlndXJhdGlvbk5hbWUgPSAkdGhpcy5Db25maWd1cmF0aW9uTmFtZQogICAgICAgICAgICBDZXJ0aWZpY2F0ZUZpbGVQYXRoID0gJHRoaXMuQ2VydGlmaWNhdGVGaWxlUGF0aAogICAgICAgICAgICBDZXJ0aWZpY2F0ZVRodW1icHJpbnQgPSAkdGhpcy5DZXJ0aWZpY2F0ZVRodW1icHJpbnQKICAgICAgICAgICAgUHJvcGVydGllcyA9ICR0aGlzLlByb3BlcnRpZXMKICAgICAgICB9CgogICAgICAgIGlmICgkdGhpcy5Ib3N0KSB7CiAgICAgICAgICAgICRoYXNodGFibGUuSG9zdCA9ICR0aGlzLkhvc3QuVG9IYXNodGFibGUoKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRoYXNodGFibGUKICAgIH0KfQo=
