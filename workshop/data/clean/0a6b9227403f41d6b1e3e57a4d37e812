MSFT_xADCommon.Tests.ps1,77f5f007dca6a7c4bafa1b30fe3ff5b0,Scan result is 1. IsMalware: 0,W1N5c3RlbS5EaWFnbm9zdGljcy5Db2RlQW5hbHlzaXMuU3VwcHJlc3NNZXNzYWdlQXR0cmlidXRlKCdQU0F2b2lkVXNpbmdDb252ZXJ0VG9TZWN1cmVTdHJpbmdXaXRoUGxhaW5UZXh0JywgJycpXQpwYXJhbSgpCgokR2xvYmFsOkRTQ01vZHVsZU5hbWUgICAgICA9ICd4QWN0aXZlRGlyZWN0b3J5JyAjIEV4YW1wbGUgeE5ldHdvcmtpbmcKJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUgICAgPSAnTVNGVF94QURDb21tb24nICMgRXhhbXBsZSBNU0ZUX3hGaXJld2FsbAoKI3JlZ2lvbiBIRUFERVIKW1N0cmluZ10gJG1vZHVsZVJvb3QgPSBTcGxpdC1QYXRoIC1QYXJlbnQgKFNwbGl0LVBhdGggLVBhcmVudCAoU3BsaXQtUGF0aCAtUGFyZW50ICRTY3JpcHQ6TXlJbnZvY2F0aW9uLk15Q29tbWFuZC5QYXRoKSkKV3JpdGUtSG9zdCAkbW9kdWxlUm9vdCAtRm9yZWdyb3VuZENvbG9yIEdyZWVuOwppZiAoICgtbm90IChUZXN0LVBhdGggLVBhdGggKEpvaW4tUGF0aCAtUGF0aCAkbW9kdWxlUm9vdCAtQ2hpbGRQYXRoICdEU0NSZXNvdXJjZS5UZXN0cycpKSkgLW9yIGAKICAgICAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoIChKb2luLVBhdGggLVBhdGggJG1vZHVsZVJvb3QgLUNoaWxkUGF0aCAnRFNDUmVzb3VyY2UuVGVzdHNcVGVzdEhlbHBlci5wc20xJykpKSApCnsKICAgICYgZ2l0IEAoJ2Nsb25lJywnaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvRHNjUmVzb3VyY2UuVGVzdHMuZ2l0JywoSm9pbi1QYXRoIC1QYXRoICRtb2R1bGVSb290IC1DaGlsZFBhdGggJ1xEU0NSZXNvdXJjZS5UZXN0c1wnKSkKfQoKSW1wb3J0LU1vZHVsZSAoSm9pbi1QYXRoIC1QYXRoICRtb2R1bGVSb290IC1DaGlsZFBhdGggJ0RTQ1Jlc291cmNlLlRlc3RzXFRlc3RIZWxwZXIucHNtMScpIC1Gb3JjZQokVGVzdEVudmlyb25tZW50ID0gSW5pdGlhbGl6ZS1UZXN0RW52aXJvbm1lbnQgYAogICAgLURTQ01vZHVsZU5hbWUgJEdsb2JhbDpEU0NNb2R1bGVOYW1lIGAKICAgIC1EU0NSZXNvdXJjZU5hbWUgJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUgYAogICAgLVRlc3RUeXBlIFVuaXQKI2VuZHJlZ2lvbgoKIyBCZWdpbiBUZXN0aW5nCnRyeQp7CgogICAgI3JlZ2lvbiBQZXN0ZXIgVGVzdHMKCiAgICAjIFRoZSBJbk1vZHVsZVNjb3BlIGNvbW1hbmQgYWxsb3dzIHlvdSB0byBwZXJmb3JtIHdoaXRlLWJveCB1bml0IHRlc3Rpbmcgb24gdGhlIGludGVybmFsCiAgICAjIChub24tZXhwb3J0ZWQpIGNvZGUgb2YgYSBTY3JpcHQgTW9kdWxlLgogICAgSW5Nb2R1bGVTY29wZSAkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSB7CgogICAgICAgICNyZWdpb24gUGVzdGVyIFRlc3QgSW5pdGlhbGl6YXRpb24KCiAgICAgICAgI2VuZHJlZ2lvbgoKICAgICAgICAjcmVnaW9uIEZ1bmN0aW9uIFJlc29sdmVEb21haW5GUUROCiAgICAgICAgRGVzY3JpYmUgIiQoJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUpXFJlc29sdmUtRG9tYWluRlFETiIgewoKICAgICAgICAgICAgSXQgJ1JldHVybnMgIkRvbWFpbk5hbWUiIHdoZW4gIlBhcmVudERvbWFpbk5hbWUiIG5vdCBzdXBwbGllZCcgewogICAgICAgICAgICAgICAgJHRlc3REb21haW5OYW1lID0gJ2NvbnRvc28uY29tJzsKICAgICAgICAgICAgICAgICR0ZXN0UGFyZW50RG9tYWluTmFtZSA9ICRudWxsOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBSZXNvbHZlLURvbWFpbkZRRE4gLURvbWFpbk5hbWUgJHRlc3REb21haW5OYW1lIC1QYXJlbnREb21haW5OYW1lICR0ZXN0UGFyZW50RE9tYWluTmFtZTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0IHwgU2hvdWxkIEJlICR0ZXN0RG9tYWluTmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ1JldHVybnMgY29tcG91bmQgIkRvbWFpbk5hbWUuUGFyZW50RG9tYWluTmFtZSIgd2hlbiAiUGFyZW50RG9tYWluTmFtZSIgc3VwcGxpZWQnIHsKICAgICAgICAgICAgICAgICR0ZXN0RG9tYWluTmFtZSA9ICdzdWJkb21haW4nOwogICAgICAgICAgICAgICAgJHRlc3RQYXJlbnREb21haW5OYW1lID0gJ2NvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gUmVzb2x2ZS1Eb21haW5GUUROIC1Eb21haW5OYW1lICR0ZXN0RG9tYWluTmFtZSAtUGFyZW50RG9tYWluTmFtZSAkdGVzdFBhcmVudERvbWFpbk5hbWU7CgogICAgICAgICAgICAgICAgJHJlc3VsdCB8IFNob3VsZCBCZSAiJHRlc3REb21haW5OYW1lLiR0ZXN0UGFyZW50RG9tYWluTmFtZSI7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgICNlbmRyZWdpb24KCiAgICAgICAgI3JlZ2lvbiBGdW5jdGlvbiBUZXN0RG9tYWluTWVtYmVyCiAgICAgICAgRGVzY3JpYmUgIiQoJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUpXFRlc3QtRG9tYWluTWVtYmVyIiB7CgogICAgICAgICAgICBJdCAnUmV0dXJucyAiVHJ1ZSIgd2hlbiBkb21haW4gbWVtYmVyJyB7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1DaW1JbnN0YW5jZSB7IHJldHVybiBAeyBOYW1lID0gJGVudjpDT01QVVRFUk5BTUU7IFBhcnRPZkRvbWFpbiA9ICR0cnVlOyB9IH0KCiAgICAgICAgICAgICAgICBUZXN0LURvbWFpbk1lbWJlciB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ1JldHVybnMgIkZhbHNlIiB3aGVuIHdvcmtncm91cCBtZW1iZXInIHsKICAgICAgICAgICAgICAgIE1vY2sgR2V0LUNpbUluc3RhbmNlIHsgcmV0dXJuIEB7IE5hbWUgPSAkZW52OkNPTVBVVEVSTkFNRTsgfSB9CgogICAgICAgICAgICAgICAgVGVzdC1Eb21haW5NZW1iZXIgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gR2V0LURvbWFpbk5hbWUKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcR2V0LURvbWFpbk5hbWUiIHsKCiAgICAgICAgICAgIEl0ICdSZXR1cm5zIGV4ZXBlY3RlZCBkb21haW4gbmFtZScgewogICAgICAgICAgICAgICAgTW9jayBHZXQtQ2ltSW5zdGFuY2UgeyByZXR1cm4gQHsgTmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FOyBEb21haW4gPSAnY29udG9zby5jb20nOyB9IH0KCiAgICAgICAgICAgICAgICBHZXQtRG9tYWluTmFtZSB8IFNob3VsZCBCZSAnY29udG9zby5jb20nOwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gQXNzZXJ0LU1vZHVsZQogICAgICAgIERlc2NyaWJlICIkKCRHbG9iYWw6RFNDUmVzb3VyY2VOYW1lKVxBc3NlcnQtTW9kdWxlIiB7CgogICAgICAgICAgICBJdCAnRG9lcyBub3QgdGhyb3cgd2hlbiBtb2R1bGUgaXMgaW5zdGFsbGVkJyB7CiAgICAgICAgICAgICAgICAkdGVzdE1vZHVsZU5hbWUgPSAnVGVzdE1vZHVsZSc7CiAgICAgICAgICAgICAgICBNb2NrIEdldC1Nb2R1bGUgLVBhcmFtZXRlckZpbHRlciB7ICROYW1lIC1lcSAkdGVzdE1vZHVsZU5hbWUgfSB7IHJldHVybiAkdHJ1ZTsgfQoKICAgICAgICAgICAgICAgIHsgQXNzZXJ0LU1vZHVsZSAtTW9kdWxlTmFtZSAkdGVzdE1vZHVsZU5hbWUgfSB8IFNob3VsZCBOb3QgVGhyb3c7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdUaHJvd3Mgd2hlbiBtb2R1bGUgaXMgbm90IGluc3RhbGxlZCcgewogICAgICAgICAgICAgICAgJHRlc3RNb2R1bGVOYW1lID0gJ1Rlc3RNb2R1bGUnOwogICAgICAgICAgICAgICAgTW9jayBHZXQtTW9kdWxlIC1QYXJhbWV0ZXJGaWx0ZXIgeyAkTmFtZSAtZXEgJHRlc3RNb2R1bGVOYW1lIH0geyB9CgogICAgICAgICAgICAgICAgeyBBc3NlcnQtTW9kdWxlIC1Nb2R1bGVOYW1lICR0ZXN0TW9kdWxlTmFtZSB9IHwgU2hvdWxkIFRocm93OwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gQXNzZXJ0LU1vZHVsZQogICAgICAgIERlc2NyaWJlICIkKCRHbG9iYWw6RFNDUmVzb3VyY2VOYW1lKVxHZXQtQURPYmplY3RQYXJlbnRETiIgewoKICAgICAgICAgICAgSXQgIlJldHVybnMgQ04gb2JqZWN0IHBhcmVudCBwYXRoIiB7CiAgICAgICAgICAgICAgICBHZXQtQURPYmplY3RQYXJlbnRETiAtRE4gJ0NOPUFkbWluaXN0cmF0b3IsQ049VXNlcnMsREM9Y29udG9zbyxEQz1jb20nIHwgU2hvdWxkIEJlICdDTj1Vc2VycyxEQz1jb250b3NvLERDPWNvbSc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJSZXR1cm5zIE9VIG9iamVjdCBwYXJlbnQgcGF0aCIgewogICAgICAgICAgICAgICAgR2V0LUFET2JqZWN0UGFyZW50RE4gLUROICdDTj1BZG1pbmlzdHJhdG9yLE9VPUN1c3RvbSBPcmdhbml6YXRpb25hbCBVbml0LERDPWNvbnRvc28sREM9Y29tJyB8IFNob3VsZCBCZSAnT1U9Q3VzdG9tIE9yZ2FuaXphdGlvbmFsIFVuaXQsREM9Y29udG9zbyxEQz1jb20nOwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gUmVtb3ZlLUR1cGxpY2F0ZU1lbWJlcnMKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcUmVtb3ZlLUR1cGxpY2F0ZU1lbWJlcnMiIHsKCiAgICAgICAgICAgIEl0ICdSZW1vdmVzIG9uZSBkdXBsaWNhdGUnIHsKICAgICAgICAgICAgICAgICRtZW1iZXJzID0gUmVtb3ZlLUR1cGxpY2F0ZU1lbWJlcnMgLU1lbWJlcnMgJ1VzZXIxJywnVXNlcjInLCdVU0VSMSc7CgogICAgICAgICAgICAgICAgJG1lbWJlcnMuQ291bnQgfCBTaG91bGQgQmUgMjsKICAgICAgICAgICAgICAgICRtZW1iZXJzIC1jb250YWlucyAnVXNlcjEnIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICAgICAgJG1lbWJlcnMgLWNvbnRhaW5zICdVc2VyMicgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdSZW1vdmVzIHR3byBkdXBsaWNhdGVzJyB7CiAgICAgICAgICAgICAgICAkbWVtYmVycyA9IFJlbW92ZS1EdXBsaWNhdGVNZW1iZXJzIC1NZW1iZXJzICdVc2VyMScsJ1VzZXIyJywnVVNFUjEnLCdVU0VSMic7CgogICAgICAgICAgICAgICAgJG1lbWJlcnMuQ291bnQgfCBTaG91bGQgQmUgMjsKICAgICAgICAgICAgICAgICRtZW1iZXJzIC1jb250YWlucyAnVXNlcjEnIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICAgICAgJG1lbWJlcnMgLWNvbnRhaW5zICdVc2VyMicgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdSZW1vdmVzIGRvdWJsZSBkdXBsaWNhdGVzJyB7CiAgICAgICAgICAgICAgICAkbWVtYmVycyA9IFJlbW92ZS1EdXBsaWNhdGVNZW1iZXJzIC1NZW1iZXJzICdVc2VyMScsJ1VzZXIyJywnVVNFUjEnLCd1c2VyMSc7CgogICAgICAgICAgICAgICAgJG1lbWJlcnMuQ291bnQgfCBTaG91bGQgQmUgMjsKICAgICAgICAgICAgICAgICRtZW1iZXJzIC1jb250YWlucyAnVXNlcjEnIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICAgICAgJG1lbWJlcnMgLWNvbnRhaW5zICdVc2VyMicgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgICNlbmRyZWdpb24KCiAgICAgICAgI3JlZ2lvbiBGdW5jdGlvbiBUZXN0LU1lbWJlcnMKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcVGVzdC1NZW1iZXJzIiB7CgogICAgICAgICAgICBJdCAnUGFzc2VzIHdoZW4gbm90aGluZyBpcyBwYXNzZWQnIHsKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICRudWxsIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAnUGFzc2VzIHdoZW4gdGhlcmUgYXJlIGV4aXN0aW5nIG1lbWJlcnMgYnV0IG1lbWJlcnMgYXJlIHJlcXVpcmVkJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJyk7CgogICAgICAgICAgICAgICAgVGVzdC1NZW1iZXJzIC1FeGlzdGluZ01lbWJlcnMgJHRlc3RFeGlzdGluZ01lbWJlcnMgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdQYXNzZXMgd2hlbiBleGlzdGluZyBtZW1iZXJzIG1hdGNoIHJlcXVpcmVkIG1lbWJlcnMnIHsKICAgICAgICAgICAgICAgICR0ZXN0RXhpc3RpbmdNZW1iZXJzID0gQCgnVVNFUjEnLCAnVVNFUjInKTsKICAgICAgICAgICAgICAgICR0ZXN0TWVtYmVycyA9IEAoJ1VTRVIyJywgJ1VTRVIxJyk7CgogICAgICAgICAgICAgICAgVGVzdC1NZW1iZXJzIC1FeGlzdGluZ01lbWJlcnMgJHRlc3RFeGlzdGluZ01lbWJlcnMgLU1lbWJlcnMgJHRlc3RNZW1iZXJzIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAnRmFpbHMgd2hlbiB0aGVyZSBhcmUgbm8gZXhpc3RpbmcgbWVtYmVycyBhbmQgbWVtYmVycyBhcmUgcmVxdWlyZWQnIHsKICAgICAgICAgICAgICAgICR0ZXN0RXhpc3RpbmdNZW1iZXJzID0gQCgnVVNFUjEnLCAnVVNFUjInKTsKICAgICAgICAgICAgICAgICR0ZXN0TWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIzJyk7CgogICAgICAgICAgICAgICAgVGVzdC1NZW1iZXJzIC1FeGlzdGluZ01lbWJlcnMgJG51bGwgLU1lbWJlcnMgJHRlc3RNZW1iZXJzIHwgU2hvdWxkIEJlICRmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ0ZhaWxzIHdoZW4gdGhlcmUgYXJlIG1vcmUgZXhpc3RpbmcgbWVtYmVycyB0aGFuIHRoZSBtZW1iZXJzIHJlcXVpcmVkJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJywgJ1VTRVIzJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnMgPSBAKCdVU0VSMScsICdVU0VSMycpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICRudWxsIC1NZW1iZXJzICR0ZXN0TWVtYmVycyB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdGYWlscyB3aGVuIHRoZXJlIGFyZSBtb3JlIGV4aXN0aW5nIG1lbWJlcnMgdGhhbiB0aGUgbWVtYmVycyByZXF1aXJlZCcgewogICAgICAgICAgICAgICAgJHRlc3RFeGlzdGluZ01lbWJlcnMgPSBAKCdVU0VSMScsICdVU0VSMicpOwogICAgICAgICAgICAgICAgJHRlc3RNZW1iZXJzID0gQCgnVVNFUjEnLCAnVVNFUjMnLCAnVVNFUjInKTsKCiAgICAgICAgICAgICAgICBUZXN0LU1lbWJlcnMgLUV4aXN0aW5nTWVtYmVycyAkbnVsbCAtTWVtYmVycyAkdGVzdE1lbWJlcnMgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAnRmFpbHMgd2hlbiBleGlzdGluZyBtZW1iZXJzIGRvIG5vdCBtYXRjaCByZXF1aXJlZCBtZW1iZXJzJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnMgPSBAKCdVU0VSMScsICdVU0VSMycpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzICR0ZXN0TWVtYmVycyB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdQYXNzZXMgd2hlbiBleGlzdGluZyBtZW1iZXJzIGluY2x1ZGUgcmVxdWlyZWQgbWVtYmVyJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgPSBAKCdVU0VSMicpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzVG9JbmNsdWRlICR0ZXN0TWVtYmVyc1RvSW5jbHVkZSB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ1Bhc3NlcyB3aGVuIGV4aXN0aW5nIG1lbWJlcnMgaW5jbHVkZSByZXF1aXJlZCBtZW1iZXJzJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgPSBAKCdVU0VSMicsICdVU0VSMScpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzVG9JbmNsdWRlICR0ZXN0TWVtYmVyc1RvSW5jbHVkZSB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ0ZhaWxzIHdoZW4gZXhpc3RpbmcgbWVtYmVycyBpcyBtaXNzaW5nIGEgcmVxdWlyZWQgbWVtYmVyJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgPSBAKCdVU0VSMicpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzVG9JbmNsdWRlICR0ZXN0TWVtYmVyc1RvSW5jbHVkZSB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdGYWlscyB3aGVuIGV4aXN0aW5nIG1lbWJlcnMgaXMgbWlzc2luZyBhIHJlcXVpcmVkIG1lbWJlcicgewogICAgICAgICAgICAgICAgJHRlc3RFeGlzdGluZ01lbWJlcnMgPSBAKCdVU0VSMScsICdVU0VSMycpOwogICAgICAgICAgICAgICAgJHRlc3RNZW1iZXJzVG9JbmNsdWRlID0gQCgnVVNFUjInKTsKCiAgICAgICAgICAgICAgICBUZXN0LU1lbWJlcnMgLUV4aXN0aW5nTWVtYmVycyAkdGVzdEV4aXN0aW5nTWVtYmVycyAtTWVtYmVyc1RvSW5jbHVkZSAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAnRmFpbHMgd2hlbiBleGlzdGluZyBtZW1iZXJzIGlzIG1pc3NpbmcgYSByZXF1aXJlZCBtZW1iZXJzJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIzJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgPSBAKCdVU0VSMScsICdVU0VSMicpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzVG9JbmNsdWRlICR0ZXN0TWVtYmVyc1RvSW5jbHVkZSB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdQYXNzZXMgd2hlbiBleGlzdGluZyBtZW1iZXIgZG9lcyBub3QgaW5jbHVkZSBleGNsdWRlZCBtZW1iZXInIHsKICAgICAgICAgICAgICAgICR0ZXN0RXhpc3RpbmdNZW1iZXJzID0gQCgnVVNFUjEnKTsKICAgICAgICAgICAgICAgICR0ZXN0TWVtYmVyc1RvRXhjbHVkZSA9IEAoJ1VTRVIyJyk7CgogICAgICAgICAgICAgICAgVGVzdC1NZW1iZXJzIC1FeGlzdGluZ01lbWJlcnMgJHRlc3RFeGlzdGluZ01lbWJlcnMgLU1lbWJlcnNUb0V4Y2x1ZGUgJHRlc3RNZW1iZXJzVG9JbmNsdWRlIHwgU2hvdWxkIEJlICR0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAnUGFzc2VzIHdoZW4gZXhpc3RpbmcgbWVtYmVyIGRvZXMgbm90IGluY2x1ZGUgZXhjbHVkZWQgbWVtYmVycycgewogICAgICAgICAgICAgICAgJHRlc3RFeGlzdGluZ01lbWJlcnMgPSBAKCdVU0VSMScpOwogICAgICAgICAgICAgICAgJHRlc3RNZW1iZXJzVG9FeGNsdWRlID0gQCgnVVNFUjInLCAnVVNFUjMnKTsKCiAgICAgICAgICAgICAgICBUZXN0LU1lbWJlcnMgLUV4aXN0aW5nTWVtYmVycyAkdGVzdEV4aXN0aW5nTWVtYmVycyAtTWVtYmVyc1RvRXhjbHVkZSAkdGVzdE1lbWJlcnNUb0luY2x1ZGUgfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICdQYXNzZXMgd2hlbiBleGlzdGluZyBtZW1iZXJzIGRvZXMgbm90IGluY2x1ZGUgZXhjbHVkZWQgbWVtYmVyJyB7CiAgICAgICAgICAgICAgICAkdGVzdEV4aXN0aW5nTWVtYmVycyA9IEAoJ1VTRVIxJywgJ1VTRVIyJyk7CiAgICAgICAgICAgICAgICAkdGVzdE1lbWJlcnNUb0V4Y2x1ZGUgPSBAKCdVU0VSMycpOwoKICAgICAgICAgICAgICAgIFRlc3QtTWVtYmVycyAtRXhpc3RpbmdNZW1iZXJzICR0ZXN0RXhpc3RpbmdNZW1iZXJzIC1NZW1iZXJzVG9FeGNsdWRlICR0ZXN0TWVtYmVyc1RvSW5jbHVkZSB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gQXNzZXJ0LU1lbWJlclBhcmFtZXRlcnMKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcQXNzZXJ0LU1lbWJlclBhcmFtZXRlcnMiIHsKCiAgICAgICAgICAgIEl0ICJUaHJvd3MgaWYgJ01lbWJlcnMnIGlzIHNwZWNpZmllZCBidXQgaXMgZW1wdHkiIHsKICAgICAgICAgICAgICAgIHsgQXNzZXJ0LU1lbWJlclBhcmFtZXRlcnMgLU1lbWJlcnMgQCgpIH0gfCBTaG91bGQgVGhyb3cgJ1RoZSBNZW1iZXJzIHBhcmFtZXRlciB2YWx1ZSBpcyBudWxsJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlRocm93cyBpZiAnTWVtYmVycycgYW5kICdNZW1iZXJzVG9JbmNsdWRlJyBhcmUgc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICB7IEFzc2VydC1NZW1iZXJQYXJhbWV0ZXJzIC1NZW1iZXJzIEAoJ1VzZXIxJykgLU1lbWJlcnNUb0luY2x1ZGUgQCgnVXNlcjEnKSB9IHwgU2hvdWxkIFRocm93ICdwYXJhbWV0ZXJzIGNvbmZsaWN0JzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlRocm93cyBpZiAnTWVtYmVycycgYW5kICdNZW1iZXJzVG9FeGNsdWRlJyBhcmUgc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICB7IEFzc2VydC1NZW1iZXJQYXJhbWV0ZXJzIC1NZW1iZXJzIEAoJ1VzZXIxJykgLU1lbWJlcnNUb0V4Y2x1ZGUgQCgnVXNlcjInKSB9IHwgU2hvdWxkIFRocm93ICdwYXJhbWV0ZXJzIGNvbmZsaWN0JzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlRocm93cyBpZiAnTWVtYmVyc1RvSW5jbHVkZScgYW5kICdNZW1iZXJzVG9FeGNsdWRlJyBjb250YWluIHRoZSBzYW1lIG1lbWJlciIgewogICAgICAgICAgICAgICAgeyBBc3NlcnQtTWVtYmVyUGFyYW1ldGVycyAtTWVtYmVyc1RvRXhjbHVkZSBAKCd1c2VyMScpIC1NZW1iZXJzVG9JbmNsdWRlIEAoJ1VTRVIxJykgfSB8IFNob3VsZCBUaHJvdyAnbWVtYmVyIG11c3Qgbm90IGJlIGluY2x1ZGVkIGluIGJvdGgnOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiVGhyb3dzIGlmICdNZW1iZXJzVG9JbmNsdWRlJyBhbmQgJ01lbWJlcnNUb0V4Y2x1ZGUnIGFyZSBlbXB0eSIgewogICAgICAgICAgICAgICAgeyBBc3NlcnQtTWVtYmVyUGFyYW1ldGVycyAtTWVtYmVyc1RvRXhjbHVkZSBAKCkgLU1lbWJlcnNUb0luY2x1ZGUgQCgpIH0gfCBTaG91bGQgVGhyb3cgJ0F0IGxlYXN0IG9uZSBtZW1iZXIgbXVzdCBiZSBzcGVjaWZpZWQnOwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgICAgICNyZWdpb24gRnVuY3Rpb24gQ29udmVydFRvLVRpbWVzcGFuCiAgICAgICAgRGVzY3JpYmUgIiQoJEdsb2JhbDpEU0NSZXNvdXJjZU5hbWUpXENvbnZlcnRUby1UaW1lc3BhbiIgewoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ1N5c3RlbS5UaW1lU3Bhbicgb2JqZWN0IHR5cGUiIHsKICAgICAgICAgICAgICAgICR0ZXN0SW50VGltZVNwYW4gPSA2MDsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ29udmVydFRvLVRpbWVTcGFuIC1UaW1lU3BhbiAkdGVzdEludFRpbWVTcGFuIC1UaW1lU3BhblR5cGUgTWludXRlczsKCiAgICAgICAgICAgICAgICAkcmVzdWx0IC1pcyBbU3lzdGVtLlRpbWVTcGFuXSB8IFNob3VsZCBCZSAkdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNyZWF0ZXMgVGltZVNwYW4gZnJvbSBzZWNvbmRzIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbnZlcnRUby1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RJbnRUaW1lU3BhbiAtVGltZVNwYW5UeXBlIFNlY29uZHM7CgogICAgICAgICAgICAgICAgJHJlc3VsdC5Ub3RhbFNlY29uZHMgfCBTaG91bGQgQmUgJHRlc3RJbnRUaW1lU3BhbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNyZWF0ZXMgVGltZVNwYW4gZnJvbSBtaW51dGVzIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbnZlcnRUby1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RJbnRUaW1lU3BhbiAtVGltZVNwYW5UeXBlIE1pbnV0ZXM7CgogICAgICAgICAgICAgICAgJHJlc3VsdC5Ub3RhbE1pbnV0ZXMgfCBTaG91bGQgQmUgJHRlc3RJbnRUaW1lU3BhbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNyZWF0ZXMgVGltZVNwYW4gZnJvbSBob3VycyIgewogICAgICAgICAgICAgICAgJHRlc3RJbnRUaW1lU3BhbiA9IDYwOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDb252ZXJ0VG8tVGltZVNwYW4gLVRpbWVTcGFuICR0ZXN0SW50VGltZVNwYW4gLVRpbWVTcGFuVHlwZSBIb3VyczsKCiAgICAgICAgICAgICAgICAkcmVzdWx0LlRvdGFsSG91cnMgfCBTaG91bGQgQmUgJHRlc3RJbnRUaW1lU3BhbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNyZWF0ZXMgVGltZVNwYW4gZnJvbSBkYXlzIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbnZlcnRUby1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RJbnRUaW1lU3BhbiAtVGltZVNwYW5UeXBlIERheXM7CgogICAgICAgICAgICAgICAgJHJlc3VsdC5Ub3RhbERheXMgfCBTaG91bGQgQmUgJHRlc3RJbnRUaW1lU3BhbjsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAgICAgI2VuZHJlZ2lvbgoKICAgICAgICAjcmVnaW9uIEZ1bmN0aW9uIENvbnZlcnRUby1UaW1lc3BhbgogICAgICAgIERlc2NyaWJlICIkKCRHbG9iYWw6RFNDUmVzb3VyY2VOYW1lKVxDb252ZXJ0RnJvbS1UaW1lc3BhbiIgewoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ1N5c3RlbS5VSW50MzInIG9iamVjdCB0eXBlIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CiAgICAgICAgICAgICAgICAkdGVzdFRpbWVTcGFuID0gTmV3LVRpbWVTcGFuIC1TZWNvbmRzICR0ZXN0SW50VGltZVNwYW47CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbnZlcnRGcm9tLVRpbWVTcGFuIC1UaW1lU3BhbiAkdGVzdFRpbWVTcGFuIC1UaW1lU3BhblR5cGUgU2Vjb25kczsKCiAgICAgICAgICAgICAgICAkcmVzdWx0IC1pcyBbU3lzdGVtLlVJbnQzMl0gfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDb252ZXJ0cyBUaW1lU3BhbiB0byB0b3RhbCBzZWNvbmRzIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CiAgICAgICAgICAgICAgICAkdGVzdFRpbWVTcGFuID0gTmV3LVRpbWVTcGFuIC1TZWNvbmRzICR0ZXN0SW50VGltZVNwYW47CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbnZlcnRGcm9tLVRpbWVTcGFuIC1UaW1lU3BhbiAkdGVzdFRpbWVTcGFuIC1UaW1lU3BhblR5cGUgU2Vjb25kczsKCiAgICAgICAgICAgICAgICAkcmVzdWx0IHwgU2hvdWxkIEJlICR0ZXN0VGltZVNwYW4uVG90YWxTZWNvbmRzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ29udmVydHMgVGltZVNwYW4gdG8gdG90YWwgbWludXRlcyIgewogICAgICAgICAgICAgICAgJHRlc3RJbnRUaW1lU3BhbiA9IDYwOwogICAgICAgICAgICAgICAgJHRlc3RUaW1lU3BhbiA9IE5ldy1UaW1lU3BhbiAtTWludXRlcyAkdGVzdEludFRpbWVTcGFuOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDb252ZXJ0RnJvbS1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RUaW1lU3BhbiAtVGltZVNwYW5UeXBlIE1pbnV0ZXM7CgogICAgICAgICAgICAgICAgJHJlc3VsdCB8IFNob3VsZCBCZSAkdGVzdFRpbWVTcGFuLlRvdGFsTWludXRlczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIkNvbnZlcnRzIFRpbWVTcGFuIHRvIHRvdGFsIGhvdXJzIiB7CiAgICAgICAgICAgICAgICAkdGVzdEludFRpbWVTcGFuID0gNjA7CiAgICAgICAgICAgICAgICAkdGVzdFRpbWVTcGFuID0gTmV3LVRpbWVTcGFuIC1Ib3VycyAkdGVzdEludFRpbWVTcGFuOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDb252ZXJ0RnJvbS1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RUaW1lU3BhbiAtVGltZVNwYW5UeXBlIEhvdXJzOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgfCBTaG91bGQgQmUgJHRlc3RUaW1lU3Bhbi5Ub3RhbEhvdXJzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ29udmVydHMgVGltZVNwYW4gdG8gdG90YWwgZGF5cyIgewogICAgICAgICAgICAgICAgJHRlc3RJbnRUaW1lU3BhbiA9IDYwOwogICAgICAgICAgICAgICAgJHRlc3RUaW1lU3BhbiA9IE5ldy1UaW1lU3BhbiAtRGF5cyAkdGVzdEludFRpbWVTcGFuOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDb252ZXJ0RnJvbS1UaW1lU3BhbiAtVGltZVNwYW4gJHRlc3RUaW1lU3BhbiAtVGltZVNwYW5UeXBlIERheXM7CgogICAgICAgICAgICAgICAgJHJlc3VsdCB8IFNob3VsZCBCZSAkdGVzdFRpbWVTcGFuLlRvdGFsRGF5czsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAgICAgI2VuZHJlZ2lvbgoKICAgICAgICAjcmVnaW9uIEZ1bmN0aW9uIEdldC1BRENvbW1vblBhcmFtZXRlcnMKICAgICAgICBEZXNjcmliZSAiJCgkR2xvYmFsOkRTQ1Jlc291cmNlTmFtZSlcR2V0LUFEQ29tbW9uUGFyYW1ldGVycyIgewoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGUnIG9iamVjdCB0eXBlIiB7CiAgICAgICAgICAgICAgICAkdGVzdElkZW50aXR5ID0gJ2NvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0IC1pcyBbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0gfCBTaG91bGQgQmUgJHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJSZXR1cm5zICdJZGVudGl0eScga2V5IGJ5IGRlZmF1bHQiIHsKICAgICAgICAgICAgICAgICR0ZXN0SWRlbnRpdHkgPSAnY29udG9zby5jb20nOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIC1JZGVudGl0eSAkdGVzdElkZW50aXR5OwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ0lkZW50aXR5J10gfCBTaG91bGQgQmUgJHRlc3RJZGVudGl0eTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ05hbWUnIGtleSB3aGVuICdVc2VOYW1lUGFyYW1ldGVyJyBpcyBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgICR0ZXN0SWRlbnRpdHkgPSAnY29udG9zby5jb20nOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIC1JZGVudGl0eSAkdGVzdElkZW50aXR5IC1Vc2VOYW1lUGFyYW1ldGVyOwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ05hbWUnXSB8IFNob3VsZCBCZSAkdGVzdElkZW50aXR5OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3JlYWNoICgkaWRlbnRpdHlQYXJhbSBpbiBAKCdVc2VyTmFtZScsJ0dyb3VwTmFtZScsJ0NvbXB1dGVyTmFtZScpKSB7CiAgICAgICAgICAgICAgICBJdCAiUmV0dXJucyAnSWRlbnRpdHknIGtleSB3aGVuICckaWRlbnRpdHlQYXJhbScgYWxpYXMgaXMgc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgICAgICAgICAgJGdldEFEQ29tbW9uUGFyYW1ldGVycyA9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpZGVudGl0eVBhcmFtID0gJHRlc3RJZGVudGl0eTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIEBnZXRBRENvbW1vblBhcmFtZXRlcnM7CgogICAgICAgICAgICAgICAgICAgICRyZXN1bHRbJ0lkZW50aXR5J10gfCBTaG91bGQgQmUgJHRlc3RJZGVudGl0eTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ0lkZW50aXR5JyBrZXkgYnkgZGVmYXVsdCB3aGVuICdJZGVudGl0eScgYW5kICdDb21tb25OYW1lJyBhcmUgc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICAkdGVzdElkZW50aXR5ID0gJ2NvbnRvc28uY29tJzsKICAgICAgICAgICAgICAgICR0ZXN0Q29tbW9uTmFtZSA9ICdUZXN0IENvbW1vbiBOYW1lJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eSAtQ29tbW9uTmFtZSAkdGVzdENvbW1vbk5hbWU7CgogICAgICAgICAgICAgICAgJHJlc3VsdFsnSWRlbnRpdHknXSB8IFNob3VsZCBCZSAkdGVzdElkZW50aXR5OwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiUmV0dXJucyAnSWRlbnRpdHknIGtleSB3aXRoICdDb21tb25OYW1lJyB3aGVuICdJZGVudGl0eScsICdDb21tb25OYW1lJyBhbmQgJ1ByZWZlckNvbW1vbk5hbWUnIGFyZSBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgICR0ZXN0SWRlbnRpdHkgPSAnY29udG9zby5jb20nOwogICAgICAgICAgICAgICAgJHRlc3RDb21tb25OYW1lID0gJ1Rlc3QgQ29tbW9uIE5hbWUnOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIC1JZGVudGl0eSAkdGVzdElkZW50aXR5IC1Db21tb25OYW1lICR0ZXN0Q29tbW9uTmFtZSAtUHJlZmVyQ29tbW9uTmFtZTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0WydJZGVudGl0eSddIHwgU2hvdWxkIEJlICR0ZXN0Q29tbW9uTmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgIlJldHVybnMgJ0lkZW50aXR5JyBrZXkgd2l0aCAnSWRlbnRpdHknIHdoZW4gJ0lkZW50aXR5JyBhbmQgJ1ByZWZlckNvbW1vbk5hbWUnIGFyZSBzcGVjaWZpZWQiIHsKICAgICAgICAgICAgICAgICR0ZXN0SWRlbnRpdHkgPSAnY29udG9zby5jb20nOwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIC1JZGVudGl0eSAkdGVzdElkZW50aXR5IC1QcmVmZXJDb21tb25OYW1lOwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ0lkZW50aXR5J10gfCBTaG91bGQgQmUgJHRlc3RJZGVudGl0eTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaXQgIlJldHVybnMgJ05hbWUnIGtleSB3aGVuICdVc2VOYW1lUGFyYW1ldGVyJyBhbmQgJ1ByZWZlckNvbW1vbk5hbWUnIGFyZSBzdXBwbGllZCIgewogICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgICAgICAkdGVzdENvbW1vbk5hbWUgPSAnVGVzdCBDb21tb24gTmFtZSc7CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IEdldC1BRENvbW1vblBhcmFtZXRlcnMgLUlkZW50aXR5ICR0ZXN0SWRlbnRpdHkgLVVzZU5hbWVQYXJhbWV0ZXIgLUNvbW1vbk5hbWUgJHRlc3RDb21tb25OYW1lIC1QcmVmZXJDb21tb25OYW1lOwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ05hbWUnXSB8IFNob3VsZCBCZSAkdGVzdENvbW1vbk5hbWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJEb2VzIG5vdCByZXR1cm4gJ0NyZWRlbnRpYWwnIGtleSBieSBkZWZhdWx0IiB7CiAgICAgICAgICAgICAgICAkdGVzdElkZW50aXR5ID0gJ2NvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0LkNvbnRhaW5zS2V5KCdDcmVkZW50aWFsJykgfCBTaG91bGQgQmUgJGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiUmV0dXJucyAnQ3JlZGVudGlhbCcga2V5IHdoZW4gc3BlY2lmaWVkIiB7CiAgICAgICAgICAgICAgICAkdGVzdElkZW50aXR5ID0gJ2NvbnRvc28uY29tJzsKICAgICAgICAgICAgICAgICR0ZXN0Q3JlZGVudGlhbCA9IFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF06OkVtcHR5OwoKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBHZXQtQURDb21tb25QYXJhbWV0ZXJzIC1JZGVudGl0eSAkdGVzdElkZW50aXR5IC1DcmVkZW50aWFsICR0ZXN0Q3JlZGVudGlhbDsKCiAgICAgICAgICAgICAgICAkcmVzdWx0WydDcmVkZW50aWFsJ10gfCBTaG91bGQgQmUgJHRlc3RDcmVkZW50aWFsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiRG9lcyBub3QgcmV0dXJuICdTZXJ2ZXInIGtleSBieSBkZWZhdWx0IiB7CiAgICAgICAgICAgICAgICAkdGVzdElkZW50aXR5ID0gJ2NvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0LkNvbnRhaW5zS2V5KCdTZXJ2ZXInKSB8IFNob3VsZCBCZSAkZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJSZXR1cm5zICdTZXJ2ZXInIGtleSB3aGVuIHNwZWNpZmllZCIgewogICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgICAgICAkdGVzdFNlcnZlciA9ICd0ZXN0c2VydmVyLmNvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eSAtU2VydmVyICR0ZXN0U2VydmVyOwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ1NlcnZlciddIHwgU2hvdWxkIEJlICR0ZXN0U2VydmVyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBJdCAiQ29udmVydHMgJ0RvbWFpbkFkbWluaXN0cmF0b3JDcmVkZW50aWFsJyBwYXJhbWV0ZXIgdG8gJ0NyZWRlbnRpYWwnIGtleSIgewogICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgICAgICAkdGVzdENyZWRlbnRpYWwgPSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdOjpFbXB0eTsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eSAtRG9tYWluQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwgJHRlc3RDcmVkZW50aWFsOwoKICAgICAgICAgICAgICAgICRyZXN1bHRbJ0NyZWRlbnRpYWwnXSB8IFNob3VsZCBCZSAkdGVzdENyZWRlbnRpYWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEl0ICJDb252ZXJ0cyAnRG9tYWluQ29udHJvbGxlcicgcGFyYW1ldGVyIHRvICdTZXJ2ZXInIGtleSIgewogICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CiAgICAgICAgICAgICAgICAkdGVzdFNlcnZlciA9ICd0ZXN0c2VydmVyLmNvbnRvc28uY29tJzsKCiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyAtSWRlbnRpdHkgJHRlc3RJZGVudGl0eSAtRG9tYWluQ29udHJvbGxlciAkdGVzdFNlcnZlcjsKCiAgICAgICAgICAgICAgICAkcmVzdWx0WydTZXJ2ZXInXSB8IFNob3VsZCBCZSAkdGVzdFNlcnZlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSXQgJ0FjY2VwdHMgcmVtYWluaW5nIGFyZ3VtZW50cycgewogICAgICAgICAgICAgICAgJHRlc3RJZGVudGl0eSA9ICdjb250b3NvLmNvbSc7CgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IEdldC1BRENvbW1vblBhcmFtZXRlcnMgLUlkZW50aXR5ICR0ZXN0SWRlbnRpdHkgLVVuZXhwZWN0ZWRQYXJhbWV0ZXIgNDI7CgogICAgICAgICAgICAgICAgJHJlc3VsdFsnSWRlbnRpdHknXSB8IFNob3VsZCBCZSAkdGVzdElkZW50aXR5OwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICAjZW5kcmVnaW9uCgogICAgfQogICAgI2VuZHJlZ2lvbgp9CmZpbmFsbHkKewogICAgI3JlZ2lvbiBGT09URVIKICAgIFJlc3RvcmUtVGVzdEVudmlyb25tZW50IC1UZXN0RW52aXJvbm1lbnQgJFRlc3RFbnZpcm9ubWVudAogICAgI2VuZHJlZ2lvbgp9Cg==
