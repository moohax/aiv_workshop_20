PSTrueCrypt.psm1,c25dcb674f3504b85e571b90bea3978a,Scan result is 1. IsMalware: 0,dXNpbmcgbmFtZXNwYWNlICdTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uJwp1c2luZyBtb2R1bGUgLlxzcmNcd3JpdGVyXEVycm9yLnBzbTEKdXNpbmcgbW9kdWxlIC5cc3JjXHdyaXRlclxJbmZvcm1hdGlvbi5wc20xCnVzaW5nIG1vZHVsZSAuXHNyY1x3cml0ZXJcVmVyYm9zZS5wc20xCnVzaW5nIG1vZHVsZSAuXHNyY1x3cml0ZXJcV2FybmluZy5wc20xCgojLkV4dGVybmFsSGVscCBQU1RydWVDcnlwdC1oZWxwLnhtbApmdW5jdGlvbiBNb3VudC1UcnVlQ3J5cHQKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgUG9zaXRpb24gPSAxKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddJE5hbWUsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJEZhbHNlKV0KICAgICAgICBbYXJyYXldJEtleWZpbGVQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRGYWxzZSldCiAgICAgICAgW1N5c3RlbS5TZWN1cml0eS5TZWN1cmVTdHJpbmddJFBhc3N3b3JkCiAgICApCiAgICAKICAgICMgVE9ETzogbmVlZCBhIGJldHRlciB3YXkgdG8gY2hlY2sgZm9yIGEgc3Via2V5LiAgYWxsIGtleXMgbWF5IGhhdmUgYmVlbiBkZWxldGVkIGJ1dCBQU1RydWVDcnlwdCBzdGlsbCBleGlzdHMKICAgIHRyeSAKICAgIHsKICAgICAgICAkU2V0dGluZ3MgPSBHZXQtUFNUcnVlQ3J5cHRDb250YWluZXIgLU5hbWUgJE5hbWUKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkl0ZW1Ob3RGb3VuZEV4Y2VwdGlvbl0KICAgIHsKICAgICAgICAgT3V0LUVycm9yICdOb1BTVHJ1ZUNyeXB0Q29udGFpbmVyRm91bmQnIC1BY3Rpb24gQ29udGludWUKICAgIH0KCiAgICAjIGNvbnN0cnVjdCBhcmd1bWVudHMgZm9yIGV4cHJlc3Npb24gYW5kIGluc2VydCB0b2tlbiBpbiBmb3IgcGFzc3dvcmQuLi4KICAgIFtzdHJpbmddJEV4cHJlc3Npb24gPSBHZXQtVHJ1ZUNyeXB0TW91bnRQYXJhbXMgIC1UcnVlQ3J5cHRDb250YWluZXJQYXRoICRTZXR0aW5ncy5UcnVlQ3J5cHRDb250YWluZXJQYXRoIC1QcmVmZXJyZWRNb3VudERyaXZlICRTZXR0aW5ncy5QcmVmZXJyZWRNb3VudERyaXZlIC1Qcm9kdWN0ICRTZXR0aW5ncy5Qcm9kdWN0IC1LZXlmaWxlUGF0aCAkS2V5ZmlsZVBhdGggLVRpbWVzdGFtcCAkU2V0dGluZ3MuVGltZXN0YW1wCgogICAgIyBpZiBubyBwYXNzd29yZCB3YXMgZ2l2ZW4sIHRoZW4gd2UgbmVlZCB0byBzdGFydCB0aGUgcHJvY2VzcyBmb3Igb2YgcHJvbXB0aW5nIGZvciBvbmUuLi4KICAgIGlmIChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkUGFzc3dvcmQpIC1lcSAkVHJ1ZSkKICAgIHsKICAgICAgICAkV2FzQ29uc29sZVByb21wdGluZ1ByaW9yCiAgICAgICAgIyBjaGVjayB0byBzZWUgaWYgc2Vzc2lvbiBpcyBpbiBhZG1pbiBtb2RlIGZvciBjb25zb2xlIHByb21wdGluZy4uLgogICAgICAgIGlmIChUZXN0LUlzQWRtaW4gLWVxICRUcnVlKQogICAgICAgIHsKICAgICAgICAgICAgJFdhc0NvbnNvbGVQcm9tcHRpbmdQcmlvciA9IEdldC1JdGVtUHJvcGVydHkgIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxQb3dlclNoZWxsXDFcU2hlbGxJZHMiIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgQ29uc29sZVByb21wdGluZwoKICAgICAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFBvd2VyU2hlbGxcMVxTaGVsbElkcyIgLU5hbWUgQ29uc29sZVByb21wdGluZyAtVmFsdWUgJFRydWUKICAgICAgICB9CgogICAgICAgIFtzZWN1cmVzdHJpbmddJFBhc3N3b3JkID0gUmVhZC1Ib3N0IC1Qcm9tcHQgIkVudGVyIHBhc3N3b3JkIiAtQXNTZWN1cmVTdHJpbmcKICAgIH0KCiAgICAjIHRoaXMgbWV0aG9kIG9mIGhhbmRsaW5nIHBhc3N3b3JkIHNlY3VyZWx5IGhhcyBiZWVuIG1lbnRpb25lZCBhdCB0aGUgZm9sbG93aW5nIGxpbmtzOgogICAgIyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3N5c3RlbS5zZWN1cml0eS5zZWN1cmVzdHJpbmcodj12cy4xMTApLmFzcHgKICAgICMgaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9zeXN0ZW0ucnVudGltZS5pbnRlcm9wc2VydmljZXMubWFyc2hhbC5zZWN1cmVzdHJpbmd0b2JzdHIodj12cy4xMTApLmFzcHgKICAgICMgaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9zeXN0ZW0uaW50cHRyKHY9dnMuMTEwKS5hc3B4CiAgICAjIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvZXd5a3RjYWEodj12cy4xMTApLmFzcHgKICAgIHRyeQogICAgewogICAgICAgICMgQ3JlYXRlIEludFBhc3N3b3JkIGFuZCBkaXNwb3NlICRQYXNzd29yZC4uLgoKICAgICAgICBbU3lzdGVtLkludFB0cl0kSW50UGFzc3dvcmQgPSBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpTZWN1cmVTdHJpbmdUb0JTVFIoJFBhc3N3b3JkKQogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5Ob3RTdXBwb3J0ZWRFeGNlcHRpb25dCiAgICB7CiAgICAgICAgIyBUaGUgY3VycmVudCBjb21wdXRlciBpcyBub3QgcnVubmluZyBXaW5kb3dzIDIwMDAgU2VydmljZSBQYWNrIDMgb3IgbGF0ZXIuCiAgICAgICAgT3V0LUVycm9yICdOb3RTdXBwb3J0ZWRFeGNlcHRpb24nCiAgICB9CiAgICBjYXRjaCBbU3lzdGVtLk91dE9mTWVtb3J5RXhjZXB0aW9uXQogICAgewogICAgICAgICMgT3V0T2ZNZW1vcnlFeGNlcHRpb24KICAgICAgICBPdXQtRXJyb3IgJ091dE9mTWVtb3J5RXhjZXB0aW9uJwogICAgfQogICAgZmluYWxseQogICAgewogICAgICAgICRQYXNzd29yZC5EaXNwb3NlKCkKICAgIH0KCiAgICB0cnkKICAgIHsKICAgICAgICAjIEV4ZWN1dGUgRXhwcmVzc2lvbgogICAgICAgIEludm9rZS1FeHByZXNzaW9uICgkRXhwcmVzc2lvbiAtZiBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpQdHJUb1N0cmluZ0F1dG8oJEludFBhc3N3b3JkKSkKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uRXhjZXB0aW9uXQogICAgewogICAgICAgIE91dC1FcnJvciAnVW5rbm93bkV4Y2VwdGlvbicsICdFbnN1cmVGaWxlUmVjb21tZW5kbWVudCcKICAgIH0KICAgIGZpbmFsbHkKICAgIHsKICAgICMgVE9ETzogdGhpcyBpcyBjcmFzaGluZyBDTFMuICBJcyB0aGlzIHRvIGJlIGNhbGxlZCB3aGVuIGRpc21vdW50IGlzIGRvbmU/ICBQZXJoYXBzIFRydWVDcnlwdCBpcyAKICAgICMgaG9sZGluZyBvbiB0byB0aGlzIHBvaW50ZXIgd2hpbGUgY29udGFpbmVyIGlzIG9wZW4uCiAgICAjIFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06Olplcm9GcmVlQ29UYXNrTWVtQW5zaSgkSW50UGFzc3dvcmQpCiAgICB9CgogICAgIyBpZiBjb25zb2xlIHByb21wdGluZyB3YXMgc2V0IHRvIGZhbHNlIHByaW9yIHRvIHRoaXMgbW9kdWxlLCB0aGVuIHNldCBpdCBiYWNrIHRvIGZhbHNlLi4uIAogICAgaWYgKCRXYXNDb25zb2xlUHJvbXB0aW5nUHJpb3IgLWVxICRGYWxzZSkKICAgIHsKICAgICAgICBTZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcUG93ZXJTaGVsbFwxXFNoZWxsSWRzIiAtTmFtZSBDb25zb2xlUHJvbXB0aW5nIC1WYWx1ZSAkRmFsc2UKICAgIH0KCiAgICBpZigkS2V5ZmlsZVBhdGggLW5lICRudWxsKQogICAgewogICAgICAgIEVkaXQtSGlzdG9yeUZpbGUgLUtleWZpbGVQYXRoICRLZXlmaWxlUGF0aAogICAgfQp9CgoKIy5FeHRlcm5hbEhlbHAgUFNUcnVlQ3J5cHQtaGVscC54bWwKZnVuY3Rpb24gRGlzbW91bnQtVHJ1ZUNyeXB0CnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFBvc2l0aW9uID0gMSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSROYW1lCiAgICApCgogICAgJFNldHRpbmdzID0gR2V0LVBTVHJ1ZUNyeXB0Q29udGFpbmVyIC1OYW1lICROYW1lCiAgICAKICAgICMgY29uc3RydWN0IGFyZ3VtZW50cyBhbmQgZXhlY3V0ZSBleHByZXNzaW9uLi4uCiAgICBbc3RyaW5nXSRFeHByZXNzaW9uID0gR2V0LVRydWVDcnlwdERpc21vdW50UGFyYW1zIC1Ecml2ZSAkU2V0dGluZ3MuUHJlZmVycmVkTW91bnREcml2ZSAtUHJvZHVjdCAkU2V0dGluZ3MuUHJvZHVjdAoKICAgIEludm9rZS1FeHByZXNzaW9uICRFeHByZXNzaW9uCn0KCgojLkV4dGVybmFsSGVscCBQU1RydWVDcnlwdC1oZWxwLnhtbApmdW5jdGlvbiBEaXNtb3VudC1UcnVlQ3J5cHRGb3JjZUFsbAp7CiAgICBJbnZva2UtRGlzbW91bnRBbGwgLVByb2R1Y3QgVHJ1ZUNyeXB0CiAgICBJbnZva2UtRGlzbW91bnRBbGwgLVByb2R1Y3QgVmVyYUNyeXB0Cn0KCiMgaW50ZXJuYWwgZnVuY3Rpb24KZnVuY3Rpb24gSW52b2tlLURpc21vdW50QWxsCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtWYWxpZGF0ZVNldCgiVHJ1ZUNyeXB0IiwgIlZlcmFDcnlwdCIpXQogICAgICAgIFtzdHJpbmddJFByb2R1Y3QKICAgICkKCiAgICAjIGNvbnN0cnVjdCBhcmd1bWVudHMgZm9yIEZvcmNlIGRpc21vdW50KHMpLi4uCiAgICBbc3RyaW5nXSRFeHByZXNzaW9uID0gR2V0LVRydWVDcnlwdERpc21vdW50UGFyYW1zIC1Qcm9kdWN0ICRQcm9kdWN0CgogICAgdHJ5CiAgICB7CiAgICAgICAgSW52b2tlLUV4cHJlc3Npb24gJEV4cHJlc3Npb24KICAgICAgICAkSGFzWENyeXB0RGlzbW91bnRGYWlsZWQgPSAkRmFsc2UKICAgIH0KICAgIGNhdGNoIAogICAgewogICAgICAgICRIYXNYQ3J5cHREaXNtb3VudEZhaWxlZCA9ICRUcnVlCiAgICB9CiAgICBmaW5hbGx5CiAgICB7CiAgICAgICAgaWYoJEhhc1hDcnlwdERpc21vdW50RmFpbGVkIC1lcSAkRmFsc2UpCiAgICAgICAgewogICAgICAgICAgICBPdXQtSW5mb3JtYXRpb24gJ0FsbFByb2R1Y3RDb250YWluZXJzRGlzbW91bnRlZCcgLUZvcm1hdCAkUHJvZHVjdAogICAgICAgIH0KICAgICAgICBlbHNlIAogICAgICAgIHsKICAgICAgICAgICAgT3V0LUVycm9yICdEaXNtb3VudEV4Y2VwdGlvbicgLUZvcm1hdCAkUHJvZHVjdAogICAgICAgIH0KICAgIH0KfQoKIy5FeHRlcm5hbEhlbHAgUFNUcnVlQ3J5cHQtaGVscC54bWwKZnVuY3Rpb24gTmV3LVBTVHJ1ZUNyeXB0Q29udGFpbmVyCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBQYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFBvc2l0aW9uID0gMSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSROYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlLCBQb3NpdGlvbiA9IDIpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW3N0cmluZ10kTG9jYXRpb24sCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFBvc2l0aW9uID0gMyldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbc3RyaW5nXSRNb3VudExldHRlciwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgUG9zaXRpb24gPSA0KV0KICAgICAgICBbVmFsaWRhdGVTZXQoIlRydWVDcnlwdCIsICJWZXJhQ3J5cHQiKV0KICAgICAgICBbc3RyaW5nXSRQcm9kdWN0LAoKICAgICAgICBbc3dpdGNoXSRUaW1lc3RhbXAKICAgICkKCiAgICAkRGVjaXNpb24gPSBHZXQtQ29uZmlybWF0aW9uIC1NZXNzYWdlICJOZXctUFNUcnVlQ3J5cHRDb250YWluZXIgd2lsbCBhZGQgYSBuZXcgc3Via2V5IGluIHRoZSBmb2xsb3dpbmcgb2YgeW91ciByZWdpc3RyeTogSEtDVTpcU09GVFdBUkVcUFNUcnVlQ3J5cHQiCgogICAgdHJ5CiAgICB7CiAgICAgICAgaWYgKCREZWNpc2lvbiAtZXEgJFRydWUpCiAgICAgICAgewogICAgICAgICAgICBbU3lzdGVtLlN0cmluZ10kU3ViS2V5TmFtZSA9IE5ldy1HdWlkCiAgICAgICAgICAgICRBY2Nlc3NSdWxlID0gTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5SZWdpc3RyeUFjY2Vzc1J1bGUgKAogICAgICAgICAgICAgICAgW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpLk5hbWUsICJGdWxsQ29udHJvbCIsCiAgICAgICAgICAgICAgICBbU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuSW5oZXJpdGFuY2VGbGFnc10iT2JqZWN0SW5oZXJpdCxDb250YWluZXJJbmhlcml0IiwKICAgICAgICAgICAgICAgIFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5Qcm9wYWdhdGlvbkZsYWdzXSJOb25lIiwKICAgICAgICAgICAgICAgIFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5BY2Nlc3NDb250cm9sVHlwZV0iQWxsb3ciKQoKICAgICAgICAgICAgJFN1YktleSA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnldOjpDdXJyZW50VXNlci5DcmVhdGVTdWJLZXkoIlNPRlRXQVJFXFBTVHJ1ZUNyeXB0XCRTdWJLZXlOYW1lIiwKICAgICAgICAgICAgICAgICAgICBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5UGVybWlzc2lvbkNoZWNrXTo6UmVhZFdyaXRlU3ViVHJlZSkKCiAgICAgICAgICAgICRBY2Nlc3NDb250cm9sID0gJFN1YktleS5HZXRBY2Nlc3NDb250cm9sKCkKICAgICAgICAgICAgJEFjY2Vzc0NvbnRyb2wuU2V0QWNjZXNzUnVsZSgkQWNjZXNzUnVsZSkKICAgICAgICAgICAgJFN1YktleS5TZXRBY2Nlc3NDb250cm9sKCRBY2Nlc3NDb250cm9sKQoKICAgICAgICAgICAgIyBzbGllbnQgb3V0LXB1dCB1c2luZyAnW3ZvaWRdKC4uLiknCiAgICAgICAgICAgIFt2b2lkXShOZXctSXRlbVByb3BlcnR5IC1QYXRoICAiSEtDVTpcU09GVFdBUkVcUFNUcnVlQ3J5cHRcJFN1YktleU5hbWUiIC1OYW1lIE5hbWUgICAgICAgIC1Qcm9wZXJ0eVR5cGUgU3RyaW5nIC1WYWx1ZSAkTmFtZSkKICAgICAgICAgICAgW3ZvaWRdKE5ldy1JdGVtUHJvcGVydHkgLVBhdGggICJIS0NVOlxTT0ZUV0FSRVxQU1RydWVDcnlwdFwkU3ViS2V5TmFtZSIgLU5hbWUgTG9jYXRpb24gICAgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRMb2NhdGlvbikKICAgICAgICAgICAgW3ZvaWRdKE5ldy1JdGVtUHJvcGVydHkgLVBhdGggICJIS0NVOlxTT0ZUV0FSRVxQU1RydWVDcnlwdFwkU3ViS2V5TmFtZSIgLU5hbWUgTW91bnRMZXR0ZXIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRNb3VudExldHRlcikKICAgICAgICAgICAgW3ZvaWRdKE5ldy1JdGVtUHJvcGVydHkgLVBhdGggICJIS0NVOlxTT0ZUV0FSRVxQU1RydWVDcnlwdFwkU3ViS2V5TmFtZSIgLU5hbWUgUHJvZHVjdCAgICAgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRQcm9kdWN0KQogICAgICAgICAgICBbdm9pZF0oTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAgIkhLQ1U6XFNPRlRXQVJFXFBTVHJ1ZUNyeXB0XCRTdWJLZXlOYW1lIiAtTmFtZSBUaW1lc3RhbXAgICAtUHJvcGVydHlUeXBlIERXb3JkIC1WYWx1ZSAkVGltZXN0YW1wLkdldEhhc2hDb2RlKCkpCgogICAgICAgICAgICBPdXQtSW5mb3JtYXRpb24gJ05ld0NvbnRhaW5lck9wZXJhdGlvblN1Y2NlZWRlZCcgLUZvcm1hdCAkTmFtZQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBPdXQtV2FybmluZyAnTmV3Q29udGFpbmVyT3BlcmF0aW9uQ2FuY2VsbGVkJwogICAgICAgIH0KICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uVW5hdXRob3JpemVkQWNjZXNzRXhjZXB0aW9uXQogICAgewogICAgICAgICMgVE9ETzogYXBwZW5kIHRvIHRoaXMgbWVzc2FnZSBvZiBvcHRpb25zIGZvciBhIHNvbHV0aW9uLiAgc29sdXRpb24gd2lsbCBiZSBkZXRlcm1pbmVkIGlmIHRoZSB1c2VyIGlzIGluIGFuIGVsZXZhdGVkIENMUy4KICAgICAgICBPdXQtRXJyb3IgJ1VuYXV0aG9yaXplZEFjY2Vzc0V4Y2VwdGlvbicKICAgIH0KfQoKCiMuRXh0ZXJuYWxIZWxwIFBTVHJ1ZUNyeXB0LWhlbHAueG1sCmZ1bmN0aW9uIFJlbW92ZS1QU1RydWVDcnlwdENvbnRhaW5lciAKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgUG9zaXRpb24gPSAxKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddJE5hbWUKICAgICkKICAgIAogICAgdHJ5CiAgICB7CiAgICAgICAgW1N5c3RlbS5TdHJpbmddJFN1YktleU5hbWUgPSBHZXQtU3ViS2V5UGF0aCAtTmFtZSAkTmFtZQoKICAgICAgICBpZigkU3ViS2V5TmFtZSkgewogICAgICAgICAgICBSZW1vdmUtSEtDVVN1YktleSAiU09GVFdBUkVcUFNUcnVlQ3J5cHRcJFN1YktleU5hbWUiCgogICAgICAgICAgICBPdXQtSW5mb3JtYXRpb24gJ0NvbnRhaW5lclNldHRpbmdzRGVsZXRlZCcKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBOZXctT2JqZWN0IFN5c3RlbS5Bcmd1bWVudEV4Y2VwdGlvbignVW5hYmxlVG9GaW5kUFNUcnVlQ3J5cHRDb250YWluZXInKQogICAgICAgIH0KICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uT2JqZWN0RGlzcG9zZWRFeGNlcHRpb25dCiAgICB7CiAgICAgICAgI1RoZSBSZWdpc3RyeUtleSBiZWluZyBtYW5pcHVsYXRlZCBpcyBjbG9zZWQgKGNsb3NlZCBrZXlzIGNhbm5vdCBiZSBhY2Nlc3NlZCkuCiAgICAgICAgT3V0LUVycm9yICdPYmplY3REaXNwb3NlZEV4Y2VwdGlvbicKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uQXJndW1lbnRFeGNlcHRpb25dLFtTeXN0ZW0uQXJndW1lbnROdWxsRXhjZXB0aW9uXQogICAgewogICAgICAgICNzdWJrZXkgZG9lcyBub3Qgc3BlY2lmeSBhIHZhbGlkIHJlZ2lzdHJ5IGtleSwgYW5kIHRocm93T25NaXNzaW5nU3ViS2V5IGlzIHRydWUuCiAgICAgICAgI3N1YmtleSBpcyBudWxsLgogICAgICAgIE91dC1FcnJvciAnVW5hYmxlVG9GaW5kUFNUcnVlQ3J5cHRDb250YWluZXInIC1Gb3JtYXQgJE5hbWUKCiAgICB9CiAgICBjYXRjaCBbU3lzdGVtLlNlY3VyaXR5LlNlY3VyaXR5RXhjZXB0aW9uXQogICAgewogICAgICAgICNUaGUgdXNlciBkb2VzIG5vdCBoYXZlIHRoZSBwZXJtaXNzaW9ucyByZXF1aXJlZCB0byBkZWxldGUgdGhlIGtleS4KICAgICAgICBPdXQtRXJyb3IgJ1NlY3VyaXR5RXhjZXB0aW9uJyAtUmVjb21tZW5kbWVudCAnU2VjdXJpdHlSZWNvbW1lbmRtZW50JwogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5JbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uXQogICAgewogICAgICAgICMgc3Via2V5IGhhcyBjaGlsZCBzdWJrZXlzLgogICAgICAgIE91dC1FcnJvciAnSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbicKICAgIH0KICAgIGNhdGNoIFtTeXN0ZW0uVW5hdXRob3JpemVkQWNjZXNzRXhjZXB0aW9uXQogICAgewogICAgICAgICNUaGUgdXNlciBkb2VzIG5vdCBoYXZlIHRoZSBuZWNlc3NhcnkgcmVnaXN0cnkgcmlnaHRzLgogICAgICAgIE91dC1FcnJvciAnVW5hdXRob3JpemVkUmVnaXN0cnlBY2Nlc3NFeGNlcHRpb24nCiAgICB9Cn0KCgojLkV4dGVybmFsSGVscCBQU1RydWVDcnlwdC1oZWxwLnhtbApmdW5jdGlvbiBTaG93LVBTVHJ1ZUNyeXB0Q29udGFpbmVycyAKewogICAgUHVzaC1Mb2NhdGlvbgogICAgU2V0LUxvY2F0aW9uIC1QYXRoIEhLQ1U6XFNPRlRXQVJFXFBTVHJ1ZUNyeXB0CgogICAgdHJ5IAogICAgewogICAgICAgIEdldC1DaGlsZEl0ZW0gLiAtUmVjdXJzZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgR2V0LUl0ZW1Qcm9wZXJ0eSAkXy5Qc1BhdGgKICAgICAgICB9fCBTb3J0LU9iamVjdCBOYW1lIHwgRm9ybWF0LVRhYmxlIE5hbWUsIExvY2F0aW9uLCBNb3VudExldHRlciwgUHJvZHVjdCwgQHtMYWJlbD0iVGltZXN0YW1wIjtFeHByZXNzaW9uPXtbYm9vbF0oJF8uVGltZXN0YW1wKX19IC1BdXRvU2l6ZQogICAgfQogICAgY2F0Y2ggW1N5c3RlbS5TZWN1cml0eS5TZWN1cml0eUV4Y2VwdGlvbl0KICAgIHsKICAgICAgICAjVGhlIHVzZXIgZG9lcyBub3QgaGF2ZSB0aGUgcGVybWlzc2lvbnMgcmVxdWlyZWQgdG8gZGVsZXRlIHRoZSBrZXkuCiAgICAgICAgT3V0LUVycm9yICdTZWN1cml0eUV4Y2VwdGlvbicgLVJlY29tbWVuZG1lbnQgJ1NlY3VyaXR5UmVjb21tZW5kbWVudCcKICAgIH0KCiAgICBQb3AtTG9jYXRpb24KfQoKCiNpbnRlcm5hbCBmdW5jdGlvbgpmdW5jdGlvbiBHZXQtUFNUcnVlQ3J5cHRDb250YWluZXIgCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgUG9zaXRpb24gPSAxKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtzdHJpbmddJE5hbWUKICAgICkKCiAgICBbU3lzdGVtLlN0cmluZ10kU3ViS2V5TmFtZSA9IEdldC1TdWJLZXlQYXRoIC1OYW1lICROYW1lCgogICAgaWYoJFN1YktleU5hbWUgLW5lICIiKQogICAgewogICAgICAgICRTZXR0aW5ncyA9IEB7CiAgICAgICAgICAgIFRydWVDcnlwdENvbnRhaW5lclBhdGggID0gR2V0LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU09GVFdBUkVcUFNUcnVlQ3J5cHRcJFN1YktleU5hbWUiIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgTG9jYXRpb24KICAgICAgICAgICAgUHJlZmVycmVkTW91bnREcml2ZSAgICAgPSBHZXQtSXRlbVByb3BlcnR5ICJIS0NVOlxTT0ZUV0FSRVxQU1RydWVDcnlwdFwkU3ViS2V5TmFtZSIgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBNb3VudExldHRlcgogICAgICAgICAgICBQcm9kdWN0ICAgICAgICAgICAgICAgICA9IEdldC1JdGVtUHJvcGVydHkgIkhLQ1U6XFNPRlRXQVJFXFBTVHJ1ZUNyeXB0XCRTdWJLZXlOYW1lIiB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFByb2R1Y3QKICAgICAgICAgICAgVGltZXN0YW1wICAgICAgICAgICAgICAgPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU09GVFdBUkVcUFNUcnVlQ3J5cHRcJFN1YktleU5hbWUiIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgVGltZXN0YW1wKSAtZXEgMQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBPdXQtRXJyb3IgJ1VuYWJsZVRvRmluZFBTVHJ1ZUNyeXB0Q29udGFpbmVyJyAtRm9ybWF0ICROYW1lIC1BY3Rpb24gU3RvcAogICAgfQoKICAgICRTZXR0aW5ncwp9CgoKIyBpbnRlcm5hbCBmdW5jdGlvbgojIHJldHVybnMgdGhlIHBhdGggdG8gdGhlIHN1YmtleTogJ0hLQ1U6XFNPRlRXQVJFXFBTVHJ1ZUNyeXB0XGUwM2UxOTVlLWMwNjktNGM2Yi05ZDM1LTZiNjFjZGY0MGFhZCcKZnVuY3Rpb24gR2V0LVN1YktleVBhdGgKewogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbc3RyaW5nXSROYW1lCiAgICApCgogICAgUHVzaC1Mb2NhdGlvbgogICAgU2V0LUxvY2F0aW9uIC1QYXRoIEhLQ1U6XFNPRlRXQVJFXFBTVHJ1ZUNyeXB0CgogICAgdHJ5IAogICAgewogICAgICAgIEdldC1DaGlsZEl0ZW0gLiAtUmVjdXJzZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgaWYgKCROYW1lIC1lcSAoR2V0LUl0ZW1Qcm9wZXJ0eSAkXy5Qc1BhdGgpLk5hbWUpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkUFNDaGlsZE5hbWUgPSAkXy5QU0NoaWxkTmFtZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggCiAgICB7CiAgICAgICAgIyBUT0RPOiBOZWVkIHRvIHRocm93IHNwZWNpZmljIGVycm9yIHRvIGNhbGxpbmcgbWV0aG9kCiAgICAgICAgT3V0LUVycm9yICdVbmFibGVUb1JlYWRSZWdpc3RyeScKICAgIH0KCiAgICBQb3AtTG9jYXRpb24KCiAgICBXcml0ZS1PdXRwdXQgJFBTQ2hpbGROYW1lCn0KCgojIGludGVybmFsIGZ1bmN0aW9uCmZ1bmN0aW9uIEdldC1UcnVlQ3J5cHRNb3VudFBhcmFtcyAKewogICAgUGFyYW0KICAgICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlLCBQb3NpdGlvbiA9IDEpXQogICAgICAgIFtzdHJpbmddJFRydWVDcnlwdENvbnRhaW5lclBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJFRydWUsIFBvc2l0aW9uID0gMildCiAgICAgICAgW3N0cmluZ10kUHJlZmVycmVkTW91bnREcml2ZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkVHJ1ZSwgUG9zaXRpb24gPSAzKV0KICAgICAgICBbc3RyaW5nXSRQcm9kdWN0LAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRGYWxzZSwgUG9zaXRpb24gPSA0KV0KICAgICAgICBbYXJyYXldJEtleWZpbGVQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRGYWxzZSwgUG9zaXRpb24gPSA1KV0KICAgICAgICBbYm9vbF0kVGltZXN0YW1wCiAgICApCgogICAgJFBhcmFtc0hhc2ggPSBAewogICAgICAgICAgICAgICAgICAgICAgICAiL3F1aXQiID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICIvdm9sdW1lIiA9ICInJFRydWVDcnlwdENvbnRhaW5lclBhdGgnIjsKICAgICAgICAgICAgICAgICAgICAgICAgIi9sZXR0ZXIiID0gIickUHJlZmVycmVkTW91bnREcml2ZSciOwogICAgICAgICAgICAgICAgICAgICAgICAiL2F1dG8iID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICIvcGFzc3dvcmQiID0gIid7MH0nIjsKICAgICAgICAgICAgICAgICAgICAgICAgIi9leHBsb3JlIiA9ICIiOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAkUGFyYW1zU3RyaW5nID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgIlN5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXIiOwoKICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuSW5zZXJ0KDAsICImICIrJFByb2R1Y3QrIiAiKQoKICAgIGlmICgkVGltZXN0YW1wKSAKICAgIHsKICAgICAgICAkUGFyYW1zSGFzaC5BZGQoIi9tb3VudG9wdGlvbiIsICJ0aW1lc3RhbXAiKQogICAgfQoKICAgICMgYWRkIGtleWZpbGUocykgaWYgYW55IHRvIFBhcmFtc0hhc2guLi4KICAgIGlmICgkS2V5ZmlsZVBhdGguY291bnQgLWd0IDApIAogICAgewogICAgICAgICRLZXlmaWxlUGF0aCB8IEZvckVhY2gtT2JqZWN0IHsgCiAgICAgICAgICAgICRQYXJhbXNIYXNoLkFkZCgiL2tleWZpbGUiLCAiJyRfJyIpCiAgICAgICAgfQogICAgfQogICAgCiAgICAjIHBvcHVsYXRlIFBhcmFtc1N0cmluZyB3aXRoIFBhcmFtc0hhc2ggZGF0YS4uLgogICAgJFBhcmFtc0hhc2guR2V0RW51bWVyYXRvcigpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICMgaWYgbm8gdmFsdWUgYXNzaWduZWQgdG8gdGhpcyBUcnVlQ3J5cHQgYXR0cmlidXRlLCB0aGVuIGp1c3QgYXBwZW5kIGF0dHJpYnV0ZSB0byBQYXJhbXNTdHJpbmcuLi4KICAgICAgICBpZiAoJF8uVmFsdWUuRXF1YWxzKCIiKSkKICAgICAgICB7CiAgICAgICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kRm9ybWF0KCJ7MH0iLCAkXy5LZXkpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kRm9ybWF0KCJ7MH0gezF9IiwgJF8uS2V5LCAkXy5WYWx1ZSkKICAgICAgICB9CgogICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kKCIgIikKICAgIH0KICAgIAogICAgJFBhcmFtc1N0cmluZy5Ub1N0cmluZygpLlRyaW1FbmQoIiAiKTsKfQoKCiMgaW50ZXJuYWwgZnVuY3Rpb24KZnVuY3Rpb24gR2V0LVRydWVDcnlwdERpc21vdW50UGFyYW1zCnsKICAgIFBhcmFtCiAgICAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkRmFsc2UpXQogICAgICAgIFtzdHJpbmddJERyaXZlLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRUcnVlKV0KICAgICAgICBbc3RyaW5nXSRQcm9kdWN0CiAgICApCgogICAgJFBhcmFtc0hhc2ggPSBAewogICAgICAgICAgICAgICAgICAgICIvcXVpdCIgPSAiIjsKICAgICAgICAgICAgICAgICAgICAiL2Rpc21vdW50IiA9ICREcml2ZQogICAgICAgICAgICAgICAgfQogICAgCiAgICAjIEZvcmNlIGRpc21vdW50IGZvciBhbGwgVHJ1ZUNyeXB0IHZvbHVtZXM/IC4uLgogICAgaWYoJERyaXZlIC1lcSAiIikKICAgIHsKICAgICAgICAkUGFyYW1zSGFzaC5BZGQoIi9mb3JjZSIsICIiKQogICAgfQoKICAgICRQYXJhbXNTdHJpbmcgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSAiU3lzdGVtLlRleHQuU3RyaW5nQnVpbGRlciI7CgogICAgW3ZvaWRdJFBhcmFtc1N0cmluZy5JbnNlcnQoMCwgIiYgIiskUHJvZHVjdCsiICIpCgogICAgJFBhcmFtc0hhc2guR2V0RW51bWVyYXRvcigpIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgIGlmICgkXy5WYWx1ZS5FcXVhbHMoIiIpKSAKICAgICAgICB7CiAgICAgICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kRm9ybWF0KCJ7MH0iLCAkXy5LZXkpCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kRm9ybWF0KCJ7MH0gezF9IiwgJF8uS2V5LCAkXy5WYWx1ZSkKICAgICAgICB9CgogICAgICAgIFt2b2lkXSRQYXJhbXNTdHJpbmcuQXBwZW5kKCIgIikKICAgIH0KICAgIAogICAgcmV0dXJuICRQYXJhbXNTdHJpbmcuVG9TdHJpbmcoKS5UcmltRW5kKCIgIikKfQoKIyBpbnRlcm5hbCBmdW5jdGlvbjogZGVzaWduZWQgZm9yIFBlc3RlciBhY2Nlc3MKZnVuY3Rpb24gUmVtb3ZlLUhLQ1VTdWJLZXkKewogICAgUGFyYW0KICAgICgKICAgICAgICBbc3RyaW5nXSRGdWxsUGF0aAogICAgKQogICAgIyB0aGUgQ3VycmVudFVzZXIgaGVyZSBpbmRpY2F0ZXMgSEtFWV9DVVJSRU5UX1VTRVIgaGl2ZS4uLgogICAgW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeV06OkN1cnJlbnRVc2VyLkRlbGV0ZVN1YktleSgkRnVsbFBhdGgsICRUcnVlKQp9
