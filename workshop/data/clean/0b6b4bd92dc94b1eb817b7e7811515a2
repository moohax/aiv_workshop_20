SPWebAppPolicy.psm1,8bb6471495c5abfbc1de07e0ebd049b5,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gQXNzZXJ0LVNQRFNDUG9saWN5VXNlcigpIAp7CiAgICBQYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JGZhbHNlKV0KICAgICAgICBbQXJyYXldIAogICAgICAgICRDdXJyZW50RGlmZmVyZW5jZXMsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbU3RyaW5nXSAKICAgICAgICAkVXNlcm5hbWVUb0NoZWNrCiAgICApCgogICAgZm9yZWFjaCAoJGRpZmZlcmVuY2UgaW4gJEN1cnJlbnREaWZmZXJlbmNlcykgCiAgICB7CiAgICAgICAgaWYoJGRpZmZlcmVuY2UuQ29udGFpbnNLZXkoJFVzZXJuYW1lVG9DaGVjaykpIAogICAgICAgIHsgCiAgICAgICAgICAgIHJldHVybiAkdHJ1ZSAKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJGZhbHNlCn0KCmZ1bmN0aW9uIENvbXBhcmUtU1BEU0NXZWJBcHBQb2xpY3koKSAKewogICAgUGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0gCiAgICAgICAgW0FycmF5XSAKICAgICAgICAkV0FQb2xpY2llcywKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXSAKICAgICAgICBbQXJyYXldIAogICAgICAgICREU0NTZXR0aW5ncywKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXSAKICAgICAgICBbU3RyaW5nXSAKICAgICAgICAkRGVmYXVsdElkZW50aXR5VHlwZQogICAgKQogICAgSW1wb3J0LU1vZHVsZSAtTmFtZSAoSm9pbi1QYXRoIC1QYXRoICRQU1NjcmlwdFJvb3QgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1DaGlsZFBhdGggIi4uXFNoYXJlUG9pbnREc2MuVXRpbFxTaGFyZVBvaW50RHNjLlV0aWwucHNtMSIgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1SZXNvbHZlKQogICAgJGRpZmYgPSBAKCkKCiAgICBmb3JlYWNoICgkcG9saWN5IGluICRXQVBvbGljaWVzKSAKICAgIHsKICAgICAgICAkbWVtYmVyZXhpc3RzID0gJGZhbHNlCiAgICAgICAgZm9yZWFjaCgkc2V0dGluZyBpbiAkRFNDU2V0dGluZ3MpIAogICAgICAgIHsKICAgICAgICAgICAgJGlkZW50aXR5VHlwZSA9ICREZWZhdWx0SWRlbnRpdHlUeXBlCiAgICAgICAgICAgIGlmICgoVGVzdC1TUERTQ09iamVjdEhhc1Byb3BlcnR5IC1PYmplY3QgJHNldHRpbmcgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtUHJvcGVydHlOYW1lICJJZGVudGl0eVR5cGUiKSAtZXEgJHRydWUpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkaWRlbnRpdHlUeXBlID0gJHNldHRpbmcuSWRlbnRpdHlUeXBlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCgkcG9saWN5LlVzZXJuYW1lIC1lcSAkc2V0dGluZy5Vc2VybmFtZSkgLWFuZCBgCiAgICAgICAgICAgICAgICAoJHBvbGljeS5JZGVudGl0eVR5cGUgLWVxICRpZGVudGl0eVR5cGUpKSAKICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgICRtZW1iZXJleGlzdHMgPSAkdHJ1ZQoKICAgICAgICAgICAgICAgICRwb2xiaW5kZGlmZiA9IENvbXBhcmUtT2JqZWN0IC1SZWZlcmVuY2VPYmplY3QgJHBvbGljeS5QZXJtaXNzaW9uTGV2ZWwuVG9Mb3dlcigpIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1EaWZmZXJlbmNlT2JqZWN0ICRzZXR0aW5nLlBlcm1pc3Npb25MZXZlbC5Ub0xvd2VyKCkKCiAgICAgICAgICAgICAgICBpZiAoJG51bGwgLW5lICRwb2xiaW5kZGlmZikgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIlBlcm1pc3Npb24gbGV2ZWwgZGlmZmVyZW50IGZvciAiICsgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIkKCRwb2xpY3kuSWRlbnRpdHlUeXBlKSB1c2VyICckKCRwb2xpY3kuVXNlcm5hbWUpJyIpCgogICAgICAgICAgICAgICAgICAgIGlmICgtbm90IChBc3NlcnQtU1BEU0NQb2xpY3lVc2VyIC1DdXJyZW50RGlmZmVyZW5jZXMgJGRpZmYgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Vc2VybmFtZVRvQ2hlY2sgJHBvbGljeS5Vc2VybmFtZS5Ub0xvd2VyKCkpKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRkaWZmICs9IEB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlcm5hbWUgPSAkcG9saWN5LlVzZXJuYW1lLlRvTG93ZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RhdHVzID0gIkRpZmZlcmVudCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIElkZW50aXR5VHlwZSA9ICRwb2xpY3kuSWRlbnRpdHlUeXBlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNpcmVkUGVybWlzc2lvbkxldmVsID0gJHNldHRpbmcuUGVybWlzc2lvbkxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNpcmVkQWN0QXNTeXN0ZW1TZXR0aW5nID0gJHNldHRpbmcuQWN0QXNTeXN0ZW1BY2NvdW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICgkc2V0dGluZy5BY3RBc1N5c3RlbUFjY291bnQpIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICgkcG9saWN5LkFjdEFzU3lzdGVtQWNjb3VudCAtbmUgJHNldHRpbmcuQWN0QXNTeXN0ZW1BY2NvdW50KSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlN5c3RlbSBVc2VyIGRpZmZlcmVudCBmb3IgIiArIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJCgkcG9saWN5LklkZW50aXR5VHlwZSkgdXNlciAnJCgkcG9saWN5LlVzZXJuYW1lKSciCgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoQXNzZXJ0LVNQRFNDUG9saWN5VXNlciAtQ3VycmVudERpZmZlcmVuY2VzICRkaWZmIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVVzZXJuYW1lVG9DaGVjayAkcG9saWN5LlVzZXJuYW1lLlRvTG93ZXIoKSkpIAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGlmZiArPSBAeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVc2VybmFtZSA9ICRwb2xpY3kuVXNlcm5hbWUuVG9Mb3dlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RhdHVzID0gIkRpZmZlcmVudCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZGVudGl0eVR5cGUgPSAkcG9saWN5LklkZW50aXR5VHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlc2lyZWRQZXJtaXNzaW9uTGV2ZWwgPSAkc2V0dGluZy5QZXJtaXNzaW9uTGV2ZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNpcmVkQWN0QXNTeXN0ZW1TZXR0aW5nID0gJHNldHRpbmcuQWN0QXNTeXN0ZW1BY2NvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgtbm90ICRtZW1iZXJleGlzdHMpIAogICAgICAgIHsKICAgICAgICAgICAgaWYgKC1ub3QgKEFzc2VydC1TUERTQ1BvbGljeVVzZXIgLUN1cnJlbnREaWZmZXJlbmNlcyAkZGlmZiBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Vc2VybmFtZVRvQ2hlY2sgJHBvbGljeS5Vc2VybmFtZS5Ub0xvd2VyKCkpKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGRpZmYgKz0gQHsgCiAgICAgICAgICAgICAgICAgICAgVXNlcm5hbWUgPSAkcG9saWN5LlVzZXJuYW1lLlRvTG93ZXIoKQogICAgICAgICAgICAgICAgICAgIFN0YXR1cyA9ICJBZGRpdGlvbmFsIgogICAgICAgICAgICAgICAgICAgIElkZW50aXR5VHlwZSA9ICRwb2xpY3kuSWRlbnRpdHlUeXBlCiAgICAgICAgICAgICAgICAgICAgRGVzaXJlZFBlcm1pc3Npb25MZXZlbCA9ICRudWxsCiAgICAgICAgICAgICAgICAgICAgRGVzaXJlZEFjdEFzU3lzdGVtU2V0dGluZyA9ICRudWxsCiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZvcmVhY2ggKCRzZXR0aW5nIGluICREU0NTZXR0aW5ncykgCiAgICB7CiAgICAgICAgJG1lbWJlcmV4aXN0cyA9ICRmYWxzZQogICAgICAgICRpZGVudGl0eVR5cGUgPSAkRGVmYXVsdElkZW50aXR5VHlwZQogICAgICAgIGlmICgoVGVzdC1TUERTQ09iamVjdEhhc1Byb3BlcnR5IC1PYmplY3QgJHNldHRpbmcgLVByb3BlcnR5TmFtZSAiSWRlbnRpdHlUeXBlIikgLWVxICR0cnVlKSAKICAgICAgICB7CiAgICAgICAgICAgICRpZGVudGl0eVR5cGUgPSAkc2V0dGluZy5JZGVudGl0eVR5cGUKICAgICAgICB9CiAgICAgICAgZm9yZWFjaCgkcG9saWN5IGluICRXQVBvbGljaWVzKSAKICAgICAgICB7CiAgICAgICAgICAgIGlmICgoJHBvbGljeS5Vc2VybmFtZSAtZXEgJHNldHRpbmcuVXNlcm5hbWUpIC1hbmQgYAogICAgICAgICAgICAgICAgKCRwb2xpY3kuSWRlbnRpdHlUeXBlIC1lcSAkaWRlbnRpdHlUeXBlKSkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRtZW1iZXJleGlzdHMgPSAkdHJ1ZQoKICAgICAgICAgICAgICAgICRwb2xiaW5kZGlmZiA9IENvbXBhcmUtT2JqZWN0IC1SZWZlcmVuY2VPYmplY3QgJHBvbGljeS5QZXJtaXNzaW9uTGV2ZWwuVG9Mb3dlcigpIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1EaWZmZXJlbmNlT2JqZWN0ICRzZXR0aW5nLlBlcm1pc3Npb25MZXZlbC5Ub0xvd2VyKCkKICAgICAgICAgICAgICAgIGlmICgkbnVsbCAtbmUgJHBvbGJpbmRkaWZmKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICgiUGVybWlzc2lvbiBsZXZlbCBkaWZmZXJlbnQgZm9yICIgKyBgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJCgkcG9saWN5LklkZW50aXR5VHlwZSkgdXNlciAnJCgkcG9saWN5LlVzZXJuYW1lKSciKQoKICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoQXNzZXJ0LVNQRFNDUG9saWN5VXNlciAtQ3VycmVudERpZmZlcmVuY2VzICRkaWZmIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtVXNlcm5hbWVUb0NoZWNrICRwb2xpY3kuVXNlcm5hbWUuVG9Mb3dlcigpKSkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkZGlmZiArPSBAeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJuYW1lID0gJHNldHRpbmcuVXNlcm5hbWUuVG9Mb3dlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdGF0dXMgPSAiRGlmZmVyZW50IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgSWRlbnRpdHlUeXBlID0gJGlkZW50aXR5VHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzaXJlZFBlcm1pc3Npb25MZXZlbCA9ICRzZXR0aW5nLlBlcm1pc3Npb25MZXZlbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzaXJlZEFjdEFzU3lzdGVtU2V0dGluZyA9ICRzZXR0aW5nLkFjdEFzU3lzdGVtQWNjb3VudAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgkc2V0dGluZy5BY3RBc1N5c3RlbUFjY291bnQpIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICgkcG9saWN5LkFjdEFzU3lzdGVtQWNjb3VudCAtbmUgJHNldHRpbmcuQWN0QXNTeXN0ZW1BY2NvdW50KSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlN5c3RlbSBVc2VyIGRpZmZlcmVudCBmb3IgIiArIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJCgkcG9saWN5LklkZW50aXR5VHlwZSkgdXNlciAnJCgkcG9saWN5LlVzZXJuYW1lKSciCgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoLW5vdCAoQXNzZXJ0LVNQRFNDUG9saWN5VXNlciAtQ3VycmVudERpZmZlcmVuY2VzICRkaWZmIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVVzZXJuYW1lVG9DaGVjayAkcG9saWN5LlVzZXJuYW1lLlRvTG93ZXIoKSkpIAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGlmZiArPSBAeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVc2VybmFtZSA9ICRzZXR0aW5nLlVzZXJuYW1lLlRvTG93ZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXR1cyA9ICJEaWZmZXJlbnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSWRlbnRpdHlUeXBlID0gJGlkZW50aXR5VHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlc2lyZWRQZXJtaXNzaW9uTGV2ZWwgPSAkc2V0dGluZy5QZXJtaXNzaW9uTGV2ZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNpcmVkQWN0QXNTeXN0ZW1TZXR0aW5nID0gJHNldHRpbmcuQWN0QXNTeXN0ZW1BY2NvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKC1ub3QgJG1lbWJlcmV4aXN0cykgCiAgICAgICAgewogICAgICAgICAgICBpZiAoLW5vdCAoQXNzZXJ0LVNQRFNDUG9saWN5VXNlciAtQ3VycmVudERpZmZlcmVuY2VzICRkaWZmIGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVVzZXJuYW1lVG9DaGVjayAkc2V0dGluZy5Vc2VybmFtZS5Ub0xvd2VyKCkpKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGRpZmYgKz0gQHsgCiAgICAgICAgICAgICAgICAgICAgVXNlcm5hbWUgPSAkc2V0dGluZy5Vc2VybmFtZS5Ub0xvd2VyKCkKICAgICAgICAgICAgICAgICAgICBTdGF0dXMgPSAiTWlzc2luZyIKICAgICAgICAgICAgICAgICAgICBJZGVudGl0eVR5cGUgPSAkaWRlbnRpdHlUeXBlCiAgICAgICAgICAgICAgICAgICAgRGVzaXJlZFBlcm1pc3Npb25MZXZlbCA9ICRzZXR0aW5nLlBlcm1pc3Npb25MZXZlbAogICAgICAgICAgICAgICAgICAgIERlc2lyZWRBY3RBc1N5c3RlbVNldHRpbmcgPSAkc2V0dGluZy5BY3RBc1N5c3RlbUFjY291bnQKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJGRpZmYKfQo=
