psake.psm1,c9f6b86374b107fcdd11a2fb16e13e8e,Scan result is 1. IsMalware: 0,IyBwc2FrZQojIENvcHlyaWdodCAoYykgMjAxMiBKYW1lcyBLb3ZhY3MKIyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CiMgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKIyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCiMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAojIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwojIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CiMKIyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgojIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgojCiMgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKIyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKIyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKIyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCiMgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKIyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCiMgVEhFIFNPRlRXQVJFLgoKI1JlcXVpcmVzIC1WZXJzaW9uIDIuMAoKIy0tIFB1YmxpYyBNb2R1bGUgRnVuY3Rpb25zIC0tIwoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEludm9rZS1UYXNrCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXSBbc3RyaW5nXSR0YXNrTmFtZQogICAgKQoKICAgIEFzc2VydCAkdGFza05hbWUgKCRtc2dzLmVycm9yX2ludmFsaWRfdGFza19uYW1lKQoKICAgICR0YXNrS2V5ID0gJHRhc2tOYW1lLlRvTG93ZXIoKQoKICAgIGlmICgkY3VycmVudENvbnRleHQuYWxpYXNlcy5Db250YWlucygkdGFza0tleSkpIHsKICAgICAgICAkdGFza05hbWUgPSAkY3VycmVudENvbnRleHQuYWxpYXNlcy4kdGFza0tleS5OYW1lCiAgICAgICAgJHRhc2tLZXkgPSAkdGFza05hbWUuVG9Mb3dlcigpCiAgICB9CgogICAgJGN1cnJlbnRDb250ZXh0ID0gJHBzYWtlLmNvbnRleHQuUGVlaygpCgogICAgQXNzZXJ0ICgkY3VycmVudENvbnRleHQudGFza3MuQ29udGFpbnMoJHRhc2tLZXkpKSAoJG1zZ3MuZXJyb3JfdGFza19uYW1lX2RvZXNfbm90X2V4aXN0IC1mICR0YXNrTmFtZSkKCiAgICBpZiAoJGN1cnJlbnRDb250ZXh0LmV4ZWN1dGVkVGFza3MuQ29udGFpbnMoJHRhc2tLZXkpKSAgeyByZXR1cm4gfQoKICAgIEFzc2VydCAoISRjdXJyZW50Q29udGV4dC5jYWxsU3RhY2suQ29udGFpbnMoJHRhc2tLZXkpKSAoJG1zZ3MuZXJyb3JfY2lyY3VsYXJfcmVmZXJlbmNlIC1mICR0YXNrTmFtZSkKCiAgICAkY3VycmVudENvbnRleHQuY2FsbFN0YWNrLlB1c2goJHRhc2tLZXkpCgogICAgJHRhc2sgPSAkY3VycmVudENvbnRleHQudGFza3MuJHRhc2tLZXkKCiAgICAkcHJlY29uZGl0aW9uX2lzX3ZhbGlkID0gJiAkdGFzay5QcmVjb25kaXRpb24KCiAgICBpZiAoISRwcmVjb25kaXRpb25faXNfdmFsaWQpIHsKICAgICAgICBXcml0ZUNvbG9yZWRPdXRwdXQgKCRtc2dzLnByZWNvbmRpdGlvbl93YXNfZmFsc2UgLWYgJHRhc2tOYW1lKSAtZm9yZWdyb3VuZGNvbG9yIEN5YW4KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCR0YXNrS2V5IC1uZSAnZGVmYXVsdCcpIHsKCiAgICAgICAgICAgIGlmICgkdGFzay5QcmVBY3Rpb24gLW9yICR0YXNrLlBvc3RBY3Rpb24pIHsKICAgICAgICAgICAgICAgIEFzc2VydCAoJHRhc2suQWN0aW9uIC1uZSAkbnVsbCkgKCRtc2dzLmVycm9yX21pc3NpbmdfYWN0aW9uX3BhcmFtZXRlciAtZiAkdGFza05hbWUpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkdGFzay5BY3Rpb24pIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkY2hpbGRUYXNrIGluICR0YXNrLkRlcGVuZHNPbikgewogICAgICAgICAgICAgICAgICAgICAgICBJbnZva2UtVGFzayAkY2hpbGRUYXNrCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkc3RvcHdhdGNoID0gW1N5c3RlbS5EaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRDb250ZXh0LmN1cnJlbnRUYXNrTmFtZSA9ICR0YXNrTmFtZQoKICAgICAgICAgICAgICAgICAgICAmICRjdXJyZW50Q29udGV4dC50YXNrU2V0dXBTY3JpcHRCbG9jawoKICAgICAgICAgICAgICAgICAgICBpZiAoJHRhc2suUHJlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICYgJHRhc2suUHJlQWN0aW9uCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoJGN1cnJlbnRDb250ZXh0LmNvbmZpZy50YXNrTmFtZUZvcm1hdCAtaXMgW1NjcmlwdEJsb2NrXSkgewogICAgICAgICAgICAgICAgICAgICAgICAmICRjdXJyZW50Q29udGV4dC5jb25maWcudGFza05hbWVGb3JtYXQgJHRhc2tOYW1lCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGVDb2xvcmVkT3V0cHV0ICgkY3VycmVudENvbnRleHQuY29uZmlnLnRhc2tOYW1lRm9ybWF0IC1mICR0YXNrTmFtZSkgLWZvcmVncm91bmRjb2xvciBDeWFuCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkdmFyaWFibGUgaW4gJHRhc2sucmVxdWlyZWRWYXJpYWJsZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgQXNzZXJ0ICgodGVzdC1wYXRoICJ2YXJpYWJsZTokdmFyaWFibGUiKSAtYW5kICgoZ2V0LXZhcmlhYmxlICR2YXJpYWJsZSkuVmFsdWUgLW5lICRudWxsKSkgKCRtc2dzLnJlcXVpcmVkX3ZhcmlhYmxlX25vdF9zZXQgLWYgJHZhcmlhYmxlLCAkdGFza05hbWUpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAmICR0YXNrLkFjdGlvbgoKICAgICAgICAgICAgICAgICAgICBpZiAoJHRhc2suUG9zdEFjdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAmICR0YXNrLlBvc3RBY3Rpb24KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICYgJGN1cnJlbnRDb250ZXh0LnRhc2tUZWFyRG93blNjcmlwdEJsb2NrCiAgICAgICAgICAgICAgICAgICAgJHRhc2suRHVyYXRpb24gPSAkc3RvcHdhdGNoLkVsYXBzZWQKICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIGlmICgkdGFzay5Db250aW51ZU9uRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIi0iKjcwCiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlQ29sb3JlZE91dHB1dCAoJG1zZ3MuY29udGludWVfb25fZXJyb3IgLWYgJHRhc2tOYW1lLCRfKSAtZm9yZWdyb3VuZGNvbG9yIFllbGxvdwogICAgICAgICAgICAgICAgICAgICAgICAiLSIqNzAKICAgICAgICAgICAgICAgICAgICAgICAgJHRhc2suRHVyYXRpb24gPSAkc3RvcHdhdGNoLkVsYXBzZWQKICAgICAgICAgICAgICAgICAgICB9ICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgJF8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAjIG5vIGFjdGlvbiB3YXMgc3BlY2lmaWVkIGJ1dCB3ZSBzdGlsbCBleGVjdXRlIGFsbCB0aGUgZGVwZW5kZW5jaWVzCiAgICAgICAgICAgICAgICBmb3JlYWNoKCRjaGlsZFRhc2sgaW4gJHRhc2suRGVwZW5kc09uKSB7CiAgICAgICAgICAgICAgICAgICAgSW52b2tlLVRhc2sgJGNoaWxkVGFzawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yZWFjaCgkY2hpbGRUYXNrIGluICR0YXNrLkRlcGVuZHNPbikgewogICAgICAgICAgICAgICAgSW52b2tlLVRhc2sgJGNoaWxkVGFzawogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBBc3NlcnQgKCYgJHRhc2suUG9zdGNvbmRpdGlvbikgKCRtc2dzLnBvc3Rjb25kaXRpb25fZmFpbGVkIC1mICR0YXNrTmFtZSkKICAgIH0KCiAgICAkcG9wcGVkVGFza0tleSA9ICRjdXJyZW50Q29udGV4dC5jYWxsU3RhY2suUG9wKCkKICAgIEFzc2VydCAoJHBvcHBlZFRhc2tLZXkgLWVxICR0YXNrS2V5KSAoJG1zZ3MuZXJyb3JfY29ycnVwdF9jYWxsc3RhY2sgLWYgJHRhc2tLZXksJHBvcHBlZFRhc2tLZXkpCgogICAgJGN1cnJlbnRDb250ZXh0LmV4ZWN1dGVkVGFza3MuUHVzaCgkdGFza0tleSkKfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEV4ZWMKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnk9MSldW3NjcmlwdGJsb2NrXSRjbWQsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0xLE1hbmRhdG9yeT0wKV1bc3RyaW5nXSRlcnJvck1lc3NhZ2UgPSAoJG1zZ3MuZXJyb3JfYmFkX2NvbW1hbmQgLWYgJGNtZCksCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0yLE1hbmRhdG9yeT0wKV1baW50XSRtYXhSZXRyaWVzID0gMCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTMsTWFuZGF0b3J5PTApXVtzdHJpbmddJHJldHJ5VHJpZ2dlckVycm9yUGF0dGVybiA9ICRudWxsCiAgICApCgogICAgJHRyeUNvdW50ID0gMQoKICAgIGRvIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkZ2xvYmFsOmxhc3RleGl0Y29kZSA9IDAKICAgICAgICAgICAgJiAkY21kCiAgICAgICAgICAgIGlmICgkbGFzdGV4aXRjb2RlIC1uZSAwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAoIkV4ZWM6ICIgKyAkZXJyb3JNZXNzYWdlKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIGNhdGNoIFtFeGNlcHRpb25dCiAgICAgICAgewogICAgICAgICAgICBpZiAoJHRyeUNvdW50IC1ndCAkbWF4UmV0cmllcykgewogICAgICAgICAgICAgICAgdGhyb3cgJF8KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCRyZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4gLW5lICRudWxsKSB7CiAgICAgICAgICAgICAgICAkaXNNYXRjaCA9IFtyZWdleF06OklzTWF0Y2goJF8uRXhjZXB0aW9uLk1lc3NhZ2UsICRyZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4pCgogICAgICAgICAgICAgICAgaWYgKCRpc01hdGNoIC1lcSAkZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyAkXwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBXcml0ZS1Ib3N0ICJUcnkgJHRyeUNvdW50IGZhaWxlZCwgcmV0cnlpbmcgYWdhaW4gaW4gMSBzZWNvbmQuLi4iCgogICAgICAgICAgICAkdHJ5Q291bnQrKwoKICAgICAgICAgICAgW1N5c3RlbS5UaHJlYWRpbmcuVGhyZWFkXTo6U2xlZXAoW1N5c3RlbS5UaW1lU3Bhbl06OkZyb21TZWNvbmRzKDEpKQogICAgICAgIH0KICAgIH0KICAgIHdoaWxlICgkdHJ1ZSkKfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEFzc2VydAp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV0kY29uZGl0aW9uVG9DaGVjaywKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTEsTWFuZGF0b3J5PTEpXSRmYWlsdXJlTWVzc2FnZQogICAgKQogICAgaWYgKCEkY29uZGl0aW9uVG9DaGVjaykgewogICAgICAgIHRocm93ICgiQXNzZXJ0OiAiICsgJGZhaWx1cmVNZXNzYWdlKQogICAgfQp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gVGFzawp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc3RyaW5nXSRuYW1lID0gJG51bGwsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0xLE1hbmRhdG9yeT0wKV1bc2NyaXB0YmxvY2tdJGFjdGlvbiA9ICRudWxsLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MixNYW5kYXRvcnk9MCldW3NjcmlwdGJsb2NrXSRwcmVhY3Rpb24gPSAkbnVsbCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTMsTWFuZGF0b3J5PTApXVtzY3JpcHRibG9ja10kcG9zdGFjdGlvbiA9ICRudWxsLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249NCxNYW5kYXRvcnk9MCldW3NjcmlwdGJsb2NrXSRwcmVjb25kaXRpb24gPSB7JHRydWV9LAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249NSxNYW5kYXRvcnk9MCldW3NjcmlwdGJsb2NrXSRwb3N0Y29uZGl0aW9uID0geyR0cnVlfSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTYsTWFuZGF0b3J5PTApXVtzd2l0Y2hdJGNvbnRpbnVlT25FcnJvciA9ICRmYWxzZSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTcsTWFuZGF0b3J5PTApXVtzdHJpbmdbXV0kZGVwZW5kcyA9IEAoKSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTgsTWFuZGF0b3J5PTApXVtzdHJpbmdbXV0kcmVxdWlyZWRWYXJpYWJsZXMgPSBAKCksCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj05LE1hbmRhdG9yeT0wKV1bc3RyaW5nXSRkZXNjcmlwdGlvbiA9ICRudWxsLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MTAsTWFuZGF0b3J5PTApXVtzdHJpbmddJGFsaWFzID0gJG51bGwsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0xMSxNYW5kYXRvcnk9MCldW3N0cmluZ10kbWF4UmV0cmllcyA9IDAsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0xMixNYW5kYXRvcnk9MCldW3N0cmluZ10kcmV0cnlUcmlnZ2VyRXJyb3JQYXR0ZXJuID0gJG51bGwKICAgICkKICAgIGlmICgkbmFtZSAtZXEgJ2RlZmF1bHQnKSB7CiAgICAgICAgQXNzZXJ0ICghJGFjdGlvbikgKCRtc2dzLmVycm9yX2RlZmF1bHRfdGFza19jYW5ub3RfaGF2ZV9hY3Rpb24pCiAgICB9CgogICAgJG5ld1Rhc2sgPSBAewogICAgICAgIE5hbWUgPSAkbmFtZQogICAgICAgIERlcGVuZHNPbiA9ICRkZXBlbmRzCiAgICAgICAgUHJlQWN0aW9uID0gJHByZWFjdGlvbgogICAgICAgIEFjdGlvbiA9ICRhY3Rpb24KICAgICAgICBQb3N0QWN0aW9uID0gJHBvc3RhY3Rpb24KICAgICAgICBQcmVjb25kaXRpb24gPSAkcHJlY29uZGl0aW9uCiAgICAgICAgUG9zdGNvbmRpdGlvbiA9ICRwb3N0Y29uZGl0aW9uCiAgICAgICAgQ29udGludWVPbkVycm9yID0gJGNvbnRpbnVlT25FcnJvcgogICAgICAgIERlc2NyaXB0aW9uID0gJGRlc2NyaXB0aW9uCiAgICAgICAgRHVyYXRpb24gPSBbU3lzdGVtLlRpbWVTcGFuXTo6WmVybwogICAgICAgIFJlcXVpcmVkVmFyaWFibGVzID0gJHJlcXVpcmVkVmFyaWFibGVzCiAgICAgICAgQWxpYXMgPSAkYWxpYXMKICAgICAgICBNYXhSZXRyaWVzID0gJG1heFJldHJpZXMKICAgICAgICBSZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4gPSAkcmV0cnlUcmlnZ2VyRXJyb3JQYXR0ZXJuCiAgICB9CgogICAgJHRhc2tLZXkgPSAkbmFtZS5Ub0xvd2VyKCkKCiAgICAkY3VycmVudENvbnRleHQgPSAkcHNha2UuY29udGV4dC5QZWVrKCkKCiAgICBBc3NlcnQgKCEkY3VycmVudENvbnRleHQudGFza3MuQ29udGFpbnNLZXkoJHRhc2tLZXkpKSAoJG1zZ3MuZXJyb3JfZHVwbGljYXRlX3Rhc2tfbmFtZSAtZiAkbmFtZSkKCiAgICAkY3VycmVudENvbnRleHQudGFza3MuJHRhc2tLZXkgPSAkbmV3VGFzawoKICAgIGlmKCRhbGlhcykKICAgIHsKICAgICAgICAkYWxpYXNLZXkgPSAkYWxpYXMuVG9Mb3dlcigpCgogICAgICAgIEFzc2VydCAoISRjdXJyZW50Q29udGV4dC5hbGlhc2VzLkNvbnRhaW5zS2V5KCRhbGlhc0tleSkpICgkbXNncy5lcnJvcl9kdXBsaWNhdGVfYWxpYXNfbmFtZSAtZiAkYWxpYXMpCgogICAgICAgICRjdXJyZW50Q29udGV4dC5hbGlhc2VzLiRhbGlhc0tleSA9ICRuZXdUYXNrCiAgICB9Cn0KCiMgLkV4dGVybmFsSGVscCAgcHNha2UucHNtMS1oZWxwLnhtbApmdW5jdGlvbiBQcm9wZXJ0aWVzIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXVtzY3JpcHRibG9ja10kcHJvcGVydGllcwogICAgKQogICAgJHBzYWtlLmNvbnRleHQuUGVlaygpLnByb3BlcnRpZXMgKz0gJHByb3BlcnRpZXMKfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEluY2x1ZGUgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnk9MSldW3N0cmluZ10kZmlsZU5hbWVQYXRoVG9JbmNsdWRlCiAgICApCiAgICBBc3NlcnQgKHRlc3QtcGF0aCAkZmlsZU5hbWVQYXRoVG9JbmNsdWRlIC1wYXRoVHlwZSBMZWFmKSAoJG1zZ3MuZXJyb3JfaW52YWxpZF9pbmNsdWRlX3BhdGggLWYgJGZpbGVOYW1lUGF0aFRvSW5jbHVkZSkKICAgICRwc2FrZS5jb250ZXh0LlBlZWsoKS5pbmNsdWRlcy5FbnF1ZXVlKChSZXNvbHZlLVBhdGggJGZpbGVOYW1lUGF0aFRvSW5jbHVkZSkpOwp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gRm9ybWF0VGFza05hbWUgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnk9MSldJGZvcm1hdAogICAgKQogICAgJHBzYWtlLmNvbnRleHQuUGVlaygpLmNvbmZpZy50YXNrTmFtZUZvcm1hdCA9ICRmb3JtYXQKfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIFRhc2tTZXR1cCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc2NyaXB0YmxvY2tdJHNldHVwCiAgICApCiAgICAkcHNha2UuY29udGV4dC5QZWVrKCkudGFza1NldHVwU2NyaXB0QmxvY2sgPSAkc2V0dXAKfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIFRhc2tUZWFyRG93biB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc2NyaXB0YmxvY2tdJHRlYXJkb3duCiAgICApCiAgICAkcHNha2UuY29udGV4dC5QZWVrKCkudGFza1RlYXJEb3duU2NyaXB0QmxvY2sgPSAkdGVhcmRvd24KfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEZyYW1ld29yayB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc3RyaW5nXSRmcmFtZXdvcmsKICAgICkKICAgICRwc2FrZS5jb250ZXh0LlBlZWsoKS5jb25maWcuZnJhbWV3b3JrID0gJGZyYW1ld29yawogICAgQ29uZmlndXJlQnVpbGRFbnZpcm9ubWVudAp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gSW52b2tlLXBzYWtlIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gMCldW3N0cmluZ10gJGJ1aWxkRmlsZSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gMCldW3N0cmluZ1tdXSAkdGFza0xpc3QgPSBAKCksCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDIsIE1hbmRhdG9yeSA9IDApXVtzdHJpbmddICRmcmFtZXdvcmssCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDMsIE1hbmRhdG9yeSA9IDApXVtzd2l0Y2hdICRkb2NzID0gJGZhbHNlLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA0LCBNYW5kYXRvcnkgPSAwKV1baGFzaHRhYmxlXSAkcGFyYW1ldGVycyA9IEB7fSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNSwgTWFuZGF0b3J5ID0gMCldW2hhc2h0YWJsZV0gJHByb3BlcnRpZXMgPSBAe30sCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDYsIE1hbmRhdG9yeSA9IDApXVthbGlhcygiaW5pdCIpXVtzY3JpcHRibG9ja10gJGluaXRpYWxpemF0aW9uID0ge30sCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDcsIE1hbmRhdG9yeSA9IDApXVtzd2l0Y2hdICRub2xvZ28gPSAkZmFsc2UsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDgsIE1hbmRhdG9yeSA9IDApXVtzd2l0Y2hdICRkZXRhaWxlZERvY3MgPSAkZmFsc2UKICAgICkKICAgIHRyeSB7CiAgICAgICAgaWYgKC1ub3QgJG5vbG9nbykgewogICAgICAgICAgICAicHNha2UgdmVyc2lvbiB7MH1gbkNvcHlyaWdodCAoYykgMjAxMC0yMDE1IEphbWVzIEtvdmFjcywgRGFtaWFuIEhpY2tleSAmIENvbnRyaWJ1dG9yc2BuIiAtZiAkcHNha2UudmVyc2lvbgogICAgICAgIH0KCiAgICAgICAgaWYgKCEkYnVpbGRGaWxlKSB7CiAgICAgICAgICAkYnVpbGRGaWxlID0gJHBzYWtlLmNvbmZpZ19kZWZhdWx0LmJ1aWxkRmlsZU5hbWUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICghKHRlc3QtcGF0aCAkYnVpbGRGaWxlIC1wYXRoVHlwZSBMZWFmKSAtYW5kICh0ZXN0LXBhdGggJHBzYWtlLmNvbmZpZ19kZWZhdWx0LmJ1aWxkRmlsZU5hbWUgLXBhdGhUeXBlIExlYWYpKSB7CiAgICAgICAgICAgICMgSWYgdGhlICRjb25maWcuYnVpbGRGaWxlTmFtZSBmaWxlIGV4aXN0cyBhbmQgdGhlIGdpdmVuICJidWlsZGZpbGUiIGlzbiAndCBmb3VuZCBhc3N1bWUgdGhhdCB0aGUgZ2l2ZW4KICAgICAgICAgICAgIyAkYnVpbGRGaWxlIGlzIGFjdHVhbGx5IHRoZSB0YXJnZXQgVGFza3MgdG8gZXhlY3V0ZSBpbiB0aGUgJGNvbmZpZy5idWlsZEZpbGVOYW1lIHNjcmlwdC4KICAgICAgICAgICAgJHRhc2tMaXN0ID0gJGJ1aWxkRmlsZS5TcGxpdCgnLCAnKQogICAgICAgICAgICAkYnVpbGRGaWxlID0gJHBzYWtlLmNvbmZpZ19kZWZhdWx0LmJ1aWxkRmlsZU5hbWUKICAgICAgICB9CgogICAgICAgICMgRXhlY3V0ZSB0aGUgYnVpbGQgZmlsZSB0byBzZXQgdXAgdGhlIHRhc2tzIGFuZCBkZWZhdWx0cwogICAgICAgIEFzc2VydCAodGVzdC1wYXRoICRidWlsZEZpbGUgLXBhdGhUeXBlIExlYWYpICgkbXNncy5lcnJvcl9idWlsZF9maWxlX25vdF9mb3VuZCAtZiAkYnVpbGRGaWxlKQoKICAgICAgICAkcHNha2UuYnVpbGRfc2NyaXB0X2ZpbGUgPSBnZXQtaXRlbSAkYnVpbGRGaWxlCiAgICAgICAgJHBzYWtlLmJ1aWxkX3NjcmlwdF9kaXIgPSAkcHNha2UuYnVpbGRfc2NyaXB0X2ZpbGUuRGlyZWN0b3J5TmFtZQogICAgICAgICRwc2FrZS5idWlsZF9zdWNjZXNzID0gJGZhbHNlCgogICAgICAgICRwc2FrZS5jb250ZXh0LnB1c2goQHsKICAgICAgICAgICAgInRhc2tTZXR1cFNjcmlwdEJsb2NrIiA9IHt9OwogICAgICAgICAgICAidGFza1RlYXJEb3duU2NyaXB0QmxvY2siID0ge307CiAgICAgICAgICAgICJleGVjdXRlZFRhc2tzIiA9IG5ldy1vYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlN0YWNrOwogICAgICAgICAgICAiY2FsbFN0YWNrIiA9IG5ldy1vYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlN0YWNrOwogICAgICAgICAgICAib3JpZ2luYWxFbnZQYXRoIiA9ICRlbnY6cGF0aDsKICAgICAgICAgICAgIm9yaWdpbmFsRGlyZWN0b3J5IiA9IGdldC1sb2NhdGlvbjsKICAgICAgICAgICAgIm9yaWdpbmFsRXJyb3JBY3Rpb25QcmVmZXJlbmNlIiA9ICRnbG9iYWw6RXJyb3JBY3Rpb25QcmVmZXJlbmNlOwogICAgICAgICAgICAidGFza3MiID0gQHt9OwogICAgICAgICAgICAiYWxpYXNlcyIgPSBAe307CiAgICAgICAgICAgICJwcm9wZXJ0aWVzIiA9IEAoKTsKICAgICAgICAgICAgImluY2x1ZGVzIiA9IG5ldy1vYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlF1ZXVlOwogICAgICAgICAgICAiY29uZmlnIiA9IENyZWF0ZUNvbmZpZ3VyYXRpb25Gb3JOZXdDb250ZXh0ICRidWlsZEZpbGUgJGZyYW1ld29yawogICAgICAgIH0pCgogICAgICAgIExvYWRDb25maWd1cmF0aW9uICRwc2FrZS5idWlsZF9zY3JpcHRfZGlyCgogICAgICAgICRzdG9wd2F0Y2ggPSBbU3lzdGVtLkRpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKCiAgICAgICAgc2V0LWxvY2F0aW9uICRwc2FrZS5idWlsZF9zY3JpcHRfZGlyCgogICAgICAgIExvYWRNb2R1bGVzCgogICAgICAgICRmcmFtZXdvcmtPbGRWYWx1ZSA9ICRmcmFtZXdvcmsKICAgICAgICAuICRwc2FrZS5idWlsZF9zY3JpcHRfZmlsZS5GdWxsTmFtZQoKICAgICAgICAkY3VycmVudENvbnRleHQgPSAkcHNha2UuY29udGV4dC5QZWVrKCkKCiAgICAgICAgaWYgKCRmcmFtZXdvcmsgLW5lICRmcmFtZXdvcmtPbGRWYWx1ZSkgewogICAgICAgICAgICB3cml0ZWNvbG9yZWRvdXRwdXQgJG1zZ3Mud2FybmluZ19kZXByZWNhdGVkX2ZyYW1ld29ya192YXJpYWJsZSAtZm9yZWdyb3VuZGNvbG9yIFllbGxvdwogICAgICAgICAgICAkY3VycmVudENvbnRleHQuY29uZmlnLmZyYW1ld29yayA9ICRmcmFtZXdvcmsKICAgICAgICB9CgogICAgICAgIENvbmZpZ3VyZUJ1aWxkRW52aXJvbm1lbnQKCiAgICAgICAgd2hpbGUgKCRjdXJyZW50Q29udGV4dC5pbmNsdWRlcy5Db3VudCAtZ3QgMCkgewogICAgICAgICAgICAkaW5jbHVkZUZpbGVuYW1lID0gJGN1cnJlbnRDb250ZXh0LmluY2x1ZGVzLkRlcXVldWUoKQogICAgICAgICAgICAuICRpbmNsdWRlRmlsZW5hbWUKICAgICAgICB9CgogICAgICAgIGlmICgkZG9jcyAtb3IgJGRldGFpbGVkRG9jcykgewogICAgICAgICAgICBXcml0ZURvY3VtZW50YXRpb24oJGRldGFpbGVkRG9jcykKICAgICAgICAgICAgQ2xlYW51cEVudmlyb25tZW50CiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgZm9yZWFjaCAoJGtleSBpbiAkcGFyYW1ldGVycy5rZXlzKSB7CiAgICAgICAgICAgIGlmICh0ZXN0LXBhdGggInZhcmlhYmxlOlwka2V5IikgewogICAgICAgICAgICAgICAgc2V0LWl0ZW0gLXBhdGggInZhcmlhYmxlOlwka2V5IiAtdmFsdWUgJHBhcmFtZXRlcnMuJGtleSAtV2hhdElmOiRmYWxzZSAtQ29uZmlybTokZmFsc2UgfCBvdXQtbnVsbAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3LWl0ZW0gLXBhdGggInZhcmlhYmxlOlwka2V5IiAtdmFsdWUgJHBhcmFtZXRlcnMuJGtleSAtV2hhdElmOiRmYWxzZSAtQ29uZmlybTokZmFsc2UgfCBvdXQtbnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIFRoZSBpbml0aWFsIGRvdCAoLikgaW5kaWNhdGVzIHRoYXQgdmFyaWFibGVzIGluaXRpYWxpemVkL21vZGlmaWVkIGluIHRoZSBwcm9wZXJ0eUJsb2NrIGFyZSBhdmFpbGFibGUgaW4gdGhlIHBhcmVudCBzY29wZS4KICAgICAgICBmb3JlYWNoICgkcHJvcGVydHlCbG9jayBpbiAkY3VycmVudENvbnRleHQucHJvcGVydGllcykgewogICAgICAgICAgICAuICRwcm9wZXJ0eUJsb2NrCiAgICAgICAgfQoKICAgICAgICBmb3JlYWNoICgka2V5IGluICRwcm9wZXJ0aWVzLmtleXMpIHsKICAgICAgICAgICAgaWYgKHRlc3QtcGF0aCAidmFyaWFibGU6XCRrZXkiKSB7CiAgICAgICAgICAgICAgICBzZXQtaXRlbSAtcGF0aCAidmFyaWFibGU6XCRrZXkiIC12YWx1ZSAkcHJvcGVydGllcy4ka2V5IC1XaGF0SWY6JGZhbHNlIC1Db25maXJtOiRmYWxzZSB8IG91dC1udWxsCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgU2ltcGxlIGRvdCBzb3VyY2luZyB3aWxsIG5vdCB3b3JrLiBXZSBoYXZlIHRvIGZvcmNlIHRoZSBzY3JpcHQgYmxvY2sgaW50byBvdXIKICAgICAgICAjIG1vZHVsZSdzIHNjb3BlIGluIG9yZGVyIHRvIGluaXRpYWxpemUgdmFyaWFibGVzIHByb3Blcmx5LgogICAgICAgIC4gJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuTW9kdWxlICRpbml0aWFsaXphdGlvbgoKICAgICAgICAjIEV4ZWN1dGUgdGhlIGxpc3Qgb2YgdGFza3Mgb3IgdGhlIGRlZmF1bHQgdGFzawogICAgICAgIGlmICgkdGFza0xpc3QpIHsKICAgICAgICAgICAgZm9yZWFjaCAoJHRhc2sgaW4gJHRhc2tMaXN0KSB7CiAgICAgICAgICAgICAgICBpbnZva2UtdGFzayAkdGFzawogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlaWYgKCRjdXJyZW50Q29udGV4dC50YXNrcy5kZWZhdWx0KSB7CiAgICAgICAgICAgIGludm9rZS10YXNrIGRlZmF1bHQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyAkbXNncy5lcnJvcl9ub19kZWZhdWx0X3Rhc2sKICAgICAgICB9CgogICAgICAgIFdyaXRlQ29sb3JlZE91dHB1dCAoImBuIiArICRtc2dzLmJ1aWxkX3N1Y2Nlc3MgKyAiYG4iKSAtZm9yZWdyb3VuZGNvbG9yIEdyZWVuCgogICAgICAgIFdyaXRlVGFza1RpbWVTdW1tYXJ5ICRzdG9wd2F0Y2guRWxhcHNlZAoKICAgICAgICAkcHNha2UuYnVpbGRfc3VjY2VzcyA9ICR0cnVlCiAgICB9IGNhdGNoIHsKICAgICAgICAkY3VycmVudENvbmZpZyA9IEdldEN1cnJlbnRDb25maWd1cmF0aW9uT3JEZWZhdWx0CiAgICAgICAgaWYgKCRjdXJyZW50Q29uZmlnLnZlcmJvc2VFcnJvcikgewogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSA9ICJ7MH06IEFuIEVycm9yIE9jY3VycmVkLiBTZWUgRXJyb3IgRGV0YWlscyBCZWxvdzogYG4iIC1mIChHZXQtRGF0ZSkKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gKCItIiAqIDcwKSArICJgbiIKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gIkVycm9yOiB7MH1gbiIgLWYgKFJlc29sdmVFcnJvciAkXyAtU2hvcnQpCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9ICgiLSIgKiA3MCkgKyAiYG4iCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9IFJlc29sdmVFcnJvciAkXwogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSArPSAoIi0iICogNzApICsgImBuIgogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSArPSAiU2NyaXB0IFZhcmlhYmxlcyIgKyAiYG4iCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9ICgiLSIgKiA3MCkgKyAiYG4iCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9IGdldC12YXJpYWJsZSAtc2NvcGUgc2NyaXB0IHwgZm9ybWF0LXRhYmxlIHwgb3V0LXN0cmluZwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICMgKCRfIHwgT3V0LVN0cmluZykgZ2V0cyBlcnJvciBtZXNzYWdlcyB3aXRoIHNvdXJjZSBpbmZvcm1hdGlvbiBpbmNsdWRlZC4KICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgPSAiRXJyb3I6IHswfTogYG57MX0iIC1mIChHZXQtRGF0ZSksIChSZXNvbHZlRXJyb3IgJF8gLVNob3J0KQogICAgICAgIH0KCiAgICAgICAgJHBzYWtlLmJ1aWxkX3N1Y2Nlc3MgPSAkZmFsc2UKCiAgICAgICAgIyBpZiB3ZSBhcmUgcnVubmluZyBpbiBhIG5lc3RlZCBzY29wZSAoaS5lLiBydW5uaW5nIGEgcHNha2Ugc2NyaXB0IGZyb20gYSBwc2FrZSBzY3JpcHQpIHRoZW4gd2UgbmVlZCB0byByZS10aHJvdyB0aGUgZXhjZXB0aW9uCiAgICAgICAgIyBzbyB0aGF0IHRoZSBwYXJlbnQgc2NyaXB0IHdpbGwgZmFpbCBvdGhlcndpc2UgdGhlIHBhcmVudCBzY3JpcHQgd2lsbCByZXBvcnQgYSBzdWNjZXNzZnVsIGJ1aWxkCiAgICAgICAgJGluTmVzdGVkU2NvcGUgPSAoJHBzYWtlLmNvbnRleHQuY291bnQgLWd0IDEpCiAgICAgICAgaWYgKCAkaW5OZXN0ZWRTY29wZSApIHsKICAgICAgICAgICAgdGhyb3cgJF8KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoISRwc2FrZS5ydW5fYnlfcHNha2VfYnVpbGRfdGVzdGVyKSB7CiAgICAgICAgICAgICAgICBXcml0ZUNvbG9yZWRPdXRwdXQgJGVycm9yX21lc3NhZ2UgLWZvcmVncm91bmRjb2xvciBSZWQKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgICAgQ2xlYW51cEVudmlyb25tZW50CiAgICB9Cn0KCiMtLSBQcml2YXRlIE1vZHVsZSBGdW5jdGlvbnMgLS0jCmZ1bmN0aW9uIFdyaXRlQ29sb3JlZE91dHB1dCB7CiAgICBwYXJhbSgKICAgICAgICBbc3RyaW5nXSAkbWVzc2FnZSwKICAgICAgICBbU3lzdGVtLkNvbnNvbGVDb2xvcl0gJGZvcmVncm91bmRjb2xvcgogICAgKQoKICAgICRjdXJyZW50Q29uZmlnID0gR2V0Q3VycmVudENvbmZpZ3VyYXRpb25PckRlZmF1bHQKICAgIGlmICgkY3VycmVudENvbmZpZy5jb2xvcmVkT3V0cHV0IC1lcSAkdHJ1ZSkgewogICAgICAgIGlmICgoJEhvc3QuVUkgLW5lICRudWxsKSAtYW5kICgkSG9zdC5VSS5SYXdVSSAtbmUgJG51bGwpIC1hbmQgKCRIb3N0LlVJLlJhd1VJLkZvcmVncm91bmRDb2xvciAtbmUgJG51bGwpKSB7CiAgICAgICAgICAgICRwcmV2aW91c0NvbG9yID0gJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yCiAgICAgICAgICAgICRIb3N0LlVJLlJhd1VJLkZvcmVncm91bmRDb2xvciA9ICRmb3JlZ3JvdW5kY29sb3IKICAgICAgICB9CiAgICB9CgogICAgJG1lc3NhZ2UKCiAgICBpZiAoJHByZXZpb3VzQ29sb3IgLW5lICRudWxsKSB7CiAgICAgICAgJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yID0gJHByZXZpb3VzQ29sb3IKICAgIH0KfQoKZnVuY3Rpb24gTG9hZE1vZHVsZXMgewogICAgJGN1cnJlbnRDb25maWcgPSAkcHNha2UuY29udGV4dC5wZWVrKCkuY29uZmlnCiAgICBpZiAoJGN1cnJlbnRDb25maWcubW9kdWxlcykgewoKICAgICAgICAkc2NvcGUgPSAkY3VycmVudENvbmZpZy5tb2R1bGVTY29wZQoKICAgICAgICAkZ2xvYmFsID0gW3N0cmluZ106OkVxdWFscygkc2NvcGUsICJnbG9iYWwiLCBbU3RyaW5nQ29tcGFyaXNvbl06OkN1cnJlbnRDdWx0dXJlSWdub3JlQ2FzZSkKCiAgICAgICAgJGN1cnJlbnRDb25maWcubW9kdWxlcyB8IGZvcmVhY2ggewogICAgICAgICAgICByZXNvbHZlLXBhdGggJF8gfCBmb3JlYWNoIHsKICAgICAgICAgICAgICAgICJMb2FkaW5nIG1vZHVsZTogJF8iCiAgICAgICAgICAgICAgICAkbW9kdWxlID0gaW1wb3J0LW1vZHVsZSAkXyAtcGFzc3RocnUgLURpc2FibGVOYW1lQ2hlY2tpbmcgLWdsb2JhbDokZ2xvYmFsCiAgICAgICAgICAgICAgICBpZiAoISRtb2R1bGUpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoJG1zZ3MuZXJyb3JfbG9hZGluZ19tb2R1bGUgLWYgJF8uTmFtZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAiIgogICAgfQp9CgpmdW5jdGlvbiBMb2FkQ29uZmlndXJhdGlvbiB7CiAgICBwYXJhbSgKICAgICAgICBbc3RyaW5nXSAkY29uZmlnZGlyID0gJFBTU2NyaXB0Um9vdAogICAgKQoKICAgICRwc2FrZUNvbmZpZ0ZpbGVQYXRoID0gKGpvaW4tcGF0aCAkY29uZmlnZGlyICJwc2FrZS1jb25maWcucHMxIikKCiAgICBpZiAodGVzdC1wYXRoICRwc2FrZUNvbmZpZ0ZpbGVQYXRoIC1wYXRoVHlwZSBMZWFmKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGNvbmZpZyA9IEdldEN1cnJlbnRDb25maWd1cmF0aW9uT3JEZWZhdWx0CiAgICAgICAgICAgIC4gJHBzYWtlQ29uZmlnRmlsZVBhdGgKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgdGhyb3cgIkVycm9yIExvYWRpbmcgQ29uZmlndXJhdGlvbiBmcm9tIHBzYWtlLWNvbmZpZy5wczE6ICIgKyAkXwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gR2V0Q3VycmVudENvbmZpZ3VyYXRpb25PckRlZmF1bHQoKSB7CiAgICBpZiAoJHBzYWtlLmNvbnRleHQuY291bnQgLWd0IDApIHsKICAgICAgICByZXR1cm4gJHBzYWtlLmNvbnRleHQucGVlaygpLmNvbmZpZwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJHBzYWtlLmNvbmZpZ19kZWZhdWx0CiAgICB9Cn0KCmZ1bmN0aW9uIENyZWF0ZUNvbmZpZ3VyYXRpb25Gb3JOZXdDb250ZXh0IHsKICAgIHBhcmFtKAogICAgICAgIFtzdHJpbmddICRidWlsZEZpbGUsCiAgICAgICAgW3N0cmluZ10gJGZyYW1ld29yawogICAgKQoKICAgICRwcmV2aW91c0NvbmZpZyA9IEdldEN1cnJlbnRDb25maWd1cmF0aW9uT3JEZWZhdWx0CgogICAgJGNvbmZpZyA9IG5ldy1vYmplY3QgcHNvYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgYnVpbGRGaWxlTmFtZSA9ICRwcmV2aW91c0NvbmZpZy5idWlsZEZpbGVOYW1lOwogICAgICAgIGZyYW1ld29yayA9ICRwcmV2aW91c0NvbmZpZy5mcmFtZXdvcms7CiAgICAgICAgdGFza05hbWVGb3JtYXQgPSAkcHJldmlvdXNDb25maWcudGFza05hbWVGb3JtYXQ7CiAgICAgICAgdmVyYm9zZUVycm9yID0gJHByZXZpb3VzQ29uZmlnLnZlcmJvc2VFcnJvcjsKICAgICAgICBjb2xvcmVkT3V0cHV0ID0gJHByZXZpb3VzQ29uZmlnLmNvbG9yZWRPdXRwdXQ7CiAgICAgICAgbW9kdWxlcyA9ICRwcmV2aW91c0NvbmZpZy5tb2R1bGVzOwogICAgICAgIG1vZHVsZVNjb3BlID0gICRwcmV2aW91c0NvbmZpZy5tb2R1bGVTY29wZTsKICAgIH0KCiAgICBpZiAoJGZyYW1ld29yaykgewogICAgICAgICRjb25maWcuZnJhbWV3b3JrID0gJGZyYW1ld29yazsKICAgIH0KCiAgICBpZiAoJGJ1aWxkRmlsZSkgewogICAgICAgICRjb25maWcuYnVpbGRGaWxlTmFtZSA9ICRidWlsZEZpbGU7CiAgICB9CgogICAgcmV0dXJuICRjb25maWcKfQoKZnVuY3Rpb24gQ29uZmlndXJlQnVpbGRFbnZpcm9ubWVudCB7CiAgICAkZnJhbWV3b3JrID0gJHBzYWtlLmNvbnRleHQucGVlaygpLmNvbmZpZy5mcmFtZXdvcmsKICAgIGlmICgkZnJhbWV3b3JrIC1jbWF0Y2ggJ14oKD86XGQrXC5cZCspKD86XC5cZCspezAsMX0pKHg4Nnx4NjQpezAsMX0kJykgewogICAgICAgICR2ZXJzaW9uUGFydCA9ICRtYXRjaGVzWzFdCiAgICAgICAgJGJpdG5lc3NQYXJ0ID0gJG1hdGNoZXNbMl0KICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX2ludmFsaWRfZnJhbWV3b3JrIC1mICRmcmFtZXdvcmspCiAgICB9CiAgICAkdmVyc2lvbnMgPSAkbnVsbAogICAgJGJ1aWxkVG9vbHNWZXJzaW9ucyA9ICRudWxsCiAgICBzd2l0Y2ggKCR2ZXJzaW9uUGFydCkgewogICAgICAgICcxLjAnIHsKICAgICAgICAgICAgJHZlcnNpb25zID0gQCgndjEuMC4zNzA1JykKICAgICAgICB9CiAgICAgICAgJzEuMScgewogICAgICAgICAgICAkdmVyc2lvbnMgPSBAKCd2MS4xLjQzMjInKQogICAgICAgIH0KICAgICAgICAnMi4wJyB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3YyLjAuNTA3MjcnKQogICAgICAgIH0KICAgICAgICAnMy4wJyB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3YyLjAuNTA3MjcnKQogICAgICAgIH0KICAgICAgICAnMy41JyB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3YzLjUnLCAndjIuMC41MDcyNycpCiAgICAgICAgfQogICAgICAgICc0LjAnIHsKICAgICAgICAgICAgJHZlcnNpb25zID0gQCgndjQuMC4zMDMxOScpCiAgICAgICAgfQogICAgICAgIHsoJF8gLWVxICc0LjUuMScpIC1vciAoJF8gLWVxICc0LjUuMicpfSB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3Y0LjAuMzAzMTknKQogICAgICAgICAgICAkYnVpbGRUb29sc1ZlcnNpb25zID0gQCgnMTQuMCcsICcxMi4wJykKICAgICAgICB9CiAgICAgICAgJzQuNicgewogICAgICAgICAgICAkdmVyc2lvbnMgPSBAKCd2NC4wLjMwMzE5JykKICAgICAgICAgICAgJGJ1aWxkVG9vbHNWZXJzaW9ucyA9IEAoJzE0LjAnKQogICAgICAgIH0KCiAgICAgICAgZGVmYXVsdCB7CiAgICAgICAgICAgIHRocm93ICgkbXNncy5lcnJvcl91bmtub3duX2ZyYW1ld29yayAtZiAkdmVyc2lvblBhcnQsICRmcmFtZXdvcmspCiAgICAgICAgfQogICAgfQoKICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yaycKICAgIGlmICgkdmVyc2lvblBhcnQgLW5lICcxLjAnIC1hbmQgJHZlcnNpb25QYXJ0IC1uZSAnMS4xJykgewogICAgICAgIHN3aXRjaCAoJGJpdG5lc3NQYXJ0KSB7CiAgICAgICAgICAgICd4ODYnIHsKICAgICAgICAgICAgICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yaycKICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgzMicKICAgICAgICAgICAgfQogICAgICAgICAgICAneDY0JyB7CiAgICAgICAgICAgICAgICAkYml0bmVzcyA9ICdGcmFtZXdvcms2NCcKICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgeyBbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkXykgfSB7CiAgICAgICAgICAgICAgICAkcHRyU2l6ZSA9IFtTeXN0ZW0uSW50UHRyXTo6U2l6ZQogICAgICAgICAgICAgICAgc3dpdGNoICgkcHRyU2l6ZSkgewogICAgICAgICAgICAgICAgICAgIDQgewogICAgICAgICAgICAgICAgICAgICAgICAkYml0bmVzcyA9ICdGcmFtZXdvcmsnCiAgICAgICAgICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgzMicKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgOCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yazY0JwogICAgICAgICAgICAgICAgICAgICAgICAkYnVpbGRUb29sc0tleSA9ICdNU0J1aWxkVG9vbHNQYXRoJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX3Vua25vd25fcG9pbnRlcnNpemUgLWYgJHB0clNpemUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlZmF1bHQgewogICAgICAgICAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX3Vua25vd25fYml0bmVzc3BhcnQgLWYgJGJpdG5lc3NQYXJ0LCAkZnJhbWV3b3JrKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgJGZyYW1ld29ya0RpcnMgPSBAKCkKICAgIGlmICgkYnVpbGRUb29sc1ZlcnNpb25zIC1uZSAkbnVsbCkgewogICAgICAgIGZvcmVhY2goJHZlciBpbiAkYnVpbGRUb29sc1ZlcnNpb25zKSB7CiAgICAgICAgICAgIGlmIChUZXN0LVBhdGggIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxNU0J1aWxkXFRvb2xzVmVyc2lvbnNcJHZlciIpIHsKICAgICAgICAgICAgICAgICRmcmFtZXdvcmtEaXJzICs9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcTVNCdWlsZFxUb29sc1ZlcnNpb25zXCR2ZXIiIC1OYW1lICRidWlsZFRvb2xzS2V5KS4kYnVpbGRUb29sc0tleQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgJGZyYW1ld29ya0RpcnMgPSAkZnJhbWV3b3JrRGlycyArIEAoJHZlcnNpb25zIHwgZm9yZWFjaCB7ICIkZW52OndpbmRpclxNaWNyb3NvZnQuTkVUXCRiaXRuZXNzXCRfXCIgfSkKCiAgICBmb3IgKCRpID0gMDsgJGkgLWx0ICRmcmFtZXdvcmtEaXJzLkNvdW50OyAkaSsrKSB7CiAgICAgICAgJGRpciA9ICRmcmFtZXdvcmtEaXJzWyRpXQogICAgICAgIGlmICgkZGlyIC1NYXRjaCAiXCRcKFJlZ2lzdHJ5OkhLRVlfTE9DQUxfTUFDSElORSguKj8pQCguKilcKSIpIHsKICAgICAgICAgICAgJGtleSA9ICJIS0xNOiIgKyAkbWF0Y2hlc1sxXQogICAgICAgICAgICAkbmFtZSA9ICRtYXRjaGVzWzJdCiAgICAgICAgICAgICRkaXIgPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAka2V5IC1OYW1lICRuYW1lKS4kbmFtZQogICAgICAgICAgICAkZnJhbWV3b3JrRGlyc1skaV0gPSAkZGlyCiAgICAgICAgfQogICAgfQoKICAgICRmcmFtZXdvcmtEaXJzIHwgZm9yZWFjaCB7IEFzc2VydCAodGVzdC1wYXRoICRfIC1wYXRoVHlwZSBDb250YWluZXIpICgkbXNncy5lcnJvcl9ub19mcmFtZXdvcmtfaW5zdGFsbF9kaXJfZm91bmQgLWYgJF8pfQoKICAgICRlbnY6cGF0aCA9ICgkZnJhbWV3b3JrRGlycyAtam9pbiAiOyIpICsgIjskZW52OnBhdGgiCiAgICAjIGlmIGFueSBlcnJvciBvY2N1cnMgaW4gYSBQUyBmdW5jdGlvbiB0aGVuICJzdG9wIiBwcm9jZXNzaW5nIGltbWVkaWF0ZWx5CiAgICAjIHRoaXMgZG9lcyBub3QgZWZmZWN0IGFueSBleHRlcm5hbCBwcm9ncmFtcyB0aGF0IHJldHVybiBhIG5vbi16ZXJvIGV4aXQgY29kZQogICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU3RvcCIKfQoKZnVuY3Rpb24gQ2xlYW51cEVudmlyb25tZW50IHsKICAgIGlmICgkcHNha2UuY29udGV4dC5Db3VudCAtZ3QgMCkgewogICAgICAgICRjdXJyZW50Q29udGV4dCA9ICRwc2FrZS5jb250ZXh0LlBlZWsoKQogICAgICAgICRlbnY6cGF0aCA9ICRjdXJyZW50Q29udGV4dC5vcmlnaW5hbEVudlBhdGgKICAgICAgICBTZXQtTG9jYXRpb24gJGN1cnJlbnRDb250ZXh0Lm9yaWdpbmFsRGlyZWN0b3J5CiAgICAgICAgJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2UgPSAkY3VycmVudENvbnRleHQub3JpZ2luYWxFcnJvckFjdGlvblByZWZlcmVuY2UKICAgICAgICBbdm9pZF0gJHBzYWtlLmNvbnRleHQuUG9wKCkKICAgIH0KfQoKZnVuY3Rpb24gU2VsZWN0T2JqZWN0V2l0aERlZmF1bHQKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXQogICAgICAgIFtQU09iamVjdF0KICAgICAgICAkSW5wdXRPYmplY3QsCiAgICAgICAgW3N0cmluZ10KICAgICAgICAkTmFtZSwKICAgICAgICAkVmFsdWUKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBpZiAoJF8gLWVxICRudWxsKSB7ICRWYWx1ZSB9CiAgICAgICAgZWxzZWlmICgkXyB8IEdldC1NZW1iZXIgLU5hbWUgJE5hbWUpIHsKICAgICAgICAgICRfLiROYW1lCiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoKCRfIC1pcyBbSGFzaHRhYmxlXSkgLWFuZCAoJF8uS2V5cyAtY29udGFpbnMgJE5hbWUpKSB7CiAgICAgICAgICAkXy4kTmFtZQogICAgICAgIH0KICAgICAgICBlbHNlIHsgJFZhbHVlIH0KICAgIH0KfQoKIyBib3Jyb3dlZCBmcm9tIEplZmZyZXkgU25vdmVyIGh0dHA6Ly9ibG9ncy5tc2RuLmNvbS9wb3dlcnNoZWxsL2FyY2hpdmUvMjAwNi8xMi8wNy9yZXNvbHZlLWVycm9yLmFzcHgKIyBtb2RpZmllZCB0byBiZXR0ZXIgaGFuZGxlIFNRTCBlcnJvcnMKZnVuY3Rpb24gUmVzb2x2ZUVycm9yCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFZhbHVlRnJvbVBpcGVsaW5lPSR0cnVlKV0KICAgICAgICAkRXJyb3JSZWNvcmQ9JEVycm9yWzBdLAogICAgICAgIFtTd2l0Y2hdCiAgICAgICAgJFNob3J0CiAgICApCgogICAgcHJvY2VzcyB7CiAgICAgICAgaWYgKCRfIC1lcSAkbnVsbCkgeyAkXyA9ICRFcnJvclJlY29yZCB9CiAgICAgICAgJGV4ID0gJF8uRXhjZXB0aW9uCgogICAgICAgIGlmICgtbm90ICRTaG9ydCkgewogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSA9ICJgbkVycm9yUmVjb3JkOnswfUVycm9yUmVjb3JkLkludm9jYXRpb25JbmZvOnsxfUV4Y2VwdGlvbjpgbnsyfSIKICAgICAgICAgICAgJGZvcm1hdHRlZF9lcnJvclJlY29yZCA9ICRfIHwgZm9ybWF0LWxpc3QgKiAtZm9yY2UgfCBvdXQtc3RyaW5nCiAgICAgICAgICAgICRmb3JtYXR0ZWRfaW52b2NhdGlvbkluZm8gPSAkXy5JbnZvY2F0aW9uSW5mbyB8IGZvcm1hdC1saXN0ICogLWZvcmNlIHwgb3V0LXN0cmluZwogICAgICAgICAgICAkZm9ybWF0dGVkX2V4Y2VwdGlvbiA9ICcnCgogICAgICAgICAgICAkaSA9IDAKICAgICAgICAgICAgd2hpbGUgKCRleCAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICRpKysKICAgICAgICAgICAgICAgICRmb3JtYXR0ZWRfZXhjZXB0aW9uICs9ICgiJGkiICogNzApICsgImBuIiArCiAgICAgICAgICAgICAgICAgICAgKCRleCB8IGZvcm1hdC1saXN0ICogLWZvcmNlIHwgb3V0LXN0cmluZykgKyAiYG4iCiAgICAgICAgICAgICAgICAkZXggPSAkZXggfCBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdCAtTmFtZSAnSW5uZXJFeGNlcHRpb24nIC1WYWx1ZSAkbnVsbAogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJGVycm9yX21lc3NhZ2UgLWYgJGZvcm1hdHRlZF9lcnJvclJlY29yZCwgJGZvcm1hdHRlZF9pbnZvY2F0aW9uSW5mbywgJGZvcm1hdHRlZF9leGNlcHRpb24KICAgICAgICB9CgogICAgICAgICRsYXN0RXhjZXB0aW9uID0gQCgpCiAgICAgICAgd2hpbGUgKCRleCAtbmUgJG51bGwpIHsKICAgICAgICAgICAgJGxhc3RNZXNzYWdlID0gJGV4IHwgU2VsZWN0T2JqZWN0V2l0aERlZmF1bHQgLU5hbWUgJ01lc3NhZ2UnIC1WYWx1ZSAnJwogICAgICAgICAgICAkbGFzdEV4Y2VwdGlvbiArPSAoJGxhc3RNZXNzYWdlIC1yZXBsYWNlICJgbiIsICcnKQogICAgICAgICAgICBpZiAoJGV4IC1pcyBbRGF0YS5TcWxDbGllbnQuU3FsRXhjZXB0aW9uXSkgewogICAgICAgICAgICAgICAgJGxhc3RFeGNlcHRpb24gKz0gIihMaW5lIFskKCRleC5MaW5lTnVtYmVyKV0gIiArCiAgICAgICAgICAgICAgICAgICAgIlByb2NlZHVyZSBbJCgkZXguUHJvY2VkdXJlKV0gQ2xhc3MgWyQoJGV4LkNsYXNzKV0gIiArCiAgICAgICAgICAgICAgICAgICAgIiBOdW1iZXIgWyQoJGV4Lk51bWJlcildIFN0YXRlIFskKCRleC5TdGF0ZSldICkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGV4ID0gJGV4IHwgU2VsZWN0T2JqZWN0V2l0aERlZmF1bHQgLU5hbWUgJ0lubmVyRXhjZXB0aW9uJyAtVmFsdWUgJG51bGwKICAgICAgICB9CiAgICAgICAgJHNob3J0RXhjZXB0aW9uID0gJGxhc3RFeGNlcHRpb24gLWpvaW4gJyAtLT4gJwoKICAgICAgICAkaGVhZGVyID0gJG51bGwKICAgICAgICAkY3VycmVudCA9ICRfCiAgICAgICAgJGhlYWRlciA9ICgoJF8uSW52b2NhdGlvbkluZm8gfAogICAgICAgICAgICBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdCAtTmFtZSAnUG9zaXRpb25NZXNzYWdlJyAtVmFsdWUgJycpIC1yZXBsYWNlICJgbiIsICcgJyksCiAgICAgICAgICAgICgkXyB8IFNlbGVjdE9iamVjdFdpdGhEZWZhdWx0IC1OYW1lICdNZXNzYWdlJyAtVmFsdWUgJycpLAogICAgICAgICAgICAoJF8gfCBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdCAtTmFtZSAnRXhjZXB0aW9uJyAtVmFsdWUgJycpIHwKICAgICAgICAgICAgICAgID8geyAtbm90IFtTdHJpbmddOjpJc051bGxPckVtcHR5KCRfKSB9IHwKICAgICAgICAgICAgICAgIFNlbGVjdCAtRmlyc3QgMQoKICAgICAgICAkZGVsaW1pdGVyID0gJycKICAgICAgICBpZiAoKC1ub3QgW1N0cmluZ106OklzTnVsbE9yRW1wdHkoJGhlYWRlcikpIC1hbmQKICAgICAgICAgICAgKC1ub3QgW1N0cmluZ106OklzTnVsbE9yRW1wdHkoJHNob3J0RXhjZXB0aW9uKSkpCiAgICAgICAgICAgIHsgJGRlbGltaXRlciA9ICcgWzw8PT0+Pl0gJyB9CgogICAgICAgIHJldHVybiAiJCgkaGVhZGVyKSQoJGRlbGltaXRlcilFeGNlcHRpb246ICQoJHNob3J0RXhjZXB0aW9uKSIKICAgIH0KfQoKZnVuY3Rpb24gV3JpdGVEb2N1bWVudGF0aW9uKCRzaG93RGV0YWlsZWQpIHsKICAgICRjdXJyZW50Q29udGV4dCA9ICRwc2FrZS5jb250ZXh0LlBlZWsoKQoKICAgIGlmICgkY3VycmVudENvbnRleHQudGFza3MuZGVmYXVsdCkgewogICAgICAgICRkZWZhdWx0VGFza0RlcGVuZGVuY2llcyA9ICRjdXJyZW50Q29udGV4dC50YXNrcy5kZWZhdWx0LkRlcGVuZHNPbgogICAgfSBlbHNlIHsKICAgICAgICAkZGVmYXVsdFRhc2tEZXBlbmRlbmNpZXMgPSBAKCkKICAgIH0KCiAgICAkZG9jcyA9ICRjdXJyZW50Q29udGV4dC50YXNrcy5LZXlzIHwgZm9yZWFjaC1vYmplY3QgewogICAgICAgIGlmICgkXyAtZXEgImRlZmF1bHQiKSB7CiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgJHRhc2sgPSAkY3VycmVudENvbnRleHQudGFza3MuJF8KICAgICAgICBuZXctb2JqZWN0IFBTT2JqZWN0IC1wcm9wZXJ0eSBAewogICAgICAgICAgICBOYW1lID0gJHRhc2suTmFtZTsKICAgICAgICAgICAgQWxpYXMgPSAkdGFzay5BbGlhczsKICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAkdGFzay5EZXNjcmlwdGlvbjsKICAgICAgICAgICAgIkRlcGVuZHMgT24iID0gJHRhc2suRGVwZW5kc09uIC1qb2luICIsICIKICAgICAgICAgICAgRGVmYXVsdCA9IGlmICgkZGVmYXVsdFRhc2tEZXBlbmRlbmNpZXMgLWNvbnRhaW5zICR0YXNrLk5hbWUpIHsgJHRydWUgfQogICAgICAgIH0KICAgIH0KICAgIGlmICgkc2hvd0RldGFpbGVkKSB7CiAgICAgICAgJGRvY3MgfCBzb3J0ICdOYW1lJyB8IGZvcm1hdC1saXN0IC1wcm9wZXJ0eSBOYW1lLEFsaWFzLERlc2NyaXB0aW9uLCJEZXBlbmRzIE9uIixEZWZhdWx0CiAgICB9IGVsc2UgewogICAgICAgICRkb2NzIHwgc29ydCAnTmFtZScgfCBmb3JtYXQtdGFibGUgLWF1dG9TaXplIC13cmFwIC1wcm9wZXJ0eSBOYW1lLEFsaWFzLCJEZXBlbmRzIE9uIixEZWZhdWx0LERlc2NyaXB0aW9uCiAgICB9Cgp9CgpmdW5jdGlvbiBXcml0ZVRhc2tUaW1lU3VtbWFyeSgkaW52b2tlUHNha2VEdXJhdGlvbikgewogICAgaWYgKCRwc2FrZS5jb250ZXh0LmNvdW50IC1ndCAwKSB7CiAgICAgICAgIi0iICogNzAKICAgICAgICAiQnVpbGQgVGltZSBSZXBvcnQiCiAgICAgICAgIi0iICogNzAKICAgICAgICAkbGlzdCA9IEAoKQogICAgICAgICRjdXJyZW50Q29udGV4dCA9ICRwc2FrZS5jb250ZXh0LlBlZWsoKQogICAgICAgIHdoaWxlICgkY3VycmVudENvbnRleHQuZXhlY3V0ZWRUYXNrcy5Db3VudCAtZ3QgMCkgewogICAgICAgICAgICAkdGFza0tleSA9ICRjdXJyZW50Q29udGV4dC5leGVjdXRlZFRhc2tzLlBvcCgpCiAgICAgICAgICAgICR0YXNrID0gJGN1cnJlbnRDb250ZXh0LnRhc2tzLiR0YXNrS2V5CiAgICAgICAgICAgIGlmICgkdGFza0tleSAtZXEgImRlZmF1bHQiKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CiAgICAgICAgICAgICRsaXN0ICs9IG5ldy1vYmplY3QgUFNPYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgICAgICAgICBOYW1lID0gJHRhc2suTmFtZTsKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gJHRhc2suRHVyYXRpb24KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBbQXJyYXldOjpSZXZlcnNlKCRsaXN0KQogICAgICAgICRsaXN0ICs9IG5ldy1vYmplY3QgUFNPYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgICAgIE5hbWUgPSAiVG90YWw6IjsKICAgICAgICAgICAgRHVyYXRpb24gPSAkaW52b2tlUHNha2VEdXJhdGlvbgogICAgICAgIH0KICAgICAgICAjIHVzaW5nICJvdXQtc3RyaW5nIHwgd2hlcmUtb2JqZWN0IiB0byBmaWx0ZXIgb3V0IHRoZSBibGFuayBsaW5lIHRoYXQgZm9ybWF0LXRhYmxlIHByZXBlbmRzCiAgICAgICAgJGxpc3QgfCBmb3JtYXQtdGFibGUgLWF1dG9TaXplIC1wcm9wZXJ0eSBOYW1lLER1cmF0aW9uIHwgb3V0LXN0cmluZyAtc3RyZWFtIHwgd2hlcmUtb2JqZWN0IHsgJF8gfQogICAgfQp9CgpEQVRBIG1zZ3Mgewpjb252ZXJ0ZnJvbS1zdHJpbmdkYXRhIEAnCiAgICBlcnJvcl9pbnZhbGlkX3Rhc2tfbmFtZSA9IFRhc2sgbmFtZSBzaG91bGQgbm90IGJlIG51bGwgb3IgZW1wdHkgc3RyaW5nLgogICAgZXJyb3JfdGFza19uYW1lX2RvZXNfbm90X2V4aXN0ID0gVGFzayB7MH0gZG9lcyBub3QgZXhpc3QuCiAgICBlcnJvcl9jaXJjdWxhcl9yZWZlcmVuY2UgPSBDaXJjdWxhciByZWZlcmVuY2UgZm91bmQgZm9yIHRhc2sgezB9LgogICAgZXJyb3JfbWlzc2luZ19hY3Rpb25fcGFyYW1ldGVyID0gQWN0aW9uIHBhcmFtZXRlciBtdXN0IGJlIHNwZWNpZmllZCB3aGVuIHVzaW5nIFByZUFjdGlvbiBvciBQb3N0QWN0aW9uIHBhcmFtZXRlcnMgZm9yIHRhc2sgezB9LgogICAgZXJyb3JfY29ycnVwdF9jYWxsc3RhY2sgPSBDYWxsIHN0YWNrIHdhcyBjb3JydXB0LiBFeHBlY3RlZCB7MH0sIGJ1dCBnb3QgezF9LgogICAgZXJyb3JfaW52YWxpZF9mcmFtZXdvcmsgPSBJbnZhbGlkIC5ORVQgRnJhbWV3b3JrIHZlcnNpb24sIHswfSBzcGVjaWZpZWQuCiAgICBlcnJvcl91bmtub3duX2ZyYW1ld29yayA9IFVua25vd24gLk5FVCBGcmFtZXdvcmsgdmVyc2lvbiwgezB9IHNwZWNpZmllZCBpbiB7MX0uCiAgICBlcnJvcl91bmtub3duX3BvaW50ZXJzaXplID0gVW5rbm93biBwb2ludGVyIHNpemUgKHswfSkgcmV0dXJuZWQgZnJvbSBTeXN0ZW0uSW50UHRyLgogICAgZXJyb3JfdW5rbm93bl9iaXRuZXNzcGFydCA9IFVua25vd24gLk5FVCBGcmFtZXdvcmsgYml0bmVzcywgezB9LCBzcGVjaWZpZWQgaW4gezF9LgogICAgZXJyb3Jfbm9fZnJhbWV3b3JrX2luc3RhbGxfZGlyX2ZvdW5kID0gTm8gLk5FVCBGcmFtZXdvcmsgaW5zdGFsbGF0aW9uIGRpcmVjdG9yeSBmb3VuZCBhdCB7MH0uCiAgICBlcnJvcl9iYWRfY29tbWFuZCA9IEVycm9yIGV4ZWN1dGluZyBjb21tYW5kIHswfS4KICAgIGVycm9yX2RlZmF1bHRfdGFza19jYW5ub3RfaGF2ZV9hY3Rpb24gPSAnZGVmYXVsdCcgdGFzayBjYW5ub3Qgc3BlY2lmeSBhbiBhY3Rpb24uCiAgICBlcnJvcl9kdXBsaWNhdGVfdGFza19uYW1lID0gVGFzayB7MH0gaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkLgogICAgZXJyb3JfZHVwbGljYXRlX2FsaWFzX25hbWUgPSBBbGlhcyB7MH0gaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkLgogICAgZXJyb3JfaW52YWxpZF9pbmNsdWRlX3BhdGggPSBVbmFibGUgdG8gaW5jbHVkZSB7MH0uIEZpbGUgbm90IGZvdW5kLgogICAgZXJyb3JfYnVpbGRfZmlsZV9ub3RfZm91bmQgPSBDb3VsZCBub3QgZmluZCB0aGUgYnVpbGQgZmlsZSB7MH0uCiAgICBlcnJvcl9ub19kZWZhdWx0X3Rhc2sgPSAnZGVmYXVsdCcgdGFzayByZXF1aXJlZC4KICAgIGVycm9yX2xvYWRpbmdfbW9kdWxlID0gRXJyb3IgbG9hZGluZyBtb2R1bGUgezB9LgogICAgd2FybmluZ19kZXByZWNhdGVkX2ZyYW1ld29ya192YXJpYWJsZSA9IFdhcm5pbmc6IFVzaW5nIGdsb2JhbCB2YXJpYWJsZSAkZnJhbWV3b3JrIHRvIHNldCAuTkVUIGZyYW1ld29yayB2ZXJzaW9uIHVzZWQgaXMgZGVwcmVjYXRlZC4gSW5zdGVhZCB1c2UgRnJhbWV3b3JrIGZ1bmN0aW9uIG9yIGNvbmZpZ3VyYXRpb24gZmlsZSBwc2FrZS1jb25maWcucHMxLgogICAgcmVxdWlyZWRfdmFyaWFibGVfbm90X3NldCA9IFZhcmlhYmxlIHswfSBtdXN0IGJlIHNldCB0byBydW4gdGFzayB7MX0uCiAgICBwb3N0Y29uZGl0aW9uX2ZhaWxlZCA9IFBvc3Rjb25kaXRpb24gZmFpbGVkIGZvciB0YXNrIHswfS4KICAgIHByZWNvbmRpdGlvbl93YXNfZmFsc2UgPSBQcmVjb25kaXRpb24gd2FzIGZhbHNlLCBub3QgZXhlY3V0aW5nIHRhc2sgezB9LgogICAgY29udGludWVfb25fZXJyb3IgPSBFcnJvciBpbiB0YXNrIHswfS4gezF9CiAgICBidWlsZF9zdWNjZXNzID0gQnVpbGQgU3VjY2VlZGVkIQonQAp9CgppbXBvcnQtbG9jYWxpemVkZGF0YSAtYmluZGluZ3ZhcmlhYmxlIG1zZ3MgLWVycm9yYWN0aW9uIHNpbGVudGx5Y29udGludWUKCiRzY3JpcHQ6cHNha2UgPSBAe30KJHBzYWtlLnZlcnNpb24gPSAiNC40LjIiICMgY29udGFpbnMgdGhlIGN1cnJlbnQgdmVyc2lvbiBvZiBwc2FrZQokcHNha2UuY29udGV4dCA9IG5ldy1vYmplY3Qgc3lzdGVtLmNvbGxlY3Rpb25zLnN0YWNrICMgaG9sZHMgb250byB0aGUgY3VycmVudCBzdGF0ZSBvZiBhbGwgdmFyaWFibGVzCiRwc2FrZS5ydW5fYnlfcHNha2VfYnVpbGRfdGVzdGVyID0gJGZhbHNlICMgaW5kaWNhdGVzIHRoYXQgYnVpbGQgaXMgYmVpbmcgcnVuIGJ5IHBzYWtlLUJ1aWxkVGVzdGVyCiRwc2FrZS5jb25maWdfZGVmYXVsdCA9IG5ldy1vYmplY3QgcHNvYmplY3QgLXByb3BlcnR5IEB7CiAgICBidWlsZEZpbGVOYW1lID0gImRlZmF1bHQucHMxIjsKICAgIGZyYW1ld29yayA9ICI0LjAiOwogICAgdGFza05hbWVGb3JtYXQgPSAiRXhlY3V0aW5nIHswfSI7CiAgICB2ZXJib3NlRXJyb3IgPSAkZmFsc2U7CiAgICBjb2xvcmVkT3V0cHV0ID0gJHRydWU7CiAgICBtb2R1bGVzID0gJG51bGw7CiAgICBtb2R1bGVTY29wZSA9ICIiOwp9ICMgY29udGFpbnMgZGVmYXVsdCBjb25maWd1cmF0aW9uLCBjYW4gYmUgb3ZlcnJpZGVuIGluIHBzYWtlLWNvbmZpZy5wczEgaW4gZGlyZWN0b3J5IHdpdGggcHNha2UucHNtMSBvciBpbiBkaXJlY3Rvcnkgd2l0aCBjdXJyZW50IGJ1aWxkIHNjcmlwdAoKJHBzYWtlLmJ1aWxkX3N1Y2Nlc3MgPSAkZmFsc2UgIyBpbmRpY2F0ZXMgdGhhdCB0aGUgY3VycmVudCBidWlsZCB3YXMgc3VjY2Vzc2Z1bAokcHNha2UuYnVpbGRfc2NyaXB0X2ZpbGUgPSAkbnVsbCAjIGNvbnRhaW5zIGEgU3lzdGVtLklPLkZpbGVJbmZvIGZvciB0aGUgY3VycmVudCBidWlsZCBzY3JpcHQKJHBzYWtlLmJ1aWxkX3NjcmlwdF9kaXIgPSAiIiAjIGNvbnRhaW5zIGEgc3RyaW5nIHdpdGggZnVsbHktcXVhbGlmaWVkIHBhdGggdG8gY3VycmVudCBidWlsZCBzY3JpcHQKCkxvYWRDb25maWd1cmF0aW9uCgpleHBvcnQtbW9kdWxlbWVtYmVyIC1mdW5jdGlvbiBJbnZva2UtcHNha2UsIEludm9rZS1UYXNrLCBUYXNrLCBQcm9wZXJ0aWVzLCBJbmNsdWRlLCBGb3JtYXRUYXNrTmFtZSwgVGFza1NldHVwLCBUYXNrVGVhckRvd24sIEZyYW1ld29yaywgQXNzZXJ0LCBFeGVjIC12YXJpYWJsZSBwc2FrZQo=
