Update-AlwaysON_v3.ps1,63c9a8b46e459288838c1b2022d2c530,Scan result is 1. IsMalware: 0,w6/Cu8K/PCMKVXNhZ2U6IC5cVXBkYXRlLUFsd2F5c09uX3YzLnBzMSAtU1FMTm9kZXMgQCgnU1FMMDFBTycsICdTUUwwMkFPJykgLUFsd2F5c09uSW5zdGFuY2UgJ0FMV0FZU09OJyAtQXZhaWxhYmlsaXR5R3JvdXBOYW1lICdBRzAxJyAtQ29sbGVjdGlvbklEICdIUTEwMDA2NicgLVNNU1Byb3ZpZGVyIENNMDEuRE8uTE9DQUwgLVZlcmJvc2UKIz4KCgojcmVnaW9uIGRlY2xhcmUgdmFyaWFibGVzCltDbWRsZXRCaW5kaW5nKCldCnBhcmFtKAokU1FMTm9kZXMgPSBAKCdTUUwwMUFPJywgJ1NRTDAyQU8nKSwKJEFsd2F5c09uSW5zdGFuY2UgPSAnQUxXQVlTT04nLAokQXZhaWxhYmlsaXR5R3JvdXBOYW1lID0gJ0FHMDEnLAokQ29sbGVjdGlvbklEID0gJ0hRMTAwMDY2JywKJFNNU1Byb3ZpZGVyID0gJ2NtMDEuZG8ubG9jYWwnLApbc3dpdGNoXSRTZW5kRW1haWwKKQoKPCMKJFNRTE5vZGVzID0gQCgnU1FMMDFBTycsICdTUUwwMkFPJykKJEFsd2F5c09uSW5zdGFuY2UgPSAnQUxXQVlTT04nCiRBdmFpbGFiaWxpdHlHcm91cE5hbWUgPSAnQUcwMScKJENvbGxlY3Rpb25JRCA9ICdIUTEwMDA2NicKJFNNU1Byb3ZpZGVyID0gJ2NtMDEuZG8ubG9jYWwnCiM+CiRsb2NhdGlvbiA9IFNwbGl0LVBhdGggJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuUGF0aCAtUGFyZW50CgojZW5kcmVnaW9uIGRlY2xhcmUgdmFyaWFibGVzCgojcmVnaW9uIGhlbHBlciBmdW5jdGlvbnMKRnVuY3Rpb24gR2V0LVNRTEFsd2F5c09uUmVwbGljYU5vZGUgewogICMgRnVsbCBjcmVkaXQgdG8gQnJpYW4gUCBPRHd5ZXIgaHR0cDovL3d3dy5tc3NxbHRpcHMuY29tL3NxbHNlcnZlcnRpcC8zMjA2L2ZpbmRpbmctcHJpbWFyeS1yZXBsaWNhcy1mb3Itc3FsLXNlcnZlci0yMDEyLWFsd2F5c29uLWF2YWlsYWJpbGl0eS1ncm91cHMtd2l0aC1wb3dlcnNoZWxsLwogICMgc21hbGwgY2hhbmdlcyB0byAkY29ubmVjdGlvbnN0cmluZyBhbmQgb3V0cHV0IGJ5IERhdmlkIE8nQnJpZW4KICBbQ21kbGV0QmluZGluZygpXQogIHBhcmFtICgKICAgIFthcnJheV0kU1FMTm9kZXMsICAgCiAgICBbc3RyaW5nXSRTUUxJbnN0YW5jZSwKICAgIFtWYWxpZGF0ZVNldCgnUFJJTUFSWScsJ1NFQ09OREFSWScpXSAKICAgIFtzdHJpbmddJFJvbGUKICApCiAgCiAgIyMgU2V0dXAgZGF0YXNldCB0byBob2xkIHJlc3VsdHMKICAkZGF0YXNldCA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuRGF0YVNldAogICMjIFNldHVwIGNvbm5lY3Rpb24gdG8gU1FMIHNlcnZlciBpbnNpZGUgbG9vcCBhbmQgcnVuIFQtU1FMIGFnYWluc3QgaW5zdGFuY2UgCiAgZm9yZWFjaCgkU2VydmVyIGluICRTUUxOb2RlcykgewogICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRTUUxJbnN0YW5jZSkpIHsKICAgICAgJGNvbm5lY3Rpb25TdHJpbmcgPSAiUHJvdmlkZXI9c3Fsb2xlZGI7RGF0YSBTb3VyY2U9JFNlcnZlcjtJbml0aWFsIENhdGFsb2c9TWFzdGVyO0ludGVncmF0ZWQgU2VjdXJpdHk9U1NQSTsiCiAgICB9CiAgICBlbHNlIHsKICAgICAgJGNvbm5lY3Rpb25TdHJpbmcgPSAiUHJvdmlkZXI9c3Fsb2xlZGI7RGF0YSBTb3VyY2U9JFNlcnZlclwkU1FMSW5zdGFuY2U7SW5pdGlhbCBDYXRhbG9nPU1hc3RlcjtJbnRlZ3JhdGVkIFNlY3VyaXR5PVNTUEk7IgogICAgfQogICAgIyMgcGxhY2UgdGhlIFQtU1FMIGluIHZhcmlhYmxlIHRvIGJlIGV4ZWN1dGVkIGJ5IE9MRURCIG1ldGhvZCAKICAgIAogICAgJHNxbGNvbW1hbmQ9IgogICAgICBJRiBTRVJWRVJQUk9QRVJUWSAoJ0lzSGFkckVuYWJsZWQnKSA9IDEKICAgICAgQkVHSU4KICAgICAgU0VMRUNUCiAgICAgIEFHQy5uYW1lCiAgICAgICwgUkNTLnJlcGxpY2Ffc2VydmVyX25hbWUKICAgICAgLCBBUlMucm9sZV9kZXNjCiAgICAgICwgQUdMLmRuc19uYW1lCiAgICAgIEZST00KICAgICAgc3lzLmF2YWlsYWJpbGl0eV9ncm91cHNfY2x1c3RlciBBUyBBR0MKICAgICAgSU5ORVIgSk9JTiBzeXMuZG1faGFkcl9hdmFpbGFiaWxpdHlfcmVwbGljYV9jbHVzdGVyX3N0YXRlcyBBUyBSQ1MKICAgICAgT04KICAgICAgUkNTLmdyb3VwX2lkID0gQUdDLmdyb3VwX2lkCiAgICAgIElOTkVSIEpPSU4gc3lzLmRtX2hhZHJfYXZhaWxhYmlsaXR5X3JlcGxpY2Ffc3RhdGVzIEFTIEFSUwogICAgICBPTgogICAgICBBUlMucmVwbGljYV9pZCA9IFJDUy5yZXBsaWNhX2lkCiAgICAgIElOTkVSIEpPSU4gc3lzLmF2YWlsYWJpbGl0eV9ncm91cF9saXN0ZW5lcnMgQVMgQUdMCiAgICAgIE9OCiAgICAgIEFHTC5ncm91cF9pZCA9IEFSUy5ncm91cF9pZAogICAgICBXSEVSRQogICAgICBBUlMucm9sZV9kZXNjID0gJyRSb2xlJwogICAgICBFTkQKICAgICIKICAgICMjIENvbm5lY3QgdG8gdGhlIGRhdGEgc291cmNlIGFuZCBvcGVuIGl0CiAgICAkY29ubmVjdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuT2xlRGIuT2xlRGJDb25uZWN0aW9uICRjb25uZWN0aW9uU3RyaW5nCiAgICAkY29tbWFuZCA9IE5ldy1PYmplY3QgU3lzdGVtLkRhdGEuT2xlRGIuT2xlRGJDb21tYW5kICRzcWxDb21tYW5kLCRjb25uZWN0aW9uCiAgICAkY29ubmVjdGlvbi5PcGVuKCkKICAgICMjIEV4ZWN1dGUgVC1TUUwgY29tbWFuZCBpbiB2YXJpYWJsZSwgZmV0Y2ggdGhlIHJlc3VsdHMsIGFuZCBjbG9zZSB0aGUgY29ubmVjdGlvbgogICAgJGFkYXB0ZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5EYXRhLk9sZURiLk9sZURiRGF0YUFkYXB0ZXIgJGNvbW1hbmQKICAgIFt2b2lkXSAkYWRhcHRlci5GaWxsKCRkYXRhU2V0KQogICAgJGNvbm5lY3Rpb24uQ2xvc2UoKQogIH0KICAjIyBSZXR1cm4gYWxsIG9mIHRoZSByb3dzIGZyb20gZGF0YXNldCBvYmplY3QKICByZXR1cm4gKCREYXRhU2V0LlRhYmxlc1swXSB8IFNlbGVjdC1PYmplY3QgcmVwbGljYV9zZXJ2ZXJfbmFtZSkucmVwbGljYV9zZXJ2ZXJfbmFtZQogIAogICM+Cn0KCkZ1bmN0aW9uIENoZWNrLUFHSGVhbHRoIHsKICBbQ21kbGV0QmluZGluZygpXQogIHBhcmFtICgKICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICBbc3RyaW5nXSRBR05hbWUKICApCgogICRvYmpIZWFsdGggPSBUZXN0LVNxbEF2YWlsYWJpbGl0eUdyb3VwIC1QYXRoICJTUUxTZXJ2ZXI6XFNRTFwkUHJpbWFyeVJlcGxpY2FTZXJ2ZXJcYXZhaWxhYmlsaXR5Z3JvdXBzXCRBR05hbWUiCiAgCiAgaWYgKCRvYmpIZWFsdGguSGVhbHRoU3RhdGUgLWVxICdIZWFsdGh5JykgewogICAgcmV0dXJuICR0cnVlOwogIH0KICBlbHNlaWYgKCRvYmpIZWFsdGguSGVhbHRoU3RhdGUgLWVxICdVbmtub3duJykgewogICAgV3JpdGUtVmVyYm9zZSAnVGhlIEFHIGlzIGluIEhlYWx0aCBTdGF0ZSB1bmtub3duLiBUaGUgc2NyaXB0IG1pZ2h0IGJlIGNoZWNraW5nIGFnYWluc3QgYSBTZWNvbmRhcnkgUmVwbGljYS4nOwogICAgcmV0dXJuICRmYWxzZTsKICB9CiAgZWxzZSB7CiAgICBXcml0ZS1WZXJib3NlICdUaGUgQUcgaXMgaW4gYW4gdW5oZWFsdGh5IHN0YXRlLiBQbGVhc2UgY2hlY2sgZmlyc3QgYmVmb3JlIHVwZGF0aW5nLic7CiAgICByZXR1cm4gJGZhbHNlOwogIH0KfQoKRnVuY3Rpb24gQ2hlY2stUmVwbGljYUhlYWx0aCB7CiAgW0NtZGxldEJpbmRpbmcoKV0KICBwYXJhbSgpICAgIAogIFtpbnRdJEhlYWx0aElzc3VlcyA9IDAKICBbYXJyYXldJFVuaGVhbHRoeVJlcGxpY2EgPSBAKCkKICAKICBTZXQtTG9jYXRpb24gIlNRTFNlcnZlcjpcU1FMXCRQcmltYXJ5UmVwbGljYVNlcnZlclxhdmFpbGFiaWxpdHlncm91cHNcJEF2YWlsYWJpbGl0eUdyb3VwTmFtZVxBdmFpbGFiaWxpdHlSZXBsaWNhcyIKICAkb2JqUmVwbGljYUhlYWx0aCA9ICBkaXIgfCBUZXN0LVNxbEF2YWlsYWJpbGl0eVJlcGxpY2EKICBmb3JlYWNoICgkb2JqIGluICRvYmpSZXBsaWNhSGVhbHRoKSB7CiAgICBpZiAoJG9iai5IZWFsdGhTdGF0ZSAtbmUgJ0hlYWx0aHknKSB7CiAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJG9iai5OYW1lKSBpcyBpbiBIZWFsdGhTdGF0ZSAkKCRvYmouSGVhbHRoU3RhdGUpLiIKICAgICAgJEhlYWx0aElzc3VlcysrCiAgICAgICRVbmhlYWx0aHlSZXBsaWNhICs9ICRvYmouTmFtZQogICAgfQogICAgZWxzZSB7CiAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJG9iai5OYW1lKSBpcyBpbiBIZWFsdGhTdGF0ZSAkKCRvYmouSGVhbHRoU3RhdGUpLiIKICAgIH0KICB9CiAgaWYgKCRIZWFsdGhJc3N1ZXMgLWdlIDEpIHsKICAgIFdyaXRlLVZlcmJvc2UgIlRoZXJlIHdlcmUgJEhlYWx0aElzc3VlcyBpc3N1ZXMgaW4gdGhpcyBBdmFpbGFiaWxpdHlHcm91cC4iCiAgICByZXR1cm4gJFVuaGVhbHRoeVJlcGxpY2EKICB9CiAgZWxzZSB7CiAgICBXcml0ZS1WZXJib3NlICJUaGVyZSB3ZXJlICRIZWFsdGhJc3N1ZXMgaXNzdWVzIGluIHRoaXMgQXZhaWxhYmlsaXR5R3JvdXAuIgogICAgcmV0dXJuICRVbmhlYWx0aHlSZXBsaWNhCiAgfQp9CgpGdW5jdGlvbiBDaGVjay1EQlN5bmNocm9uaXNhdGlvbiB7CiAgW0NtZGxldEJpbmRpbmcoKV0KICBwYXJhbSgpCiAgW2FycmF5XSROb3RTeW5jaHJvbmlzZWREQnMgPSBAKCkKICBTZXQtTG9jYXRpb24gIlNRTFNlcnZlcjpcU1FMXCRQcmltYXJ5UmVwbGljYVNlcnZlclxhdmFpbGFiaWxpdHlncm91cHNcJEF2YWlsYWJpbGl0eUdyb3VwTmFtZVxEYXRhYmFzZVJlcGxpY2FTdGF0ZXMiCiAgJERCSGVhbHRoU3RhdGVzID0gZGlyIHwgVGVzdC1TcWxEYXRhYmFzZVJlcGxpY2FTdGF0ZQogIGZvcmVhY2ggKCREQkhlYWx0aFN0YXRlIGluICREQkhlYWx0aFN0YXRlcykgewogICAgaWYgKCREQkhlYWx0aFN0YXRlLkhlYWx0aFN0YXRlIC1uZSAnSGVhbHRoeScpIHsKICAgICAgJE5vdFN5bmNocm9uaXNlZERCcyArPSAkREJIZWFsdGhTdGF0ZS5OYW1lLCREQkhlYWx0aFN0YXRlLkF2YWlsYWJpbGl0eVJlcGxpY2EsJERCSGVhbHRoU3RhdGUuSGVhbHRoU3RhdGUKICAgIH0KICB9CiAgU2V0LUxvY2F0aW9uICRsb2NhdGlvbgogIHJldHVybiAkTm90U3luY2hyb25pc2VkREJzCn0KCkZ1bmN0aW9uIEJhY2t1cC1BdmFpbGFiaWxpdHlEQiB7CiAgW0NtZGxldEJpbmRpbmcoKV0KICBwYXJhbSgpCiAgW2ludF0kZ2xvYmFsOmVycm9yY291bnQgPSAwCiAgU2V0LUxvY2F0aW9uICJTUUxTZXJ2ZXI6XFNRTFwkUHJpbWFyeVJlcGxpY2FTZXJ2ZXJcYXZhaWxhYmlsaXR5Z3JvdXBzXCRBdmFpbGFiaWxpdHlHcm91cE5hbWVcQXZhaWxhYmlsaXR5RGF0YWJhc2VzIgogICREQnMgPSBHZXQtQ2hpbGRJdGVtIC1QYXRoICJTUUxTZXJ2ZXI6XFNRTFwkUHJpbWFyeVJlcGxpY2FTZXJ2ZXJcYXZhaWxhYmlsaXR5Z3JvdXBzXCRBdmFpbGFiaWxpdHlHcm91cE5hbWVcQXZhaWxhYmlsaXR5RGF0YWJhc2VzIgogIGZvcmVhY2ggKCREQiBpbiAkREJzKSB7CiAgICBpZiAoJERCLlN5bmNocm9uaXphdGlvblN0YXRlIC1lcSAnU3luY2hyb25pemVkJykgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlN0YXJ0aW5nIEJhY2t1cCBvZiAkKCREQi5OYW1lKS4iCiAgICAgICAgQmFja3VwLVNxbERhdGFiYXNlICIkKCREQi5OYW1lKSIgIlxcZGMwMVxzb3VyY2VzXFNRTEFsd2F5c09uXCQoJERCLk5hbWUpX1BvU2guYmFrIiAtQmFja3VwQWN0aW9uIERhdGFiYXNlIC1WZXJib3NlCiAgICAgICAgQmFja3VwLVNxbERhdGFiYXNlICIkKCREQi5OYW1lKSIgIlxcZGMwMVxzb3VyY2VzXFNRTEFsd2F5c09uXCQoJERCLk5hbWUpX1BvU2gudHJuIiAtQmFja3VwQWN0aW9uIExvZyAtVmVyYm9zZQogICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUKICAgIAogICAgICAgIGlmICgoIShUZXN0LVBhdGggImZpbGVzeXN0ZW06OlxcZGMwMVxzb3VyY2VzXFNRTEFsd2F5c09uXCQoJERCLk5hbWUpX1BvU2guYmFrIikpIC1vciAoIShUZXN0LVBhdGggImZpbGVzeXN0ZW06OlxcZGMwMVxzb3VyY2VzXFNRTEFsd2F5c09uXCQoJERCLk5hbWUpX1BvU2gudHJuIikpKSB7CiAgICAgICAgICBXcml0ZS1WZXJib3NlICIkKCREQi5OYW1lKSBpcyBtaXNzaW5nIgogICAgICAgICAgJGVycm9yY291bnQrKwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgIFdyaXRlLUVycm9yICIkKCREQi5OYW1lKSBpcyBub3QgaW4gYSBzeW5jaHJvbmlzZWQgc3RhdGUuIEFib3J0aW5nLiIKICAgIH0KICB9CgogIGlmICgkZXJyb3Jjb3VudCAtZXEgMCkgewogICAgV3JpdGUtVmVyYm9zZSAndGhpcyBpcyB0cnVlJwogICAgcmV0dXJuICR0cnVlOwogIH0KICBlbHNlIHsKICAgIFdyaXRlLVZlcmJvc2UgJ3RoaXMgaXMgZmFsc2UnCiAgICByZXR1cm4gJGZhbHNlOwogIH0KICBTZXQtTG9jYXRpb24gJGxvY2F0aW9uCn0KCkZ1bmN0aW9uIERpc2FibGUtQXV0b21hdGljRmFpbG92ZXIgewogIFtjbWRsZXRiaW5kaW5nKCldCiAgcGFyYW0oCiAgICAkTm9kZSwKICAgICRBbHdheXNPbkluc3RhbmNlCiAgKQogIAogICRSZXBsaWNhU2VydmVyID0gJE5vZGUrJ1wnKyRBbHdheXNPbkluc3RhbmNlCiAgCiAgJE5ld1JlcGxpY2FTdHJpbmcgPSAkUmVwbGljYVNlcnZlci5SZXBsYWNlKCdcJywnJTVDJykKICB0cnkgewogICAgU2V0LVNxbEF2YWlsYWJpbGl0eVJlcGxpY2EgLUF2YWlsYWJpbGl0eU1vZGUgJ1N5bmNocm9ub3VzQ29tbWl0JyAtRmFpbG92ZXJNb2RlICdNYW51YWwnIC1QYXRoIFNRTFNFUlZFUjpcU3FsXCRQcmltYXJ5UmVwbGljYVNlcnZlclxBdmFpbGFiaWxpdHlHcm91cHNcJEF2YWlsYWJpbGl0eUdyb3VwTmFtZVxBdmFpbGFiaWxpdHlSZXBsaWNhc1wkTmV3UmVwbGljYVN0cmluZwogIH0KICBjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAkXwogIH0KfQoKRnVuY3Rpb24gR2V0LVNpdGVDb2RlIHsKICBbY21kbGV0QmluZGluZygpXQogIHBhcmFtICgKICAgICRTTVNQcm92aWRlcgogICkKICAkd3FsUXVlcnkgPSAnU0VMRUNUICogRlJPTSBTTVNfUHJvdmlkZXJMb2NhdGlvbicKICAkYSA9IEdldC1XbWlPYmplY3QgLVF1ZXJ5ICR3cWxRdWVyeSAtTmFtZXNwYWNlICdyb290XHNtcycgLUNvbXB1dGVyTmFtZSAkU01TUHJvdmlkZXIKICAkYSB8IEZvckVhY2gtT2JqZWN0IHsKICAgIGlmKCRfLlByb3ZpZGVyRm9yTG9jYWxTaXRlKQogICAgewogICAgICAkU2l0ZUNvZGUgPSAkXy5TaXRlQ29kZQogICAgfQogIH0KICByZXR1cm4gJFNpdGVDb2RlCn0KCkZ1bmN0aW9uIEFkZC1Ob2RlVG9Db25maWdNZ3JDb2xsZWN0aW9uIHsKICBbY21kbGV0QmluZGluZygpXQogIAogIHBhcmFtICgKICAgICROb2RlLAogICAgJENvbGxlY3Rpb25JRCwKICAgICRTaXRlQ29kZSwKICAgICRTTVNQcm92aWRlcgogICkKICAKICAkRGV2aWNlID0gR2V0LVdtaU9iamVjdCAtQ29tcHV0ZXJOYW1lICRTTVNQcm92aWRlciAtQ2xhc3MgU01TX1JfU1lTVEVNIC1OYW1lc3BhY2Ugcm9vdFxzbXNcc2l0ZV8kU2l0ZUNvZGUgLUZpbHRlciAiTmFtZSA9ICckTm9kZSciCiAgJG9iakNvbFJ1bGVkaXJlY3QgPSBbV21pQ2xhc3NdIlxcJFNNU1Byb3ZpZGVyXFJPT1RcU01TXHNpdGVfJCgkU2l0ZUNvZGUpOlNNU19Db2xsZWN0aW9uUnVsZURpcmVjdCIKICAkb2JqQ29sUnVsZURpcmVjdC5wc2Jhc2UucHJvcGVydGllc1siUmVzb3VyY2VDbGFzc05hbWUiXS52YWx1ZSA9ICJTTVNfUl9TeXN0ZW0iCiAgJG9iakNvbFJ1bGVEaXJlY3QucHNiYXNlLnByb3BlcnRpZXNbIlJlc291cmNlSUQiXS52YWx1ZSA9ICREZXZpY2UuUmVzb3VyY2VJRAogIAogICRNQyA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFNNU19Db2xsZWN0aW9uIC1Db21wdXRlck5hbWUgJFNNU1Byb3ZpZGVyIC1OYW1lc3BhY2UgIlJPT1RcU01TXHNpdGVfJFNpdGVDb2RlIiAtRmlsdGVyICJDb2xsZWN0aW9uSUQgPSAnJENvbGxlY3Rpb25JRCciCiAgJEluUGFyYW1zID0gJG1jLnBzYmFzZS5HZXRNZXRob2RQYXJhbWV0ZXJzKCJBZGRNZW1iZXJzaGlwUnVsZSIpCiAgJEluUGFyYW1zLmNvbGxlY3Rpb25SdWxlID0gJG9iakNvbFJ1bGVkaXJlY3QKICAkUiA9ICRtYy5QU0Jhc2UuSW52b2tlTWV0aG9kKCJBZGRNZW1iZXJzaGlwUnVsZSIsICRpblBhcmFtcywgJE51bGwpCn0KCkZ1bmN0aW9uIEludm9rZS1Qb2xpY3lEb3dubG9hZCB7CiAgW0NtZGxldEJpbmRpbmcoKV0KICBwYXJhbSgKICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldCiAgICBbU3lzdGVtLlN0cmluZ10JCQogICAgJENvbXB1dGVyTmFtZT0oZ2V0LWNvbnRlbnQgZW52OmNvbXB1dGVybmFtZSkgI2RlZmF1bHRzIHRvIGxvY2FsIGNvbXB1dGVyIG5hbWUJCQogICkKICAgIEludm9rZS1XbWlNZXRob2QgLU5hbWVzcGFjZSByb290XGNjbSAtQ2xhc3Mgc21zX2NsaWVudCAtTmFtZSBUcmlnZ2VyU2NoZWR1bGUgJ3swMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMjF9JyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbAogICAgI1RyaWdnZXIgbWFjaGluZSBwb2xpY3kgZG93bmxvYWQKICAgIEludm9rZS1XbWlNZXRob2QgLU5hbWVzcGFjZSByb290XGNjbSAtQ2xhc3Mgc21zX2NsaWVudCAtTmFtZSBUcmlnZ2VyU2NoZWR1bGUgJ3swMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMjJ9JyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbAogICAgI1RyaWdnZXIgU29mdHdhcmUgVXBkYXRlIFNjYW5lIGN5Y2xlCiAgICBJbnZva2UtV21pTWV0aG9kIC1OYW1lc3BhY2Ugcm9vdFxjY20gLUNsYXNzIHNtc19jbGllbnQgLU5hbWUgVHJpZ2dlclNjaGVkdWxlICd7MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMTEzfScgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwKICAgICNUcmlnZ2VyIFNvZnR3YXJlIFVwZGF0ZSBEZXBsb3ltZW50IEV2YWx1YXRpb24gQ3ljbGUKICAgIEludm9rZS1XbWlNZXRob2QgLU5hbWVzcGFjZSByb290XGNjbSAtQ2xhc3Mgc21zX2NsaWVudCAtTmFtZSBUcmlnZ2VyU2NoZWR1bGUgJ3swMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAxMTR9JyAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbAoKfQpGdW5jdGlvbiBHZXQtQ29uZmlnTWdyU29mdHdhcmVVcGRhdGVDb21wbGlhbmNlIHsKICBbQ21kbGV0QmluZGluZygpXQogIHBhcmFtKAogICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLFZhbHVlRnJvbVBpcGVsaW5lPSR0cnVlKV0KICAgIFtTeXN0ZW0uU3RyaW5nXQkJCiAgICAkQ29tcHV0ZXJOYW1lPShnZXQtY29udGVudCBlbnY6Y29tcHV0ZXJuYW1lKSAjZGVmYXVsdHMgdG8gbG9jYWwgY29tcHV0ZXIgbmFtZQkJCiAgKQogIEludm9rZS1Qb2xpY3lEb3dubG9hZCAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWU7CiAgZG8gewogICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAzMAogICAgICBXcml0ZS1PdXRwdXQgIkNoZWNraW5nIFNvZnR3YXJlIFVwZGF0ZXMgQ29tcGxpYW5jZSBvbiBbJENvbXB1dGVyTmFtZV0iCiAgICAgIAogICAgICAjY2hlY2sgaWYgdGhlIG1hY2hpbmUgaGFzIGFuIHVwZGF0ZSBhc3NpZ25tZW50IHRhcmdldGVkIGF0IGl0CiAgICAkZ2xvYmFsOlVwZGF0ZUFzc2lnbWVudCA9IEdldC1XbWlPYmplY3QgLVF1ZXJ5ICdTZWxlY3QgKiBmcm9tIENDTV9Bc3NpZ25tZW50Q29tcGxpYW5jZScgLU5hbWVzcGFjZSByb290XGNjbVxTb2Z0d2FyZVVwZGF0ZXNcRGVwbG95bWVudEFnZW50IC1Db21wdXRlck5hbWUgJENvbXB1dGVyTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSA7CiAgICAKICAgIFdyaXRlLU91dHB1dCAkVXBkYXRlQXNzaWdtZW50CiAgICAgICAgICAgIAogICAgICAjaWYgdXBkYXRlIGFzc2lnbm1lbnRzIHdlcmUgcmV0dXJuZWQgY2hlY2sgdG8gc2VlIGlmIGFueSBhcmUgbm9uLWNvbXBsaWFudAogICAgICAgICRJc0NvbXBsaWFudCA9ICR0cnVlCQkJCiAgICAgICAgCiAgICAgICAgJFVwZGF0ZUFzc2lnbWVudCB8IEZvckVhY2gtT2JqZWN0eyAgICAgCiAgICAgICAgICAjbWFyayB0aGUgY29tcGxpYW5jZSBhcyBmYWxzZQogICAgICAgICAgaWYoJF8uSXNDb21wbGlhbnQgLWVxICRmYWxzZSAtYW5kICRJc0NvbXBsaWFudCAtZXEgJHRydWUpeyRJc0NvbXBsaWFudCA9ICRmYWxzZX0KICAgICAgICAgIH0KICAgICAgICAjQ2hlY2sgZm9yIHBlbmRpbmcgcmVib290IHRvIGZpbmlzaCBjb21wbGlhbmNlCiAgICAgICAgJHJlYm9vdFBlbmRpbmcgPSAoSW52b2tlLVdtaU1ldGhvZCAtTmFtZXNwYWNlIHJvb3RcY2NtXGNsaWVudHNkayAtQ2xhc3MgQ0NNX0NsaWVudFV0aWxpdGllcyAtTmFtZSBEZXRlcm1pbmVJZlJlYm9vdFBlbmRpbmcgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lKS5SZWJvb3RQZW5kaW5nCgogICAgICAgICAgaWYgKCRyZWJvb3RQZW5kaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBJbnZva2UtV21pTWV0aG9kIC1OYW1lc3BhY2Ugcm9vdFxjY21cY2xpZW50c2RrIC1DbGFzcyBDQ01fQ2xpZW50VXRpbGl0aWVzIC1OYW1lIFJlc3RhcnRDb21wdXRlciAtQ29tcHV0ZXJOYW1lICRDb21wdXRlck5hbWUKICAgICAgICAgICAgICAgIGRvIHsnd2FpdGluZy4uLic7c3RhcnQtc2xlZXAgLVNlY29uZHMgNX0gCiAgICAgICAgICAgICAgICB3aGlsZSAoLW5vdCAoKGdldC1zZXJ2aWNlIC1uYW1lICdTTVMgQWdlbnQgSG9zdCcgLUNvbXB1dGVyTmFtZSAkQ29tcHV0ZXJOYW1lKS5TdGF0dXMgLWVxICdSdW5uaW5nJykpCgogICAgICAgICAgICB9IAogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAnTm8gcGVuZGluZyByZWJvb3QuIENvbnRpbnVlLi4uJwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHdoaWxlICgtbm90ICRJc0NvbXBsaWFudCkKfQoKI2VuZHJlZ2lvbiBoZWxwZXIgZnVuY3Rpb25zCgoKI3JlZ2lvbiBtYWluIHNjcmlwdCBzdGFydHMgaGVyZQppZiAoR2V0LU1vZHVsZSAtTmFtZSBTUUxQUykgewogIFdyaXRlLVZlcmJvc2UgJ1NRTFBTIE1vZHVsZSBwcmVzZW50LCBjb250aW51ZSc7Cn0KZWxzZSB7CiAgV3JpdGUtVmVyYm9zZSAnU1FMUFMgTW9kdWxlIGlzIG5vdCBwcmVzZW50LCBiZXR0ZXIgaW1wb3J0IGl0JzsKICAKICB0cnkgewogICAgSW1wb3J0LU1vZHVsZSBTUUxQUyAtRGlzYWJsZU5hbWVDaGVja2luZyAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsKICB9CiAgY2F0Y2ggewogICAgV3JpdGUtRXJyb3IgJF8KICB9Cn07CgppZiAoISAoVGVzdC1QYXRoICdTUUxTZXJ2ZXI6JykpIHsKICBXcml0ZS1WZXJib3NlICdDYW5ub3QgYWNjZXNzIHRoZSBTUUxTZXJ2ZXIgUFNEcml2ZS4gRXhpdGluZy4nOwogIGV4aXQgMQogICNleGl0IGFmdGVyIGhlcmUKfQplbHNlIHsKICBTZXQtTG9jYXRpb24gJGxvY2F0aW9uCn0KCiRQcmltYXJ5UmVwbGljYVNlcnZlciA9IEdldC1TUUxBbHdheXNPblJlcGxpY2FOb2RlIC1TUUxOb2RlcyAkU1FMTm9kZXMgLVNRTEluc3RhbmNlICRBbHdheXNPbkluc3RhbmNlIC1Sb2xlIFBSSU1BUlk7CiRTZWNvbmRhcnlSZXBsaWNhU2VydmVyID0gR2V0LVNRTEFsd2F5c09uUmVwbGljYU5vZGUgLVNRTE5vZGVzICRTUUxOb2RlcyAtU1FMSW5zdGFuY2UgJEFsd2F5c09uSW5zdGFuY2UgLVJvbGUgU0VDT05EQVJZOwoKI3JlZ2lvbiBleGVjdXRpbmcgSGVhbHRoQ2hlY2tzCgppZiAoIShDaGVjay1BR0hlYWx0aCAtQUdOYW1lICRBdmFpbGFiaWxpdHlHcm91cE5hbWUpKSB7CiAgU2V0LUxvY2F0aW9uIEM6XAogIFNldC1Mb2NhdGlvbiAkbG9jYXRpb24KICB0aHJvdyAiQXZhaWxhYmlsaXR5R3JvdXAgJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSBpcyBpbiBhbiB1bmhlYWx0aHkgb3IgdW5rbm93biBzdGF0ZS4iCn0KICAgIAokVW5oZWFsdGh5UmVwbGljYSA9IENoZWNrLVJlcGxpY2FIZWFsdGgKCmlmICgtbm90IFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRVbmhlYWx0aHlSZXBsaWNhKSkgewogIFNldC1Mb2NhdGlvbiBDOlwKICBTZXQtTG9jYXRpb24gJGxvY2F0aW9uCiAgdGhyb3cgIklzc3VlcyBmb3VuZCB3aXRoICRVbmhlYWx0aHlSZXBsaWNhLiBQbGVhc2UgY2hlY2sgdGhlIG5vZGUgZm9yIGFueSBpc3N1ZXMuIgp9CgokTm90U3luY2hyb25pc2VkREJzID0gQ2hlY2stREJTeW5jaHJvbmlzYXRpb24KCmlmICgtbm90IFtzdHJpbmddOjpJc051bGxPckVtcHR5KCROb3RTeW5jaHJvbmlzZWREQnMpKSB7CiAgU2V0LUxvY2F0aW9uIEM6XAogIFNldC1Mb2NhdGlvbiAkbG9jYXRpb24KICB0aHJvdyAiSXNzdWVzIGZvdW5kIHdpdGggJE5vdFN5bmNocm9uaXNlZERCcy4gUGxlYXNlIGNoZWNrIHRoZSBub2RlIGZvciBhbnkgaXNzdWVzLiIKfQoKV3JpdGUtVmVyYm9zZSAnQWxsIHNlZW1zIHRvIGJlIGZpbmUuIExldCcncyBnbycKCiNlbmRyZWdpb24gSGVhbHRoQ2hlY2tzCgojcmVnaW9uIGJhY2sgdXAgdGhlIEFsd2F5c09uIERCcwoKdHJ5IHsKICAgIEJhY2t1cC1BdmFpbGFiaWxpdHlEQgp9CmNhdGNoIHsKICAgIFdyaXRlLUVycm9yICRfCn0KCmlmIChCYWNrdXAtQXZhaWxhYmlsaXR5REIpIHsKICAgIFdyaXRlLVZlcmJvc2UgJ0FsbCBEYXRhYmFzZXMgYmFja2VkIHVwJyAKICAgIH0KZWxzZSB7CiAgICB0aHJvdyAiUHJvYmxlbSBiYWNraW5nIHVwIERhdGFiYXNlcy4gJGVycm9yY291bnQgZXJyb3JzLiIKICAgIH0KCiNlbmRyZWdpb24gYmFja3VwCgpmb3JlYWNoICgkU1FMTm9kZSBpbiAkU1FMTm9kZXMpCnsKICBEaXNhYmxlLUF1dG9tYXRpY0ZhaWxvdmVyIC1Ob2RlICRTUUxOb2RlIC1BbHdheXNPbkluc3RhbmNlICRBbHdheXNPbkluc3RhbmNlIC1WZXJib3NlCn0KCiNTdGFydCBVcGRhdGluZyBvbmUgU2Vjb25kYXJ5IE5vZGUgYXQgYSB0aW1lCgokU2l0ZUNvZGUgPSBHZXQtU2l0ZUNvZGUgLVNNU1Byb3ZpZGVyICRTTVNQcm92aWRlcgokaSA9IDAKZm9yZWFjaCAoJFNlY29uZGFyeVJlcGxpY2EgaW4gJFNlY29uZGFyeVJlcGxpY2FTZXJ2ZXIpIHsKICBpZiAoLW5vdCAoJEFscmVhZHlQYXRjaGVkIC1jb250YWlucyAkU2Vjb25kYXJ5UmVwbGljYS5TcGxpdCgnXCcpWzBdKSkgewogICAgdHJ5IHsKICAgICAgJGkrKwogICAgICBXcml0ZS1WZXJib3NlICJQYXRjaGluZyBTZXJ2ZXIgcm91bmQgJGkgPSAkKCRTZWNvbmRhcnlSZXBsaWNhLlNwbGl0KCdcJylbMF0pIgoKICAgICAgI0FkZCBjdXJyZW50IHNlY29uZGFyeSBub2RlIHRvIENvbmZpZ01nciBjb2xsZWN0aW9uIHRvIHJlY2VpdmUgaXRzIHVwZGF0ZXMKICAgICAgQWRkLU5vZGVUb0NvbmZpZ01nckNvbGxlY3Rpb24gLU5vZGUgJFNlY29uZGFyeVJlcGxpY2EuU3BsaXQoJ1wnKVswXSAtU2l0ZUNvZGUgJFNpdGVDb2RlIC1TTVNQcm92aWRlciAkU01TUHJvdmlkZXIgLUNvbGxlY3Rpb25JRCAkQ29sbGVjdGlvbklEIC1WZXJib3NlCgogICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA2MAogICAgICBJbnZva2UtcG9saWN5ZG93bmxvYWQgLWNvbXB1dGVybmFtZSAkU2Vjb25kYXJ5UmVwbGljYS5TcGxpdCgnXCcpWzBdCgogICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA5MAogICAgICBJbnZva2UtcG9saWN5ZG93bmxvYWQgLWNvbXB1dGVybmFtZSAkU2Vjb25kYXJ5UmVwbGljYS5TcGxpdCgnXCcpWzBdCgogICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyA5MAogICAgICAjQ2hlY2sgaWYgYWxsIHVwZGF0ZXMgaGF2ZSBiZWVuIGluc3RhbGxlZCBhbmQgc2VydmVyIGZpbmlzaGVkIHJlYm9vdGluZwogICAgICBXcml0ZS1PdXRwdXQgJ0FwcGx5aW5nIHVwZGF0ZXMgbm93JwogICAgICBHZXQtQ29uZmlnTWdyU29mdHdhcmVVcGRhdGVDb21wbGlhbmNlIC1Db21wdXRlck5hbWUgJFNlY29uZGFyeVJlcGxpY2EuU3BsaXQoJ1wnKVswXQogICAgICAgIAogICAgICAkQWxyZWFkeVBhdGNoZWQgKz0gJFNlY29uZGFyeVJlcGxpY2EuU3BsaXQoJ1wnKVswXQogICAgfQogICAgY2F0Y2ggewogICAgICBXcml0ZS1FcnJvciAkXwogICAgfQogIH0KICBlbHNlIHsKICAgIFdyaXRlLVZlcmJvc2UgIiQoJFNlY29uZGFyeVJlcGxpY2EuU3BsaXQoJ1wnKVswXSkgaGFzIGFscmVhZHkgYmVlbiBwYXRjaGVkLiBTa2lwcGluZy4iCiAgfQp9CgojIGZhaWwgb3ZlciB0byBvbmUgb2YgdGhlIHNlY29uZGFyeSBub2RlcyBhbmQgdXBkYXRlIHRoZSBwcmltYXJ5IG5vZGUsIGFmdGVyIHRoYXQsIGZhaWwgb3ZlciBhZ2FpbiB0byB0aGUgb3JpZ2luYWwgcHJpbWFyeSBub2RlCgpTd2l0Y2gtU3FsQXZhaWxhYmlsaXR5R3JvdXAgLVBhdGggU1FMU0VSVkVSOlxTcWxcJChHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAkU2Vjb25kYXJ5UmVwbGljYVNlcnZlcilcQXZhaWxhYmlsaXR5R3JvdXBzXCRBdmFpbGFiaWxpdHlHcm91cE5hbWUgLVZlcmJvc2UKQWRkLU5vZGVUb0NvbmZpZ01nckNvbGxlY3Rpb24gLU5vZGUgJFByaW1hcnlSZXBsaWNhU2VydmVyLlNwbGl0KCdcJylbMF0gLVNpdGVDb2RlICRTaXRlQ29kZSAtU01TUHJvdmlkZXIgJFNNU1Byb3ZpZGVyIC1Db2xsZWN0aW9uSUQgJENvbGxlY3Rpb25JRCAtVmVyYm9zZQoKU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKSW52b2tlLVBvbGljeURvd25sb2FkIC1jb21wdXRlcm5hbWUgJFByaW1hcnlSZXBsaWNhU2VydmVyLlNwbGl0KCdcJylbMF0KClN0YXJ0LVNsZWVwIC1TZWNvbmRzIDkwCkludm9rZS1Qb2xpY3lEb3dubG9hZCAtY29tcHV0ZXJuYW1lICRQcmltYXJ5UmVwbGljYVNlcnZlci5TcGxpdCgnXCcpWzBdCgpTdGFydC1TbGVlcCAtU2Vjb25kcyA5MAojQ2hlY2sgaWYgYWxsIHVwZGF0ZXMgaGF2ZSBiZWVuIGluc3RhbGxlZCBhbmQgc2VydmVyIGZpbmlzaGVkIHJlYm9vdGluZwpXcml0ZS1PdXRwdXQgJ0FwcGx5aW5nIHVwZGF0ZXMgbm93JwpHZXQtQ29uZmlnTWdyU29mdHdhcmVVcGRhdGVDb21wbGlhbmNlIC1Db21wdXRlck5hbWUgJFByaW1hcnlSZXBsaWNhU2VydmVyLlNwbGl0KCdcJylbMF0KCgojSWYgdGhlIHByaW1hcnkgbm9kZSBpcyBmaW5pc2hlZCB1cGRhdGluZywgZmFpbCBvdmVyIGFnYWluIHRvIHRoZSBQcmltYXJ5ClN3aXRjaC1TcWxBdmFpbGFiaWxpdHlHcm91cCAtUGF0aCBTUUxTRVJWRVI6XFNxbFwkUHJpbWFyeVJlcGxpY2FTZXJ2ZXJcQXZhaWxhYmlsaXR5R3JvdXBzXCRBdmFpbGFiaWxpdHlHcm91cE5hbWUgLVZlcmJvc2UKClNldC1Mb2NhdGlvbiBDOlwKU2V0LUxvY2F0aW9uICRsb2NhdGlvbgoKSWYgKCRTZW5kRW1haWwpIHsKJHNlY3Bhc3N3ZCA9IENvbnZlcnRUby1TZWN1cmVTdHJpbmcgIlhYWFhYWFhYWFhYWFhYWFhYIiAtQXNQbGFpblRleHQgLUZvcmNlCiRteWNyZWRzID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCAoIm9icmllbi5kYXZpZEBvdXRsb29rLmNvbSIsICRzZWNwYXNzd2QpCgpTZW5kLU1haWxNZXNzYWdlIC1Cb2R5ICdUZXN0JyAtU3ViamVjdCAnU1FMIEFsd2F5c09OIENvbXBsZXRpb24gTWVzc2FnZScgLUZyb20gJ29icmllbi5kYXZpZEBvdXRsb29rLmNvbScgLVNtdHBTZXJ2ZXIgZHViNDAzLW0uaG90bWFpbC5jb20gLVVzZVNzbCAtQ3JlZGVudGlhbCAkbXljcmVkcyAtVG8gJ2RhdmlkLm9icmllbkBkaWxpZ25ldC5jb20nCn0KI2VuZHJlZ2lvbiB0aGF0J3MgaXQhCg==
