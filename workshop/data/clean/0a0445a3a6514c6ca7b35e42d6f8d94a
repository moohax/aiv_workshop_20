psake.psm1,311767bec588bc0151607c14b162197b,Scan result is 1. IsMalware: 0,IyBwc2FrZQojIENvcHlyaWdodCAoYykgMjAxMiBKYW1lcyBLb3ZhY3MKIyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CiMgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKIyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCiMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAojIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwojIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CiMKIyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgojIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgojCiMgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKIyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKIyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKIyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCiMgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKIyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCiMgVEhFIFNPRlRXQVJFLgoKI1JlcXVpcmVzIC1WZXJzaW9uIDIuMAoKIy0tIFB1YmxpYyBNb2R1bGUgRnVuY3Rpb25zIC0tIwoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIEludm9rZS1UYXNrCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXSBbc3RyaW5nXSR0YXNrTmFtZQogICAgKQoKICAgIEFzc2VydCAkdGFza05hbWUgKCRtc2dzLmVycm9yX2ludmFsaWRfdGFza19uYW1lKQoKICAgICR0YXNrS2V5ID0gJHRhc2tOYW1lLlRvTG93ZXIoKQoKICAgIGlmICgkY3VycmVudENvbnRleHQuYWxpYXNlcy5Db250YWlucygkdGFza0tleSkpIHsKICAgICAgICAkdGFza05hbWUgPSAkY3VycmVudENvbnRleHQuYWxpYXNlcy4kdGFza0tleS5OYW1lCiAgICAgICAgJHRhc2tLZXkgPSAkdGFza05hbWUuVG9Mb3dlcigpCiAgICB9CgogICAgJGN1cnJlbnRDb250ZXh0ID0gJHBzYWtlLmNvbnRleHQuUGVlaygpCgogICAgQXNzZXJ0ICgkY3VycmVudENvbnRleHQudGFza3MuQ29udGFpbnMoJHRhc2tLZXkpKSAoJG1zZ3MuZXJyb3JfdGFza19uYW1lX2RvZXNfbm90X2V4aXN0IC1mICR0YXNrTmFtZSkKCiAgICBpZiAoJGN1cnJlbnRDb250ZXh0LmV4ZWN1dGVkVGFza3MuQ29udGFpbnMoJHRhc2tLZXkpKSAgeyByZXR1cm4gfQoKICAgIEFzc2VydCAoISRjdXJyZW50Q29udGV4dC5jYWxsU3RhY2suQ29udGFpbnMoJHRhc2tLZXkpKSAoJG1zZ3MuZXJyb3JfY2lyY3VsYXJfcmVmZXJlbmNlIC1mICR0YXNrTmFtZSkKCiAgICAkY3VycmVudENvbnRleHQuY2FsbFN0YWNrLlB1c2goJHRhc2tLZXkpCgogICAgJHRhc2sgPSAkY3VycmVudENvbnRleHQudGFza3MuJHRhc2tLZXkKCiAgICAkcHJlY29uZGl0aW9uX2lzX3ZhbGlkID0gJiAkdGFzay5QcmVjb25kaXRpb24KCiAgICBpZiAoISRwcmVjb25kaXRpb25faXNfdmFsaWQpIHsKICAgICAgICBXcml0ZUNvbG9yZWRPdXRwdXQgKCRtc2dzLnByZWNvbmRpdGlvbl93YXNfZmFsc2UgLWYgJHRhc2tOYW1lKSAtZm9yZWdyb3VuZGNvbG9yIEN5YW4KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCR0YXNrS2V5IC1uZSAnZGVmYXVsdCcpIHsKCiAgICAgICAgICAgIGlmICgkdGFzay5QcmVBY3Rpb24gLW9yICR0YXNrLlBvc3RBY3Rpb24pIHsKICAgICAgICAgICAgICAgIEFzc2VydCAoJHRhc2suQWN0aW9uIC1uZSAkbnVsbCkgKCRtc2dzLmVycm9yX21pc3NpbmdfYWN0aW9uX3BhcmFtZXRlciAtZiAkdGFza05hbWUpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgkdGFzay5BY3Rpb24pIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkY2hpbGRUYXNrIGluICR0YXNrLkRlcGVuZHNPbikgewogICAgICAgICAgICAgICAgICAgICAgICBJbnZva2UtVGFzayAkY2hpbGRUYXNrCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkc3RvcHdhdGNoID0gW1N5c3RlbS5EaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRDb250ZXh0LmN1cnJlbnRUYXNrTmFtZSA9ICR0YXNrTmFtZQoKICAgICAgICAgICAgICAgICAgICAmICRjdXJyZW50Q29udGV4dC50YXNrU2V0dXBTY3JpcHRCbG9jawoKICAgICAgICAgICAgICAgICAgICBpZiAoJHRhc2suUHJlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICYgJHRhc2suUHJlQWN0aW9uCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoJGN1cnJlbnRDb250ZXh0LmNvbmZpZy50YXNrTmFtZUZvcm1hdCAtaXMgW1NjcmlwdEJsb2NrXSkgewogICAgICAgICAgICAgICAgICAgICAgICAmICRjdXJyZW50Q29udGV4dC5jb25maWcudGFza05hbWVGb3JtYXQgJHRhc2tOYW1lCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGVDb2xvcmVkT3V0cHV0ICgkY3VycmVudENvbnRleHQuY29uZmlnLnRhc2tOYW1lRm9ybWF0IC1mICR0YXNrTmFtZSkgLWZvcmVncm91bmRjb2xvciBDeWFuCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkdmFyaWFibGUgaW4gJHRhc2sucmVxdWlyZWRWYXJpYWJsZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgQXNzZXJ0ICgodGVzdC1wYXRoICJ2YXJpYWJsZTokdmFyaWFibGUiKSAtYW5kICgoZ2V0LXZhcmlhYmxlICR2YXJpYWJsZSkuVmFsdWUgLW5lICRudWxsKSkgKCRtc2dzLnJlcXVpcmVkX3ZhcmlhYmxlX25vdF9zZXQgLWYgJHZhcmlhYmxlLCAkdGFza05hbWUpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBFeGVjICR0YXNrLkFjdGlvbiBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1tYXhSZXRyaWVzICAgICAgICAgICAgICAgJHRhc2suTWF4UmV0cmllcyBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1yZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4gJHRhc2suUmV0cnlUcmlnZ2VyRXJyb3JQYXR0ZXJuCgogICAgICAgICAgICAgICAgICAgIGlmICgkdGFzay5Qb3N0QWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICYgJHRhc2suUG9zdEFjdGlvbgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJiAkY3VycmVudENvbnRleHQudGFza1RlYXJEb3duU2NyaXB0QmxvY2sKICAgICAgICAgICAgICAgICAgICAkdGFzay5EdXJhdGlvbiA9ICRzdG9wd2F0Y2guRWxhcHNlZAogICAgICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCR0YXNrLkNvbnRpbnVlT25FcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAiLSIqNzAKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGVDb2xvcmVkT3V0cHV0ICgkbXNncy5jb250aW51ZV9vbl9lcnJvciAtZiAkdGFza05hbWUsJF8pIC1mb3JlZ3JvdW5kY29sb3IgWWVsbG93CiAgICAgICAgICAgICAgICAgICAgICAgICItIio3MAogICAgICAgICAgICAgICAgICAgICAgICAkdGFzay5EdXJhdGlvbiA9ICRzdG9wd2F0Y2guRWxhcHNlZAogICAgICAgICAgICAgICAgICAgIH0gIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAkXwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICMgbm8gYWN0aW9uIHdhcyBzcGVjaWZpZWQgYnV0IHdlIHN0aWxsIGV4ZWN1dGUgYWxsIHRoZSBkZXBlbmRlbmNpZXMKICAgICAgICAgICAgICAgIGZvcmVhY2goJGNoaWxkVGFzayBpbiAkdGFzay5EZXBlbmRzT24pIHsKICAgICAgICAgICAgICAgICAgICBJbnZva2UtVGFzayAkY2hpbGRUYXNrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3JlYWNoKCRjaGlsZFRhc2sgaW4gJHRhc2suRGVwZW5kc09uKSB7CiAgICAgICAgICAgICAgICBJbnZva2UtVGFzayAkY2hpbGRUYXNrCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEFzc2VydCAoJiAkdGFzay5Qb3N0Y29uZGl0aW9uKSAoJG1zZ3MucG9zdGNvbmRpdGlvbl9mYWlsZWQgLWYgJHRhc2tOYW1lKQogICAgfQoKICAgICRwb3BwZWRUYXNrS2V5ID0gJGN1cnJlbnRDb250ZXh0LmNhbGxTdGFjay5Qb3AoKQogICAgQXNzZXJ0ICgkcG9wcGVkVGFza0tleSAtZXEgJHRhc2tLZXkpICgkbXNncy5lcnJvcl9jb3JydXB0X2NhbGxzdGFjayAtZiAkdGFza0tleSwkcG9wcGVkVGFza0tleSkKCiAgICAkY3VycmVudENvbnRleHQuZXhlY3V0ZWRUYXNrcy5QdXNoKCR0YXNrS2V5KQp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gRXhlYwp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc2NyaXB0YmxvY2tdJGNtZCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTEsTWFuZGF0b3J5PTApXVtzdHJpbmddJGVycm9yTWVzc2FnZSA9ICgkbXNncy5lcnJvcl9iYWRfY29tbWFuZCAtZiAkY21kKSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTIsTWFuZGF0b3J5PTApXVtpbnRdJG1heFJldHJpZXMgPSAwLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MyxNYW5kYXRvcnk9MCldW3N0cmluZ10kcmV0cnlUcmlnZ2VyRXJyb3JQYXR0ZXJuID0gJG51bGwKICAgICkKCiAgICAkdHJ5Q291bnQgPSAxCgogICAgZG8gewogICAgICAgIHRyeSB7IAogICAgICAgICAgICAmICRjbWQKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggW0V4Y2VwdGlvbl0KICAgICAgICB7CiAgICAgICAgICAgIGlmICgkdHJ5Q291bnQgLWd0ICRtYXhSZXRyaWVzKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAkXwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoJHJldHJ5VHJpZ2dlckVycm9yUGF0dGVybiAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICRpc01hdGNoID0gW3JlZ2V4XTo6SXNNYXRjaCgkXy5FeGNlcHRpb24uTWVzc2FnZSwgJHJldHJ5VHJpZ2dlckVycm9yUGF0dGVybikKCiAgICAgICAgICAgICAgICBpZiAoJGlzTWF0Y2ggLWVxICRmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIHRocm93ICRfCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFdyaXRlLUhvc3QgIlRyeSAkdHJ5Q291bnQgZmFpbGVkLCByZXRyeWluZyBhZ2FpbiBpbiAxIHNlY29uZC4uLiIKCiAgICAgICAgICAgICR0cnlDb3VudCsrCgogICAgICAgICAgICBbU3lzdGVtLlRocmVhZGluZy5UaHJlYWRdOjpTbGVlcChbU3lzdGVtLlRpbWVTcGFuXTo6RnJvbVNlY29uZHMoMSkpCiAgICAgICAgfQogICAgfQogICAgd2hpbGUgKCR0cnVlKQp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gQXNzZXJ0CnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXSRjb25kaXRpb25Ub0NoZWNrLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MSxNYW5kYXRvcnk9MSldJGZhaWx1cmVNZXNzYWdlCiAgICApCiAgICBpZiAoISRjb25kaXRpb25Ub0NoZWNrKSB7CiAgICAgICAgdGhyb3cgKCJBc3NlcnQ6ICIgKyAkZmFpbHVyZU1lc3NhZ2UpCiAgICB9Cn0KCiMgLkV4dGVybmFsSGVscCAgcHNha2UucHNtMS1oZWxwLnhtbApmdW5jdGlvbiBUYXNrCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXVtzdHJpbmddJG5hbWUgPSAkbnVsbCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTEsTWFuZGF0b3J5PTApXVtzY3JpcHRibG9ja10kYWN0aW9uID0gJG51bGwsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0yLE1hbmRhdG9yeT0wKV1bc2NyaXB0YmxvY2tdJHByZWFjdGlvbiA9ICRudWxsLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MyxNYW5kYXRvcnk9MCldW3NjcmlwdGJsb2NrXSRwb3N0YWN0aW9uID0gJG51bGwsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj00LE1hbmRhdG9yeT0wKV1bc2NyaXB0YmxvY2tdJHByZWNvbmRpdGlvbiA9IHskdHJ1ZX0sCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj01LE1hbmRhdG9yeT0wKV1bc2NyaXB0YmxvY2tdJHBvc3Rjb25kaXRpb24gPSB7JHRydWV9LAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249NixNYW5kYXRvcnk9MCldW3N3aXRjaF0kY29udGludWVPbkVycm9yID0gJGZhbHNlLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249NyxNYW5kYXRvcnk9MCldW3N0cmluZ1tdXSRkZXBlbmRzID0gQCgpLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249OCxNYW5kYXRvcnk9MCldW3N0cmluZ1tdXSRyZXF1aXJlZFZhcmlhYmxlcyA9IEAoKSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTksTWFuZGF0b3J5PTApXVtzdHJpbmddJGRlc2NyaXB0aW9uID0gJG51bGwsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0xMCxNYW5kYXRvcnk9MCldW3N0cmluZ10kYWxpYXMgPSAkbnVsbCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTExLE1hbmRhdG9yeT0wKV1bc3RyaW5nXSRtYXhSZXRyaWVzID0gMCwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTEyLE1hbmRhdG9yeT0wKV1bc3RyaW5nXSRyZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4gPSAkbnVsbAogICAgKQogICAgaWYgKCRuYW1lIC1lcSAnZGVmYXVsdCcpIHsKICAgICAgICBBc3NlcnQgKCEkYWN0aW9uKSAoJG1zZ3MuZXJyb3JfZGVmYXVsdF90YXNrX2Nhbm5vdF9oYXZlX2FjdGlvbikKICAgIH0KCiAgICAkbmV3VGFzayA9IEB7CiAgICAgICAgTmFtZSA9ICRuYW1lCiAgICAgICAgRGVwZW5kc09uID0gJGRlcGVuZHMKICAgICAgICBQcmVBY3Rpb24gPSAkcHJlYWN0aW9uCiAgICAgICAgQWN0aW9uID0gJGFjdGlvbgogICAgICAgIFBvc3RBY3Rpb24gPSAkcG9zdGFjdGlvbgogICAgICAgIFByZWNvbmRpdGlvbiA9ICRwcmVjb25kaXRpb24KICAgICAgICBQb3N0Y29uZGl0aW9uID0gJHBvc3Rjb25kaXRpb24KICAgICAgICBDb250aW51ZU9uRXJyb3IgPSAkY29udGludWVPbkVycm9yCiAgICAgICAgRGVzY3JpcHRpb24gPSAkZGVzY3JpcHRpb24KICAgICAgICBEdXJhdGlvbiA9IFtTeXN0ZW0uVGltZVNwYW5dOjpaZXJvCiAgICAgICAgUmVxdWlyZWRWYXJpYWJsZXMgPSAkcmVxdWlyZWRWYXJpYWJsZXMKICAgICAgICBBbGlhcyA9ICRhbGlhcwogICAgICAgIE1heFJldHJpZXMgPSAkbWF4UmV0cmllcwogICAgICAgIFJldHJ5VHJpZ2dlckVycm9yUGF0dGVybiA9ICRyZXRyeVRyaWdnZXJFcnJvclBhdHRlcm4KICAgIH0KCiAgICAkdGFza0tleSA9ICRuYW1lLlRvTG93ZXIoKQoKICAgICRjdXJyZW50Q29udGV4dCA9ICRwc2FrZS5jb250ZXh0LlBlZWsoKQoKICAgIEFzc2VydCAoISRjdXJyZW50Q29udGV4dC50YXNrcy5Db250YWluc0tleSgkdGFza0tleSkpICgkbXNncy5lcnJvcl9kdXBsaWNhdGVfdGFza19uYW1lIC1mICRuYW1lKQoKICAgICRjdXJyZW50Q29udGV4dC50YXNrcy4kdGFza0tleSA9ICRuZXdUYXNrCgogICAgaWYoJGFsaWFzKQogICAgewogICAgICAgICRhbGlhc0tleSA9ICRhbGlhcy5Ub0xvd2VyKCkKCiAgICAgICAgQXNzZXJ0ICghJGN1cnJlbnRDb250ZXh0LmFsaWFzZXMuQ29udGFpbnNLZXkoJGFsaWFzS2V5KSkgKCRtc2dzLmVycm9yX2R1cGxpY2F0ZV9hbGlhc19uYW1lIC1mICRhbGlhcykKCiAgICAgICAgJGN1cnJlbnRDb250ZXh0LmFsaWFzZXMuJGFsaWFzS2V5ID0gJG5ld1Rhc2sKICAgIH0KfQoKIyAuRXh0ZXJuYWxIZWxwICBwc2FrZS5wc20xLWhlbHAueG1sCmZ1bmN0aW9uIFByb3BlcnRpZXMgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb249MCxNYW5kYXRvcnk9MSldW3NjcmlwdGJsb2NrXSRwcm9wZXJ0aWVzCiAgICApCiAgICAkcHNha2UuY29udGV4dC5QZWVrKCkucHJvcGVydGllcyArPSAkcHJvcGVydGllcwp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gSW5jbHVkZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV1bc3RyaW5nXSRmaWxlTmFtZVBhdGhUb0luY2x1ZGUKICAgICkKICAgIEFzc2VydCAodGVzdC1wYXRoICRmaWxlTmFtZVBhdGhUb0luY2x1ZGUgLXBhdGhUeXBlIExlYWYpICgkbXNncy5lcnJvcl9pbnZhbGlkX2luY2x1ZGVfcGF0aCAtZiAkZmlsZU5hbWVQYXRoVG9JbmNsdWRlKQogICAgJHBzYWtlLmNvbnRleHQuUGVlaygpLmluY2x1ZGVzLkVucXVldWUoKFJlc29sdmUtUGF0aCAkZmlsZU5hbWVQYXRoVG9JbmNsdWRlKSk7Cn0KCiMgLkV4dGVybmFsSGVscCAgcHNha2UucHNtMS1oZWxwLnhtbApmdW5jdGlvbiBGb3JtYXRUYXNrTmFtZSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbj0wLE1hbmRhdG9yeT0xKV0kZm9ybWF0CiAgICApCiAgICAkcHNha2UuY29udGV4dC5QZWVrKCkuY29uZmlnLnRhc2tOYW1lRm9ybWF0ID0gJGZvcm1hdAp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gVGFza1NldHVwIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXVtzY3JpcHRibG9ja10kc2V0dXAKICAgICkKICAgICRwc2FrZS5jb250ZXh0LlBlZWsoKS50YXNrU2V0dXBTY3JpcHRCbG9jayA9ICRzZXR1cAp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gVGFza1RlYXJEb3duIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXVtzY3JpcHRibG9ja10kdGVhcmRvd24KICAgICkKICAgICRwc2FrZS5jb250ZXh0LlBlZWsoKS50YXNrVGVhckRvd25TY3JpcHRCbG9jayA9ICR0ZWFyZG93bgp9CgojIC5FeHRlcm5hbEhlbHAgIHBzYWtlLnBzbTEtaGVscC54bWwKZnVuY3Rpb24gRnJhbWV3b3JrIHsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uPTAsTWFuZGF0b3J5PTEpXVtzdHJpbmddJGZyYW1ld29yawogICAgKQogICAgJHBzYWtlLmNvbnRleHQuUGVlaygpLmNvbmZpZy5mcmFtZXdvcmsgPSAkZnJhbWV3b3JrCn0KCiMgLkV4dGVybmFsSGVscCAgcHNha2UucHNtMS1oZWxwLnhtbApmdW5jdGlvbiBJbnZva2UtcHNha2UgewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAwKV1bc3RyaW5nXSAkYnVpbGRGaWxlLAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAwKV1bc3RyaW5nW11dICR0YXNrTGlzdCA9IEAoKSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMiwgTWFuZGF0b3J5ID0gMCldW3N0cmluZ10gJGZyYW1ld29yaywKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMywgTWFuZGF0b3J5ID0gMCldW3N3aXRjaF0gJGRvY3MgPSAkZmFsc2UsCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDQsIE1hbmRhdG9yeSA9IDApXVtoYXNodGFibGVdICRwYXJhbWV0ZXJzID0gQHt9LAogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSA1LCBNYW5kYXRvcnkgPSAwKV1baGFzaHRhYmxlXSAkcHJvcGVydGllcyA9IEB7fSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNiwgTWFuZGF0b3J5ID0gMCldW2FsaWFzKCJpbml0IildW3NjcmlwdGJsb2NrXSAkaW5pdGlhbGl6YXRpb24gPSB7fSwKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gNywgTWFuZGF0b3J5ID0gMCldW3N3aXRjaF0gJG5vbG9nbyA9ICRmYWxzZQogICAgKQogICAgdHJ5IHsKICAgICAgICBpZiAoLW5vdCAkbm9sb2dvKSB7CiAgICAgICAgICAgICJwc2FrZSB2ZXJzaW9uIHswfWBuQ29weXJpZ2h0IChjKSAyMDEwIEphbWVzIEtvdmFjc2BuIiAtZiAkcHNha2UudmVyc2lvbgogICAgICAgIH0KCiAgICAgICAgIyBJZiB0aGUgZGVmYXVsdC5wczEgZmlsZSBleGlzdHMgYW5kIHRoZSBnaXZlbiAiYnVpbGRmaWxlIiBpc24gJ3QgZm91bmQgYXNzdW1lIHRoYXQgdGhlIGdpdmVuCiAgICAgICAgIyAkYnVpbGRGaWxlIGlzIGFjdHVhbGx5IHRoZSB0YXJnZXQgVGFza3MgdG8gZXhlY3V0ZSBpbiB0aGUgZGVmYXVsdC5wczEgc2NyaXB0LgogICAgICAgIGlmICgkYnVpbGRGaWxlIC1hbmQgISh0ZXN0LXBhdGggJGJ1aWxkRmlsZSAtcGF0aFR5cGUgTGVhZikgLWFuZCAodGVzdC1wYXRoICRwc2FrZS5jb25maWdfZGVmYXVsdC5idWlsZEZpbGVOYW1lIC1wYXRoVHlwZSBMZWFmKSkgewogICAgICAgICAgICAkdGFza0xpc3QgPSAkYnVpbGRGaWxlLlNwbGl0KCcsICcpCiAgICAgICAgICAgICRidWlsZEZpbGUgPSAkcHNha2UuY29uZmlnX2RlZmF1bHQuYnVpbGRGaWxlTmFtZQogICAgICAgIH0KCiAgICAgICAgIyBFeGVjdXRlIHRoZSBidWlsZCBmaWxlIHRvIHNldCB1cCB0aGUgdGFza3MgYW5kIGRlZmF1bHRzCiAgICAgICAgQXNzZXJ0ICh0ZXN0LXBhdGggJGJ1aWxkRmlsZSAtcGF0aFR5cGUgTGVhZikgKCRtc2dzLmVycm9yX2J1aWxkX2ZpbGVfbm90X2ZvdW5kIC1mICRidWlsZEZpbGUpCgogICAgICAgICRwc2FrZS5idWlsZF9zY3JpcHRfZmlsZSA9IGdldC1pdGVtICRidWlsZEZpbGUKICAgICAgICAkcHNha2UuYnVpbGRfc2NyaXB0X2RpciA9ICRwc2FrZS5idWlsZF9zY3JpcHRfZmlsZS5EaXJlY3RvcnlOYW1lCiAgICAgICAgJHBzYWtlLmJ1aWxkX3N1Y2Nlc3MgPSAkZmFsc2UKCiAgICAgICAgJHBzYWtlLmNvbnRleHQucHVzaChAewogICAgICAgICAgICAidGFza1NldHVwU2NyaXB0QmxvY2siID0ge307CiAgICAgICAgICAgICJ0YXNrVGVhckRvd25TY3JpcHRCbG9jayIgPSB7fTsKICAgICAgICAgICAgImV4ZWN1dGVkVGFza3MiID0gbmV3LW9iamVjdCBTeXN0ZW0uQ29sbGVjdGlvbnMuU3RhY2s7CiAgICAgICAgICAgICJjYWxsU3RhY2siID0gbmV3LW9iamVjdCBTeXN0ZW0uQ29sbGVjdGlvbnMuU3RhY2s7CiAgICAgICAgICAgICJvcmlnaW5hbEVudlBhdGgiID0gJGVudjpwYXRoOwogICAgICAgICAgICAib3JpZ2luYWxEaXJlY3RvcnkiID0gZ2V0LWxvY2F0aW9uOwogICAgICAgICAgICAib3JpZ2luYWxFcnJvckFjdGlvblByZWZlcmVuY2UiID0gJGdsb2JhbDpFcnJvckFjdGlvblByZWZlcmVuY2U7CiAgICAgICAgICAgICJ0YXNrcyIgPSBAe307CiAgICAgICAgICAgICJhbGlhc2VzIiA9IEB7fTsKICAgICAgICAgICAgInByb3BlcnRpZXMiID0gQCgpOwogICAgICAgICAgICAiaW5jbHVkZXMiID0gbmV3LW9iamVjdCBTeXN0ZW0uQ29sbGVjdGlvbnMuUXVldWU7CiAgICAgICAgICAgICJjb25maWciID0gQ3JlYXRlQ29uZmlndXJhdGlvbkZvck5ld0NvbnRleHQgJGJ1aWxkRmlsZSAkZnJhbWV3b3JrCiAgICAgICAgfSkKCiAgICAgICAgTG9hZENvbmZpZ3VyYXRpb24gJHBzYWtlLmJ1aWxkX3NjcmlwdF9kaXIKCiAgICAgICAgTG9hZE1vZHVsZXMKCiAgICAgICAgJHN0b3B3YXRjaCA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuU3RvcHdhdGNoXTo6U3RhcnROZXcoKQoKICAgICAgICBzZXQtbG9jYXRpb24gJHBzYWtlLmJ1aWxkX3NjcmlwdF9kaXIKCiAgICAgICAgJGZyYW1ld29ya09sZFZhbHVlID0gJGZyYW1ld29yawogICAgICAgIC4gJHBzYWtlLmJ1aWxkX3NjcmlwdF9maWxlLkZ1bGxOYW1lCgogICAgICAgICRjdXJyZW50Q29udGV4dCA9ICRwc2FrZS5jb250ZXh0LlBlZWsoKQoKICAgICAgICBpZiAoJGZyYW1ld29yayAtbmUgJGZyYW1ld29ya09sZFZhbHVlKSB7CiAgICAgICAgICAgIHdyaXRlY29sb3JlZG91dHB1dCAkbXNncy53YXJuaW5nX2RlcHJlY2F0ZWRfZnJhbWV3b3JrX3ZhcmlhYmxlIC1mb3JlZ3JvdW5kY29sb3IgWWVsbG93CiAgICAgICAgICAgICRjdXJyZW50Q29udGV4dC5jb25maWcuZnJhbWV3b3JrID0gJGZyYW1ld29yawogICAgICAgIH0KCiAgICAgICAgQ29uZmlndXJlQnVpbGRFbnZpcm9ubWVudAoKICAgICAgICB3aGlsZSAoJGN1cnJlbnRDb250ZXh0LmluY2x1ZGVzLkNvdW50IC1ndCAwKSB7CiAgICAgICAgICAgICRpbmNsdWRlRmlsZW5hbWUgPSAkY3VycmVudENvbnRleHQuaW5jbHVkZXMuRGVxdWV1ZSgpCiAgICAgICAgICAgIC4gJGluY2x1ZGVGaWxlbmFtZQogICAgICAgIH0KCiAgICAgICAgaWYgKCRkb2NzKSB7CiAgICAgICAgICAgIFdyaXRlRG9jdW1lbnRhdGlvbgogICAgICAgICAgICBDbGVhbnVwRW52aXJvbm1lbnQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgfQoKICAgICAgICBmb3JlYWNoICgka2V5IGluICRwYXJhbWV0ZXJzLmtleXMpIHsKICAgICAgICAgICAgaWYgKHRlc3QtcGF0aCAidmFyaWFibGU6XCRrZXkiKSB7CiAgICAgICAgICAgICAgICBzZXQtaXRlbSAtcGF0aCAidmFyaWFibGU6XCRrZXkiIC12YWx1ZSAkcGFyYW1ldGVycy4ka2V5IC1XaGF0SWY6JGZhbHNlIC1Db25maXJtOiRmYWxzZSB8IG91dC1udWxsCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXctaXRlbSAtcGF0aCAidmFyaWFibGU6XCRrZXkiIC12YWx1ZSAkcGFyYW1ldGVycy4ka2V5IC1XaGF0SWY6JGZhbHNlIC1Db25maXJtOiRmYWxzZSB8IG91dC1udWxsCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgVGhlIGluaXRpYWwgZG90ICguKSBpbmRpY2F0ZXMgdGhhdCB2YXJpYWJsZXMgaW5pdGlhbGl6ZWQvbW9kaWZpZWQgaW4gdGhlIHByb3BlcnR5QmxvY2sgYXJlIGF2YWlsYWJsZSBpbiB0aGUgcGFyZW50IHNjb3BlLgogICAgICAgIGZvcmVhY2ggKCRwcm9wZXJ0eUJsb2NrIGluICRjdXJyZW50Q29udGV4dC5wcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgIC4gJHByb3BlcnR5QmxvY2sKICAgICAgICB9CgogICAgICAgIGZvcmVhY2ggKCRrZXkgaW4gJHByb3BlcnRpZXMua2V5cykgewogICAgICAgICAgICBpZiAodGVzdC1wYXRoICJ2YXJpYWJsZTpcJGtleSIpIHsKICAgICAgICAgICAgICAgIHNldC1pdGVtIC1wYXRoICJ2YXJpYWJsZTpcJGtleSIgLXZhbHVlICRwcm9wZXJ0aWVzLiRrZXkgLVdoYXRJZjokZmFsc2UgLUNvbmZpcm06JGZhbHNlIHwgb3V0LW51bGwKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBTaW1wbGUgZG90IHNvdXJjaW5nIHdpbGwgbm90IHdvcmsuIFdlIGhhdmUgdG8gZm9yY2UgdGhlIHNjcmlwdCBibG9jayBpbnRvIG91cgogICAgICAgICMgbW9kdWxlJ3Mgc2NvcGUgaW4gb3JkZXIgdG8gaW5pdGlhbGl6ZSB2YXJpYWJsZXMgcHJvcGVybHkuCiAgICAgICAgLiAkTXlJbnZvY2F0aW9uLk15Q29tbWFuZC5Nb2R1bGUgJGluaXRpYWxpemF0aW9uCgogICAgICAgICMgRXhlY3V0ZSB0aGUgbGlzdCBvZiB0YXNrcyBvciB0aGUgZGVmYXVsdCB0YXNrCiAgICAgICAgaWYgKCR0YXNrTGlzdCkgewogICAgICAgICAgICBmb3JlYWNoICgkdGFzayBpbiAkdGFza0xpc3QpIHsKICAgICAgICAgICAgICAgIGludm9rZS10YXNrICR0YXNrCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2VpZiAoJGN1cnJlbnRDb250ZXh0LnRhc2tzLmRlZmF1bHQpIHsKICAgICAgICAgICAgaW52b2tlLXRhc2sgZGVmYXVsdAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93ICRtc2dzLmVycm9yX25vX2RlZmF1bHRfdGFzawogICAgICAgIH0KCiAgICAgICAgV3JpdGVDb2xvcmVkT3V0cHV0ICgiYG4iICsgJG1zZ3MuYnVpbGRfc3VjY2VzcyArICJgbiIpIC1mb3JlZ3JvdW5kY29sb3IgR3JlZW4KCiAgICAgICAgV3JpdGVUYXNrVGltZVN1bW1hcnkgJHN0b3B3YXRjaC5FbGFwc2VkCgogICAgICAgICRwc2FrZS5idWlsZF9zdWNjZXNzID0gJHRydWUKICAgIH0gY2F0Y2ggewogICAgICAgICRjdXJyZW50Q29uZmlnID0gR2V0Q3VycmVudENvbmZpZ3VyYXRpb25PckRlZmF1bHQKICAgICAgICBpZiAoJGN1cnJlbnRDb25maWcudmVyYm9zZUVycm9yKSB7CiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlID0gInswfTogQW4gRXJyb3IgT2NjdXJyZWQuIFNlZSBFcnJvciBEZXRhaWxzIEJlbG93OiBgbiIgLWYgKEdldC1EYXRlKQogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSArPSAoIi0iICogNzApICsgImBuIgogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSArPSAiRXJyb3I6IHswfWBuIiAtZiAoUmVzb2x2ZUVycm9yICRfIC1TaG9ydCkKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gKCItIiAqIDcwKSArICJgbiIKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gUmVzb2x2ZUVycm9yICRfCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9ICgiLSIgKiA3MCkgKyAiYG4iCiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlICs9ICJTY3JpcHQgVmFyaWFibGVzIiArICJgbiIKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gKCItIiAqIDcwKSArICJgbiIKICAgICAgICAgICAgJGVycm9yX21lc3NhZ2UgKz0gZ2V0LXZhcmlhYmxlIC1zY29wZSBzY3JpcHQgfCBmb3JtYXQtdGFibGUgfCBvdXQtc3RyaW5nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIyAoJF8gfCBPdXQtU3RyaW5nKSBnZXRzIGVycm9yIG1lc3NhZ2VzIHdpdGggc291cmNlIGluZm9ybWF0aW9uIGluY2x1ZGVkLgogICAgICAgICAgICAkZXJyb3JfbWVzc2FnZSA9ICJFcnJvcjogezB9OiBgbnsxfSIgLWYgKEdldC1EYXRlKSwgKFJlc29sdmVFcnJvciAkXyAtU2hvcnQpCiAgICAgICAgfQoKICAgICAgICAkcHNha2UuYnVpbGRfc3VjY2VzcyA9ICRmYWxzZQoKICAgICAgICAjIGlmIHdlIGFyZSBydW5uaW5nIGluIGEgbmVzdGVkIHNjb3BlIChpLmUuIHJ1bm5pbmcgYSBwc2FrZSBzY3JpcHQgZnJvbSBhIHBzYWtlIHNjcmlwdCkgdGhlbiB3ZSBuZWVkIHRvIHJlLXRocm93IHRoZSBleGNlcHRpb24KICAgICAgICAjIHNvIHRoYXQgdGhlIHBhcmVudCBzY3JpcHQgd2lsbCBmYWlsIG90aGVyd2lzZSB0aGUgcGFyZW50IHNjcmlwdCB3aWxsIHJlcG9ydCBhIHN1Y2Nlc3NmdWwgYnVpbGQgCiAgICAgICAgJGluTmVzdGVkU2NvcGUgPSAoJHBzYWtlLmNvbnRleHQuY291bnQgLWd0IDEpCiAgICAgICAgaWYgKCAkaW5OZXN0ZWRTY29wZSApIHsKICAgICAgICAgICAgdGhyb3cgJF8KICAgICAgICB9IGVsc2UgewoJICAgICAgICBpZiAoISRwc2FrZS5ydW5fYnlfcHNha2VfYnVpbGRfdGVzdGVyKSB7CgkgICAgICAgICAgICBXcml0ZUNvbG9yZWRPdXRwdXQgJGVycm9yX21lc3NhZ2UgLWZvcmVncm91bmRjb2xvciBSZWQKCSAgICAgICAgfQogICAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgICAgQ2xlYW51cEVudmlyb25tZW50CiAgICB9Cn0KCiMtLSBQcml2YXRlIE1vZHVsZSBGdW5jdGlvbnMgLS0jCmZ1bmN0aW9uIFdyaXRlQ29sb3JlZE91dHB1dCB7CiAgICBwYXJhbSgKICAgICAgICBbc3RyaW5nXSAkbWVzc2FnZSwKICAgICAgICBbU3lzdGVtLkNvbnNvbGVDb2xvcl0gJGZvcmVncm91bmRjb2xvcgogICAgKQoKICAgICRjdXJyZW50Q29uZmlnID0gR2V0Q3VycmVudENvbmZpZ3VyYXRpb25PckRlZmF1bHQKICAgIGlmICgkY3VycmVudENvbmZpZy5jb2xvcmVkT3V0cHV0IC1lcSAkdHJ1ZSkgewogICAgICAgIGlmICgoJEhvc3QuVUkgLW5lICRudWxsKSAtYW5kICgkSG9zdC5VSS5SYXdVSSAtbmUgJG51bGwpIC1hbmQgKCRIb3N0LlVJLlJhd1VJLkZvcmVncm91bmRDb2xvciAtbmUgJG51bGwpKSB7CiAgICAgICAgICAgICRwcmV2aW91c0NvbG9yID0gJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yCiAgICAgICAgICAgICRIb3N0LlVJLlJhd1VJLkZvcmVncm91bmRDb2xvciA9ICRmb3JlZ3JvdW5kY29sb3IKICAgICAgICB9CiAgICB9CgogICAgJG1lc3NhZ2UKCiAgICBpZiAoJHByZXZpb3VzQ29sb3IgLW5lICRudWxsKSB7CiAgICAgICAgJEhvc3QuVUkuUmF3VUkuRm9yZWdyb3VuZENvbG9yID0gJHByZXZpb3VzQ29sb3IKICAgIH0KfQoKZnVuY3Rpb24gTG9hZE1vZHVsZXMgewogICAgJGN1cnJlbnRDb25maWcgPSAkcHNha2UuY29udGV4dC5wZWVrKCkuY29uZmlnCiAgICBpZiAoJGN1cnJlbnRDb25maWcubW9kdWxlcykgewoKICAgICAgICAkc2NvcGUgPSAkY3VycmVudENvbmZpZy5tb2R1bGVTY29wZQoKICAgICAgICAkZ2xvYmFsID0gW3N0cmluZ106OkVxdWFscygkc2NvcGUsICJnbG9iYWwiLCBbU3RyaW5nQ29tcGFyaXNvbl06OkN1cnJlbnRDdWx0dXJlSWdub3JlQ2FzZSkKCiAgICAgICAgJGN1cnJlbnRDb25maWcubW9kdWxlcyB8IGZvcmVhY2ggewogICAgICAgICAgICByZXNvbHZlLXBhdGggJF8gfCBmb3JlYWNoIHsKICAgICAgICAgICAgICAgICJMb2FkaW5nIG1vZHVsZTogJF8iCiAgICAgICAgICAgICAgICAkbW9kdWxlID0gaW1wb3J0LW1vZHVsZSAkXyAtcGFzc3RocnUgLURpc2FibGVOYW1lQ2hlY2tpbmcgLWdsb2JhbDokZ2xvYmFsCiAgICAgICAgICAgICAgICBpZiAoISRtb2R1bGUpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoJG1zZ3MuZXJyb3JfbG9hZGluZ19tb2R1bGUgLWYgJF8uTmFtZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAiIgogICAgfQp9CgpmdW5jdGlvbiBMb2FkQ29uZmlndXJhdGlvbiB7CiAgICBwYXJhbSgKICAgICAgICBbc3RyaW5nXSAkY29uZmlnZGlyID0gJFBTU2NyaXB0Um9vdAogICAgKQoKICAgICRwc2FrZUNvbmZpZ0ZpbGVQYXRoID0gKGpvaW4tcGF0aCAkY29uZmlnZGlyICJwc2FrZS1jb25maWcucHMxIikKCiAgICBpZiAodGVzdC1wYXRoICRwc2FrZUNvbmZpZ0ZpbGVQYXRoIC1wYXRoVHlwZSBMZWFmKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGNvbmZpZyA9IEdldEN1cnJlbnRDb25maWd1cmF0aW9uT3JEZWZhdWx0CiAgICAgICAgICAgIC4gJHBzYWtlQ29uZmlnRmlsZVBhdGgKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgdGhyb3cgIkVycm9yIExvYWRpbmcgQ29uZmlndXJhdGlvbiBmcm9tIHBzYWtlLWNvbmZpZy5wczE6ICIgKyAkXwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gR2V0Q3VycmVudENvbmZpZ3VyYXRpb25PckRlZmF1bHQoKSB7CiAgICBpZiAoJHBzYWtlLmNvbnRleHQuY291bnQgLWd0IDApIHsKICAgICAgICByZXR1cm4gJHBzYWtlLmNvbnRleHQucGVlaygpLmNvbmZpZwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJHBzYWtlLmNvbmZpZ19kZWZhdWx0CiAgICB9Cn0KCmZ1bmN0aW9uIENyZWF0ZUNvbmZpZ3VyYXRpb25Gb3JOZXdDb250ZXh0IHsKICAgIHBhcmFtKAogICAgICAgIFtzdHJpbmddICRidWlsZEZpbGUsCiAgICAgICAgW3N0cmluZ10gJGZyYW1ld29yawogICAgKQoKICAgICRwcmV2aW91c0NvbmZpZyA9IEdldEN1cnJlbnRDb25maWd1cmF0aW9uT3JEZWZhdWx0CgogICAgJGNvbmZpZyA9IG5ldy1vYmplY3QgcHNvYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgYnVpbGRGaWxlTmFtZSA9ICRwcmV2aW91c0NvbmZpZy5idWlsZEZpbGVOYW1lOwogICAgICAgIGZyYW1ld29yayA9ICRwcmV2aW91c0NvbmZpZy5mcmFtZXdvcms7CiAgICAgICAgdGFza05hbWVGb3JtYXQgPSAkcHJldmlvdXNDb25maWcudGFza05hbWVGb3JtYXQ7CiAgICAgICAgdmVyYm9zZUVycm9yID0gJHByZXZpb3VzQ29uZmlnLnZlcmJvc2VFcnJvcjsKICAgICAgICBjb2xvcmVkT3V0cHV0ID0gJHByZXZpb3VzQ29uZmlnLmNvbG9yZWRPdXRwdXQ7CiAgICAgICAgbW9kdWxlcyA9ICRwcmV2aW91c0NvbmZpZy5tb2R1bGVzOwogICAgICAgIG1vZHVsZVNjb3BlID0gICRwcmV2aW91c0NvbmZpZy5tb2R1bGVTY29wZTsKICAgIH0KCiAgICBpZiAoJGZyYW1ld29yaykgewogICAgICAgICRjb25maWcuZnJhbWV3b3JrID0gJGZyYW1ld29yazsKICAgIH0KCiAgICBpZiAoJGJ1aWxkRmlsZSkgewogICAgICAgICRjb25maWcuYnVpbGRGaWxlTmFtZSA9ICRidWlsZEZpbGU7CiAgICB9CgogICAgcmV0dXJuICRjb25maWcKfQoKZnVuY3Rpb24gQ29uZmlndXJlQnVpbGRFbnZpcm9ubWVudCB7CiAgICAkZnJhbWV3b3JrID0gJHBzYWtlLmNvbnRleHQucGVlaygpLmNvbmZpZy5mcmFtZXdvcmsKICAgIGlmICgkZnJhbWV3b3JrIC1jbWF0Y2ggJ14oKD86XGQrXC5cZCspKD86XC5cZCspezAsMX0pKHg4Nnx4NjQpezAsMX0kJykgewogICAgICAgICR2ZXJzaW9uUGFydCA9ICRtYXRjaGVzWzFdCiAgICAgICAgJGJpdG5lc3NQYXJ0ID0gJG1hdGNoZXNbMl0KICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX2ludmFsaWRfZnJhbWV3b3JrIC1mICRmcmFtZXdvcmspCiAgICB9CiAgICAkdmVyc2lvbnMgPSAkbnVsbAogICAgc3dpdGNoICgkdmVyc2lvblBhcnQpIHsKICAgICAgICAnMS4wJyB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3YxLjAuMzcwNScpCiAgICAgICAgfQogICAgICAgICcxLjEnIHsKICAgICAgICAgICAgJHZlcnNpb25zID0gQCgndjEuMS40MzIyJykKICAgICAgICB9CiAgICAgICAgJzIuMCcgewogICAgICAgICAgICAkdmVyc2lvbnMgPSBAKCd2Mi4wLjUwNzI3JykKICAgICAgICB9CiAgICAgICAgJzMuMCcgewogICAgICAgICAgICAkdmVyc2lvbnMgPSBAKCd2Mi4wLjUwNzI3JykKICAgICAgICB9CiAgICAgICAgJzMuNScgewogICAgICAgICAgICAkdmVyc2lvbnMgPSBAKCd2My41JywgJ3YyLjAuNTA3MjcnKQogICAgICAgIH0KICAgICAgICAnNC4wJyB7CiAgICAgICAgICAgICR2ZXJzaW9ucyA9IEAoJ3Y0LjAuMzAzMTknKQogICAgICAgIH0KICAgICAgICAnNC41LjEnIHsKICAgICAgICAgICAgJHZlcnNpb25zID0gQCgndjQuMC4zMDMxOScpCiAgICAgICAgICAgICRidWlsZFRvb2xzVmVyc2lvbnMgPSBAKCcxMi4wJykKICAgICAgICB9CiAgICAgICAgZGVmYXVsdCB7CiAgICAgICAgICAgIHRocm93ICgkbXNncy5lcnJvcl91bmtub3duX2ZyYW1ld29yayAtZiAkdmVyc2lvblBhcnQsICRmcmFtZXdvcmspCiAgICAgICAgfQogICAgfQoKICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yaycKICAgIGlmICgkdmVyc2lvblBhcnQgLW5lICcxLjAnIC1hbmQgJHZlcnNpb25QYXJ0IC1uZSAnMS4xJykgewogICAgICAgIHN3aXRjaCAoJGJpdG5lc3NQYXJ0KSB7CiAgICAgICAgICAgICd4ODYnIHsKICAgICAgICAgICAgICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yaycKICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgzMicKICAgICAgICAgICAgfQogICAgICAgICAgICAneDY0JyB7CiAgICAgICAgICAgICAgICAkYml0bmVzcyA9ICdGcmFtZXdvcms2NCcKICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgeyBbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkXykgfSB7CiAgICAgICAgICAgICAgICAkcHRyU2l6ZSA9IFtTeXN0ZW0uSW50UHRyXTo6U2l6ZQogICAgICAgICAgICAgICAgc3dpdGNoICgkcHRyU2l6ZSkgewogICAgICAgICAgICAgICAgICAgIDQgewogICAgICAgICAgICAgICAgICAgICAgICAkYml0bmVzcyA9ICdGcmFtZXdvcmsnCiAgICAgICAgICAgICAgICAgICAgICAgICRidWlsZFRvb2xzS2V5ID0gJ01TQnVpbGRUb29sc1BhdGgzMicKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgOCB7CiAgICAgICAgICAgICAgICAgICAgICAgICRiaXRuZXNzID0gJ0ZyYW1ld29yazY0JwogICAgICAgICAgICAgICAgICAgICAgICAkYnVpbGRUb29sc0tleSA9ICdNU0J1aWxkVG9vbHNQYXRoJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX3Vua25vd25fcG9pbnRlcnNpemUgLWYgJHB0clNpemUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlZmF1bHQgewogICAgICAgICAgICAgICAgdGhyb3cgKCRtc2dzLmVycm9yX3Vua25vd25fYml0bmVzc3BhcnQgLWYgJGJpdG5lc3NQYXJ0LCAkZnJhbWV3b3JrKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgIyRmcmFtZXdvcmtEaXJzID0gQCgkYnVpbGRUb29sc1ZlcnNpb25zIHwgZm9yZWFjaCB7IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcTVNCdWlsZFxUb29sc1ZlcnNpb25zXCRfIiAtTmFtZSAkYnVpbGRUb29sc0tleSkuJGJ1aWxkVG9vbHNLZXkgfSkKICAgICMkZnJhbWV3b3JrRGlycyA9ICRmcmFtZXdvcmtEaXJzICsgQCgkdmVyc2lvbnMgfCBmb3JlYWNoIHsgIiRlbnY6d2luZGlyXE1pY3Jvc29mdC5ORVRcJGJpdG5lc3NcJF9cIiB9KQogICAgJGZyYW1ld29ya0RpcnMgPSAkdmVyc2lvbnMgfCBmb3JlYWNoIHsgIiRlbnY6d2luZGlyXE1pY3Jvc29mdC5ORVRcJGJpdG5lc3NcJF9cIiB9CgogICAgJGZyYW1ld29ya0RpcnMgfCBmb3JlYWNoIHsgQXNzZXJ0ICh0ZXN0LXBhdGggJF8gLXBhdGhUeXBlIENvbnRhaW5lcikgKCRtc2dzLmVycm9yX25vX2ZyYW1ld29ya19pbnN0YWxsX2Rpcl9mb3VuZCAtZiAkXyl9CgogICAgJGVudjpwYXRoID0gKCRmcmFtZXdvcmtEaXJzIC1qb2luICI7IikgKyAiOyRlbnY6cGF0aCIKICAgICMgaWYgYW55IGVycm9yIG9jY3VycyBpbiBhIFBTIGZ1bmN0aW9uIHRoZW4gInN0b3AiIHByb2Nlc3NpbmcgaW1tZWRpYXRlbHkKICAgICMgdGhpcyBkb2VzIG5vdCBlZmZlY3QgYW55IGV4dGVybmFsIHByb2dyYW1zIHRoYXQgcmV0dXJuIGEgbm9uLXplcm8gZXhpdCBjb2RlCiAgICAkZ2xvYmFsOkVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIgp9CgpmdW5jdGlvbiBDbGVhbnVwRW52aXJvbm1lbnQgewogICAgaWYgKCRwc2FrZS5jb250ZXh0LkNvdW50IC1ndCAwKSB7CiAgICAgICAgJGN1cnJlbnRDb250ZXh0ID0gJHBzYWtlLmNvbnRleHQuUGVlaygpCiAgICAgICAgJGVudjpwYXRoID0gJGN1cnJlbnRDb250ZXh0Lm9yaWdpbmFsRW52UGF0aAogICAgICAgIFNldC1Mb2NhdGlvbiAkY3VycmVudENvbnRleHQub3JpZ2luYWxEaXJlY3RvcnkKICAgICAgICAkZ2xvYmFsOkVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICRjdXJyZW50Q29udGV4dC5vcmlnaW5hbEVycm9yQWN0aW9uUHJlZmVyZW5jZQogICAgICAgIFt2b2lkXSAkcHNha2UuY29udGV4dC5Qb3AoKQogICAgfQp9CgpmdW5jdGlvbiBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdAp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihWYWx1ZUZyb21QaXBlbGluZT0kdHJ1ZSldCiAgICAgICAgW1BTT2JqZWN0XQogICAgICAgICRJbnB1dE9iamVjdCwKICAgICAgICBbc3RyaW5nXQogICAgICAgICROYW1lLAogICAgICAgICRWYWx1ZQogICAgKQoKICAgIHByb2Nlc3MgewogICAgICAgIGlmICgkXyAtZXEgJG51bGwpIHsgJFZhbHVlIH0KICAgICAgICBlbHNlaWYgKCRfIHwgR2V0LU1lbWJlciAtTmFtZSAkTmFtZSkgewogICAgICAgICAgJF8uJE5hbWUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgoJF8gLWlzIFtIYXNodGFibGVdKSAtYW5kICgkXy5LZXlzIC1jb250YWlucyAkTmFtZSkpIHsKICAgICAgICAgICRfLiROYW1lCiAgICAgICAgfQogICAgICAgIGVsc2UgeyAkVmFsdWUgfQogICAgfQp9CgojIGJvcnJvd2VkIGZyb20gSmVmZnJleSBTbm92ZXIgaHR0cDovL2Jsb2dzLm1zZG4uY29tL3Bvd2Vyc2hlbGwvYXJjaGl2ZS8yMDA2LzEyLzA3L3Jlc29sdmUtZXJyb3IuYXNweAojIG1vZGlmaWVkIHRvIGJldHRlciBoYW5kbGUgU1FMIGVycm9ycwpmdW5jdGlvbiBSZXNvbHZlRXJyb3IKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmU9JHRydWUpXQogICAgICAgICRFcnJvclJlY29yZD0kRXJyb3JbMF0sCiAgICAgICAgW1N3aXRjaF0KICAgICAgICAkU2hvcnQKICAgICkKCiAgICBwcm9jZXNzIHsKICAgICAgICBpZiAoJF8gLWVxICRudWxsKSB7ICRfID0gJEVycm9yUmVjb3JkIH0KICAgICAgICAkZXggPSAkXy5FeGNlcHRpb24KCiAgICAgICAgaWYgKC1ub3QgJFNob3J0KSB7CiAgICAgICAgICAgICRlcnJvcl9tZXNzYWdlID0gImBuRXJyb3JSZWNvcmQ6ezB9RXJyb3JSZWNvcmQuSW52b2NhdGlvbkluZm86ezF9RXhjZXB0aW9uOmBuezJ9IgogICAgICAgICAgICAkZm9ybWF0dGVkX2Vycm9yUmVjb3JkID0gJF8gfCBmb3JtYXQtbGlzdCAqIC1mb3JjZSB8IG91dC1zdHJpbmcKICAgICAgICAgICAgJGZvcm1hdHRlZF9pbnZvY2F0aW9uSW5mbyA9ICRfLkludm9jYXRpb25JbmZvIHwgZm9ybWF0LWxpc3QgKiAtZm9yY2UgfCBvdXQtc3RyaW5nCiAgICAgICAgICAgICRmb3JtYXR0ZWRfZXhjZXB0aW9uID0gJycKCiAgICAgICAgICAgICRpID0gMAogICAgICAgICAgICB3aGlsZSAoJGV4IC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgJGkrKwogICAgICAgICAgICAgICAgJGZvcm1hdHRlZF9leGNlcHRpb24gKz0gKCIkaSIgKiA3MCkgKyAiYG4iICsKICAgICAgICAgICAgICAgICAgICAoJGV4IHwgZm9ybWF0LWxpc3QgKiAtZm9yY2UgfCBvdXQtc3RyaW5nKSArICJgbiIKICAgICAgICAgICAgICAgICRleCA9ICRleCB8IFNlbGVjdE9iamVjdFdpdGhEZWZhdWx0IC1OYW1lICdJbm5lckV4Y2VwdGlvbicgLVZhbHVlICRudWxsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiAkZXJyb3JfbWVzc2FnZSAtZiAkZm9ybWF0dGVkX2Vycm9yUmVjb3JkLCAkZm9ybWF0dGVkX2ludm9jYXRpb25JbmZvLCAkZm9ybWF0dGVkX2V4Y2VwdGlvbgogICAgICAgIH0KCiAgICAgICAgJGxhc3RFeGNlcHRpb24gPSBAKCkKICAgICAgICB3aGlsZSAoJGV4IC1uZSAkbnVsbCkgewogICAgICAgICAgICAkbGFzdE1lc3NhZ2UgPSAkZXggfCBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdCAtTmFtZSAnTWVzc2FnZScgLVZhbHVlICcnCiAgICAgICAgICAgICRsYXN0RXhjZXB0aW9uICs9ICgkbGFzdE1lc3NhZ2UgLXJlcGxhY2UgImBuIiwgJycpCiAgICAgICAgICAgIGlmICgkZXggLWlzIFtEYXRhLlNxbENsaWVudC5TcWxFeGNlcHRpb25dKSB7CiAgICAgICAgICAgICAgICAkbGFzdEV4Y2VwdGlvbiArPSAiKExpbmUgWyQoJGV4LkxpbmVOdW1iZXIpXSAiICsKICAgICAgICAgICAgICAgICAgICAiUHJvY2VkdXJlIFskKCRleC5Qcm9jZWR1cmUpXSBDbGFzcyBbJCgkZXguQ2xhc3MpXSAiICsKICAgICAgICAgICAgICAgICAgICAiIE51bWJlciBbJCgkZXguTnVtYmVyKV0gU3RhdGUgWyQoJGV4LlN0YXRlKV0gKSIKICAgICAgICAgICAgfQogICAgICAgICAgICAkZXggPSAkZXggfCBTZWxlY3RPYmplY3RXaXRoRGVmYXVsdCAtTmFtZSAnSW5uZXJFeGNlcHRpb24nIC1WYWx1ZSAkbnVsbAogICAgICAgIH0KICAgICAgICAkc2hvcnRFeGNlcHRpb24gPSAkbGFzdEV4Y2VwdGlvbiAtam9pbiAnIC0tPiAnCgogICAgICAgICRoZWFkZXIgPSAkbnVsbAogICAgICAgICRjdXJyZW50ID0gJF8KICAgICAgICAkaGVhZGVyID0gKCgkXy5JbnZvY2F0aW9uSW5mbyB8CiAgICAgICAgICAgIFNlbGVjdE9iamVjdFdpdGhEZWZhdWx0IC1OYW1lICdQb3NpdGlvbk1lc3NhZ2UnIC1WYWx1ZSAnJykgLXJlcGxhY2UgImBuIiwgJyAnKSwKICAgICAgICAgICAgKCRfIHwgU2VsZWN0T2JqZWN0V2l0aERlZmF1bHQgLU5hbWUgJ01lc3NhZ2UnIC1WYWx1ZSAnJyksCiAgICAgICAgICAgICgkXyB8IFNlbGVjdE9iamVjdFdpdGhEZWZhdWx0IC1OYW1lICdFeGNlcHRpb24nIC1WYWx1ZSAnJykgfAogICAgICAgICAgICAgICAgPyB7IC1ub3QgW1N0cmluZ106OklzTnVsbE9yRW1wdHkoJF8pIH0gfAogICAgICAgICAgICAgICAgU2VsZWN0IC1GaXJzdCAxCgogICAgICAgICRkZWxpbWl0ZXIgPSAnJwogICAgICAgIGlmICgoLW5vdCBbU3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkaGVhZGVyKSkgLWFuZAogICAgICAgICAgICAoLW5vdCBbU3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkc2hvcnRFeGNlcHRpb24pKSkKICAgICAgICAgICAgeyAkZGVsaW1pdGVyID0gJyBbPDw9PT4+XSAnIH0KCiAgICAgICAgcmV0dXJuICIkKCRoZWFkZXIpJCgkZGVsaW1pdGVyKUV4Y2VwdGlvbjogJCgkc2hvcnRFeGNlcHRpb24pIgogICAgfQp9CgpmdW5jdGlvbiBXcml0ZURvY3VtZW50YXRpb24gewogICAgJGN1cnJlbnRDb250ZXh0ID0gJHBzYWtlLmNvbnRleHQuUGVlaygpCgogICAgaWYgKCRjdXJyZW50Q29udGV4dC50YXNrcy5kZWZhdWx0KSB7CiAgICAgICAgJGRlZmF1bHRUYXNrRGVwZW5kZW5jaWVzID0gJGN1cnJlbnRDb250ZXh0LnRhc2tzLmRlZmF1bHQuRGVwZW5kc09uCiAgICB9IGVsc2UgewogICAgICAgICRkZWZhdWx0VGFza0RlcGVuZGVuY2llcyA9IEAoKQogICAgfQoKICAgICRjdXJyZW50Q29udGV4dC50YXNrcy5LZXlzIHwgZm9yZWFjaC1vYmplY3QgewogICAgICAgIGlmICgkXyAtZXEgImRlZmF1bHQiKSB7CiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgJHRhc2sgPSAkY3VycmVudENvbnRleHQudGFza3MuJF8KICAgICAgICBuZXctb2JqZWN0IFBTT2JqZWN0IC1wcm9wZXJ0eSBAewogICAgICAgICAgICBOYW1lID0gJHRhc2suTmFtZTsKICAgICAgICAgICAgQWxpYXMgPSAkdGFzay5BbGlhczsKICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAkdGFzay5EZXNjcmlwdGlvbjsKICAgICAgICAgICAgIkRlcGVuZHMgT24iID0gJHRhc2suRGVwZW5kc09uIC1qb2luICIsICIKICAgICAgICAgICAgRGVmYXVsdCA9IGlmICgkZGVmYXVsdFRhc2tEZXBlbmRlbmNpZXMgLWNvbnRhaW5zICR0YXNrLk5hbWUpIHsgJHRydWUgfQogICAgICAgIH0KICAgIH0gfCBzb3J0ICdOYW1lJyB8IGZvcm1hdC1saXN0IC1wcm9wZXJ0eSBOYW1lLEFsaWFzLERlc2NyaXB0aW9uLCJEZXBlbmRzIE9uIixEZWZhdWx0Cn0KCmZ1bmN0aW9uIFdyaXRlVGFza1RpbWVTdW1tYXJ5KCRpbnZva2VQc2FrZUR1cmF0aW9uKSB7CiAgICAiLSIgKiA3MAogICAgIkJ1aWxkIFRpbWUgUmVwb3J0IgogICAgIi0iICogNzAKICAgICRsaXN0ID0gQCgpCiAgICAkY3VycmVudENvbnRleHQgPSAkcHNha2UuY29udGV4dC5QZWVrKCkKICAgIHdoaWxlICgkY3VycmVudENvbnRleHQuZXhlY3V0ZWRUYXNrcy5Db3VudCAtZ3QgMCkgewogICAgICAgICR0YXNrS2V5ID0gJGN1cnJlbnRDb250ZXh0LmV4ZWN1dGVkVGFza3MuUG9wKCkKICAgICAgICAkdGFzayA9ICRjdXJyZW50Q29udGV4dC50YXNrcy4kdGFza0tleQogICAgICAgIGlmICgkdGFza0tleSAtZXEgImRlZmF1bHQiKSB7CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQogICAgICAgICRsaXN0ICs9IG5ldy1vYmplY3QgUFNPYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgICAgIE5hbWUgPSAkdGFzay5OYW1lOwogICAgICAgICAgICBEdXJhdGlvbiA9ICR0YXNrLkR1cmF0aW9uCiAgICAgICAgfQogICAgfQogICAgW0FycmF5XTo6UmV2ZXJzZSgkbGlzdCkKICAgICRsaXN0ICs9IG5ldy1vYmplY3QgUFNPYmplY3QgLXByb3BlcnR5IEB7CiAgICAgICAgTmFtZSA9ICJUb3RhbDoiOwogICAgICAgIER1cmF0aW9uID0gJGludm9rZVBzYWtlRHVyYXRpb24KICAgIH0KICAgICMgdXNpbmcgIm91dC1zdHJpbmcgfCB3aGVyZS1vYmplY3QiIHRvIGZpbHRlciBvdXQgdGhlIGJsYW5rIGxpbmUgdGhhdCBmb3JtYXQtdGFibGUgcHJlcGVuZHMKICAgICRsaXN0IHwgZm9ybWF0LXRhYmxlIC1hdXRvU2l6ZSAtcHJvcGVydHkgTmFtZSxEdXJhdGlvbiB8IG91dC1zdHJpbmcgLXN0cmVhbSB8IHdoZXJlLW9iamVjdCB7ICRfIH0KfQoKREFUQSBtc2dzIHsKY29udmVydGZyb20tc3RyaW5nZGF0YSBAJwogICAgZXJyb3JfaW52YWxpZF90YXNrX25hbWUgPSBUYXNrIG5hbWUgc2hvdWxkIG5vdCBiZSBudWxsIG9yIGVtcHR5IHN0cmluZy4KICAgIGVycm9yX3Rhc2tfbmFtZV9kb2VzX25vdF9leGlzdCA9IFRhc2sgezB9IGRvZXMgbm90IGV4aXN0LgogICAgZXJyb3JfY2lyY3VsYXJfcmVmZXJlbmNlID0gQ2lyY3VsYXIgcmVmZXJlbmNlIGZvdW5kIGZvciB0YXNrIHswfS4KICAgIGVycm9yX21pc3NpbmdfYWN0aW9uX3BhcmFtZXRlciA9IEFjdGlvbiBwYXJhbWV0ZXIgbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiB1c2luZyBQcmVBY3Rpb24gb3IgUG9zdEFjdGlvbiBwYXJhbWV0ZXJzIGZvciB0YXNrIHswfS4KICAgIGVycm9yX2NvcnJ1cHRfY2FsbHN0YWNrID0gQ2FsbCBzdGFjayB3YXMgY29ycnVwdC4gRXhwZWN0ZWQgezB9LCBidXQgZ290IHsxfS4KICAgIGVycm9yX2ludmFsaWRfZnJhbWV3b3JrID0gSW52YWxpZCAuTkVUIEZyYW1ld29yayB2ZXJzaW9uLCB7MH0gc3BlY2lmaWVkLgogICAgZXJyb3JfdW5rbm93bl9mcmFtZXdvcmsgPSBVbmtub3duIC5ORVQgRnJhbWV3b3JrIHZlcnNpb24sIHswfSBzcGVjaWZpZWQgaW4gezF9LgogICAgZXJyb3JfdW5rbm93bl9wb2ludGVyc2l6ZSA9IFVua25vd24gcG9pbnRlciBzaXplICh7MH0pIHJldHVybmVkIGZyb20gU3lzdGVtLkludFB0ci4KICAgIGVycm9yX3Vua25vd25fYml0bmVzc3BhcnQgPSBVbmtub3duIC5ORVQgRnJhbWV3b3JrIGJpdG5lc3MsIHswfSwgc3BlY2lmaWVkIGluIHsxfS4KICAgIGVycm9yX25vX2ZyYW1ld29ya19pbnN0YWxsX2Rpcl9mb3VuZCA9IE5vIC5ORVQgRnJhbWV3b3JrIGluc3RhbGxhdGlvbiBkaXJlY3RvcnkgZm91bmQgYXQgezB9LgogICAgZXJyb3JfYmFkX2NvbW1hbmQgPSBFcnJvciBleGVjdXRpbmcgY29tbWFuZCB7MH0uCiAgICBlcnJvcl9kZWZhdWx0X3Rhc2tfY2Fubm90X2hhdmVfYWN0aW9uID0gJ2RlZmF1bHQnIHRhc2sgY2Fubm90IHNwZWNpZnkgYW4gYWN0aW9uLgogICAgZXJyb3JfZHVwbGljYXRlX3Rhc2tfbmFtZSA9IFRhc2sgezB9IGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZC4KICAgIGVycm9yX2R1cGxpY2F0ZV9hbGlhc19uYW1lID0gQWxpYXMgezB9IGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZC4KICAgIGVycm9yX2ludmFsaWRfaW5jbHVkZV9wYXRoID0gVW5hYmxlIHRvIGluY2x1ZGUgezB9LiBGaWxlIG5vdCBmb3VuZC4KICAgIGVycm9yX2J1aWxkX2ZpbGVfbm90X2ZvdW5kID0gQ291bGQgbm90IGZpbmQgdGhlIGJ1aWxkIGZpbGUgezB9LgogICAgZXJyb3Jfbm9fZGVmYXVsdF90YXNrID0gJ2RlZmF1bHQnIHRhc2sgcmVxdWlyZWQuCiAgICBlcnJvcl9sb2FkaW5nX21vZHVsZSA9IEVycm9yIGxvYWRpbmcgbW9kdWxlIHswfS4KICAgIHdhcm5pbmdfZGVwcmVjYXRlZF9mcmFtZXdvcmtfdmFyaWFibGUgPSBXYXJuaW5nOiBVc2luZyBnbG9iYWwgdmFyaWFibGUgJGZyYW1ld29yayB0byBzZXQgLk5FVCBmcmFtZXdvcmsgdmVyc2lvbiB1c2VkIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQgdXNlIEZyYW1ld29yayBmdW5jdGlvbiBvciBjb25maWd1cmF0aW9uIGZpbGUgcHNha2UtY29uZmlnLnBzMS4KICAgIHJlcXVpcmVkX3ZhcmlhYmxlX25vdF9zZXQgPSBWYXJpYWJsZSB7MH0gbXVzdCBiZSBzZXQgdG8gcnVuIHRhc2sgezF9LgogICAgcG9zdGNvbmRpdGlvbl9mYWlsZWQgPSBQb3N0Y29uZGl0aW9uIGZhaWxlZCBmb3IgdGFzayB7MH0uCiAgICBwcmVjb25kaXRpb25fd2FzX2ZhbHNlID0gUHJlY29uZGl0aW9uIHdhcyBmYWxzZSwgbm90IGV4ZWN1dGluZyB0YXNrIHswfS4KICAgIGNvbnRpbnVlX29uX2Vycm9yID0gRXJyb3IgaW4gdGFzayB7MH0uIHsxfQogICAgYnVpbGRfc3VjY2VzcyA9IEJ1aWxkIFN1Y2NlZWRlZCEKJ0AKfQoKaW1wb3J0LWxvY2FsaXplZGRhdGEgLWJpbmRpbmd2YXJpYWJsZSBtc2dzIC1lcnJvcmFjdGlvbiBzaWxlbnRseWNvbnRpbnVlCgokc2NyaXB0OnBzYWtlID0gQHt9CiRwc2FrZS52ZXJzaW9uID0gIjQuMi4wIiAjIGNvbnRhaW5zIHRoZSBjdXJyZW50IHZlcnNpb24gb2YgcHNha2UKJHBzYWtlLmNvbnRleHQgPSBuZXctb2JqZWN0IHN5c3RlbS5jb2xsZWN0aW9ucy5zdGFjayAjIGhvbGRzIG9udG8gdGhlIGN1cnJlbnQgc3RhdGUgb2YgYWxsIHZhcmlhYmxlcwokcHNha2UucnVuX2J5X3BzYWtlX2J1aWxkX3Rlc3RlciA9ICRmYWxzZSAjIGluZGljYXRlcyB0aGF0IGJ1aWxkIGlzIGJlaW5nIHJ1biBieSBwc2FrZS1CdWlsZFRlc3RlcgokcHNha2UuY29uZmlnX2RlZmF1bHQgPSBuZXctb2JqZWN0IHBzb2JqZWN0IC1wcm9wZXJ0eSBAewogICAgYnVpbGRGaWxlTmFtZSA9ICJkZWZhdWx0LnBzMSI7CiAgICBmcmFtZXdvcmsgPSAiNC4wIjsKICAgIHRhc2tOYW1lRm9ybWF0ID0gIkV4ZWN1dGluZyB7MH0iOwogICAgdmVyYm9zZUVycm9yID0gJGZhbHNlOwogICAgY29sb3JlZE91dHB1dCA9ICR0cnVlOwogICAgbW9kdWxlcyA9ICRudWxsOwogICAgbW9kdWxlU2NvcGUgPSAiIjsKfSAjIGNvbnRhaW5zIGRlZmF1bHQgY29uZmlndXJhdGlvbiwgY2FuIGJlIG92ZXJyaWRlbiBpbiBwc2FrZS1jb25maWcucHMxIGluIGRpcmVjdG9yeSB3aXRoIHBzYWtlLnBzbTEgb3IgaW4gZGlyZWN0b3J5IHdpdGggY3VycmVudCBidWlsZCBzY3JpcHQKCiRwc2FrZS5idWlsZF9zdWNjZXNzID0gJGZhbHNlICMgaW5kaWNhdGVzIHRoYXQgdGhlIGN1cnJlbnQgYnVpbGQgd2FzIHN1Y2Nlc3NmdWwKJHBzYWtlLmJ1aWxkX3NjcmlwdF9maWxlID0gJG51bGwgIyBjb250YWlucyBhIFN5c3RlbS5JTy5GaWxlSW5mbyBmb3IgdGhlIGN1cnJlbnQgYnVpbGQgc2NyaXB0CiRwc2FrZS5idWlsZF9zY3JpcHRfZGlyID0gIiIgIyBjb250YWlucyBhIHN0cmluZyB3aXRoIGZ1bGx5LXF1YWxpZmllZCBwYXRoIHRvIGN1cnJlbnQgYnVpbGQgc2NyaXB0CgpMb2FkQ29uZmlndXJhdGlvbgoKZXhwb3J0LW1vZHVsZW1lbWJlciAtZnVuY3Rpb24gSW52b2tlLXBzYWtlLCBJbnZva2UtVGFzaywgVGFzaywgUHJvcGVydGllcywgSW5jbHVkZSwgRm9ybWF0VGFza05hbWUsIFRhc2tTZXR1cCwgVGFza1RlYXJEb3duLCBGcmFtZXdvcmssIEFzc2VydCwgRXhlYyAtdmFyaWFibGUgcHNha2U=
