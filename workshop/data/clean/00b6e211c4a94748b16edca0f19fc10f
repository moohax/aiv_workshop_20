MicrosoftAzure_xSqlAvailabilityGroupListener.psm1,11b064cb74b5e92fb8f91683f8bccfd0,Scan result is 1. IsMalware: 0,w6/Cu8K/IwojIHhTcWxBdmFpbGFiaWxpdHlHcm91cExpc3RlbmVyOiBEU0MgcmVzb3VyY2UgdGhhdCBjb25maWd1cmVzIGEgU1FMIEFsd2F5c09uIEF2YWlsYWJpbGl0eSBHcm91cCBMaXN0ZW5lci4KIwoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10gJE5hbWUsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddICRBdmFpbGFiaWxpdHlHcm91cE5hbWUsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddICREb21haW5OYW1lRnFkbiwKCiAgICAgICAgW1N0cmluZ10gJExpc3RlbmVySVBBZGRyZXNzLAoKICAgICAgICBbVUludDMyXSAkTGlzdGVuZXJQb3J0TnVtYmVyID0gMTQzMywKCiAgICAgICAgW1VJbnQzMl0gJFByb2JlUG9ydE51bWJlciA9IDU5OTk5LAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXSAkSW5zdGFuY2VOYW1lLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbUFNDcmVkZW50aWFsXSAkRG9tYWluQ3JlZGVudGlhbCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsCiAgICApCgogICAgJGJDb25maWd1cmVkID0gVGVzdC1UYXJnZXRSZXNvdXJjZSAtTmFtZSAkTmFtZSAtQXZhaWxhYmlsaXR5R3JvdXBOYW1lICRBdmFpbGFiaWxpdHlHcm91cE5hbWUgLURvbWFpbk5hbWVGcWRuICREb21haW5OYW1lRnFkbiAtTGlzdGVuZXJQb3J0TnVtYmVyICRMaXN0ZW5lclBvcnROdW1iZXIgLVByb2JlUG9ydE51bWJlciAkUHJvYmVQb3J0TnVtYmVyIC1JbnN0YW5jZU5hbWUgICRJbnN0YW5jZU5hbWUgLURvbWFpbkNyZWRlbnRpYWwgJERvbWFpbkNyZWRlbnRpYWwgLVNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsICRTcWxBZG1pbmlzdHJhdG9yQ3JlZGVudGlhbAoKICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgTmFtZSA9ICROYW1lCiAgICAgICAgQXZhaWxhYmlsaXR5R3JvdXBOYW1lID0gJEF2YWlsYWJpbGl0eUdyb3VwTmFtZQogICAgICAgIERvbWFpbk5hbWVGcWRuID0gJERvbWFpbk5hbWVGcWRuCiAgICAgICAgTGlzdGVuZXJQb3J0TnVtYmVyID0gJExpc3RlbmVyUG9ydE51bWJlcgogICAgICAgIFByb2JlUG9ydE51bWJlciA9ICRQcm9iZVBvcnROdW1iZXIKICAgICAgICBJbnN0YW5jZU5hbWUgPSAkSW5zdGFuY2VOYW1lCiAgICAgICAgRG9tYWluQ3JlZGVudGlhbCA9ICREb21haW5DcmVkZW50aWFsLlVzZXJOYW1lCiAgICAgICAgU3FsQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwgPSAkU3FsQWRtaW5pc3RyYXRvckNyZWRlbnRpYWwuVXNlck5hbWUKICAgICAgICBDb25maWd1cmVkID0gJGJDb25maWd1cmVkCiAgICB9CgogICAgJHJldHVyblZhbHVlCn0KCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddICROYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXSAkQXZhaWxhYmlsaXR5R3JvdXBOYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXSAkRG9tYWluTmFtZUZxZG4sCgogICAgICAgIFtTdHJpbmddICRMaXN0ZW5lcklQQWRkcmVzcywKCiAgICAgICAgW1VJbnQzMl0gJExpc3RlbmVyUG9ydE51bWJlciA9IDE0MzMsCgogICAgICAgIFtVSW50MzJdICRQcm9iZVBvcnROdW1iZXIgPSA1OTk5OSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10gJEluc3RhbmNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJERvbWFpbkNyZWRlbnRpYWwsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtQU0NyZWRlbnRpYWxdICRTcWxBZG1pbmlzdHJhdG9yQ3JlZGVudGlhbAogICAgKQoKICAgICRpbnN0YW5jZSA9IEdldC1TcWxJbnN0YW5jZU5hbWUgLU5vZGUgICRlbnY6Q09NUFVURVJOQU1FIC1JbnN0YW5jZU5hbWUgJEluc3RhbmNlTmFtZQogICAgJHMgPSBHZXQtU3FsU2VydmVyIC1JbnN0YW5jZU5hbWUgJGluc3RhbmNlIC1DcmVkZW50aWFsICRTcWxBZG1pbmlzdHJhdG9yQ3JlZGVudGlhbAoKICAgICRTdG9wbG9vcCA9ICRmYWxzZQogICAgJFJldHJ5Y291bnQgPSAwCgogICAgaWYgKCRMaXN0ZW5lcklQQWRkcmVzcykgewoKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJUaGUgYXNzaWduZWQgTGlzdGVuZXIgcHVibGljIElQIGFkZHJlc3MgaXMgJyQoJExpc3RlbmVySVBBZGRyZXNzKSciCgogICAgICAgICRwdWJsaWNJcEFkZHJlc3MgPSAkTGlzdGVuZXJJUEFkZHJlc3MKICAgICAgICAKICAgIH0KICAgIGVsc2UgewoKICAgICAgICBkbyB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkcHVibGljSXBBZGRyZXNzID0gKFtTeXN0ZW0uTmV0LkROU106OkdldEhvc3RBZGRyZXNzZXMoJERvbWFpbk5hbWVGcWRuKSkuSVBBZGRyZXNzVG9TdHJpbmcKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkdvdCBMaXN0ZW5lciBwdWJsaWMgSVAgYWRkcmVzcyAuLickKCRwdWJsaWNJcEFkZHJlc3MpJyIKICAgICAgICAgICAgICAgICRTdG9wbG9vcCA9ICR0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgaWYgKCRSZXRyeWNvdW50IC1ndCAyMCl7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiQ291bGQgbm90IEdldCBIb3N0IEFkZHJlc3NlcyBhZnRlciAyMCByZXRyeXMuIgogICAgICAgICAgICAgICAgICAgICRTdG9wbG9vcCA9ICR0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJDb3VsZCBub3QgR2V0IEhvc3QgQWRkcmVzc2VzIHJldHJ5aW5nIGluIDYwIHNlY29uZHMuLi4iCiAgICAgICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKICAgICAgICAgICAgICAgICAgICAkUmV0cnljb3VudCA9ICRSZXRyeWNvdW50ICsgMQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFdoaWxlICgkU3RvcGxvb3AgLWVxICRmYWxzZSkKCiAgICB9CgogICAgdHJ5CiAgICB7CiAgICAgICAgKCRvbGRUb2tlbiwgJGNvbnRleHQsICRuZXdUb2tlbikgPSBJbXBlcnNvbmF0ZUFzIC1jcmVkICREb21haW5DcmVkZW50aWFsCgogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlN0b3BwaW5nIGNsdXN0ZXIgcmVzb3VyY2UgJyQoJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSknIC4uLiIKICAgICAgICBTdG9wLUNsdXN0ZXJSZXNvdXJjZSAtTmFtZSAkQXZhaWxhYmlsaXR5R3JvdXBOYW1lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwKCiAgICAgICAgaWYgKCEoR2V0LUNsdXN0ZXJSZXNvdXJjZSAkTmFtZSAtRXJyb3JBY3Rpb24gSWdub3JlKSkKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNyZWF0aW5nIE5ldHdvcmsgTmFtZSByZXNvdXJjZSAnJCgkTmFtZSknIC4uLiIKICAgICAgICAgICAgJHBhcmFtcz0gQHsKICAgICAgICAgICAgICAgIE5hbWUgPSAkTmFtZQogICAgICAgICAgICAgICAgRG5zTmFtZSA9ICROYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgICAgQWRkLUNsdXN0ZXJSZXNvdXJjZSAtTmFtZSAkTmFtZSAtUmVzb3VyY2VUeXBlICJOZXR3b3JrIE5hbWUiIC1Hcm91cCAkQXZhaWxhYmlsaXR5R3JvdXBOYW1lIC1FcnJvckFjdGlvbiBTdG9wIHwKICAgICAgICAgICAgICAgIFNldC1DbHVzdGVyUGFyYW1ldGVyIC1NdWx0aXBsZSAkcGFyYW1zIC1FcnJvckFjdGlvbiBTdG9wCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTZXR0aW5nIHJlc291cmNlIGRlcGVuZGVuY3kgYmV0d2VlbiAnJCgkQXZhaWxhYmlsaXR5R3JvdXBOYW1lKScgYW5kICckKCROYW1lKScgLi4uIgogICAgICAgICAgICBHZXQtQ2x1c3RlclJlc291cmNlIC1OYW1lICRBdmFpbGFiaWxpdHlHcm91cE5hbWUgfCBTZXQtQ2x1c3RlclJlc291cmNlRGVwZW5kZW5jeSAiWyROYW1lXSIgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICB9CgogICAgICAgIGlmICghKEdldC1DbHVzdGVyUmVzb3VyY2UgIklQIEFkZHJlc3MgJHB1YmxpY0lwQWRkcmVzcyIgLUVycm9yQWN0aW9uIElnbm9yZSkpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJDcmVhdGluZyBJUCBBZGRyZXNzIHJlc291cmNlIGZvciAnJCgkcHVibGljSXBBZGRyZXNzKScgLi4uIgogICAgICAgICAgICAkcGFyYW1zID0gQHsKICAgICAgICAgICAgICAgIEFkZHJlc3MgPSAkcHVibGljSXBBZGRyZXNzCiAgICAgICAgICAgICAgICBQcm9iZVBvcnQgPSAkUHJvYmVQb3J0TnVtYmVyCiAgICAgICAgICAgICAgICBTdWJuZXRNYXNrID0gIjI1NS4yNTUuMjU1LjI1NSIKICAgICAgICAgICAgICAgIE5ldHdvcmsgPSAoR2V0LUNsdXN0ZXJOZXR3b3JrKVswXS5OYW1lCiAgICAgICAgICAgICAgICBPdmVycmlkZUFkZHJlc3NNYXRjaCA9IDEKICAgICAgICAgICAgICAgIEVuYWJsZURoY3AgPSAwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIEFkZC1DbHVzdGVyUmVzb3VyY2UgLU5hbWUgIklQIEFkZHJlc3MgJHB1YmxpY0lwQWRkcmVzcyIgLVJlc291cmNlVHlwZSAiSVAgQWRkcmVzcyIgLUdyb3VwICRBdmFpbGFiaWxpdHlHcm91cE5hbWUgLUVycm9yQWN0aW9uIFN0b3AgfAogICAgICAgICAgICAgICAgU2V0LUNsdXN0ZXJQYXJhbWV0ZXIgLU11bHRpcGxlICRwYXJhbXMgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlNldHRpbmcgcmVzb3VyY2UgZGVwZW5kZW5jeSBiZXR3ZWVuICckKCROYW1lKScgYW5kICckKCRwdWJsaWNJcEFkZHJlc3MpJyAuLi4iCiAgICAgICAgICAgIEdldC1DbHVzdGVyUmVzb3VyY2UgLU5hbWUgJE5hbWUgfCBTZXQtQ2x1c3RlclJlc291cmNlRGVwZW5kZW5jeSAiW0lQIEFkZHJlc3MgJHB1YmxpY0lwQWRkcmVzc10iIC1FcnJvckFjdGlvbiBTdG9wCiAgICAgICAgfQoKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTdGFydGluZyBjbHVzdGVyIHJlc291cmNlICckKCROYW1lKScgLi4uIgogICAgICAgIFN0YXJ0LUNsdXN0ZXJSZXNvdXJjZSAtTmFtZSAkTmFtZSAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsCgogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlN0YXJ0aW5nIGNsdXN0ZXIgcmVzb3VyY2UgJyQoJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSknIC4uLiIKICAgICAgICBTdGFydC1DbHVzdGVyUmVzb3VyY2UgLU5hbWUgJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsCiAgICB9CiAgICBmaW5hbGx5CiAgICB7CiAgICAgICAgaWYgKCRjb250ZXh0KQogICAgICAgIHsKICAgICAgICAgICAgJGNvbnRleHQuVW5kbygpCiAgICAgICAgICAgICRjb250ZXh0LkRpc3Bvc2UoKQogICAgICAgICAgICBDbG9zZVVzZXJUb2tlbigkbmV3VG9rZW4pCiAgICAgICAgfQogICAgfQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlNldHRpbmcgdGhlIEF2YWlsYWJpbGl0eSBHcm91cCBMaXN0ZW5lciBwb3J0IHRvICckKCRMaXN0ZW5lclBvcnROdW1iZXIpJyAuLi4iCiAgICAkYWcgPSBHZXQtU3FsQXZhaWxhYmlsaXR5R3JvdXAgLU5hbWUgJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSAtU2VydmVyICRzCiAgICAkYWdMaXN0ZW5lciA9ICRhZy5BdmFpbGFiaWxpdHlHcm91cExpc3RlbmVycyB8IHdoZXJlIHsgJF8uTmFtZSAtZXEgJE5hbWUgfQogICAgJGFnTGlzdGVuZXIuUG9ydE51bWJlciA9ICRMaXN0ZW5lclBvcnROdW1iZXIKICAgICRhZ0xpc3RlbmVyLkFsdGVyKCkKfQoKZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQp7CiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTdHJpbmddICROYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXSAkQXZhaWxhYmlsaXR5R3JvdXBOYW1lLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3RyaW5nXSAkRG9tYWluTmFtZUZxZG4sCgogICAgICAgIFtTdHJpbmddICRMaXN0ZW5lcklQQWRkcmVzcywKCiAgICAgICAgW1VJbnQzMl0gJExpc3RlbmVyUG9ydE51bWJlciA9IDE0MzMsCgogICAgICAgIFtVSW50MzJdICRQcm9iZVBvcnROdW1iZXIgPSA1OTk5OSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N0cmluZ10gJEluc3RhbmNlTmFtZSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1BTQ3JlZGVudGlhbF0gJERvbWFpbkNyZWRlbnRpYWwsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtQU0NyZWRlbnRpYWxdICRTcWxBZG1pbmlzdHJhdG9yQ3JlZGVudGlhbAogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNoZWNraW5nIGlmIFNRTCBBRyAnJCgkQXZhaWxhYmlsaXR5R3JvdXBOYW1lKScgZXhpc3RzIG9uIGluc3RhbmNlICckKCRJbnN0YW5jZU5hbWUpJyAuLi4iCgogICAgJGluc3RhbmNlID0gR2V0LVNxbEluc3RhbmNlTmFtZSAtTm9kZSAgJGVudjpDT01QVVRFUk5BTUUgLUluc3RhbmNlTmFtZSAkSW5zdGFuY2VOYW1lCiAgICAkcyA9IEdldC1TcWxTZXJ2ZXIgLUluc3RhbmNlTmFtZSAkaW5zdGFuY2UgLUNyZWRlbnRpYWwgJFNxbEFkbWluaXN0cmF0b3JDcmVkZW50aWFsCgogICAgJGFnID0gR2V0LVNxbEF2YWlsYWJpbGl0eUdyb3VwIC1OYW1lICRBdmFpbGFiaWxpdHlHcm91cE5hbWUgLVNlcnZlciAkcwogICAgaWYgKCRhZykKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJTUUwgQUcgJyQoJEF2YWlsYWJpbGl0eUdyb3VwTmFtZSknIGZvdW5kLiIKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0aHJvdyAiU1FMIEdBICckKCRBdmFpbGFiaWxpdHlHcm91cE5hbWUpJyBOT1QgZm91bmQuIgogICAgfQoKICAgIHRyeQogICAgewogICAgICAgICgkb2xkVG9rZW4sICRjb250ZXh0LCAkbmV3VG9rZW4pID0gSW1wZXJzb25hdGVBcyAtY3JlZCAkRG9tYWluQ3JlZGVudGlhbAoKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJDaGVja2luZyBpZiBOZXR3b3JrIE5hbWUgcmVzb3VyY2UgJyQoJE5hbWUpJyBleGlzdHMgLi4uIgogICAgICAgIGlmIChHZXQtQ2x1c3RlclJlc291cmNlICROYW1lIC1FcnJvckFjdGlvbiBJZ25vcmUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJOZXR3b3JrIE5hbWUgcmVzb3VyY2UgJyQoJE5hbWUpJyBmb3VuZC4iCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIk5ldHdvcmsgTmFtZSByZXNvdXJjZSAnJCgkTmFtZSknIE5PVCBmb3VuZC4iCiAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICB9CgogICAgICAgICRwdWJsaWNJcEFkZHJlc3MgPSAoW1N5c3RlbS5OZXQuRE5TXTo6R2V0SG9zdEFkZHJlc3NlcygkRG9tYWluTmFtZUZxZG4pKS5JUEFkZHJlc3NUb1N0cmluZwogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkNoZWNraW5nIGlmIElQIEFkZHJlc3MgcmVzb3VyY2UgZm9yICckKCRwdWJsaWNJcEFkZHJlc3MpJyBleGlzdHMgLi4uIgogICAgICAgIGlmIChHZXQtQ2x1c3RlclJlc291cmNlICJJUCBBZGRyZXNzICRwdWJsaWNJcEFkZHJlc3MiIC1FcnJvckFjdGlvbiBJZ25vcmUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJJUCBBZGRyZXNzIHJlc291cmNlICdJUCBBZGRyZXNzICQoJHB1YmxpY0lwQWRkcmVzcyknIGZvdW5kLiIKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiSVAgQWRkcmVzcyByZXNvdXJjZSAnSVAgQWRkcmVzcyAkKCRwdWJsaWNJcEFkZHJlc3MpJyBOT1QgZm91bmQuIgogICAgICAgICAgICByZXR1cm4gJGZhbHNlCiAgICAgICAgfQogICAgfQogICAgZmluYWxseQogICAgewogICAgICAgIGlmICgkY29udGV4dCkKICAgICAgICB7CiAgICAgICAgICAgICRjb250ZXh0LlVuZG8oKQogICAgICAgICAgICAkY29udGV4dC5EaXNwb3NlKCkKICAgICAgICAgICAgQ2xvc2VVc2VyVG9rZW4oJG5ld1Rva2VuKQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJHRydWUKfQoKCmZ1bmN0aW9uIEdldC1TcWxTZXJ2ZXIoW3N0cmluZ10kSW5zdGFuY2VOYW1lLCBbUFNDcmVkZW50aWFsXSRDcmVkZW50aWFsKQp7CiAgICBbU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHldOjpMb2FkV2l0aFBhcnRpYWxOYW1lKCJNaWNyb3NvZnQuU3FsU2VydmVyLkNvbm5lY3Rpb25JbmZvIikgfCBPdXQtTnVsbAogICAgJHNjID0gTmV3LU9iamVjdCBNaWNyb3NvZnQuU3FsU2VydmVyLk1hbmFnZW1lbnQuQ29tbW9uLlNlcnZlckNvbm5lY3Rpb24KICAgICRzYy5TZXJ2ZXJJbnN0YW5jZSA9ICRJbnN0YW5jZU5hbWUKICAgICRzYy5Db25uZWN0QXNVc2VyID0gJHRydWUKICAgIGlmICgkQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLkRvbWFpbiAtYW5kICRDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuRG9tYWluIC1uZSAkZW52OkNPTVBVVEVSTkFNRSkKICAgIHsKICAgICAgICAkc2MuQ29ubmVjdEFzVXNlck5hbWUgPSAiJCgkQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlVzZXJOYW1lKUAkKCRDcmVkZW50aWFsLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuRG9tYWluKSIKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkc2MuQ29ubmVjdEFzVXNlck5hbWUgPSAkQ3JlZGVudGlhbC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlVzZXJOYW1lCiAgICB9CiAgICAkc2MuQ29ubmVjdEFzVXNlclBhc3N3b3JkID0gJENyZWRlbnRpYWwuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZAogICAgW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgiTWljcm9zb2Z0LlNxbFNlcnZlci5TbW8iKSB8IE91dC1OdWxsCiAgICAkcyA9IE5ldy1PYmplY3QgTWljcm9zb2Z0LlNxbFNlcnZlci5NYW5hZ2VtZW50LlNtby5TZXJ2ZXIgJHNjCgogICAgJHMKfQoKZnVuY3Rpb24gR2V0LVNxbEluc3RhbmNlTmFtZShbc3RyaW5nXSROb2RlLCBbc3RyaW5nXSRJbnN0YW5jZU5hbWUpCnsKICAgICRwdXJlSW5zdGFuY2VOYW1lID0gR2V0LVB1cmVTcWxJbnN0YW5jZU5hbWUgLUluc3RhbmNlTmFtZSAkSW5zdGFuY2VOYW1lCiAgICBpZiAoIk1TU1FMU0VSVkVSIiAtZXEgJHB1cmVJbnN0YW5jZU5hbWUpCiAgICB7CiAgICAgICAgJE5vZGUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkTm9kZSArICJcIiArICRwdXJlSW5zdGFuY2VOYW1lCiAgICB9Cn0KCmZ1bmN0aW9uIEdldC1QdXJlU3FsSW5zdGFuY2VOYW1lKFtzdHJpbmddJEluc3RhbmNlTmFtZSkKewogICAgJGxpc3QgPSAkSW5zdGFuY2VOYW1lLlNwbGl0KCJcIikKICAgIGlmICgkbGlzdC5Db3VudCAtZ3QgMSkKICAgIHsKICAgICAgICAkbGlzdFsxXQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICJNU1NRTFNFUlZFUiIKICAgIH0KfQoKZnVuY3Rpb24gR2V0LVNxbEF2YWlsYWJpbGl0eUdyb3VwKFtzdHJpbmddJE5hbWUsIFtNaWNyb3NvZnQuU3FsU2VydmVyLk1hbmFnZW1lbnQuU21vLlNlcnZlcl0kU2VydmVyKQp7CiAgICAkcy5BdmFpbGFiaWxpdHlHcm91cHMgfCB3aGVyZSB7ICRfLk5hbWUgLWVxICROYW1lIH0KfQoKCmZ1bmN0aW9uIEdldC1JbXBlcnNvbmF0ZUxpYgp7CiAgICBpZiAoJHNjcmlwdDpJbXBlcnNvbmF0ZUxpYikKICAgIHsKICAgICAgICByZXR1cm4gJHNjcmlwdDpJbXBlcnNvbmF0ZUxpYgogICAgfQoKICAgICRzaWcgPSBAJwpbRGxsSW1wb3J0KCJhZHZhcGkzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0KcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBMb2dvblVzZXIoc3RyaW5nIGxwc3pVc2VybmFtZSwgc3RyaW5nIGxwc3pEb21haW4sIHN0cmluZyBscHN6UGFzc3dvcmQsIGludCBkd0xvZ29uVHlwZSwgaW50IGR3TG9nb25Qcm92aWRlciwgcmVmIEludFB0ciBwaFRva2VuKTsKCltEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQpwdWJsaWMgc3RhdGljIGV4dGVybiBCb29sZWFuIENsb3NlSGFuZGxlKEludFB0ciBoT2JqZWN0KTsKJ0AKICAgJHNjcmlwdDpJbXBlcnNvbmF0ZUxpYiA9IEFkZC1UeXBlIC1QYXNzVGhydSAtTmFtZXNwYWNlICdMaWIuSW1wZXJzb25hdGlvbicgLU5hbWUgSW1wZXJzb25hdGlvbkxpYiAtTWVtYmVyRGVmaW5pdGlvbiAkc2lnCgogICByZXR1cm4gJHNjcmlwdDpJbXBlcnNvbmF0ZUxpYgp9CgpmdW5jdGlvbiBJbXBlcnNvbmF0ZUFzKFtQU0NyZWRlbnRpYWxdICRjcmVkKQp7CiAgICBbSW50UHRyXSAkdXNlclRva2VuID0gW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkuVG9rZW4KICAgICR1c2VyVG9rZW4KICAgICRJbXBlcnNvbmF0ZUxpYiA9IEdldC1JbXBlcnNvbmF0ZUxpYgoKICAgICRiTG9naW4gPSAkSW1wZXJzb25hdGVMaWI6OkxvZ29uVXNlcigkY3JlZC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLlVzZXJOYW1lLCAkY3JlZC5HZXROZXR3b3JrQ3JlZGVudGlhbCgpLkRvbWFpbiwgJGNyZWQuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZCwgCiAgICA5LCAwLCBbcmVmXSR1c2VyVG9rZW4pCgogICAgaWYgKCRiTG9naW4pCiAgICB7CiAgICAgICAgJElkZW50aXR5ID0gTmV3LU9iamVjdCBTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5ICR1c2VyVG9rZW4KICAgICAgICAkY29udGV4dCA9ICRJZGVudGl0eS5JbXBlcnNvbmF0ZSgpCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdGhyb3cgIkNhbid0IGxvZyBvbiBhcyB1c2VyICckKCRjcmVkLkdldE5ldHdvcmtDcmVkZW50aWFsKCkuVXNlck5hbWUpJy4iCiAgICB9CiAgICAkY29udGV4dCwgJHVzZXJUb2tlbgp9CgpmdW5jdGlvbiBDbG9zZVVzZXJUb2tlbihbSW50UHRyXSAkdG9rZW4pCnsKICAgICRJbXBlcnNvbmF0ZUxpYiA9IEdldC1JbXBlcnNvbmF0ZUxpYgoKICAgICRiTG9naW4gPSAkSW1wZXJzb25hdGVMaWI6OkNsb3NlSGFuZGxlKCR0b2tlbikKICAgIGlmICghJGJMb2dpbikKICAgIHsKICAgICAgICB0aHJvdyAiQ2FuJ3QgY2xvc2UgdG9rZW4uIgogICAgfQp9CgoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKi1UYXJnZXRSZXNvdXJjZQo=
