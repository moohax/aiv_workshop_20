MSFT_SPQuotaTemplate.psm1,06135cce439ef191f5db897a2a000698,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtTeXN0ZW0uU3RyaW5nXSAgJE5hbWUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLlVJbnQzMl0gICRTdG9yYWdlTWF4SW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJFN0b3JhZ2VXYXJuaW5nSW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJE1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJFdhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXSBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSA9ICJQcmVzZW50IiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCiAgICAKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIkdldHRpbmcgUXVvdGEgVGVtcGxhdGUgc2V0dGluZ3MiCiAgICBpZiAoJFN0b3JhZ2VNYXhJbk1CIC1sdCAkU3RvcmFnZVdhcm5pbmdJbk1CKSB7CiAgICAgICAgVGhyb3cgIlN0b3JhZ2VNYXhJbk1CIG11c3QgYmUgbGFyZ2VyIHRoYW4gU3RvcmFnZVdhcm5pbmdJbk1CLiIKICAgIH0KCiAgICBpZiAoJE1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucyAtbHQgJFdhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucykgewogICAgICAgIFRocm93ICJNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMgbXVzdCBiZSBsYXJnZXIgdGhhbiBXYXJuaW5nVXNhZ2VQb2ludHNTb2x1dGlvbnMuIgogICAgfQoKICAgICRyZXN1bHQgPSBJbnZva2UtU1BEU0NDb21tYW5kIC1DcmVkZW50aWFsICRJbnN0YWxsQWNjb3VudCAtQXJndW1lbnRzICRQU0JvdW5kUGFyYW1ldGVycyAtU2NyaXB0QmxvY2sgewogICAgICAgICRwYXJhbXMgPSAkYXJnc1swXQogICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRzcEZhcm0gPSBHZXQtU1BGYXJtCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLVZlcmJvc2UgIk5vIGxvY2FsIFNoYXJlUG9pbnQgZmFybSB3YXMgZGV0ZWN0ZWQuIFF1b3RhIHRlbXBsYXRlIHNldHRpbmdzIHdpbGwgbm90IGJlIGFwcGxpZWQiCiAgICAgICAgICAgIHJldHVybiAkbnVsbAogICAgICAgIH0KCiAgICAgICAgIyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIEFkbWluaXN0cmF0aW9uIFdlYlNlcnZpY2UKICAgICAgICAkYWRtU2VydmljZSA9IEdldC1TUERTQ0NvbnRlbnRTZXJ2aWNlCgogICAgICAgICR0ZW1wbGF0ZSA9ICRhZG1TZXJ2aWNlLlF1b3RhVGVtcGxhdGVzWyRwYXJhbXMuTmFtZV0KICAgICAgICBpZiAoJG51bGwgLWVxICR0ZW1wbGF0ZSkgeyAKICAgICAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgICAgICBOYW1lID0gJHBhcmFtcy5OYW1lCiAgICAgICAgICAgICAgICBFbnN1cmUgPSAiQWJzZW50IgogICAgICAgICAgICAgICAgSW5zdGFsbEFjY291bnQgPSAkcGFyYW1zLkluc3RhbGxBY2NvdW50CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gQHsKICAgICAgICAgICAgICAgIE5hbWUgPSAkcGFyYW1zLk5hbWUKICAgICAgICAgICAgICAgIFN0b3JhZ2VNYXhJbk1CID0gKCR0ZW1wbGF0ZS5TdG9yYWdlTWF4aW11bUxldmVsIC8gMU1CKSAjIENvbnZlcnQgZnJvbSBieXRlcyB0byBtZWdhYnl0ZXMKICAgICAgICAgICAgICAgIFN0b3JhZ2VXYXJuaW5nSW5NQiA9ICgkdGVtcGxhdGUuU3RvcmFnZVdhcm5pbmdMZXZlbCAvIDFNQikgIyBDb252ZXJ0IGZyb20gYnl0ZXMgdG8gbWVnYWJ5dGVzCiAgICAgICAgICAgICAgICBNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMgPSAkdGVtcGxhdGUuVXNlckNvZGVNYXhpbXVtTGV2ZWwKICAgICAgICAgICAgICAgIFdhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucyA9ICR0ZW1wbGF0ZS5Vc2VyQ29kZVdhcm5pbmdMZXZlbAogICAgICAgICAgICAgICAgRW5zdXJlID0gIlByZXNlbnQiCiAgICAgICAgICAgICAgICBJbnN0YWxsQWNjb3VudCA9ICRwYXJhbXMuSW5zdGFsbEFjY291bnQKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcmVzdWx0Cn0KCgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldICBbU3lzdGVtLlN0cmluZ10gICROYW1lLAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0gW1N5c3RlbS5VSW50MzJdICAkU3RvcmFnZU1heEluTUIsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLlVJbnQzMl0gICRTdG9yYWdlV2FybmluZ0luTUIsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLlVJbnQzMl0gICRNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLlVJbnQzMl0gICRXYXJuaW5nVXNhZ2VQb2ludHNTb2x1dGlvbnMsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0gW1N5c3RlbS5TdHJpbmddICRFbnN1cmUgPSAiUHJlc2VudCIsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdICRJbnN0YWxsQWNjb3VudAogICAgKQoKICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlNldHRpbmcgcXVvdGEgdGVtcGxhdGUgc2V0dGluZ3MiCgogICAgaWYgKCRTdG9yYWdlTWF4SW5NQiAtbHQgJFN0b3JhZ2VXYXJuaW5nSW5NQikgewogICAgICAgIFRocm93ICJTdG9yYWdlTWF4SW5NQiBtdXN0IGJlIGxhcmdlciB0aGFuIFN0b3JhZ2VXYXJuaW5nSW5NQi4iCiAgICB9CgogICAgaWYgKCRNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMgLWx0ICRXYXJuaW5nVXNhZ2VQb2ludHNTb2x1dGlvbnMpIHsKICAgICAgICBUaHJvdyAiTWF4aW11bVVzYWdlUG9pbnRzU29sdXRpb25zIG11c3QgYmUgbGFyZ2VyIHRoYW4gV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zLiIKICAgIH0KCiAgICBzd2l0Y2ggKCRFbnN1cmUpIHsKICAgICAgICAiUHJlc2VudCIgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFbnN1cmUgaXMgc2V0IHRvIFByZXNlbnQgLSBBZGQgb3IgdXBkYXRlIHRlbXBsYXRlIgogICAgICAgICAgICBJbnZva2UtU1BEU0NDb21tYW5kIC1DcmVkZW50aWFsICRJbnN0YWxsQWNjb3VudCAtQXJndW1lbnRzICRQU0JvdW5kUGFyYW1ldGVycyAtU2NyaXB0QmxvY2sgewogICAgICAgICAgICAgICAgJHBhcmFtcyA9ICRhcmdzWzBdCiAgICAgICAgCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICRzcEZhcm0gPSBHZXQtU1BGYXJtCiAgICAgICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyAiTm8gbG9jYWwgU2hhcmVQb2ludCBmYXJtIHdhcyBkZXRlY3RlZC4gQW50aXZpcnVzIHNldHRpbmdzIHdpbGwgbm90IGJlIGFwcGxpZWQiCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiU3RhcnQgdXBkYXRlIgogICAgICAgICAgICAgICAgIyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIEFkbWluaXN0cmF0aW9uIFdlYlNlcnZpY2UKICAgICAgICAgICAgICAgICRhZG1TZXJ2aWNlID0gR2V0LVNQRFNDQ29udGVudFNlcnZpY2UKCiAgICAgICAgICAgICAgICAkdGVtcGxhdGUgPSAkYWRtU2VydmljZS5RdW90YVRlbXBsYXRlc1skcGFyYW1zLk5hbWVdCgogICAgICAgICAgICAgICAgaWYgKCRudWxsIC1lcSAkdGVtcGxhdGUpIHsgCiAgICAgICAgICAgICAgICAgICAgI1RlbXBsYXRlIGRvZXMgbm90IGV4aXN0LCBjcmVhdGUgbmV3IHRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgJG5ld1RlbXBsYXRlID0gTmV3LU9iamVjdCBNaWNyb3NvZnQuU2hhcmVQb2ludC5BZG1pbmlzdHJhdGlvbi5TUFF1b3RhVGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICAkbmV3VGVtcGxhdGUuTmFtZSA9ICRwYXJhbXMuTmFtZQogICAgICAgICAgICAgICAgICAgIGlmICgkcGFyYW1zLkNvbnRhaW5zS2V5KCJTdG9yYWdlTWF4SW5NQiIpKSB7ICRuZXdUZW1wbGF0ZS5TdG9yYWdlTWF4aW11bUxldmVsID0gKCRwYXJhbXMuU3RvcmFnZU1heEluTUIgKiAxTUIpIH0gIyBDb252ZXJ0IGZyb20gbWVnYWJ5dGVzIHRvIGJ5dGVzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRwYXJhbXMuQ29udGFpbnNLZXkoIlN0b3JhZ2VXYXJuaW5nSW5NQiIpKSB7ICRuZXdUZW1wbGF0ZS5TdG9yYWdlV2FybmluZ0xldmVsID0gKCRwYXJhbXMuU3RvcmFnZVdhcm5pbmdJbk1CICogMU1CKSB9ICMgQ29udmVydCBmcm9tIG1lZ2FieXRlcyB0byBieXRlcwogICAgICAgICAgICAgICAgICAgIGlmICgkcGFyYW1zLkNvbnRhaW5zS2V5KCJNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMiKSkgeyAkbmV3VGVtcGxhdGUuVXNlckNvZGVNYXhpbXVtTGV2ZWwgPSAkcGFyYW1zLk1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucyB9ICMgQ29udmVydCBmcm9tIG1lZ2FieXRlcyB0byBieXRlcwogICAgICAgICAgICAgICAgICAgIGlmICgkcGFyYW1zLkNvbnRhaW5zS2V5KCJXYXJuaW5nVXNhZ2VQb2ludHNTb2x1dGlvbnMiKSkgeyAkbmV3VGVtcGxhdGUuVXNlckNvZGVXYXJuaW5nTGV2ZWwgPSAkcGFyYW1zLldhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucyB9ICMgQ29udmVydCBmcm9tIG1lZ2FieXRlcyB0byBieXRlcwogICAgICAgICAgICAgICAgICAgICRhZG1TZXJ2aWNlLlF1b3RhVGVtcGxhdGVzLkFkZCgkbmV3VGVtcGxhdGUpCiAgICAgICAgICAgICAgICAgICAgJGFkbVNlcnZpY2UuVXBkYXRlKCkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgI1RlbXBsYXRlIGV4aXN0cywgdXBkYXRlIHNldHRpbmdzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRwYXJhbXMuQ29udGFpbnNLZXkoIlN0b3JhZ2VNYXhJbk1CIikpIHsgJHRlbXBsYXRlLlN0b3JhZ2VNYXhpbXVtTGV2ZWwgPSAoJHBhcmFtcy5TdG9yYWdlTWF4SW5NQiAqIDFNQikgfSAjIENvbnZlcnQgZnJvbSBtZWdhYnl0ZXMgdG8gYnl0ZXMKICAgICAgICAgICAgICAgICAgICBpZiAoJHBhcmFtcy5Db250YWluc0tleSgiU3RvcmFnZVdhcm5pbmdJbk1CIikpIHsgJHRlbXBsYXRlLlN0b3JhZ2VXYXJuaW5nTGV2ZWwgPSAoJHBhcmFtcy5TdG9yYWdlV2FybmluZ0luTUIgKiAxTUIpIH0gIyBDb252ZXJ0IGZyb20gbWVnYWJ5dGVzIHRvIGJ5dGVzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRwYXJhbXMuQ29udGFpbnNLZXkoIk1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucyIpKSB7ICR0ZW1wbGF0ZS5Vc2VyQ29kZU1heGltdW1MZXZlbCA9ICRwYXJhbXMuTWF4aW11bVVzYWdlUG9pbnRzU29sdXRpb25zIH0gIyBDb252ZXJ0IGZyb20gbWVnYWJ5dGVzIHRvIGJ5dGVzCiAgICAgICAgICAgICAgICAgICAgaWYgKCRwYXJhbXMuQ29udGFpbnNLZXkoIldhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucyIpKSB7ICR0ZW1wbGF0ZS5Vc2VyQ29kZVdhcm5pbmdMZXZlbCA9ICRwYXJhbXMuV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zIH0gIyBDb252ZXJ0IGZyb20gbWVnYWJ5dGVzIHRvIGJ5dGVzCiAgICAgICAgICAgICAgICAgICAgJGFkbVNlcnZpY2UuVXBkYXRlKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAiQWJzZW50IiB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkVuc3VyZSBpcyBzZXQgdG8gQWJzZW50IC0gUmVtb3ZpbmcgdGVtcGxhdGUiCgogICAgICAgICAgICBpZiAoJFN0b3JhZ2VNYXhJbk1CIC1vciAkU3RvcmFnZVdhcm5pbmdJbk1CIC1vciAkTWF4aW11bVVzYWdlUG9pbnRzU29sdXRpb25zIC1vciAkV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zKSB7CiAgICAgICAgICAgICAgICBUaHJvdyAiRG8gbm90IHVzZSBTdG9yYWdlTWF4SW5NQiwgU3RvcmFnZVdhcm5pbmdJbk1CLCBNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMgb3IgV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zIHdoZW4gRW5zdXJlIGlzIHNwZWNpZmllZCBhcyBBYnNlbnQiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEludm9rZS1TUERTQ0NvbW1hbmQgLUNyZWRlbnRpYWwgJEluc3RhbGxBY2NvdW50IC1Bcmd1bWVudHMgJFBTQm91bmRQYXJhbWV0ZXJzIC1TY3JpcHRCbG9jayB7CiAgICAgICAgICAgICAgICAkcGFyYW1zID0gJGFyZ3NbMF0KICAgICAgICAKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgJHNwRmFybSA9IEdldC1TUEZhcm0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLVZlcmJvc2UgIk5vIGxvY2FsIFNoYXJlUG9pbnQgZmFybSB3YXMgZGV0ZWN0ZWQuIFF1b3RhIHRlbXBsYXRlIHNldHRpbmdzIHdpbGwgbm90IGJlIGFwcGxpZWQiCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiU3RhcnQgdXBkYXRlIgogICAgICAgICAgICAgICAgIyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIEFkbWluaXN0cmF0aW9uIFdlYlNlcnZpY2UKICAgICAgICAgICAgICAgICRhZG1TZXJ2aWNlID0gR2V0LVNQRFNDQ29udGVudFNlcnZpY2UKCiAgICAgICAgICAgICAgICAjIERlbGV0ZSB0ZW1wbGF0ZSwgZnVuY3Rpb24gZG9lcyBub3QgdGhyb3cgYW4gZXJyb3Igd2hlbiB0aGUgdGVtcGxhdGUgZG9lcyBub3QgZXhpc3QuIFNvIHNhZmUgdG8gY2FsbCB3aXRob3V0IGVycm9yIGhhbmRsaW5nLgogICAgICAgICAgICAgICAgJGFkbVNlcnZpY2UuUXVvdGFUZW1wbGF0ZXMuRGVsZXRlKCRwYXJhbXMuTmFtZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIFRlc3QtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0gIFtTeXN0ZW0uU3RyaW5nXSAgJE5hbWUsCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXSBbU3lzdGVtLlVJbnQzMl0gICRTdG9yYWdlTWF4SW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJFN0b3JhZ2VXYXJuaW5nSW5NQiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJE1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uVUludDMyXSAgJFdhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucywKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXSBbU3lzdGVtLlN0cmluZ10gJEVuc3VyZSA9ICJQcmVzZW50IiwKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0gJEluc3RhbGxBY2NvdW50CiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiVGVzdGluZyBxdW90YSB0ZW1wbGF0ZSBzZXR0aW5ncyIKICAgIGlmICgkU3RvcmFnZU1heEluTUIgLWx0ICRTdG9yYWdlV2FybmluZ0luTUIpIHsKICAgICAgICBUaHJvdyAiU3RvcmFnZU1heEluTUIgbXVzdCBiZSBsYXJnZXIgdGhhbiBTdG9yYWdlV2FybmluZ0luTUIuIgogICAgfQoKICAgIGlmICgkTWF4aW11bVVzYWdlUG9pbnRzU29sdXRpb25zIC1sdCAkV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zKSB7CiAgICAgICAgVGhyb3cgIk1heGltdW1Vc2FnZVBvaW50c1NvbHV0aW9ucyBtdXN0IGJlIGxhcmdlciB0aGFuIFdhcm5pbmdVc2FnZVBvaW50c1NvbHV0aW9ucy4iCiAgICB9CgogICAgc3dpdGNoICgkRW5zdXJlKSB7CiAgICAgICAgIlByZXNlbnQiIHsKICAgICAgICAgICAgJEN1cnJlbnRWYWx1ZXMgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICAgICAgICAgIGlmICgoJEN1cnJlbnRWYWx1ZXMuRW5zdXJlIC1lcSAiQWJzZW50IikgLW9yICgkQ3VycmVudFZhbHVlcyAtZXEgJG51bGwpKSB7IHJldHVybiAkZmFsc2UgfQogICAgICAgICAgICByZXR1cm4gVGVzdC1TUERTQ1NwZWNpZmljUGFyYW1ldGVycyAtQ3VycmVudFZhbHVlcyAkQ3VycmVudFZhbHVlcyAtRGVzaXJlZFZhbHVlcyAkUFNCb3VuZFBhcmFtZXRlcnMKICAgICAgICB9CiAgICAgICAgIkFic2VudCIgewogICAgICAgICAgICBpZiAoJFN0b3JhZ2VNYXhJbk1CIC1vciAkU3RvcmFnZVdhcm5pbmdJbk1CIC1vciAkTWF4aW11bVVzYWdlUG9pbnRzU29sdXRpb25zIC1vciAkV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zKSB7CiAgICAgICAgICAgICAgICBUaHJvdyAiRG8gbm90IHVzZSBTdG9yYWdlTWF4SW5NQiwgU3RvcmFnZVdhcm5pbmdJbk1CLCBNYXhpbXVtVXNhZ2VQb2ludHNTb2x1dGlvbnMgb3IgV2FybmluZ1VzYWdlUG9pbnRzU29sdXRpb25zIHdoZW4gRW5zdXJlIGlzIHNwZWNpZmllZCBhcyBBYnNlbnQiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRDdXJyZW50VmFsdWVzID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVycwogICAgICAgICAgICBpZiAoKCRDdXJyZW50VmFsdWVzLkVuc3VyZSAtZXEgIlByZXNlbnQiKSAtb3IgKCRDdXJyZW50VmFsdWVzIC1lcSAkbnVsbCkpIHsgCiAgICAgICAgICAgICAgICAjIEVycm9yIG9jY3VyZWQgaW4gR2V0IG1ldGhvZCBvciB0ZW1wbGF0ZSBleGlzdHMsIHdoaWNoIGlzIG5vdCBzdXBwb3NlZCB0byBiZS4gUmV0dXJuIGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gJGZhbHNlCiAgICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgIyBUZW1wbGF0ZSBkb2VzIG5vdCBleGlzdHMsIHdoaWNoIGlzIHN1cHBvc2VkIHRvIGJlLiBSZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgcmV0dXJuICR0cnVlCiAgICAgICAgICAgIH0gCiAgICAgICAgfQogICAgfQp9CgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCg==
