ExchangeConfigHelper.psm1,9b517b44ded12a6235b9aa6d079c2139,Scan result is 1. IsMalware: 0,w6/Cu8K/I1Rha2VzIGEgU2VydmVycy5Dc3YgZmlsZSBnZW5lcmF0ZWQgYnkgdGhlIEV4Y2hhbmdlIFNlcnZlciBSb2xlIFJlcXVpcmVtZW50cyBDYWxjdWxhdG9yIGFuZCB0dXJucyB0aGUgbGlzdGVkIGRpc2tzCiNpbnRvIGEgRGJNYXAgd2hpY2ggY2FuIGJlIHVzZWQgd2l0aCB4RXhjaEF1dG9Nb3VudFBvaW50LgojCiNQYXJhbXM6CiNTZXJ2ZXJzQ3N2UGF0aDogVGhlIGZ1bGwgcGF0aCB0byB0aGUgU2VydmVycy5jc3YgZmlsZSB0byByZWFkCiNTZXJ2ZXJOYW1lSW5Dc3Y6IFRoZSBuYW1lIG9mIHRoZSBzZXJ2ZXIgaW4gdGhlIFNlcnZlcnMuY3N2IGZpbGUgdGhhdCBtYXRjaGVzIHRoaXMgc2VydmVyLiBGb3IgaW5zdGFuY2UsIGlmIFNSVi0jIy0wMSB3YXMgYSBzZXJ2ZXIgbmFtZSBpbiBTZXJ2ZXJzLmNzdiwgYnV0IHRoaXMgc2VydmVyIGlzIFNSVi0wMS0wMSwgeW91IHdvdWxkIHBhc3MgaW4gJ1NSVi0jIy0wMScgdG8gY29ycmVjdGx5IGZpbmQgdGhlIHJpZ2h0IHNldCBvZiBkYXRhYmFzZXMKI0RiTmFtZVJlcGxhY2VtZW50czogQW55IHJlcGxhY2VtZW50cyB0aGF0IHNob3VsZCBiZSBpbiB0aGUgZGF0YWJhc2UgbmFtZS4gRm9yIGluc3RhbmNlLCBpZiBhIGRhdGFiYXNlIG5hbWUgaW4gdGhlIGZpbGUgd2FzIERBRy0jIy1EQjAxLCBJIHdvdWxkIHNwZWNpZmljeTogQHsiIyMiID0gIjAxIH0uIFRoaXMgd291bGQgcmVwbGFjZSBhbGwgZGF0YWJhc2UgbmFtZSBpbnN0YW5jZSBvZiAjIyB3aXRoIDAxCmZ1bmN0aW9uIERCTWFwRnJvbVNlcnZlcnNDc3YKewogICAgcGFyYW0oW3N0cmluZ10kU2VydmVyc0NzdlBhdGgsIFtzdHJpbmddJFNlcnZlck5hbWVJbkNzdiwgW0hhc2h0YWJsZV0kRGJOYW1lUmVwbGFjZW1lbnRzID0gQHt9KQoKICAgICNPdXRwdXQgdmFyaWFibGUgZm9yIHRoZSBmdW5jdGlvbgogICAgW3N0cmluZ1tdXSRkYk1hcE91dCA9IEAoKQoKICAgIGlmICgoVGVzdC1QYXRoIC1MaXRlcmFsUGF0aCAiJCgkU2VydmVyc0NzdlBhdGgpIikgLWVxICR0cnVlKQogICAgewogICAgICAgICRzZXJ2ZXJzQ3N2ID0gSW1wb3J0LUNzdiAtTGl0ZXJhbFBhdGggIiQoJFNlcnZlcnNDc3ZQYXRoKSIKCiAgICAgICAgJGZvdW5kU2VydmVyID0gJGZhbHNlCgogICAgICAgICNMb29wIHRocm91Z2ggdW50aWwgd2UgZmluZCBhIG1hdGNoaW5nIHNlcnZlcgogICAgICAgIGZvciAoJGkgPSAwOyAkaSAtbHQgJHNlcnZlcnNDc3YuQ291bnQgLWFuZCAkZm91bmRTZXJ2ZXIgLWVxICRmYWxzZTsgJGkrKykKICAgICAgICB7ICAgICAgICAgICAKICAgICAgICAgICAgaWYgKCRzZXJ2ZXJzQ3N2WyRpXS5TZXJ2ZXJOYW1lIC1saWtlICRTZXJ2ZXJOYW1lSW5Dc3YpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICNXZSBmb3VuZCBhIG1hdGNoLCBwcm9jZWVkCiAgICAgICAgICAgICAgICAkZm91bmRTZXJ2ZXIgPSAkdHJ1ZQoKICAgICAgICAgICAgICAgICRkYlBlclZvbHVtZSA9ICRzZXJ2ZXJzQ3N2WyRpXS5EYlBlclZvbHVtZQoKICAgICAgICAgICAgICAgIGlmICgkZGJQZXJWb2x1bWUgLWVxIDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgIkRiUGVyVm9sdW1lIGZvciBzZXJ2ZXIgJyQoJFNlcnZlck5hbWVJbkNzdiknaXMgMCIKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAjVHVybiB0aGUgRGJNYXAgZnJvbSBzdHJpbmcgaW50byBhbiBhcnJheQogICAgICAgICAgICAgICAgJGRiTWFwSW4gPSAkc2VydmVyc0NzdlskaV0uRGJNYXAuU3BsaXQoJywnKQoKICAgICAgICAgICAgICAgIGlmICgkZGJNYXBJbi5Db3VudCAtZ3QgMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAjTG9vcCB0aHJvdWdoIHRoZSBEYk1hcCBpbiBpbmNyZW1lbnRzIG9mIGRiUGVyVm9sdW1lIGFuZCBmaWd1cmUgb3V0IHdoaWNoIERCJ3Mgd2lsbCBnbyBvbiBhIHNpbmdsZSBkaXNrCiAgICAgICAgICAgICAgICAgICAgZm9yICgkaiA9IDA7ICRqIC1sdCAkZGJNYXBJbi5Db3VudDsgJGogKz0gJGRiUGVyVm9sdW1lKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgW3N0cmluZ10kY3VycmVudERpc2sgPSAiIgoKICAgICAgICAgICAgICAgICAgICAgICAgI0xvb3AgdGhyb3VnaCB0aGUgaW5kaXZpZHVhbCBEQidzIGZvciB0aGlzIGRpc2sKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICgkayA9ICRqOyAkayAtbHQgJGogKyAkZGJQZXJWb2x1bWU7ICRrKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICNUaGlzIGlzbid0IHRoZSBmaXJzdCBEQiBvbiB0aGUgZGlzayBzbyBwcmVwZW5kIGEgY29tbWEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkayAtZ3QgJGopCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnREaXNrICs9ICIsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICNNYWtlIGFueSByZXF1ZXN0ZWQgcmVwbGFjZW1lbnRzIGluIHRoZSBEQiBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3VycmVudERiID0gU3RyaW5nUmVwbGFjZUZyb21IYXNodGFibGUgLVN0cmluZ0luICRkYk1hcEluWyRrXSAtUmVwbGFjZW1lbnRzICREYk5hbWVSZXBsYWNlbWVudHMKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjQWRkIHRoZSBkYiB0byB0aGUgY3VycmVudCBkaXNrIHN0cmluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnREaXNrICs9ICRjdXJyZW50RGIKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgI0FkZCB0aGUgZmluaXNoZWQgZGlzayB0byB0aGUgb3V0cHV0IHZhcmlhYmxlCiAgICAgICAgICAgICAgICAgICAgICAgICRkYk1hcE91dCArPSAkY3VycmVudERpc2sKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgIk5vIGRhdGFiYXNlcyBmb3VuZCBpbiBEYk1hcCBmb3Igc2VydmVyICckKCRTZXJ2ZXJOYW1lSW5Dc3YpJyBpbiBmaWxlOiAkKCRTZXJ2ZXJzQ3N2UGF0aCkiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgkZm91bmRTZXJ2ZXIgLWVxICRmYWxzZSkKICAgICAgICB7CiAgICAgICAgICAgIHRocm93ICJVbmFibGUgdG8gZmluZCBzZXJ2ZXIgJyQoJFNlcnZlck5hbWVJbkNzdiknIGluIGZpbGU6ICQoJFNlcnZlcnNDc3ZQYXRoKSIKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBhY2Nlc3MgZmlsZSBhdCBwYXRoOiAkKCRTZXJ2ZXJzQ3N2UGF0aCkiCiAgICB9CgogICAgcmV0dXJuICRkYk1hcE91dAp9CgojVGFrZXMgYSBNYWlsYm94RGF0YWJhc2VzLmNzdiBmaWxlIGdlbmVyYXRlZCBieSB0aGUgRXhjaGFuZ2UgU2VydmVyIFJvbGUgUmVxdWlyZW1lbnRzIENhbGN1bGF0b3IgYW5kIHJldHVybnMgYSBsaXN0IG9mIGRhdGFiYXNlcyBhbmQgdGhlaXIgcHJvcGVydGllcy4KI1RoaXMgY2FuIHRoZW4gYmUgdXNlZCBhcyBpbnB1dCBmb3IgdGhlIHhFeGNoTWFpbGJveERhdGFiYXNlIHJlc291cmNlLgojCiNQYXJhbXM6CiNNYWlsYm94RGF0YWJhc2VzQ3N2UGF0aDogVGhlIGZ1bGwgcGF0aCB0byB0aGUgTWFpbGJveERhdGFiYXNlcy5jc3YgZmlsZSB0byByZWFkCiNTZXJ2ZXJOYW1lSW5Dc3Y6IFRoZSBuYW1lIG9mIHRoZSBzZXJ2ZXIgaW4gdGhlIE1haWxib3hEYXRhYmFzZXMuY3N2IGZpbGUgdGhhdCBtYXRjaGVzIHRoaXMgc2VydmVyLiBGb3IgaW5zdGFuY2UsIGlmIFNSVi0jIy0wMSB3YXMgYSBzZXJ2ZXIgbmFtZSBpbiBTZXJ2ZXJzLmNzdiwgYnV0IHRoaXMgc2VydmVyIGlzIFNSVi0wMS0wMSwgeW91IHdvdWxkIHBhc3MgaW4gJ1NSVi0jIy0wMScgdG8gY29ycmVjdGx5IGZpbmQgdGhlIHJpZ2h0IHNldCBvZiBkYXRhYmFzZXMKI0RiTmFtZVJlcGxhY2VtZW50czogQW55IHJlcGxhY2VtZW50cyB0aGF0IHNob3VsZCBiZSBpbiB0aGUgZGF0YWJhc2UgbmFtZSwgbG9nIHBhdGgsIG9yIGVkYiBwYXRoLiBGb3IgaW5zdGFuY2UsIGlmIGEgZGF0YWJhc2UgbmFtZSBpbiB0aGUgZmlsZSB3YXMgREFHLSMjLURCMDEsIEkgd291bGQgc3BlY2lmaWN5OiBAeyIjIyIgPSAiMDEgfS4gVGhpcyB3b3VsZCByZXBsYWNlIGFsbCBkYXRhYmFzZSBuYW1lIGluc3RhbmNlIG9mICMjIHdpdGggMDEKZnVuY3Rpb24gREJMaXN0RnJvbU1haWxib3hEYXRhYmFzZXNDc3YKewogICAgcGFyYW0oW3N0cmluZ10kTWFpbGJveERhdGFiYXNlc0NzdlBhdGgsIFtzdHJpbmddJFNlcnZlck5hbWVJbkNzdiwgW0hhc2h0YWJsZV0kRGJOYW1lUmVwbGFjZW1lbnRzID0gQHt9KQoKICAgICNPdXRwdXQgdmFyaWFibGUgZm9yIHRoZSBmdW5jdGlvbgogICAgW0FycmF5XSRkYkxpc3QgPSBAKCkKCiAgICBpZiAoKFRlc3QtUGF0aCAtTGl0ZXJhbFBhdGggIiQoJE1haWxib3hEYXRhYmFzZXNDc3ZQYXRoKSIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkZGF0YWJhc2VzQ3N2ID0gSW1wb3J0LUNzdiAtTGl0ZXJhbFBhdGggIiQoJE1haWxib3hEYXRhYmFzZXNDc3ZQYXRoKSIKCiAgICAgICAgI0xvb3AgdGhyb3VnaCBlYWNoIGRhdGFiYXNlLCBhbmQgaWYgaXQgYmVsb25ncyB0byB0aGlzIHNlcnZlciwgYXQgaXQgdG8gdGhlIGxpc3QKICAgICAgICBmb3IgKCRpID0gMDsgJGkgLWx0ICRkYXRhYmFzZXNDc3YuQ291bnQ7ICRpKyspCiAgICAgICAgewogICAgICAgICAgICBpZiAoJGRhdGFiYXNlc0NzdlskaV0uU2VydmVyIC1saWtlICRTZXJ2ZXJOYW1lSW5Dc3YpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRkYkluID0gJGRhdGFiYXNlc0NzdlskaV0KCiAgICAgICAgICAgICAgICAjQnVpbGQgYSBjdXN0b20gb2JqZWN0IHRvIGhvbGQgYWxsIHRoZSBEQiBwcm9wcwogICAgICAgICAgICAgICAgJGN1cnJlbnREYiA9IE5ldy1PYmplY3QgUFNPYmplY3QKCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgTmFtZSAoU3RyaW5nUmVwbGFjZUZyb21IYXNodGFibGUgLVN0cmluZ0luICRkYkluLk5hbWUgLVJlcGxhY2VtZW50cyAkRGJOYW1lUmVwbGFjZW1lbnRzKQogICAgICAgICAgICAgICAgJGN1cnJlbnREYiB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IERCRmlsZVBhdGggKFN0cmluZ1JlcGxhY2VGcm9tSGFzaHRhYmxlIC1TdHJpbmdJbiAkZGJJbi5EQkZpbGVQYXRoIC1SZXBsYWNlbWVudHMgJERiTmFtZVJlcGxhY2VtZW50cykKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBMb2dGb2xkZXJQYXRoIChTdHJpbmdSZXBsYWNlRnJvbUhhc2h0YWJsZSAtU3RyaW5nSW4gJGRiSW4uTG9nRm9sZGVyUGF0aCAtUmVwbGFjZW1lbnRzICREYk5hbWVSZXBsYWNlbWVudHMpCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgRGVsZXRlZEl0ZW1SZXRlbnRpb24gJGRiSW4uRGVsZXRlZEl0ZW1SZXRlbnRpb24KICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBHQyAkZGJJbi5HQwogICAgICAgICAgICAgICAgJGN1cnJlbnREYiB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IE9BQiAkZGJJbi5PQUIKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBSZXRhaW5EZWxldGVkSXRlbXNVbnRpbEJhY2t1cCAkZGJJbi5SZXRhaW5EZWxldGVkSXRlbXNVbnRpbEJhY2t1cAogICAgICAgICAgICAgICAgJGN1cnJlbnREYiB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IEluZGV4RW5hYmxlZCAkZGJJbi5JbmRleEVuYWJsZWQKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBDaXJjdWxhckxvZ2dpbmdFbmFibGVkICRkYkluLkNpcmN1bGFyTG9nZ2luZ0VuYWJsZWQKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBQcm9oaWJpdFNlbmRSZWNlaXZlUXVvdGEgJGRiSW4uUHJvaGliaXRTZW5kUmVjZWl2ZVF1b3RhCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgUHJvaGliaXRTZW5kUXVvdGEgJGRiSW4uUHJvaGliaXRTZW5kUXVvdGEKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBJc3N1ZVdhcm5pbmdRdW90YSAkZGJJbi5Jc3N1ZVdhcm5pbmdRdW90YQogICAgICAgICAgICAgICAgJGN1cnJlbnREYiB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IEFsbG93RmlsZVJlc3RvcmUgJGRiSW4uQWxsb3dGaWxlUmVzdG9yZQogICAgICAgICAgICAgICAgJGN1cnJlbnREYiB8IEFkZC1NZW1iZXIgTm90ZVByb3BlcnR5IEJhY2tncm91bmREYXRhYmFzZU1haW50ZW5hbmNlICRkYkluLkJhY2tncm91bmREYXRhYmFzZU1haW50ZW5hbmNlCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgSXNFeGNsdWRlZEZyb21Qcm92aXNpb25pbmcgJGRiSW4uSXNFeGNsdWRlZEZyb21Qcm92aXNpb25pbmcKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBJc1N1c3BlbmRlZEZyb21Qcm92aXNpb25pbmcgJGRiSW4uSXNTdXNwZW5kZWRGcm9tUHJvdmlzaW9uaW5nCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgTWFpbGJveFJldGVudGlvbiAkZGJJbi5NYWlsYm94UmV0ZW50aW9uCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgTW91bnRBdFN0YXJ0dXAgJGRiSW4uTW91bnRBdFN0YXJ0dXAKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBFdmVudEhpc3RvcnlSZXRlbnRpb25QZXJpb2QgJGRiSW4uRXZlbnRIaXN0b3J5UmV0ZW50aW9uUGVyaW9kCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgQXV0b0RhZ0V4Y2x1ZGVGcm9tTW9uaXRvcmluZyAkZGJJbi5BdXRvRGFnRXhjbHVkZUZyb21Nb25pdG9yaW5nCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgQ2FsZW5kYXJMb2dnaW5nUXVvdGEgJGRiSW4uQ2FsZW5kYXJMb2dnaW5nUXVvdGEKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBJc0V4Y2x1ZGVkRnJvbUluaXRpYWxQcm92aXNpb25pbmcgJGRiSW4uSXNFeGNsdWRlZEZyb21Jbml0aWFsUHJvdmlzaW9uaW5nCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgRGF0YU1vdmVSZXBsaWNhdGlvbkNvbnN0cmFpbnQgJGRiSW4uRGF0YU1vdmVSZXBsaWNhdGlvbkNvbnN0cmFpbnQKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBSZWNvdmVyYWJsZUl0ZW1zUXVvdGEgJGRiSW4uUmVjb3ZlcmFibGVJdGVtc1F1b3RhCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgUmVjb3ZlcmFibGVJdGVtc1dhcm5pbmdRdW90YSAkZGJJbi5SZWNvdmVyYWJsZUl0ZW1zV2FybmluZ1F1b3RhCgogICAgICAgICAgICAgICAgJGRiTGlzdCArPSAkY3VycmVudERiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBhY2Nlc3MgZmlsZSBhdCBwYXRoOiAkKCRNYWlsYm94RGF0YWJhc2VzQ3N2UGF0aCkiCiAgICB9CgogICAgcmV0dXJuICRkYkxpc3QKfQoKI1Rha2VzIGEgTWFpbGJveERhdGFiYXNlQ29waWVzLmNzdiBmaWxlIGdlbmVyYXRlZCBieSB0aGUgRXhjaGFuZ2UgU2VydmVyIFJvbGUgUmVxdWlyZW1lbnRzIENhbGN1bGF0b3IgYW5kIHJldHVybnMgYSBsaXN0IG9mIGRhdGFiYXNlcyBhbmQgdGhlaXIgcHJvcGVydGllcy4KI1RoaXMgY2FuIHRoZW4gYmUgdXNlZCBhcyBpbnB1dCBmb3IgdGhlIHhFeGNoTWFpbGJveERhdGFiYXNlIHJlc291cmNlLgojCiNQYXJhbXM6CiNNYWlsYm94RGF0YWJhc2VDb3BpZXNDc3ZQYXRoOiBUaGUgZnVsbCBwYXRoIHRvIHRoZSBNYWlsYm94RGF0YWJhc2VDb3BpZXMuY3N2IGZpbGUgdG8gcmVhZAojU2VydmVyTmFtZUluQ3N2OiBUaGUgbmFtZSBvZiB0aGUgc2VydmVyIGluIHRoZSBNYWlsYm94RGF0YWJhc2VDb3BpZXMuY3N2IGZpbGUgdGhhdCBtYXRjaGVzIHRoaXMgc2VydmVyLiBGb3IgaW5zdGFuY2UsIGlmIFNSVi0jIy0wMSB3YXMgYSBzZXJ2ZXIgbmFtZSBpbiBTZXJ2ZXJzLmNzdiwgYnV0IHRoaXMgc2VydmVyIGlzIFNSVi0wMS0wMSwgeW91IHdvdWxkIHBhc3MgaW4gJ1NSVi0jIy0wMScgdG8gY29ycmVjdGx5IGZpbmQgdGhlIHJpZ2h0IHNldCBvZiBkYXRhYmFzZXMKI0RiTmFtZVJlcGxhY2VtZW50czogQW55IHJlcGxhY2VtZW50cyB0aGF0IHNob3VsZCBiZSBpbiB0aGUgZGF0YWJhc2UgbmFtZSwgbG9nIHBhdGgsIG9yIGVkYiBwYXRoLiBGb3IgaW5zdGFuY2UsIGlmIGEgZGF0YWJhc2UgbmFtZSBpbiB0aGUgZmlsZSB3YXMgREFHLSMjLURCMDEsIEkgd291bGQgc3BlY2lmaWN5OiBAeyIjIyIgPSAiMDEgfS4gVGhpcyB3b3VsZCByZXBsYWNlIGFsbCBkYXRhYmFzZSBuYW1lIGluc3RhbmNlIG9mICMjIHdpdGggMDEKZnVuY3Rpb24gREJMaXN0RnJvbU1haWxib3hEYXRhYmFzZUNvcGllc0Nzdgp7CiAgICBwYXJhbShbc3RyaW5nXSRNYWlsYm94RGF0YWJhc2VDb3BpZXNDc3ZQYXRoLCBbc3RyaW5nXSRTZXJ2ZXJOYW1lSW5Dc3YsIFtIYXNodGFibGVdJERiTmFtZVJlcGxhY2VtZW50cyA9IEB7fSkKCiAgICAjT3V0cHV0IHZhcmlhYmxlIGZvciB0aGUgZnVuY3Rpb24KICAgIFtBcnJheV0kZGJMaXN0ID0gQCgpCgogICAgaWYgKChUZXN0LVBhdGggLUxpdGVyYWxQYXRoICIkKCRNYWlsYm94RGF0YWJhc2VDb3BpZXNDc3ZQYXRoKSIpIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkZGF0YWJhc2VzQ3N2ID0gSW1wb3J0LUNzdiAtTGl0ZXJhbFBhdGggIiQoJE1haWxib3hEYXRhYmFzZUNvcGllc0NzdlBhdGgpIgoKICAgICAgICAjTG9vcCB0aHJvdWdoIGVhY2ggZGF0YWJhc2UsIGFuZCBpZiBpdCBiZWxvbmdzIHRvIHRoaXMgc2VydmVyLCBhdCBpdCB0byB0aGUgbGlzdAogICAgICAgIGZvciAoJGkgPSAwOyAkaSAtbHQgJGRhdGFiYXNlc0Nzdi5Db3VudDsgJGkrKykKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkZGF0YWJhc2VzQ3N2WyRpXS5TZXJ2ZXIgLWxpa2UgJFNlcnZlck5hbWVJbkNzdikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGRiSW4gPSAkZGF0YWJhc2VzQ3N2WyRpXQoKICAgICAgICAgICAgICAgICNCdWlsZCBhIGN1c3RvbSBvYmplY3QgdG8gaG9sZCBhbGwgdGhlIERCIHByb3BzCiAgICAgICAgICAgICAgICAkY3VycmVudERiID0gTmV3LU9iamVjdCBQU09iamVjdAoKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBOYW1lIChTdHJpbmdSZXBsYWNlRnJvbUhhc2h0YWJsZSAtU3RyaW5nSW4gJGRiSW4uTmFtZSAtUmVwbGFjZW1lbnRzICREYk5hbWVSZXBsYWNlbWVudHMpCiAgICAgICAgICAgICAgICAkY3VycmVudERiIHwgQWRkLU1lbWJlciBOb3RlUHJvcGVydHkgQWN0aXZhdGlvblByZWZlcmVuY2UgJGRiSW4uQWN0aXZhdGlvblByZWZlcmVuY2UKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBSZXBsYXlMYWdUaW1lICRkYkluLlJlcGxheUxhZ1RpbWUKICAgICAgICAgICAgICAgICRjdXJyZW50RGIgfCBBZGQtTWVtYmVyIE5vdGVQcm9wZXJ0eSBUcnVuY2F0aW9uTGFnVGltZSAkZGJJbi5UcnVuY2F0aW9uTGFnVGltZQoKICAgICAgICAgICAgICAgICRkYkxpc3QgKz0gJGN1cnJlbnREYgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHRocm93ICJVbmFibGUgdG8gYWNjZXNzIGZpbGUgYXQgcGF0aDogJCgkTWFpbGJveERhdGFiYXNlc0NzdlBhdGgpIgogICAgfQoKICAgIHJldHVybiAkZGJMaXN0Cn0KCiNUYWtlcyBhIHN0cmluZywgbWFrZXMgYW55IHJlcGxhY2VtZW50cyBzcGVjaWZpZWQgaW4gdGhlIGhhc2h0YWJsZSwgYW5kIHRoZW4gcmV0dXJucyB0aGUgbmV3IHN0cmluZwpmdW5jdGlvbiBTdHJpbmdSZXBsYWNlRnJvbUhhc2h0YWJsZQp7CiAgICBwYXJhbShbc3RyaW5nXSRTdHJpbmdJbiwgJFJlcGxhY2VtZW50cyA9IEB7fSkKCiAgICBpZiAoJFJlcGxhY2VtZW50cy5Db3VudCAtZ3QgMCkKICAgIHsKICAgICAgICBmb3JlYWNoICgka2V5IGluICRSZXBsYWNlbWVudHMuS2V5cykKICAgICAgICB7CiAgICAgICAgICAgICRTdHJpbmdJbiA9ICRTdHJpbmdJbi5SZXBsYWNlKCRrZXksICRSZXBsYWNlbWVudHNbJGtleV0pCiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkU3RyaW5nSW4KfQoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKgo=
