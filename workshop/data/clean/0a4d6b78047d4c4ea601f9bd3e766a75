xExchangeDiskPart.psm1,70a72ce359943b5fed4d88741aa1851d,Scan result is 1. IsMalware: 0,I0FkZHMgdGhlIGFycmF5IG9mIGNvbW1hbmRzIHRvIGEgc2luZ2xlIHRlbXAgZmlsZSwgYW5kIGhhcyBkaXNrIHBhcnQgZXhlY3V0ZSB0aGUgdGVtcCBmaWxlCmZ1bmN0aW9uIFN0YXJ0RGlza3BhcnQKewoJW0NtZGxldEJpbmRpbmcoKV0KCVtPdXRwdXRUeXBlKFtTeXN0ZW0uU3RyaW5nXSldCiAgICBQYXJhbSAoW0FycmF5XSRDb21tYW5kcywgW0Jvb2xlYW5dJFNob3dPdXRwdXQgPSAkdHJ1ZSwgJFZlcmJvc2VQcmVmZXJlbmNlKQoKICAgICRUZW1wZmlsZSA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldFRlbXBGaWxlTmFtZSgpCgogICAgZm9yZWFjaCAoJENvbSBpbiAkQ29tbWFuZHMpCiAgICB7CgkJJENNRExpbmUgPSAkQ01ETGluZSArICRDb20gKyAiLCAiCiAgICAgICAgQWRkLUNvbnRlbnQgJFRlbXBmaWxlICRDb20KICAgIH0KCiAgICAkT3V0cHV0ID0gRGlza1BhcnQgL3MgJFRlbXBmaWxlCgogICAgaWYgKCRTaG93T3V0cHV0KQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIkV4ZWN1dGVkIERpc2twYXJ0IGNvbW1hbmRzOiAkKFN0cmluZ0FycmF5VG9Db21tYVNlcGFyYXRlZFN0cmluZyAtQXJyYXkgJENvbW1hbmRzKS4gUmVzdWx0OiIKICAgICAgICBXcml0ZS1WZXJib3NlICIkKCRPdXRwdXQpIgogICAgfQoKICAgIFJlbW92ZS1JdGVtICRUZW1wZmlsZQoKICAgIHJldHVybiAkT3V0cHV0Cn0KCiNVc2VzIGRpc2twYXJ0IHRvIG9idGFpbiBpbmZvcm1hdGlvbiBvbiB0aGUgZGlza3MgYW5kIHZvbHVtZXMgdGhhdCBhbHJlYWR5IGV4aXN0IG9uIHRoZSBzeXN0ZW0KZnVuY3Rpb24gR2V0RGlza0luZm8KewogICAgW0hhc2h0YWJsZV0kZ2xvYmFsOkRpc2tUb1ZvbHVtZU1hcCA9IEB7fQogICAgW0hhc2h0YWJsZV0kZ2xvYmFsOlZvbHVtZVRvTW91bnRQb2ludE1hcCA9IEB7fQogICAgW0hhc2h0YWJsZV0kZ2xvYmFsOkRpc2tTaXplTWFwID0gQHt9CiAgICBbaW50W11dJGRpc2tOdW1zID0gQCgpCgogICAgJGRpc2tMaXN0ID0gU3RhcnREaXNrcGFydCAtQ29tbWFuZHMgIkxpc3QgRGlzayIgLVNob3dPdXRwdXQgJGZhbHNlCgogICAgJGZvdW5kRGlza3MgPSAkZmFsc2UKCiAgICAjRmlyc3QgcGFyc2Ugb3V0IHRoZSBsaXN0IG9mIGRpc2tzCiAgICBmb3JlYWNoICgkbGluZSBpbiAkZGlza0xpc3QpCiAgICB7CiAgICAgICAgaWYgKCRmb3VuZERpc2tzIC1lcSAkdHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgkbGluZS5Db250YWlucygiRGlzayAiKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgI0ZpcnN0IGZpbmQgdGhlIGRpc2sgbnVtYmVyCiAgICAgICAgICAgICAgICAkc3RhcnRJbmRleCA9ICIgIERpc2sgIi5MZW5ndGgKICAgICAgICAgICAgICAgICRlbmRJbmRleCA9ICIgIC0tLS0tLS0tICAiLkxlbmd0aAogICAgICAgICAgICAgICAgJGRpc2tOdW1TdHIgPSAkbGluZS5TdWJzdHJpbmcoJHN0YXJ0SW5kZXgsICRlbmRJbmRleCAtICRzdGFydEluZGV4KS5UcmltKCkKCiAgICAgICAgICAgICAgICBpZiAoJGRpc2tOdW1TdHIuTGVuZ3RoIC1ndCAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRkaXNrTnVtID0gW2ludF06OlBhcnNlKCRkaXNrTnVtU3RyKQogICAgICAgICAgICAgICAgICAgICRkaXNrTnVtcyArPSAkZGlza051bQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICNOb3cgZmluZCB0aGUgZGlzayBzaXplCiAgICAgICAgICAgICAgICAkc3RhcnRJbmRleCA9ICIgIC0tLS0tLS0tICAtLS0tLS0tLS0tLS0tICAiLkxlbmd0aAogICAgICAgICAgICAgICAgJGVuZEluZGV4ID0gIiAgLS0tLS0tLS0gIC0tLS0tLS0tLS0tLS0gIC0tLS0tLS0gICIuTGVuZ3RoCiAgICAgICAgICAgICAgICAkZGlza1NpemUgPSAkbGluZS5TdWJzdHJpbmcoJHN0YXJ0SW5kZXgsICRlbmRJbmRleCAtICRzdGFydEluZGV4KS5UcmltKCkKCiAgICAgICAgICAgICAgICBpZiAoJGRpc2tTaXplLkxlbmd0aCAtZ3QgMCAtYW5kICRkaXNrTnVtIC1uZSAkbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkRGlza1NpemVNYXAuQWRkKCRkaXNrTnVtLCAkZGlza1NpemUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkbGluZS5Db250YWlucygiLS0tLS0tLS0gIC0tLS0tLS0tLS0tLS0gIC0tLS0tLS0gIC0tLS0tLS0gIC0tLSAgLS0tIikpICNTY3JvbGwgZm9yd2FyZCB1bnRpbCB3ZSBmaW5kIHRoZSB3aGVyZSB0aGUgbGlzdCBvZiBkaXNrcyBzdGFydHMKICAgICAgICB7CiAgICAgICAgICAgICRmb3VuZERpc2tzID0gJHRydWUKICAgICAgICB9CiAgICB9CgogICAgI05vdyBnZXQgaW5mbyBvbiB0aGUgZGlza3MKICAgIGZvcmVhY2ggKCRkaXNrTnVtIGluICRkaXNrTnVtcykKICAgIHsKICAgICAgICAkZGlza0RldGFpbHMgPSBTdGFydERpc2twYXJ0IC1Db21tYW5kcyAiU2VsZWN0IERpc2sgJCgkZGlza051bSkiLCJEZXRhaWwgRGlzayIgLVNob3dPdXRwdXQgJGZhbHNlCgogICAgICAgICRmb3VuZFZvbHVtZXMgPSAkZmFsc2UKCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkZGlza0RldGFpbHMuQ291bnQ7ICRpKyspCiAgICAgICAgewogICAgICAgICAgICAkbGluZSA9ICRkaXNrRGV0YWlsc1skaV0KCiAgICAgICAgICAgIGlmICgkZm91bmRWb2x1bWVzIC1lcSAkdHJ1ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCRsaW5lLlN0YXJ0c1dpdGgoIiAgVm9sdW1lICIpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICNGaXJzdCBmaW5kIHRoZSB2b2x1bWUgbnVtYmVyCiAgICAgICAgICAgICAgICAgICAgJHZvbFN0YXJ0ID0gIiAgVm9sdW1lICIuTGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgJHZvbEVuZCA9ICIgIC0tLS0tLS0tLS0gICIuTGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgJHZvbFN0ciA9ICRsaW5lLlN1YnN0cmluZygkdm9sU3RhcnQsICR2b2xFbmQgLSAkdm9sU3RhcnQpLlRyaW0oKQoKICAgICAgICAgICAgICAgICAgICBpZiAoJHZvbFN0ci5MZW5ndGggLWd0IDApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkdm9sTnVtID0gW2ludF06OlBhcnNlKCR2b2xTdHIpCgogICAgICAgICAgICAgICAgICAgICAgICBBZGRPYmplY3RUb01hcE9mT2JqZWN0QXJyYXlzIC1NYXAgJERpc2tUb1ZvbHVtZU1hcCAtS2V5ICRkaXNrTnVtIC1WYWx1ZSAkdm9sTnVtCgogICAgICAgICAgICAgICAgICAgICAgICAjTm93IHBhcnNlIG91dCB0aGUgZHJpdmUgbGV0dGVyIGlmIGl0J3Mgc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICRsZXR0ZXJTdGFydCA9ICIgIC0tLS0tLS0tLS0gICIuTGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICRsZXR0ZXJFbmQgPSAkbGluZS5JbmRleE9mKCIgIC0tLS0tLS0tLS0gIC0tLSAgIikgKyAiICAtLS0tLS0tLS0tICAtLS0gICIuTGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICRsZXR0ZXIgPSAkbGluZS5TdWJzdHJpbmcoJGxldHRlclN0YXJ0LCAkbGV0dGVyRW5kIC0gJGxldHRlclN0YXJ0KS5UcmltKCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkbGV0dGVyLkxlbmd0aCAtZXEgMSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgQWRkT2JqZWN0VG9NYXBPZk9iamVjdEFycmF5cyAtTWFwICRWb2x1bWVUb01vdW50UG9pbnRNYXAgLUtleSAkdm9sTnVtIC1WYWx1ZSAkbGV0dGVyCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICNOb3cgZmluZCBhbGwgdGhlIG1vdW50IHBvaW50cwogICAgICAgICAgICAgICAgICAgICAgICBkbwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluZSA9ICRkaXNrRGV0YWlsc1srKyRpXQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkbGluZSAtZXEgJG51bGwgLW9yICRsaW5lLlN0YXJ0c1dpdGgoIiAgVm9sdW1lICIpIC1vciAkbGluZS5UcmltKCkuTGVuZ3RoIC1lcSAwKSAjV2UndmUgaGl0IHRoZSBuZXh0IHZvbHVtZSwgb3IgdGhlIGVuZCBvZiBhbGwgaW5mbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpLS0gI01vdmUgJGkgYmFjayBvbmUgYXMgd2UgbWF5IGhhdmUgb3ZlcnJ1biB0aGUgc3RhcnQgb2YgdGhlIG5leHQgdm9sdW1lIGluZm8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtb3VudFBvaW50ID0gJGxpbmUuVHJpbSgpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFkZE9iamVjdFRvTWFwT2ZPYmplY3RBcnJheXMgLU1hcCAkVm9sdW1lVG9Nb3VudFBvaW50TWFwIC1LZXkgJHZvbE51bSAtVmFsdWUgJG1vdW50UG9pbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKCRpIC1sdCAkZGlza0RldGFpbHMuQ291bnQpCgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCRsaW5lLkNvbnRhaW5zKCJUaGVyZSBhcmUgbm8gdm9sdW1lcy4iKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgW3N0cmluZ1tdXSRlbXB0eUFycmF5ID0gQCgpCiAgICAgICAgICAgICAgICAkRGlza1RvVm9sdW1lTWFwWyRkaXNrTnVtXSA9ICRlbXB0eUFycmF5CgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCRsaW5lLkNvbnRhaW5zKCItLS0tLS0tLS0tICAtLS0gIC0tLS0tLS0tLS0tICAtLS0tLSAgLS0tLS0tLS0tLSAgLS0tLS0tLSAgLS0tLS0tLS0tICAtLS0tLS0tLSIpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkZm91bmRWb2x1bWVzID0gJHRydWUKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gU3RyaW5nQXJyYXlUb0NvbW1hU2VwYXJhdGVkU3RyaW5nCnsKICAgIHBhcmFtKFtzdHJpbmdbXV0kQXJyYXkpCgogICAgJHN0cmluZyA9ICIiCgogICAgaWYgKCRBcnJheSAtbmUgJG51bGwgLWFuZCAkQXJyYXkuQ291bnQgLWd0IDApCiAgICB7CiAgICAgICAgJHN0cmluZyA9ICRBcnJheVswXQoKICAgICAgICBmb3IgKCRpID0gMTsgJGkgLWx0ICRBcnJheS5Db3VudDsgJGkrKykKICAgICAgICB7CiAgICAgICAgICAgICRzdHJpbmcgKz0gIiwkKCRBcnJheVskaV0pIgogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJHN0cmluZwp9CgojVGFrZXMgYSBoYXNodGFibGUsIGFuZCBhZGRzIHRoZSBnaXZlbiBrZXkgYW5kIHZhbHVlLgpmdW5jdGlvbiBBZGRPYmplY3RUb01hcE9mT2JqZWN0QXJyYXlzCnsKICAgIFBhcmFtKFtIYXNodGFibGVdJE1hcCwgJEtleSwgJFZhbHVlKQoKICAgIGlmICgkTWFwLkNvbnRhaW5zS2V5KCRLZXkpKQogICAgewogICAgICAgICRNYXBbJEtleV0gKz0gJFZhbHVlCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgW29iamVjdFtdXSRBcnJheSA9ICRWYWx1ZQogICAgICAgICRNYXBbJEtleV0gPSAkQXJyYXkKICAgIH0KfQoKI0NoZWNrcyB3aGV0aGVyIHRoZSBtb3VudCBwb2ludCBzcGVjaWZpZWQgaW4gdGhlIGdpdmVuIHBhdGggYWxyZWFkeSBleGlzdHMgYXMgYSBtb3VudCBwb2ludAojUmV0dXJucyB0aGUgdm9sdW1lIG51bWJlciBpZiBpdCBkb2VzIGV4aXN0LCBlbHNlIC0xCmZ1bmN0aW9uIE1vdW50UG9pbnRFeGlzdHMKewogICAgcGFyYW0oW3N0cmluZ10kUGF0aCkKCiAgICBmb3JlYWNoICgka2V5IGluICRnbG9iYWw6Vm9sdW1lVG9Nb3VudFBvaW50TWFwLktleXMpCiAgICB7CiAgICAgICAgZm9yZWFjaCAoJHZhbHVlIGluICRnbG9iYWw6Vm9sdW1lVG9Nb3VudFBvaW50TWFwWyRrZXldKQogICAgICAgIHsKICAgICAgICAgICAgI01ha2Ugc3VyZSBib3RoIHBhdGhzIGVuZCB3aXRoIHRoZSBzYW1lIGNoYXJhY3RlcgogICAgICAgICAgICBpZiAoKCR2YWx1ZS5FbmRzV2l0aCgiXCIpKSAtZXEgJGZhbHNlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkdmFsdWUgKz0gIlwiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoJFBhdGguRW5kc1dpdGgoIlwiKSkgLWVxICRmYWxzZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFBhdGggKz0gIlwiCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNEbyB0aGUgY29tcGFyaXNvbgogICAgICAgICAgICBpZiAoJHZhbHVlIC1saWtlICRQYXRoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gJGtleQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAtMQp9CgoKRXhwb3J0LU1vZHVsZU1lbWJlciAtRnVuY3Rpb24gKg==
