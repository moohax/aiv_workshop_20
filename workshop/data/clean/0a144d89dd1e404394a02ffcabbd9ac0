MSFT_xADGroup.psm1,757226670c1fb584fcd9bf024f1c6966,Scan result is 1. IsMalware: 0,IyBMb2NhbGl6ZWQgbWVzc2FnZXMKZGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIEAnClJvbGVOb3RGb3VuZEVycm9yICAgICAgID0gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSBQb3dlclNoZWxsIG1vZHVsZSBmb3Igcm9sZSAnezB9JyBpcyBpbnN0YWxsZWQKQWRkaW5nR3JvdXAgICAgICAgICAgICAgPSBBZGRpbmcgQUQgR3JvdXAgJ3swfScKVXBkYXRpbmdHcm91cCAgICAgICAgICAgPSBVcGRhdGluZyBBRCBHcm91cCAnezB9JwpSZW1vdmluZ0dyb3VwICAgICAgICAgICA9IFJlbW92aW5nIEFEIEdyb3VwICd7MH0nCk1vdmluZ0dyb3VwICAgICAgICAgICAgID0gTW92aW5nIEFEIEdyb3VwICd7MH0nIHRvICd7MX0nCkdyb3VwTm90Rm91bmQgICAgICAgICAgID0gQUQgR3JvdXAgJ3swfScgd2FzIG5vdCBmb3VuZApOb3REZXNpcmVkUHJvcGVydHlTdGF0ZSA9IEFEIEdyb3VwICd7MH0nIGlzIG5vdCBjb3JyZWN0LiBFeHBlY3RlZCAnezF9JywgYWN0dWFsICd7Mn0nClVwZGF0aW5nR3JvdXBQcm9wZXJ0eSAgID0gVXBkYXRpbmcgQUQgR3JvdXAgcHJvcGVydHkgJ3swfScgdG8gJ3sxfScKJ0AKfQoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnRG9tYWluTG9jYWwnLCdHbG9iYWwnLCdVbml2ZXJzYWwnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkR3JvdXBTY29wZSA9ICdHbG9iYWwnLAoKICAgICAgICBbVmFsaWRhdGVTZXQoJ1NlY3VyaXR5JywnRGlzdHJpYnV0aW9uJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJENhdGVnb3J5ID0gJ1NlY3VyaXR5JywKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwgIkFic2VudCIpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAiUHJlc2VudCIsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERlc2NyaXB0aW9uLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREaXNwbGF5TmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIKICAgICkKICAgIEFzc2VydC1Nb2R1bGUgLU1vZHVsZU5hbWUgJ0FjdGl2ZURpcmVjdG9yeSc7CiAgICAkYWRHcm91cFBhcmFtcyA9IEdldC1BRENvbW1vblBhcmFtZXRlcnMgQFBTQm91bmRQYXJhbWV0ZXJzOwogICAgdHJ5IHsKICAgICAgICAkYWRHcm91cCA9IEdldC1BREdyb3VwIEBhZEdyb3VwUGFyYW1zIC1Qcm9wZXJ0eSBOYW1lLEdyb3VwU2NvcGUsR3JvdXBDYXRlZ29yeSxEaXN0aW5ndWlzaGVkTmFtZSxEZXNjcmlwdGlvbixEaXNwbGF5TmFtZTsKICAgICAgICAkdGFyZ2V0UmVzb3VyY2UgPSBAewogICAgICAgICAgICBHcm91cE5hbWUgPSAkYWRHcm91cC5OYW1lOwogICAgICAgICAgICBHcm91cFNjb3BlID0gJGFkR3JvdXAuR3JvdXBTY29wZTsKICAgICAgICAgICAgQ2F0ZWdvcnkgPSAkYWRHcm91cC5Hcm91cENhdGVnb3J5OwogICAgICAgICAgICBQYXRoID0gR2V0LUFET2JqZWN0UGFyZW50RE4gLUROICRhZEdyb3VwLkRpc3Rpbmd1aXNoZWROYW1lOwogICAgICAgICAgICBEZXNjcmlwdGlvbiA9ICRhZEdyb3VwLkRlc2NyaXB0aW9uOwogICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICRhZEdyb3VwLkRpc3BsYXlOYW1lOwogICAgICAgICAgICBFbnN1cmUgPSAnUHJlc2VudCc7CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dIHsKICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5Hcm91cE5vdEZvdW5kIC1mICRHcm91cE5hbWUpOwogICAgICAgICR0YXJnZXRSZXNvdXJjZSA9IEB7CiAgICAgICAgICAgIEdyb3VwTmFtZSA9ICRHcm91cE5hbWU7CiAgICAgICAgICAgIEdyb3VwU2NvcGUgPSAkR3JvdXBTY29wZTsKICAgICAgICAgICAgQ2F0ZWdvcnkgPSAkQ2F0ZWdvcnk7CiAgICAgICAgICAgIFBhdGggPSAkUGF0aDsKICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAkRGVzY3JpcHRpb247CiAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJERpc3BsYXlOYW1lOwogICAgICAgICAgICBFbnN1cmUgPSAnQWJzZW50JzsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJHRhcmdldFJlc291cmNlOwp9ICNlbmQgZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRHcm91cE5hbWUsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnRG9tYWluTG9jYWwnLCdHbG9iYWwnLCdVbml2ZXJzYWwnKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkR3JvdXBTY29wZSA9ICdHbG9iYWwnLAoKICAgICAgICBbVmFsaWRhdGVTZXQoJ1NlY3VyaXR5JywnRGlzdHJpYnV0aW9uJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJENhdGVnb3J5ID0gJ1NlY3VyaXR5JywKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUGF0aCwKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwgIkFic2VudCIpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAiUHJlc2VudCIsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERlc2NyaXB0aW9uLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREaXNwbGF5TmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIKICAgICkKICAgICRhZEdyb3VwID0gR2V0LVRhcmdldFJlc291cmNlIEBQU0JvdW5kUGFyYW1ldGVyczsKICAgICR0YXJnZXRSZXNvdXJjZUluQ29tcGxpYW5jZSA9ICR0cnVlOwogICAgaWYgKCRhZEdyb3VwLkdyb3VwU2NvcGUgLW5lICRHcm91cFNjb3BlKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuTm90RGVzaXJlZFByb3BlcnR5U3RhdGUgLWYgJ0dyb3VwU2NvcGUnLCAkR3JvdXBTY29wZSwgJGFkR3JvdXAuR3JvdXBTY29wZSk7CiAgICAgICAgJHRhcmdldFJlc291cmNlSW5Db21wbGlhbmNlID0gJGZhbHNlOwogICAgfQogICAgZWxzZWlmICgkYWRHcm91cC5DYXRlZ29yeSAtbmUgJENhdGVnb3J5KSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuTm90RGVzaXJlZFByb3BlcnR5U3RhdGUgLWYgJ0NhdGVnb3J5JywgJENhdGVnb3J5LCAkYWRHcm91cC5DYXRlZ29yeSk7CiAgICAgICAgJHRhcmdldFJlc291cmNlSW5Db21wbGlhbmNlID0gJGZhbHNlOwogICAgfQogICAgZWxzZWlmICgkUGF0aCAtYW5kICgkYWRHcm91cC5QYXRoIC1uZSAkUGF0aCkpIHsKICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5Ob3REZXNpcmVkUHJvcGVydHlTdGF0ZSAtZiAnUGF0aCcsICRQYXRoLCAkYWRHcm91cC5QYXRoKTsKICAgICAgICAkdGFyZ2V0UmVzb3VyY2VJbkNvbXBsaWFuY2UgPSAkZmFsc2U7CiAgICB9CiAgICBlbHNlaWYgKCREZXNjcmlwdGlvbiAtYW5kICgkYWRHcm91cC5EZXNjcmlwdGlvbiAtbmUgJERlc2NyaXB0aW9uKSkgewogICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLk5vdERlc2lyZWRQcm9wZXJ0eVN0YXRlIC1mICdEZXNjcmlwdGlvbicsICREZXNjcmlwdGlvbiwgJGFkR3JvdXAuRGVzY3JpcHRpb24pOwogICAgICAgICR0YXJnZXRSZXNvdXJjZUluQ29tcGxpYW5jZSA9ICRmYWxzZTsKICAgIH0KICAgIGVsc2VpZiAoJERpc3BsYXlOYW1lIC1hbmQgKCRhZEdyb3VwLkRpc3BsYXlOYW1lIC1uZSAkRGlzcGxheU5hbWUpKSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuTm90RGVzaXJlZFByb3BlcnR5U3RhdGUgLWYgJ0Rpc3BsYXlOYW1lJywgJERpc3BsYXlOYW1lLCAkYWRHcm91cC5EaXNwbGF5TmFtZSk7CiAgICAgICAgJHRhcmdldFJlc291cmNlSW5Db21wbGlhbmNlID0gJGZhbHNlOwogICAgfQogICAgZWxzZWlmICgkYWRHcm91cC5FbnN1cmUgLW5lICRFbnN1cmUpIHsKICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5Ob3REZXNpcmVkUHJvcGVydHlTdGF0ZSAtZiAnRW5zdXJlJywgJEVuc3VyZSwgJGFkR3JvdXAuRW5zdXJlKTsKICAgICAgICAkdGFyZ2V0UmVzb3VyY2VJbkNvbXBsaWFuY2UgPSAkZmFsc2U7CiAgICB9CiAgICByZXR1cm4gJHRhcmdldFJlc291cmNlSW5Db21wbGlhbmNlOwp9ICNlbmQgZnVuY3Rpb24gVGVzdC1UYXJnZXRSZXNvdXJjZQoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEdyb3VwTmFtZSwKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdEb21haW5Mb2NhbCcsJ0dsb2JhbCcsJ1VuaXZlcnNhbCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRHcm91cFNjb3BlID0gJ0dsb2JhbCcsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnU2VjdXJpdHknLCdEaXN0cmlidXRpb24nKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkQ2F0ZWdvcnkgPSAnU2VjdXJpdHknLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRQYXRoLAoKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCAiQWJzZW50IildCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEVuc3VyZSA9ICJQcmVzZW50IiwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGVzY3JpcHRpb24sCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERpc3BsYXlOYW1lLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbCwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlcgogICAgKQogICAgQXNzZXJ0LU1vZHVsZSAtTW9kdWxlTmFtZSAnQWN0aXZlRGlyZWN0b3J5JzsKICAgICRhZEdyb3VwUGFyYW1zID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyBAUFNCb3VuZFBhcmFtZXRlcnM7CiAgICAKICAgIHRyeSB7CiAgICAgICAgJGFkR3JvdXAgPSBHZXQtQURHcm91cCBAYWRHcm91cFBhcmFtcyAtUHJvcGVydHkgTmFtZSxHcm91cFNjb3BlLEdyb3VwQ2F0ZWdvcnksRGlzdGluZ3Vpc2hlZE5hbWUsRGVzY3JpcHRpb24sRGlzcGxheU5hbWU7CgogICAgICAgIGlmICgkRW5zdXJlIC1lcSAnUHJlc2VudCcpIHsKCiAgICAgICAgICAgICRzZXRBREdyb3VwUGFyYW1zID0gQHt9OwoKICAgICAgICAgICAgIyBVcGRhdGUgZXhpc3RpbmcgZ3JvdXAgcHJvcGVydGllcwogICAgICAgICAgICBpZiAoJENhdGVnb3J5IC1uZSAkYWRHcm91cC5Hcm91cENhdGVnb3J5KSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5VcGRhdGluZ0dyb3VwUHJvcGVydHkgLWYgJ0NhdGVnb3J5JywgJENhdGVnb3J5KTsKICAgICAgICAgICAgICAgICRzZXRBREdyb3VwUGFyYW1zWydDYXRlZ29yeSddID0gJENhdGVncm9yeTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJEdyb3VwU2NvcGUgLW5lICRhZEdyb3VwLkdyb3VwU2NvcGUpIHsKICAgICAgICAgICAgICAgICMjIENhbm5vdCBjaGFuZ2UgRG9tYWluTG9jYWwgdG8gR2xvYmFsIG9yIHZpY2UgdmVyc2EuIE5lZWQgdG8gY2hhbmdlIHRoZW0gdG8gVW5pdmVyc2FsIGdyb3VwcyBmaXJzdCEKICAgICAgICAgICAgICAgIFNldC1BREdyb3VwIC1JZGVudGl0eSAkYWRHcm91cC5EaXN0aW5ndWlzaGVkTmFtZSAtR3JvdXBTY29wZSBVbml2ZXJzYWw7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5VcGRhdGluZ0dyb3VwUHJvcGVydHkgLWYgJ0dyb3VwU2NvcGUnLCAkR3JvdXBTY29wZSk7CiAgICAgICAgICAgICAgICAkc2V0QURHcm91cFBhcmFtc1snR3JvdXBTY29wZSddID0gJEdyb3VwU2NvcGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCREZXNjcmlwdGlvbiAtYW5kICgkRGVzY3JpcHRpb24gLW5lICRhZEdyb3VwLkRlc2NyaXB0aW9uKSkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuVXBkYXRpbmdHcm91cFByb3BlcnR5IC1mICdEZXNjcmlwdGlvbicsICREZXNjcmlwdGlvbik7CiAgICAgICAgICAgICAgICAkc2V0QURHcm91cFBhcmFtc1snRGVzY3JpcHRpb24nXSA9ICREZXNjcmlwdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJERpc3BsYXlOYW1lIC1hbmQgKCREaXNwbGF5TmFtZSAtbmUgJGFkR3JvdXAuRGlzcGxheU5hbWUpKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5VcGRhdGluZ0dyb3VwUHJvcGVydHkgLWYgJ0Rpc3BsYXlOYW1lJywgJERpc3BsYXlOYW1lKTsKICAgICAgICAgICAgICAgICRzZXRBREdyb3VwUGFyYW1zWydEaXNwbGF5TmFtZSddID0gJERpc3BsYXlOYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgKCRMb2NhbGl6ZWREYXRhLlVwZGF0aW5nR3JvdXAgLWYgJEdyb3VwTmFtZSk7CiAgICAgICAgICAgIFNldC1BREdyb3VwIC1JZGVudGl0eSAkYWRHcm91cC5EaXN0aW5ndWlzaGVkTmFtZSBAc2V0QURHcm91cFBhcmFtczsKCiAgICAgICAgICAgICMgTW92ZSBncm91cCBpZiB0aGUgcGF0aCBpcyBub3QgY29ycmVjdAogICAgICAgICAgICBpZiAoJFBhdGggLWFuZCAoJFBhdGggLW5lIChHZXQtQURPYmplY3RQYXJlbnRETiAtRE4gJGFkR3JvdXAuRGlzdGluZ3Vpc2hlZE5hbWUpKSkgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuTW92aW5nR3JvdXAgLWYgJEdyb3VwTmFtZSwgJFBhdGgpOwogICAgICAgICAgICAgICAgTW92ZS1BRE9iamVjdCAtSWRlbnRpdHkgJGFkR3JvdXAuRGlzdGluZ3Vpc2hlZE5hbWUgLVRhcmdldFBhdGggJFBhdGg7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoJEVuc3VyZSAtZXEgJ0Fic2VudCcpIHsKICAgICAgICAgICAgIyBSZW1vdmUgZXhpc3RpbmcgZ3JvdXAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoJExvY2FsaXplZERhdGEuUmVtb3ZpbmdHcm91cCAtZiAkR3JvdXBOYW1lKTsKICAgICAgICAgICAgUmVtb3ZlLUFER3JvdXAgQGFkR3JvdXBQYXJhbXMgLUNvbmZpcm06JGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgIGNhdGNoIFtNaWNyb3NvZnQuQWN0aXZlRGlyZWN0b3J5Lk1hbmFnZW1lbnQuQURJZGVudGl0eU5vdEZvdW5kRXhjZXB0aW9uXSB7CiAgICAgICAgIyMgVGhlIEFEIGdyb3VwIGRvZXNuJ3QgZXhpc3QKICAgICAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKSB7CgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5Hcm91cE5vdEZvdW5kIC1mICRHcm91cE5hbWUpOwogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgkTG9jYWxpemVkRGF0YS5BZGRpbmdHcm91cCAtZiAkR3JvdXBOYW1lKTsKCiAgICAgICAgICAgICRhZEdyb3VwUGFyYW1zID0gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyBAUFNCb3VuZFBhcmFtZXRlcnMgLVVzZU5hbWVQYXJhbWV0ZXI7CiAgICAgICAgICAgIGlmICgkRGVzY3JpcHRpb24pIHsKICAgICAgICAgICAgICAgICRhZEdyb3VwUGFyYW1zWydEZXNjcmlwdGlvbiddID0gJERlc2NyaXB0aW9uOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkRGlzcGxheU5hbWUpIHsKICAgICAgICAgICAgICAgICRhZEdyb3VwUGFyYW1zWydEaXNwbGF5TmFtZSddID0gJERpc3BsYXlOYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkUGF0aCkgewogICAgICAgICAgICAgICAgJGFkR3JvdXBQYXJhbXNbJ1BhdGgnXSA9ICRQYXRoOwogICAgICAgICAgICB9CiAgICAgICAgICAgICMjIENyZWF0ZSBncm91cAogICAgICAgICAgICBOZXctQURHcm91cCBAYWRHcm91cFBhcmFtcyAtR3JvdXBDYXRlZ29yeSAkQ2F0ZWdvcnkgLUdyb3VwU2NvcGUgJEdyb3VwU2NvcGU7CgogICAgICAgIH0KICAgIH0gI2VuZCBjYXRjaAp9ICNlbmQgZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCgojIEludGVybmFsIGZ1bmN0aW9uIHRvIGFzc2VydCBpZiB0aGUgcm9sZSBzcGVjaWZpYyBtb2R1bGUgaXMgaW5zdGFsbGVkIG9yIG5vdApmdW5jdGlvbiBBc3NlcnQtTW9kdWxlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbSAoCiAgICAgICAgW1N5c3RlbS5TdHJpbmddICRNb2R1bGVOYW1lID0gJ0FjdGl2ZURpcmVjdG9yeScKICAgICkKCiAgICBpZiAoLW5vdCAoR2V0LU1vZHVsZSAtTmFtZSAkTW9kdWxlTmFtZSAtTGlzdEF2YWlsYWJsZSkpCiAgICB7CiAgICAgICAgJGVycm9yTXNnID0gJCgkTG9jYWxpemVkRGF0YS5Sb2xlTm90Rm91bmRFcnJvcikgLWYgJG1vZHVsZU5hbWU7CiAgICAgICAgJGV4Y2VwdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gJGVycm9yTWVzc2FnZTsKICAgICAgICAkZXJyb3JSZWNvcmQgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JSZWNvcmQgJGV4Y2VwdGlvbiwgJGVycm9ySWQsICRlcnJvckNhdGVnb3J5LCAkbnVsbDsKICAgICAgICB0aHJvdyAkZXJyb3JSZWNvcmQ7CiAgICB9Cn0gI2VuZCBmdW5jdGlvbiBBc3NlcnQtTW9kdWxlCgojIEludGVybmFsIGZ1bmN0aW9uIHRvIGdldCBhbiBBY3RpdmUgRGlyZWN0b3J5IG9iamVjdCdzIHBhcmVudCBEaXN0aW5ndWlzaGVkIE5hbWUKZnVuY3Rpb24gR2V0LUFET2JqZWN0UGFyZW50RE4gewogICAgIyBodHRwczovL3d3dy51dm0uZWR1L35nY2QvMjAxMi8wNy9saXN0aW5nLXBhcmVudC1vZi1hZC1vYmplY3QtaW4tcG93ZXJzaGVsbC8KICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5KV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRE4KICAgICkKICAgICRkaXN0aW5ndWlzaGVkTmFtZVBhcnRzID0gJEROIC1zcGxpdCAnKD88IVtcXF0pLCc7CiAgICAkZGlzdGluZ3Vpc2hlZE5hbWVQYXJ0c1sxLi4kKCRkaXN0aW5ndWlzaGVkTmFtZVBhcnRzLkNvdW50LTEpXSAtam9pbiAnLCc7Cn0KCiMgSW50ZXJuYWwgZnVuY3Rpb24gdG8gYnVpbGQgY29tbW9uIHBhcmFtZXRlcnMgZm9yIHRoZSBBY3RpdmUgRGlyZWN0b3J5IGNtZGxldHMKZnVuY3Rpb24gR2V0LUFEQ29tbW9uUGFyYW1ldGVycyB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkR3JvdXBOYW1lLAoKICAgICAgICBbVmFsaWRhdGVTZXQoJ0RvbWFpbkxvY2FsJywnR2xvYmFsJywnVW5pdmVyc2FsJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEdyb3VwU2NvcGUgPSAnR2xvYmFsJywKCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdTZWN1cml0eScsJ0Rpc3RyaWJ1dGlvbicpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRDYXRlZ29yeSA9ICdTZWN1cml0eScsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsICJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREZXNjcmlwdGlvbiwKCiAgICAgICAgW1ZhbGlkYXRlTm90TnVsbE9yRW1wdHkoKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGlzcGxheU5hbWUsCgogICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsLAoKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3dpdGNoXQogICAgICAgICRVc2VOYW1lUGFyYW1ldGVyCiAgICApCiAgICAjIyBUaGUgR2V0LUFER3JvdXAgYW5kIFNldC1BREdyb3VwIHBhcmFtZXRlcnMgdGFrZSBhbiAtSWRlbnRpdHkgcGFyYW1ldGVyLCBidXQgdGhlIE5ldy1BREdyb3VwIGNtZGxldCB1c2VzIHRoZSAtTmFtZSBwYXJhbWV0ZXIKICAgIGlmICgkVXNlTmFtZVBhcmFtZXRlcikgewogICAgICAgICRhZEdyb3VwQ29tbW9uUGFyYW1ldGVycyA9IEB7IE5hbWUgPSAkR3JvdXBOYW1lOyB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkYWRHcm91cENvbW1vblBhcmFtZXRlcnMgPSBAeyBJZGVudGl0eSA9ICRHcm91cE5hbWU7IH0KICAgIH0KCiAgICBpZiAoJENyZWRlbnRpYWwpIHsKICAgICAgICAkYWRHcm91cENvbW1vblBhcmFtZXRlcnNbJ0NyZWRlbnRpYWwnXSA9ICRDcmVkZW50aWFsOwogICAgfQogICAgaWYgKCREb21haW5Db250cm9sbGVyKSB7CiAgICAgICAgJGFkR3JvdXBDb21tb25QYXJhbWV0ZXJzWydTZXJ2ZXInXSA9ICREb21haW5Db250cm9sbGVyOwogICAgfQogICAgcmV0dXJuICRhZEdyb3VwQ29tbW9uUGFyYW1ldGVyczsKfSAjZW5kIGZ1bmN0aW9uIEdldC1BRENvbW1vblBhcmFtZXRlcnMKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U7Cg==
