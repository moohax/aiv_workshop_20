MSFT_xFileSystemAccessRule.psm1,be24f762aba1dea5d094fe0c31075d83,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXSAKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgJElkZW50aXR5LAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW1N0cmluZ1tdXQogICAgICAgIFtWYWxpZGF0ZVNldCgiTGlzdERpcmVjdG9yeSIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkRGF0YSIsCiAgICAgICAgICAgICAgICAgICAgICJXcml0ZURhdGEiLAogICAgICAgICAgICAgICAgICAgICAiQ3JlYXRlRmlsZXMiLAogICAgICAgICAgICAgICAgICAgICAiQ3JlYXRlRGlyZWN0b3JpZXMiLAogICAgICAgICAgICAgICAgICAgICAiQXBwZW5kRGF0YSIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkRXh0ZW5kZWRBdHRyaWJ1dGVzIiwKICAgICAgICAgICAgICAgICAgICAgIldyaXRlRXh0ZW5kZWRBdHRyaWJ1dGVzIiwKICAgICAgICAgICAgICAgICAgICAgIlRyYXZlcnNlIiwKICAgICAgICAgICAgICAgICAgICAgIkV4ZWN1dGVGaWxlIiwKICAgICAgICAgICAgICAgICAgICAgIkRlbGV0ZVN1YmRpcmVjdG9yaWVzQW5kRmlsZXMiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZEF0dHJpYnV0ZXMiLAogICAgICAgICAgICAgICAgICAgICAiV3JpdGVBdHRyaWJ1dGVzIiwKICAgICAgICAgICAgICAgICAgICAgIldyaXRlIiwKICAgICAgICAgICAgICAgICAgICAgIkRlbGV0ZSIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkUGVybWlzc2lvbnMiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZCIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkQW5kRXhlY3V0ZSIsCiAgICAgICAgICAgICAgICAgICAgICJNb2RpZnkiLAogICAgICAgICAgICAgICAgICAgICAiQ2hhbmdlUGVybWlzc2lvbnMiLAogICAgICAgICAgICAgICAgICAgICAiVGFrZU93bmVyc2hpcCIsCiAgICAgICAgICAgICAgICAgICAgICJTeW5jaHJvbml6ZSIsCiAgICAgICAgICAgICAgICAgICAgICJGdWxsQ29udHJvbCIpXQogICAgICAgICRSaWdodHMsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgIFtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXQogICAgICAgICRFbnN1cmUgPSAiUHJlc2VudCIKICAgICkKICAgIAogICAgaWYgKChUZXN0LVBhdGggLVBhdGggJFBhdGgpIC1lcSAkZmFsc2UpCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBnZXQgQUNMIGZvciAnJFBhdGgnIGFzIGl0IGRvZXMgbm90IGV4aXN0IgogICAgfQoKICAgICRhY2wgPSBHZXQtQWNsIC1QYXRoICRQYXRoCiAgICAkYWNjZXNzUnVsZXMgPSAkYWNsLkFjY2VzcwoKICAgICRpZGVudGl0eVJ1bGUgPSAkYWNjZXNzUnVsZXMgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7CiAgICAgICAgJF8uSWRlbnRpdHlSZWZlcmVuY2UgLWVxICRJZGVudGl0eQogICAgfSB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDEKCiAgICBpZiAoJG51bGwgLWVxICRpZGVudGl0eVJ1bGUpCiAgICB7CiAgICAgICAgcmV0dXJuIEB7CiAgICAgICAgICAgIFBhdGggPSAkUGF0aAogICAgICAgICAgICBJZGVudGl0eSA9ICRJZGVudGl0eQogICAgICAgICAgICBSaWdodHMgPSBAKCkKICAgICAgICAgICAgRW5zdXJlID0gIkFic2VudCIKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gQHsKICAgICAgICBQYXRoID0gJFBhdGgKICAgICAgICBJZGVudGl0eSA9ICRJZGVudGl0eQogICAgICAgIFJpZ2h0cyA9ICRpZGVudGl0eVJ1bGUuRmlsZVN5c3RlbVJpZ2h0cy5Ub1N0cmluZygpIC1zcGxpdCAiLCAiCiAgICAgICAgRW5zdXJlID0gIlByZXNlbnQiCiAgICB9Cn0KCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkUGF0aCwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICAkSWRlbnRpdHksCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJGZhbHNlKV0KICAgICAgICBbU3RyaW5nW11dCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJMaXN0RGlyZWN0b3J5IiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWREYXRhIiwKICAgICAgICAgICAgICAgICAgICAgIldyaXRlRGF0YSIsCiAgICAgICAgICAgICAgICAgICAgICJDcmVhdGVGaWxlcyIsCiAgICAgICAgICAgICAgICAgICAgICJDcmVhdGVEaXJlY3RvcmllcyIsCiAgICAgICAgICAgICAgICAgICAgICJBcHBlbmREYXRhIiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWRFeHRlbmRlZEF0dHJpYnV0ZXMiLAogICAgICAgICAgICAgICAgICAgICAiV3JpdGVFeHRlbmRlZEF0dHJpYnV0ZXMiLAogICAgICAgICAgICAgICAgICAgICAiVHJhdmVyc2UiLAogICAgICAgICAgICAgICAgICAgICAiRXhlY3V0ZUZpbGUiLAogICAgICAgICAgICAgICAgICAgICAiRGVsZXRlU3ViZGlyZWN0b3JpZXNBbmRGaWxlcyIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkQXR0cmlidXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICJXcml0ZUF0dHJpYnV0ZXMiLAogICAgICAgICAgICAgICAgICAgICAiV3JpdGUiLAogICAgICAgICAgICAgICAgICAgICAiRGVsZXRlIiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWRQZXJtaXNzaW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICJSZWFkIiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWRBbmRFeGVjdXRlIiwKICAgICAgICAgICAgICAgICAgICAgIk1vZGlmeSIsCiAgICAgICAgICAgICAgICAgICAgICJDaGFuZ2VQZXJtaXNzaW9ucyIsCiAgICAgICAgICAgICAgICAgICAgICJUYWtlT3duZXJzaGlwIiwKICAgICAgICAgICAgICAgICAgICAgIlN5bmNocm9uaXplIiwKICAgICAgICAgICAgICAgICAgICAgIkZ1bGxDb250cm9sIildCiAgICAgICAgJFJpZ2h0cywKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTdHJpbmddCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildCiAgICAgICAgJEVuc3VyZSA9ICJQcmVzZW50IgogICAgKQoKICAgIGlmICgoVGVzdC1QYXRoIC1QYXRoICRQYXRoKSAtZXEgJGZhbHNlKQogICAgewogICAgICAgIHRocm93ICJVbmFibGUgdG8gZ2V0IEFDTCBmb3IgJyRQYXRoJyBhcyBpdCBkb2VzIG5vdCBleGlzdCIKICAgIH0KCiAgICAkYWNsID0gR2V0LUFjbCAtUGF0aCAkUGF0aAogICAgJGFjY2Vzc1J1bGVzID0gJGFjbC5BY2Nlc3MKCiAgICBpZiAoJEVuc3VyZSAtZXEgIlByZXNlbnQiKQogICAgewogICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgIlNldHRpbmcgYWNjZXNzIHJ1bGVzIGZvciAkSWRlbnRpdHkgb24gJFBhdGgiCiAgICAgICAgJG5ld1JpZ2h0cyA9IFtTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5GaWxlU3lzdGVtUmlnaHRzXSRSaWdodHMKICAgICAgICAkYXIgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uU2VjdXJpdHkuQWNjZXNzQ29udHJvbC5GaWxlU3lzdGVtQWNjZXNzUnVsZSBgCiAgICAgICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRMaXN0IEAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJElkZW50aXR5LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbmV3UmlnaHRzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29udGFpbmVySW5oZXJpdCxPYmplY3RJbmhlcml0IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vbmUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQWxsb3ciKQogICAgICAgICRhY2wuU2V0QWNjZXNzUnVsZSgkYXIpCgogICAgICAgIFNldC1BY2wgLVBhdGggJFBhdGggLUFjbE9iamVjdCAkYWNsCgogICAgfQoKICAgIGlmICgkRW5zdXJlIC1lcSAiQWJzZW50IikKICAgIHsKICAgICAgICAkaWRlbnRpdHlSdWxlID0gJGFjY2Vzc1J1bGVzIHwgV2hlcmUtT2JqZWN0IC1GaWx0ZXJTY3JpcHQgewogICAgICAgICAgICAkXy5JZGVudGl0eVJlZmVyZW5jZSAtZXEgJElkZW50aXR5CiAgICAgICAgfSB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDEKCiAgICAgICAgaWYgKCRudWxsIC1uZSAkaWRlbnRpdHlSdWxlKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiUmVtb3ZpbmcgYWNjZXNzIHJ1bGVzIGZvciAkSWRlbnRpdHkgb24gJFBhdGgiCiAgICAgICAgICAgICRhY2wuUmVtb3ZlQWNjZXNzUnVsZSgkaWRlbnRpdHlSdWxlKSB8IE91dC1OdWxsCiAgICAgICAgICAgIFNldC1BY2wgLVBhdGggJFBhdGggLUFjbE9iamVjdCAkYWNsCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0gCiAgICBwYXJhbSgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3RyaW5nXQogICAgICAgICRJZGVudGl0eSwKCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXQogICAgICAgIFtTdHJpbmdbXV0KICAgICAgICBbVmFsaWRhdGVTZXQoIkxpc3REaXJlY3RvcnkiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZERhdGEiLAogICAgICAgICAgICAgICAgICAgICAiV3JpdGVEYXRhIiwKICAgICAgICAgICAgICAgICAgICAgIkNyZWF0ZUZpbGVzIiwKICAgICAgICAgICAgICAgICAgICAgIkNyZWF0ZURpcmVjdG9yaWVzIiwKICAgICAgICAgICAgICAgICAgICAgIkFwcGVuZERhdGEiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZEV4dGVuZGVkQXR0cmlidXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICJXcml0ZUV4dGVuZGVkQXR0cmlidXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICJUcmF2ZXJzZSIsCiAgICAgICAgICAgICAgICAgICAgICJFeGVjdXRlRmlsZSIsCiAgICAgICAgICAgICAgICAgICAgICJEZWxldGVTdWJkaXJlY3Rvcmllc0FuZEZpbGVzIiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWRBdHRyaWJ1dGVzIiwKICAgICAgICAgICAgICAgICAgICAgIldyaXRlQXR0cmlidXRlcyIsCiAgICAgICAgICAgICAgICAgICAgICJXcml0ZSIsCiAgICAgICAgICAgICAgICAgICAgICJEZWxldGUiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZFBlcm1pc3Npb25zIiwKICAgICAgICAgICAgICAgICAgICAgIlJlYWQiLAogICAgICAgICAgICAgICAgICAgICAiUmVhZEFuZEV4ZWN1dGUiLAogICAgICAgICAgICAgICAgICAgICAiTW9kaWZ5IiwKICAgICAgICAgICAgICAgICAgICAgIkNoYW5nZVBlcm1pc3Npb25zIiwKICAgICAgICAgICAgICAgICAgICAgIlRha2VPd25lcnNoaXAiLAogICAgICAgICAgICAgICAgICAgICAiU3luY2hyb25pemUiLAogICAgICAgICAgICAgICAgICAgICAiRnVsbENvbnRyb2wiKV0KICAgICAgICAkUmlnaHRzLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW1N0cmluZ10KICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiCiAgICApCgogICAgJEN1cnJlbnRWYWx1ZXMgPSBHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzCgogICAgaWYgKCRudWxsIC1lcSAkQ3VycmVudFZhbHVlcykgCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBkZXRlcm1pbmUgY3VycmVudCBBQ0wgdmFsdWVzIGZvciAnJFBhdGgnIgogICAgfQoKICAgIGlmICgkQ3VycmVudFZhbHVlcy5FbnN1cmUgLW5lICRFbnN1cmUpCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAiRW5zdXJlIHByb3BlcnR5IGRvZXMgbm90IG1hdGNoIgogICAgICAgIHJldHVybiAkZmFsc2UKICAgIH0KCiAgICBpZiAoJEVuc3VyZSAtZXEgIlByZXNlbnQiKQogICAgewogICAgICAgICRyaWdodHNDb21wYXJlID0gQ29tcGFyZS1PYmplY3QgLVJlZmVyZW5jZU9iamVjdCAkQ3VycmVudFZhbHVlcy5SaWdodHMgYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLURpZmZlcmVuY2VPYmplY3QgJFJpZ2h0cwogICAgICAgIGlmICgkbnVsbCAtbmUgJHJpZ2h0c0NvbXBhcmUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICJSaWdodHMgcHJvcGVydHkgZG9lcyBub3QgbWF0Y2giCiAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuICR0cnVlCn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UK
