MSFT_xSQLServerDatabaseRole.psm1,0c048eb30de796df193fda6b9b042e96,Scan result is 1. IsMalware: 0,JGN1cnJlbnRQYXRoID0gU3BsaXQtUGF0aCAtUGFyZW50ICRNeUludm9jYXRpb24uTXlDb21tYW5kLlBhdGgKV3JpdGUtRGVidWcgLU1lc3NhZ2UgIkN1cnJlbnRQYXRoOiAkY3VycmVudFBhdGgiCgojIExvYWQgQ29tbW9uIENvZGUKSW1wb3J0LU1vZHVsZSAkY3VycmVudFBhdGhcLi5cLi5ceFNRTFNlcnZlckhlbHBlci5wc20xIC1WZXJib3NlOiRmYWxzZSAtRXJyb3JBY3Rpb24gU3RvcAoKIyBEU0MgcmVzb3VyY2UgdG8gbWFuYWdlIFNRTCBkYXRhYmFzZSByb2xlcwoKIyBOT1RFOiBUaGlzIHJlc291cmNlIHJlcXVpcmVzIFdNRjUgYW5kIFBzRHNjUnVuQXNDcmVkZW50aWFsCgpmdW5jdGlvbiBDb25uZWN0U1FMCnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFNRTFNlcnZlciA9ICRlbnY6Q09NUFVURVJOQU1FLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lID0gIk1TU1FMU0VSVkVSIgogICAgKQogICAgCiAgICAkbnVsbCA9IFtTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ01pY3Jvc29mdC5TcWxTZXJ2ZXIuU21vJykKICAgIAogICAgaWYoJFNRTEluc3RhbmNlTmFtZSAtZXEgIk1TU1FMU0VSVkVSIikKICAgIHsKICAgICAgICAkQ29ubmVjdFNRTCA9ICRTUUxTZXJ2ZXIKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkQ29ubmVjdFNRTCA9ICIkU1FMU2VydmVyXCRTUUxJbnN0YW5jZU5hbWUiCiAgICB9CgogICAgV3JpdGUtVmVyYm9zZSAiQ29ubmVjdGluZyB0byBTUUwgJENvbm5lY3RTUUwiCiAgICAkU1FMID0gTmV3LU9iamVjdCBNaWNyb3NvZnQuU3FsU2VydmVyLk1hbmFnZW1lbnQuU21vLlNlcnZlciAkQ29ubmVjdFNRTAoKICAgIGlmKCRTUUwpCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ29ubmVjdGVkIHRvIFNRTCAkQ29ubmVjdFNRTCIKICAgICAgICAkU1FMCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIGNvbm5lY3RpbmcgdG8gU1FMICRDb25uZWN0U1FMIgogICAgfQp9CgoKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFNRTFNlcnZlciA9ICRlbnY6Q09NUFVURVJOQU1FLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lID0gIk1TU1FMU0VSVkVSIiwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERhdGFiYXNlLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUm9sZQogICAgKQoKICAgIGlmKCEkU1FMKQogICAgewogICAgICAgICRTUUwgPSBDb25uZWN0U1FMIC1TUUxTZXJ2ZXIgJFNRTFNlcnZlciAtU1FMSW5zdGFuY2VOYW1lICRTUUxJbnN0YW5jZU5hbWUKICAgIH0KCiAgICBpZigkU1FMKQogICAgewogICAgICAgICMgQ2hlY2sgZGF0YWJhc2UgZXhpc3RzCiAgICAgICAgaWYoISgkU1FMRGF0YWJhc2UgPSAkU1FMLkRhdGFiYXNlc1skRGF0YWJhc2VdKSkKICAgICAgICB7CiAgICAgICAgICAgIHRocm93IE5ldy1UZXJtaW5hdGluZ0Vycm9yIC1FcnJvclR5cGUgTm9EYXRhYmFzZSAtRm9ybWF0QXJncyBAKCREYXRhYmFzZSwkU1FMU2VydmVyLCRTUUxJbnN0YW5jZU5hbWUpIC1FcnJvckNhdGVnb3J5IE9iamVjdE5vdEZvdW5kCiAgICAgICAgfQoKICAgICAgICAjIENoZWNrIHJvbGUgZXhpc3RzCiAgICAgICAgaWYoISgkU1FMRGF0YWJhc2UuUm9sZXNbJFJvbGVdKSkKICAgICAgICB7CiAgICAgICAgICAgIHRocm93IE5ldy1UZXJtaW5hdGluZ0Vycm9yIC1FcnJvclR5cGUgUm9sZU5vdEZvdW5kIC1Gb3JtYXRBcmdzIEAoJFJvbGUsJERhdGFiYXNlLCRTUUxTZXJ2ZXIsJFNRTEluc3RhbmNlTmFtZSkgLUVycm9yQ2F0ZWdvcnkgT2JqZWN0Tm90Rm91bmQKICAgICAgICB9CgogICAgICAgICMgQ2hlY2sgbG9naW4gZXhpc3RzCiAgICAgICAgaWYoISgkU1FMTG9naW4gPSAkU1FMLkxvZ2luc1skTmFtZV0pKQogICAgICAgIHsKICAgICAgICAgICAgdGhyb3cgTmV3LVRlcm1pbmF0aW5nRXJyb3IgLUVycm9yVHlwZSBMb2dpbk5vdEZvdW5kIC1Gb3JtYXRBcmdzIEAoJE5hbWUsJFNRTFNlcnZlciwkU1FMSW5zdGFuY2VOYW1lKSAtRXJyb3JDYXRlZ29yeSBPYmplY3ROb3RGb3VuZAogICAgICAgIH0KCiAgICAgICAgaWYoJFNRTERhdGFiYXNlVXNlciA9ICRTUUxEYXRhYmFzZS5Vc2Vyc1skTmFtZV0pCiAgICAgICAgewogICAgICAgICAgICBpZigkU1FMRGF0YWJhc2VVc2VyLklzTWVtYmVyKCRSb2xlKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU1FMIGxvZ2luICROYW1lIGlzIGEgbWVtYmVyIG9mIHJvbGUgJFJvbGUgb24gZGF0YWJhc2UgJERhdGFiYXNlIG9uICRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlTmFtZSIKICAgICAgICAgICAgICAgICRFbnN1cmUgPSAiUHJlc2VudCIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNRTCBsb2dpbiAkTmFtZSBpcyBub3QgYSBtZW1iZXIgb2Ygcm9sZSAkUm9sZSBvbiBkYXRhYmFzZSAkRGF0YWJhc2Ugb24gJFNRTFNlcnZlclwkU1FMSW5zdGFuY2VOYW1lIgogICAgICAgICAgICAgICAgJEVuc3VyZSA9ICJBYnNlbnQiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU1FMIGxvZ2luICROYW1lIGlzIG5vdCBhIHVzZXIgb2YgZGF0YWJhc2UgJERhdGFiYXNlIG9uICRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlTmFtZSIKICAgICAgICAgICAgJEVuc3VyZSA9ICJBYnNlbnQiCiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgICRFbnN1cmUgPSAiQWJzZW50IgogICAgfQoKICAgICRyZXR1cm5WYWx1ZSA9IEB7CiAgICAgICAgRW5zdXJlID0gJEVuc3VyZQogICAgICAgIE5hbWUgPSAkTmFtZQogICAgICAgIFNRTFNlcnZlciA9ICRTUUxTZXJ2ZXIKICAgICAgICBTUUxJbnN0YW5jZU5hbWUgPSAkU1FMSW5zdGFuY2VOYW1lCiAgICAgICAgRGF0YWJhc2UgPSAkRGF0YWJhc2UKICAgICAgICBSb2xlID0gJFJvbGUKICAgIH0KCiAgICAkcmV0dXJuVmFsdWUKfQoKCmZ1bmN0aW9uIFNldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0KICAgICgKICAgICAgICBbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRW5zdXJlID0gIlByZXNlbnQiLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkTmFtZSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFNRTFNlcnZlciA9ICRlbnY6Q09NUFVURVJOQU1FLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkU1FMSW5zdGFuY2VOYW1lID0gIk1TU1FMU0VSVkVSIiwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERhdGFiYXNlLAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkUm9sZQogICAgKQoKICAgIGlmKCEkU1FMKQogICAgewogICAgICAgICRTUUwgPSBDb25uZWN0U1FMIC1TUUxTZXJ2ZXIgJFNRTFNlcnZlciAtU1FMSW5zdGFuY2VOYW1lICRTUUxJbnN0YW5jZU5hbWUKICAgIH0KCiAgICBpZigkU1FMKQogICAgewogICAgICAgICRTUUxEYXRhYmFzZSA9ICRTUUwuRGF0YWJhc2VzWyREYXRhYmFzZV0KICAgICAgICAkU1FMRGF0YWJhc2VSb2xlID0gJFNRTERhdGFiYXNlLlJvbGVzWyRSb2xlXQogICAgICAgIHN3aXRjaCgkRW5zdXJlKQogICAgICAgIHsKICAgICAgICAgICAgIlByZXNlbnQiCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKCEkU1FMRGF0YWJhc2UuVXNlcnNbJE5hbWVdKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQWRkaW5nIFNRTCBsb2dpbiAkTmFtZSBhcyBhIHVzZXIgb2YgZGF0YWJhc2UgJERhdGFiYXNlIG9uICRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlTmFtZSIKICAgICAgICAgICAgICAgICAgICAgICAgJFNRTERhdGFiYXNlVXNlciA9IE5ldy1PYmplY3QgTWljcm9zb2Z0LlNxbFNlcnZlci5NYW5hZ2VtZW50LlNtby5Vc2VyICRTUUxEYXRhYmFzZSwkTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAkU1FMRGF0YWJhc2VVc2VyLkxvZ2luID0gJE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgJFNRTERhdGFiYXNlVXNlci5DcmVhdGUoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIGFkZGluZyBTUUwgbG9naW4gJE5hbWUgYXMgYSB1c2VyIG9mIGRhdGFiYXNlICREYXRhYmFzZSBvbiAkU1FMU2VydmVyXCRTUUxJbnN0YW5jZU5hbWUiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoJFNRTERhdGFiYXNlLlVzZXJzWyROYW1lXSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0cnkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkFkZGluZyBTUUwgbG9naW4gJE5hbWUgdG8gcm9sZSAkUm9sZSBvbiBkYXRhYmFzZSAkRGF0YWJhc2Ugb24gJFNRTFNlcnZlclwkU1FMSW5zdGFuY2VOYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAkU1FMRGF0YWJhc2VSb2xlLkFkZE1lbWJlcigkTmFtZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2gKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCBhZGRpbmcgU1FMIGxvZ2luICROYW1lIHRvIHJvbGUgJFJvbGUgb24gZGF0YWJhc2UgJERhdGFiYXNlIG9uICRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlTmFtZSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgIkFic2VudCIKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiUmVtb3ZpbmcgU1FMIGxvZ2luICROYW1lIGZyb20gcm9sZSAkUm9sZSBvbiBkYXRhYmFzZSAkRGF0YWJhc2Ugb24gJFNRTFNlcnZlclwkU1FMSW5zdGFuY2VOYW1lIgogICAgICAgICAgICAgICAgICAgICRTUUxEYXRhYmFzZVJvbGUuRHJvcE1lbWJlcigkTmFtZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRmFpbGVkIHJlbW92aW5nIFNRTCBsb2dpbiAkTmFtZSBmcm9tIHJvbGUgJFJvbGUgb24gZGF0YWJhc2UgJERhdGFiYXNlIG9uICRTUUxTZXJ2ZXJcJFNRTEluc3RhbmNlTmFtZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAjIyMgVE9ETyB1cGRhdGUgd2l0aCBsb2NhbGl6ZWQgaGVscGVyCiAgICBpZighKFRlc3QtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzKSkKICAgIHsKICAgICAgICB0aHJvdyBOZXctVGVybWluYXRpbmdFcnJvciAtRXJyb3JUeXBlIFRlc3RGYWlsZWRBZnRlclNldCAtRXJyb3JDYXRlZ29yeSBJbnZhbGlkUmVzdWx0CiAgICB9Cn0KCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW1ZhbGlkYXRlU2V0KCJQcmVzZW50IiwiQWJzZW50IildCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEVuc3VyZSA9ICJQcmVzZW50IiwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJE5hbWUsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRTUUxTZXJ2ZXIgPSAkZW52OkNPTVBVVEVSTkFNRSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFNRTEluc3RhbmNlTmFtZSA9ICJNU1NRTFNFUlZFUiIsCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREYXRhYmFzZSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFJvbGUKICAgICkKCiAgICAkcmVzdWx0ID0gKChHZXQtVGFyZ2V0UmVzb3VyY2UgQFBTQm91bmRQYXJhbWV0ZXJzKS5FbnN1cmUgLWVxICRFbnN1cmUpCiAgICAKICAgICRyZXN1bHQKfQoKCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U=
