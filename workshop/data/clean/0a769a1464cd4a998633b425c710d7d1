STOR_VSS_BackupRestore.ps1,1818aa4d96b723dfef0ec4c259b35a3b,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBMaW51eCBvbiBIeXBlci1WIGFuZCBBenVyZSBUZXN0IENvZGUsIHZlci4gMS4wLjAKIyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbgojCiMgQWxsIHJpZ2h0cyByZXNlcnZlZC4gCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICIiTGljZW5zZSIiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMCAgCiMKIyBUSElTIENPREUgSVMgUFJPVklERUQgKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMKIyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTgojIEFOWSBJTVBMSUVEIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSCiMgUFVSUE9TRSwgTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC4KIwojIFNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZwojIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCjwjCi5TeW5vcHNpcwogICAgVGhpcyBzY3JpcHQgdGVzdHMgVlNTIGJhY2t1cCBmdW5jdGlvbmFsaXR5LgoKLkRlc2NyaXB0aW9uCiAgICBUaGlzIHNjcmlwdCB3aWxsIGNyZWF0ZSBhIGZpbGUgb24gdGhlIHZtLCBiYWNrcyB1cCB0aGUgVk0sCiAgICBkZWxldGVzIHRoZSBmaWxlIGFuZCByZXN0b3JlcyB0aGUgVk0uCgogICAgSXQgdXNlcyBhIHNlY29uZCBwYXJ0aXRpb24gYXMgdGFyZ2V0LiAKCiAgICBOb3RlOiBUaGUgc2NyaXB0IGhhcyB0byBiZSBydW4gb24gdGhlIGhvc3QuIEEgc2Vjb25kIHBhcnRpdGlvbgogICAgZGlmZmVyZW50IGZyb20gdGhlIEh5cGVyLVYgb25lIGhhcyB0byBiZSBhdmFpbGFibGUuIAoKICAgIFRoZSAueG1sIGVudHJ5IGZvciB0aGlzIHNjcmlwdCBjb3VsZCBsb29rIGxpa2UgZWl0aGVyIG9mIHRoZQogICAgZm9sbG93aW5nOgoKICAgIEFuIGFjdHVhbCB0ZXN0cGFyYW1zIGRlZmluaXRpb24gbWF5IGxvb2sgbGlrZSB0aGUgZm9sbG93aW5nCgogICAgICAgIDx0ZXN0UGFyYW1zPgogICAgICAgICAgICA8cGFyYW0+ZHJpdmVsZXR0ZXI9Rjo8L3BhcmFtPgogICAgICAgIDx0ZXN0UGFyYW1zPgoKICAgIEEgdHlwaWNhbCBYTUwgZGVmaW5pdGlvbiBmb3IgdGhpcyB0ZXN0IGNhc2Ugd291bGQgbG9vayBzaW1pbGFyCiAgICB0byB0aGUgZm9sbG93aW5nOgogICAgICAgIDx0ZXN0PgogICAgICAgIDx0ZXN0TmFtZT5WU1NfQmFja3VwUmVzdG9yZTwvdGVzdE5hbWU+CiAgICAgICAgICAgIDx0ZXN0U2NyaXB0PnNldHVwc2NyaXB0c1xWU1NfQmFja3VwUmVzdG9yZS5wczE8L3Rlc3RTY3JpcHQ+IAogICAgICAgICAgICA8dGVzdFBhcmFtcz4KICAgICAgICAgICAgICAgIDxwYXJhbT5kcml2ZWxldHRlcj1GOjwvcGFyYW0+CiAgICAgICAgICAgICAgICA8cGFyYW0+VENfQ09WRVJFRD1WU1MtMDYsVlNTLTE3PC9wYXJhbT4KICAgICAgICAgICAgPC90ZXN0UGFyYW1zPgogICAgICAgICAgICA8dGltZW91dD4xMjAwPC90aW1lb3V0PgogICAgICAgICAgICA8T25FcnJvcj5Db250aW51ZTwvT25FcnJvcj4KICAgICAgICA8L3Rlc3Q+CgouUGFyYW1ldGVyIHZtTmFtZQogICAgTmFtZSBvZiB0aGUgVk0gdG8gcmVtb3ZlIGRpc2sgZnJvbSAuCgouUGFyYW1ldGVyIGh2U2VydmVyCiAgICBOYW1lIG9mIHRoZSBIeXBlci1WIHNlcnZlciBob3N0aW5nIHRoZSBWTS4KCi5QYXJhbWV0ZXIgdGVzdFBhcmFtcwogICAgVGVzdCBkYXRhIGZvciB0aGlzIHRlc3QgY2FzZQoKLkV4YW1wbGUKICAgIHNldHVwU2NyaXB0c1xWU1NfV1NCX0JhY2t1cFJlc3RvcmUucHMxIC1odlNlcnZlciBsb2NhbGhvc3QgLXZtTmFtZSBOYW1lT2ZWbSAtdGVzdFBhcmFtcyAnc3NoS2V5PXBhdGgvdG8vc3NoO3Jvb3RkaXI9cGF0aC90by90ZXN0ZGlyO2lwdjQ9aXBhZGRyZXNzO2RyaXZlbGV0dGVyPUQ6JwoKIz4KCnBhcmFtKFtzdHJpbmddICR2bU5hbWUsIFtzdHJpbmddICRodlNlcnZlciwgW3N0cmluZ10gJHRlc3RQYXJhbXMpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojQ2hlY2tzIGlmIHRoZSBWU1MgQmFja3VwIGRhZW1vbiBpcyBydW5uaW5nIG9uIHRoZSBMaW51eCBndWVzdCAgCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmZ1bmN0aW9uIENoZWNrVlNTRGFlbW9uKCkKewogICAgICRyZXRWYWx1ZSA9ICRGYWxzZQogICAgCiAgICAuXGJpblxwbGluayAtaSBzc2hcJHtzc2hLZXl9IHJvb3RAJHtpcHY0fSAicHMgLWVmIHwgZ3JlcCAnW2hddl92c3NfZGFlbW9uJyA+IC9yb290L3ZzcyIKICAgIGlmICgtbm90ICQ/KQogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICAiRVJST1I6IFVuYWJsZSB0byBydW4gcHMgLWVmIHwgZ3JlcCBodl92c19kYWVtb24iIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogVW5hYmxlIHRvIHJ1biBwcyAtZWYgfCBncmVwIGh2X3ZzX2RhZW1vbiIKICAgICAgICByZXR1cm4gJEZhbHNlCiAgICB9CgogICAgLlxiaW5ccHNjcCAtaSBzc2hcJHtzc2hLZXl9IHJvb3RAJHtpcHY0fTovcm9vdC92c3MgLgogICAgaWYgKC1ub3QgJD8pCiAgICB7CiAgICAgICAKICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFUlJPUjogVW5hYmxlIHRvIGNvcHkgdnNzIGZyb20gdGhlIFZNIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogVW5hYmxlIHRvIGNvcHkgdnNzIGZyb20gdGhlIFZNIgogICAgICAgcmV0dXJuICRGYWxzZQogICAgfQoKICAgICRmaWxlbmFtZSA9ICIuXHZzcyIKICAKICAgICMgVGhpcyBpcyBhc3N1bXB0aW9uIHRoYXQgd2hlbiB5b3UgZ3JlcCB2c3MgYmFja3VwIHByb2Nlc3MgaW4gZmlsZSwgaXQgd2lsbCByZXR1cm4gMSBsaW5lcyBpbiBjYXNlIG9mIHN1Y2Nlc3MuIAogICAgaWYgKChHZXQtQ29udGVudCAkZmlsZW5hbWUgIHwgTWVhc3VyZS1PYmplY3QgLUxpbmUpLkxpbmVzIC1lcSAgIjEiICkKICAgIHsKICAgICAgICBXcml0ZS1PdXRwdXQgIlZTUyBEYWVtb24gaXMgcnVubmluZyIgIAogICAgICAgICRyZXRWYWx1ZSA9ICAkVHJ1ZQogICAgfSAgICAKICAgIGRlbCAkZmlsZW5hbWUgICAKICAgIHJldHVybiAgJHJldFZhbHVlIAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIENoZWNrIGJvb3QubXNnIGluIExpbnV4IFZNIGZvciBSZWNvdmVyaW5nIGpvdXJuYWwuIAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpmdW5jdGlvbiBDaGVja1JlY292ZXJpbmdKKCkKewogICAgJHJldFZhbHVlID0gJEZhbHNlCiAgICAgICAKICAgIC5cYmluXHBzY3AgLWkgc3NoXCR7c3NoS2V5fSAgcm9vdEAke2lwdjR9Oi92YXIvbG9nL2Jvb3QuKiAuL2Jvb3QubXNnIAoKICAgIGlmICgtbm90ICQ/KQogICAgewogICAgICBXcml0ZS1PdXRwdXQgIkVSUk9SOiBVbmFibGUgdG8gY29weSBib290Lm1zZyBmcm9tIHRoZSBWTSIKICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KCiAgICAkZmlsZW5hbWUgPSAiLlxib290Lm1zZyIKICAgICR0ZXh0ID0gInJlY292ZXJpbmcgam91cm5hbCIKICAgIAogICAgJGZpbGUgPSBHZXQtQ29udGVudCAkZmlsZW5hbWUKICAgIGlmICgtbm90ICRmaWxlKQogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJVbmFibGUgdG8gcmVhZCBmaWxlIiAtQ2F0ZWdvcnkgSW52YWxpZEFyZ3VtZW50IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgcmV0dXJuICRudWxsCiAgICB9CgogICAgIGZvcmVhY2ggKCRsaW5lIGluICRmaWxlKQogICAgewogICAgICAgIGlmICgkbGluZSAtbWF0Y2ggJHRleHQpCiAgICAgICAgeyAgICAgICAgICAgCiAgICAgICAgICAgICRyZXRWYWx1ZSA9ICRUcnVlIAogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRsaW5lIiAgICAgICAgICAKICAgICAgICB9ICAgICAgICAgICAgIAogICAgfQoKICAgIGRlbCAkZmlsZW5hbWUKICAgIHJldHVybiAkcmV0VmFsdWUgICAgCn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgQ3JlYXRlIGEgZmlsZSBvbiB0aGUgVk0uIAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpmdW5jdGlvbiBDcmVhdGVGaWxlKCkKewogICAgLlxiaW5ccGxpbmsgLWkgc3NoXCR7c3NoS2V5fSByb290QCR7aXB2NH0gImVjaG8gYWJjID4gL3Jvb3QvMSIKICAgIGlmICgtbm90ICQ/KQogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFUlJPUjogVW5hYmxlIHRvIGNyZWF0ZSBmaWxlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KICAgCiAgICByZXR1cm4gICRUcnVlIAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIERlbGV0ZSBhIGZpbGUgb24gdGhlIFZNLiAKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZnVuY3Rpb24gRGVsZXRlRmlsZSgpCnsKICAgIC5cYmluXHBsaW5rIC1pIHNzaFwke3NzaEtleX0gcm9vdEAke2lwdjR9ICJybSAtcmYgL3Jvb3QvMSIKICAgIGlmICgtbm90ICQ/KQogICAgewogICAgICAgIFdyaXRlLUVycm9yIC1NZXNzYWdlICJFUlJPUjogVW5hYmxlIHRvIGRlbGV0ZSBmaWxlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQogICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KICAgCiAgICByZXR1cm4gICRUcnVlIAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIENoZWNrcyBpZiB0ZXN0IGZpbGUgaXMgcHJlc2VudCBvciBub3QuIAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpmdW5jdGlvbiBDaGVja0ZpbGUoKQp7CiAgICAuXGJpblxwbGluayAtaSBzc2hcJHtzc2hLZXl9IHJvb3RAJHtpcHY0fSAiY2F0IC9yb290LzEiCiAgICBpZiAoLW5vdCAkPykKICAgIHsKICAgICAgICBXcml0ZS1FcnJvciAtTWVzc2FnZSAiRVJST1I6IFVuYWJsZSB0byByZWFkIGZpbGUiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgcmV0dXJuICRGYWxzZQogICAgfQogICAKICAgIHJldHVybiAgJFRydWUgCn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIAojIAojIE1haW4gc2NyaXB0IGJvZHkgCiMgCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiRyZXRWYWwgPSAkZmFsc2UKCldyaXRlLU91dHB1dCAiUmVtb3Zpbmcgb2xkIGJhY2t1cHMiCnRyeSB7IFJlbW92ZS1XQkJhY2t1cFNldCAtRm9yY2UgLVdhcm5pbmdBY3Rpb24gU2lsZW50bHlDb250aW51ZSB9CkNhdGNoIHsgV3JpdGUtT3V0cHV0ICJObyBleGlzdGluZyBiYWNrdXAncyB0byByZW1vdmUifQoKIyBEZWZpbmUgYW5kIGNsZWFudXAgdGhlIHN1bW1hcnlMb2cKJHN1bW1hcnlMb2cgID0gIiR7dm1OYW1lfV9zdW1tYXJ5LmxvZyIKZWNobyAiQ292ZXJzIFZTUyBCYWNrdXAiID4gJHN1bW1hcnlMb2cKCiMgQ2hlY2sgaW5wdXQgYXJndW1lbnRzCmlmICgkdm1OYW1lIC1lcSAkbnVsbCkKewogICAgIkVSUk9SOiBWTSBuYW1lIGlzIG51bGwiCiAgICByZXR1cm4gJHJldFZhbAp9CgojIENoZWNrIGlucHV0IHBhcmFtcwokcGFyYW1zID0gJHRlc3RQYXJhbXMuU3BsaXQoIjsiKQoKZm9yZWFjaCAoJHAgaW4gJHBhcmFtcykKewogICRmaWVsZHMgPSAkcC5TcGxpdCgiPSIpCiAgICAKICBzd2l0Y2ggKCRmaWVsZHNbMF0uVHJpbSgpKQogICAgewogICAgInNzaEtleSIgeyAkc3NoS2V5ID0gJGZpZWxkc1sxXS5UcmltKCkgfQogICAgImlwdjQiIHsgJGlwdjQgPSAkZmllbGRzWzFdLlRyaW0oKSB9CiAgICAicm9vdGRpciIgeyAkcm9vdERpciA9ICRmaWVsZHNbMV0uVHJpbSgpIH0KICAgICJkcml2ZWxldHRlciIgeyAkZHJpdmVsZXR0ZXIgPSAkZmllbGRzWzFdLlRyaW0oKSB9CiAgICAgZGVmYXVsdCAge30gICAgICAgICAgCiAgICB9Cn0KCmlmICgkbnVsbCAtZXEgJHNzaEtleSkKewogICAgIkVSUk9SOiBUZXN0IHBhcmFtZXRlciBzc2hLZXkgd2FzIG5vdCBzcGVjaWZpZWQiCiAgICByZXR1cm4gJEZhbHNlCn0KCmlmICgkbnVsbCAtZXEgJGlwdjQpCnsKICAgICJFUlJPUjogVGVzdCBwYXJhbWV0ZXIgaXB2NCB3YXMgbm90IHNwZWNpZmllZCIKICAgIHJldHVybiAkRmFsc2UKfQoKaWYgKCRudWxsIC1lcSAkcm9vdGRpcikKewogICAgIkVSUk9SOiBUZXN0IHBhcmFtZXRlciByb290ZGlyIHdhcyBub3Qgc3BlY2lmaWVkIgogICAgcmV0dXJuICRGYWxzZQp9CgppZiAoJG51bGwgLWVxICRkcml2ZWxldHRlcikKewogICAgIldhcm5pbmc6IEJhY2t1cCBkcml2ZWxldHRlciBpcyBub3Qgc3BlY2lmaWVkLiIKICAgIHJldHVybiAkRmFsc2UKfQoKZWNobyAkcGFyYW1zCgojIENoYW5nZSB0aGUgd29ya2luZyBkaXJlY3RvcnkgdG8gd2hlcmUgd2UgbmVlZCB0byBiZQpjZCAkcm9vdERpcgoKIyBTb3VyY2UgdGhlIFRDVXRpbHMucHMxIGZpbGUKLiAuXHNldHVwc2NyaXB0c1xUQ1V0aWxzLnBzMQoKIyBDaGVjayBpZiB0aGUgVm0gVkhEIGluIG5vdCBvbiB0aGUgc2FtZSBkcml2ZSBhcyB0aGUgYmFja3VwIGRlc3RpbmF0aW9uIAokdm0gPSBHZXQtVk0gLU5hbWUgJHZtTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlcgppZiAoLW5vdCAkdm0pCnsKICAgICJFcnJvcjogVk0gJyR7dm1OYW1lfScgZG9lcyBub3QgZXhpc3QiCiAgICByZXR1cm4gJEZhbHNlCn0KIApmb3JlYWNoICgkZHJpdmUgaW4gJHZtLkhhcmREcml2ZXMpCnsKICAgIGlmICggJGRyaXZlLlBhdGguU3RhcnRzV2l0aCgiJHtkcml2ZUxldHRlcn0iKSkKICAgIHsKICAgICAgICAiRXJyb3I6IEJhY2t1cCBwYXJ0aXRpb24gJyR7ZHJpdmVMZXR0ZXJ9JyBpcyBzYW1lIGFzIHBhcnRpdGlvbiBob3N0aW5nIHRoZSBWTXMgZGlzayIKICAgICAgICAiICAgICAgICQoJGRyaXZlLlBhdGgpIgogICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KfQoKIyBDaGVjayB0byBzZWUgTGludXggVk0gaXMgcnVubmluZyBWU1MgYmFja3VwIGRhZW1vbiAKJHN0cyA9IENoZWNrVlNTRGFlbW9uCmlmICgtbm90ICRzdHNbLTFdKQp7CiAgICBXcml0ZS1PdXRwdXQgIkVSUk9SOiBWU1MgYmFja3VwIGRhZW1vbiBpcyBub3QgcnVubmluZyBpbnNpZGUgTGludXggVk0iCiAgICByZXR1cm4gJEZhbHNlCn0KV3JpdGUtT3V0cHV0ICJWU1MgRGFlbW9uIGlzIHJ1bm5pbmcgIiA+PiAkc3VtbWFyeUxvZwoKIyBJbnN0YWxsIHRoZSBXaW5kb3dzIEJhY2t1cCBmZWF0dXJlCldyaXRlLU91dHB1dCAiQ2hlY2tpbmcgaWYgdGhlIFdpbmRvd3MgU2VydmVyIEJhY2t1cCBmZWF0dXJlIGlzIGluc3RhbGxlZC4uLiIKdHJ5IHsgQWRkLVdpbmRvd3NGZWF0dXJlIC1OYW1lIFdpbmRvd3MtU2VydmVyLUJhY2t1cCAtSW5jbHVkZUFsbFN1YkZlYXR1cmU6JHRydWUgLVJlc3RhcnQ6JGZhbHNlIH0KQ2F0Y2ggeyBXcml0ZS1PdXRwdXQgIldpbmRvd3MgU2VydmVyIEJhY2t1cCBmZWF0dXJlIGlzIGFscmVhZHkgaW5zdGFsbGVkLCBubyBhY3Rpb25zIHJlcXVpcmVkLiJ9CgojIENyZWF0ZSBhIGZpbGUgb24gdGhlIFZNIGJlZm9yZSBiYWNrdXAKJHN0cyA9IENyZWF0ZUZpbGUKaWYgKC1ub3QgJHN0c1stMV0pCnsKICAgIFdyaXRlLU91dHB1dCAiRVJST1I6IENhbiBub3QgY3JlYXRlIGZpbGUiCiAgICByZXR1cm4gJEZhbHNlCn0KV3JpdGUtT3V0cHV0ICJGaWxlIGNyZWF0ZWQgb24gVk06ICR2bW5hbWUiID4+ICRzdW1tYXJ5TG9nCgojIFJlbW92ZSBFeGlzdGluZyBCYWNrdXAgUG9saWN5CnRyeSB7IFJlbW92ZS1XQlBvbGljeSAtYWxsIC1mb3JjZSB9CkNhdGNoIHsgV3JpdGUtT3V0cHV0ICJObyBleGlzdGluZyBiYWNrdXAgcG9saWN5IHRvIHJlbW92ZSJ9CgojIFNldCB1cCBhIG5ldyBCYWNrdXAgUG9saWN5CiRwb2xpY3kgPSBOZXctV0JQb2xpY3kKCiMgU2V0IHRoZSBiYWNrdXAgYmFja3VwIGxvY2F0aW9uCiRiYWNrdXBMb2NhdGlvbiA9IE5ldy1XQkJhY2t1cFRhcmdldCAtVm9sdW1lUGF0aCAkZHJpdmVsZXR0ZXIKCiMgRGVmaW5lIFZTUyBXQkJhY2t1cCB0eXBlClNldC1XQlZzc0JhY2t1cE9wdGlvbnMgLVBvbGljeSAkcG9saWN5IC1Wc3NDb3B5QmFja3VwCgojIEFkZCB0aGUgVmlydHVhbCBtYWNoaW5lcyB0byB0aGUgbGlzdAokVk0gPSBHZXQtV0JWaXJ0dWFsTWFjaGluZSB8IHdoZXJlIHZtbmFtZSAtbGlrZSAkdm1OYW1lCkFkZC1XQlZpcnR1YWxNYWNoaW5lIC1Qb2xpY3kgJHBvbGljeSAtVmlydHVhbE1hY2hpbmUgJFZNCkFkZC1XQkJhY2t1cFRhcmdldCAtUG9saWN5ICRwb2xpY3kgLVRhcmdldCAkYmFja3VwTG9jYXRpb24KCiMgRGlzcGxheSB0aGUgQmFja3VwIHBvbGljeQpXcml0ZS1PdXRwdXQgIkJhY2t1cCBwb2xpY3kgaXM6IGBuJHBvbGljeSIKCiMgU3RhcnQgdGhlIGJhY2t1cApXcml0ZS1PdXRwdXQgIkJhY2tpbmcgdG8gJGRyaXZlbGV0dGVyIgpTdGFydC1XQkJhY2t1cCAtUG9saWN5ICRwb2xpY3kKCiMgUmV2aWV3IHRoZSByZXN1bHRzICAgICAgICAgICAgCiRCYWNrdXBUaW1lID0gKE5ldy1UaW1lc3BhbiAtU3RhcnQgKEdldC1XQkpvYiAtUHJldmlvdXMgMSkuU3RhcnRUaW1lIC1FbmQgKEdldC1XQkpvYiAtUHJldmlvdXMgMSkuRW5kVGltZSkuTWludXRlcwpXcml0ZS1PdXRwdXQgIkJhY2t1cCBkdXJhdGlvbjogJEJhY2t1cFRpbWUgbWludXRlcyIgICAgICAgICAgIAoiQmFja3VwIGR1cmF0aW9uOiAkQmFja3VwVGltZSBtaW51dGVzIiA+PiAkc3VtbWFyeUxvZwoKJHN0cz1HZXQtV0JKb2IgLVByZXZpb3VzIDEKaWYgKCRzdHMuSm9iU3RhdGUgLW5lICJDb21wbGV0ZWQiKQp7CiAgICBXcml0ZS1PdXRwdXQgIkVSUk9SOiBWU1MgV0JCYWNrdXAgZmFpbGVkIgogICAgJHJldFZhbCA9ICRmYWxzZQogICAgcmV0dXJuICRyZXRWYWwKfQoKV3JpdGUtT3V0cHV0ICJgbkJhY2t1cCBzdWNjZXNzIWBuIgojIExldCdzIHdhaXQgYSBmZXcgU2Vjb25kcwpTdGFydC1TbGVlcCAtU2Vjb25kcyAzCgojIERlbGV0ZSBmaWxlIG9uIHRoZSBWTQokc3RzID0gRGVsZXRlRmlsZQppZiAoLW5vdCAkc3RzWy0xXSkKewogICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogQ2FuIG5vdCBkZWxldGUgZmlsZSIKICAgIHJldHVybiAkRmFsc2UKfQpXcml0ZS1PdXRwdXQgIkZpbGUgZGVsZXRlZCBvbiBWTTogJHZtbmFtZSIgPj4gJHN1bW1hcnlMb2cKCiMgU3RhcnQgdGhlIFJlc3RvcmUKV3JpdGUtT3V0cHV0ICJgbk5vdyBsZXQncyBkbyByZXN0b3JlIC4uLmBuIgoKIyBHZXQgQmFja3VwU2V0CiRCYWNrdXBTZXQ9R2V0LVdCQmFja3VwU2V0IC1CYWNrdXBUYXJnZXQgJGJhY2t1cExvY2F0aW9uCgojIFN0YXJ0IFJlc3RvcmUKU3RhcnQtV0JIeXBlclZSZWNvdmVyeSAtQmFja3VwU2V0ICRCYWNrdXBTZXQgLVZNSW5CYWNrdXAgJEJhY2t1cFNldC5BcHBsaWNhdGlvblswXS5Db21wb25lbnRbMF0gLUZvcmNlIC1XYXJuaW5nQWN0aW9uIFNpbGVudGx5Q29udGludWUKJHN0cz1HZXQtV0JKb2IgLVByZXZpb3VzIDEKaWYgKCRzdHMuSm9iU3RhdGUgLW5lICJDb21wbGV0ZWQiKQp7CiAgICBXcml0ZS1PdXRwdXQgIkVSUk9SOiBWU1MgV0IgUmVzdG9yZSBmYWlsZWQiCiAgICAkcmV0VmFsID0gJGZhbHNlCiAgICByZXR1cm4gJHJldFZhbAp9CgojIFJldmlldyB0aGUgcmVzdWx0cyAgCiRSZXN0b3JlVGltZSA9IChOZXctVGltZXNwYW4gLVN0YXJ0IChHZXQtV0JKb2IgLVByZXZpb3VzIDEpLlN0YXJ0VGltZSAtRW5kIChHZXQtV0JKb2IgLVByZXZpb3VzIDEpLkVuZFRpbWUpLk1pbnV0ZXMKV3JpdGUtT3V0cHV0ICJSZXN0b3JlIGR1cmF0aW9uOiAkUmVzdG9yZVRpbWUgbWludXRlcyIKIlJlc3RvcmUgZHVyYXRpb246ICRSZXN0b3JlVGltZSBtaW51dGVzIiA+PiAkc3VtbWFyeUxvZwoKIyBNYWtlIHN1cmUgVk0gZXhzaXN0IGFmdGVyIFZTUyBiYWNrdXAvcmVzdG9yZSBPcGVyYXRpb24gCiR2bSA9IEdldC1WTSAtTmFtZSAkdm1OYW1lIC1Db21wdXRlck5hbWUgJGh2U2VydmVyCiAgICBpZiAoLW5vdCAkdm0pCiAgICB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogVk0gJHt2bU5hbWV9IGRvZXMgbm90IGV4aXN0IGFmdGVyIHJlc3RvcmUiCiAgICAgICAgcmV0dXJuICRGYWxzZQogICAgfQpXcml0ZS1PdXRwdXQgIlJlc3RvcmUgc3VjY2VzcyEiCgojIEFmdGVyIEJhY2t1cCBSZXN0b3JlIFZNIG11c3QgYmUgb2ZmIG1ha2Ugc3VyZSB0aGF0LgppZiAoICR2bS5zdGF0ZSAtbmUgIk9mZiIgKSAgCnsKICAgIFdyaXRlLU91dHB1dCAiRVJST1I6IFZNIGlzIG5vdCBpbiBPRkYgc3RhdGUsIGN1cnJlbnQgc3RhdGUgaXMgIiArICR2bS5zdGF0ZSAKICAgIHJldHVybiAkRmFsc2UKfQoKIyBOb3cgU3RhcnQgdGhlIFZNIAokdGltZW91dCA9IDUwMAokc3RzID0gU3RhcnQtVk0gLU5hbWUgJHZtTmFtZSAtQ29tcHV0ZXJOYW1lICRodlNlcnZlciAKaWYgKC1ub3QgKFdhaXRGb3JWTVRvU3RhcnRLVlAgJHZtTmFtZSAkaHZTZXJ2ZXIgJHRpbWVvdXQgKSkKewogICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogJHt2bU5hbWV9IGZhaWxlZCB0byBzdGFydCIKICAgIHJldHVybiAkRmFsc2UKfQplbHNlCnsKICAgIFdyaXRlLU91dHB1dCAiSU5GTzogU3RhcnRlZCBWTSAke3ZtTmFtZX0iCn0KCiMgTm93IENoZWNrIHRoZSBib290IGxvZ3MgaW4gVk0gdG8gdmVyaWZ5IGlmIHRoZXJlIGlzIG5vIFJlY292ZXJpbmcgam91cm5hbHMgaW4gaXQgLiAKJHN0cz1DaGVja1JlY292ZXJpbmdKCmlmICgkc3RzWy0xXSkKewogICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogUmVjb3ZlcmluZyBKb3VybmFscyBpbiBCb290IGxvZyBGaWxlLCBWU1MgQmFja3VwL3Jlc3RvcmUgaXMgRmFpbGVkICIKICAgIFdyaXRlLU91dHB1dCAiTm8gUmVjb3ZlcmluZyBKb3VybmFsIGluIGJvb3QgbG9nczogRmFpbGVkIiA+PiAkc3VtbWFyeUxvZwogICAgcmV0dXJuICRGYWxzZQp9CmVsc2UgCnsKICAgICRzdHMgPSBDaGVja0ZpbGUKICAgIGlmICgtbm90ICRzdHNbLTFdKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJFUlJPUjogRmlsZSBpcyBub3QgcHJlc2VudCBmaWxlIgogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkZpbGUgcHJlc2VudCBvbiBWTSBBZnRlciBCYWNrdXAvUmVzdG9yZTogRmFpbGVkIiA+PiAkc3VtbWFyeUxvZwogICAgICAgICAgICByZXR1cm4gJEZhbHNlCiAgICAgICAgfQoKICAgIFdyaXRlLU91dHB1dCAiSU5GTzogRmlsZSBwcmVzZW50IG9uIFZNOiAkdm1OYW1lIgogICAgV3JpdGUtT3V0cHV0ICJGaWxlIHByZXNlbnQgb24gVk0gQWZ0ZXIgQmFja3VwL1Jlc3RvcmU6IFN1Y2Nlc3MiID4+ICRzdW1tYXJ5TG9nCiAgICAkcmVzdWx0cyA9ICJQYXNzZWQiCiAgICAkcmV0VmFsID0gJFRydWUKICAgIFdyaXRlLU91dHB1dCAiSU5GTzogVlNTIEJhY2svUmVzdG9yZTogU3VjY2VzcyIgICAKICAgIFdyaXRlLU91dHB1dCAiTm8gUmVjb3ZlcmluZyBKb3VybmFsIGluIGJvb3QgbXNnOiBTdWNjZXNzIiA+PiAkc3VtbWFyeUxvZwp9CgojIFJlbW92ZSBDcmVhdGVkIEJhY2t1cApXcml0ZS1PdXRwdXQgIlJlbW92aW5nIG9sZCBiYWNrdXBzIGZyb20gJGJhY2t1cExvY2F0aW9uIgp0cnkgeyBSZW1vdmUtV0JCYWNrdXBTZXQgLUJhY2t1cFRhcmdldCAkYmFja3VwTG9jYXRpb24gLUZvcmNlIC1XYXJuaW5nQWN0aW9uIFNpbGVudGx5Q29udGludWUgfQpDYXRjaCB7IFdyaXRlLU91dHB1dCAiTm8gZXhpc3RpbmcgYmFja3VwJ3MgdG8gcmVtb3ZlIn0KCldyaXRlLU91dHB1dCAiSU5GTzogVGVzdCAke3Jlc3VsdHN9IgpyZXR1cm4gJHJldFZhbAo=
