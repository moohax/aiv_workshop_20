LongPathFunctions.ps1,294fcf4b572ffabcbd4af82855f5c269,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFByaXZhdGUgZnVuY3Rpb25zLgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmZ1bmN0aW9uIENvbnZlcnRGcm9tLUxvbmdGb3JtUGF0aCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oW3N0cmluZ10kUGF0aCkKCiAgICBpZiAoJFBhdGgpIHsKICAgICAgICBpZiAoJFBhdGguU3RhcnRzV2l0aCgnXFw/XFVOQycpKSB7CiAgICAgICAgICAgICMgRS5nLiBcXD9cVU5DXHNlcnZlclxzaGFyZSAtPiBcXHNlcnZlclxzaGFyZQogICAgICAgICAgICByZXR1cm4gJFBhdGguU3Vic3RyaW5nKDEsICdcP1xVTkMnLkxlbmd0aCkKICAgICAgICB9IGVsc2VpZiAoJFBhdGguU3RhcnRzV2l0aCgnXFw/XCcpKSB7CiAgICAgICAgICAgICMgRS5nLiBcXD9cQzpcZGlyZWN0b3J5IC0+IEM6XGRpcmVjdG9yeQogICAgICAgICAgICByZXR1cm4gJFBhdGguU3Vic3RyaW5nKCdcXD9cJy5MZW5ndGgpCiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkUGF0aAp9CmZ1bmN0aW9uIENvbnZlcnRUby1Mb25nRm9ybVBhdGggewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJFBhdGgpCgogICAgW3N0cmluZ10kbG9uZ0Zvcm1QYXRoID0gR2V0LUZ1bGxOb3JtYWxpemVkUGF0aCAtUGF0aCAkUGF0aAogICAgaWYgKCRsb25nRm9ybVBhdGggLWFuZCAhJGxvbmdGb3JtUGF0aC5TdGFydHNXaXRoKCdcXD8nKSkgewogICAgICAgIGlmICgkbG9uZ0Zvcm1QYXRoLlN0YXJ0c1dpdGgoJ1xcJykpIHsKICAgICAgICAgICAgIyBFLmcuIFxcc2VydmVyXHNoYXJlIC0+IFxcP1xVTkNcc2VydmVyXHNoYXJlCiAgICAgICAgICAgIHJldHVybiAiXFw/XFVOQyQoJGxvbmdGb3JtUGF0aC5TdWJzdHJpbmcoMSkpIgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICMgRS5nLiBDOlxkaXJlY3RvcnkgLT4gXFw/XEM6XGRpcmVjdG9yeQogICAgICAgICAgICByZXR1cm4gIlxcP1wkbG9uZ0Zvcm1QYXRoIgogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJGxvbmdGb3JtUGF0aAp9CgojIFRPRE86IEFERCBBIFNXSVRDSCBUTyBFWENMVURFIEZJTEVTLCBBIFNXSVRDSCBUTyBFWENMVURFIERJUkVDVE9SSUVTLCBBTkQgQSBTV0lUQ0ggTk9UIFRPIEZPTExPVyBSRVBBUlNFIFBPSU5UUy4KZnVuY3Rpb24gR2V0LURpcmVjdG9yeUNoaWxkSXRlbSB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10kUGF0aCwKICAgICAgICBbVmFsaWRhdGVOb3ROdWxsT3JFbXB0eSgpXQogICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICBbc3RyaW5nXSRGaWx0ZXIgPSAiKiIsCiAgICAgICAgW3N3aXRjaF0kRm9yY2UsCiAgICAgICAgW1ZzdHNUYXNrU2RrLkZTLkZpbmRGbGFnc10kRmxhZ3MgPSBbVnN0c1Rhc2tTZGsuRlMuRmluZEZsYWdzXTo6TGFyZ2VGZXRjaCwKICAgICAgICBbVnN0c1Rhc2tTZGsuRlMuRmluZEluZm9MZXZlbF0kSW5mb0xldmVsID0gW1ZzdHNUYXNrU2RrLkZTLkZpbmRJbmZvTGV2ZWxdOjpCYXNpYywKICAgICAgICBbc3dpdGNoXSRSZWN1cnNlKQoKICAgICRzdGFja09mRGlyZWN0b3J5UXVldWVzID0gTmV3LU9iamVjdCBTeXN0ZW0uQ29sbGVjdGlvbnMuU3RhY2sKICAgIHdoaWxlICgkdHJ1ZSkgewogICAgICAgICRkaXJlY3RvcnlRdWV1ZSA9IE5ldy1PYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlF1ZXVlCiAgICAgICAgJGZpbGVRdWV1ZSA9IE5ldy1PYmplY3QgU3lzdGVtLkNvbGxlY3Rpb25zLlF1ZXVlCiAgICAgICAgJGZpbmREYXRhID0gTmV3LU9iamVjdCBWc3RzVGFza1Nkay5GUy5GaW5kRGF0YQogICAgICAgICRsb25nRm9ybVBhdGggPSAoQ29udmVydFRvLUxvbmdGb3JtUGF0aCAkUGF0aCkKICAgICAgICAkaGFuZGxlID0gJG51bGwKICAgICAgICB0cnkgewogICAgICAgICAgICAkaGFuZGxlID0gW1ZzdHNUYXNrU2RrLkZTLk5hdGl2ZU1ldGhvZHNdOjpGaW5kRmlyc3RGaWxlRXgoCiAgICAgICAgICAgICAgICBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRsb25nRm9ybVBhdGgsICRGaWx0ZXIpLAogICAgICAgICAgICAgICAgJEluZm9MZXZlbCwKICAgICAgICAgICAgICAgICRmaW5kRGF0YSwKICAgICAgICAgICAgICAgIFtWc3RzVGFza1Nkay5GUy5GaW5kU2VhcmNoT3BzXTo6TmFtZU1hdGNoLAogICAgICAgICAgICAgICAgW1N5c3RlbS5JbnRQdHJdOjpaZXJvLAogICAgICAgICAgICAgICAgJEZsYWdzKQogICAgICAgICAgICBpZiAoISRoYW5kbGUuSXNJbnZhbGlkKSB7CiAgICAgICAgICAgICAgICB3aGlsZSAoJHRydWUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoJGZpbmREYXRhLmZpbGVOYW1lIC1ub3RpbiAnLicsICcuLicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGF0dHJpYnV0ZXMgPSBbVnN0c1Rhc2tTZGsuRlMuQXR0cmlidXRlc10kZmluZERhdGEuZmlsZUF0dHJpYnV0ZXMKICAgICAgICAgICAgICAgICAgICAgICAgIyBJZiB0aGUgaXRlbSBpcyBoaWRkZW4sIGNoZWNrIGlmICRGb3JjZSBpcyBzcGVjaWZpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkRm9yY2UgLW9yICEkYXR0cmlidXRlcy5IYXNGbGFnKFtWc3RzVGFza1Nkay5GUy5BdHRyaWJ1dGVzXTo6SGlkZGVuKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDcmVhdGUgdGhlIGl0ZW0uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaXRlbSA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIHBzb2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBdHRyaWJ1dGVzJyA9ICRhdHRyaWJ1dGVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0Z1bGxOYW1lJyA9IChDb252ZXJ0RnJvbS1Mb25nRm9ybVBhdGggLVBhdGggKFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJFBhdGgsICRmaW5kRGF0YS5maWxlTmFtZSkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdOYW1lJyA9ICRmaW5kRGF0YS5maWxlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBPdXRwdXQgZGlyZWN0b3JpZXMgaW1tZWRpYXRlbHkuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGl0ZW0uQXR0cmlidXRlcy5IYXNGbGFnKFtWc3RzVGFza1Nkay5GUy5BdHRyaWJ1dGVzXTo6RGlyZWN0b3J5KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBBcHBlbmQgdG8gdGhlIGRpcmVjdG9yeSBxdWV1ZSBpZiByZWN1cnNpdmUgYW5kIGRlZmF1bHQgZmlsdGVyLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkUmVjdXJzZSAtYW5kICRGaWx0ZXIgLWVxICcqJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGlyZWN0b3J5UXVldWUuRW5xdWV1ZSgkaXRlbSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgSG9sZCB0aGUgZmlsZXMgdW50aWwgYWxsIGRpcmVjdG9yaWVzIGhhdmUgYmVlbiBvdXRwdXQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZpbGVRdWV1ZS5FbnF1ZXVlKCRpdGVtKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoIShbVnN0c1Rhc2tTZGsuRlMuTmF0aXZlTWV0aG9kc106OkZpbmROZXh0RmlsZSgkaGFuZGxlLCAkZmluZERhdGEpKSkgeyBicmVhayB9CgogICAgICAgICAgICAgICAgICAgIGlmICgkaGFuZGxlLklzSW52YWxpZCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkNvbXBvbmVudE1vZGVsLldpbjMyRXhjZXB0aW9uIC1Bcmd1bWVudExpc3QgQCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldExhc3RXaW4zMkVycm9yKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdldC1Mb2NTdHJpbmcgLUtleSBQU0xJQl9FbnVtZXJhdGluZ1N1YmRpcmVjdG9yaWVzRmFpbGVkRm9yUGF0aDAgLUFyZ3VtZW50TGlzdCAkUGF0aAogICAgICAgICAgICAgICAgICAgICAgICApKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmICgkaGFuZGxlIC1uZSAkbnVsbCkgeyAkaGFuZGxlLkRpc3Bvc2UoKSB9CiAgICAgICAgfQoKICAgICAgICAjIElmIHJlY3Vyc2l2ZSBhbmQgbm9uLWRlZmF1bHQgZmlsdGVyLCBxdWV1ZSBjaGlsZCBkaXJlY3Rvcmllcy4KICAgICAgICBpZiAoJFJlY3Vyc2UgLWFuZCAkRmlsdGVyIC1uZSAnKicpIHsKICAgICAgICAgICAgJGZpbmREYXRhID0gTmV3LU9iamVjdCBWc3RzVGFza1Nkay5GUy5GaW5kRGF0YQogICAgICAgICAgICAkaGFuZGxlID0gJG51bGwKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRoYW5kbGUgPSBbVnN0c1Rhc2tTZGsuRlMuTmF0aXZlTWV0aG9kc106OkZpbmRGaXJzdEZpbGVFeCgKICAgICAgICAgICAgICAgICAgICBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRsb25nRm9ybVBhdGgsICcqJyksCiAgICAgICAgICAgICAgICAgICAgW1ZzdHNUYXNrU2RrLkZTLkZpbmRJbmZvTGV2ZWxdOjpCYXNpYywKICAgICAgICAgICAgICAgICAgICAkZmluZERhdGEsCiAgICAgICAgICAgICAgICAgICAgW1ZzdHNUYXNrU2RrLkZTLkZpbmRTZWFyY2hPcHNdOjpOYW1lTWF0Y2gsCiAgICAgICAgICAgICAgICAgICAgW1N5c3RlbS5JbnRQdHJdOjpaZXJvLAogICAgICAgICAgICAgICAgICAgICRGbGFncykKICAgICAgICAgICAgICAgIGlmICghJGhhbmRsZS5Jc0ludmFsaWQpIHsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoJHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRmaW5kRGF0YS5maWxlTmFtZSAtbm90aW4gJy4nLCAnLi4nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYXR0cmlidXRlcyA9IFtWc3RzVGFza1Nkay5GUy5BdHRyaWJ1dGVzXSRmaW5kRGF0YS5maWxlQXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBJZiB0aGUgaXRlbSBpcyBoaWRkZW4sIGNoZWNrIGlmICRGb3JjZSBpcyBzcGVjaWZpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJEZvcmNlIC1vciAhJGF0dHJpYnV0ZXMuSGFzRmxhZyhbVnN0c1Rhc2tTZGsuRlMuQXR0cmlidXRlc106OkhpZGRlbikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENvbGxlY3QgZGlyZWN0b3JpZXMgb25seS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGF0dHJpYnV0ZXMuSGFzRmxhZyhbVnN0c1Rhc2tTZGsuRlMuQXR0cmlidXRlc106OkRpcmVjdG9yeSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDcmVhdGUgdGhlIGl0ZW0uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgcHNvYmplY3QgLVByb3BlcnR5IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQXR0cmlidXRlcycgPSAkYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0Z1bGxOYW1lJyA9IChDb252ZXJ0RnJvbS1Mb25nRm9ybVBhdGggLVBhdGggKFtTeXN0ZW0uSU8uUGF0aF06OkNvbWJpbmUoJFBhdGgsICRmaW5kRGF0YS5maWxlTmFtZSkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05hbWUnID0gJGZpbmREYXRhLmZpbGVOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRpcmVjdG9yeVF1ZXVlLkVucXVldWUoJGl0ZW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShbVnN0c1Rhc2tTZGsuRlMuTmF0aXZlTWV0aG9kc106OkZpbmROZXh0RmlsZSgkaGFuZGxlLCAkZmluZERhdGEpKSkgeyBicmVhayB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGhhbmRsZS5Jc0ludmFsaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IChOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uQ29tcG9uZW50TW9kZWwuV2luMzJFeGNlcHRpb24gLUFyZ3VtZW50TGlzdCBAKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldExhc3RXaW4zMkVycm9yKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHZXQtTG9jU3RyaW5nIC1LZXkgUFNMSUJfRW51bWVyYXRpbmdTdWJkaXJlY3Rvcmllc0ZhaWxlZEZvclBhdGgwIC1Bcmd1bWVudExpc3QgJFBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoJGhhbmRsZSAtbmUgJG51bGwpIHsgJGhhbmRsZS5EaXNwb3NlKCkgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIE91dHB1dCB0aGUgZmlsZXMuCiAgICAgICAgJGZpbGVRdWV1ZQoKICAgICAgICAjIFB1c2ggdGhlIGRpcmVjdG9yeSBxdWV1ZSBvbnRvIHRoZSBzdGFjayBpZiBhbnkgZGlyZWN0b3JpZXMgd2VyZSBmb3VuZC4KICAgICAgICBpZiAoJGRpcmVjdG9yeVF1ZXVlLkNvdW50KSB7ICRzdGFja09mRGlyZWN0b3J5UXVldWVzLlB1c2goJGRpcmVjdG9yeVF1ZXVlKSB9CgogICAgICAgICMgQnJlYWsgb3V0IG9mIHRoZSBsb29wIGlmIG5vIG1vcmUgZGlyZWN0b3J5IHF1ZXVlcyB0byBwcm9jZXNzLgogICAgICAgIGlmICghJHN0YWNrT2ZEaXJlY3RvcnlRdWV1ZXMuQ291bnQpIHsgYnJlYWsgfQoKICAgICAgICAjIEdldCB0aGUgbmV4dCBwYXRoLgogICAgICAgICRkaXJlY3RvcnlRdWV1ZSA9ICRzdGFja09mRGlyZWN0b3J5UXVldWVzLlBlZWsoKQogICAgICAgICRQYXRoID0gJGRpcmVjdG9yeVF1ZXVlLkRlcXVldWUoKS5GdWxsTmFtZQoKICAgICAgICAjIFBvcCB0aGUgZGlyZWN0b3J5IHF1ZXVlIGlmIGl0J3MgZW1wdHkuCiAgICAgICAgaWYgKCEkZGlyZWN0b3J5UXVldWUuQ291bnQpIHsgJG51bGwgPSAkc3RhY2tPZkRpcmVjdG9yeVF1ZXVlcy5Qb3AoKSB9CiAgICB9Cn0KCmZ1bmN0aW9uIEdldC1GdWxsTm9ybWFsaXplZFBhdGggewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJFBhdGgpCgogICAgW3N0cmluZ10kb3V0UGF0aCA9ICRQYXRoCiAgICBbdWludDMyXSRidWZmZXJTaXplID0gW1ZzdHNUYXNrU2RrLkZTLk5hdGl2ZU1ldGhvZHNdOjpHZXRGdWxsUGF0aE5hbWUoJFBhdGgsIDAsICRudWxsLCAkbnVsbCkKICAgIFtpbnRdJGxhc3RXaW4zMkVycm9yID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0TGFzdFdpbjMyRXJyb3IoKQogICAgaWYgKCRidWZmZXJTaXplIC1ndCAwKSB7CiAgICAgICAgJGFic29sdXRlUGF0aCA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuU3RyaW5nQnVpbGRlcihbaW50XSRidWZmZXJTaXplKQogICAgICAgIFt1aW50MzJdJGxlbmd0aCA9IFtWc3RzVGFza1Nkay5GUy5OYXRpdmVNZXRob2RzXTo6R2V0RnVsbFBhdGhOYW1lKCRQYXRoLCAkYnVmZmVyU2l6ZSwgJGFic29sdXRlUGF0aCwgJG51bGwpCiAgICAgICAgJGxhc3RXaW4zMkVycm9yID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0TGFzdFdpbjMyRXJyb3IoKQogICAgICAgIGlmICgkbGVuZ3RoIC1ndCAwKSB7CiAgICAgICAgICAgICRvdXRQYXRoID0gJGFic29sdXRlUGF0aC5Ub1N0cmluZygpCiAgICAgICAgfSBlbHNlICB7CiAgICAgICAgICAgIHRocm93IChOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uQ29tcG9uZW50TW9kZWwuV2luMzJFeGNlcHRpb24gLUFyZ3VtZW50TGlzdCBAKAogICAgICAgICAgICAgICAgJGxhc3RXaW4zMkVycm9yCiAgICAgICAgICAgICAgICBHZXQtTG9jU3RyaW5nIC1LZXkgUFNMSUJfUGF0aExlbmd0aE5vdFJldHVybmVkRm9yMCAtQXJndW1lbnRMaXN0ICRQYXRoCiAgICAgICAgICAgICkpCiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyAoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkNvbXBvbmVudE1vZGVsLldpbjMyRXhjZXB0aW9uIC1Bcmd1bWVudExpc3QgQCgKICAgICAgICAgICAgJGxhc3RXaW4zMkVycm9yCiAgICAgICAgICAgIEdldC1Mb2NTdHJpbmcgLUtleSBQU0xJQl9QYXRoTGVuZ3RoTm90UmV0dXJuZWRGb3IwIC1Bcmd1bWVudExpc3QgJFBhdGgKICAgICAgICApKQogICAgfQoKICAgIGlmICgkb3V0UGF0aC5FbmRzV2l0aCgnXCcpIC1hbmQgISRvdXRQYXRoLkVuZHNXaXRoKCc6XCcpKSB7CiAgICAgICAgJG91dFBhdGggPSAkb3V0UGF0aC5UcmltRW5kKCdcJykKICAgIH0KCiAgICAkb3V0UGF0aAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVHlwZXMuCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBJZiB0aGUgdHlwZSBoYXMgYWxyZWFkeSBiZWVuIGxvYWRlZCBvbmNlLCB0aGVuIGl0IGlzIG5vdCBsb2FkZWQgYWdhaW4uCldyaXRlLVZlcmJvc2UgIkFkZGluZyBsb25nIHBhdGggbmF0aXZlIG1ldGhvZHMuIgpBZGQtVHlwZSAtRGVidWc6JGZhbHNlIC1UeXBlRGVmaW5pdGlvbiBAJwpuYW1lc3BhY2UgVnN0c1Rhc2tTZGsuRlMKewogICAgdXNpbmcgU3lzdGVtOwogICAgdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTmF0aXZlTWV0aG9kcwogICAgewogICAgICAgIHByaXZhdGUgY29uc3Qgc3RyaW5nIEtlcm5lbDMyRGxsID0gImtlcm5lbDMyLmRsbCI7CgogICAgICAgIFtEbGxJbXBvcnQoS2VybmVsMzJEbGwsIENoYXJTZXQgPSBDaGFyU2V0LlVuaWNvZGUsIEJlc3RGaXRNYXBwaW5nID0gZmFsc2UsIFRocm93T25Vbm1hcHBhYmxlQ2hhciA9IHRydWUpXQogICAgICAgIFtyZXR1cm46IE1hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJvb2wpXQogICAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgRmluZENsb3NlKEludFB0ciBoRmluZEZpbGUpOwoKICAgICAgICAvLyBIQU5ETEUgV0lOQVBJIEZpbmRGaXJzdEZpbGUoCiAgICAgICAgLy8gICBfSW5fICBMUENUU1RSICAgICAgICAgICBscEZpbGVOYW1lLAogICAgICAgIC8vICAgX091dF8gTFBXSU4zMl9GSU5EX0RBVEEgbHBGaW5kRmlsZURhdGEKICAgICAgICAvLyApOwogICAgICAgIFtEbGxJbXBvcnQoS2VybmVsMzJEbGwsIENoYXJTZXQgPSBDaGFyU2V0LlVuaWNvZGUsIEJlc3RGaXRNYXBwaW5nID0gZmFsc2UsIFRocm93T25Vbm1hcHBhYmxlQ2hhciA9IHRydWUsIFNldExhc3RFcnJvciA9IHRydWUpXQogICAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIFNhZmVGaW5kSGFuZGxlIEZpbmRGaXJzdEZpbGUoCiAgICAgICAgICAgIFtNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5MUFRTdHIpXQogICAgICAgICAgICBzdHJpbmcgZmlsZU5hbWUsCiAgICAgICAgICAgIFtJbiwgT3V0XSBGaW5kRGF0YSBmaW5kRmlsZURhdGEKICAgICAgICApOwoKICAgICAgICAvL0hBTkRMRSBXSU5BUEkgRmluZEZpcnN0RmlsZUV4KAogICAgICAgIC8vICBfSW5fICAgICAgIExQQ1RTVFIgICAgICAgICAgICBscEZpbGVOYW1lLAogICAgICAgIC8vICBfSW5fICAgICAgIEZJTkRFWF9JTkZPX0xFVkVMUyBmSW5mb0xldmVsSWQsCiAgICAgICAgLy8gIF9PdXRfICAgICAgTFBWT0lEICAgICAgICAgICAgIGxwRmluZEZpbGVEYXRhLAogICAgICAgIC8vICBfSW5fICAgICAgIEZJTkRFWF9TRUFSQ0hfT1BTICBmU2VhcmNoT3AsCiAgICAgICAgLy8gIF9SZXNlcnZlZF8gTFBWT0lEICAgICAgICAgICAgIGxwU2VhcmNoRmlsdGVyLAogICAgICAgIC8vICBfSW5fICAgICAgIERXT1JEICAgICAgICAgICAgICBkd0FkZGl0aW9uYWxGbGFncwogICAgICAgIC8vKTsKICAgICAgICBbRGxsSW1wb3J0KEtlcm5lbDMyRGxsLCBDaGFyU2V0ID0gQ2hhclNldC5Vbmljb2RlLCBCZXN0Rml0TWFwcGluZyA9IGZhbHNlLCBUaHJvd09uVW5tYXBwYWJsZUNoYXIgPSB0cnVlLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0KICAgICAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBTYWZlRmluZEhhbmRsZSBGaW5kRmlyc3RGaWxlRXgoCiAgICAgICAgICAgIFtNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5MUFRTdHIpXQogICAgICAgICAgICBzdHJpbmcgZmlsZU5hbWUsCiAgICAgICAgICAgIFtJbl0gRmluZEluZm9MZXZlbCBmSW5mb0xldmVsSWQsCiAgICAgICAgICAgIFtJbiwgT3V0XSBGaW5kRGF0YSBscEZpbmRGaWxlRGF0YSwKICAgICAgICAgICAgW0luXSBGaW5kU2VhcmNoT3BzIGZTZWFyY2hPcCwKICAgICAgICAgICAgSW50UHRyIGxwU2VhcmNoRmlsdGVyLAogICAgICAgICAgICBbSW5dIEZpbmRGbGFncyBkd0FkZGl0aW9uYWxGbGFncwogICAgICAgICk7CgogICAgICAgIFtEbGxJbXBvcnQoS2VybmVsMzJEbGwsIENoYXJTZXQgPSBDaGFyU2V0LlVuaWNvZGUsIEJlc3RGaXRNYXBwaW5nID0gZmFsc2UsIFRocm93T25Vbm1hcHBhYmxlQ2hhciA9IHRydWUsIFNldExhc3RFcnJvciA9IHRydWUpXQogICAgICAgIFtyZXR1cm46IE1hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJvb2wpXQogICAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgRmluZE5leHRGaWxlKFNhZmVGaW5kSGFuZGxlIGhGaW5kRmlsZSwgW0luLCBPdXRdIEZpbmREYXRhIGxwRmluZEZpbGVEYXRhKTsKCiAgICAgICAgW0RsbEltcG9ydChLZXJuZWwzMkRsbCwgQ2hhclNldCA9IENoYXJTZXQuVW5pY29kZSwgQmVzdEZpdE1hcHBpbmcgPSBmYWxzZSwgVGhyb3dPblVubWFwcGFibGVDaGFyID0gdHJ1ZSwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IEdldEZpbGVBdHRyaWJ1dGVzKHN0cmluZyBscEZpbGVOYW1lKTsKCiAgICAgICAgW0RsbEltcG9ydChLZXJuZWwzMkRsbCwgQ2hhclNldCA9IENoYXJTZXQuVW5pY29kZSwgQmVzdEZpdE1hcHBpbmcgPSBmYWxzZSwgVGhyb3dPblVubWFwcGFibGVDaGFyID0gdHJ1ZSwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gdWludCBHZXRGdWxsUGF0aE5hbWUoCiAgICAgICAgICAgIFtNYXJzaGFsQXMoVW5tYW5hZ2VkVHlwZS5MUFRTdHIpXQogICAgICAgICAgICBzdHJpbmcgbHBGaWxlTmFtZSwKICAgICAgICAgICAgdWludCBuQnVmZmVyTGVuZ3RoLAogICAgICAgICAgICBbT3V0XQogICAgICAgICAgICBTeXN0ZW0uVGV4dC5TdHJpbmdCdWlsZGVyIGxwQnVmZmVyLAogICAgICAgICAgICBTeXN0ZW0uVGV4dC5TdHJpbmdCdWlsZGVyIGxwRmlsZVBhcnQKICAgICAgICApOwogICAgfQoKICAgIC8vZm9yIG1hcHBpbmcgdG8gdGhlIFdJTjMyX0ZJTkRfREFUQSBuYXRpdmUgc3RydWN0dXJlCiAgICBbU3RydWN0TGF5b3V0KExheW91dEtpbmQuU2VxdWVudGlhbCwgQ2hhclNldCA9IENoYXJTZXQuVW5pY29kZSldCiAgICBwdWJsaWMgc2VhbGVkIGNsYXNzIEZpbmREYXRhCiAgICB7CiAgICAgICAgLy8gTk9URToKICAgICAgICAvLyBBbHRob3VnaCBpdCBtYXkgc2VlbSBjb3JyZWN0IHRvIE1hcnNoYWwgdGhlIHN0cmluZyBtZW1iZXJzIG9mIHRoaXMgY2xhc3MgYXMgVW5tYW5hZ2VkVHlwZS5MUFdTdHIsIHRoZXkKICAgICAgICAvLyBtdXN0IGV4cGxpY2l0bHkgcmVtYWluIFVubWFuYWdlZFR5cGUuQnlWYWxUU3RyIHdpdGggdGhlIHNpemUgY29uc3RyYWludHMgbm90ZWQuICBPdGhlcndpc2Ugd2UgZW5kIHVwIHdpdGgKICAgICAgICAvLyBDT00gSW50ZXJvcCBleGNlcHRpb25zIHdoaWxlIHRyeWluZyB0byBtYXJzaGFsIHRoZSBkYXRhIGFjcm9zcyB0aGUgUEludm9rZSBib3VuZGFyaWVzLgogICAgICAgIHB1YmxpYyBpbnQgZmlsZUF0dHJpYnV0ZXM7CiAgICAgICAgcHVibGljIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5Db21UeXBlcy5GSUxFVElNRSBjcmVhdGlvblRpbWU7CiAgICAgICAgcHVibGljIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5Db21UeXBlcy5GSUxFVElNRSBsYXN0QWNjZXNzVGltZTsKICAgICAgICBwdWJsaWMgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkNvbVR5cGVzLkZJTEVUSU1FIGxhc3RXcml0ZVRpbWU7CiAgICAgICAgcHVibGljIGludCBuRmlsZVNpemVIaWdoOwogICAgICAgIHB1YmxpYyBpbnQgbkZpbGVTaXplTG93OwogICAgICAgIHB1YmxpYyBpbnQgZHdSZXNlcnZlZDA7CiAgICAgICAgcHVibGljIGludCBkd1Jlc2VydmVkMTsKICAgICAgICBbTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQnlWYWxUU3RyLCBTaXplQ29uc3QgPSAyNjApXQogICAgICAgIHB1YmxpYyBzdHJpbmcgZmlsZU5hbWU7CiAgICAgICAgW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJ5VmFsVFN0ciwgU2l6ZUNvbnN0ID0gMTQpXQogICAgICAgIHB1YmxpYyBzdHJpbmcgYWx0ZXJuYXRlRmlsZU5hbWU7CiAgICB9CgogICAgLy9BIFdpbjMyIHNhZmUgZmluZCBoYW5kbGUgaW4gd2hpY2ggYSByZXR1cm4gdmFsdWUgb2YgLTEgaW5kaWNhdGVzIGl0J3MgaW52YWxpZAogICAgcHVibGljIHNlYWxlZCBjbGFzcyBTYWZlRmluZEhhbmRsZSA6IE1pY3Jvc29mdC5XaW4zMi5TYWZlSGFuZGxlcy5TYWZlSGFuZGxlTWludXNPbmVJc0ludmFsaWQKICAgIHsKICAgICAgICBwdWJsaWMgU2FmZUZpbmRIYW5kbGUoKQogICAgICAgICAgICA6IGJhc2UodHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIFtTeXN0ZW0uUnVudGltZS5Db25zdHJhaW5lZEV4ZWN1dGlvbi5SZWxpYWJpbGl0eUNvbnRyYWN0KFN5c3RlbS5SdW50aW1lLkNvbnN0cmFpbmVkRXhlY3V0aW9uLkNvbnNpc3RlbmN5LldpbGxOb3RDb3JydXB0U3RhdGUsIFN5c3RlbS5SdW50aW1lLkNvbnN0cmFpbmVkRXhlY3V0aW9uLkNlci5TdWNjZXNzKV0KICAgICAgICBwcm90ZWN0ZWQgb3ZlcnJpZGUgYm9vbCBSZWxlYXNlSGFuZGxlKCkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBOYXRpdmVNZXRob2RzLkZpbmRDbG9zZShoYW5kbGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBSZWZlciBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9nZzI1ODExNyh2PXZzLjg1KS5hc3B4CiAgICBbRmxhZ3NdCiAgICBwdWJsaWMgZW51bSBBdHRyaWJ1dGVzIDogdWludAogICAgewogICAgICAgIE5vbmUgPSAweDAwMDAwMDAwLAogICAgICAgIFJlYWRvbmx5ID0gMHgwMDAwMDAwMSwKICAgICAgICBIaWRkZW4gPSAweDAwMDAwMDAyLAogICAgICAgIFN5c3RlbSA9IDB4MDAwMDAwMDQsCiAgICAgICAgRGlyZWN0b3J5ID0gMHgwMDAwMDAxMCwKICAgICAgICBBcmNoaXZlID0gMHgwMDAwMDAyMCwKICAgICAgICBEZXZpY2UgPSAweDAwMDAwMDQwLAogICAgICAgIE5vcm1hbCA9IDB4MDAwMDAwODAsCiAgICAgICAgVGVtcG9yYXJ5ID0gMHgwMDAwMDEwMCwKICAgICAgICBTcGFyc2VGaWxlID0gMHgwMDAwMDIwMCwKICAgICAgICBSZXBhcnNlUG9pbnQgPSAweDAwMDAwNDAwLAogICAgICAgIENvbXByZXNzZWQgPSAweDAwMDAwODAwLAogICAgICAgIE9mZmxpbmUgPSAweDAwMDAxMDAwLAogICAgICAgIE5vdENvbnRlbnRJbmRleGVkID0gMHgwMDAwMjAwMCwKICAgICAgICBFbmNyeXB0ZWQgPSAweDAwMDA0MDAwLAogICAgICAgIEludGVncml0eVN0cmVhbSA9IDB4MDAwMDgwMDAsCiAgICAgICAgVmlydHVhbCA9IDB4MDAwMTAwMDAsCiAgICAgICAgTm9TY3J1YkRhdGEgPSAweDAwMDIwMDAwLAogICAgICAgIFdyaXRlX1Rocm91Z2ggPSAweDgwMDAwMDAwLAogICAgICAgIE92ZXJsYXBwZWQgPSAweDQwMDAwMDAwLAogICAgICAgIE5vQnVmZmVyaW5nID0gMHgyMDAwMDAwMCwKICAgICAgICBSYW5kb21BY2Nlc3MgPSAweDEwMDAwMDAwLAogICAgICAgIFNlcXVlbnRpYWxTY2FuID0gMHgwODAwMDAwMCwKICAgICAgICBEZWxldGVPbkNsb3NlID0gMHgwNDAwMDAwMCwKICAgICAgICBCYWNrdXBTZW1hbnRpY3MgPSAweDAyMDAwMDAwLAogICAgICAgIFBvc2l4U2VtYW50aWNzID0gMHgwMTAwMDAwMCwKICAgICAgICBPcGVuUmVwYXJzZVBvaW50ID0gMHgwMDIwMDAwMCwKICAgICAgICBPcGVuTm9SZWNhbGwgPSAweDAwMTAwMDAwLAogICAgICAgIEZpcnN0UGlwZUluc3RhbmNlID0gMHgwMDA4MDAwMAogICAgfQoKICAgIFtGbGFnc10KICAgIHB1YmxpYyBlbnVtIEZpbmRGbGFncwogICAgewogICAgICAgIE5vbmUgPSAwLAogICAgICAgIENhc2VTZW5zaXRpdmUgPSAxLAogICAgICAgIExhcmdlRmV0Y2ggPSAyLAogICAgfQoKICAgIHB1YmxpYyBlbnVtIEZpbmRJbmZvTGV2ZWwKICAgIHsKICAgICAgU3RhbmRhcmQgPSAwLAogICAgICBCYXNpYyA9IDEsCiAgICB9CgogICAgcHVibGljIGVudW0gRmluZFNlYXJjaE9wcwogICAgewogICAgICAgIE5hbWVNYXRjaCA9IDAsCiAgICAgICAgTGltaXRUb0RpcmVjdG9yaWVzID0gMSwKICAgICAgICBMaW1pdFRvRGV2aWNlcyA9IDIsCiAgICB9Cn0KJ0AK
