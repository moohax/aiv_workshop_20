MSFT_xWindowsUpdate.psm1,7dce402872f765f0ee60a7841b9b501f,Scan result is 1. IsMalware: 0,RGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiZQogICAgQ29udmVydEZyb20tU3RyaW5nRGF0YSBAJwogICAgICAgIEdldHRpbmdIb3RmaXhNZXNzYWdlPUdldHRpbmcgdGhlIGhvdGZpeCBwYXRjaCB3aXRoIElEIHswfS4KICAgICAgICBWYWxpZGF0aW5nUGF0aFVyaT1WYWxpZGF0aW5nIHBhdGgvVVJJLgogICAgICAgIEVycm9yUGF0aFVyaVNwZWNpZmllZFRvZ2V0aGVyPUhvdGZpeCBwYXRoIGFuZCBVcmkgcGFyYW1ldGVycyBjYW5ub3QgYmUgc3BlY2lmaWVkIHRvZ2V0aGVyLgogICAgICAgIEVycm9ySW52YWxpZEZpbGVQYXRoTXN1PUZpbGVuYW1lIHByb3ZpZGVkIGlzIGFuIGludmFsaWQgZmlsZSBwYXRoIGZvciBob3RmaXggc2luY2UgaXQgZG9lcyBub3QgaGF2ZSB0aGUgbXN1IHN1ZmZpeCB0byBpdC4KICAgICAgICBTdGFydEtleVdvcmQ9U1RBUlQKICAgICAgICBFbmRLZXlXb3JkPSBFTkQKICAgICAgICBGYWlsZWRLZXl3b3JkID0gRkFJTEVECiAgICAgICAgQWN0aW9uRG93bmxvYWRGcm9tVXJpPSBEb3dubG9hZCBmcm9tIHswfSB1c2luZyBCaXRzVHJhbnNmZXIKICAgICAgICBBY3Rpb25JbnN0YWxsVXNpbmd3c3VzYSA9IEluc3RhbGwgdXNpbmcgd3N1c2EuZXhlCiAgICAgICAgQWN0aW9uVW5pbnN0YWxsVXNpbmd3c3VzYSA9IFVuaW5zdGFsbCB1c2luZyB3c3VzYS5leGUKICAgICAgICBEb3dubG9hZGluZ1BhY2thZ2VUbyA9IERvd25sb2FkaW5nIHBhY2thZ2UgdG8gZmlsZXBhdGggezB9CiAgICAgICAgRmlsZURvZXNudEV4aXN0PVRoZSBnaXZlbiBwYXRoIHswfSBkb2VzIG5vdCBleGlzdC4KICAgICAgICBMb2dOb3RTcGVjaWZpZWQ9TG9nIG5hbWUgaGFzbid0IGJlZW4gc3BlY2lmaWVkLiBIb3RmaXggd2lsbCB1c2UgdGhlIHRlbXBvcmFyeSBsb2cgezB9IAogICAgICAgIEVycm9yT2NjdXJlZE9uSG90Zml4SW5zdGFsbCA9IFxuQ291bGQgbm90IGluc3RhbGwgdGhlIHdpbmRvd3MgdXBkYXRlLiBEZXRhaWxzIGFyZSBzdG9yZWQgaW4gdGhlIGxvZyB7MH0gLiBFcnJvciBtZXNzYWdlIGlzIFxuXG4gezF9ICAuXG5cblBsZWFzZSBsb29rIGF0IFdpbmRvd3MgVXBkYXRlIGVycm9yIGNvZGVzIGhlcmUgZm9yIG1vcmUgaW5mb3JtYXRpb24gLSBodHRwOi8vdGVjaG5ldC5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvZGQ5Mzk4MzcoV1MuMTApLmFzcHgKICAgICAgICBFcnJvck9jY3VyZWRPbkhvdGZpeFVuaW5uc3RhbGwgPSBcbkNvdWxkIG5vdCB1bmluc3RhbGwgdGhlIHdpbmRvd3MgdXBkYXRlLiBEZXRhaWxzIGFyZSBzdG9yZWQgaW4gdGhlIGxvZyB7MH0gLiBFcnJvciBtZXNzYWdlIGlzIFxuXG4gezF9ICAuXG5cblBsZWFzZSBsb29rIGF0IFdpbmRvd3MgVXBkYXRlIGVycm9yIGNvZGVzIGhlcmUgZm9yIG1vcmUgaW5mb3JtYXRpb24gLSBodHRwOi8vdGVjaG5ldC5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvZGQ5Mzk4MzcoV1MuMTApLmFzcHgKICAgICAgICBUZXN0aW5nRW5zdXJlID0gVGVzdGluZyB3aGV0aGVyIGhvdGZpeCBpcyB7MH0KJ0AKfQoKCiMgR2V0LVRhcmdldFJlc291cmNlIGZ1bmN0aW9uICAKZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKCVtDbWRsZXRCaW5kaW5nKCldCglbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQoJUGFyYW0KCSgKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkSWQKCSkKCiAgICBXcml0ZS1WZXJib3NlICQoJExvY2FsaXplZERhdGEuR2V0dGluZ0hvdGZpeE1lc3NhZ2UgLWYgJHtJZH0pCgkKICAgICRQU0JvdW5kUGFyYW1ldGVycy5SZW1vdmUoIklkIikKCiAgICAkaG90Zml4ID0gR2V0LUhvdEZpeCAtSWQgJElkIEBQU0JvdW5kUGFyYW1ldGVycwoJCgkkcmV0dXJuVmFsdWUgPSBAewoJCVBhdGggPSAiIgoJCUlkID0gJGhvdGZpeC5Ib3RGaXhJZAoJCUxvZyA9ICIiCgl9CgoJJHJldHVyblZhbHVlCQoKfQoKCiMgVGhlIFNldC1UYXJnZXRSZXNvdXJjZSBjbWRsZXQKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKCVtDbWRsZXRCaW5kaW5nKCldCglQYXJhbQoJKAoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRQYXRoLAoKCQlbU3lzdGVtLlN0cmluZ10KCQkkVXJpLAoKCQlbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkSWQsCgoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRMb2csCgoJCVtWYWxpZGF0ZVNldCgiUHJlc2VudCIsIkFic2VudCIpXQoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRFbnN1cmU9IlByZXNlbnQiCgkpCiAgICBpZiAoISRMb2cpCiAgICB7CiAgICAgICAgJExvZyA9IFtJTy5QYXRoXTo6R2V0VGVtcEZpbGVOYW1lKCkKICAgICAgICAkTG9nICs9ICIuZXRsIgoKICAgICAgICBXcml0ZS1WZXJib3NlICIkKCRMb2NhbGl6ZWREYXRhLkxvZ05vdFNwZWNpZmllZCAtZiAke0xvZ30pIgogICAgfQogICAgaWYoJEVuc3VyZSAtZXEgIlByZXNlbnQiKQogICAgewogICAgICAgICRQU0JvdW5kUGFyYW1ldGVycy5SZW1vdmUoIkVuc3VyZSIpID4gJG51bGwKICAgICAgICAkUFNCb3VuZFBhcmFtZXRlcnMuUmVtb3ZlKCJMb2ciKSA+ICRudWxsCiAgICAgICAgJFBTQm91bmRQYXJhbWV0ZXJzLlJlbW92ZSgiSWQiKSA+ICRudWxsCiAgICAgICAgJGZpbGVQYXRoID0gR2V0LUZpbGVQYXRoIEBQU0JvdW5kUGFyYW1ldGVycyAKICAgICAgICBXcml0ZS1WZXJib3NlICIkKCRMb2NhbGl6ZWREYXRhLlN0YXJ0S2V5V29yZCkgJCgkTG9jYWxpemVkRGF0YS5BY3Rpb25JbnN0YWxsVXNpbmd3c3VzYSkiCiAgICAKICAgICAgICBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAid3VzYS5leGUiIC1Bcmd1bWVudExpc3QgImAiJGZpbGVwYXRoYCIgL3F1aWV0IC9ub3Jlc3RhcnQgL2xvZzokTG9nIiAtV2FpdCAtTm9OZXdXaW5kb3cgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAkZXJyb3JPY2N1cmVkID0gR2V0LVdpbkV2ZW50IC1QYXRoICRMb2cgLU9sZGVzdCB8IFdoZXJlLU9iamVjdCB7JF8uSWQgLWVxIDN9ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIGlmKCRlcnJvck9jY3VyZWQpCiAgICAgICAgewogICAgICAgICAgICAkZXJyb3JNZXNzYWdlPSAkZXJyb3JPY2N1cmVkLk1lc3NhZ2UKICAgICAgICAgICAgVGhyb3cgIiQoJExvY2FsaXplZERhdGEuRXJyb3JPY2N1cmVkT25Ib3RmaXhJbnN0YWxsIC1mICR7TG9nfSwgJHtlcnJvck1lc3NhZ2V9KSIKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJExvY2FsaXplZERhdGEuRW5kS2V5V29yZCkgJCgkTG9jYWxpemVkRGF0YS5BY3Rpb25JbnN0YWxsVXNpbmd3c3VzYSkiCgoJICAgIAogICAgICAgIAogICAgCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiJCgkTG9jYWxpemVkRGF0YS5TdGFydEtleVdvcmQpICQoJExvY2FsaXplZERhdGEuQWN0aW9uVW5pbnN0YWxsVXNpbmd3c3VzYSkiCiAgICAKICAgICAgICBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAid3VzYS5leGUiIC1Bcmd1bWVudExpc3QgIi91bmluc3RhbGwgL0tCOiRJZCAvcXVpZXQgL25vcmVzdGFydCAvbG9nOiRMb2ciIC1XYWl0IC1Ob05ld1dpbmRvdyAgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAjUmVhZCB0aGUgbG9nIGFuZCBzZWUgaWYgdGhlcmUgd2FzIGFuIGVycm9yIGV2ZW50CiAgICAgICAgJGVycm9yT2NjdXJlZCA9IEdldC1XaW5FdmVudCAtUGF0aCAkTG9nIC1PbGRlc3QgfCBXaGVyZS1PYmplY3QgeyRfLklkIC1lcSAzfSAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBpZigkZXJyb3JPY2N1cmVkKQogICAgICAgIHsKICAgICAgICAgICAgJGVycm9yTWVzc2FnZT0gJGVycm9yT2NjdXJlZC5NZXNzYWdlCiAgICAgICAgICAgIFRocm93ICIkKCRMb2NhbGl6ZWREYXRhLkVycm9yT2NjdXJlZE9uSG90Zml4VW5pbnN0YWxsIC1mICR7TG9nfSwgJHtlcnJvck1lc3NhZ2V9KSIKICAgICAgICB9CgogICAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJExvY2FsaXplZERhdGEuRW5kS2V5V29yZCkgJCgkTG9jYWxpemVkRGF0YS5BY3Rpb25Vbmluc3RhbGxVc2luZ3dzdXNhKSIKCgkgICAgCiAgICB9CiAgICAKICAgIGlmICgkTEFTVEVYSVRDT0RFIC1lcSAzMDEwKQogICAgewoJICAgICRnbG9iYWw6RFNDTWFjaGluZVN0YXR1cyA9IDEgICAgICAgIAogICAgfQogICAgICAgICAgICAKICAgIAp9CgoKIyBGdW5jdGlvbiB0byB0ZXN0IGlmIEhvdGZpeCBpcyBpbnN0YWxsZWQuCmZ1bmN0aW9uIFRlc3QtVGFyZ2V0UmVzb3VyY2UKewoJW0NtZGxldEJpbmRpbmcoKV0KCVtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQoJcGFyYW0KCSgKCQlbU3lzdGVtLlN0cmluZ10KCQkkUGF0aCwKCgkJW1N5c3RlbS5TdHJpbmddCgkJJFVyaSwKCgkJW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCgkJW1N5c3RlbS5TdHJpbmddCgkJJElkLAoKCQlbU3lzdGVtLlN0cmluZ10KCQkkTG9nLAoKCQlbVmFsaWRhdGVTZXQoIlByZXNlbnQiLCJBYnNlbnQiKV0KCQlbU3lzdGVtLlN0cmluZ10KCQkkRW5zdXJlPSJQcmVzZW50IgoJKQogICAgV3JpdGUtVmVyYm9zZSAiJCgkTG9jYWxpemVkRGF0YS5UZXN0aW5nRW5zdXJlIC1mICR7RW5zdXJlfSkiCiAgICBWYWxpZGF0ZVBhdGhBbmRVcmlFeGNsdXNpdmUgLVBhdGggJFBhdGggLVVyaSAkVXJpCiAgICAKCSRyZXN1bHQgPSBHZXQtSG90Rml4IC1JZCAkSWQgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCSRyZXR1cm5WYWx1ZT0gIFtib29sXSRyZXN1bHQKICAgIGlmKCRFbnN1cmUgLWVxICJQcmVzZW50IikKICAgIHsKCiAgICAJUmV0dXJuICRyZXR1cm5WYWx1ZQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFJldHVybiAhJHJldHVyblZhbHVlCiAgICB9Cgp9CgoKI0Z1bmN0aW9uIHRvIGxvb2sgYXQgdGhlIHBhdGggb3IgdXJpIGFuZCByZXR1cm4gdGhlIHBhdGggbmFtZSBvZiB0aGUgbXN1IGZpbGUKRnVuY3Rpb24gR2V0LUZpbGVQYXRoCnsKICAgIFBhcmFtKFtTeXN0ZW0uU3RyaW5nXQoJCSRQYXRoLAoKCQlbU3lzdGVtLlN0cmluZ10KCQkkVXJpKQogICAgICAgIAogICAgVmFsaWRhdGVQYXRoQW5kVXJpRXhjbHVzaXZlIC1QYXRoICRQYXRoIC1VcmkgJFVyaQoKICAgIGlmICgkcGF0aCAtbmUgJG51bGwpCiAgICB7CiAgICAgICAgIyBjaGVjayBpZiAkcGF0aCByZXByZXNlbnRzIGEgLm1zdSBmaWxlIAogICAgICAgICRmaWxlbmFtZSA9IFNwbGl0LVBhdGggLVBhdGggJFBhdGggLUxlYWYKCiAgICAgICAgaWYgKCEoJGZpbGVuYW1lLlN1YnN0cmluZygkZmlsZW5hbWUuTGVuZ3RoIC0gMykgLWllcSAibXN1IikpCiAgICAgICAgewogICAgICAgICAgICBUaHJvdyAkTG9jYWxpemVkRGF0YS5FcnJvckludmFsaWRGaWxlUGF0aE1zdQogICAgICAgIH0KICAgICAgICBpZighW0lPLkZpbGVdOjpFeGlzdHMoJFBhdGgpKQogICAgICAgIHsKICAgICAgICAgICAgVGhyb3cgJExvY2FsaXplZERhdGEuRmlsZURvZXNudEV4aXN0IC1mICR7UGF0aH0KICAgICAgICB9CiAgICAgICAgJGZpbGVwYXRoID0gJFBhdGgKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAgJGZpbGVwYXRoID0gW2lvLnBhdGhdOjpHZXRUZW1wRmlsZU5hbWUoKQogICAgICAgICAkZmlsZXBhdGggKz0gIi5tc3UiCiAgICAgICAgIFdyaXRlLVZlcmJvc2UgIiQoJExvY2FsaXplZERhdGEuU3RhcnRLZXlXb3JkKSAkKCRMb2NhbGl6ZWREYXRhLkFjdGlvbkRvd25sb2FkRnJvbVVyaSAtZiAke1VyaX0pICIKICAgICAgICAgCiAgICAgICAgICRiaXRzVHJhbnNmZXJQYXJhbWV0ZXJzPSBAeyBTb3VyY2UgPSAkVXJpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzdGluYXRpb249ICRmaWxlUGF0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uID0gIkZyb20gYCckVXJpJ2AgIiA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFcnJvclZhcmlhYmxlID0gImVycm9yT2NjdXJlZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEaXNwbGF5TmFtZSA9ICQoJExvY2FsaXplZERhdGEuRG93bmxvYWRpbmdQYWNrYWdlVG8gLWYgJHtmaWxlUGF0aH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPSAiRm9yZUdyb3VuZCJ9CgoKICAgICAgICAgU3RhcnQtQml0c1RyYW5zZmVyIEBiaXRzVHJhbnNmZXJQYXJhbWV0ZXJzCgogICAgICAgICBpZiAoJGVycm9yT2NjdXJlZCkKICAgICAgICAgewogICAgICAgICAgICBUaHJvdyAgIiQoJExvY2FsaXplZERhdGEuQWN0aW9uRG93bmxvYWRGcm9tVXJpIC1mICR7VXJpfSkgJCgkTG9jYWxpemVkRGF0YS5GYWlsZWRLZXlXb3JkKSIgCiAgICAgICAgIH0KICAgICAgICAgV3JpdGUtVmVyYm9zZSAiJCgkTG9jYWxpemVkRGF0YS5FbmRLZXlXb3JkKSAkKCRMb2NhbGl6ZWREYXRhLkFjdGlvbkRvd25sb2FkRnJvbVVyaSAtZiAke1VyaX0pIiAKICAgIAogICAgfQoKICAgIFJldHVybiAkZmlsZVBhdGgKCiAgICAKfQoKCiNGdW5jdGlvbiB0byB2YWxpZGF0ZSB0aGF0IGVpdGhlciB0aGUgcGF0aCBvciBVUkkgYXJlIGVudGVyZWQKZnVuY3Rpb24gVmFsaWRhdGVQYXRoQW5kVXJpRXhjbHVzaXZlCnsKCXBhcmFtCgkoCgkJW1N5c3RlbS5TdHJpbmddCgkJJFBhdGgsCgoJCVtTeXN0ZW0uU3RyaW5nXQoJCSRVcmkKCSkKICAgIFdyaXRlLVZlcmJvc2UgJCgkTG9jYWxpemVkRGF0YS5WYWxpZGF0aW5nUGF0aFVyaSkKCQogICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRQYXRoKSAtYW5kICFbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkVXJpKSkKICAgIHsKCSAgICBSZXR1cm4KICAgIH0KICAgIGlmICghW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFBhdGgpIC1hbmQgW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFVyaSkpCiAgICB7CgkgICAgUmV0dXJuCiAgICB9CgogICAgJGVycm9yTWVzc2FnZT0gJExvY2FsaXplZERhdGEuRXJyb3JQYXRoVXJpU3BlY2lmaWVkVG9nZXRoZXIKICAgIFRocm93ICRlcnJvck1lc3NhZ2UKfQoKCgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCgoK
