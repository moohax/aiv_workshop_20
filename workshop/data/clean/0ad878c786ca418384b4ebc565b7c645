MSFT_xExchWaitForMailboxDatabase.psm1,d9060415094fa9ec036040883f4b08a9,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZV0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkSWRlbnRpdHksCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbCwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRSZXRyeUludGVydmFsU2VjID0gNjAsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRSZXRyeUNvdW50ID0gNSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEFkU2VydmVyU2V0dGluZ3NQcmVmZXJyZWRTZXJ2ZXIKICAgICkKCiAgICAjTG9hZCBoZWxwZXIgbW9kdWxlCiAgICBJbXBvcnQtTW9kdWxlICIkKChHZXQtSXRlbSAtTGl0ZXJhbFBhdGggIiQoJFBTU2NyaXB0Um9vdCkiKS5QYXJlbnQuUGFyZW50LkZ1bGxOYW1lKVxNaXNjXHhFeGNoYW5nZUNvbW1vbi5wc20xIiAtVmVyYm9zZTowCgogICAgTG9nRnVuY3Rpb25FbnRyeSAtUGFyYW1ldGVycyBAeyJJZGVudGl0eSIgPSAkSWRlbnRpdHl9IC1WZXJib3NlUHJlZmVyZW5jZSAkVmVyYm9zZVByZWZlcmVuY2UKCiAgICAjRXN0YWJsaXNoIHJlbW90ZSBQb3dlcnNoZWxsIHNlc3Npb24KICAgIEdldFJlbW90ZUV4Y2hhbmdlU2Vzc2lvbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQ29tbWFuZHNUb0xvYWQgIkdldC1NYWlsYm94RGF0YWJhc2UiLCJTZXQtQWRTZXJ2ZXJTZXR0aW5ncyIgLVZlcmJvc2VQcmVmZXJlbmNlICRWZXJib3NlUHJlZmVyZW5jZQoKICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIkFkU2VydmVyU2V0dGluZ3NQcmVmZXJyZWRTZXJ2ZXIiKSAtYW5kICFbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkQWRTZXJ2ZXJTZXR0aW5nc1ByZWZlcnJlZFNlcnZlcikpCiAgICB7CiAgICAgICAgU2V0LUFEU2VydmVyU2V0dGluZ3Mg4oCTUHJlZmVycmVkU2VydmVyICIkKCRBZFNlcnZlclNldHRpbmdzUHJlZmVycmVkU2VydmVyKSIKICAgIH0KCiAgICAkZGIgPSBHZXRNYWlsYm94RGF0YWJhc2UgQFBTQm91bmRQYXJhbWV0ZXJzCgogICAgaWYgKCRkYiAtbmUgJG51bGwpCiAgICB7CiAgICAgICAgJHJldHVyblZhbHVlID0gQHsKICAgICAgICAgICAgSWRlbnRpdHkgPSAkSWRlbnRpdHkKICAgICAgICB9ICAgIAogICAgfQoKICAgICRyZXR1cm5WYWx1ZQp9CgoKZnVuY3Rpb24gU2V0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBwYXJhbQogICAgKAogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRJZGVudGl0eSwKCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsLAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRG9tYWluQ29udHJvbGxlciwKCiAgICAgICAgW1N5c3RlbS5VSW50MzJdCiAgICAgICAgJFJldHJ5SW50ZXJ2YWxTZWMgPSA2MCwKCiAgICAgICAgW1N5c3RlbS5VSW50MzJdCiAgICAgICAgJFJldHJ5Q291bnQgPSA1LAoKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkQWRTZXJ2ZXJTZXR0aW5nc1ByZWZlcnJlZFNlcnZlcgogICAgKQoKICAgICNMb2FkIGhlbHBlciBtb2R1bGUKICAgIEltcG9ydC1Nb2R1bGUgIiQoKEdldC1JdGVtIC1MaXRlcmFsUGF0aCAiJCgkUFNTY3JpcHRSb290KSIpLlBhcmVudC5QYXJlbnQuRnVsbE5hbWUpXE1pc2NceEV4Y2hhbmdlQ29tbW9uLnBzbTEiIC1WZXJib3NlOjAKCiAgICBMb2dGdW5jdGlvbkVudHJ5IC1QYXJhbWV0ZXJzIEB7IklkZW50aXR5IiA9ICRJZGVudGl0eX0gLVZlcmJvc2VQcmVmZXJlbmNlICRWZXJib3NlUHJlZmVyZW5jZQoKICAgICNFc3RhYmxpc2ggcmVtb3RlIFBvd2Vyc2hlbGwgc2Vzc2lvbgogICAgR2V0UmVtb3RlRXhjaGFuZ2VTZXNzaW9uIC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1Db21tYW5kc1RvTG9hZCAiR2V0LU1haWxib3hEYXRhYmFzZSIsIlNldC1BZFNlcnZlclNldHRpbmdzIiAtVmVyYm9zZVByZWZlcmVuY2UgJFZlcmJvc2VQcmVmZXJlbmNlCgogICAgaWYgKCRQU0JvdW5kUGFyYW1ldGVycy5Db250YWluc0tleSgiQWRTZXJ2ZXJTZXR0aW5nc1ByZWZlcnJlZFNlcnZlciIpIC1hbmQgIVtzdHJpbmddOjpJc051bGxPckVtcHR5KCRBZFNlcnZlclNldHRpbmdzUHJlZmVycmVkU2VydmVyKSkKICAgIHsKICAgICAgICBTZXQtQURTZXJ2ZXJTZXR0aW5ncyDigJNQcmVmZXJyZWRTZXJ2ZXIgIiQoJEFkU2VydmVyU2V0dGluZ3NQcmVmZXJyZWRTZXJ2ZXIpIgogICAgfQoKICAgICRkYiA9IEdldE1haWxib3hEYXRhYmFzZSBAUFNCb3VuZFBhcmFtZXRlcnMKCiAgICBmb3IgKCRpID0gMDsgJGkgLWx0ICRSZXRyeUNvdW50OyAkaSsrKQogICAgewogICAgICAgIGlmICgkZGIgLWVxICRudWxsKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRGF0YWJhc2UgJyQoJElkZW50aXR5KScgZG9lcyBub3QgeWV0IGV4aXN0LiBTbGVlcGluZyBmb3IgJCgkUmV0cnlJbnRlcnZhbFNlYykgc2Vjb25kcy4iCiAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRSZXRyeUludGVydmFsU2VjCgogICAgICAgICAgICAkZGIgPSBHZXRNYWlsYm94RGF0YWJhc2UgQFBTQm91bmRQYXJhbWV0ZXJzCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgfQogICAgCiAgICBpZiAoJGRiIC1lcSAkbnVsbCkKICAgIHsKICAgICAgICB0aHJvdyAiRGF0YWJhc2UgJyQoJElkZW50aXR5KScgZG9lcyBub3QgeWV0IGV4aXN0LiBUaGlzIHdpbGwgcHJldmVudCByZXNvdXJjZXMgdGhhdCBhcmUgZGVwZW5kYW50IG9uIHRoaXMgcmVzb3VyY2UgZnJvbSBleGVjdXRpbmcuIElmIHlvdSBhcmUgcnVubmluZyB0aGUgRFNDIGNvbmZpZ3VyYXRpb24gaW4gcHVzaCBtb2RlLCB5b3Ugd2lsbCBuZWVkIHRvIHJlLXJ1biB0aGUgY29uZmlndXJhdGlvbiBvbmNlIHRoZSBkYXRhYmFzZSBoYXMgYmVlbiBjcmVhdGVkLiIKICAgIH0KfQoKCmZ1bmN0aW9uIFRlc3QtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIFtPdXRwdXRUeXBlKFtTeXN0ZW0uQm9vbGVhbl0pXQogICAgcGFyYW0KICAgICgKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkSWRlbnRpdHksCgogICAgICAgIFtwYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbF0KICAgICAgICAkQ3JlZGVudGlhbCwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERvbWFpbkNvbnRyb2xsZXIsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRSZXRyeUludGVydmFsU2VjID0gNjAsCgogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRSZXRyeUNvdW50ID0gNSwKCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEFkU2VydmVyU2V0dGluZ3NQcmVmZXJyZWRTZXJ2ZXIKICAgICkKCiAgICAjTG9hZCBoZWxwZXIgbW9kdWxlCiAgICBJbXBvcnQtTW9kdWxlICIkKChHZXQtSXRlbSAtTGl0ZXJhbFBhdGggIiQoJFBTU2NyaXB0Um9vdCkiKS5QYXJlbnQuUGFyZW50LkZ1bGxOYW1lKVxNaXNjXHhFeGNoYW5nZUNvbW1vbi5wc20xIiAtVmVyYm9zZTowCgogICAgTG9nRnVuY3Rpb25FbnRyeSAtUGFyYW1ldGVycyBAeyJJZGVudGl0eSIgPSAkSWRlbnRpdHl9IC1WZXJib3NlUHJlZmVyZW5jZSAkVmVyYm9zZVByZWZlcmVuY2UKCiAgICAjRXN0YWJsaXNoIHJlbW90ZSBQb3dlcnNoZWxsIHNlc3Npb24KICAgIEdldFJlbW90ZUV4Y2hhbmdlU2Vzc2lvbiAtQ3JlZGVudGlhbCAkQ3JlZGVudGlhbCAtQ29tbWFuZHNUb0xvYWQgIkdldC1NYWlsYm94RGF0YWJhc2UiLCJTZXQtQWRTZXJ2ZXJTZXR0aW5ncyIgLVZlcmJvc2VQcmVmZXJlbmNlICRWZXJib3NlUHJlZmVyZW5jZQoKICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuQ29udGFpbnNLZXkoIkFkU2VydmVyU2V0dGluZ3NQcmVmZXJyZWRTZXJ2ZXIiKSAtYW5kICFbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkQWRTZXJ2ZXJTZXR0aW5nc1ByZWZlcnJlZFNlcnZlcikpCiAgICB7CiAgICAgICAgU2V0LUFEU2VydmVyU2V0dGluZ3Mg4oCTUHJlZmVycmVkU2VydmVyICIkKCRBZFNlcnZlclNldHRpbmdzUHJlZmVycmVkU2VydmVyKSIKICAgIH0KCiAgICAkZGIgPSBHZXRNYWlsYm94RGF0YWJhc2UgQFBTQm91bmRQYXJhbWV0ZXJzCgogICAgcmV0dXJuICgkZGIgLW5lICRudWxsKQp9CgpmdW5jdGlvbiBHZXRNYWlsYm94RGF0YWJhc2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJElkZW50aXR5LAoKICAgICAgICBbcGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICREb21haW5Db250cm9sbGVyLAoKICAgICAgICBbU3lzdGVtLlVJbnQzMl0KICAgICAgICAkUmV0cnlJbnRlcnZhbFNlYyA9IDYwLAoKICAgICAgICBbU3lzdGVtLlVJbnQzMl0KICAgICAgICAkUmV0cnlDb3VudCA9IDUsCgogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRBZFNlcnZlclNldHRpbmdzUHJlZmVycmVkU2VydmVyCiAgICApCgogICAgUmVtb3ZlUGFyYW1ldGVycyAtUFNCb3VuZFBhcmFtZXRlcnNJbiAkUFNCb3VuZFBhcmFtZXRlcnMgLVBhcmFtc1RvS2VlcCAiSWRlbnRpdHkiLCJEb21haW5Db250cm9sbGVyIgoKICAgIHJldHVybiAoR2V0LU1haWxib3hEYXRhYmFzZSBAUFNCb3VuZFBhcmFtZXRlcnMgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpCn0KCgpFeHBvcnQtTW9kdWxlTWVtYmVyIC1GdW5jdGlvbiAqLVRhcmdldFJlc291cmNlCgoKCg==
