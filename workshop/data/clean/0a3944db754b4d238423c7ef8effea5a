KVP_ModifyNonExistKeyValue.ps1,107e045f9b8b8140244a5a123328058c,Scan result is 1. IsMalware: 0,IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKIyBMaW51eCBvbiBIeXBlci1WIGFuZCBBenVyZSBUZXN0IENvZGUsIHZlci4gMS4wLjAKIyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbgojCiMgQWxsIHJpZ2h0cyByZXNlcnZlZC4gCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICIiTGljZW5zZSIiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMCAgCiMKIyBUSElTIENPREUgSVMgUFJPVklERUQgKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMKIyBPRiBBTlkgS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTgojIEFOWSBJTVBMSUVEIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSCiMgUFVSUE9TRSwgTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC4KIwojIFNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZwojIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgo8IwouU3lub3BzaXMKICAgIE1vZGlmeSBOb24tRXhpc3RpbmcgS1ZQIGl0ZW0uCgouRGVzY3JpcHRpb24KICAgIE1vZGlmeSBOb24tRXhpc3RpbmcgS1ZQIGl0ZW0gb24gYSBMaW51eCBWTS4gIFRoZSBvcGVyYXRpb24KICAgIGlzIHBlcmZvcm1lZCBvbiB0aGUgaG9zdCBzaWRlLgogICAgIAogICAgQSBzYW1wbGUgWE1MIHRlc3QgZGVmaW5pdGlvbiBmb3IgdGhpcyB0ZXN0IGNhc2Ugd291bGQgbG9vawogICAgc2ltaWxhciB0byB0aGUgZm9sbG93aW5nOiAKCiAgICAgICAgPHRlc3Q+CgkJCTx0ZXN0TmFtZT5Nb2RpZnlOb25FeGlzdEtWUE9uR3Vlc3Q8L3Rlc3ROYW1lPgoJCQk8dGVzdFNjcmlwdD5zZXR1cHNjcmlwdHNcS1ZQX01vZGlmeU5vbkV4aXN0S2V5VmFsdWUucHMxPC90ZXN0U2NyaXB0PgoJCQk8dGltZW91dD42MDA8L3RpbWVvdXQ+CgkJCTxvbkVycm9yPkFib3J0PC9vbkVycm9yPgoJCQk8bm9SZWJvb3Q+RmFsc2U8L25vUmVib290PgoJCQk8dGVzdHBhcmFtcz4KCQkJCTxwYXJhbT5UQ19DT1ZFUkVEPTQyPC9wYXJhbT4KCQkJCTxwYXJhbT5LZXk9QUFBPC9wYXJhbT4KCQkJCTxwYXJhbT5WYWx1ZT0wMDA8L3BhcmFtPgoJCQkJPHBhcmFtPlBvb2w9MDwvcGFyYW0+CgkJCTwvdGVzdHBhcmFtcz4KCQk8L3Rlc3Q+Ci5QYXJhbWV0ZXIgdm1OYW1lCiAgICBOYW1lIG9mIHRoZSBWTSB0byByZWFkIGludHJpbnNpYyBkYXRhIGZyb20uCgouUGFyYW1ldGVyIGh2U2VydmVyCiAgICBOYW1lIG9mIHRoZSBIeXBlci1WIHNlcnZlciBob3N0aW5nIHRoZSBWTS4KCi5QYXJhbWV0ZXIgdGVzdFBhcmFtcwogICAgVGVzdCBkYXRhIGZvciB0aGlzIHRlc3QgY2FzZQoKLkV4YW1wbGUKICAgIHNldHVwU2NyaXB0c1xLVlBfTW9kaWZ5Tm9uRXhpc3RLZXlWYWx1ZS5wczEgLXZtTmFtZSAibXlWbSIgLWh2U2VydmVyICJsb2NhbGhvc3QgLVRlc3RQYXJhbXMgImtleT1hYWE7dmFsdWU9MDAwIgoKLkxpbmsKICAgIE5vbmUuCiM+CgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwojIE1haW4gc2NyaXB0IGJvZHkKIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpwYXJhbShbc3RyaW5nXSAkdm1OYW1lLCBbc3RyaW5nXSAkaHZTZXJ2ZXIsIFtzdHJpbmddICR0ZXN0UGFyYW1zKQoKCiMKIyBDaGVjayBpbnB1dCBhcmd1bWVudHMKIwppZiAoLW5vdCAkdm1OYW1lKQp7CiAgICAiRXJyb3I6IFZNIG5hbWUgaXMgbnVsbCIKICAgIHJldHVybiAkRmFsc2UKfQoKaWYgKC1ub3QgJGh2U2VydmVyKQp7CiAgICAiRXJyb3I6IGh2U2VydmVyIGlzIG51bGwiCiAgICByZXR1cm4gJEZhbHNlCn0KCmlmICgtbm90ICR0ZXN0UGFyYW1zKQp7CiAgICAiRXJyb3I6IE5vIHRlc3RQYXJhbXMgcHJvdmlkZWQiCiAgICAiICAgICAgIFRoaXMgc2NyaXB0IHJlcXVpcmVzIHRoZSBLZXkgJiB2YWx1ZSB0ZXN0IHBhcmFtZXRlcnMiCiAgICByZXR1cm4gJEZhbHNlCn0KCiMKIyBGaW5kIHRoZSB0ZXN0UGFyYW1zIHdlIHJlcXVpcmUuICBDb21wbGFpbiBpZiBub3QgZm91bmQKIwokS2V5ID0gJG51bGwKJFZhbHVlID0gJG51bGwKJHJvb3REaXIgPSAkbnVsbAokdGNDb3ZlcmVkID0gInVua25vd24iCgokcGFyYW1zID0gJHRlc3RQYXJhbXMuU3BsaXQoIjsiKQpmb3JlYWNoICgkcCBpbiAkcGFyYW1zKQp7CiAgICAkZmllbGRzID0gJHAuU3BsaXQoIj0iKQogICAgCiAgICBzd2l0Y2ggKCRmaWVsZHNbMF0uVHJpbSgpKQogICAgewogICAgImtleSIgICAgICAgIHsgJGtleSAgICAgICA9ICRmaWVsZHNbMV0uVHJpbSgpIH0KICAgICJ2YWx1ZSIgICAgICB7ICR2YWx1ZSAgICAgPSAkZmllbGRzWzFdLlRyaW0oKSB9CiAgICAicm9vdERpciIgICAgeyAkcm9vdERpciAgID0gJGZpZWxkc1sxXS5UcmltKCkgfQogICAgInRjX2NvdmVyZWQiIHsgJHRjQ292ZXJlZCA9ICRmaWVsZHNbMV0uVHJpbSgpIH0KICAgIGRlZmF1bHQgICB7fSAgIyB1bmtub3duIHBhcmFtIC0ganVzdCBpZ25vcmUgaXQKICAgIH0KfSAgICAgICAgCgppZiAoLW5vdCAka2V5KQp7CiAgICAiRXJyb3I6IE1pc3NpbmcgdGVzdFBhcmFtIEtleSB0byBiZSBhZGRlZCIKICAgIHJldHVybiAkRmFsc2UKfQppZiAoLW5vdCAkdmFsdWUpCnsKICAgICJFcnJvcjogTWlzc2luZyB0ZXN0UGFyYW0gVmFsdWUgdG8gYmUgYWRkZWQiCiAgICByZXR1cm4gJEZhbHNlCn0KCmlmICgtbm90ICRyb290RGlyKQp7CiAgICAiV2FybiA6IG5vIHJvb3REaXIgdGVzdCBwYXJhbWV0ZXIgd2FzIHN1cHBsaWVkIgp9CmVsc2UKewogICAgY2QgJHJvb3REaXIKfQoKIwojIENyZWF0aW5nIHRoZSBzdW1tYXJ5IGZpbGUKIwokc3VtbWFyeUxvZyAgPSAiJHt2bU5hbWV9X3N1bW1hcnkubG9nIgpkZWwgJHN1bW1hcnlMb2cgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKV3JpdGUtT3V0cHV0ICJDb3ZlcnMgJHt0Y0NvdmVyZWR9IiB8IE91dC1GaWxlIC1BcHBlbmQgJHN1bW1hcnlMb2cKCiMKIyBNb2RpZnkgdGhlIE5vbi1FeGlzdGluZyBLZXkgVmFsdWUgcGFpciBmcm9tIHRoZSBQb29sIDAgb24gZ3Vlc3QgT1MuIElmIHRoZSBLZXkgaXMgYWxyZWFkeSBwcmVzZW50LCB3aWxsIHJldHVybiBwcm9wZXIgbWVzc2FnZS4KIwoKJFZNTWFuYWdlbWVudFNlcnZpY2UgPSBHZXQtV21pT2JqZWN0IC1jbGFzcyAiTXN2bV9WaXJ0dWFsU3lzdGVtTWFuYWdlbWVudFNlcnZpY2UiIC1uYW1lc3BhY2UgInJvb3RcdmlydHVhbGl6YXRpb24iIC1Db21wdXRlck5hbWUgJGh2U2VydmVyCmlmICgtbm90ICRWTU1hbmFnZW1lbnRTZXJ2aWNlKQp7CiAgICAiRXJyb3I6IFVuYWJsZSB0byBjcmVhdGUgYSBWTU1hbmFnZW1lbnRTZXJ2aWNlIG9iamVjdCIKICAgIHJldHVybiAkRmFsc2UKfQoKJFZNR3Vlc3QgPSBHZXQtV21pT2JqZWN0IC1OYW1lc3BhY2Ugcm9vdFx2aXJ0dWFsaXphdGlvbiAtQ29tcHV0ZXJOYW1lICRodlNlcnZlciAtUXVlcnkgIlNlbGVjdCAqIEZyb20gTXN2bV9Db21wdXRlclN5c3RlbSBXaGVyZSBFbGVtZW50TmFtZT0nJFZtTmFtZSciCmlmICgtbm90ICRWTUd1ZXN0KQp7CiAgICAiRXJyb3I6IFVuYWJsZSB0byBjcmVhdGUgVk1HdWVzdCBvYmplY3QiCiAgICByZXR1cm4gJEZhbHNlCn0KCiRNc3ZtX0t2cEV4Y2hhbmdlRGF0YUl0ZW1QYXRoID0gIlxcJGh2U2VydmVyXHJvb3RcdmlydHVhbGl6YXRpb246TXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtIgokTXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtID0gKFtXbWlDbGFzc10kTXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtUGF0aCkuQ3JlYXRlSW5zdGFuY2UoKQppZiAoLW5vdCAkTXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtKQp7CiAgICAiRXJyb3I6IFVuYWJsZSB0byBjcmVhdGUgTXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtIG9iamVjdCIKICAgIHJldHVybiAkRmFsc2UKfQoKIkluZm8gOiBNb2RpZnlpbmcgS2V5ICcke2tleX0ndG8gJyR7VmFsdWV9JyIKCiRNc3ZtX0t2cEV4Y2hhbmdlRGF0YUl0ZW0uU291cmNlID0gMAokTXN2bV9LdnBFeGNoYW5nZURhdGFJdGVtLk5hbWUgPSAkS2V5CiRNc3ZtX0t2cEV4Y2hhbmdlRGF0YUl0ZW0uRGF0YSA9ICRWYWx1ZQokcmVzdWx0ID0gJFZNTWFuYWdlbWVudFNlcnZpY2UuTW9kaWZ5S3ZwSXRlbXMoJFZNR3Vlc3QsICRNc3ZtX0t2cEV4Y2hhbmdlRGF0YUl0ZW0uUFNCYXNlLkdldFRleHQoMSkpCiRqb2IgPSBbd21pXSRyZXN1bHQuSm9iCgojCiMgQ2hlY2sgaWYgdGhlIG1vZGlmeSB3b3JrZWQKIwp3aGlsZSgkam9iLmpvYnN0YXRlIC1sdCA3KSB7Cgkkam9iLmdldCgpCn0KCmlmICgkam9iLkVycm9yQ29kZSAtbmUgMCkKewogICAgIkVycm9yOiB3aGlsZSBtb2RpZnlpbmcgdGhlIGtleSB2YWx1ZSBwYWlyIgogICAgIkVycm9yOiBKb2IgZXJyb3IgY29kZSA9ICQoJEpvYi5FcnJvckNvZGUpIgoKICAgIGlmICgkam9iLkVycm9yQ29kZSAtZXEgMzI3NzMpCiAgICB7ICAKICAgICAgICBXcml0ZS1PdXRwdXQgIkVycm9yOiBLZXkgPSAnJHtrZXl9ICxOb24tZXhpc3Rpbmcga2V5IGNhbm5vdCBiZSBtb2RpZmllZCBFcnJvciBDb2RlLScgJCgkSm9iLkVycm9yQ29kZSkgIiB8IE91dC1GaWxlIC1BcHBlbmQgJHN1bW1hcnlMb2cKICAgICAgICByZXR1cm4gJFRydWUKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAiRXJyb3I6IFVuYWJsZSB0byBtb2RpZnkga2V5IgogICAgICAgIHJldHVybiAkRmFsc2UKICAgIH0KfQoKaWYgKCRqb2IuU3RhdHVzIC1lcSAiT0siKQp7CiAgICAiRXJyb3I6IE5vbi1leGlzdGluZyBLVlAgbW9kaWZpZWQgd2l0aCBzdGF0dXMgT0ssIENoZWNrIEtleSBhbmQgVmFsdWUgcGFpciBleGlzdCBvciBub3QgaW4gcG9vbCAwIgogICAgcmV0dXJuICRGYWxzZQp9Cg==
