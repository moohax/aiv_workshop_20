MSFT_xExchInstall.psm1,b7896a05cb9b86804199762e7d13831f,Scan result is 1. IsMalware: 0,ZnVuY3Rpb24gR2V0LVRhcmdldFJlc291cmNlIAp7CiAgICBbQ21kbGV0QmluZGluZygpXQoJW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCgkgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEFyZ3VtZW50cywKICAgICAgICAKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCiAgICAKICAgICNMb2FkIGhlbHBlciBtb2R1bGUKICAgIEltcG9ydC1Nb2R1bGUgIiQoKEdldC1JdGVtIC1MaXRlcmFsUGF0aCAiJCgkUFNTY3JpcHRSb290KSIpLlBhcmVudC5QYXJlbnQuRnVsbE5hbWUpXE1pc2NceEV4Y2hhbmdlQ29tbW9uLnBzbTEiIC1WZXJib3NlOjAKCiAgICBMb2dGdW5jdGlvbkVudHJ5IC1QYXJhbWV0ZXJzIEB7IlBhdGgiID0gJFBhdGg7ICJBcmd1bWVudHMiID0gJEFyZ3VtZW50c30gLVZlcmJvc2VQcmVmZXJlbmNlICRWZXJib3NlUHJlZmVyZW5jZQoKICAgICRyZXR1cm5WYWx1ZSA9IEB7CgkJUGF0aCA9ICRQYXRoCgkJQXJndW1lbnRzID0gJEFyZ3VtZW50cwogICAgfQoKCSRyZXR1cm5WYWx1ZQp9CgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCgkgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRQYXRoLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJEFyZ3VtZW50cywKICAgICAgICAKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsXQogICAgICAgICRDcmVkZW50aWFsCiAgICApCgogICAgSW1wb3J0LU1vZHVsZSAiJCgoR2V0LUl0ZW0gLUxpdGVyYWxQYXRoICIkKCRQU1NjcmlwdFJvb3QpIikuUGFyZW50LlBhcmVudC5GdWxsTmFtZSlcTWlzY1x4RXhjaGFuZ2VDb21tb24ucHNtMSIgLVZlcmJvc2U6MAoKICAgIExvZ0Z1bmN0aW9uRW50cnkgLVBhcmFtZXRlcnMgQHsiUGF0aCIgPSAkUGF0aDsgIkFyZ3VtZW50cyIgPSAkQXJndW1lbnRzfSAtVmVyYm9zZVByZWZlcmVuY2UgJFZlcmJvc2VQcmVmZXJlbmNlCgogICAgJGluc3RhbGxTdGF0dXMgPSBHZXRJbnN0YWxsU3RhdHVzCgogICAgaWYgKCRpbnN0YWxsU3RhdHVzLlNob3VsZFN0YXJ0SW5zdGFsbCAtZXEgJHRydWUpCiAgICB7CiAgICAgICAgI0NoZWNrIGlmIFdTTWFuIG5lZWRzIHRvIGJlIGNvbmZpZ3VyZWQsIGFzIGl0IHdpbGwgcmVxdWlyZSBhbiBpbW1lZGlhdGUgcmVib290CiAgICAgICAgJG5lZWRSZWJvb3QgPSBDaGVja1dTTWFuQ29uZmlnIC1BbGxvd0ltbWVkaWF0ZVJlYm9vdCAkQWxsb3dJbW1lZGlhdGVSZWJvb3QKCiAgICAgICAgaWYgKCRuZWVkUmVib290IC1lcSAkdHJ1ZSkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiSW5pdGlhdGluZyBFeGNoYW5nZSBTZXR1cC4gQ29tbWFuZDogJCgkUGF0aCkgJCgkQXJndW1lbnRzKSIKCiAgICAgICAgU3RhcnRTY2hlZHVsZWRUYXNrIC1QYXRoICIkKCRQYXRoKSIgLUFyZ3VtZW50cyAiJCgkQXJndW1lbnRzKSIgLUNyZWRlbnRpYWwgJENyZWRlbnRpYWwgLVRhc2tOYW1lICJJbnN0YWxsIEV4Y2hhbmdlIiAtVmVyYm9zZVByZWZlcmVuY2UgJFZlcmJvc2VQcmVmZXJlbmNlCgogICAgICAgICRkZXRlY3RlZEV4c2V0dXAgPSAkZmFsc2UKCiAgICAgICAgV3JpdGUtVmVyYm9zZSAiV2FpdGluZyB1cCB0byA2MCBzZWNvbmRzIGJlZm9yZSBleGl0aW5nIHRvIGdpdmUgdGltZSBmb3IgRXhTZXR1cC5leGUgdG8gc3RhcnQiCgogICAgICAgIGZvciAoJGkgPSAwOyAkaSAtbHQgNjA7ICRpKyspCiAgICAgICAgewogICAgICAgICAgICBpZiAoKEdldC1Qcm9jZXNzIC1OYW1lIEV4U2V0dXAgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpIC1lcSAkbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgMQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRGV0ZWN0ZWQgdGhhdCBFeFNldHVwLmV4ZSBpcyBydW5uaW5nIgogICAgICAgICAgICAgICAgJGRldGVjdGVkRXhzZXR1cCA9ICR0cnVlCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoJGRldGVjdGVkRXhzZXR1cCAtZXEgJGZhbHNlKQogICAgICAgIHsKICAgICAgICAgICAgdGhyb3cgIldhaXRlZCA2MCBzZWNvbmRzLCBidXQgd2FzIHVuYWJsZSB0byBkZXRlY3QgdGhhdCBFeFNldHVwLmV4ZSB3YXMgc3RhcnRlZCIKICAgICAgICB9CgogICAgICAgICNOb3cgd2FpdCBmb3Igc2V0dXAgdG8gZmluaXNoCiAgICAgICAgd2hpbGUgKChHZXQtUHJvY2VzcyAtTmFtZSBFeFNldHVwIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKSAtbmUgJG51bGwpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZXR1cCBpcyBzdGlsbCBydW5uaW5nIGF0ICQoW0RhdGVUaW1lXTo6Tm93KS4gU2xlZXBpbmcgZm9yIDEgbWludXRlLiIKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYgKCRpbnN0YWxsU3RhdHVzLlNldHVwQ29tcGxldGUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFeGNoYW5nZSBzZXR1cCBoYXMgYWxyZWFkeSBzdWNjZXNzZnVsbHkgY29tcGxldGVkLiIKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXhjaGFuZ2Ugc2V0dXAgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4iCiAgICAgICAgfSAgICAgICAgIAogICAgfQp9CgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlIAp7CiAgICBbQ21kbGV0QmluZGluZygpXQoJW091dHB1dFR5cGUoW1N5c3RlbS5Cb29sZWFuXSldCiAgICAgcGFyYW0KICAgICgKCSAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkQXJndW1lbnRzLAogICAgICAgIAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWxdCiAgICAgICAgJENyZWRlbnRpYWwKICAgICkKCiAgICBJbXBvcnQtTW9kdWxlICIkKChHZXQtSXRlbSAtTGl0ZXJhbFBhdGggIiQoJFBTU2NyaXB0Um9vdCkiKS5QYXJlbnQuUGFyZW50LkZ1bGxOYW1lKVxNaXNjXHhFeGNoYW5nZUNvbW1vbi5wc20xIiAtVmVyYm9zZTowCgogICAgTG9nRnVuY3Rpb25FbnRyeSAtUGFyYW1ldGVycyBAeyJQYXRoIiA9ICRQYXRoOyAiQXJndW1lbnRzIiA9ICRBcmd1bWVudHN9IC1WZXJib3NlUHJlZmVyZW5jZSAkVmVyYm9zZVByZWZlcmVuY2UKCiAgICAkaW5zdGFsbFN0YXR1cyA9IEdldEluc3RhbGxTdGF0dXMKCiAgICBpZiAoJGluc3RhbGxTdGF0dXMuU2hvdWxkU3RhcnRJbnN0YWxsIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJFeGNoYW5nZSBpcyBlaXRoZXIgbm90IGluc3RhbGxlZCwgb3IgYSBwcmV2aW91cyBpbnN0YWxsIG9ubHkgcGFydGlhbGx5IGNvbXBsZXRlZC4iCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYgKCRpbnN0YWxsU3RhdHVzLlNldHVwQ29tcGxldGUpCiAgICAgICAgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJFeGNoYW5nZSBzZXR1cCBoYXMgYWxyZWFkeSBzdWNjZXNzZnVsbHkgY29tcGxldGVkLiIKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiRXhjaGFuZ2Ugc2V0dXAgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcy4iCiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAoISgkaW5zdGFsbFN0YXR1cy5TaG91bGRTdGFydEluc3RhbGwpKQp9CgojQ2hlY2tzIGZvciB0aGUgZXhhY3Qgc3RhdHVzIG9mIEV4Y2hhbmdlIHNldHVwIGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGluIGEgSGFzaHRhYmxlCmZ1bmN0aW9uIEdldEluc3RhbGxTdGF0dXMKewogICAgJHNob3VsZFN0YXJ0SW5zdGFsbCA9ICRmYWxzZQoKICAgICRzZXR1cFJ1bm5pbmcgPSBJc1NldHVwUnVubmluZwogICAgJHNldHVwQ29tcGxldGUgPSBJc1NldHVwQ29tcGxldGUKICAgICRleGNoYW5nZVByZXNlbnQgPSBJc0V4Y2hhbmdlUHJlc2VudAogICAgJHNldHVwUGFydGlhbGx5Q29tcGxldGUgPSBJc1NldHVwUGFydGlhbGx5Q29tcGxldGVkCgogICAgaWYgKCRzZXR1cFJ1bm5pbmcgLWVxICR0cnVlIC1vciAkc2V0dXBDb21wbGV0ZSAtZXEgJHRydWUpCiAgICB7CiAgICAgICAgI0RvIG5vdGhpbmcuIEVpdGhlciBJbnN0YWxsIGlzIGFscmVhZHkgcnVubmluZywgb3IgaXQncyBhbHJlYWR5IGZpbmlzaGVkIHN1Y2Nlc3NmdWxseQogICAgfQogICAgZWxzZWlmICgkZXhjaGFuZ2VQcmVzZW50IC1lcSAkZmFsc2UgLW9yICRzZXR1cFBhcnRpYWxseUNvbXBsZXRlIC1lcSAkdHJ1ZSkKICAgIHsKICAgICAgICAkc2hvdWxkU3RhcnRJbnN0YWxsID0gJHRydWUKICAgIH0KCiAgICAkcmV0dXJuVmFsdWUgPSBAewogICAgICAgIFNldHVwUnVubmluZyA9ICRzZXR1cFJ1bm5pbmcKICAgICAgICBTZXR1cENvbXBsZXRlID0gJHNldHVwQ29tcGxldGUKICAgICAgICBFeGNoYW5nZVByZXNlbnQgPSAkZXhjaGFuZ2VQcmVzZW50CiAgICAgICAgU2V0dXBQYXJ0aWFsbHlDb21wbGV0ZSA9ICRzZXR1cFBhcnRpYWxseUNvbXBsZXRlCgkJU2hvdWxkU3RhcnRJbnN0YWxsID0gJHNob3VsZFN0YXJ0SW5zdGFsbAogICAgfQoKCSRyZXR1cm5WYWx1ZQp9CgojQ2hlY2sgZm9yIG1pc3NpbmcgcmVnaXN0cnkga2V5cyB0aGF0IG1heSBjYXVzZSBFeGNoYW5nZSBzZXR1cCB0byB0cnkgdG8gcmVzdGFydCBXaW5STSBtaWQgc2V0dXAgLCB3aGljaCB3aWxsIGluIHR1cm4gY2F1c2UgdGhlIERTQyByZXNvdXJjZSB0byBmYWlsCiNJZiBhbnkgcmVxdWlyZWQga2V5cyBhcmUgbWlzc2luZywgY29uZmlndXJlIFdpblJNLCB0aGVuIGZvcmNlIGEgcmVib290CmZ1bmN0aW9uIENoZWNrV1NNYW5Db25maWcKewogICAgJG5lZWRSZWJvb3QgPSAkZmFsc2UKCiAgICAkd3NtYW5LZXkgPSBHZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxXU01BTiIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCiAgICBpZiAoJHdzbWFuS2V5IC1uZSAkbnVsbCkKICAgIHsKICAgICAgICBpZiAoJHdzbWFuS2V5LlVwZGF0ZWRDb25maWcgLWVxICRudWxsKQogICAgICAgIHsKICAgICAgICAgICAgJG5lZWRSZWJvb3QgPSAkdHJ1ZQoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVmFsdWUgJ1VwZGF0ZWRDb25maWcnIG1pc3NpbmcgZnJvbSByZWdpc3RyeSBrZXkgSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cV1NNQU4uIFJ1bm5pbmc6IHdpbnJtIGkgcmVzdG9yZSB3aW5ybS9jb25maWciCgogICAgICAgICAgICBTZXQtTG9jYXRpb24gIiQoJGVudjp3aW5kaXIpXFN5c3RlbTMyXGluZXRzcnYiCiAgICAgICAgICAgIEludm9rZS1FeHByZXNzaW9uIC1Db21tYW5kICJ3aW5ybSBpIHJlc3RvcmUgd2lucm0vY29uZmlnIiB8IE91dC1OdWxsCgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJNYWNoaW5lIG5lZWRzIHRvIGJlIHJlYm9vdGVkIGJlZm9yZSBFeGNoYW5nZSBzZXR1cCBjYW4gcHJvY2VlZCIKCiAgICAgICAgICAgICRnbG9iYWw6RFNDTWFjaGluZVN0YXR1cyA9IDEKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdGhyb3cgIlVuYWJsZSB0byBmaW5kIHJlZ2lzdHJ5IGtleTogSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cV1NNQU4iCiAgICB9CgogICAgcmV0dXJuICRuZWVkUmVib290Cn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2U=
