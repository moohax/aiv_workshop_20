HgTabExpansion.ps1,9db7e6af4f4a1d426768baabb4ab675a,Scan result is 1. IsMalware: 0,JHNjcmlwdDpoZ0NvbW1hbmRzID0gQCgpCgpmdW5jdGlvbiBIZ1RhYkV4cGFuc2lvbigkbGFzdEJsb2NrKSB7CiAgc3dpdGNoIC1yZWdleCAoJGxhc3RCbG9jaykgeyAKICAgIAogICAjaGFuZGxlcyBoZ3RrIGhlbHAgPGNtZD4KICAgI2hhbmRsZXMgaGd0ayA8Y21kPgogICAndGhnIChoZWxwICk/KFxTKikkJyB7CiAgICAgdGhnQ29tbWFuZHMoJG1hdGNoZXNbMl0pOwogICB9CiAgICAKICAgI2hhbmRsZXMgaGcgdXBkYXRlIDxicmFuY2ggbmFtZT4KICAgI2hhbmRsZXMgaGcgbWVyZ2UgPGJyYW5jaCBuYW1lPgogICAnaGcgKHVwfHVwZGF0ZXxtZXJnZXxjb3xjaGVja291dCkgKFxTKikkJyB7CiAgICAgIGZpbmRCcmFuY2hPckJvb2ttYXJrT3JUYWdzKCRtYXRjaGVzWzJdKQogICB9CiAgICAgICAKICAgI0hhbmRsZXMgaGcgcHVsbCAtQiA8Ym9va21hcms+ICAgCiAgICdoZyBwdWxsICgtXFMqICkqLShCKSAoXFMqKSQnIHsKICAgICBoZ1JlbW90ZUJvb2ttYXJrcygkbWF0Y2hlc1szXSkKICAgICBoZ0xvY2FsQm9va21hcmtzKCRtYXRjaGVzWzNdKQogICB9CiAgICAKICAgI0hhbmRsZXMgaGcgcHVzaCAtQiA8Ym9va21hcms+ICAgCiAgICdoZyBwdXNoICgtXFMqICkqLShCKSAoXFMqKSQnIHsKICAgICBoZ0xvY2FsQm9va21hcmtzKCRtYXRjaGVzWzNdKQogICB9CiAgIAogICAjSGFuZGxlcyBoZyBib29rbWFyayA8Ym9va21hcms+CiAgICdoZyAoYm9va3xib29rbWFyaykgKFxTKikkJyB7CiAgICAgIGhnTG9jYWxCb29rbWFya3MoJG1hdGNoZXNbMl0pCiAgIH0KICAgIAogICAgI0hhbmRsZXMgaGcgcHVzaCA8cGF0aD4KICAgICNIYW5kbGVzIGhnIHB1bGwgPHBhdGg+CiAgICAnaGcgKHB1c2h8cHVsbCkgKC1cUyogKSooXFMqKSQnIHsKICAgICAgaGdSZW1vdGVzKCRtYXRjaGVzWzNdKQogICAgfQogICAgCiAgICAjaGFuZGxlcyBoZyBoZWxwIDxjbWQ+CiAgICAjaGFuZGxlcyBoZyA8Y21kPgogICAgJ2hnIChoZWxwICk/KFxTKikkJyB7CiAgICAgIGhnQ29tbWFuZHMoJG1hdGNoZXNbMl0pOwogICAgfQoKICAgICNoYW5kbGVzIGhnIDxjbWQ+IC0tPG9wdGlvbj4KICAgICdoZyAoXFMrKSAoLVxTKiApKi0tKFxTKikkJyB7CiAgICAgIGhnT3B0aW9ucyAkbWF0Y2hlc1sxXSAkbWF0Y2hlc1szXTsKICAgIH0KICAgIAogICAgI2hhbmRsZXMgaGcgcmV2ZXJ0IDxwYXRoPgogICAgJ2hnIHJldmVydCAoXFMqKSQnIHsKICAgICAgaGdGaWxlcyAkbWF0Y2hlc1sxXSAnTXxBfFJ8IScKICAgIH0KICAgIAogICAgI2hhbmRsZXMgaGcgYWRkIDxwYXRoPgogICAgJ2hnIGFkZCAoXFMqKSQnIHsKICAgICAgaGdGaWxlcyAkbWF0Y2hlc1sxXSAnXD8nCiAgICB9CiAgICAKICAgICMgaGFuZGxlcyBoZyBkaWZmIDxwYXRoPgogICAgJ2hnIGRpZmYgKFxTKikkJyB7CiAgICAgIGhnRmlsZXMgJG1hdGNoZXNbMV0gJ00nCiAgICB9CiAgICAKICAgICMgaGFuZGxlcyBoZyBjb21taXQgLShJfFgpIDxwYXRoPgogICAgJ2hnIGNvbW1pdCAoXFMqICkqLShJfFgpIChcUyopJCcgewogICAgICBoZ0ZpbGVzICRtYXRjaGVzWzNdICdNfEF8UnwhJwogICAgfSAgICAKICB9Cn0KCmZ1bmN0aW9uIGhnRmlsZXMoJGZpbHRlciwgJHBhdHRlcm4pIHsKICAgaGcgc3RhdHVzICQoaGcgcm9vdCkgfCAKICAgIGZvcmVhY2ggeyAKICAgICAgaWYoJF8gLW1hdGNoICIoJHBhdHRlcm4pezF9ICguKikiKSB7IAogICAgICAgICRtYXRjaGVzWzJdIAogICAgICB9IAogICAgfSB8CiAgICB3aGVyZSB7ICRfIC1saWtlICIqJGZpbHRlcioiIH0gfAogICAgZm9yZWFjaCB7IGlmKCRfIC1saWtlICcqIConKSB7ICAiJyRfJyIgIH0gZWxzZSB7ICRfIH0gfQp9CgpmdW5jdGlvbiBoZ1JlbW90ZXMoJGZpbHRlcikgewogIGhnIHBhdGhzIHwgZm9yZWFjaCB7CiAgICAkcGF0aCA9ICRfLlNwbGl0KCI9IilbMF0uVHJpbSgpOwogICAgaWYoJGZpbHRlciAtYW5kICRwYXRoLlN0YXJ0c1dpdGgoJGZpbHRlcikpIHsKICAgICAgJHBhdGgKICAgIH0gZWxzZWlmKC1ub3QgJGZpbHRlcikgewogICAgICAkcGF0aAogICAgfQogIH0KfQoKIyBCeSBkZWZhdWx0IHRoZSBoZyBjb21tYW5kIGxpc3QgaXMgcG9wdWxhdGVkIHRoZSBmaXJzdCB0aW1lIGhnQ29tbWFuZHMgaXMgaW52b2tlZC4gCiMgSW52b2tlIFBvcHVsYXRlSGdDb21tYW5kcyBpbiB5b3VyIHByb2ZpbGUgaWYgeW91IGRvbid0IHdhbnQgdGhlIGluaXRpYWwgaGl0LiAKZnVuY3Rpb24gaGdDb21tYW5kcygkZmlsdGVyKSB7CiAgaWYoJHNjcmlwdDpoZ0NvbW1hbmRzLkxlbmd0aCAtZXEgMCkgewogICAgcG9wdWxhdGVIZ0NvbW1hbmRzCiAgfQoKICBpZigkZmlsdGVyKSB7CiAgICAgJGhnQ29tbWFuZHMgfCA/IHsgJF8uU3RhcnRzV2l0aCgkZmlsdGVyKSB9IHwgJSB7ICRfLlRyaW0oKSB9IHwgc29ydCAgCiAgfQogIGVsc2UgewogICAgJGhnQ29tbWFuZHMgfCAlIHsgJF8uVHJpbSgpIH0gfCBzb3J0CiAgfQp9CgojIEJ5IGRlZmF1bHQgdGhlIGhnIGNvbW1hbmQgbGlzdCBpcyBwb3B1bGF0ZWQgdGhlIGZpcnN0IHRpbWUgaGdDb21tYW5kcyBpcyBpbnZva2VkLiAKIyBJbnZva2UgUG9wdWxhdGVIZ0NvbW1hbmRzIGluIHlvdXIgcHJvZmlsZSBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgaW5pdGlhbCBoaXQuIApmdW5jdGlvbiBQb3B1bGF0ZUhnQ29tbWFuZHMoKSB7CiAgICRoZ0NvbW1hbmRzID0gZm9yZWFjaCgkY21kIGluIChoZyBoZWxwKSkgewogICAgIyBTdG9wIG9uY2Ugd2UgcmVhY2ggdGhlICJFbmFibGVkIEV4dGVuc2lvbnMiIHNlY3Rpb24gb2YgaGVscC4gCiAgICAjIE5vdCBzdXJlIGlmIHRoZXJlJ3MgYSBiZXR0ZXIgd2F5IHRvIGRvIHRoaXMuLi4KICAgIGlmKCRjbWQgLWVxICJlbmFibGVkIGV4dGVuc2lvbnM6IikgewogICAgICBicmVhawogICAgfQogICAgCiAgICBpZigkY21kIC1tYXRjaCAnXiAoXFMrKSAoLiopJykgewogICAgICAgICRtYXRjaGVzWzFdCiAgICAgfQogIH0KCiAgaWYoJGdsb2JhbDpQb3NoSGdTZXR0aW5ncy5TaG93UGF0Y2hlcykgewogICAgIyBNUSBpbnRlZ3JhdGlvbiBtdXN0IGJlIGV4cGxpY2l0bHkgZW5hYmxlZCBhcyB0aGUgdXNlciBtYXkgbm90IGhhdmUgdGhlIGV4dGVuc2lvbgogICAgJGhnQ29tbWFuZHMgKz0gKGhnIGhlbHAgbXEpIHwgJSB7CiAgICAgIGlmKCRfIC1tYXRjaCAnXiAoXFMrKSAoLiopJykgewogICAgICAgICAgJG1hdGNoZXNbMV0KICAgICAgIH0KICAgIH0KICB9CiAgCiAgJHNjcmlwdDpoZ0NvbW1hbmRzID0gJGhnQ29tbWFuZHMKfQoKZnVuY3Rpb24gZmluZEJyYW5jaE9yQm9va21hcmtPclRhZ3MoJGZpbHRlcil7CiAgICBoZ0xvY2FsQnJhbmNoZXMoJGZpbHRlcikKICBoZ0xvY2FsVGFncygkZmlsdGVyKQogICAgaGdMb2NhbEJvb2ttYXJrcygkZmlsdGVyKQp9CgpmdW5jdGlvbiBoZ0xvY2FsQnJhbmNoZXMoJGZpbHRlcikgewogIGhnIGJyYW5jaGVzIC1hIHwgZm9yZWFjaCB7CiAgICBpZigkXyAtbWF0Y2ggIihcUyspIC4qIikgewogICAgICBpZigkZmlsdGVyIC1hbmQgJG1hdGNoZXNbMV0uU3RhcnRzV2l0aCgkZmlsdGVyKSkgewogICAgICAgICRtYXRjaGVzWzFdCiAgICAgIH0KICAgICAgZWxzZWlmKC1ub3QgJGZpbHRlcikgewogICAgICAgICRtYXRjaGVzWzFdCiAgICAgIH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGhnTG9jYWxUYWdzKCRmaWx0ZXIpIHsKICBoZyB0YWdzIHwgZm9yZWFjaCB7CiAgICBpZigkXyAtbWF0Y2ggIihcUyspIC4qIikgewogICAgICBpZigkZmlsdGVyIC1hbmQgJG1hdGNoZXNbMV0uU3RhcnRzV2l0aCgkZmlsdGVyKSkgewogICAgICAgICRtYXRjaGVzWzFdCiAgICAgIH0KICAgICAgZWxzZWlmKC1ub3QgJGZpbHRlcikgewogICAgICAgICRtYXRjaGVzWzFdCiAgICAgIH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGJvb2ttYXJrTmFtZSgkYm9va21hcmspIHsKICAgICRzcGxpdCA9ICRib29rbWFyay5TcGxpdCgiICIpOwogICAgICAgIAogICAgaWYoJGJvb2ttYXJrLlN0YXJ0c1dpdGgoIioiKSkgewogICAgICAgICRzcGxpdFsxXQogICAgfQogICAgZWxzZXsKICAgICAgICAkc3BsaXRbMF0KICAgIH0KfQoKZnVuY3Rpb24gaGdMb2NhbEJvb2ttYXJrcygkZmlsdGVyKSB7CiAgaGcgYm9va21hcmtzIC0tcXVpZXQgfCBmb3JlYWNoIHsKICAgIGlmKCRfIC1tYXRjaCAiKFxTKykgLioiKSB7CiAgICAgICRib29rbWFyayA9IGJvb2ttYXJrTmFtZSgkbWF0Y2hlc1swXSkgIAogICAgICBpZigkZmlsdGVyIC1hbmQgJGJvb2ttYXJrLlN0YXJ0c1dpdGgoJGZpbHRlcikpIHsKICAgICAgICAkYm9va21hcmsKICAgICAgfQogICAgICBlbHNlaWYoLW5vdCAkZmlsdGVyKSB7CiAgICAgICAgJGJvb2ttYXJrCiAgICAgIH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGhnUmVtb3RlQm9va21hcmtzKCRmaWx0ZXIpIHsKICBoZyBpbmNvbWluZyAtQiB8IGZvcmVhY2ggewogICAgaWYoJF8gLW1hdGNoICIoXFMrKSAuKiIpIHsKICAgICAgaWYoJGZpbHRlciAtYW5kICRtYXRjaGVzWzFdLlN0YXJ0c1dpdGgoJGZpbHRlcikpIHsKICAgICAgICAkbWF0Y2hlc1sxXQogICAgICB9CiAgICAgIGVsc2VpZigtbm90ICRmaWx0ZXIpIHsKICAgICAgICAkbWF0Y2hlc1sxXQogICAgICB9CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBoZ09wdGlvbnMoJGNtZCwgJGZpbHRlcikgewogICRvcHRMaXN0ID0gQCgpCiAgJG91dHB1dCA9IGhnIGhlbHAgJGNtZAogIGZvcmVhY2goJGxpbmUgaW4gJG91dHB1dCkgewogICAgaWYoJGxpbmUgLW1hdGNoICdeICgoLVxTKXwgICkgLS0oXFMrKSAuKiQnKSB7CiAgICAgICRvcHQgPSAkbWF0Y2hlc1szXQogICAgICBpZigkZmlsdGVyIC1hbmQgJG9wdC5TdGFydHNXaXRoKCRmaWx0ZXIpKSB7CiAgICAgICAgJG9wdExpc3QgKz0gJy0tJyArICRvcHQuVHJpbSgpCiAgICAgIH0KICAgICAgZWxzZWlmKC1ub3QgJGZpbHRlcikgewogICAgICAgICRvcHRMaXN0ICs9ICctLScgKyAkb3B0LlRyaW0oKQogICAgICB9CiAgICB9CiAgfQoKICAkb3B0TGlzdCB8IHNvcnQKfQoKZnVuY3Rpb24gdGhnQ29tbWFuZHMoJGZpbHRlcikgewogICRjbWRMaXN0ID0gQCgpCiAgJG91dHB1dCA9IHRoZyBoZWxwCiAgZm9yZWFjaCgkbGluZSBpbiAkb3V0cHV0KSB7CiAgICBpZigkbGluZSAtbWF0Y2ggJ14gKFxTKykgKC4qKScpIHsKICAgICAgJGNtZCA9ICRtYXRjaGVzWzFdCiAgICAgIGlmKCRmaWx0ZXIgLWFuZCAkY21kLlN0YXJ0c1dpdGgoJGZpbHRlcikpIHsKICAgICAgICAkY21kTGlzdCArPSAkY21kLlRyaW0oKQogICAgICB9CiAgICAgIGVsc2VpZigtbm90ICRmaWx0ZXIpIHsKICAgICAgICAkY21kTGlzdCArPSAkY21kLlRyaW0oKQogICAgICB9CiAgICB9CiAgfQogIAogICRjbWRMaXN0IHwgc29ydCAKfQoKaWYgKEdldC1Db21tYW5kICJSZWdpc3Rlci1UYWJFeHBhbnNpb24iIC1lcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKQp7CiAgICBSZWdpc3Rlci1UYWJFeHBhbnNpb24gImhnLmV4ZSIgLVR5cGUgQ29tbWFuZCB7CiAgICAgICAgcGFyYW0oJENvbnRleHQsIFtyZWZdJFRhYkV4cGFuc2lvbkhhc091dHB1dCwgW3JlZl0kUXVvdGVTcGFjZXMpICAjIDE6CgogICAgICAgICRsaW5lID0gJENvbnRleHQuTGluZQogICAgICAgICRsYXN0QmxvY2sgPSBbcmVnZXhdOjpTcGxpdCgkbGluZSwgJ1t8O10nKVstMV0uVHJpbVN0YXJ0KCkKICAgICAgICAkVGFiRXhwYW5zaW9uSGFzT3V0cHV0LlZhbHVlID0gJHRydWUKICAgICAgICBIZ1RhYkV4cGFuc2lvbiAkbGFzdEJsb2NrCiAgICB9CiAgICByZXR1cm4KfQoKaWYgKFRlc3QtUGF0aCBGdW5jdGlvbjpcVGFiRXhwYW5zaW9uKSB7CiAgUmVuYW1lLUl0ZW0gRnVuY3Rpb246XFRhYkV4cGFuc2lvbiBEZWZhdWx0VGFiRXhwYW5zaW9uCn0KCiMgU2V0IHVwIHRhYiBleHBhbnNpb24gYW5kIGluY2x1ZGUgaGcgZXhwYW5zaW9uCmZ1bmN0aW9uIFRhYkV4cGFuc2lvbigkbGluZSwgJGxhc3RXb3JkKSB7CiAgJGxhc3RCbG9jayA9IFtyZWdleF06OlNwbGl0KCRsaW5lLCAnW3w7XScpWy0xXQoKICBzd2l0Y2ggLXJlZ2V4ICgkbGFzdEJsb2NrKSB7CiAgICAiXiQoR2V0LUFsaWFzUGF0dGVybiBoZykgKC4qKSIgeyBIZ1RhYkV4cGFuc2lvbiAkbGFzdEJsb2NrIH0KICAgICJeJChHZXQtQWxpYXNQYXR0ZXJuIHRnaCkgKC4qKSIgeyBIZ1RhYkV4cGFuc2lvbiAkbGFzdEJsb2NrIH0KCiAgICAjIEZhbGwgYmFjayBvbiBleGlzdGluZyB0YWIgZXhwYW5zaW9uCiAgICBkZWZhdWx0IHsgaWYgKFRlc3QtUGF0aCBGdW5jdGlvbjpcRGVmYXVsdFRhYkV4cGFuc2lvbikgeyBEZWZhdWx0VGFiRXhwYW5zaW9uICRsaW5lICRsYXN0V29yZCB9IH0KICB9Cn0=
