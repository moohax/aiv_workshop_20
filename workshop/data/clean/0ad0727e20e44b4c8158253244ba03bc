Send-TCPRequest.ps1,b7fa3a4567ad0c864c5bae9a6ea9d2a3,Scan result is 1. IsMalware: 0,w6/Cu8K/IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIFNlbmQtVGNwUmVxdWVzdAojIwojIyBGcm9tIFdpbmRvd3MgUG93ZXJTaGVsbCBDb29rYm9vayAoTydSZWlsbHkpCiMjIGJ5IExlZSBIb2xtZXMgKGh0dHA6Ly93d3cubGVlaG9sbWVzLmNvbS9ndWlkZSkKIyMgRG93bmxvYWRlZCBmcm9tOiBodHRwOi8vcG9zaGNvZGUub3JnLzIyMTgKIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgo8IwoKLlNZTk9QU0lTCgpTZW5kIGEgVENQIHJlcXVlc3QgdG8gYSByZW1vdGUgY29tcHV0ZXIsIGFuZCByZXR1cm4gdGhlIHJlc3BvbnNlLgpJZiB5b3UgZG8gbm90IHN1cHBseSBpbnB1dCB0byB0aGlzIHNjcmlwdCAodmlhIGVpdGhlciB0aGUgcGlwZWxpbmUsIG9yIHRoZQotSW5wdXRPYmplY3QgcGFyYW1ldGVyLCkgdGhlIHNjcmlwdCBvcGVyYXRlcyBpbiBpbnRlcmFjdGl2ZSBtb2RlLgoKLkVYQU1QTEUKClBTID4kaHR0cCA9IEAiCiAgR0VUIC8gSFRUUC8xLjEKICBIb3N0OmJpbmcuY29tCiAgYG5gbgoiQAoKJGh0dHAgfCBTZW5kLVRjcFJlcXVlc3QgYmluZy5jb20gODAKCiM+CgpwYXJhbSgKICAgICMjIFRoZSBjb21wdXRlciB0byBjb25uZWN0IHRvCiAgICBbc3RyaW5nXSAkQ29tcHV0ZXJOYW1lID0gImxvY2FsaG9zdCIsCgogICAgIyMgQSBzd2l0Y2ggdG8gZGV0ZXJtaW5lIGlmIHlvdSBqdXN0IHdhbnQgdG8gdGVzdCB0aGUgY29ubmVjdGlvbgogICAgW3N3aXRjaF0gJFRlc3QsCgogICAgIyMgVGhlIHBvcnQgdG8gdXNlCiAgICBbaW50XSAkUG9ydCA9IDgwLAoKICAgICMjIEEgc3dpdGNoIHRvIGRldGVybWluZSBpZiB0aGUgY29ubmVjdGlvbiBzaG91bGQgYmUgbWFkZSB1c2luZyBTU0wKICAgIFtzd2l0Y2hdICRVc2VTU0wsCgogICAgIyMgVGhlIGlucHV0IHN0cmluZyB0byBzZW5kIHRvIHRoZSByZW1vdGUgaG9zdAogICAgW3N0cmluZ10gJElucHV0T2JqZWN0LAoKICAgICMjIFRoZSBkZWxheSwgaW4gbWlsbGlzZWNvbmRzLCB0byB3YWl0IGJldHdlZW4gY29tbWFuZHMKICAgIFtpbnRdICREZWxheSA9IDEwMAopCgpTZXQtU3RyaWN0TW9kZSAtVmVyc2lvbiBMYXRlc3QKCltzdHJpbmddICRTQ1JJUFQ6b3V0cHV0ID0gIiIKCiMjIFN0b3JlIHRoZSBpbnB1dCBpbnRvIGFuIGFycmF5IHRoYXQgd2UgY2FuIHNjYW4gb3Zlci4gSWYgdGhlcmUgd2FzIG5vIGlucHV0LAojIyB0aGVuIHdlIHdpbGwgYmUgaW4gaW50ZXJhY3RpdmUgbW9kZS4KJGN1cnJlbnRJbnB1dCA9ICRpbnB1dE9iamVjdAppZigtbm90ICRjdXJyZW50SW5wdXQpCnsKICAgICRjdXJyZW50SW5wdXQgPSBAKCRpbnB1dCkKfQokc2NyaXB0ZWRNb2RlID0gKFtib29sXSAkY3VycmVudElucHV0KSAtb3IgJHRlc3QKCmZ1bmN0aW9uIE1haW4KewogICAgIyMgT3BlbiB0aGUgc29ja2V0LCBhbmQgY29ubmVjdCB0byB0aGUgY29tcHV0ZXIgb24gdGhlIHNwZWNpZmllZCBwb3J0CiAgICBpZigtbm90ICRzY3JpcHRlZE1vZGUpCiAgICB7CiAgICAgICAgd3JpdGUtaG9zdCAiQ29ubmVjdGluZyB0byAkY29tcHV0ZXJOYW1lIG9uIHBvcnQgJHBvcnQiCiAgICB9CgogICAgdHJ5CiAgICB7CiAgICAgICAgJHNvY2tldCA9IE5ldy1PYmplY3QgTmV0LlNvY2tldHMuVGNwQ2xpZW50KCRjb21wdXRlck5hbWUsICRwb3J0KQogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICBpZigkdGVzdCkgeyAkZmFsc2UgfQogICAgICAgIGVsc2UgeyBXcml0ZS1FcnJvciAiQ291bGQgbm90IGNvbm5lY3QgdG8gcmVtb3RlIGNvbXB1dGVyOiAkXyIgfQoKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAjIyBJZiB3ZSdyZSBqdXN0IHRlc3RpbmcgdGhlIGNvbm5lY3Rpb24sIHdlJ3ZlIG1hZGUgdGhlIGNvbm5lY3Rpb24KICAgICMjIHN1Y2Nlc3NmdWxseSwgc28ganVzdCByZXR1cm4gJHRydWUKICAgIGlmKCR0ZXN0KSB7ICR0cnVlOyByZXR1cm4gfQoKICAgICMjIElmIHRoaXMgaXMgaW50ZXJhY3RpdmUgbW9kZSwgc3VwcGx5IHRoZSBwcm9tcHQKICAgIGlmKC1ub3QgJHNjcmlwdGVkTW9kZSkKICAgIHsKICAgICAgICB3cml0ZS1ob3N0ICJDb25uZWN0ZWQuICBQcmVzcyBeRCBmb2xsb3dlZCBieSBbRU5URVJdIHRvIGV4aXQuYG4iCiAgICB9CgogICAgJHN0cmVhbSA9ICRzb2NrZXQuR2V0U3RyZWFtKCkKCiAgICAjIyBJZiB3ZSB3YW50ZWQgdG8gdXNlIFNTTCwgc2V0IHVwIHRoYXQgcG9ydGlvbiBvZiB0aGUgY29ubmVjdGlvbgogICAgaWYoJFVzZVNTTCkKICAgIHsKICAgICAgICAkc3NsU3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNlY3VyaXR5LlNzbFN0cmVhbSAkc3RyZWFtLCRmYWxzZQogICAgICAgICRzc2xTdHJlYW0uQXV0aGVudGljYXRlQXNDbGllbnQoJGNvbXB1dGVyTmFtZSkKICAgICAgICAkc3RyZWFtID0gJHNzbFN0cmVhbQogICAgfQoKICAgICR3cml0ZXIgPSBuZXctb2JqZWN0IFN5c3RlbS5JTy5TdHJlYW1Xcml0ZXIgJHN0cmVhbQoKICAgIHdoaWxlKCR0cnVlKQogICAgewogICAgICAgICMjIFJlY2VpdmUgdGhlIG91dHB1dCB0aGF0IGhhcyBidWZmZXJlZCBzbyBmYXIKICAgICAgICAkU0NSSVBUOm91dHB1dCArPSBHZXRPdXRwdXQKCiAgICAgICAgIyMgSWYgd2UncmUgaW4gc2NyaXB0ZWQgbW9kZSwgc2VuZCB0aGUgY29tbWFuZHMsCiAgICAgICAgIyMgcmVjZWl2ZSB0aGUgb3V0cHV0LCBhbmQgZXhpdC4KICAgICAgICBpZigkc2NyaXB0ZWRNb2RlKQogICAgICAgIHsKICAgICAgICAgICAgZm9yZWFjaCgkbGluZSBpbiAkY3VycmVudElucHV0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkd3JpdGVyLldyaXRlTGluZSgkbGluZSkKICAgICAgICAgICAgICAgICR3cml0ZXIuRmx1c2goKQogICAgICAgICAgICAgICAgU3RhcnQtU2xlZXAgLW0gJERlbGF5CiAgICAgICAgICAgICAgICAkU0NSSVBUOm91dHB1dCArPSBHZXRPdXRwdXQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgIyMgSWYgd2UncmUgaW4gaW50ZXJhY3RpdmUgbW9kZSwgd3JpdGUgdGhlIGJ1ZmZlcmVkCiAgICAgICAgIyMgb3V0cHV0LCBhbmQgcmVzcG9uZCB0byBpbnB1dC4KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBpZigkb3V0cHV0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRsaW5lIGluICRvdXRwdXQuU3BsaXQoImBuIikpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgd3JpdGUtaG9zdCAkbGluZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFNDUklQVDpvdXRwdXQgPSAiIgogICAgICAgICAgICB9CgogICAgICAgICAgICAjIyBSZWFkIHRoZSB1c2VyJ3MgY29tbWFuZCwgcXVpdHRpbmcgaWYgdGhleSBoaXQgXkQKICAgICAgICAgICAgJGNvbW1hbmQgPSByZWFkLWhvc3QKICAgICAgICAgICAgaWYoJGNvbW1hbmQgLWVxIChbY2hhcl0gNCkpIHsgYnJlYWs7IH0KCiAgICAgICAgICAgICMjIE90aGVyd2lzZSwgV3JpdGUgdGhlaXIgY29tbWFuZCB0byB0aGUgcmVtb3RlIGhvc3QKICAgICAgICAgICAgJHdyaXRlci5Xcml0ZUxpbmUoJGNvbW1hbmQpCiAgICAgICAgICAgICR3cml0ZXIuRmx1c2goKQogICAgICAgIH0KICAgIH0KCiAgICAjIyBDbG9zZSB0aGUgc3RyZWFtcwogICAgJHdyaXRlci5DbG9zZSgpCiAgICAkc3RyZWFtLkNsb3NlKCkKCiAgICAjIyBJZiB3ZSdyZSBpbiBzY3JpcHRlZCBtb2RlLCByZXR1cm4gdGhlIG91dHB1dAogICAgaWYoJHNjcmlwdGVkTW9kZSkKICAgIHsKICAgICAgICAkb3V0cHV0CiAgICB9Cn0KCiMjIFJlYWQgb3V0cHV0IGZyb20gYSByZW1vdGUgaG9zdApmdW5jdGlvbiBHZXRPdXRwdXQKewogICAgIyMgQ3JlYXRlIGEgYnVmZmVyIHRvIHJlY2VpdmUgdGhlIHJlc3BvbnNlCiAgICAkYnVmZmVyID0gbmV3LW9iamVjdCBTeXN0ZW0uQnl0ZVtdIDEwMjQKICAgICRlbmNvZGluZyA9IG5ldy1vYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwoKICAgICRvdXRwdXRCdWZmZXIgPSAiIgogICAgJGZvdW5kTW9yZSA9ICRmYWxzZQoKICAgICMjIFJlYWQgYWxsIHRoZSBkYXRhIGF2YWlsYWJsZSBmcm9tIHRoZSBzdHJlYW0sIHdyaXRpbmcgaXQgdG8gdGhlCiAgICAjIyBvdXRwdXQgYnVmZmVyIHdoZW4gZG9uZS4KICAgIGRvCiAgICB7CiAgICAgICAgIyMgQWxsb3cgZGF0YSB0byBidWZmZXIgZm9yIGEgYml0CiAgICAgICAgc3RhcnQtc2xlZXAgLW0gMTAwMAoKICAgICAgICAjIyBSZWFkIHdoYXQgZGF0YSBpcyBhdmFpbGFibGUKICAgICAgICAkZm91bmRtb3JlID0gJGZhbHNlCiAgICAgICAgJHN0cmVhbS5SZWFkVGltZW91dCA9IDEwMDAKCiAgICAgICAgZG8KICAgICAgICB7CiAgICAgICAgICAgIHRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkcmVhZCA9ICRzdHJlYW0uUmVhZCgkYnVmZmVyLCAwLCAxMDI0KQoKICAgICAgICAgICAgICAgIGlmKCRyZWFkIC1ndCAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRmb3VuZG1vcmUgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICRvdXRwdXRCdWZmZXIgKz0gKCRlbmNvZGluZy5HZXRTdHJpbmcoJGJ1ZmZlciwgMCwgJHJlYWQpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIHsgJGZvdW5kTW9yZSA9ICRmYWxzZTsgJHJlYWQgPSAwIH0KICAgICAgICB9IHdoaWxlKCRyZWFkIC1ndCAwKQogICAgfSB3aGlsZSgkZm91bmRtb3JlKQoKICAgICRvdXRwdXRCdWZmZXIKfQoKLiBNYWlu
