win_shell_become.ps1,b73ee283a4c1a82efca40578aaa74589,Scan result is 1. IsMalware: 0,IyFwb3dlcnNoZWxsCiMgKGMpMjAxNiwgTWF0dCBEYXZpcyA8bWRhdmlzQGFuc2libGUuY29tPgojCiMgQW5zaWJsZSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiMgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKIyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgojIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiMKIyBBbnNpYmxlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiMgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKIyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiMgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KIwojIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCiMgYWxvbmcgd2l0aCBBbnNpYmxlLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoKIyBXQU5UX0pTT04KIyBQT1dFUlNIRUxMX0NPTU1PTgoKU2V0LVN0cmljdE1vZGUgLVZlcnNpb24gMgokRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIlN0b3AiCgokaGVscGVyX2RlZiA9IEAiCnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzOwp1c2luZyBTeXN0ZW0uSU87CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmc7CnVzaW5nIFN5c3RlbS5TZWN1cml0eTsKdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2w7CnVzaW5nIFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWw7CnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsKCm5hbWVzcGFjZSBBbnNpYmxlLlNoZWxsCnsKICAgIHB1YmxpYyBjbGFzcyBQcm9jZXNzVXRpbAogICAgewogICAgICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBHZXRQcm9jZXNzT3V0cHV0KFN0cmVhbVJlYWRlciBzdGRvdXRTdHJlYW0sIFN0cmVhbVJlYWRlciBzdGRlcnJTdHJlYW0sIG91dCBzdHJpbmcgc3Rkb3V0LCBvdXQgc3RyaW5nIHN0ZGVycikKICAgICAgICB7CiAgICAgICAgICAgIHZhciBzb3dhaXQgPSBuZXcgRXZlbnRXYWl0SGFuZGxlKGZhbHNlLCBFdmVudFJlc2V0TW9kZS5NYW51YWxSZXNldCk7CiAgICAgICAgICAgIHZhciBzZXdhaXQgPSBuZXcgRXZlbnRXYWl0SGFuZGxlKGZhbHNlLCBFdmVudFJlc2V0TW9kZS5NYW51YWxSZXNldCk7CgogICAgICAgICAgICBzdHJpbmcgc28gPSBudWxsLCBzZSA9IG51bGw7CgogICAgICAgICAgICBUaHJlYWRQb29sLlF1ZXVlVXNlcldvcmtJdGVtKChzKT0+CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHNvID0gc3Rkb3V0U3RyZWFtLlJlYWRUb0VuZCgpOwogICAgICAgICAgICAgICAgc293YWl0LlNldCgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIFRocmVhZFBvb2wuUXVldWVVc2VyV29ya0l0ZW0oKHMpID0+CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHNlID0gc3RkZXJyU3RyZWFtLlJlYWRUb0VuZCgpOwogICAgICAgICAgICAgICAgc2V3YWl0LlNldCgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGZvcmVhY2godmFyIHdoIGluIG5ldyBXYWl0SGFuZGxlW10geyBzb3dhaXQsIHNld2FpdCB9KQogICAgICAgICAgICAgICAgd2guV2FpdE9uZSgpOwoKICAgICAgICAgICAgc3Rkb3V0ID0gc287CiAgICAgICAgICAgIHN0ZGVyciA9IHNlOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIEdyYW50QWNjZXNzVG9XaW5kb3dTdGF0aW9uQW5kRGVza3RvcChzdHJpbmcgdXNlcm5hbWUpCiAgICAgICAgewogICAgICAgICAgICBjb25zdCBpbnQgV2luZG93U3RhdGlvbkFsbEFjY2VzcyA9IDB4MDAwZjAzN2Y7CiAgICAgICAgICAgIEdyYW50QWNjZXNzKHVzZXJuYW1lLCBHZXRQcm9jZXNzV2luZG93U3RhdGlvbigpLCBXaW5kb3dTdGF0aW9uQWxsQWNjZXNzKTsKICAgICAgICAgICAgY29uc3QgaW50IERlc2t0b3BSaWdodHNBbGxBY2Nlc3MgPSAweDAwMGYwMWZmOwogICAgICAgICAgICBHcmFudEFjY2Vzcyh1c2VybmFtZSwgR2V0VGhyZWFkRGVza3RvcChHZXRDdXJyZW50VGhyZWFkSWQoKSksIERlc2t0b3BSaWdodHNBbGxBY2Nlc3MpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBHcmFudEFjY2VzcyhzdHJpbmcgdXNlcm5hbWUsIEludFB0ciBoYW5kbGUsIGludCBhY2Nlc3NNYXNrKQogICAgICAgIHsKICAgICAgICAgICAgU2FmZUhhbmRsZSBzYWZlSGFuZGxlID0gbmV3IE5vb3BTYWZlSGFuZGxlKGhhbmRsZSk7CiAgICAgICAgICAgIEdlbmVyaWNTZWN1cml0eSBzZWN1cml0eSA9CiAgICAgICAgICAgICAgICBuZXcgR2VuZXJpY1NlY3VyaXR5KGZhbHNlLCBSZXNvdXJjZVR5cGUuV2luZG93T2JqZWN0LCBzYWZlSGFuZGxlLCBBY2Nlc3NDb250cm9sU2VjdGlvbnMuQWNjZXNzKTsKCiAgICAgICAgICAgIHNlY3VyaXR5LkFkZEFjY2Vzc1J1bGUoCiAgICAgICAgICAgICAgICBuZXcgR2VuZXJpY0FjY2Vzc1J1bGUobmV3IE5UQWNjb3VudCh1c2VybmFtZSksIGFjY2Vzc01hc2ssIEFjY2Vzc0NvbnRyb2xUeXBlLkFsbG93KSk7CiAgICAgICAgICAgIHNlY3VyaXR5LlBlcnNpc3Qoc2FmZUhhbmRsZSwgQWNjZXNzQ29udHJvbFNlY3Rpb25zLkFjY2Vzcyk7CiAgICAgICAgfQoKICAgICAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRQcm9jZXNzV2luZG93U3RhdGlvbigpOwoKICAgICAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRUaHJlYWREZXNrdG9wKGludCBkd1RocmVhZElkKTsKCiAgICAgICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZXh0ZXJuIGludCBHZXRDdXJyZW50VGhyZWFkSWQoKTsKCiAgICAgICAgLy8gQWxsIHRoZSBjb2RlIHRvIG1hbmlwdWxhdGUgYSBzZWN1cml0eSBvYmplY3QgaXMgYXZhaWxhYmxlIGluIC5ORVQgZnJhbWV3b3JrLAogICAgICAgIC8vIGJ1dCBpdHMgQVBJIHRyaWVzIHRvIGJlIHR5cGUtc2FmZSBhbmQgaGFuZGxlLXNhZmUsIGVuZm9yY2luZyBhIHNwZWNpYWwgaW1wbGVtZW50YXRpb24KICAgICAgICAvLyAodG8gYW4gb3RoZXJ3aXNlIGdlbmVyaWMgV2luQVBJKSBmb3IgZWFjaCBoYW5kbGUgdHlwZS4gVGhpcyBpcyB0byBtYWtlIHN1cmUKICAgICAgICAvLyBvbmx5IGEgY29ycmVjdCBzZXQgb2YgcGVybWlzc2lvbnMgY2FuIGJlIHNldCBmb3IgY29ycmVzcG9uZGluZyBvYmplY3QgdHlwZXMgYW5kCiAgICAgICAgLy8gbWFpbmx5IHRoYXQgaGFuZGxlcyBkbyBub3QgbGVhay4KICAgICAgICAvLyBIZW5jZSB0aGUgQWNjZXNzUnVsZSBhbmQgdGhlIE5hdGl2ZU9iamVjdFNlY3VyaXR5IGNsYXNzZXMgYXJlIGFic3RyYWN0LgogICAgICAgIC8vIFRoaXMgaXMgdGhlIHNpbXBsZXN0IHBvc3NpYmxlIGltcGxlbWVudGF0aW9uIHRoYXQgeWV0IGFsbG93cyB1cyB0byBtYWtlIHVzZQogICAgICAgIC8vIG9mIHRoZSBleGlzdGluZyAuTkVUIGltcGxlbWVudGF0aW9uLCBzcGFyaW5nIG5lY2Vzc2l0eSB0byBQL0ludm9rZSB0aGUgdW5kZXJseWluZyBXaW5BUEkuCgogICAgICAgIHByaXZhdGUgY2xhc3MgR2VuZXJpY0FjY2Vzc1J1bGUgOiBBY2Nlc3NSdWxlCiAgICAgICAgewogICAgICAgICAgICBwdWJsaWMgR2VuZXJpY0FjY2Vzc1J1bGUoSWRlbnRpdHlSZWZlcmVuY2UgaWRlbnRpdHksIGludCBhY2Nlc3NNYXNrLCBBY2Nlc3NDb250cm9sVHlwZSB0eXBlKSA6CiAgICAgICAgICAgICAgICBiYXNlKGlkZW50aXR5LCBhY2Nlc3NNYXNrLCBmYWxzZSwgSW5oZXJpdGFuY2VGbGFncy5Ob25lLCBQcm9wYWdhdGlvbkZsYWdzLk5vbmUsIHR5cGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBjbGFzcyBHZW5lcmljU2VjdXJpdHkgOiBOYXRpdmVPYmplY3RTZWN1cml0eQogICAgICAgIHsKICAgICAgICAgICAgcHVibGljIEdlbmVyaWNTZWN1cml0eShib29sIGlzQ29udGFpbmVyLCBSZXNvdXJjZVR5cGUgcmVzVHlwZSwgU2FmZUhhbmRsZSBvYmplY3RIYW5kbGUsIEFjY2Vzc0NvbnRyb2xTZWN0aW9ucyBzZWN0aW9uc1JlcXVlc3RlZCkKICAgICAgICAgICAgICAgIDogYmFzZShpc0NvbnRhaW5lciwgcmVzVHlwZSwgb2JqZWN0SGFuZGxlLCBzZWN0aW9uc1JlcXVlc3RlZCkKICAgICAgICAgICAgewogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXcgcHVibGljIHZvaWQgUGVyc2lzdChTYWZlSGFuZGxlIGhhbmRsZSwgQWNjZXNzQ29udHJvbFNlY3Rpb25zIGluY2x1ZGVTZWN0aW9ucykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgYmFzZS5QZXJzaXN0KGhhbmRsZSwgaW5jbHVkZVNlY3Rpb25zKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV3IHB1YmxpYyB2b2lkIEFkZEFjY2Vzc1J1bGUoQWNjZXNzUnVsZSBydWxlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBiYXNlLkFkZEFjY2Vzc1J1bGUocnVsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNyZWdpb24gTmF0aXZlT2JqZWN0U2VjdXJpdHkgQWJzdHJhY3QgTWV0aG9kIE92ZXJyaWRlcwoKICAgICAgICAgICAgcHVibGljIG92ZXJyaWRlIFR5cGUgQWNjZXNzUmlnaHRUeXBlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGdldCB7IHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbigpOyB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBBY2Nlc3NSdWxlIEFjY2Vzc1J1bGVGYWN0b3J5KFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuSWRlbnRpdHlSZWZlcmVuY2UgaWRlbnRpdHlSZWZlcmVuY2UsIGludCBhY2Nlc3NNYXNrLCBib29sIGlzSW5oZXJpdGVkLCBJbmhlcml0YW5jZUZsYWdzIGluaGVyaXRhbmNlRmxhZ3MsIFByb3BhZ2F0aW9uRmxhZ3MgcHJvcGFnYXRpb25GbGFncywgQWNjZXNzQ29udHJvbFR5cGUgdHlwZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBUeXBlIEFjY2Vzc1J1bGVUeXBlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGdldCB7IHJldHVybiB0eXBlb2YoQWNjZXNzUnVsZSk7IH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIG92ZXJyaWRlIEF1ZGl0UnVsZSBBdWRpdFJ1bGVGYWN0b3J5KFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuSWRlbnRpdHlSZWZlcmVuY2UgaWRlbnRpdHlSZWZlcmVuY2UsIGludCBhY2Nlc3NNYXNrLCBib29sIGlzSW5oZXJpdGVkLCBJbmhlcml0YW5jZUZsYWdzIGluaGVyaXRhbmNlRmxhZ3MsIFByb3BhZ2F0aW9uRmxhZ3MgcHJvcGFnYXRpb25GbGFncywgQXVkaXRGbGFncyBmbGFncykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBvdmVycmlkZSBUeXBlIEF1ZGl0UnVsZVR5cGUKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIHR5cGVvZihBdWRpdFJ1bGUpOyB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICNlbmRyZWdpb24KICAgICAgICB9CgogICAgICAgIC8vIEhhbmRsZXMgcmV0dXJuZWQgYnkgR2V0UHJvY2Vzc1dpbmRvd1N0YXRpb24gYW5kIEdldFRocmVhZERlc2t0b3Agc2hvdWxkIG5vdCBiZSBjbG9zZWQKICAgICAgICBwcml2YXRlIGNsYXNzIE5vb3BTYWZlSGFuZGxlIDogU2FmZUhhbmRsZQogICAgICAgIHsKICAgICAgICAgICAgcHVibGljIE5vb3BTYWZlSGFuZGxlKEludFB0ciBoYW5kbGUpIDoKICAgICAgICAgICAgICAgIGJhc2UoaGFuZGxlLCBmYWxzZSkKICAgICAgICAgICAgewogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgYm9vbCBJc0ludmFsaWQKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZ2V0IHsgcmV0dXJuIGZhbHNlOyB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBvdmVycmlkZSBib29sIFJlbGVhc2VIYW5kbGUoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9Cn0KIkAKCiRwYXJzZWRfYXJncyA9IFBhcnNlLUFyZ3MgJGFyZ3MgJGZhbHNlCgokcmF3X2NvbW1hbmRfbGluZSA9ICQoR2V0LUFuc2libGVQYXJhbSAkcGFyc2VkX2FyZ3MgImNvbW1hbmRfbGluZSIgLWZhaWxpZmVtcHR5ICR0cnVlKS5UcmltKCkKJGNoZGlyID0gR2V0LUFuc2libGVQYXJhbSAkcGFyc2VkX2FyZ3MgImNoZGlyIgokZXhlY3V0YWJsZSA9IEdldC1BbnNpYmxlUGFyYW0gJHBhcnNlZF9hcmdzICJleGVjdXRhYmxlIgokY3JlYXRlcyA9IEdldC1BbnNpYmxlUGFyYW0gJHBhcnNlZF9hcmdzICJjcmVhdGVzIgokcmVtb3ZlcyA9IEdldC1BbnNpYmxlUGFyYW0gJHBhcnNlZF9hcmdzICJyZW1vdmVzIgoKJHVzZXJuYW1lID0gR2V0LUFuc2libGVQYXJhbSAkcGFyc2VkX2FyZ3MgInVzZXJuYW1lIgokcGFzc3dvcmQgPSBHZXQtQW5zaWJsZVBhcmFtICRwYXJzZWRfYXJncyAicGFzc3dvcmQiCgokcmVzdWx0ID0gQHtjaGFuZ2VkPSR0cnVlOyB3YXJuaW5ncz1AKCk7IGNtZD0kcmF3X2NvbW1hbmRfbGluZX0KCklmKCRjcmVhdGVzIC1hbmQgJChUZXN0LVBhdGggJGNyZWF0ZXMpKSB7CiAgICBFeGl0LUpzb24gQHtjbWQ9JHJhd19jb21tYW5kX2xpbmU7IG1zZz0ic2tpcHBlZCwgc2luY2UgJGNyZWF0ZXMgZXhpc3RzIjsgY2hhbmdlZD0kZmFsc2U7IHNraXBwZWQ9JHRydWU7IHJjPTB9Cn0KCklmKCRyZW1vdmVzIC1hbmQgLW5vdCAkKFRlc3QtUGF0aCAkcmVtb3ZlcykpIHsKICAgIEV4aXQtSnNvbiBAe2NtZD0kcmF3X2NvbW1hbmRfbGluZTsgbXNnPSJza2lwcGVkLCBzaW5jZSAkcmVtb3ZlcyBkb2VzIG5vdCBleGlzdCI7IGNoYW5nZWQ9JGZhbHNlOyBza2lwcGVkPSR0cnVlOyByYz0wfQp9CgpBZGQtVHlwZSAtVHlwZURlZmluaXRpb24gJGhlbHBlcl9kZWYKCiRleGVjX2FyZ3MgPSAkbnVsbAoKSWYoLW5vdCAkZXhlY3V0YWJsZSAtb3IgJGV4ZWN1dGFibGUgLWVxICJwb3dlcnNoZWxsIikgewogICAgJGV4ZWNfYXBwbGljYXRpb24gPSAicG93ZXJzaGVsbCIKCiAgICAjIEJhc2U2NCBlbmNvZGUgdGhlIGNvbW1hbmQgc28gd2UgZG9uJ3QgaGF2ZSB0byB3b3JyeSBhYm91dCB0aGUgdmFyaW91cyBsZXZlbHMgb2YgZXNjYXBpbmcKICAgICRlbmNvZGVkX2NvbW1hbmQgPSBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0Qnl0ZXMoJHJhd19jb21tYW5kX2xpbmUpKQoKICAgICRleGVjX2FyZ3MgPSBAKCItbm9uaW50ZXJhY3RpdmUiLCAiLWVuY29kZWRjb21tYW5kIiwgJGVuY29kZWRfY29tbWFuZCkKfQpFbHNlIHsKICAgICMgRlVUVVJFOiBzdXBwb3J0IGFyZyB0cmFuc2xhdGlvbiBmcm9tIGV4ZWN1dGFibGUgKG9yIGV4ZWN1dGFibGVfYXJncz8pIHRvIHByb2Nlc3MgYXJndW1lbnRzIGZvciBhcmJpdHJhcnkgaW50ZXJwcmV0ZXI/CiAgICAkZXhlY19hcHBsaWNhdGlvbiA9ICRleGVjdXRhYmxlCiAgICAkZXhlY19hcmdzID0gQCgiL2MiLCAkcmF3X2NvbW1hbmRfbGluZSkKfQoKJHByb2MgPSBOZXctT2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzCiRwc2kgPSAkcHJvYy5TdGFydEluZm8KJHBzaS5GaWxlTmFtZSA9ICRleGVjX2FwcGxpY2F0aW9uCiRwc2kuQXJndW1lbnRzID0gJGV4ZWNfYXJncwokcHNpLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkdHJ1ZQokcHNpLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9ICR0cnVlCiRwc2kuVXNlU2hlbGxFeGVjdXRlID0gJGZhbHNlCgppZigkdXNlcm5hbWUgLWFuZCAkcGFzc3dvcmQpIHsKICAgICMgVE9ETzogYWRkIGRvbWFpbiBwYXJzaW5nIHN1cHBvcnQKICAgICRwc2kuRG9tYWluID0gIi4iCiAgICAkcHNpLlVzZXJuYW1lID0gJHVzZXJuYW1lCiAgICAkcHNpLlBhc3N3b3JkID0gJCgkcGFzc3dvcmQgfCBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1Bc1BsYWluVGV4dCAtRm9yY2UpCgogICAgW0Fuc2libGUuU2hlbGwuUHJvY2Vzc1V0aWxdOjpHcmFudEFjY2Vzc1RvV2luZG93U3RhdGlvbkFuZERlc2t0b3AoJHVzZXJuYW1lKQp9CgoKSWYgKCRjaGRpcikgewogICAgJHBzaS5Xb3JraW5nRGlyZWN0b3J5ID0gJGNoZGlyCn0KCiRzdGFydF9kYXRldGltZSA9IFtEYXRlVGltZV06OlV0Y05vdwoKVHJ5IHsKICAgICRwcm9jLlN0YXJ0KCkgfCBPdXQtTnVsbCAjIHdpbGwgYWx3YXlzIHJldHVybiAkdHJ1ZSBmb3Igbm9uIHNoZWxsLWV4ZWMgY2FzZXMKfQpDYXRjaCBbU3lzdGVtLkNvbXBvbmVudE1vZGVsLldpbjMyRXhjZXB0aW9uXSB7CiAgICAjIGZhaWwgbmljZWx5IGZvciAibm9ybWFsIiBlcnJvciBjb25kaXRpb25zCiAgICAjIEZVVFVSRTogdGhpcyBwcm9iYWJseSB3b24ndCB3b3JrIG9uIE5hbm8gU2VydmVyCiAgICAkZXhjZXAgPSAkXwogICAgRXhpdC1Kc29uIEB7ZmFpbGVkPSR0cnVlO2NoYW5nZWQ9JGZhbHNlO2NtZD0kcmF3X2NvbW1hbmRfbGluZTtyYz0kZXhjZXAuRXhjZXB0aW9uLk5hdGl2ZUVycm9yQ29kZTttc2c9JGV4Y2VwLkV4Y2VwdGlvbi5NZXNzYWdlfQp9Cgokc3Rkb3V0ID0gJHN0ZGVyciA9IFtzdHJpbmddICRudWxsCgpbQW5zaWJsZS5TaGVsbC5Qcm9jZXNzVXRpbF06OkdldFByb2Nlc3NPdXRwdXQoJHByb2MuU3RhbmRhcmRPdXRwdXQsICRwcm9jLlN0YW5kYXJkRXJyb3IsIFtyZWZdICRzdGRvdXQsIFtyZWZdICRzdGRlcnIpIHwgT3V0LU51bGwKCiRyZXN1bHQuc3Rkb3V0ID0gJHN0ZG91dAokcmVzdWx0LnN0ZGVyciA9ICRzdGRlcnIKCiMgVE9ETzogZGVjb2RlIENMSVhNTCBzdGRlcnIgb3V0cHV0IChhbmQgb3RoZXIgc3RyZWFtcz8pCgokcHJvYy5XYWl0Rm9yRXhpdCgpIHwgT3V0LU51bGwKCiRyZXN1bHQucmMgPSAkcHJvYy5FeGl0Q29kZQoKJGVuZF9kYXRldGltZSA9IFtEYXRlVGltZV06OlV0Y05vdwoKJHJlc3VsdC5zdGFydCA9ICRzdGFydF9kYXRldGltZS5Ub1N0cmluZygieXl5eS1NTS1kZCBoaDptbTpzcy5mZmZmZmYiKQokcmVzdWx0LmVuZCA9ICRlbmRfZGF0ZXRpbWUuVG9TdHJpbmcoInl5eXktTU0tZGQgaGg6bW06c3MuZmZmZmZmIikKJHJlc3VsdC5kZWx0YSA9ICQoJGVuZF9kYXRldGltZSAtICRzdGFydF9kYXRldGltZSkuVG9TdHJpbmcoImhcOm1tXDpzc1wuZmZmZmZmIikKCkNvbnZlcnRUby1Kc29uIC1EZXB0aCA5OSAkcmVzdWx0Cgo=
