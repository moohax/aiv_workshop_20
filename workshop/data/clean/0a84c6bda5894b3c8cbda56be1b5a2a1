MSFT_iSCSIVirtualDisk.psm1,d3ab7fc62beb9c3e0eb637f89761c2b7,Scan result is 1. IsMalware: 0,ZGF0YSBMb2NhbGl6ZWREYXRhCnsKICAgICMgY3VsdHVyZT0iZW4tVVMiCiAgICBDb252ZXJ0RnJvbS1TdHJpbmdEYXRhIC1TdHJpbmdEYXRhIEAnCkdldHRpbmdpU0NTSVZpcnR1YWxEaXNrTWVzc2FnZT1HZXR0aW5nIGlTQ1NJIFZpcnR1YWwgRGlzayAiezB9Ii4KaVNDU0lWaXJ0dWFsRGlza0V4aXN0c01lc3NhZ2U9aVNDU0kgVmlydHVhbCBEaXNrICJ7MH0iIGV4aXN0cy4KaVNDU0lWaXJ0dWFsRGlza0RvZXNOb3RFeGlzdE1lc3NhZ2U9aVNDU0kgVmlydHVhbCBEaXNrICJ7MH0iIGRvZXMgbm90IGV4aXN0LgpTZXR0aW5naVNDU0lWaXJ0dWFsRGlza01lc3NhZ2U9U2V0dGluZyBpU0NTSSBWaXJ0dWFsIERpc2sgInswfSIuCkVuc3VyZWlTQ1NJVmlydHVhbERpc2tFeGlzdHNNZXNzYWdlPUVuc3VyaW5nIGlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBleGlzdHMuCkVuc3VyZWlTQ1NJVmlydHVhbERpc2tEb2VzTm90RXhpc3RNZXNzYWdlPUVuc3VyaW5nIGlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBkb2VzIG5vdCBleGlzdC4KaVNDU0lWaXJ0dWFsRGlza0NyZWF0ZWRNZXNzYWdlPWlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBoYXMgYmVlbiBjcmVhdGVkLgppU0NTSVZpcnR1YWxEaXNrVXBkYXRlZE1lc3NhZ2U9aVNDU0kgVmlydHVhbCBEaXNrICJ7MH0iIGhhcyBiZWVuIHVwZGF0ZWQuCmlTQ1NJVmlydHVhbERpc2tSZW1vdmVkTWVzc2FnZT1pU0NTSSBWaXJ0dWFsIERpc2sgInswfSIgaGFzIGJlZW4gcmVtb3ZlZC4KVGVzdGluZ2lTQ1NJVmlydHVhbERpc2tNZXNzYWdlPVRlc3RpbmcgaVNDU0kgVmlydHVhbCBEaXNrICJ7MH0iLgppU0NTSVZpcnR1YWxEaXNrUGFyYW1ldGVyTmVlZHNVcGRhdGVNZXNzYWdlPWlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiB7MX0gaXMgZGlmZmVyZW50LiBDaGFuZ2UgcmVxdWlyZWQuCmlTQ1NJVmlydHVhbERpc2tEb2VzTm90RXhpc3RCdXRTaG91bGRNZXNzYWdlPWlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBkb2VzIG5vdCBleGlzdCBidXQgc2hvdWxkLiBDaGFuZ2UgcmVxdWlyZWQuCmlTQ1NJVmlydHVhbERpc2tFeGlzdHNCdXRTaG91bGROb3RNZXNzYWdlPWlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBleGlzdHMgYnV0IHNob3VsZCBub3QuIENoYW5nZSByZXF1aXJlZC4KaVNDU0lWaXJ0dWFsRGlza0RvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2U9aVNDU0kgVmlydHVhbCBEaXNrICJ7MH0iIGRvZXMgbm90IGV4aXN0IGFuZCBzaG91bGQgbm90LiBDaGFuZ2Ugbm90IHJlcXVpcmVkLgppU0NTSVZpcnR1YWxEaXNrUmVxdWlyZXNSZWNyZWF0ZUVycm9yPWlTQ1NJIFZpcnR1YWwgRGlzayAiezB9IiBuZWVkcyB0byBiZSBkZWxldGVkIGFuZCByZWNyZWF0ZWQuIFBsZWFzZSBwZXJmb3JtIHRoaXMgbWFudWFsbHkuCidACn0KCmZ1bmN0aW9uIEdldC1UYXJnZXRSZXNvdXJjZQp7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgW091dHB1dFR5cGUoW1N5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGVdKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgKICAgICkKICAgIAogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5HZXR0aW5naVNDU0lWaXJ0dWFsRGlza01lc3NhZ2UpIGAKICAgICAgICAgICAgLWYgJFBhdGgKICAgICAgICApIC1qb2luICcnICkKCiAgICAkVmlydHVhbERpc2sgPSAgR2V0LVZpcnR1YWxEaXNrIC1QYXRoICRQYXRoCgogICAgJHJldHVyblZhbHVlID0gQHsKICAgICAgICBQYXRoID0gJFBhdGgKICAgIH0KICAgIGlmICgkVmlydHVhbERpc2spCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLmlTQ1NJVmlydHVhbERpc2tFeGlzdHNNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAtZiAkUGF0aAogICAgICAgICAgICApIC1qb2luICcnICkKCiAgICAgICAgJHJldHVyblZhbHVlICs9IEB7CiAgICAgICAgICAgIEVuc3VyZSA9ICdQcmVzZW50JwogICAgICAgICAgICBTaXplQnl0ZXMgPSAkVmlydHVhbERpc2suU2l6ZQogICAgICAgICAgICBEaXNrVHlwZSA9ICRWaXJ0dWFsRGlzay5EaXNrVHlwZQogICAgICAgICAgICBEZXNjcmlwdGlvbiA9ICRWaXJ0dWFsRGlzay5EZXNjcmlwdGlvbgogICAgICAgICAgICBQYXJlbnRQYXRoID0gJFZpcnR1YWxEaXNrLlBhcmVudFBhdGgKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLmlTQ1NJVmlydHVhbERpc2tEb2VzTm90RXhpc3RNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAtZiAkUGF0aAogICAgICAgICAgICApIC1qb2luICcnICkKCiAgICAgICAgJHJldHVyblZhbHVlICs9IEB7CiAgICAgICAgICAgIEVuc3VyZSA9ICdBYnNlbnQnCiAgICAgICAgfQogICAgfQoKICAgICRyZXR1cm5WYWx1ZQp9ICMgR2V0LVRhcmdldFJlc291cmNlCgpmdW5jdGlvbiBTZXQtVGFyZ2V0UmVzb3VyY2UKewogICAgW0NtZGxldEJpbmRpbmcoKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnRHluYW1pYycsJ0ZpeGVkJywnRGlmZmVyZW5jaW5nJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERpc2tUeXBlID0gJ0R5bmFtaWMnLAoKICAgICAgICBbU3lzdGVtLlVpbnQ2NF0KICAgICAgICAkU2l6ZUJ5dGVzLAogICAgICAgIAogICAgICAgIFtTeXN0ZW0uVWludDMyXQogICAgICAgICRCbG9ja1NpemVCeXRlcywKICAgICAgIAogICAgICAgIFtWYWxpZGF0ZVNldCg1MTIsNDA5NildCiAgICAgICAgW1N5c3RlbS5VaW50MzJdCiAgICAgICAgJExvZ2ljYWxTZWN0b3JTaXplQnl0ZXMsCiAgICAgICAgCiAgICAgICAgW1ZhbGlkYXRlU2V0KDUxMiw0MDk2KV0KICAgICAgICBbU3lzdGVtLlVJbnQzMl0KICAgICAgICAkUGh5c2ljYWxTZWN0b3JTaXplQnl0ZXMsCiAgICAgICAgCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERlc2NyaXB0aW9uLAogICAgICAgIAogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRQYXJlbnRQYXRoCiAgICApCgogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5TZXR0aW5naVNDU0lWaXJ0dWFsRGlza01lc3NhZ2UpIGAKICAgICAgICAgICAgLWYgJFBhdGgKICAgICAgICApIC1qb2luICcnICkKCiAgICAjIFJlbW92ZSBhbnkgcGFyYW1ldGVycyB0aGF0IGNhbid0IGJlIHNwbGF0dGVkLgogICAgJG51bGwgPSAkUFNCb3VuZFBhcmFtZXRlcnMuUmVtb3ZlKCdFbnN1cmUnKQogICAgJG51bGwgPSAkUFNCb3VuZFBhcmFtZXRlcnMuUmVtb3ZlKCdEaXNrVHlwZScpCgogICAgIyBMb29rdXAgdGhlIGV4aXN0aW5nIGlTQ1NJIFZpcnR1YWwgRGlzawogICAgJFZpcnR1YWxEaXNrID0gR2V0LVZpcnR1YWxEaXNrIC1QYXRoICRQYXRoCgogICAgaWYgKCRFbnN1cmUgLWVxICdQcmVzZW50JykKICAgIHsKICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuRW5zdXJlaVNDU0lWaXJ0dWFsRGlza0V4aXN0c01lc3NhZ2UpIGAKICAgICAgICAgICAgICAgIC1mICRQYXRoCiAgICAgICAgICAgICkgLWpvaW4gJycgKQoKICAgICAgICBpZiAoJFZpcnR1YWxEaXNrKQogICAgICAgIHsKICAgICAgICAgICAgIyBUaGUgaVNDU0kgVmlydHVhbCBEaXNrIGV4aXN0cwogICAgICAgICAgICBbQm9vbGVhbl0gJFJlY3JlYXRlID0gJGZhbHNlCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoKCREaXNrVHlwZSkgYAogICAgICAgICAgICAgICAgLWFuZCAoJFZpcnR1YWxEaXNrLkRpc2tUeXBlIC1uZSAkRGlza1R5cGUpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkUmVjcmVhdGUgPSAkdHJ1ZQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCRTaXplQnl0ZXMpIGAKICAgICAgICAgICAgICAgIC1hbmQgKCRWaXJ0dWFsRGlzay5TaXplIC1uZSAkU2l6ZUJ5dGVzKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFJlY3JlYXRlID0gJHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkUGFyZW50UGF0aCkgYAogICAgICAgICAgICAgICAgLWFuZCAoJFZpcnR1YWxEaXNrLlBhcmVudFBhdGggLW5lICRQYXJlbnRQYXRoKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFJlY3JlYXRlID0gJHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBJZiBhbnkgcGFyYW1ldGVycyBkaWZmZXIgdGhhdCByZXF1aXJlIHRoaXMgVmlydHVhbCBEaXNrIHRvIGJlIHJlY3JlYXRlZAogICAgICAgICAgICAjIHRoZW4gdGhyb3cgYW4gZXJyb3IuIFJlY3JlYXRpbmcgdGhlIFZpcnR1YWwgRGlzayBpcyB0b28gZGFuZ2Vyb3VzIGFzIGl0CiAgICAgICAgICAgICMgbWF5IGNvbnRhaW4gZGF0YS4gSWYgdGhlIFZpcnR1YWwgRGlzayAqbXVzdCogYmUgcmVjcmVhdGVkIHRoZW4gdGhlIHVzZXIKICAgICAgICAgICAgIyB3aWxsIG5lZWQgdG8gbWFudWFsbHkgZGVsZXRlIHRoZSBWaXJ0dWFsIERpc2sgYW5kIHRoZSBjb25maWcgd2lsbCB0aGVuCiAgICAgICAgICAgICMgY3JlYXRlIGEgbmV3IG9uZS4KICAgICAgICAgICAgaWYgKCRSZWNyZWF0ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGVycm9ySWQgPSAnaVNDU0lWaXJ0dWFsRGlza1JlcXVpcmVzUmVjcmVhdGVFcnJvcicKICAgICAgICAgICAgICAgICRlcnJvckNhdGVnb3J5ID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JDYXRlZ29yeV06OkludmFsaWRBcmd1bWVudAogICAgICAgICAgICAgICAgJGVycm9yTWVzc2FnZSA9ICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza1JlcXVpcmVzUmVjcmVhdGVFcnJvcikgLWYgJFBhdGgKICAgICAgICAgICAgICAgICRleGNlcHRpb24gPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbiBgCiAgICAgICAgICAgICAgICAgICAgLUFyZ3VtZW50TGlzdCAkZXJyb3JNZXNzYWdlCiAgICAgICAgICAgICAgICAkZXJyb3JSZWNvcmQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkVycm9yUmVjb3JkIGAKICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRMaXN0ICRleGNlcHRpb24sICRlcnJvcklkLCAkZXJyb3JDYXRlZ29yeSwgJG51bGwKCiAgICAgICAgICAgICAgICAkUFNDbWRsZXQuVGhyb3dUZXJtaW5hdGluZ0Vycm9yKCRlcnJvclJlY29yZCkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgU2V0LWlTQ1NJVmlydHVhbERpc2sgYAogICAgICAgICAgICAgICAgLUNvbXB1dGVyTmFtZSBMT0NBTEhPU1QgYAogICAgICAgICAgICAgICAgLVBhdGggJFBhdGggYAogICAgICAgICAgICAgICAgLURlc2NyaXB0aW9uICREZXNjcmlwdGlvbiBgCiAgICAgICAgICAgICAgICAtRXJyb3JBY3Rpb24gU3RvcAoKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAiJCgkTXlJbnZvY2F0aW9uLk15Q29tbWFuZCk6ICIKICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza1VwZGF0ZWRNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgLWYgJFBhdGgKICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIENyZWF0ZSB0aGUgaVNDU0kgVmlydHVhbCBEaXNrCiAgICAgICAgICAgIGlmICgkRGlza1R5cGUgLWVxICdGaXhlZCcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRudWxsID0gJFBTQm91bmRQYXJhbWV0ZXJzLkFkZCgnVXNlRml4ZWQnLCRUcnVlKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJG51bGwgPSAkUFNCb3VuZFBhcmFtZXRlcnMuUmVtb3ZlKCdMb2dpY2FsU2VjdG9yU2l6ZUJ5dGVzJykKICAgICAgICAgICAgfQogICAgICAgICAgICBOZXctaVNDU0lWaXJ0dWFsRGlzayBgCiAgICAgICAgICAgICAgICBAUFNCb3VuZFBhcmFtZXRlcnMgYAogICAgICAgICAgICAgICAgLUNvbXB1dGVyTmFtZSBMT0NBTEhPU1QgYAogICAgICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLmlTQ1NJVmlydHVhbERpc2tDcmVhdGVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLkVuc3VyZWlTQ1NJVmlydHVhbERpc2tEb2VzTm90RXhpc3RNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAtZiAkUGF0aAogICAgICAgICAgICApIC1qb2luICcnICkKCiAgICAgICAgaWYgKCRWaXJ0dWFsRGlzaykKICAgICAgICB7CiAgICAgICAgICAgICMgVGhlIGlTQ1NJIFZpcnR1YWwgRGlzayBzaG91bGRuJ3QgZXhpc3QgLSByZW1vdmUgaXQKICAgICAgICAgICAgUmVtb3ZlLWlTQ1NJVmlydHVhbERpc2sgYAogICAgICAgICAgICAgICAgLUNvbXB1dGVyTmFtZSBMT0NBTEhPU1QgYAogICAgICAgICAgICAgICAgLVBhdGggJFBhdGggYAogICAgICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAkKCRMb2NhbGl6ZWREYXRhLmlTQ1NJVmlydHVhbERpc2tSZW1vdmVkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICB9ICMgaWYKICAgIH0gIyBpZgp9ICMgU2V0LVRhcmdldFJlc291cmNlCgpmdW5jdGlvbiBUZXN0LVRhcmdldFJlc291cmNlCnsKICAgIFtDbWRsZXRCaW5kaW5nKCldCiAgICBbT3V0cHV0VHlwZShbU3lzdGVtLkJvb2xlYW5dKV0KICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnUHJlc2VudCcsJ0Fic2VudCcpXQogICAgICAgIFtTeXN0ZW0uU3RyaW5nXQogICAgICAgICRFbnN1cmUgPSAnUHJlc2VudCcsCgogICAgICAgIFtWYWxpZGF0ZVNldCgnRHluYW1pYycsJ0ZpeGVkJywnRGlmZmVyZW5jaW5nJyldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJERpc2tUeXBlID0gJ0R5bmFtaWMnLAoKICAgICAgICBbU3lzdGVtLlVpbnQ2NF0KICAgICAgICAkU2l6ZUJ5dGVzLAogICAgICAgIAogICAgICAgIFtTeXN0ZW0uVWludDMyXQogICAgICAgICRCbG9ja1NpemVCeXRlcywKCiAgICAgICAgW1ZhbGlkYXRlU2V0KDUxMiw0MDk2KV0KICAgICAgICBbU3lzdGVtLlVpbnQzMl0KICAgICAgICAkTG9naWNhbFNlY3RvclNpemVCeXRlcywKICAgICAgICAKICAgICAgICBbVmFsaWRhdGVTZXQoNTEyLDQwOTYpXQogICAgICAgIFtTeXN0ZW0uVUludDMyXQogICAgICAgICRQaHlzaWNhbFNlY3RvclNpemVCeXRlcywKICAgICAgICAKICAgICAgICBbU3lzdGVtLlN0cmluZ10KICAgICAgICAkRGVzY3JpcHRpb24sCiAgICAgICAgCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhcmVudFBhdGgKICAgICkKICAgCiAgICAjIEZsYWcgdG8gc2lnbmFsIHdoZXRoZXIgc2V0dGluZ3MgYXJlIGNvcnJlY3QKICAgIFtCb29sZWFuXSAkZGVzaXJlZENvbmZpZ3VyYXRpb25NYXRjaCA9ICR0cnVlCgogICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5UZXN0aW5naVNDU0lWaXJ0dWFsRGlza01lc3NhZ2UpIGAKICAgICAgICAgICAgLWYgJFBhdGgKICAgICAgICApIC1qb2luICcnICkKCiAgICAjIExvb2t1cCB0aGUgZXhpc3RpbmcgaVNDU0kgVmlydHVhbCBEaXNrCiAgICAkVmlydHVhbERpc2sgPSBHZXQtVmlydHVhbERpc2sgLVBhdGggJFBhdGgKCiAgICBpZiAoJEVuc3VyZSAtZXEgJ1ByZXNlbnQnKQogICAgewogICAgICAgICMgVGhlIGlTQ1NJIFZpcnR1YWwgRGlzayBzaG91bGQgZXhpc3QKICAgICAgICBpZiAoJFZpcnR1YWxEaXNrKQogICAgICAgIHsKICAgICAgICAgICAgIyBUaGUgaVNDU0kgVmlydHVhbCBEaXNrIGV4aXN0cyBhbHJlYWR5IC0gY2hlY2sgdGhlIHBhcmFtZXRlcnMKICAgICAgICAgICAgW0Jvb2xlYW5dICRSZWNyZWF0ZSA9ICRmYWxzZQoKICAgICAgICAgICAgaWYgKCgkRGVzY3JpcHRpb24pIGAKICAgICAgICAgICAgICAgIC1hbmQgKCRWaXJ0dWFsRGlzay5EZXNjcmlwdGlvbiAtbmUgJERlc2NyaXB0aW9uKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5pU0NTSVZpcnR1YWxEaXNrUGFyYW1ldGVyTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCdEZXNjcmlwdGlvbicKICAgICAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICgoJERpc2tUeXBlKSBgCiAgICAgICAgICAgICAgICAtYW5kICgkVmlydHVhbERpc2suRGlza1R5cGUgLW5lICREaXNrVHlwZSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza1BhcmFtZXRlck5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwnU2l6ZUJ5dGVzJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJFJlY3JlYXRlID0gJHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkU2l6ZUJ5dGVzKSBgCiAgICAgICAgICAgICAgICAtYW5kICgkVmlydHVhbERpc2suU2l6ZSAtbmUgJFNpemVCeXRlcykpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza1BhcmFtZXRlck5lZWRzVXBkYXRlTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aCwnU2l6ZUJ5dGVzJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJFJlY3JlYXRlID0gJHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgkUGFyZW50UGF0aCkgYAogICAgICAgICAgICAgICAgLWFuZCAoJFZpcnR1YWxEaXNrLlBhcmVudFBhdGggLW5lICRQYXJlbnRQYXRoKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAtTWVzc2FnZSAoIEAoCiAgICAgICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5pU0NTSVZpcnR1YWxEaXNrUGFyYW1ldGVyTmVlZHNVcGRhdGVNZXNzYWdlKSBgCiAgICAgICAgICAgICAgICAgICAgICAgIC1mICRQYXRoLCdQYXJlbnRQYXRoJwogICAgICAgICAgICAgICAgICAgICkgLWpvaW4gJycgKQogICAgICAgICAgICAgICAgJFJlY3JlYXRlID0gJHRydWUKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBJZiBhbnkgcGFyYW1ldGVycyBkaWZmZXIgdGhhdCByZXF1aXJlIHRoaXMgVmlydHVhbCBEaXNrIHRvIGJlIHJlY3JlYXRlZAogICAgICAgICAgICAjIHRoZW4gdGhyb3cgYW4gZXJyb3IuIFJlY3JlYXRpbmcgdGhlIFZpcnR1YWwgRGlzayBpcyB0b28gZGFuZ2Vyb3VzIGFzIGl0CiAgICAgICAgICAgICMgbWF5IGNvbnRhaW4gZGF0YS4gSWYgdGhlIFZpcnR1YWwgRGlzayAqbXVzdCogYmUgcmVjcmVhdGVkIHRoZW4gdGhlIHVzZXIKICAgICAgICAgICAgIyB3aWxsIG5lZWQgdG8gbWFudWFsbHkgZGVsZXRlIHRoZSBWaXJ0dWFsIERpc2sgYW5kIHRoZSBjb25maWcgd2lsbCB0aGVuCiAgICAgICAgICAgICMgY3JlYXRlIGEgbmV3IG9uZS4KICAgICAgICAgICAgaWYgKCRSZWNyZWF0ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJGVycm9ySWQgPSAnaVNDU0lWaXJ0dWFsRGlza1JlcXVpcmVzUmVjcmVhdGVFcnJvcicKICAgICAgICAgICAgICAgICRlcnJvckNhdGVnb3J5ID0gW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uRXJyb3JDYXRlZ29yeV06OkludmFsaWRBcmd1bWVudAogICAgICAgICAgICAgICAgJGVycm9yTWVzc2FnZSA9ICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza1JlcXVpcmVzUmVjcmVhdGVFcnJvcikgLWYgJFBhdGgKICAgICAgICAgICAgICAgICRleGNlcHRpb24gPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbiBgCiAgICAgICAgICAgICAgICAgICAgLUFyZ3VtZW50TGlzdCAkZXJyb3JNZXNzYWdlCiAgICAgICAgICAgICAgICAkZXJyb3JSZWNvcmQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkVycm9yUmVjb3JkIGAKICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRMaXN0ICRleGNlcHRpb24sICRlcnJvcklkLCAkZXJyb3JDYXRlZ29yeSwgJG51bGwKCiAgICAgICAgICAgICAgICAkUFNDbWRsZXQuVGhyb3dUZXJtaW5hdGluZ0Vycm9yKCRlcnJvclJlY29yZCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAjIFRocyBpU0NTSSBWaXJ0dWFsIERpc2sgZG9lc24ndCBleGlzdCBidXQgc2hvdWxkCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgLU1lc3NhZ2UgKCBAKAogICAgICAgICAgICAgICAgIiQoJE15SW52b2NhdGlvbi5NeUNvbW1hbmQpOiAiCiAgICAgICAgICAgICAgICAgJCgkTG9jYWxpemVkRGF0YS5pU0NTSVZpcnR1YWxEaXNrRG9lc05vdEV4aXN0QnV0U2hvdWxkTWVzc2FnZSkgYAogICAgICAgICAgICAgICAgICAgIC1mICRQYXRoCiAgICAgICAgICAgICAgICApIC1qb2luICcnICkKICAgICAgICAgICAgJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2ggPSAkZmFsc2UKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgIyBUaGUgaVNDU0kgVmlydHVhbCBEaXNrIHNob3VsZCBub3QgZXhpc3QKICAgICAgICBpZiAoJFZpcnR1YWxEaXNrKQogICAgICAgIHsKICAgICAgICAgICAgIyBUaGUgaVNDU0kgVmlydHVhbCBEaXNrIGV4aXN0cyBidXQgc2hvdWxkIG5vdAogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza0V4aXN0c0J1dFNob3VsZE5vdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aAogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgICAgICRkZXNpcmVkQ29uZmlndXJhdGlvbk1hdGNoID0gJGZhbHNlCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICMgVGhlIGlTQ1NJIFZpcnR1YWwgRGlzayBkb2VzIG5vdCBleGlzdCBhbmQgc2hvdWxkIG5vdAogICAgICAgICAgICBXcml0ZS1WZXJib3NlIC1NZXNzYWdlICggQCgKICAgICAgICAgICAgICAgICIkKCRNeUludm9jYXRpb24uTXlDb21tYW5kKTogIgogICAgICAgICAgICAgICAgICQoJExvY2FsaXplZERhdGEuaVNDU0lWaXJ0dWFsRGlza0RvZXNOb3RFeGlzdEFuZFNob3VsZE5vdE1lc3NhZ2UpIGAKICAgICAgICAgICAgICAgICAgICAtZiAkUGF0aAogICAgICAgICAgICAgICAgKSAtam9pbiAnJyApCiAgICAgICAgfQogICAgfSAjIGlmCiAgICByZXR1cm4gJGRlc2lyZWRDb25maWd1cmF0aW9uTWF0Y2gKfSAjIFRlc3QtVGFyZ2V0UmVzb3VyY2UKCiMgSGVscGVyIEZ1bmN0aW9ucwoKRnVuY3Rpb24gR2V0LVZpcnR1YWxEaXNrCnsKICAgIHBhcmFtCiAgICAoCiAgICAgICAgW3BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldCiAgICAgICAgW1N5c3RlbS5TdHJpbmddCiAgICAgICAgJFBhdGgKICAgICkKICAgIHRyeQogICAgewogICAgICAgICMgU3BlY2lmeSBMb2NhbGhvc3QgYXMgY29tcHV0ZXIgYmVjYXVzZQogICAgICAgICMgaXQgc3BlZWRzIGNtZGxldCB1cCBzaWduaWZpY2FudGx5CiAgICAgICAgJFZpcnR1YWxEaXNrID0gR2V0LWlTQ1NJVmlydHVhbERpc2sgYAogICAgICAgICAgICAtQ29tcHV0ZXJOYW1lIExPQ0FMSE9TVCBgCiAgICAgICAgICAgIC1QYXRoICRQYXRoIGAKICAgICAgICAgICAgLUVycm9yQWN0aW9uIFN0b3AKICAgIH0KICAgIGNhdGNoIFtNaWNyb3NvZnQuSXNjc2kuVGFyZ2V0LkNvbW1hbmRzLklzY3NpQ21kRXhjZXB0aW9uXQogICAgewogICAgICAgICRWaXJ0dWFsRGlzayA9ICRudWxsCiAgICB9CiAgICBjYXRjaAogICAgewogICAgICAgIFRocm93ICRfCiAgICB9CiAgICBSZXR1cm4gJFZpcnR1YWxEaXNrCn0KCkV4cG9ydC1Nb2R1bGVNZW1iZXIgLUZ1bmN0aW9uICotVGFyZ2V0UmVzb3VyY2UK
